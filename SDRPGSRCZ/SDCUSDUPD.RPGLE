000100200529     H DEBUG
000110200529     H COPYRIGHT('(c) Finastra International Limited 2002')
000120200529      *****************************************************************
000130200529/*STD *  RPGBASEMOD                                                   *
000140200529/*EXI *  TEXT('Midas SD Customer details database update')            *
000150200529      *****************************************************************
000160200529      *                                                               *
000170200529      *  Midas - Standing Data ILE Module                             *
000180200529      *
000190200529      *  SDCUSDUPD - STANDING DATA CUSTOMERS DATABASE UPDATE          *
000200200529      *                                                               *
000210200529      *  (c) Finastra International Limited 2001                      *
000220200529      *                                                               *
000230200604      *  Last Amend No. 252069             Date 22May20               *
000240200529      *  Prev Amend No. MD055210           Date 03Feb20               *
000250200529      *                 MD054883           Date 23Dec19               *
000260200529      *                 MD053436           Date 21Sep19               *
000270200529      *                 CER050             Date 16Jun19               *
000280200529      *                 CSD102             Date 08Jan19               *
000290200529      *                 MD031234           Date 16May19               *
000300200529      *                 MD020755           Date 16May19               *
000310200529      *                 MD050212           Date 02Apr18               *
000320200529      *                 MD051563           Date 19Jul18               *
000330200529      *                 MD051393           Date 29Jun18               *
000340200529      *                 MD051206           Date 11Jun18               *
000350200529      *                 MD051230           Date 08Jun18               *
000360200529      *                 MD041429           Date 22Sep16               *
000370200529      *                 CGL177             Date 11Jan16               *
000380200529      *                 CGL157             Date 17Aug15               *
000390200529      *                 MD046248           Date 27Oct17               *
000400200529      *                 MD045218           Date 17Apr17               *
000410200529      *                 MD043029           Date 05Dec16               *
000420200529      *                 MD042407           Date 08Nov16               *
000430200529      *                 MD038401B          Date 05Oct16               *
000440200529      *                 CSW216             Date 14Mar16               *
000450200529      *                 CER071             Date 01Aug16               *
000460200529      *                 MD030958           Date 17Jul15               *
000470200529      *                 CER070             Date 29Oct14               *
000480200529      *                 CSW214             Date 29Oct14               *
000490200529      *                 MD030956           Date 09Oct14               *
000500200529      *                 MD028198           Date 08Sep14               *
000510200529      *                 MD029836           Date 22Aug14               *
000520200529      *                 MD027606           Date 01Jul14               *
000530200529      *                 MD027492A          Date 12Jun14               *
000540200529      *                 MD027492           Date 12Jun14               *
000550200529      *                 MD027115           Date 22May14               *
000560200529      *                 MD026957B          Date 29May14               *
000570200529      *                 MD026957           Date 29May13               *
000580200529      *                 MD026854           Date 29May14               *
000590200529      *                 MD026835A          Date 22May14               *
000600200529      *                 MD026835           Date 22May14               *
000610200529      *                 MD026550           Date 22May14               *
000620200529      *                 MD026755           Date 16May14               *
000630200529      *                 MD026502           Date 01May14               *
000640200529      *                 MD026499A          Date 30Apr14               *
000650200529      *                 MD026499           Date 29Apr14               *
000660200529      *                 MD026518           Date 30Apr14               *
000670200529      *                 CGL132             Date 01May13               *
000680200529      *                 CSD092             Date 01May13               *
000690200529      *                 MD026368           Date 16Apr14               *
000700200529      *                 CFT050             Date 03Jun13               *
000710200529      *                 AR1086546          Date 27Jun13               *
000720200529      *                 AR679445           Date 12Jun13               *
000730200529      *                 AR1049708          Date 07Feb13               *
000740200529      *                 AR1081787          Date 30Jan13               *
000750200529      *                 CLE134             Date 01Aug12               *
000760200529      *                 AR971184           Date 28May12               *
000770200529      *                 AR830675           Date 16Sep11               *
000780200529      *                 CRE073             Date 06Dec10               *
000790200529      *                 CSD090             Date 06Dec10               *
000800200529      *                 CRE075             Date 06Dec10               *
000810200529      *                 CER059             Date 19Jul10               *
000820200529      *                 CER045             Date 20Jul09               *
000830200529      *                 BUG23518           Date 30Mar09               *
000840200529      *                 CER047             Date 19May08               *
000850200529      *                 BUG27943           Date 29Jul10               *
000860200529      *                 CSD083             Date 27May10               *
000870200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
000880200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
000890200529      *                 256564             Date 17Sep08               *
000900200529      *                 BUG16705           Date 04Mar08               *
000910200529      *                 BUG15872           Date 12Feb08               *
000920200529      *                 BUG15138           Date 25Oct07               *
000930200529      *                 BUG14969           Date 09Oct07               *
000940200529      *                 BUG14929           Date 04Oct07               *
000950200529      *                 CSW207             Date 08Jun07               *
000960200529      *                 249593             Date 22Aug07               *
000970200529      *                 BUG14009           Date 05Jul07               *
000980200529      *                 BUG14104           Date 06Jun07               *
000990200529      *                 BUG13594           Date 20Mar07               *
001000200529      * Midas Plus 1.4 Base ------------------------------------------*
001010200529      *                 BUG13525           Date 05Mar07               *
001020200529      *                 CSD079             Date 05Feb07               *
001030200529      *                 BG12238            Date 24Oct06               *
001040200529      *                 CRE026             Date 06Jun06               *
001050200529      * Midas Plus 1.3 ----------- Base ------------------------------*
001060200529      *                 BUG12406           Date 05Nov06               *
001070200529      *                 BUG12342           Date 27Oct06               *
001080200529      *                 CSD031             Date 10Apr06               *
001090200529      *                 BUG10651           Date 22Feb06               *
001100200529      *                 CSD028             Date 22Aug05               *
001110200529      *                 CSD027             Date 09Dec05               *
001120200529      *                 BUG6444            Date 05Apr05               *
001130200529      *                 217230             Date 02Sep03               *
001140200529      *                 CSW037A            Date 02May05               *
001150200529      *                 CSD023             Date 18Nov04               *
001160200529      *                 BUG6552            Date 10Apr05               *
001170200529      *                 BUG6198            Date 04Apr05               *
001180200529      *                 CSD025             Date 11Jan05               *
001190200529      *                 BUG4810            Date 27Jan05               *
001200200529      *                 BUG5409            Date 11Jan05               *
001210200529      *                 CSW036             Date 15Dec04               *
001220200529      *                 CSW037             Date 14Dec04               *
001230200529      *                 BUG4967            Date 10Dec04               *
001240200529      *                 BUG4668            Date 23Dec04               *
001250200529      *                 BUG4732            Date 06Nov04               *
001260200529      *                 BUG4692            Date 02Nov04               *
001270200529      *                 BUG4201            Date 09Sep04               *
001280200529      *                 BUG3362            Date 30Jul04               *
001290200529      *                 CFX001             Date 20Oct03               *
001300200529      *                 CLE025             Date 20Oct03               *
001310200529      *                 BUG2313            Date 28Apr04               *
001320200529      *                 BUG1986            Date 28Apr04               *
001330200529      *                 CSD021             Date 10Jul03               *
001340200529      *                 CGL029             Date 01Sep03               *
001350200529      *                 CGP001             Date 23May03               *
001360200529      *                 CSD015             Date 14Oct02               *
001370200529      *                 CSD012             Date 15Oct02               *
001380200529      * Midas Release 4.01.02 ----------------------------------------*
001390200529      *                 210006             Date 23Oct01               *
001400200529      *                 202380             Date 28May02               *
001410200529      *                 202931             Date 09May02               *
001420200529      * Midas Release 4.01 -------------------------------------------*
001430200529      *                 201011             Date 28Nov01               *
001440200529      *                 CSC011             Date 18Sep01               *
001450200529      *                 193883             Date 20Nov01               *
001460200529      *                 CSW024             Date 31Aug01               *
001470200529      * Midas Release 4 --------------- Base -------------------------*
001480200529      * Midas DBA 3.05 -----------------------------------------------*
001490200529      *                 CRE007             Date 01Mar01               *
001500200529      *                 185595             Date 13Nov00               *
001510200529      *                 175680             Date 08Mar00               *
001520200529      * Midas DBA 3.04 -----------------------------------------------*
001530200529      *                 CSD007             Date 28Aug00               *
001540200529      *                 CDL008             Date 02May00               *
001550200529      * Midas DBA 3.02 -----------------------------------------------*
001560200529      *                 CAP013             Date 22Nov99               *
001570200529      *                 CAP034  *CREATE    Date 20May99               *
001580200529      *                                                               *
001590200529      *---------------------------------------------------------------*
001600200529      *                                                               *
001610200529      *  252069 - Database error message occurs when there is a       *
001620200529      *           record locking issue.                               *
001630200529      *  MD055210 - Serious midas error encountered in CUSD           *
001640200529      *  MD054883 - CUSD Reverse API had an increased runtime         *
001650200529      *  MD053436 - Unable to perform end to end testing for          *
001660200529      *             Compliance KYC                                    *
001670200529      *  CER050 - Annualised Percentage Rate                          *
001680200529      *  CSD102 - Password Length Extension (Recompile)               *
001690200529      *  MD031234 - Marketing information not updated on CLINTCB      *
001700200529      *             when inserting customer.                          *
001710200529      *           - Applied for MD-52640.                             *
001720200529      *  MD020755 - CLINTCB not updated for SDCRMKPD.                 *
001730200529      *           - Applied for MD-52640.                             *
001740200529      *  MD050212 - Replication processing for PF/SDCUSTXC            *
001750200529      *  MD051563 - On COB run, Component GOC0100 failed due to       *
001760200529      *             Customer Related Duplicate Key Error              *
001770200529      *  MD051393 - Serious midas error                               *
001780200529      *  MD051206 - Time field in FATCA Information tab changes to    *
001790200529      *             asterisks after amendment authorisation           *
001800200529      *  MD051230 - Authorise of customer record in CUSD gets serious *
001810200529      *             midas error message                               *
001820200529      *  MD041429 - History of Customer Information does not reflect  *
001830200529      *             US Indicia Changed upon Insert and Miscellaneous  *
001840200529      *             Change to log Additional Customer Details upon    *
001850200529      *             Insert and Amend.                                 *
001860200529      *  CGL177 - CRS Reporting Phase 2                               *
001870200529      *  CGL157 - CRS Reporting                                       *
001880200529      *  MD046248 - Finastra Rebranding                               *
001890200529      *  MD045218 - Account Review is not displayed in listview       *
001900200529      *  MD043029 - Serious Midas Error encountered during            *
001910200529      *             authorisation of CUSD amend                       *
001920200529      *  MD042407 - Creation Date field is missing when CGL132 is     *
001930200529      *             switched off ; reversed MD030958 fix              *
001940200529      *  MD038401B - Corrected parameters when calling SDCUSDRTV.     *
001950200529      *  CSW216 - SWIFT Changes 2016 (Recompile)                      *
001960200529      *  CER071 - BAIS - Legal Form field                             *
001970200529      *  MD030958 - Condition SDCUSTXC updates on CGL132 feature.     *
001980200529      *  CER070 - BuBa Reporting / BAIS V.1.16.0                      *
001990200529      *  CSW214 - SWIFT Changes 2014 (Recompile)                      *
002000200529      *  MD030956 - Additional changes to BFM-TI enhancement          *
002010200529      *  MD028198 - Bank Directory Record Key field should be         *
002020200529      *             dependent on CFT050                               *
002030200529      *  MD029836 - OCBC FATCA - US Indicia Comments History          *
002040200529      *           - Apply fix MD027525                                *
002050200529      *  MD027606 - Override Date and Time remains blank after        *
002060200529      *             Defining a value in Override during Insert        *
002070200529      *  MD027492A - Override Details in US Indicia screen is         *
002080200529      *              incorrect                                        *
002090200529      *  MD027492 - Override Details in US Indicia screen is incorrect*
002100200529      *  MD027115 - Joint Account Exception updates                   *
002110200529      *  MD026957B - History of customer information issues           *
002120200529      *  MD026957 - History of customer information issues            *
002130200529      *  MD026854 - Alternative country of citizenship is missing in  *
002140200529      *             history of customer information                   *
002150200529      *  MD026835A - Override user and override time are wrong        *
002160200529      *  MD026835 - Override user and override time are wrong         *
002170200529      *  MD026550 - US TIN Update in FATCA Customer Details           *
002180200529      *             changed                                           *
002190200529      *  MD026755 - Unable to create customer Serious Midas Error on  *
002200200529      *             confirm authorised                                *
002210200529      *  MD026502 - Account review generated when a customer is       *
002220200529      *             tagged as high value account have incorrect       *
002230200529      *             scheduled date                                    *
002240200529      *  MD026499A - Unexpected error appears in auto generated       *
002250200529      *              account reviews by high value indicator          *
002260200529      *  MD026499 - Unexpected error appears in auto generated        *
002270200529      *             account reviews by high value indicator           *
002280200529      *  MD026518 - Incorrect drop down selection in US indicia       *
002290200529      *  CGL132 - FATCA Phase 1 - Customers' Identification and       *
002300200529      *           Classification - Master                             *
002310200529      *  CSD092 - Account Review                                      *
002320200529      *  MD026368 - Serious Midas error has occured when authorising  *
002330200529      *             a customer.                                       *
002340200529      *           - Condition the update to extension file SDCTNMPD   *
002350200529      *             if the customer number is not blank.              *
002360200529      *  CFT050 - SWIFTRef Directories upload                         *
002370200529      *  AR1086546 - Upgrade of CDL025 to MP 1.4 (Child: AR1086547).  *
002380200529      *              Applied for MD021813                             *
002390200529      *  AR679445 - Blanks BBIUSR and BBAUSR. Populate these fields   *
002400200529      *             using the profile on ZMUSER. (Child: AR679446)    *
002410200529      *  AR1049708 - WIP problem for customer: record written into    *
002420200529      *              PF/SDPLCSPD (Child:AR1049709)                    *
002430200529      *  AR1081787 - A Serious midas error has occurred upon hitting  *
002440200529      *              complete button using new inserted CUAP, Curren- *
002450200529      *              cy saved at PMPORTPD is wrong.                   *
002460200529      *  CLE134 - Past Due Call Loan Processing                       *
002470200529      *  AR971184 - For some JMS APIs (CUSD, AMAD, DPMV, OPAY), Front *
002480200529      *             Office Id is no more updated in master database   *
002490200529      *             files which provokes some big problems in third   *
002500200529      *             party product such as TOF.(Child:AR971185)        *
002510200529      *  AR830675 - GF - Maintain Customers - Add. Cust. Inf. 2 -     *
002520200529      *             entered lang. ID not defaulted                    *
002530200529      *             (Child: AR830676)                                 *
002540200529      *  CRE073 - Interest Rate Rounding (Recompile)                  *
002550200529      *  CSD090 - Customer Segmentation                               *
002560200529      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
002570200529      *  CER059 - German Feature Upgrade to Delhi                     *
002580200529      *         - LT073: upgrade ACU3, ACU4, CUAH and CCTX to CUSD    *
002590200529      *  CER045 - German Features - Reporting Bundesbank (Recompile)  *
002600200529      *  BUG23518 - Produce Annual Tax Deducted Statement upon        *
002610200529      *             Customer Closure                                  *
002620200529      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
002630200529      *           (Recompile)                                         *
002640200529      *  BUG27943 - Unable to authorise amendment                     *
002650200529      *  CSD083 - Watch List Compliance Upgrade                       *
002660200529      *  256564 - Recompile due to PF changes done by fix 256330      *
002670200529      *  BUG16705 - The system should automatically generate customer *
002680200529      *             number if field is blank                          *
002690200529      *  BUG15872 - Parameter mismatch. Applied fix BUG14992          *
002700200529      *  BUG14992 - Some of CSW207 fields not completely upgraded     *
002710200529      *  BUG15138 - IBEI is not updated when CSW207 is off            *
002720200529      *  BUG14969 - Cannot authorise amendments to Customer details   *
002730200529      *             SWIFT additional fields.                          *
002740200529      *  BUG14929 - Error in Customer Details update                  *
002750200529      *  CSW207 - SWIFT 2007 Changes                                  *
002760200529      *  249593 - Correct mismatch parameters on second SDCUSDRTV call*
002770200529      *  BUG14009 - To implement Close and Release functionality in   *
002780200529      *             Customer API                                      *
002790200529      *  BUG14104 - MidasPlus error encountered when authorising a    *
002800200529      *             new Wholesale Customer                            *
002810200529      *  BUG13594 - MidasPlus error encountered when authorising a    *
002820200529      *             new Wholesale Customer                            *
002830200529      *  BUG13525 - ECSD Mismatch between XML and RPG                 *
002840200529      *  CSD079 - Enhanced Customer Maintenance API                   *
002850200529      *  BG12238 - Conditional writes to files within wholesale/      *
002860200529      *            universal customer input                           *
002870200529      *  CRE026  - Consumer Banking                                   *
002880200529      *  BUG12406 - Customer Account Details DBase error              *
002890200529      *  BUG12342 - Database error when accepting Customer            *
002900200529      *  CSD031 - Enhanced Centralised Static Data                    *
002910200529      *  BUG10651 - Fiduciary Customer details blanks out during      *
002920200529      *             Standing Data Authorisation.                      *
002930200529      *  CSD028 - KYC (Standing Data Authorisations )                 *
002940200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
002950200529      *  BUG6444- Unable to amend field 71a on the counterparty record*
002960200529      *  217230 - Change to Tax/Non-tax indicator should also be      *
002970200529      *           send to TOF.                                        *
002980200529      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
002990200529      *  CSD023 - Automatic Customer Account Closure                  *
003000200529      *  BUG6552- CSW037 Field 83 (recompile).                        *
003010200529      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
003020200529      *  CSD025 - Customer De-Activation                              *
003030200529      *  BUG4810 - Decimal data error when authorising a customer.    *
003040200529      *  BUG5409 - Authorisation of customer closure do not update    *
003050200529      *            closure detail on file.                            *
003060200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
003070200529      *  CSW037 - AdditionaField Data on MT300/MT320                  *
003080200529      *  BUG4967 - Pass TI Customer Details on call to SDCUSDRTV.     *
003090200529      *  BUG4668 - Complete bug fix 4692 for another TI file          *
003100200529      *  BUG4732 - Database error on SDTICSL0                         *
003110200529      *  BUG4692 - Should not access SDTICSL0 when TI module is OFF.  *
003120200529      *  BUG4201 - Difference TI Customer Details Audit report        *
003130200529      *  BUG3362 - Added processing for TI details changes            *
003140200529      *  CFX001 - FX Margin Trading                                   *
003150200529      *  CLE025 - Credit Lines                                        *
003160200529      *  BUG2313 - Numerous errors concerning global customer id      *
003170200529      *  BUG1986 - System Generated Customer Number.  Parameter mis-  *
003180200529      *            match when calling SDCUSDRTV.                      *
003190200529      *  CSD021 - System Generated Customer Number.                   *
003200200529      *  CGL029 - Increase Account Code to 10 digits                  *
003210200529      *  CGP001 - Global Processing                                   *
003220200529      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
003230200529      *  CSD012 - Standing Data Authorisation                         *
003240200529      *  210006 - Add parameter @CNUM for customer before calling     *
003250200529      *           SD0012U to prevent program from ending in PGM DUMP. *
003260200529      *  202380 - Avoid dump due missing SE module                    *
003270200529      *  202931 - In case of more than one amend in a day, no         *
003280200529      *           acknowledge is replicated.                          *
003290200529      *  201011 - Amended customer details coming from CTL are not    *
003300200529      *           processed. Also, no update to BRT participator      *
003310200529      *           history details should be done for account holder   *
003320200529      *           type R.                                             *
003330200529      *  CSC011 - 24x7 Midas Availability                             *
003340200529      *  193883 - PB Customer Maintenance - Complete fix 175680.      *
003350200529      *  CSW024 - S.W.I.F.T. MT3xx Field 82/83/87.                    *
003360200529      *  CRE007 - Base Rate Tax 2001                                  *
003370200529      *  185595 - In case of change of the branch, SDPBDSPD needs to  *
003380200529      *           be updated to be reflected to Tof                   *
003390200529      *  175680 - PB Customer Maintenance - Fields protection         *
003400200529      *  CSD007 - Customer Closing:                                   *
003410200529      *           Allow Closure and Release of Customer Records.      *
003420200529      *  CDL008 - Continuous Linked Settlement                        *
003430200529      *  CAP013 - Allow access by Midas transaction ID if not insert  *
003440200529      *  CAP034 - Conversion of Midas inputs to modular API structure *
003450200529      *                                                               *
003460200529      *****************************************************************
003470200529
003480200529     FSDALTNL1  IF   E           K DISK
003490200529      * Interest Payment File 6
003500200529     FINTPSL6   IF   E           K DISK    RENAME(INTPSDDF:INTPSLF6)
003510200529     F                                     PREFIX(A_)
003520200529      * Interest Payment File 7
003530200529     FINTPSL7   IF   E           K DISK    RENAME(INTPSDDF:INTPSLF7)
003540200529     F                                     PREFIX(B_)
003550200529      * Interest Payment File 8
003560200529     FINTPSL8   IF   E           K DISK    RENAME(INTPSDDF:INTPSLF8)
003570200529     F                                     PREFIX(C_)
003580200529      * RTV : Midas SD Customer marketing groups retrieval
003590200529     FSDCMRKL1  IF   E           K DISK
003600200529
003610200529      * UPD : Midas SD Customer Details Master File
003620200529     FSDCUSTL0  UF A E           K DISK    COMMIT
003630200529     F                                     INFDS(DSPDS)                                       252069
003640200529     F/COPY WNCPYSRC,SDH00749
003650200529
003660200529      ** UPD : Midas SD Customer Ext Details File                                             CGL132
003670200529     FSDCUSXL0  UF A E           K DISK    COMMIT                                             CGL132
003680200529     F                                     RENAME(SDCUSTX0:SDCUSTX1)                          CGL132
003690200529                                                                                              CGL132
003700200529      * UPD : Midas SD Standing Data Controls index
003710200529     FSDFCTLL0  UF A E           K DISK    COMMIT
003720200529                                                                                              CGL132
003730200529      ** FATCA Customer details file                                                          CGL132
003740200529     FSDFTCSL0  UF A E           K DISK    COMMIT                                             CGL132
003750200529                                                                                              CGL132
003760200529      ** Account review details file                                                          CGL132
003770200529     FSDACRVL0  UF A E           K DISK    COMMIT                                             CGL132
003780200529                                                                                              CGL132
003790200529      ** US Indicia Comment History                                                           CGL132
003800200529     FSDINCHL0  UF A E           K DISK    COMMIT                                             CGL132
003810200529
003820200529      * UPD : Midas SD Alternate names and address
003830200529     FSDALTNL0  UF   E           K DISK    COMMIT
003840200529
003850200529      * UPD : Midas SD Trade Innovation Customer Details
003860200529     FSDTICSL0  UF A E           K DISK    COMMIT
003870200529     F                                     USROPN
003880200529
003890200529      * UPD : Midas SD Base Rate Tax Details
003900200529     FSDCBRTL1  UF A E           K DISK    COMMIT
003910200529     F                                     USROPN
003920200529     FPTYHSTPD  UF A E           K DISK    COMMIT
003930200529     F                                     USROPN
003940200529
003950200529     F**LSDVEBRPTPDO    E             DISK
003960200529     F**L                                  RENAME(SDVBRPTPD0:SDVBRPTERR)
003970200529
003980200529      * UPD : Midas SD Private Banking Details
003990200529     FSDPBDSL0  UF A E           K DISK    COMMIT
004000200529     F                                     PREFIX(D_)
004010200529      *                                                                                       CSD012
004020200529     FSDAULGL3  UF A E           K DISK    COMMIT                                             CSD012
004030200529     F                                     RENAME(SDAULGD0:SDAULGD3)                          CSD012
004040200529      * UPD : Authorisation Log - by Function                                                 CSD012
004050200529      *                                                                                       CSD012
004060200529     FSDCDSHL0  UF A E           K DISK    COMMIT                                             CSD012
004070200529     F                                     USROPN                                           MD055210
004080200529     F                                     PREFIX(T_)                                         CSD012
004090200529     F                                     RENAME(@BBREBG:SDCDSHD0)                           CSD012
004100200529      * UPD : Customer Details Shadow file by key                                             CSD012
004110200529      *                                                                                       CSD012
004120200529     FSDCBSHL0  UF A E           K DISK    COMMIT                                             CSD012
004130200529     F                                     PREFIX(T_)                                         CSD012
004140200529     F                                     RENAME(SDCBRTD0:SDCBSHD0)                          CSD012
004150200529      * UPD : BRT Customer details Shadow file by key                                         CSD012
004160200529      *                                                                                       CSD012
004170200529     FSDPBSHL0  UF A E           K DISK    COMMIT                                             CSD012
004180200529     F                                     PREFIX(T_)                                         CSD012
004190200529     F                                     RENAME(SDPBDSD0:SDPBSHD0)                          CSD012
004200200529      * UPD : Private Banking Customer deatails Shadow file by key                            CSD012
004210200529     FSDTDSHL0  UF A E           K DISK    COMMIT                                            BUG3362
004220200529     F                                     PREFIX(T_)                                        BUG3362
004230200529     F                                     RENAME(SDTICSD0:SDTDSHD0)                         BUG3362
004240200529      * UPD : Trade Innovation Customer Details shadow file by key                           BUG3362
004250200529     FSDSWSHL0  UF A E           K DISK    COMMIT                                           BUG14969
004260200529     F                                     PREFIX(T_)                                       BUG14969
004270200529     F                                     RENAME(SDSWSHD0:SDSWSHD1)                        BUG14969
004280200529      * UPD : Customer Extension SWIFT Details shadow file by key                           BUG14969
004290200529                                                                                              CSD015
004300200529      ** Compliance Watch Hit List                                                            CSD015
004310200529     FSDCWHTL1  IF   E           K DISK                                                       CSD015
004320200529
004330200529      ** UPD : Midas SD Global Customer X-Reference                                           CGP001
004340200529     FGPCUSTXL0 UF A E           K DISK    COMMIT                                             CGP001
004350200529     F                                     PREFIX(G_)                                         CGP001
004360200529                                                                                              CGP001
004370200529      ** IDX : Midas GL Accounts                                                              CSD023
004380200529     FACCNT     UF   E           K DISK    USROPN                                             CSD023
004390200529     F                                     IGNORE(ACCNTAAF)                                   CSD023
004400200529     F                                     IGNORE(ACCNTACF)                                   CSD023
004410200529                                                                                              CSD023
004420200529      ** Midas SD Customer Details Acceptance - Update Index                                  CSD031
004430200529     F***SDACSTL0  UF   E           K DISK    COMMIT                                 CSD031 BUG13525
004440200529     F**********                           USROPN                                    CSD031 BUG13525
004450200529     F**********                           RENAME(SDCUSTD0: SDACSTD0)                CSD031 BUG13525
004460200529                                                                                              CSD031
004470200529      ** UPD : Midas SD Customer marketing groups update                                      CSD079
004480200529     FSDCMRKL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004490200529     F                                     INFSR(SRERR)                                       CSD079
004500200529                                                                                              CSD079
004510200529      ** UPD : Midas SD Additional Customer Details update                                    CSD079
004520200529     FSDACUSL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004530200529     F                                     INFSR(SRERR)                                       CSD079
004540200529                                                                                              CSD079
004550200529      ** UPD : Midas SD Customer Service Fees Details update                                  CSD079
004560200529     FSDCFCDL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004570200529     F                                     INFSR(SRERR)                                       CSD079
004580200529                                                                                              CSD079
004590200529      ** UPD : Midas SD Customer Cheque Handling Details update                               CSD079
004600200529     FSDCHEQL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004610200529     F                                     INFSR(SRERR)                                       CSD079
004620200529                                                                                              CSD079
004630200529      ** UPD : Midas SD Customer Safes Details update                                         CSD079
004640200529     FSDSAFEL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004650200529     F                                     INFSR(SRERR)                                       CSD079
004660200529                                                                                              CSD079
004670200529      ** UPD : Midas SD Future & Options Client update                                        CSD079
004680200529     FSDFOCSL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004690200529     F                                     INFSR(SRERR)                                       CSD079
004700200529                                                                                              CSD079
004710200529      ** UPD : MIDAS/ABS FF Customers Maintenance- CAD Rtv.                                   CSD079
004720200529     FSDFOX1L0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004730200529     F                                     INFSR(SRERR)                                       CSD079
004740200529                                                                                              CSD079
004750200529      ** UPD : Midas SD Portfolio management cust dtls update                                 CSD079
004760200529     FSDPLCSL0  UF A E           K DISK    COMMIT    USROPN                                   CSD079
004770200529     F                                     INFSR(SRERR)                                       CSD079
004780200529                                                                                              CSD079
004790200529      ** PM LIVE PORTFOLIOS WITH PERFORMANCE                                                  CSD079
004800200529     FPMPORTL1  IF A E           K DISK    COMMIT                                             CSD079
004810200529     F                                     INFSR(SRERR)                                       CSD079
004820200529                                                                                              CSD079
004830200529      ** PM PORTFOLIO DEFINITION AUDIT                                                        CSD079
004840200529     FPMPORTPA  UF A E             DISK    COMMIT                                             CSD079
004850200529     F                                     INFSR(SRERR)                                       CSD079
004860200529                                                                                              CSD079
004870200529      ** RSQ : Midas SD Branch codes by customer number                                       CSD079
004880200529     FSDBRCHL5  IF   E           K DISK                                                       CSD079
004890200529                                                                                              CSD079
004900200529      ** Midas PB Template Portfolio                                                          CSD079
004910200529     FPBTMPDLL  IF   E           K DISK                                                       CSD079
004920200529      *                                                                                       CSW207
004930200529      ** UPD : Midas SD Customer Details Swift extension file                                 CSW207
004940200529      *                                                                                       CSW207
004950200529     FSDCSSWL0  UF A E           K DISK    COMMIT                                             CSW207
004960200529                                                                                              CSD079
004970200529     FSDACEXL0  O    E             DISK    INFSR(SRERR)                                     MD026499
004980200529     F                                     PREFIX(EX)                                       MD026499
004990200529                                                                                            MD027115
005000200529     FSDJACCL4  IF   E           K DISK    INFSR(SRERR)                                     MD027115
005010200529     F                                                                                      MD027115
005020200529                                                                                              CGL157
005030200529      ** Midas SD CRS Customer Details File                                                   CGL157
005040200529     FSDCRSHL0  UF A E           K DISK    COMMIT                                             CGL157
005050200529                                                                                              CGL157
005060200529      * Midas SD CRS Details File                                                             CGL157
005070200529     FSDCRSDL1  UF A E           K DISK    COMMIT                                             CGL157
005080200529                                                                                              CGL177
005090200529      * Midas SD CRS Details File                                                             CGL177
005100200529     FSDCRSDL3  UF A E           K DISK    COMMIT                                             CGL177
005110200529     F                                     RENAME(SDCRSDD0:SDCRSDD1)                          CGL177
005120200529     F                                     PREFIX(D_)                                         CGL177
005130200529                                                                                            MD026499
005140200529     F/COPY WNCPYSRC,SDCUSDDF01
005150200529      *****************************************************************
005160200529      ** +--------------------------------------+
005170200529      ** ¦ Automatically included D-specs       ¦
005180200529      ** ¦ ==============================       ¦
005190200529      ** +--------------------------------------+
005200200529      **
005210200529      **--------------------------------------------------------------------------------------------
005220200529      ** The following /COPY line includes (among others) the LDA layout
005230200529      ** and the copyright array definition:
005240200529     D/COPY ZACPYSRC,STD_D_SPEC
005250200529      **--------------------------------------------------------------------------------------------
005260200529
005270200529      **--------------------------------------------------------------------------------------------
005280200529      ** The following /COPY includes the MM standard declares:
005290200529     D/COPY ZACPYSRC,STDDECLARE
005300200529      **--------------------------------------------------------------------------------------------
005310200529
005320200529      **--------------------------------------------------------------------------------------------
005330200529      ** The following /COPY line includes all the defined fields in the
005340200529      ** Program Status Data Structures.  They have meaningful
005350200529      ** names, prefixed by 'PS'.
005360200529     D/COPY ZACPYSRC,PSDS
005370200529      **--------------------------------------------------------------------------------------------
005380200529      ** The following /COPY line includes the definitions for error and
005390200529      ** warning message arrays.
005400200529     D/COPY ZACPYSRC,ERR_ARRAYS
005410200529      **--------------------------------------------------------------------------------------------
005420200529
005430200529      **--------------------------------------------------------------------------------------------
005440200529
005450200529      ** +--------------------------------------+
005460200529      ** ¦ End of automatically included D-specs¦
005470200529      ** ¦ =====================================¦
005480200529      ** +--------------------------------------+
005490200529
005500200529      *****************************************************************
005510200529
005520200529      ** CSD023 fileds                                                                        CSD023
005530200529     D CSD023          S              1                                                       CSD023
005540200529     D CSD028          S              1                                                       CSD028
005550200529     D PTransType      S              4                                                       CSD028
005560200529     D WNewCust        S              1                                                       CSD028
005570200529     D PAction         S              1                                                       CSD028
005580200529     D PCustNumber     S              6                                                       CSD028
005590200529     D ALSTAT          S              1                                                       CSD028
005600200529     D APIRetc         S              1                                                       CSD023
005610200529                                                                                              CSD023
005620200529     D WURDNB          S                   like(BJRDNB)                                       CSD079
005630200529     D CER050          S              1A   inz('N')                                           CER050
005640200529     D CSD079          S              1A   inz('N')                                           CSD079
005650200529     D S01425          S              1A   inz('N')                                           CSD079
005660200529     D CSD008          S              1A   inz('N')                                           CSD079
005670200529     D CDL002          S              1A   inz('N')                                           CSD079
005680200529     D CDL006          S              1A   inz('N')                                           CSD079
005690200529     D CLE134          S              1A   inz('N')                                           CLE134
005700200529     D ULX609          S              1A   inz('N')                                           CSD079
005710200529     D ULX043          S              1A   inz('N')                                           CSD079
005720200529     D CGL018          S              1A                                                      CSD079
005730200529     D ULX004          S              1A   inz('N')                                           CSD079
005740200529     D CDL025          S              1A   inz('N')                                        AR1086546
005750200529     D PMODE           S              1A                                                      CSD079
005760200529                                                                                              CSD079
005770200529      *Run date DS                                                                            CSD079
005780200529     DRUNDAT           DS                                                                     CSD079
005790200529     D MRDT                    1      7                                                       CSD079
005800200529     D RDNB                    8     10P 0                                                    CSD079
005810200529     D W_DLUP                  1      2  0                                                    CSD079
005820200529     D W_MLUP                  3      5                                                       CSD079
005830200529     D W_YLUP                  6      7  0                                                    CSD079
005840200529     D SUC                    11     11                                                       CSD079
005850200529     D DFF                    12     12                                                       CSD079
005860200529     D MBIN                   13     13                                                       CSD079
005870200529     DWUMRDT           DS                                                                     CSD079
005880200529     D WUDLUP                  1      2  0                                                    CSD079
005890200529     D WUMLUP                  3      5                                                       CSD079
005900200529     D WUYLUP                  6      7  0                                                    CSD079
005910200529                                                                                              CSD079
005920200529      ** Return Code work field                                                               CSD079
005930200529     D WURTCD          S              7                                                       CSD079
005940200529                                                                                              CSD079
005950200529      ** PM-action                                                                            CSD079
005960200529     D WUPMAC          S              8                                                       CSD079
005970200529                                                                                              CSD079
005980200529      ** Book Code                                                                            CSD079
005990200529     D WUBKCD          S              2                                                       CSD079
006000200529                                                                                              CSD079
006010200529      ** Portfolio Reference                                                                  CSD079
006020200529     D WUPTRF          S              4                                                       CSD079
006030200529                                                                                              CSD079
006040200529      ** Portfolio Ref                                                                        CSD079
006050200529     D WUSCPF          S              4                                                       CSD079
006060200529                                                                                              CSD079
006070200529      ** Portfolio Ref                                                                        CSD079
006080200529     D WUSCPT          S              4                                                       CSD079
006090200529                                                                                              CSD079
006100200529      ** Program name                                                                         CSD079
006110200529     D WUPGMN          S             10                                                       CSD079
006120200529                                                                                              CSD079
006130200529      ** Customer Number                                                                      CSD079
006140200529     D WUCUST          S              6                                                       CSD079
006150200529                                                                                              CSD079
006160200529      ** Timestamp for the transaction
006170200529     D TimeStamp       S               Z
006180200529                                                                                              CGL132
006190200529     D SysVal1         C                   'FATCADftCLsNewCustNH'                             CGL132
006200200529     D SysVal2         C                   'AcRevDftFreq'                                     CGL132
006210200529     D SysVal3         C                   'FATCACountryofTax'                                CGL132
006220200529
006230200529     D ChkCusdFmt    E DS                  EXTNAME(SDCUSTPD)
006240200529      ** Rename fields for Timestamp checking
006250200529     D                                     PREFIX(CH)
006260200529     D/COPY WNCPYSRC,SDH00750
006270200529      * Current Customer in File Format (Base Rate Tax Details)
006280200529     D CBrtFilFmt    E DS                  EXTNAME(SDCBRTPD)
006290200529     D                                     PREFIX(CB_)
006300200529      * Current Customer in File Format (Private Banking Details)
006310200529     D CPrbFilFmt    E DS                  EXTNAME(SDPBDSPD)
006320200529     D                                     PREFIX(CP_)
006330200529
006340200529      ** TI Customer Details in File Format                                                  BUG4967
006350200529     D CuTIFilFmt    E DS                  EXTNAME(SDTICSPD)                                 BUG4967
006360200529     D                                     PREFIX(Z_)                                        BUG4967
006370200529                                                                                             BUG4967
006380200529      ** Current Global Customer X-Reference in File Format                                   CGP001
006390200529     D CGCuFilFmt    E DS                  EXTNAME(GPCUSTXPD)                                 CGP001
006400200529     D                                     PREFIX(CG_)                                        CGP001
006410200529     D CrXcFilFmt    E DS                  EXTNAME(SDCUSTXC)                                  CGL132
006420200529     D                                     PREFIX(C_)                                         CGL132
006430200529
006440200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID CUSTOMER
006450200529     D SDVCUSD       E DS                  EXTNAME(SDVCUSDPD)
006460200529     D                                     PREFIX(A_)
006470200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID CUSTOMER - EXT                        CGL132
006480200529     D SDVCUXC       E DS                  EXTNAME(SDVCUXCPD)                                 CGL132
006490200529     D                                     PREFIX(A_)                                         CGL132
006500200529                                                                                              CGL157
006510200529      ** Externally desc'd DS for valid CRS detail                                            CGL157
006520200529     D SDVCRSD       E DS                  EXTNAME(SDVCRSDPD)                                 CGL157
006530200529     D                                     PREFIX(D_)                                         CGL157
006540200529                                                                                              CGL157
006550200529      ** Externally desc'd DS for valid transactions Detail                                   CGL157
006560200529     D SDVCRSH       E DS                  EXTNAME(SDVCRSHPD)                                 CGL157
006570200529     D                                     PREFIX(C_)                                         CGL157
006580200529     D SDCRSDA       E DS                  EXTNAME(SDCRSDPD)                                  CGL177
006590200529     D                                     PREFIX(D_)                                         CGL177
006600200529     D SDCRSDB       E DS                  EXTNAME(SDCRSDPD)                                  CGL177
006610200529     D                                     PREFIX(E_)                                         CGL177
006620200529                                                                                              CGL157
006630200529      **  Transaction Details File                                                            CGL157
006640200529     D SDCRSH        E DS                  EXTNAME(SDCRSHPD)                                  CGL157
006650200529                                                                                              CGL157
006660200529      **  Transaction Details File                                                            CGL157
006670200529     D SDCRSD        E DS                  EXTNAME(SDCRSDPD)                                  CGL157
006680200529                                                                                              CGL157
006690200529      ** Current CRS Transaction Detail in File Format                                        CGL157
006700200529     D CrCrsFlFmt    E DS                  EXTNAME(SDCRSHPD)                                  CGL157
006710200529     D                                     PREFIX(C_)                                         CGL157
006720200529      *                                                                                       CSW207
006730200529      **  Externally descrived data structure for valid customer extension                    CSW207
006740200529      *                                                                                       CSW207
006750200529     D SDVSWSD       E DS                  EXTNAME(SDVSWSDPD)                                 CSW207
006760200529     D                                     PREFIX(A_)                                         CSW207
006770200529                                                                                            BUG14929
006780200529      ** SWIFT Details in File Format                                                       BUG14929
006790200529     D SwftFilFmt    E DS                  EXTNAME(SDCSSWPD)                                BUG14929
006800200529                                                                                              CGL132
006810200529      ** Account Review details                                                               CGL132
006820200529     D SDACRVDF      E DS                  EXTNAME(SDACRVPD)                                  CGL132
006830200529                                                                                              CGL132
006840200529      ** FATCA Customer Details in file format                                                CGL132
006850200529     D CuFaFilFmt    E DS                  EXTNAME(SDFTCSPD)                                  CGL132
006860200529     D                                     PREFIX(C_)                                         CGL132
006870200529
006880200529     D SDECUSD       E DS                  EXTNAME(SDECUPRPD)
006890200529      * Error indicators
006900200529
006910200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR 'BEFORE UPDATE' CUSTOMER
006920200529     D B_CUSTD       E DS                  EXTNAME(SDCUSTPD)
006930200529     D                                     PREFIX(B_)
006940200529
006950200529      **  CUSTOMERS FILE
006960200529     D CUSTDF        E DS                  EXTNAME(SDCUSTPD)
006970200529     D CUSTDF2       E DS                  EXTNAME(SDCUSTPD)                                  CGL132
006980200529     D                                     PREFIX(N_)                                         CGL132
006990200529
007000200529
007010200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID BASE RATE TAX
007020200529     D SDVCUBR       E DS                  EXTNAME(SDVCUBRPD)
007030200529     D SDVCUBRsh               1    717                                                       CSD012
007040200529
007050200529     D SDFTCS        E DS                  EXTNAME(SDFTCSPD)                                  CGL132
007060200529     D SDFTCS2       E DS                  EXTNAME(SDFTCSPD)                                  CGL132
007070200529     D                                     PREFIX(N_)                                         CGL132
007080200529     D SDCUXC        E DS                  EXTNAME(SDCUSTXC)                                MD026854
007090200529     D SDCUXC2       E DS                  EXTNAME(SDCUSTXC)                                MD026854
007100200529     D                                     PREFIX(N_)                                       MD026854
007110200529                                                                                            MD026854
007120200529      ** Externally described data structure for valid                                        CGL132
007130200529      ** FATCA customer details file                                                          CGL132
007140200529     D SDVFTCS       E DS                  EXTNAME(SDVFTCSPD)                                 CGL132
007150200529     D                                     PREFIX(A_)                                         CGL132
007160200529                                                                                              CGL132
007170200529     D DSLDY         E DS                  EXTNAME(DSLDY)                                     CGL132
007180200529                                                                                              CGL132
007190200529      ** Transaction Details in File Format                                                   CGL157
007200200529     D CrsdFilFmt    E DS                  EXTNAME(SDCRSHPD)                                  CGL157
007210200529     D                                     PREFIX(A_)                                         CGL157
007220200529      **  BASE RATE TAX DETAILS FILE
007230200529     D SDCBRTF       E DS                  EXTNAME(SDCBRTPD)
007240200529
007250200529      **  BRT PARTICIPATOR HISTORY FILE
007260200529     D SDPTYHSF      E DS                  EXTNAME(PTYHSTPD)
007270200529     D PTY_RECI      E                     EXTFLD(XRECI)
007280200529     D PTY_CNUM      E                     EXTFLD(XCNUM)
007290200529     D PTY_LCD       E                     EXTFLD(XLCD)
007300200529     D PTY_CHTP      E                     EXTFLD(XCHTP)
007310200529     D PTY_TNLU      E                     EXTFLD(XTNLU)
007320200529
007330200529
007340200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID PRIVATE BANKING DET
007350200529     D SDVCUPB       E DS                  EXTNAME(SDVCUPBPD)
007360200529     D                                     PREFIX(A_)
007370200529      **  Externally Described Data Structure For Valid TI details                           BUG3362
007380200529     D SDVTID        E DS                  EXTNAME(SDVTICDPD)                                BUG3362
007390200529     D                                     PREFIX(A_)                                        BUG3362
007400200529      **  TI Customer Details file                                                           BUG3362
007410200529     D SDTICDF       E DS                  EXTNAME(SDTICSPD)                                 BUG3362
007420200529      **  Customer Extension SWIFT Details File                                             BUG14969
007430200529     D SDCSSWDF      E DS                  EXTNAME(SDCSSWPD)                                BUG14969
007440200529     D                                     PREFIX(R_)                                       BUG14969
007450200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID Shadow CUSTOMER                       CSD012
007460200529     D SDVCDSH       E DS                  EXTNAME(SDCDSHPD)                                  CSD012
007470200529     D                                     PREFIX(T_)                                         CSD012
007480200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID Shadaow BRT CUSTOMER                  CSD012
007490200529     D SDVCBSH       E DS                  EXTNAME(SDCBSHPD)                                  CSD012
007500200529     D                                     PREFIX(T_)                                         CSD012
007510200529      **  EXTERNALLY DESCRIBED DATA STRUCTURE FOR VALID Shadow PB CUSTOMER                    CSD012
007520200529     D SDVPBSH       E DS                  EXTNAME(SDPBSHPD)                                  CSD012
007530200529     D                                     PREFIX(T_)                                         CSD012
007540200529      **  Externally Described Data Structure for Valid TI shadow files                      BUG3362
007550200529     D SDVTDSH       E DS                  EXTNAME(SDTDSHPD)                                 BUG3362
007560200529     D                                     PREFIX(T_)                                        BUG3362
007570200529      **  Externally Described Data Structure for Valid Customer Extension                  BUG14969
007580200529      **  SWIFT Details shadow files                                                        BUG14969
007590200529     D SDVSWSH       E DS                  EXTNAME(SDSWSHPD)                                BUG14969
007600200529     D                                     PREFIX(T_)                                       BUG14969
007610200529
007620200529      **  PRIVATE BANKING DETAILS FILE
007630200529     D*SDCPRBF       E DS                  EXTNAME(SDPBDSPD)
007640200529
007650200529      * DATA STRUCTURES FOR USE WITH ACCESS PROGRAMS
007660200529
007670200529     D SDBANK        E DS                  EXTNAME(SDBANKPD)
007680200529      * DATA STRUCTURE FOR BANK DETAILS
007690200529
007700200529     D SDGELR        E DS                  EXTNAME(SDGELRPD)
007710200529      * DATA STRUCTURE FOR General Ledger Details
007720200529
007730200529     D SDMMOD        E DS                  EXTNAME(SDMMODPD)
007740200529      * DATA STRUCTURE FOR Midas Modules Details
007750200529
007760200529     D SDSTRD        E DS                  EXTNAME(SDSTRDPD)
007770200529      * DATA STRUCTURE FOR SECURITIES TRADING DETAILS
007780200529
007790200529     D SDPORT        E DS                  EXTNAME(SDPORTPD)
007800200529      * DATA STRUCTURE FOR PORTOLIO MANAGEMENT DETAILS
007810200529
007820200529     D SDSECS        E DS                  EXTNAME(SDSECSPD)
007830200529      * DATA STRUCTURE FOR SECURITIES CUSTOMER DETAILS
007840200529     D  OldAcntCode  E                     EXTFLD(QQACCD)                                     CGL029
007850200529
007860200529     D SDCURR        E DS                  EXTNAME(SDCURRPD)
007870200529      * DATA STRUCTURE FOR CURRENCY DETAILS
007880200529
007890200529     D DSFDY         E DS                  EXTNAME(DSFDY)
007900200529      * FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
007910200529
007920200529     D DSSDY         E DS                  EXTNAME(DSSDY)
007930200529      * SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
007940200529
007950200529      ** SD data area                                                                         CSC011
007960200529     D SDSTAT        E DS                  EXTNAME(SDSTAT) DTAARA(SDSTAT)                     CSC011
007970200529                                                                                              CSC011
007980200529      ** 24X7 status data area                                                                CSC011
007990200529     D SC24X7        E DS                  EXTNAME(SC24X7) DTAARA(SC24X7)                     CSC011
008000200529                                                                                              CSC011
008010200529      ** Midas API Message Header Format Definition                                           CSC011
008020200529     D APHEAD        E DS                  EXTNAME(APHEADPD)                                  CSC011
008030200529                                                                                              CSC011
008040200529      ** Data Structure for SAR Details                                                       CSC011
008050200529     D SCSARD        E DS                  EXTNAME(SCSARDPD)                                  CSC011
008060200529                                                                                              CSC011
008070200529      ** Private Banking Details File                                                         CSC011
008080200529     D SDPBDF        E DS                  EXTNAME(SDPBDSPD)                                  CSC011
008090200529     D                                     PREFIX(W_)                                         CSC011
008100200529                                                                                              CSC011
008110200529      ** Private Banking Details File                                                         CSD012
008120200529     D SDPBDSDF      E DS                  EXTNAME(SDPBDSPD)                                  CSD012
008130200529     D                                     PREFIX(D_)                                         CSD012
008140200529                                                                                              CSD012
008150200529                                                                                              CSD015
008160200529      ** Data Structure for Watch List Checking Details                                       CSD015
008170200529     D SDWLCC        E DS                  EXTNAME(SDWLCCPD)                                  CSD015
008180200529                                                                                              CSD015
008190200529      ** Data Structure used as first parameter for the Compliance Engine                     CSD015
008200200529     D PDSWLTD       E DS                  EXTNAME(SDWLTDPD)                                  CSD015
008210200529                                                                                              CSD015
008220200529      ** Data Structure used as second parameter for the Compliance Engine                    CSD015
008230200529     D PDSXML          DS         30000                                                       CSD015
008240200529                                                                                              CSD015
008250200529      ** Data structure for Private Customer Industry Code                                    CSD015
008260200529     D WDSCWCD       E DS                  EXTNAME(SDCWCDPD)                                  CSD015
008270200529                                                                                              CSD015
008280200529      ** Ext. DS for Customer Marketing Info. Details in File Format                          CSD079
008290200529     D CUMIFilFmt    E DS                  EXTNAME(SDCMRKPD)                                  CSD079
008300200529     D                                     PREFIX(B1_)                                        CSD079
008310200529                                                                                              CSD079
008320200529      ** Ext. DS for Valid Customer Marketing Information                                     CSD079
008330200529     D SDVCUMI       E DS                  EXTNAME(SDVCUMIPD)                                 CSD079
008340200529     D                                     PREFIX(A_)                                         CSD079
008350200529                                                                                              CSD079
008360200529      ** Ext. DS for Before Update of Customer Marketing Information                          CSD079
008370200529     D B_CUMIF       E DS                  EXTNAME(SDCMRKPD)                                  CSD079
008380200529     D                                     PREFIX(B_)                                         CSD079
008390200529                                                                                              CSD079
008400200529      ** Customer Marketing Information File                                                  CSD079
008410200529     D CUMIF         E DS                  EXTNAME(SDCMRKPD)                                  CSD079
008420200529                                                                                              CSD079
008430200529      ** Ext. DS for Customer Additional Details in File Format                               CSD079
008440200529     D CUADFilFmt    E DS                  EXTNAME(SDACUSPD)                                  CSD079
008450200529     D                                     PREFIX(B3_)                                        CSD079
008460200529                                                                                              CSD079
008470200529      ** Ext. DS for Valid Customer Additional Details                                        CSD079
008480200529     D SDVCUAD       E DS                  EXTNAME(SDVCUADPD)                                 CSD079
008490200529     D                                     PREFIX(A_)                                         CSD079
008500200529                                                                                              CSD079
008510200529      ** Ext. DS for Before Update of Customer Additional Details                             CSD079
008520200529     D B_CUADF       E DS                  EXTNAME(SDACUSPD)                                  CSD079
008530200529     D                                     PREFIX(B_)                                         CSD079
008540200529                                                                                              CSD079
008550200529      ** Customer Additional Details File                                                     CSD079
008560200529     D CUADF         E DS                  EXTNAME(SDACUSPD)                                  CSD079
008570200529                                                                                              CSD079
008580200529      ** Ext. DS for Customer Service Fees Details in File Format                             CSD079
008590200529     D CUFEFilFmt    E DS                  EXTNAME(SDCFCDPD)                                  CSD079
008600200529     D                                     PREFIX(B5_)                                        CSD079
008610200529                                                                                              CSD079
008620200529      ** Ext. DS for Valid Customer Service Fees Details                                      CSD079
008630200529     D SDVCUFE       E DS                  EXTNAME(SDVSFEEPD)                                 CSD079
008640200529     D                                     PREFIX(F_)                                         CSD079
008650200529                                                                                              CSD079
008660200529      ** Ext. DS for Before Update of Customer Service Fees Details                           CSD079
008670200529     D B_CUFEF       E DS                  EXTNAME(SDCFCDPD)                                  CSD079
008680200529     D                                     PREFIX(B_)                                         CSD079
008690200529                                                                                              CSD079
008700200529      ** Customer Service Fees Details File                                                   CSD079
008710200529     D CUFEF         E DS                  EXTNAME(SDCFCDPD)                                  CSD079
008720200529                                                                                              CSD079
008730200529      ** Ext. DS for Customer Cheques & Cards Details in File Format                          CSD079
008740200529     D CUCQFilFmt    E DS                  EXTNAME(SDCHEQPD)                                  CSD079
008750200529     D                                     PREFIX(B7_)                                        CSD079
008760200529                                                                                              CSD079
008770200529      ** Ext. DS for Valid Customer Cheques & Cards Details                                   CSD079
008780200529     D SDVCUCQ       E DS                  EXTNAME(SDVCHECPD)                                 CSD079
008790200529     D                                     PREFIX(A_)                                         CSD079
008800200529                                                                                              CSD079
008810200529      ** Ext. DS for Before Update of Customer Cheques & Cards Details                        CSD079
008820200529     D B_CUCQF       E DS                  EXTNAME(SDCHEQPD)                                  CSD079
008830200529     D                                     PREFIX(B_)                                         CSD079
008840200529                                                                                              CSD079
008850200529      ** Customer Cheques & Cards Details File                                                CSD079
008860200529     D CUCQF         E DS                  EXTNAME(SDCHEQPD)                                  CSD079
008870200529                                                                                              CSD079
008880200529      ** Ext. DS for Customer Safes Details in File Format                                    CSD079
008890200529     D CUSFFilFmt    E DS                  EXTNAME(SDSAFEPD)                                  CSD079
008900200529     D                                     PREFIX(B9_)                                        CSD079
008910200529                                                                                              CSD079
008920200529      ** Ext. DS for Valid Customer Safes Details                                             CSD079
008930200529     D SDVCUSF       E DS                  EXTNAME(SDVCUSFPD)                                 CSD079
008940200529     D                                     PREFIX(A_)                                         CSD079
008950200529                                                                                              CSD079
008960200529      ** Ext. DS for Before Update of Customer Safes Details                                  CSD079
008970200529     D B_CUSFF       E DS                  EXTNAME(SDSAFEPD)                                  CSD079
008980200529     D                                     PREFIX(B_)                                         CSD079
008990200529                                                                                              CSD079
009000200529      ** Customer Safes Details File                                                          CSD079
009010200529     D CUSFF         E DS                  EXTNAME(SDSAFEPD)                                  CSD079
009020200529                                                                                              CSD079
009030200529      ** Ext. DS for Customer Risk Weighted Assets Details in File Format                     CSD079
009040200529     D CURWFilFmt    E DS                  EXTNAME(SDCRWAPD)                                  CSD079
009050200529     D                                     PREFIX(B11_)                                       CSD079
009060200529                                                                                              CSD079
009070200529      ** Ext. DS for Valid Customer Risk Weighted Assets Details                              CSD079
009080200529     D SDVCURW       E DS                  EXTNAME(SDVRWANPD)                                 CSD079
009090200529     D                                     PREFIX(A_)                                         CSD079
009100200529                                                                                              CSD079
009110200529      ** Ext. DS for Before Update of Customer Risk Weighted Assets Details                   CSD079
009120200529     D B_CURWF       E DS                  EXTNAME(SDCRWAPD)                                  CSD079
009130200529     D                                     PREFIX(B_)                                         CSD079
009140200529                                                                                              CSD079
009150200529      ** Customer Risk Weighted Assets Details File                                           CSD079
009160200529     D CURWF         E DS                  EXTNAME(SDCRWAPD)                                  CSD079
009170200529                                                                                              CSD079
009180200529      ** Ext. DS for Customer Futures & Option Details in File Format                         CSD079
009190200529     D CUFOFilFmt    E DS                  EXTNAME(SDFOCSPD)                                  CSD079
009200200529     D                                     PREFIX(B13_)                                       CSD079
009210200529                                                                                              CSD079
009220200529      ** Ext. DS for Valid Customer Futures & Option Details                                  CSD079
009230200529     D SDVCUFO       E DS                  EXTNAME(SDVCUFOPD)                                 CSD079
009240200529     D                                     PREFIX(A_)                                         CSD079
009250200529                                                                                              CSD079
009260200529      ** Ext. DS for Before Update of Customer Futures & Option Details                       CSD079
009270200529     D B_CUFOF       E DS                  EXTNAME(SDFOCSPD)                                  CSD079
009280200529     D                                     PREFIX(B_)                                         CSD079
009290200529     D  B_QQQMAC     E                     EXTFLD(QQSMAC)                                     CSD079
009300200529                                                                                              CSD079
009310200529      ** Customer Futures & Option Details File                                               CSD079
009320200529     D CUFOF         E DS                  EXTNAME(SDFOCSPD)                                  CSD079
009330200529     D    QQQMAC     E                     EXTFLD(QQSMAC)                                     CSD079
009340200529                                                                                              CSD079
009350200529      ** Ext. DS for MIDAS/ABS FF Customers Maintenance in File Format                        CSD079
009360200529     D CUFFFilFmt    E DS                  EXTNAME(SDFOX1PD)                                  CSD079
009370200529                                                                                              CSD079
009380200529      ** Ext. DS for Valid MIDAS/ABS FF Customers Maintenance Details                         CSD079
009390200529     D SDVCUFF       E DS                  EXTNAME(SDVFOX1PD)                                 CSD079
009400200529                                                                                              CSD079
009410200529      ** Ext. DS for Before Update of MIDAS/ABS FF Customers Maintenance Details              CSD079
009420200529     D B_CUFF        E DS                  EXTNAME(SDFOX1PD)                                  CSD079
009430200529     D                                     PREFIX(B21_)                                       CSD079
009440200529                                                                                              CSD079
009450200529     ** MIDAS/ABS FF Customers Maintenance Details File                                       CSD079
009460200529     D CUFF          E DS                  EXTNAME(SDFOX1PD)                                  CSD079
009470200529     D                                     PREFIX(B22_)                                       CSD079
009480200529                                                                                              CSD079
009490200529      ** Ext. DS for Customer Portfolio Mgmt. Details in File Format                          CSD079
009500200529     D CUPMFilFmt    E DS                  EXTNAME(SDPLCSPD)                                  CSD079
009510200529     D                                     PREFIX(B15_)                                       CSD079
009520200529                                                                                              CSD079
009530200529      ** Ext. DS for Valid Customer Portfolio Mgmt. Details                                   CSD079
009540200529     D SDVCUPM       E DS                  EXTNAME(SDVCUPMPD)                                 CSD079
009550200529     D                                     PREFIX(A_)                                         CSD079
009560200529                                                                                              CSD079
009570200529      ** Ext. DS for Before Update of Customer Portfolio Mgmt. Details                        CSD079
009580200529     D B_CUPMF       E DS                  EXTNAME(SDPLCSPD)                                  CSD079
009590200529     D                                     PREFIX(A_)                                         CSD079
009600200529                                                                                              CSD079
009610200529      ** Customer Portfolio Mgmt. Details File                                                CSD079
009620200529     D CUPMF         E DS                  EXTNAME(SDPLCSPD)                                  CSD079
009630200529                                                                                              CSD079
009640200529      ** Ext. DS for Lux(European Reporting)Customer Details in File Format                   CSD079
009650200529     D CueuFilFmt    E DS                  EXTNAME(SDCUX2PD)                                  CSD079
009660200529                                                                                              CSD079
009670200529      ** Ext. DS for Lux(European Reporting)Customer Details in valid format                  CSD079
009680200529     D SDVCUEU       E DS                  EXTNAME(SDVCULX2PD)                                CSD079
009690200529     D                                     PREFIX(A_)                                         CSD079
009700200529                                                                                              CSD079
009710200529      ** Lux(European Reporting)Customer Details File format                                  CSD079
009720200529     D CUEUF         E DS                  EXTNAME(SDCUX2PD)                                  CSD079
009730200529     D                                     PREFIX(R_)                                         CSD079
009740200529                                                                                              CSD079
009750200529      ** Ext. DS for Before Update of Lux(European Reporting) File format                     CSD079
009760200529     D B_CUEUF       E DS                  EXTNAME(SDCUX2PD)                                  CSD079
009770200529     D                                     PREFIX(B_)                                         CSD079
009780200529                                                                                              CSD079
009790200529      ** Ext. DS for Lux(IBLC - Extended Information) in File Format                          CSD079
009800200529     D CuibfFilFmt   E DS                  EXTNAME(SDCUX1PD)                                  CSD079
009810200529                                                                                              CSD079
009820200529      ** Ext. DS for Lux(IBLC - Extended Information)Details in valid format                  CSD079
009830200529     D SDVCUIB       E DS                  EXTNAME(SDVCULX1PD)                                CSD079
009840200529     D                                     PREFIX(A_)                                         CSD079
009850200529                                                                                              CSD079
009860200529     D TranInCUAH    E DS                  EXTNAME (SDCUAHDPD)                                CER059
009870200529     D                                     PREFIX(AH)                                         CER059
009880200529     D TranInCCTX    E DS                  EXTNAME (SDCCTXDPD)                                CER059
009890200529     D                                     PREFIX(TX)                                         CER059
009900200529                                                                                              CER059
009910200529      ** Lux(IBLC - Extended Information)Customer Details File format                         CSD079
009920200529     D CUIBF         E DS                  EXTNAME(SDCUX1PD)                                  CSD079
009930200529     D                                     PREFIX(S_)                                         CSD079
009940200529                                                                                              CSD079
009950200529      ** Ext. DS for Before Update of Lux(IBLC - Extended Information) File format            CSD079
009960200529     D B_CUIBF       E DS                  EXTNAME(SDCUX1PD)                                  CSD079
009970200529     D                                     PREFIX(B_)                                         CSD079
009980200529                                                                                              CSD079
009990200529     D SDVSW13       E DS                  EXTNAME(SDSW13PD)                                  CFT050
010000200529     D                                     PREFIX(S13)                                        CFT050
010010200529     D TranInPrim    E DS                  EXTNAME(SDCUPRPD)                                  CFT050
010020200529     D TranInSeco    E DS                  EXTNAME(SDCUSEPD)                                  CFT050
010030200529     D TranInMT3X    E DS                  EXTNAME(SDCUMTPD)                                  CFT050
010040200529     D***ZMUSER*       DS            17                                            MD026835 MD027492
010050200529     D**WUSRID**               1     10                                            MD026835 MD027492
010060200529     D/COPY WNCPYSRC,SDCUSDDD02
010070200529      ** Ext. DS for Curency/Time of Netting Details in File Format                        AR1086546
010080200529     D*CTNMFilFmt    E DS                  EXTNAME(SDCTNMPD)                     AR1086546 MD038401B
010090200529     D CTNMFilFmt    E DS                  EXTNAME(SDVCTNMPD)                              MD038401B
010100200529     D                                     PREFIX(NF_)                                     AR1086546
010110200529                                                                                           AR1086546
010120200529      ** Ext. DS for Valid Curency/Time of Netting Details                                 AR1086546
010130200529     D SDVCTNM       E DS                  EXTNAME(SDVCTNMPD)                              AR1086546
010140200529     D                                     PREFIX(NV_)                                     AR1086546
010150200529                                                                                           AR1086546
010160200529      ** Ext. DS for Before Update of Valid Curency/Time of Netting Details                AR1086546
010170200529     D B_CTNMF       E DS                  EXTNAME(SDCTNMPD)                               AR1086546
010180200529     D                                     PREFIX(NB_)                                     AR1086546
010190200529                                                                                           AR1086546
010200200529      ** Valid Curency/Time of Netting Details File                                        AR1086546
010210200529     D CTNMF         E DS                  EXTNAME(SDCTNMPD)                               AR1086546
010220200529                                                                                           AR1086546
010230200529      ** Dummy message ID and message file fields for use on the calls to
010240200529      ** ZAMSGTOOPR
010250200529     D DummyMsgID      S                   LIKE(#MsgID)
010260200529     D DummyMsgF       S             10A
010270200529
010280200529      * Outward parameters
010290200529      * RCD : Midas SD Deleted records file retrieval
010300200529     D PBRC            DS          3064
010310200529      * I :  File name
010320200529     D    PBFNME               1     10
010330200529      * I :  Long Key
010340200529     D    PBLKEY              11     60
010350200529      * I :  Deleted Data Record Pt1
010360200529     D    PBDR01              61    310
010370200529      * I :  Deleted Data Record Pt2
010380200529     D    PBDR02             311    560
010390200529      * I :  Deleted Data Record Pt3
010400200529     D    PBDR03             561    810
010410200529      * I :  Deleted Data Record Pt4
010420200529     D    PBDR04             811   1060
010430200529      * I :  Deleted Data Record Pt5
010440200529     D    PBDR05            1061   1310
010450200529      * I :  Deleted Data Record Pt6
010460200529     D    PBDR06            1311   1560
010470200529      * I :  Deleted Data Record Pt7
010480200529     D    PBDR07            1561   1810
010490200529      * I :  Deleted Data Record Pt8
010500200529     D    PBDR08            1811   2060
010510200529      * I :  Deleted Data Record Pt9
010520200529     D    PBDR09            2061   2310
010530200529      * I :  Deleted Data Record Pt10
010540200529     D    PBDR10            2311   2560
010550200529      * I :  Deleted Data Record Pt11
010560200529     D    PBDR11            2561   2810
010570200529      * I :  Deleted Data Record Pt12
010580200529     D    PBDR12            2811   3060
010590200529      * I :  Last Change Date
010600200529     D    PBLCD             3061   3063P 0
010610200529      * I :  Type of Last Change
010620200529     D    PBTYLC            3064   3064
010630200529
010640200529     D WUDELR          DS          3000
010650200529     D    WUDR01               1    250
010660200529     D    WUDR02             251    500
010670200529     D    WUDR03             501    750
010680200529     D    WUDR04             751   1000
010690200529     D    WUDR05            1001   1250
010700200529     D    WUDR06            1251   1500
010710200529     D    WUDR07            1501   1750
010720200529     D    WUDR08            1751   2000
010730200529     D    WUDR09            2001   2250
010740200529     D    WUDR10            2251   2500
010750200529     D    WUDR11            2501   2750
010760200529     D    WUDR12            2751   3000
010770200529
010780200529     D @Timestamp      S             26Z
010790200529
010800200529
010810200529     D                 DS
010820200529     D TDATE                   1      6
010830200529     D TDAY                    1      2
010840200529     D TMONTH                  3      4
010850200529     D TYEAR                   5      6
010860200529
010870200529     D                 DS
010880200529     D  DATE                   1      6
010890200529     D  DAY                    1      2  0
010900200529     D  MONTH                  3      4  0
010910200529     D  YEAR                   5      6  0
010920200529
010930200529     D LFLG            S              1    DIM(10)
010940200529      ** Liable Flag Array
010950200529
010960200529     D                 DS
010970200529      ** Effective dates array and DS
010980200529     D  EFFLDA                 1     30
010990200529     D  EFLD                   1     30P 0 INZ(0)
011000200529     D                                     DIM(10)                              EFFECT. DATE ARR
011010200529
011020200529     D                 DS
011030200529      ** Liability change dates array and DS
011040200529     D  LCHGDA                 1     30
011050200529     D  LCHD                   1     30P 0 INZ(0)
011060200529     D                                     DIM(10)                              LIAB.CHG. DTE ARR
011070200529      *                                                                                       252069
011080200529      ** File information data structure                                                      252069
011090200529      *                                                                                       252069
011100200529     DDSPDS            DS                                                                     252069
011110200529     D STATUS            *STATUS                                                              252069
011120200529                                                                                              CGL132
011130200529      ** Parameter variables for AOSVALR0 string                                              CGL132
011140200529     D SValK1          S             20                                                       CGL132
011150200529     D SVal1           S            200                                                       CGL132
011160200529     D SValK2          S             20                                                       CGL132
011170200529     D SVal2           S            200                                                       CGL132
011180200529     D SValK3          S             20                                                       CGL132
011190200529     D SVal3           S            200                                                       CGL132
011200200529     D SValK4          S             20                                                       CGL132
011210200529     D SVal4           S            200                                                       CGL132
011220200529     D SValK5          S             20                                                       CGL132
011230200529     D SVal5           S            200                                                       CGL132
011240200529     D SValK6          S             20                                                       CGL132
011250200529     D SVal6           S            200                                                       CGL132
011260200529     D SValK7          S             20                                                       CGL132
011270200529     D SVal7           S            200                                                       CGL132
011280200529     D SValK8          S             20                                                       CGL132
011290200529     D SVal8           S            200                                                       CGL132
011300200529     D SValK9          S             20                                                       CGL132
011310200529     D SVal9           S            200                                                       CGL132
011320200529     D SValK0          S             20                                                       CGL132
011330200529     D SVal10          S            200                                                       CGL132
011340200529     D KCUST           S              6A                                                      CGL132
011350200529     D KSCDT           S              5P 0                                                    CGL132
011360200529     D KSEQN           S              3S 0                                                    CGL132
011370200529     D AVSEQN          S              3S 0                                                    CGL132
011380200529     D WWTMST          S             26Z                                                      CGL132
011390200529     D XBefCRSD        S           5000A                                                    MD041429
011400200529     D XAftCRSD        S           5000A                                                    MD041429
011410200529                                                                                              CSC011
011420200529      ** Fields defined for Enhancement CSC011                                                CSC011
011430200529                                                                                              CSC011
011440200529     D CSC011          S              1A                                                      CSC011
011450200529     D TRANSDTL        S           5800A                                                      CSC011
011460200529     D***PCustNum        S             18A                                             CSC011 CGL029
011470200529     D***PACustNo        S             18A                                             CSC011 CGL029
011480200529     D PCustNum        S             24A                                                      CGL029
011490200529     D PACustNo        S             24A                                                      CGL029
011500200529     D PTimestamp      S             26A                                                      CSC011
011510200529     D PRtCd           S              7A                                                      CSC011
011520200529     D POptn           S              7A                                                      CSC011
011530200529     D PSard           S              6A                                                      CSC011
011540200529     D WCust           S              6A                                                      CSC011
011550200529                                                                                              CSD021
011560200529     D CSD021          S              1A                                                      CSD021
011570200529     D CSD090          S              1A                                                      CSD090
011580200529     D*New_CNUM*****   S              6  0                                             CSD021 CSD027
011590200529     D New_CNUM        S              6A                                                      CSD027
011600200529     D New_CNUMOK      S              1A                                                      CSD021
011610200529     D CGL132          S              1A                                                      CGL132
011620200529     D CGL133          S              1A                                                      CGL132
011630200529     D WWHVAC          S              1A                                                      CGL132
011640200529
011650200529      ** Fields defined for Enhancement CSD012 used for SDAULGL3                              CSC011
011660200529     D FUNCD           C                   CONST('CUSTOMER DETAILS')                          CSD012
011670200529      ***Override*SDCDSHL0,*SDCBSHL0*&*SDPBSHL0****************************           CSD012 BUG3362
011680200529      ** Override SDCDSHL0, SDCBSHL0, SDPBSHL0 and SDTDSHL0                                  BUG3362
011690200529     D CMD1            S              1    DIM(50) CTDATA PERRCD(50)                          CSD012
011700200529     D CMD2            S              1    DIM(50) CTDATA PERRCD(50)                          CSD012
011710200529     D CMD3            S              1    DIM(50) CTDATA PERRCD(50)                          CSD012
011720200529     D CMD4            S              1    DIM(50) CTDATA PERRCD(50)                         BUG3362
011730200529     D CMD5            S              1    DIM(50) CTDATA PERRCD(50)                        BUG14969
011740200529     D CMDXC           S             50    DIM(1) CTDATA PERRCD(1)                            CGL132
011750200529     D CMDNH           S             50    DIM(1) CTDATA PERRCD(1)                          MD027115
011760200529     D CMDCS           S             50    DIM(1) CTDATA PERRCD(1)                          MD027115
011770200529     D CMDCR           S             50    DIM(1) CTDATA PERRCD(1)                          MD051230
011780200529                                                                                              CSD015
011790200529      ** Array containing the tags for the XML format parameter                               CSD015
011800200529     D****ARRTAG       S             40    DIM(10) CTDATA                              CSD015 CSD079
011810200529     D ARRTAG          S             40    DIM(14) CTDATA                                     CSD079
011820200529                                                                                              CSD027
011830200529      ** Array for "Adding" 1 to the Alphanumeric customer number                             CSD027
011840200529                                                                                              CSD027
011850200529     D #@VC            S              1    DIM(36) CTDATA PERRCD(36)                          CSD027
011860200529     D #@CN            S              1    DIM(6)                                             CSD027
011870200529                                                                                              CSD015
011880200529      ** Fields defined for Enhancement CSD015                                                CSD015
011890200529                                                                                              CSD015
011900200529     D PFNCCD          S              8A                                                      CSD015
011910200529     D WFUNCTYPE       S              8A                                                      CSD015
011920200529     D WIDNTIFIER      S             40A                                                      CSD015
011930200529     D WBRANCH         S              3A                                                      CSD015
011940200529     D CCF001          S              1A                                                      CSD015
011950200529     D CSD015          S              1A                                                      CSD015
011960200529     D PINDATE         S              5A                                                      CSD015
011970200529     D POUTDATE        S               D                                                      CSD015
011980200529     D PCVTDDATE       S             10A                                                      CSD015
011990200529     D WADDAL          S            100A                                                      CSD015
012000200529     D WUNCF1          S              1A                                                      CSD015
012010200529                                                                                              CGP001
012020200529     D K_BRCD          S              3A                                                      CGP001
012030200529     D K_CUST          S              6A                                                      CGP001
012040200529                                                                                              CGP001
012050200529     D CFX001          S              1                                                       CFX001
012060200529     D CLE025          S              1                                                       CLE025
012070200529                                                                                              CLE025
012080200529     D                 DS                                                                     CSD023
012090200529     D**w0cnum***              1      6  0                                             CSD023 CSD027
012100200529     D  w0cnum                 1      6                                                       CSD027
012110200529     D  w0ccy                  7      9                                                       CSD023
012120200529     D  w0acod                10     19  0                                                    CSD023
012130200529     D  w0acsq                20     21  0                                                    CSD023
012140200529     D  w0brca                22     24                                                       CSD023
012150200529                                                                                              CSD023
012160200529     D                 DS                                                                     CSD023
012170200529     D w1accn                  1     24                                                       CSD023
012180200529     D  w1brca                 1      3                                                       CSD023
012190200529     D**w1cnum****             4      9  0                                             CSD023 CSD027
012200200529     D  w1cnum                 4      9                                                       CSD027
012210200529     D  w1ccy                 10     12                                                       CSD023
012220200529     D  w1acod                13     22  0                                                    CSD023
012230200529     D  w1acsq                23     24  0                                                    CSD023
012240200529                                                                                              CSD023
012250200529     D***PAccMde       S              1A                                             CSD031 BUG13525
012260200529     D***PUpdYN*       S              1A                                             CSD031 BUG13525
012270200529     D***PChkAccMde    S              1A                                             CSD031 BUG13525
012280200529     D***PChkUpdYN     S              1A                                             CSD031 BUG13525
012290200529     D PAccMde         S              1A                                                    BUG15872
012300200529     D PUpdYN          S              1A                                                    BUG15872
012310200529     D PChkAccMde      S              1A                                                    BUG15872
012320200529     D PChkUpdYN       S              1A                                                    BUG15872
012330200529     D***CSD037*       S              1A   INZ('N')                  C                SD031 BUG13525
012340200529                                                                                              CSD031
012350200529      ** Variables used by CSD079                                                             CSD079
012360200529     D WUPMSC          S              1A                                                      CSD079
012370200529     D WQ0035          S              7A                                                      CSD079
012380200529     D WQ0036          S              8A                                                      CSD079
012390200529     D WQ0037          S              6A                                                      CSD079
012400200529     D WQ0038          S              2A                                                      CSD079
012410200529     D WQ0039          S              4A                                                      CSD079
012420200529     D WQ0040          S              4A                                                      CSD079
012430200529     D WQ0041          S              4A                                                      CSD079
012440200529     D WQ0042          S             10A                                                      CSD079
012450200529     D WQ0086          S              7A                                                      CSD079
012460200529     D WQ0087          S              6A                                                      CSD079
012470200529     D WQ0088          S              3A                                                      CSD079
012480200529     D WQ0089          S              1A                                                      CSD079
012490200529     D WQ0090          S              2P 0                                                    CSD079
012500200529     D WQ0091          S              5P 0                                                    CSD079
012510200529     D WQ0092          S             10A                                                      CSD079
012520200529     D WQ0093          S              1A                                                      CSD079
012530200529     D WQ0094          S              2A                                                      CSD079
012540200529     D WQ0095          S             18A                                                      CSD079
012550200529     D WQ0096          S              8A                                                      CSD079
012560200529     D WQ0097          S              1A                                                      CSD079
012570200529     D WQ0098          S             20A                                                      CSD079
012580200529     D WQ0099          S              1A                                                      CSD079
012590200529     D WQ0100          S              5P 0                                                    CSD079
012600200529     D WQ0101          S              1A                                                      CSD079
012610200529     D WQ0102          S              2P 0                                                    CSD079
012620200529     D WQ0103          S              5P 0                                                    CSD079
012630200529     D WQ0104          S              1A                                                      CSD079
012640200529     D WQ0105          S              1A                                                      CSD079
012650200529     D WQ0106          S             20A                                                      CSD079
012660200529     D WQ0107          S              2P 0                                                    CSD079
012670200529     D WQ0108          S              3A                                                      CSD079
012680200529     D WQ0109          S              1A                                                      CSD079
012690200529     D WQ0110          S              5P 0                                                    CSD079
012700200529     D #1DFPO          S              4A                                                      CSD079
012710200529     D WURITD          S              1A                                                      CSD079
012720200529     D From_Cust       S              1A                                                      CSD079
012730200529     D WFIND           S              1A                                                      CSD079
012740200529     D ZDATE           S              6P 0                                                    CSD079
012750200529
012760200529      *
012770200529     D/COPY WNCPYSRC,SDCUSDDD01
012780200529
012790200529
012800200529      ** Swift installed flag                                                                 CSW207
012810200529     D CSW207          S              1A                                                      CSW207
012820200529     D CFT050          S              1A                                                      CFT050
012830200529     D CSW213          S              1A                                                    MD028198
012840200529                                                                                              CSD092
012850200529     D CSD092          S              1A   INZ('N')                                           CSD092
012860200529     D PCUST           S              6A                                                      CSD092
012870200529     D PCustNo         S              6A                                                      CGL132
012880200529     D WCTAX           S              2A                                                      CGL132
012890200529     D PBefCUST        S           5000A                                                      CSD092
012900200529     D PAftCUST        S           5000A                                                      CSD092
012910200529     D PBefACUS        S           5000A                                                      CSD092
012920200529     D PAftACUS        S           5000A                                                      CSD092
012930200529     D PBefFTCS        S           5000A                                                      CGL132
012940200529     D PAftFTCS        S           5000A                                                      CGL132
012950200529     D PBefJACC        S           5000A                                                      CSD092
012960200529     D PAftJACC        S           5000A                                                      CSD092
012970200529     D PBefCUAH        S           5000A                                                      CSD092
012980200529     D PAftCUAH        S           5000A                                                      CSD092
012990200529     D PBefCUXC        S           5000A                                                    MD026854
013000200529     D PAftCUXC        S           5000A                                                    MD026854
013010200529     D PBefCRSH        S           5000A                                                      CGL177
013020200529     D PAftCRSH        S           5000A                                                      CGL177
013030200529     D PBefCRSD        S           5000A                                                      CGL177
013040200529     D PAftCRSD        S           5000A                                                      CGL177
013050200529     D PACRV           S              1A                                                      CSD092
013060200529     D PELEC           S              1A                                                      CGL132
013070200529     D WTime           S               T                                                      CGL132
013080200529     D WWTIME          S              6A                                                      CGL132
013090200529     D***WKUSER*       S             10A                                           MD026835 MD027492
013100200529     D WLUSER          S             10A                                                   MD026835A
013110200529     D CTI006          S              1A                                                    MD030956
013120200529     D PCommitCUSD     S              1A                                                    MD043029
013130200529     D PCommitNAHL     S              1A                                                    MD043029
013140200529     D PCrsdF          S            219A   DIM(30)                                            CGL177
013150200529     D PCrsdX          S            219A   DIM(30)                                            CGL177
013160200529     D PCrsdZ          S            219A                                                      CGL177
013170200529     D CGL157          S              1A                                                      CGL157
013180200529     D KCTRY           S              2A                                                      CGL157
013190200529     D X               S              2S 0                                                    CGL157
013200200529     D A               S              4S 0                                                    CGL177
013210200529
013220200529      /EJECT
013230200529     C*****************************************************************
013240200529     C*                                                               *
013250200529     C* MAIN - MAIN BODY                                              *
013260200529     C*                                                               *
013270200529     C*****************************************************************
013280200529
013290200529      ** Ensure transaction has not been updated by another workstation
013300200529      ** - if so, bypass updating and return to calling program.
013310200529     C                   EXSR      CHKOTHUPD
013320200529
013330200529     C     @@RTCD        IFNE      *BLANKS
013340200529     C                   GOTO      EXIT
013350200529     C                   END
013360200529      *                                                                                     AR679445
013370200529      ** Get User profile to populate Insert or Amend User                                  AR679445
013380200529      *                                                                                     AR679445
013390200529     C                   CALL      'SFC000026'                                              AR679445
013400200529     C                   PARM      *BLANKS       USER             10                        AR679445
013410200529      *                                                                                     AR679445
013420200529     C     *BLANKS       IFNE      USER                                                     AR679445
013430200529     C                   MOVE      USER          WKUSER           10                        AR679445
013440200529     C                   ELSE                                                               AR679445
013450200529     C                   MOVE      PSUSER        WKUSER                                     AR679445
013460200529     C                   ENDIF                                                              AR679445
013470200529      *                                                                                       CSD012
013480200529      * Auth Req is ON and Auth Mode is not 'X' .                                             CSD012
013490200529     C     AUTHRQ        IFEQ      'Y'                                                        CSD012
013500200529     C     AUTHMD        ANDNE     'X'                                                        CSD012
013510200529      *                                                                                       CSD012
013520200529     C                   MOVEL     'N'           YESUPDAT          1                          CSD012
013530200529     C                   MOVEL     'N'           WNewCust                                     CSD028
013540200529      *                                                                                       CSD012
013550200529     C                   MOVEL     A_CUTYLC      WorkCHTP          1                          CSD012
013560200529     C                   Z-ADD     A_CULCD       WorkLCD           5 0                        CSD012
013570200529     C                   MOVEL     *BLANK        A_CUTYLC                                     CSD012
013580200529     C                   Z-ADD     *ZERO         A_CULCD                                      CSD012
013590200529      *                                                                                       CSD012
013600200529     C     A_CUCUST      CHAIN     SDCUSTL0                           99                      CSD012
013610200529      *                                                                                       CSD012
013620200529     C     *IN99         IFEQ      *OFF                                                       CSD012
013630200529     C                   MOVEL     *BLANK        BBTYLC                                       CSD012
013640200529     C                   Z-ADD     *ZERO         BBLCD                                        CSD012
013650200529      *                                                                                       CSD012
013660200529     C     CUSTDF        IFEQ      SDVCUSD                                                    CSD012
013670200529     C     WorkCHTP      ANDEQ     'A'                                                        CSD012
013680200529     C                   MOVEL     'N'           YESUPDAT                                     CSD012
013690200529     C                   ELSE                                                                 CSD012
013700200529     C                   MOVEL     'Y'           YESUPDAT                                     CSD012
013710200529     C                   ENDIF                                                                CSD012
013720200529      *                                                                                       CSD012
013730200529     C                   ELSE                                                                 CSD012
013740200529     C                   MOVEL     'Y'           YESUPDAT                                     CSD012
013750200529      *                                                                                       CSD028
013760200529     C                   IF        CSD028 = 'Y'                                               CSD028
013770200529     C                   EVAL      WNewCust = 'Y'                                             CSD028
013780200529     C                   ENDIF                                                                CSD028
013790200529      *                                                                                       CSD028
013800200529     C                   ENDIF                                                                CSD012
013810200529      *                                                                                       CSD012
013820200529     C                   MOVEL     WorkCHTP      A_CUTYLC                                     CSD012
013830200529     C                   Z-ADD     WorkLCD       A_CULCD                                      CSD012
013840200529      *                                                                                       CSD012
013850200529     C     S01383        IFEQ      'Y'                                                        CSD012
013860200529      *                                                                                       CSD012
013870200529     C                   MOVEL     BRCHTP        WorkCHTP                                     CSD012
013880200529     C                   Z-ADD     BRXLCD        WorkLCD                                      CSD012
013890200529     C                   MOVEL     *BLANK        BRCHTP                                       CSD012
013900200529     C                   Z-ADD     *ZERO         BRXLCD                                       CSD012
013910200529      *                                                                                       CSD012
013920200529     C     BRCNUM        CHAIN     SDCBRTL1                           98                      CSD012
013930200529      *                                                                                       CSD012
013940200529     C     *IN98         IFEQ      *OFF                                                       CSD012
013950200529     C                   MOVEL     *BLANK        XCHTP                                        CSD012
013960200529     C                   Z-ADD     *ZERO         XLCD                                         CSD012
013970200529      *                                                                                       CSD012
013980200529     C     SDCBRTF       IFEQ      SDVCUBRsh                                                  CSD012
013990200529     C     WorkCHTP      ANDEQ     'A'                                                        CSD012
014000200529     C                   ELSE                                                                 CSD012
014010200529     C                   MOVEL     'Y'           YESUPDAT                                     CSD012
014020200529     C                   ENDIF                                                                CSD012
014030200529      *                                                                                       CSD012
014040200529     C                   ELSE                                                                 CSD012
014050200529     C                   MOVEL     'Y'           YESUPDAT                                     CSD012
014060200529     C                   ENDIF                                                                CSD012
014070200529      *                                                                                       CSD012
014080200529     C                   MOVEL     WorkCHTP      BRCHTP                                       CSD012
014090200529     C                   Z-ADD     WorkLCD       BRXLCD                                       CSD012
014100200529      *                                                                                       CSD012
014110200529     C                   ENDIF                                                                CSD012
014120200529      *                                                                                       CSD012
014130200529     C     BGN4ST        IFEQ      'Y'                                                        CSD012
014140200529      *                                                                                       CSD012
014150200529     C                   MOVE      A_CUTYLC      A_PBCHTP                                     CSD012
014160200529     C                   MOVE      A_PBCHTP      WorkCHTP                                     CSD012
014170200529     C                   MOVE      A_CUCUST      A_PBCNUM                                     CSD012
014180200529      *                                                                                       CSD012
014190200529     C     WorkCHTP      IFEQ      'I'                                                        CSD012
014200200529     C                   MOVE      BJRDNB        A_PBLCHD                                     CSD012
014210200529     C                   ENDIF                                                                CSD012
014220200529      *                                                                                       CSD012
014230200529     C                   Z-ADD     A_PBLCHD      WorkLCD                                      CSD012
014240200529     C                   MOVEL     *BLANK        A_PBCHTP                                     CSD012
014250200529     C                   Z-ADD     *ZERO         A_PBLCHD                                     CSD012
014260200529      *                                                                                       CSD012
014270200529     C     A_PBCNUM      CHAIN     SDPBDSL0                           98                      CSD012
014280200529      *                                                                                       CSD012
014290200529     C     *IN98         IFEQ      *OFF                                                       CSD012
014300200529     C                   MOVEL     *BLANK        D_PBCHTP                                     CSD012
014310200529     C                   Z-ADD     *ZERO         D_PBLCHD                                     CSD012
014320200529      *                                                                                       CSD012
014330200529     C     SDPBDSDF      IFEQ      SDVCUPB                                                    CSD012
014340200529     C     WorkCHTP      ANDEQ     'A'                                                        CSD012
014350200529     C                   ELSE                                                                 CSD012
014360200529     C                   MOVEL     'Y'           YESUPDAT                                     CSD012
014370200529     C                   ENDIF                                                                CSD012
014380200529      *                                                                                       CSD012
014390200529     C                   ELSE                                                                 CSD012
014400200529     C                   MOVEL     'Y'           YESUPDAT                                     CSD012
014410200529     C                   ENDIF                                                                CSD012
014420200529      *                                                                                       CSD012
014430200529     C                   MOVEL     WorkCHTP      A_PBCHTP                                     CSD012
014440200529     C                   Z-ADD     WorkLCD       A_PBLCHD                                     CSD012
014450200529      *                                                                                       CSD012
014460200529     C                   ENDIF                                                                CSD012
014470200529                                                                                            BUG14969
014480200529      ** Process Customer Extension SWIFT Details                                           BUG14969
014490200529                                                                                            BUG14969
014500200529     C                   EVAL      A_CUCUSD = A_CUCUST                                      BUG14969
014510200529     C     A_CUCUSD      CHAIN     SDCSSWL0                                                 BUG14969
014520200529     C                   IF        NOT %FOUND                                               BUG14969
014530200529     C                   EVAL      YESUPDAT = 'Y'                                           BUG14969
014540200529     C                   ELSE                                                               BUG14969
014550200529     C                   IF        SDCSSWDF = SDVSWSD AND WorkCHTP = 'A'                    BUG14969
014560200529     C                   ELSE                                                               BUG14969
014570200529     C                   EVAL      YESUPDAT = 'Y'                                           BUG14969
014580200529     C                   ENDIF                                                              BUG14969
014590200529     C                   ENDIF                                                              BUG14969
014600200529      *                                                                                      BUG3362
014610200529      ** Do processing to TI shadow files                                                    BUG3362
014620200529      *                                                                                      BUG3362
014630200529     C     BGN3ST        IFEQ      'Y'                                                       BUG4692
014640200529      *                  MOVE      A_CUCUST      A_TCCUST          6                         BUG3362
014650200529     C     BBTICS        ANDEQ     'Y'                                                       BUG4732
014660200529     C     BGN3ST        OREQ      'Y'                                                       BUG4732
014670200529     C     WBBTICS       ANDEQ     'D'                                                       BUG4732
014680200529     C     CTI006        OREQ      'Y'                                                      MD030956
014690200529     C     BBTICS        ANDEQ     'Y'                                                      MD030956
014700200529     C     CTI006        OREQ      'Y'                                                      MD030956
014710200529     C     WBBTICS       ANDEQ     'D'                                                      MD030956
014720200529     C     A_TCCUST      CHAIN     SDTICSL0                           77                     BUG3362
014730200529      *                                                                                      BUG3362
014740200529     C     *IN77         IFEQ      *OFF                                                      BUG3362
014750200529     C                   MOVEL     *BLANK        TCTYLC                                      BUG3362
014760200529     C                   Z-ADD     *ZERO         TCLCD                                       BUG3362
014770200529      *                                                                                      BUG3362
014780200529     C     SDTICDF       IFEQ      SDVTID                                                    BUG3362
014790200529     C     WorkCHTP      ANDEQ     'A'                                                       BUG3362
014800200529      *                                                                                      BUG3362
014810200529     C                   ELSE                                                                BUG3362
014820200529     C                   MOVEL     'Y'           YESUPDAT                                    BUG3362
014830200529     C                   ENDIF                                                               BUG3362
014840200529      *                                                                                      BUG3362
014850200529     C                   ELSE                                                                BUG3362
014860200529     C                   MOVEL     'Y'           YESUPDAT                                    BUG3362
014870200529     C                   ENDIF                                                               BUG3362
014880200529      *                                                                                      BUG3362
014890200529     C                   MOVEL     WorkCHTP      TCTYLC                                      BUG3362
014900200529      *                                                                                      BUG3362
014910200529     C                   ENDIF                                                               BUG4732
014920200529      *                                                                                       CSD012
014930200529     C     YESUPDAT      IFEQ      'Y'                                                        CSD012
014940200529      *                                                                                       CSD012
014950200529      * If record does not exist write details to customer shadow file                        CSD012
014960200529     C     A_CUCUST      CHAIN     SDCDSHL0                           93                      CSD012
014970200529     C******IN93         IFEQ      *ON                                               CSD012 BUG10651
014980200529     C     *IN93         IFEQ      *OFF                                                     BUG10651
014990200529     C                   EVAL      A_CUCOMG = T_BBCOMG                                      BUG10651
015000200529     C                   EVAL      A_CUCHRG = T_BBCHRG                                      BUG10651
015010200529     C                   EVAL      A_CUAGNT = T_BBAGNT                                      BUG10651
015020200529     C                   EVAL      A_CUAGNP = T_BBAGNP                                      BUG10651
015030200529     C                   EVAL      A_CUTRAS = T_BBTRAS                                      BUG10651
015040200529     C                   EVAL      A_CUNAR1 = T_BBNAR1                                      BUG10651
015050200529     C                   EVAL      A_CUNAR2 = T_BBNAR2                                      BUG10651
015060200529     C                   EVAL      A_CUNAR3 = T_BBNAR3                                      BUG10651
015070200529     C                   EVAL      A_CUNAR4 = T_BBNAR4                                      BUG10651
015080200529     C                   EVAL      A_CUDFAC = T_BBDFAC                                      BUG10651
015090200529     C                   EVAL      A_CUDFAS = T_BBDFAS                                      BUG10651
015100200529     C                   ENDIF                                                              BUG10651
015110200529                                                                                            BUG10651
015120200529     C                   MOVEL     SDVCUSD       SDVCDSH                                      CSD012
015130200529      *                                                                                       CSD012
015140200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
015150200529     C                   EVAL      T_BBSSDT=0                                                 CSD012
015160200529     C                   ELSE                                                                 CSD012
015170200529     C                   EVAL      T_BBSSDT=A_CUSSDT                                          CSD012
015180200529     C                   ENDIF                                                                CSD012
015190200529      *                                                                                       CSD012
015200200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
015210200529     C                   EVAL      T_BBLCD=BJRDNB                                             CSD012
015220200529     C                   EVAL      T_BBTYLC='I'                                               CSD012
015230200529     C                   EVAL      T_BBLALD=0                                                 CSD012
015240200529     C                   EVAL      T_BBLDHD=0                                                 CSD012
015250200529     C                   EVAL      T_BBLRLD=0                                                 CSD012
015260200529     C                   EVAL      T_BBDTDL=0                                                 CSD012
015270200529     C                   ENDIF                                                                CSD012
015280200529      *                                                                                       CSD012
015290200529     C     A_CUTYLC      IFEQ      'A'                                                        CSD012
015300200529     C     A_CUTYLC      OREQ      'C'                                                        CSD012
015310200529     C     A_CUTYLC      OREQ      'R'                                                        CSD012
015320200529     C                   EVAL      T_BBLCD=BJRDNB                                             CSD012
015330200529     C     PTransType    IFNE      'AUTH'                                                     CSD028
015340200529     C                   EVAL      T_BBTYLC='A'                                               CSD012
015350200529     C                   ELSE                                                                 CSD028
015360200529     C                   EVAL      T_BBTYLC='I'                                               CSD028
015370200529     C                   ENDIF                                                                CSD028
015380200529     C                   EVAL      T_BBLALD=A_CULALD                                          CSD012
015390200529     C                   EVAL      T_BBLDHD=A_CULDHD                                          CSD012
015400200529     C                   EVAL      T_BBLRLD=A_CULRLD                                          CSD012
015410200529     C                   EVAL      T_BBDTDL=A_CUDTDL                                          CSD012
015420200529     C                   ENDIF                                                                CSD012
015430200529      *                                                                                       CSD012
015440200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD012
015450200529     C                   EVAL      T_BBLCD=BJRDNB                                             CSD012
015460200529     C                   EVAL      T_BBTYLC='D'                                               CSD012
015470200529     C                   EVAL      T_BBLALD=A_CULALD                                          CSD012
015480200529     C                   EVAL      T_BBLDHD=A_CULDHD                                          CSD012
015490200529     C                   EVAL      T_BBLRLD=A_CULRLD                                          CSD012
015500200529     C                   EVAL      T_BBDTDL=BJRDNB                                            CSD012
015510200529     C                   ENDIF                                                                CSD012
015520200529      *                                                                                       CSD012
015530200529     C     A_CUTYLC      IFNE      'I'                                                        CSD012
015540200529     C     A_CUTYLC      ANDNE     'A'                                                        CSD012
015550200529     C     A_CUTYLC      ANDNE     'D'                                                        CSD012
015560200529     C     A_CUTYLC      ANDNE     'C'                                                        CSD012
015570200529     C     A_CUTYLC      ANDNE     'R'                                                        CSD012
015580200529     C                   EVAL      T_BBLCD=A_CULCD                                            CSD012
015590200529     C                   EVAL      T_BBTYLC=A_CUTYLC                                          CSD012
015600200529     C                   EVAL      T_BBLALD=A_CULALD                                          CSD012
015610200529     C                   EVAL      T_BBLDHD=A_CULDHD                                          CSD012
015620200529     C                   EVAL      T_BBLRLD=A_CULRLD                                          CSD012
015630200529     C                   EVAL      T_BBDTDL=A_CUDTDL                                          CSD012
015640200529     C                   ENDIF                                                                CSD012
015650200529      *                                                                                       CSD012
015660200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
015670200529     C                   EVAL      T_BBORED=BJRDNB                                            CSD012
015680200529     C                   ELSE                                                                 CSD012
015690200529     C                   EVAL      T_BBORED=A_CUORED                                          CSD012
015700200529     C                   ENDIF                                                                CSD012
015710200529      *                                                                                       CSD012
015720200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
015730200529     C                   EVAL      T_BBNET='N'                                                CSD012
015740200529     C                   ELSE                                                                 CSD012
015750200529     C                   EVAL      T_BBNET=A_CUNET                                            CSD012
015760200529     C                   ENDIF                                                                CSD012
015770200529      *                                                                                       CSD012
015780200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
015790200529     C                   EVAL      T_BBNTCP='N'                                               CSD012
015800200529     C                   ELSE                                                                 CSD012
015810200529     C                   EVAL      T_BBNTCP=A_CUNTCP                                          CSD012
015820200529     C                   ENDIF                                                                CSD012
015830200529      *                                                                                       CSD012
015840200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
015850200529     C                   EVAL      T_BBNTMM='N'                                               CSD012
015860200529     C                   ELSE                                                                 CSD012
015870200529     C                   EVAL      T_BBNTMM=A_CUNTMM                                          CSD012
015880200529     C                   ENDIF                                                                CSD012
015890200529      *                                                                                       CSD012
015900200529      ** If CSC011 is installed, supply a Front Office ID for the                             CSD012
015910200529      ** transaction even if it originated from SIN module.                                   CSD012
015920200529     C                   IF        (A_CUTYLC = 'I') AND (CSC011 = 'Y')                        CSD012
015930200529     C                   IF        T_BBFRNT = *BLANKS                                         CSD012
015940200529     C                   EVAL      T_BBFRNT = 'MD' + A_CUCUST                                 CSD012
015950200529     C                   ENDIF                                                                CSD012
015960200529     C                   ELSE                                                                 CSD012
015970200529     C                   EVAL      T_BBFRNT =A_CUFRNT                                         CSD012
015980200529     C                   ENDIF                                                                CSD012
015990200529      *                                                                                       CSD012
016000200529     C     A_CUTYLC      IFEQ      'C'                                                        CSD012
016010200529     C                   EVAL      T_BBCLDT=BJRDNB                                            CSD012
016020200529     C                   EVAL      T_BBCLST='Y'                                               CSD012
016030200529      *                                                                                       CSD012
016040200529     C                   ELSE                                                                 CSD012
016050200529     C     A_CUTYLC      IFEQ      'R'                                                        CSD012
016060200529     C                   EVAL      T_BBCLDT=BJRDNB                                            CSD012
016070200529     C                   EVAL      T_BBCLST=' '                                               CSD012
016080200529      *                                                                                       CSD012
016090200529     C                   ELSE                                                                 CSD012
016100200529     C                   EVAL      T_BBCLDT=A_CUCLDT                                          CSD012
016110200529     C                   EVAL      T_BBCLST=A_CUCLST                                          CSD012
016120200529     C                   ENDIF                                                                CSD012
016130200529     C                   ENDIF                                                                CSD012
016140200529      *                                                                                       CSD012
016150200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD012
016160200529     C     A_CUTYLC      OREQ      'A'                                                        CSD012
016170200529      *                                                                                       CSD012
016180200529     C     CSW024        IFEQ      'Y'                                                        CSD012
016190200529     C     BGMSDL        ANDEQ     'Y'                                                        CSD012
016200200529     C                   EVAL      T_BBCORP = A_CUCORP                                        CSD012
016210200529     C                   EVAL      T_BBCBEI = A_CUCBEI                                        CSD012
016220200529     C                   EVAL      T_BBRI01 = A_CURI01                                        CSD012
016230200529     C                   EVAL      T_BBRI02 = A_CURI02                                        CSD012
016240200529     C                   EVAL      T_BBRI03 = A_CURI03                                        CSD012
016250200529     C                   EVAL      T_BBRI04 = A_CURI04                                        CSD012
016260200529     C                   EVAL      T_BBRI05 = A_CURI05                                        CSD012
016270200529     C                   EVAL      T_BBFUND = A_CUFUND                                        CSD012
016280200529     C     CSW037        IFEQ      'Y'                                                        CSW037
016290200529     C                   EVAL      T_BBFNAC = A_CUFNAC                                        CSW037
016300200529     C                   ENDIF                                                                CSW037
016310200529     C                   ENDIF                                                                CSD012
016320200529     C                   ENDIF                                                                CSD012
016330200529      *                                                                                       CSD012
016340200529      ** If a Front Office transaction set timestamp to that of                               CSD012
016350200529      ** original record's to prevent timestamp problems when authorising.                    CSD012
016360200529     C     @Type         IFEQ      '0'                                                        CSD012
016370200529     C     A_CUTYLC      ANDNE     'I'                                                        CSD012
016380200529     C                   MOVEL     CHBBTMST      T_BBTMST                                     CSD012
016390200529     C                   ENDIF                                                                CSD012
016400200529      *                                                                                       CSD012
016410200529     C                   IF        *IN93 = *ON                                                CSD028
016420200529     C                   WRITE     SDCDSHD0                                                   CSD012
016430200529      *                                                                                       CSD028
016440200529      ** If record is found in the shadoe file, issue update instead of write                 CSD028
016450200529      *                                                                                       CSD028
016460200529     C                   ELSE                                                                 CSD028
016470200529     C**********         IF        CSD028 = 'Y' AND PTransType = 'AUTH'              CSD028 BUG10651
016480200529     C                   UPDATE    SDCDSHD0                                                   CSD028
016490200529     C**********         ENDIF                                                       CSD028 BUG10651
016500200529      *                                                                                       CSD028
016510200529     C                   ENDIF                                                                CSD012
016520200529                                                                                              CSD012
016530200529     C     S01383        IFEQ      'Y'                                                        CSD012
016540200529      *                                                                                       CSD012
016550200529      * If record does not exist write details BRT customer shadow file                       CSD012
016560200529     C     BRCNUM        CHAIN     SDCBSHL0                           93                      CSD012
016570200529      *                                                                                       CSD012
016580200529     C******IN93         IFEQ      *ON                                                 CSD012 CSD028
016590200529     C                   MOVEL     SDVCUBR       SDVCBSH                                      CSD012
016600200529     C                   IF        WNewCust = 'Y'                                             CSD028
016610200529     C                   EVAL      T_XCHTP = 'I'                                              CSD028
016620200529     C                   ENDIF                                                                CSD028
016630200529     C                   IF        *IN93 = *ON                                                CSD028
016640200529     C                   WRITE     SDCBSHD0                                                   CSD012
016650200529     C                   ELSE                                                                 CSD028
016660200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                       CSD028
016670200529     C                   UPDATE    SDCBSHD0                                                   CSD028
016680200529     C                   EVAL      ALSTAT = *BLANKS                                           CSD028
016690200529     C                   ENDIF                                                                CSD028
016700200529     C                   ENDIF                                                                CSD012
016710200529      *                                                                                       CSD012
016720200529     C                   ENDIF                                                                CSD012
016730200529                                                                                              CSD012
016740200529     C     BGN4ST        IFEQ      'Y'                                                        CSD012
016750200529      *                                                                                       CSD012
016760200529      * If record does not exist write details to Private banking shadow file                 CSD012
016770200529     C     A_PBCNUM      CHAIN     SDPBSHL0                           93                      CSD012
016780200529      *                                                                                       CSD012
016790200529     C******IN93         IFEQ      *ON                                                 CSD012 CSD028
016800200529     C                   MOVEL     SDVCUPB       SDVPBSH                                      CSD012
016810200529      *                                                                                       CSD012
016820200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD012
016830200529     C                   MOVEL     'C'           T_PBRECI                                     CSD012
016840200529     C                   ELSE                                                                 CSD012
016850200529     C                   MOVEL     'D'           T_PBRECI                                     CSD012
016860200529     C                   ENDIF                                                                CSD012
016870200529     C                   EVAL      T_PBLCHD=BJRDNB                                            CSD012
016880200529     C                   EVAL      T_PBCHTP = A_CUTYLC                                        CSD012
016890200529     C                   EVAL      T_PBTMES = T_BBTMST                                        CSD012
016900200529      *                                                                                       CSD012
016910200529      ** If CSC011 is installed, supply a Front Office ID for the                             CSD012
016920200529      ** transaction even if it originated from SIN module.                                   CSD012
016930200529                                                                                              CSD012
016940200529     C                   IF        (CSC011 = 'Y') AND (A_CUTYLC = 'I')                        CSD012
016950200529     C                   IF        T_PBFRNT = *BLANKS                                         CSD012
016960200529     C                   EVAL      T_PBFRNT = BBFRNT                                          CSD012
016970200529     C                   ENDIF                                                                CSD012
016980200529     C                   ELSE                                                                 CSD012
016990200529     C                   MOVEL     A_PBFRNT      T_PBFRNT                                     CSD012
017000200529     C                   ENDIF                                                                CSD012
017010200529      *                                                                                       CSD012
017020200529     C                   IF        *IN93 = *ON                                                CSD028
017030200529     C                   WRITE     SDPBSHD0                                                   CSD012
017040200529     C                   ELSE                                                                 CSD028
017050200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                       CSD028
017060200529     C                   UPDATE    SDPBSHD0                                                   CSD028
017070200529     C                   EVAL      ALSTAT = *BLANKS                                           CSD028
017080200529     C                   ENDIF                                                                CSD028
017090200529     C                   ENDIF                                                                CSD012
017100200529      *                                                                                       CSD012
017110200529     C                   ENDIF                                                                CSD012
017120200529                                                                                            BUG14969
017130200529      ** For Customer Extension SWIFT Details: Write to corresponding shadow file           BUG14969
017140200529      ** if record does not exist.                                                          BUG14969
017150200529                                                                                            BUG14969
017160200529     C     A_CUCUSD      CHAIN     SDSWSHL0                                                 BUG14969
017170200529     C                   EVAL      SDVSWSH = SDVSWSD                                        BUG14969
017180200529     C                   IF        NOT %FOUND                                               BUG14969
017190200529     C                   EVAL      T_CSBRCA = A_CUBRCD                                      BUG14969
017200200529     C                   WRITE     SDSWSHD1                                                 BUG14969
017210200529     C                   ELSE                                                               BUG14969
017220200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                     BUG14969
017230200529     C                   UPDATE    SDSWSHD1                                                 BUG14969
017240200529     C                   EVAL      ALSTAT = *BLANKS                                         BUG14969
017250200529     C                   ENDIF                                                              BUG14969
017260200529     C                   ENDIF                                                              BUG14969
017270200529      *                                                                                      BUG3362
017280200529      ** FOR TI details                                                                      BUG3362
017290200529      *                                                                                      BUG3362
017300200529      * If record does not exist write details to TI Customer Details shadow file            BUG3362
017310200529     C     BGN3ST        IFEQ      'Y'                                                       BUG4668
017320200529     C     CTI006        OREQ      'Y'                                                      MD030956
017330200529     C     A_TCCUST      IFNE      *BLANKS                                                   BUG3362
017340200529     C     A_TCCUST      CHAIN     SDTDSHL0                           76                     BUG3362
017350200529      *                                                                                      BUG3362
017360200529     C******IN76         IFEQ      *ON                                                BUG3362 CSD028
017370200529     C                   MOVEL     SDVTID        SDVTDSH                                     BUG3362
017380200529      *                                                                                      BUG3362
017390200529      ** EVAL the varaiables needed                                                          BUG3362
017400200529      *                                                                                      BUG3362
017410200529     C                   IF        *IN76 = *ON                                                CSD028
017420200529     C                   WRITE     SDTDSHD0                                                  BUG3362
017430200529     C                   ELSE                                                                 CSD028
017440200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                       CSD028
017450200529     C                   UPDATE    SDTDSHD0                                                   CSD028
017460200529     C                   EVAL      ALSTAT = *BLANKS                                           CSD028
017470200529     C                   ENDIF                                                                CSD028
017480200529     C                   ENDIF                                                               BUG3362
017490200529     C                   ENDIF                                                               BUG3362
017500200529     C                   ENDIF                                                               BUG4668
017510200529      *                                                                                      BUG3362
017520200529                                                                                              CSC015
017530200529      ** If CSD015 = 'Y' and watch list checking applied                                      CSD015
017540200529                                                                                              CSD015
017550200529     C                   IF        CSD015 = 'Y'                                               CSD015
017560200529     C                             AND W1EWLC = 'Y'                                           CSD015
017570200529                                                                                              CSD015
017580200529      ** If user is in the main system                                                        CSD015
017590200529                                                                                              CSD015
017600200529     C                   IF        CSC011 <> 'Y'                                              CSD015
017610200529     C                             OR CSC011 = 'Y' AND S1MAIN = LIBR                          CSD015
017620200529                                                                                              CSD015
017630200529     C                   IF        A_CUTYLC = 'A'                                             CSD015
017640200529                                                                                              CSD015
017650200529      ** Access SDCWHTPD using fucntion type 'SDCUSTPD', identifier                           CSD015
017660200529      ** BBCUST, and branch BBBCRD to verify Hit Unconfirmed Flag                             CSD015
017670200529                                                                                              CSD015
017680200529     C                   EVAL      WFuncType = 'SDCUSTPD'                                     CSD015
017690200529     C                   EVAL      WIdntifier = T_BBCUST                                      CSD015
017700200529     C                   EVAL      WBranch = T_BBBRCD                                         CSD015
017710200529                                                                                              CSD015
017720200529     C     KCwFld        CHAIN     SDCWHTL1                                                   CSD015
017730200529     C                   IF        NOT %FOUND(SDCWHTL1)                                       CSD015
017740200529     C                   EVAL      WUNCF1 = 'N'                                               CSD015
017750200529     C                   ELSE                                                                 CSD015
017760200529     C                   IF        W3UNCF = 'Y'                                               CSD015
017770200529     C                   EVAL      WUNCF1 = 'Y'                                               CSD015
017780200529     C                   ENDIF                                                                CSD015
017790200529     C                   ENDIF                                                                CSD015
017800200529     C                   ENDIF                                                                CSD015
017810200529                                                                                              CSD015
017820200529      ** If any of the watch list fields has been entered                                     CSD015
017830200529                                                                                              CSD015
017840200529     C                   IF        T_BBCNA1 <> *BLANKS                                        CSD015
017850200529     C                             OR T_BBCNA2 <> *BLANKS                                     CSD015
017860200529     C                             OR T_BBCNA3 <> *BLANKS                                     CSD015
017870200529     C                             OR T_BBCNA4 <> *BLANKS                                     CSD015
017880200529     C                             OR T_BBCSID <> *BLANKS                                     CSD015
017890200529     C                             OR T_BBCNCZ <> *BLANKS                                     CSD015
017900200529     C                             OR T_BBCOLC <> *BLANKS                                     CSD015
017910200529     C                             OR WUNCF1 = 'Y' AND A_CUTYLC = 'A'                         CSD015
017920200529                                                                                              CSD015
017930200529     C                   EXSR      SRXWTCH                                                    CSD015
017940200529                                                                                              CSD015
017950200529     C                   ENDIF                                                                CSD015
017960200529     C                   ENDIF                                                                CSD015
017970200529     C                   ENDIF                                                                CSD015
017980200529      *                                                                                       CSD012
017990200529      ** Define Keylist                                                                       CSD012
018000200529     C     KAULG         KLIST                                                                CSD012
018010200529     C                   KFLD                    @FUNC            21                          CSD012
018020200529     C**********         KFLD                    @KEY             20                   CSD012 CGL029
018030200529     C                   KFLD                    @KEY             26                          CGL029
018040200529      *                                                                                       CSD012
018050200529     C                   MOVEL     FUNCD         @FUNC                                        CSD012
018060200529     C                   MOVEL     A_CUCUST      @KEY                                         CSD012
018070200529      *                                                                                       CSD012
018080200529      * If Authorisation check is on,                                                         CSD012
018090200529      * check if unathorised record exists on Authorisation Log.                              CSD012
018100200529     C     KAULG         CHAIN     SDAULGL3                           96                      CSD012
018110200529      *                                                                                       CSD012
018120200529      * If record does not exist write details to Authoristion Log                            CSD012
018130200529     C     *IN96         IFEQ      *ON                                                        CSD012
018140200529     C                   MOVEL     @KEY          ALKEY                                        CSD012
018150200529     C                   MOVEL     FUNCD         ALFUNC                                       CSD012
018160200529     C                   MOVE      A_CUTYLC      ALACTN                                       CSD012
018170200529     C                   MOVE      PSUser        ALUSER                                       CSD012
018180200529      *                                                                                       CSD028
018190200529     C                   IF        WNewCust = 'Y'                                             CSD028
018200200529     C                   MOVE      'P'           ALSTAT                                       CSD028
018210200529     C                   ENDIF                                                                CSD028
018220200529      *                                                                                       CSD028
018230200529     C                   WRITE     SDAULGD3                                                   CSD012
018240200529     C                   ENDIF                                                                CSD012
018250200529      *                                                                                       CSD012
018260200529      ** Send an amend message to compliance watch                                            CSD028
018270200529      *                                                                                       CSD028
018280200529     C                   IF        CSD028 = 'Y'                                               CSD028
018290200529     C                   IF        A_CUTYLC = 'A' AND PTransType = 'AUTH'                     CSD028
018300200529     C                   CALL      'SD000051'                                                 CSD028
018310200529     C                   PARM      'A'           PAction                                      CSD028
018320200529     C                   PARM      A_CUCUST      PCustNumber                                  CSD028
018330200529     C                   ENDIF                                                                CSD028
018340200529      *                                                                                       CSD028
018350200529     C                   IF        A_CUTYLC = 'I' AND PTransType <> 'AUTH'                    CSD028
018360200529     C                   CALL      'SD000051'                                                 CSD028
018370200529     C                   PARM      'I'           PAction                                      CSD028
018380200529     C                   PARM      A_CUCUST      PCustNumber                                  CSD028
018390200529     C                   ENDIF                                                                CSD028
018400200529     C                   ENDIF                                                                CSD028
018410200529      *                                                                                       CSD028
018420200529     C                   RETURN                                                               CSD012
018430200529     C                   ENDIF                                                                CSD012
018440200529      *                                                                                       CSD012
018450200529     C                   ENDIF                                                                CSD012
018460200529      *                                                                                     MD053436
018470200529      ** Send an amend message to compliance watch                                          MD053436
018480200529      *                                                                                     MD053436
018490200529     C                   IF        CSD028 = 'Y' AND                                         MD053436
018500200529     C                             YESUPDAT <> 'Y'                                          MD053436
018510200529      *                                                                                     MD053436
018520200529     C                   IF        A_CUTYLC = 'I'                                           MD053436
018530200529     C                   CALL      'SD000051'                                               MD053436
018540200529     C                   PARM      'I'           PAction                                    MD053436
018550200529     C                   PARM      A_CUCUST      PCustNumber                                MD053436
018560200529     C                   ELSE                                                               MD053436
018570200529     C                   CALL      'SD000051'                                               MD053436
018580200529     C                   PARM      'A'           PAction                                    MD053436
018590200529     C                   PARM      A_CUCUST      PCustNumber                                MD053436
018600200529     C                   ENDIF                                                              MD053436
018610200529     C                   ENDIF                                                              MD053436
018620200529      *                                                                                     MD053436
018630200529      ** INSERT, AMEND OR DELETE THE CUSTOMER
018640200529      ** OR CLOSE OR RELEASE THE CUSTOMER                                                     CSD007
018650200529
018660200529     C                   IF        ALSTAT = ' ' AND                                           CSD028
018670200529     C                             AUTHMD = 'X'                                               CSD028
018680200529     C                   MOVE      DACTN         A_CUTYLC                                     CSD028
018690200529     C                   ENDIF                                                                CSD028
018700200529                                                                                            BUG12342
018710200529     C**********         IF        CSD037 = 'Y' AND                                BUG12342 BUG13525
018720200529     C**********                   PAccMde = 'A'                                   BUG12342 BUG13525
018730200529     C**********         OPEN      SDACSTL0                                        BUG12342 BUG12406
018740200529     C**********A_CUCUST      CHAIN     SDACSTL0                                   BUG12342 BUG12406
018750200529     C**********         EVAL      A_CUTYLC = BBTYLC                             BUG  12342 BUG12406
018760200529     C**********         CLOSE     SDACSTL0                                        BUG12342 BUG12406
018770200529      *                                                                                     BUG12406
018780200529      ** User zonal file when checking existing customer                                    BUG12406
018790200529      *                                                                                     BUG12406
018800200529     C*****A_CUCUST      CHAIN     SDCUSTL0                         99             BUG12406 BUG13525
018810200529     C**********         If        *IN99 = *Off                                    BUG12406 BUG13525
018820200529     C**********         Eval      A_CUTYLC = 'A'                                  BUG12406 BUG13525
018830200529     C**********         EndIf                                                     BUG12406 BUG13525
018840200529     C**********         ENDIF                                                     BUG12342 BUG13525
018850200529      *                                                                                       CSD028
018860200529     C**********         IF        PUpdYN = 'Y' OR                                   CSD031 BUG13525
018870200529     C**********                   PUpdYN = *BLANK                                   CSD031 BUG13525
018880200529                                                                                              CSD031
018890200529     C                   EVAL      WLUSER = *BLANKS                                        MD026835A
018900200529     C                   IF        A_FVLUSR <> *BLANKS                                     MD026835A
018910200529     C                   EVAL      WLUSER = A_FVLUSR                                       MD026835A
018920200529     C                   ENDIF                                                             MD026835A
018930200529     C     A_CUTYLC      CASEQ     'I'           INSERT
018940200529     C     A_CUTYLC      CASEQ     'A'           AMEND
018950200529     C     A_CUTYLC      CASEQ     'D'           DELETE
018960200529     C     A_CUTYLC      CASEQ     'C'           CLOSE                                        CSD007
018970200529     C     A_CUTYLC      CASEQ     'R'           RELEASE                                      CSD007
018980200529     C                   END
018990200529      *
019000200529                                                                                              CSD031
019010200529     C**********         ENDIF                                                       CSD031 BUG13525
019020200529                                                                                              CSD031
019030200529      ** Delete customer on the acceptance file.                                              CSD031
019040200529                                                                                              CSD031
019050200529     C**********         IF        CSD037 = 'Y' AND                                  CSD031 BUG13525
019060200529     C**********                   PAccMde = 'A' AND                                 CSD031 BUG13525
019070200529     C**********                   @@RTCD = *BLANKS                                  CSD031 BUG13525
019080200529     C**********                                                                              CSD031
019090200529     C**********         OPEN      SDACSTL0                                          CSD031 BUG13525
019100200529     C*****A_CUCUST      CHAIN     SDACSTL0                                          CSD031 BUG13525
019110200529     C**********         IF        %FOUND(SDACSTL0)                                  CSD031 BUG13525
019120200529     C**********         DELETE    SDACSTD0                                          CSD031 BUG13525
019130200529     C**********         ENDIF                                                       CSD031 BUG13525
019140200529     C**********         CLOSE     SDACSTL0                                          CSD031 BUG13525
019150200529     C**********         ENDIF                                                       CSD031 BUG13525
019160200529      *                                                                                       CSD031
019170200529      ** Skip further updates if required.                                                    CSD031
019180200529      *                                                                                       CSD031
019190200529     C**********         IF        PUpdYN = 'N'                                      CSD031 BUG13525
019200200529     C**********         RETURN                                                      CSD031 BUG13525
019210200529     C**********         ENDIF                                                       CSD031 BUG13525
019220200529
019230200529      ** UPDATE BASE RATE TAX DETAILS FILE
019240200529      ** ONLY IF BRT OPTION FEATURE IS 'Y'
019250200529      **    AND IF A/C HOLDER TYPE IS 'I' OR 'J'
019260200529
019270200529     C     A_CUTYLC      IFEQ      'I'
019280200529     C     A_CUTYLC      OREQ      'A'
019290200529     C     A_CUTYLC      OREQ      'D'
019300200529     C     A_CUTYLC      OREQ      'C'                                                        CSD007
019310200529     C     A_CUTYLC      OREQ      'R'                                                        CSD007
019320200529
019330200529     C     S01383        IFEQ      'Y'
019340200529     C                   EXSR      UPDBRT
019350200529     C                   END
019360200529
019370200529     C                   ENDIF
019380200529
019390200529      ** UPDATE PRIVATE BANKING DETAILS FILE
019400200529      ** ONLY IF PRIVATE BANKING OPTION FEATURE IS 'Y'
019410200529
019420200529     C     A_CUTYLC      IFEQ      'I'
019430200529     C     A_CUTYLC      OREQ      'A'
019440200529     C     A_CUTYLC      OREQ      'D'
019450200529     C     A_CUTYLC      OREQ      'C'                                                        CSD007
019460200529     C     A_CUTYLC      OREQ      'R'                                                        CSD007
019470200529
019480200529     C     BGN4ST        IFEQ      'Y'
019490200529     C                   EXSR      UPDPRB
019500200529     C                   END
019510200529
019520200529     C                   ENDIF
019530200529
019540200529      ** UPDMID - Update Customer Marketing Details                                           CSD079
019550200529      ** ONLY IF CSD079 IS 'Y'                                                                CSD079
019560200529                                                                                              CSD079
019570200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
019580200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
019590200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
019600200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
019610200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
019620200529                                                                                              CSD079
019630200529     C     CSD079        IFEQ      'Y'                                                        CSD079
019640200529     C                   EXSR      UPDMID                                                     CSD079
019650200529     C                   ENDIF                                                                CSD079
019660200529                                                                                              CSD079
019670200529     C                   ENDIF                                                                CSD079
019680200529                                                                                              CSD079
019690200529      ** UPDADD - Update Customer Additional Details                                          CSD079
019700200529      ** ONLY IF CSD079 IS 'Y' and S01425 is 'Y'                                              CSD079
019710200529                                                                                              CSD079
019720200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
019730200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
019740200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
019750200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
019760200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
019770200529                                                                                              CSD079
019780200529     C                   IF        S01425 = 'Y' AND CSD079 = 'Y'                              CSD079
019790200529     C                   EXSR      UPDADD                                                     CSD079
019800200529     C                   ENDIF                                                                CSD079
019810200529                                                                                              CSD079
019820200529     C                   ENDIF                                                                CSD079
019830200529                                                                                              CSD079
019840200529      ** UPDSFD - Update Customer Service Fees Details                                        CSD079
019850200529      ** ONLY IF CSD079 IS 'Y' and CSD008 is 'Y'                                              CSD079
019860200529                                                                                              CSD079
019870200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
019880200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
019890200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
019900200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
019910200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
019920200529                                                                                              CSD079
019930200529     C                   IF        CSD008 = 'Y' AND CSD079 = 'Y'                              CSD079
019940200529     C     F_SFSMAC      IFNE      *BLANKS                                                   BG12238
019950200529     C     F_SFHMIN      ORNE      *BLANKS                                                   BG12238
019960200529     C     F_SFNAIN      ORNE      *BLANKS                                                   BG12238
019970200529     C     F_SFSBCH      ORNE      *BLANKS                                                   BG12238
019980200529     C     F_SFSCCY      ORNE      *BLANKS                                                   BG12238
019990200529     C     F_SFPFCD      ORNE      *BLANKS                                                   BG12238
020000200529     C     F_SFPCAC      ORNE      *BLANKS                                                   BG12238
020010200529     C     F_SFPCHM      ORNE      *BLANKS                                                   BG12238
020020200529     C     F_SFTAIF      ORNE      *BLANKS                                                   BG12238
020030200529     C                   EXSR      UPDSFD                                                     CSD079
020040200529     C                   ENDIF                                                               BG12238
020050200529     C                   ENDIF                                                                CSD079
020060200529                                                                                              CSD079
020070200529     C                   ENDIF                                                                CSD079
020080200529                                                                                              CSD079
020090200529      ** UPDCQD - Update Customer Cheques and Cards Details                                   CSD079
020100200529      ** ONLY IF CSD079 IS 'Y' and BGNXST is 'Y'                                              CSD079
020110200529                                                                                              CSD079
020120200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
020130200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
020140200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
020150200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
020160200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
020170200529                                                                                              CSD079
020180200529     C                   IF        BGNXST = 'Y' AND CSD079 = 'Y'                              CSD079
020190200529     C                   EXSR      UPDCQD                                                     CSD079
020200200529     C                   ENDIF                                                                CSD079
020210200529                                                                                              CSD079
020220200529     C                   ENDIF                                                                CSD079
020230200529                                                                                              CSD079
020240200529      ** UPDSAD - Update Customer Safe Details                                                CSD079
020250200529      ** ONLY IF CSD079 IS 'Y'                                                                CSD079
020260200529                                                                                              CSD079
020270200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
020280200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
020290200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
020300200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
020310200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
020320200529                                                                                              CSD079
020330200529     C                   IF        CSD079 = 'Y'                                               CSD079
020340200529     C                   EXSR      UPDSAD                                                     CSD079
020350200529     C                   ENDIF                                                                CSD079
020360200529                                                                                              CSD079
020370200529     C                   ENDIF                                                                CSD079
020380200529                                                                                              CSD079
020390200529      ** UPDFOD - Update Customer Future and Option Details                                   CSD079
020400200529      ** ONLY IF CSD079 IS 'Y' and BGFUOP is 'Y'                                              CSD079
020410200529                                                                                              CSD079
020420200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
020430200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
020440200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
020450200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
020460200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
020470200529                                                                                              CSD079
020480200529     C                   IF        BGFUOP = 'Y' AND CSD079 = 'Y'                              CSD079
020490200529     C     A_FOSTFQ      IFNE      *BLANKS                                                   BG12238
020500200529     C     A_FODMFS      ORNE      *ZEROS                                                    BG12238
020510200529     C     A_FONSDT      ORNE      *ZEROS                                                    BG12238
020520200529     C     A_FOFACO      ORNE      *BLANKS                                                   BG12238
020530200529     C     A_FOBKIN      ORNE      *BLANKS                                                   BG12238
020540200529     C     A_FOSTTY      ORNE      *BLANKS                                                   BG12238
020550200529     C     A_FOCPNO      ORNE      *BLANKS                                                   BG12238
020560200529     C     A_FOCOAD      ORNE      *BLANKS                                                   BG12238
020570200529     C     A_FOFTAO      ORNE      *BLANKS                                                   BG12238
020580200529     C     A_FOTXCI      ORNE      *BLANKS                                                   BG12238
020590200529     C     A_FOCTLM      ORNE      *ZEROS                                                    BG12238
020600200529     C     A_FORVFQ      ORNE      *BLANKS                                                   BG12238
020610200529     C     A_FORVBD      ORNE      *ZEROS                                                    BG12238
020620200529     C     A_FONRDT      ORNE      *ZEROS                                                    BG12238
020630200529     C     A_FOPCIN      ORNE      *BLANKS                                                   BG12238
020640200529     C     A_FOACIN      ORNE      *BLANKS                                                   BG12238
020650200529     C     A_FOCYCD      ORNE      *BLANKS                                                   BG12238
020660200529     C     A_FOCODE      ORNE      *BLANKS                                                   BG12238
020670200529     C     A_FOCOAM      ORNE      *ZEROS                                                    BG12238
020680200529     C     A_FOSEBR      ORNE      *BLANKS                                                   BG12238
020690200529     C     A_FOSMAC      ORNE      *BLANKS                                                   BG12238
020700200529     C     LXNETA        ORNE      *ZEROS                                                    BG12238
020710200529     C                   EXSR      UPDFOD                                                     CSD079
020720200529     C                   ENDIF                                                               BG12238
020730200529     C                   ENDIF                                                                CSD079
020740200529                                                                                              CSD079
020750200529     C                   ENDIF                                                                CSD079
020760200529                                                                                              CSD079
020770200529      ** UPDFFD - Update MIDAS/ABS FF Customers Maintenance details                           CSD079
020780200529      ** ONLY IF CSD079 IS 'Y' and ULX004 is 'Y'                                              CSD079
020790200529                                                                                              CSD079
020800200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
020810200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
020820200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
020830200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
020840200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
020850200529                                                                                              CSD079
020860200529     C                   IF        ULX004 = 'Y' AND CSD079 = 'Y'                              CSD079
020870200529     C     A_FOSTFQ      IFNE      *BLANKS                                                   BG12238
020880200529     C     A_FODMFS      ORNE      *ZEROS                                                    BG12238
020890200529     C     A_FONSDT      ORNE      *ZEROS                                                    BG12238
020900200529     C     A_FOFACO      ORNE      *BLANKS                                                   BG12238
020910200529     C     A_FOBKIN      ORNE      *BLANKS                                                   BG12238
020920200529     C     A_FOSTTY      ORNE      *BLANKS                                                   BG12238
020930200529     C     A_FOCPNO      ORNE      *BLANKS                                                   BG12238
020940200529     C     A_FOCOAD      ORNE      *BLANKS                                                   BG12238
020950200529     C     A_FOFTAO      ORNE      *BLANKS                                                   BG12238
020960200529     C     A_FOTXCI      ORNE      *BLANKS                                                   BG12238
020970200529     C     A_FOCTLM      ORNE      *ZEROS                                                    BG12238
020980200529     C     A_FORVFQ      ORNE      *BLANKS                                                   BG12238
020990200529     C     A_FORVBD      ORNE      *ZEROS                                                    BG12238
021000200529     C     A_FONRDT      ORNE      *ZEROS                                                    BG12238
021010200529     C     A_FOPCIN      ORNE      *BLANKS                                                   BG12238
021020200529     C     A_FOACIN      ORNE      *BLANKS                                                   BG12238
021030200529     C     A_FOCYCD      ORNE      *BLANKS                                                   BG12238
021040200529     C     A_FOCODE      ORNE      *BLANKS                                                   BG12238
021050200529     C     A_FOCOAM      ORNE      *ZEROS                                                    BG12238
021060200529     C     A_FOSEBR      ORNE      *BLANKS                                                   BG12238
021070200529     C     A_FOSMAC      ORNE      *BLANKS                                                   BG12238
021080200529     C     LXNETA        ORNE      *ZEROS                                                    BG12238
021090200529     C                   EXSR      UPDFFD                                                     CSD079
021100200529     C                   ENDIF                                                               BG12238
021110200529     C                   ENDIF                                                                CSD079
021120200529                                                                                              CSD079
021130200529     C                   ENDIF                                                                CSD079
021140200529                                                                                              CSD079
021150200529      ** UPDPMD - Update Customer Portfolio Management Details                                CSD079
021160200529      ** ONLY IF CSD079 IS 'Y' and WUPMSC is 'Y'                                              CSD079
021170200529                                                                                              CSD079
021180200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
021190200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
021200200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
021210200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
021220200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
021230200529                                                                                              CSD079
021240200529     C                   IF        WUPMSC = 'Y' AND CSD079 = 'Y'                              CSD079
021250200529     C     A_PMLANG      IFNE      *BLANKS                                                   BG12238
021260200529     C     A_PMBDAT      ORNE      *ZEROS                                                    BG12238
021270200529     C     A_PMCSBY      ORNE      *BLANKS                                                   BG12238
021280200529     C     A_PMSAFI      ORNE      *BLANKS                                                   BG12238
021290200529     C     A_PMSAFI      ANDNE     'N'                                                     AR1049708
021300200529     C     A_PMDCMS      ORNE      *BLANKS                                                   BG12238
021310200529     C     A_PMVLFQ      ORNE      *BLANKS                                                   BG12238
021320200529     C     A_PMVLDM      ORNE      *ZEROS                                                    BG12238
021330200529     C     A_PMVLND      ORNE      *ZEROS                                                    BG12238
021340200529     C     A_PMS1VR      ORNE      *BLANKS                                                   BG12238
021350200529     C     A_PMS1VR      ANDNE     'N'                                                     AR1049708
021360200529     C     A_PMS2VR      ORNE      *BLANKS                                                   BG12238
021370200529     C     A_PMS2VR      ANDNE     'N'                                                     AR1049708
021380200529     C     A_PMS3VR      ORNE      *BLANKS                                                   BG12238
021390200529     C     A_PMS3VR      ANDNE     'N'                                                     AR1049708
021400200529     C     A_PMS4VR      ORNE      *BLANKS                                                   BG12238
021410200529     C     A_PMS4VR      ANDNE     'N'                                                     AR1049708
021420200529     C     A_PMS5VR      ORNE      *BLANKS                                                   BG12238
021430200529     C     A_PMS5VR      ANDNE     'N'                                                     AR1049708
021440200529     C     A_PMS6VR      ORNE      *BLANKS                                                   BG12238
021450200529     C     A_PMS6VR      ANDNE     'N'                                                     AR1049708
021460200529     C     A_PMS7VR      ORNE      *BLANKS                                                   BG12238
021470200529     C     A_PMS7VR      ANDNE     'N'                                                     AR1049708
021480200529     C     A_PMS8VR      ORNE      *BLANKS                                                   BG12238
021490200529     C     A_PMS8VR      ANDNE     'N'                                                     AR1049708
021500200529     C     A_PMAPBC      ORNE      *BLANKS                                                   BG12238
021510200529     C     A_PMPPCS      ORNE      *BLANKS                                                   BG12238
021520200529     C     A_PMPPCS      ANDNE     'N'                                                     AR1049708
021530200529     C     A_PMDFPO      ORNE      *BLANKS                                                   BG12238
021540200529     C     A_PMINSU      ORNE      *BLANKS                                                   BG12238
021550200529     C     A_PMCYSU      ORNE      *BLANKS                                                   BG12238
021560200529     C     A_PMSECO      ORNE      *BLANKS                                                   BG12238
021570200529     C                   EXSR      UPDPMD                                                     CSD079
021580200529     C                   ENDIF                                                               BG12238
021590200529     C                   ENDIF                                                                CSD079
021600200529                                                                                              CSD079
021610200529     C                   ENDIF                                                                CSD079
021620200529                                                                                              CSD079
021630200529      ** UPDRWN - Update Customer Risk weighted Assets Details                                CSD079
021640200529      ** ONLY IF CSD079 IS 'Y' and CGL018 is 'Y'                                              CSD079
021650200529                                                                                              CSD079
021660200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
021670200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
021680200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
021690200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
021700200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
021710200529                                                                                              CSD079
021720200529     C                   IF        CGL018 = 'Y' AND CSD079 = 'Y'                              CSD079
021730200529     C                   IF        %SUBST(SDVCURW:8:107) <> *BLANKS                          BG12238
021740200529     C                   EXSR      UPDRWN                                                     CSD079
021750200529     C                   ENDIF                                                               BG12238
021760200529     C                   ENDIF                                                                CSD079
021770200529                                                                                              CSD079
021780200529     C                   ENDIF                                                                CSD079
021790200529                                                                                              CSD079
021800200529      ** UPDCUX2 - Update Lux(European Reporting ) file                                       CSD079
021810200529      ** ONLY IF ULX609 is 'Y' and BGLRIN is 'Y'                                              CSD079
021820200529                                                                                              CSD079
021830200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
021840200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
021850200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
021860200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
021870200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
021880200529                                                                                              CSD079
021890200529     C                   IF        ULX609 = 'Y' AND BGLRIN = 'Y'                              CSD079
021900200529     C                             AND CSD079 = 'Y'                                         BUG14104
021910200529     C                   EXSR      UPDCUX2                                                    CSD079
021920200529     C                   ENDIF                                                                CSD079
021930200529                                                                                              CSD079
021940200529     C                   ENDIF                                                                CSD079
021950200529                                                                                              CSD079
021960200529      ** UPDCUX1 - Update Lux(IBLC - Extended Information) file                               CSD079
021970200529      ** ONLY IF ULX043 is 'Y' and BGNWST is 'Y'                                              CSD079
021980200529                                                                                              CSD079
021990200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
022000200529     C     A_CUTYLC      OREQ      'A'                                                        CSD079
022010200529     C     A_CUTYLC      OREQ      'D'                                                        CSD079
022020200529     C*****A_CUTYLC      OREQ      'C'                                               CSD079 BUG14009
022030200529     C*****A_CUTYLC      OREQ      'R'                                               CSD079 BUG14009
022040200529                                                                                              CSD079
022050200529     C                   IF        ULX043 = 'Y' AND BGNWST = 'Y'                              CSD079
022060200529     C                             AND CSD079 = 'Y'                                         BUG14104
022070200529     C                   EXSR      UPDCUX1                                                    CSD079
022080200529     C                   ENDIF                                                                CSD079
022090200529                                                                                              CSD079
022100200529     C                   ENDIF                                                                CSD079
022110200529      *                                                                                    AR1086546
022120200529     C     A_CUTYLC      IFEQ      'I'                                                     AR1086546
022130200529     C     A_CUTYLC      OREQ      'A'                                                     AR1086546
022140200529     C     A_CUTYLC      OREQ      'D'                                                     AR1086546
022150200529                                                                                           AR1086546
022160200529     C                   IF        CDL025 = 'Y' AND CSD079 = 'Y'                           AR1086546
022170200529     C                             AND CDL002 = 'Y' AND BBNET = 'Y'                        AR1086546
022180200529     C                             AND NV_TNCUST <> *BLANKS                                 MD026368
022190200529     C                   EXSR      UPDCTNM                                                 AR1086546
022200200529     C                   ENDIF                                                             AR1086546
022210200529                                                                                           AR1086546
022220200529     C                   ENDIF                                                             AR1086546
022230200529                                                                                              CSD079
022240200529      ** If 24x7 Midas Availability is installed                                              CSC011
022250200529      ** and Support System is active                                                         CSC011
022260200529                                                                                              CSC011
022270200529     C                   IF        (CSC011 = 'Y') AND (S1SUPP = LIBR)                         CSC011
022280200529                                                                                              CSC011
022290200529      ** Move file fields to DS parameter used in SDCUSDLOG                                   CSC011
022300200529                                                                                              CSC011
022310200529     C                   EVAL      W_PBCNUM = D_PBCNUM                                        CSC011
022320200529     C                   EVAL      W_PBRECI = D_PBRECI                                        CSC011
022330200529     C                   EVAL      W_PBHOLD = D_PBHOLD                                        CSC011
022340200529     C                   EVAL      W_PBNUAC = D_PBNUAC                                        CSC011
022350200529     C                   EVAL      W_PBAGEN = D_PBAGEN                                        CSC011
022360200529     C                   EVAL      W_PBCOUN = D_PBCOUN                                        CSC011
022370200529     C                   EVAL      W_PBREPB = D_PBREPB                                        CSC011
022380200529     C                   EVAL      W_PBPBST = D_PBPBST                                        CSC011
022390200529     C                   EVAL      W_PBLCHD = D_PBLCHD                                        CSC011
022400200529     C                   EVAL      W_PBCHTP = D_PBCHTP                                        CSC011
022410200529     C                   EVAL      W_PBTMES = D_PBTMES                                        CSC011
022420200529                                                                                              CSC011
022430200529     C                   CALLB     'SDCUSDLOG'                                                CSC011
022440200529     C                   PARM      *BLANKS       RetCodeOut                                   CSC011
022450200529     C                   PARM                    CUSTDF                                       CSC011
022460200529     C                   PARM                    SDCBRTF                                      CSC011
022470200529     C                   PARM                    SDPBDF                                       CSC011
022480200529     C                   PARM                    TRANSDTL                                     CSC011
022490200529                                                                                              CSC011
022500200529      ** If there is no error, write the log file                                             CSC011
022510200529                                                                                              CSC011
022520200529     C                   IF        RetCodeOut = *BLANKS                                       CSC011
022530200529                                                                                              CSC011
022540200529     C                   EVAL      APTGTTYPE = 'SDCUSD'                                       CSC011
022550200529     C                   EVAL      APFOTRANID = BBFRNT                                        CSC011
022560200529     C                   EVAL      APRPRLOCN  = BBREPA                                        CSC011
022570200529     C                   EVAL      APUSERID   = PSUser                                        CSC011
022580200529     C                   EVAL      APMIDUSR   = PSUser                                        CSC011
022590200529                                                                                              CSC011
022600200529     C                   MOVEL     BBCUST        PCustNum                                     CSC011
022610200529                                                                                              CSC011
022620200529     C                   CALLB     'APLOGTRAN'                                                CSC011
022630200529     C                   PARM      *BLANKS       RetCodeOut                                   CSC011
022640200529     C                   PARM                    APHEAD                                       CSC011
022650200529     C                   PARM                    TRANSDTL                                     CSC011
022660200529     C                   PARM      *BLANKS       PTimestamp                                   CSC011
022670200529     C                   PARM                    PCustNum                                     CSC011
022680200529     C                   PARM      *BLANKS       PACustNo                                     CSC011
022690200529                                                                                              CSC011
022700200529     C                   ENDIF                                                                CSC011
022710200529                                                                                              CSC011
022720200529      ** If there is an error in either log file, end program                                 CSC011
022730200529                                                                                              CSC011
022740200529     C                   IF        RetCodeOut <> *BLANKS                                      CSC011
022750200529     C                   EVAL      @@RTCD = '*ERROR'                                          CSC011
022760200529     C                   ENDIF                                                                CSC011
022770200529                                                                                              CSC011
022780200529     C                   ENDIF                                                                CSC011
022790200529     C/COPY WNCPYSRC,SDCUSDDC01
022800200529      * EXIT FROM PROGRAM
022810200529     C     EXIT          TAG
022820200529
022830200529     C                   RETURN
022840200529     C****************************************************************
022850200529      /EJECT
022860200529     C*****************************************************************
022870200529     C*                                                               *
022880200529     C* CHKOTHUPD - Check for update by another workstation           *
022890200529     C*                                                               *
022900200529     C*****************************************************************
022910200529     C     CHKOTHUPD     BEGSR
022920200529
022930200529      ** Retrieve current Customer details
022940200529
022950200529     C                   MOVE      A_CUCUST      MidasTrNum        6
022960200529
022970200529      ** Determine whether program is running interactively or in batch
022980200529      **  ( 0 = batch   1 = interactive)
022990200529      *
023000200529     C                   CALLB     'ZARTVJOBA'
023010200529     C                   PARM                    @Return           6
023020200529     C                   PARM                    @type             1
023030200529      *                                                                         CAP013
023040200529      * Set retrieve mode to '*FRONT' (Access using Front Office ID)            CAP013
023050200529      *  if insert                                                              CAP013
023060200529      * Otherwise                                                               CAP013
023070200529      *  Set retrieve mode to blank  (Access using Midas transaction ID).       CAP013
023080200529      *                                                                         CAP013
023090200529     C*****A_CUTYLC      IFne      'I'                                   CAP013 193883
023100200529     C**********         MOVEL     '1'           @TYPE                   CAP013 193883
023110200529     C**********         ENDIF                                           CAP013 193883
023120200529     C*****A_CUTYLC      IFne      'I'                                   CAP013 175680
023130200529     C**********         MOVEL     '1'           @TYPE                   CAP013 175680
023140200529     C**********         ENDIF                                           CAP013 175680
023150200529      *
023160200529     C     @Type         IFEQ      '1'                                                        201011
023170200529     C     A_CUTYLC      ANDEQ     'I'                                                        201011
023180200529     C     A_CUFRNT      ANDNE     *BLANKS                                                    201011
023190200529      *                                                                                       201011
023200200529     C                   MOVE      '*FRONT'      @@MODE                                       201011
023210200529      *                                                                                       201011
023220200529     C                   ELSE                                                                 201011
023230200529                                                                                              201011
023240200529     C     @Type         IFEQ      '0'
023250200529     C*****A_CUTYLC      IFeq      'I'                                                 175680 201011
023260200529     C     A_CUTYLC      ANDEQ     'I'                                                        201011
023270200529     C                   MOVE      '*FRONT'      @@MODE
023280200529     C                   ELSE                                                   175680
023290200529     C                   MOVE      *BLANKS       @@MODE                         175680
023300200529     C                   ENDIF                                                  175680
023310200529     C**********         ELSE                                                                 201011
023320200529     C**********         MOVE      *BLANKS       @@MODE                                       201011
023330200529     C                   END
023340200529      *                                                                                       CSD021
023350200529      ** Generate customer number if not supplied and CSD021 is installed                     CSD021
023360200529     C     CSD021        IFEQ      'Y'                                                        CSD021
023370200529     C     A_CUTYLC      ANDEQ     'I'                                                        CSD021
023380200529     C     A_CUCUST      ANDEQ     *BLANK                                                     CSD021
023390200529     C                   EXSR      SRGenCustNo                                                CSD021
023400200529     C                   MOVE      New_CNUM      A_CUCUST                                     CSD021
023410200529     C                   MOVE      New_CNUM      MidasTrNum                                   CSD021
023420200529     C                   MOVE      New_CNUM      BRCNUM                                      BUG1986
023430200529     C                   ENDIF                                                                CSD021
023440200529
023450200529     C                   CALLB     'SDCUSDRTV'
023460200529      * INPUTS
023470200529      *
023480200529      * Return code
023490200529     C                   PARM      *BLANK        RetCodeOut
023500200529      *
023510200529      * Mode = '*FRONT' (FRONT OFFICE TRANSACTION INTERFACE)
023520200529      * MODE = '      ' (NOT FRONT OFFICE TRANSACTION INTERFACE)
023530200529      *
023540200529     C                   PARM                    @@MODE            6
023550200529      *
023560200529      * Response mode
023570200529     C                   PARM      ' '           @@RSMD            1
023580200529      *
023590200529      * Action Code
023600200529     C                   PARM      A_CUTYLC      ACTN              1
023610200529      *
023620200529      * Front Office Transaction ID
023630200529     C                   PARM      A_CUFRNT      FOTRID           20
023640200529      *
023650200529      * (Midas) Customer Reference
023660200529     C                   PARM                    MidasTrNum
023670200529      * Base Rate Auth req                                                                    CSD012
023680200529     C                   PARM                    AUTHRQ            1                          CSD012
023690200529      * Authorisation Mode                                                                    CSD012
023700200529     C                   PARM                    AUTHMD                                       CSD012
023710200529      *
023720200529      *  Base Rate Tax option feature is switched on
023730200529     C                   PARM                    S01383            1
023740200529      *
023750200529      *  Private Banking Customer Details is switched on
023760200529     C                   PARM                    BGN4ST            1
023770200529      ** Global Data Layout feature is switched on                                            CGP001
023780200529     C                   PARM                    CGP001                                       CGP001
023790200529      ** Transaction Type                                                                     CSD028
023800200529     C                   PARM                    PTransType                                   CSD028
023810200529      *                                                                                       CSD031
023820200529      ** Acceptance Mode                                                                      CSD031
023830200529     C**********         PARM      PAccMde       PChkAccMde                          CSD031 BUG13525
023840200529      ** Update (Y/N)                                                                         CSD031
023850200529     C**********         PARM                    PChkUpdYN                           CSD031 BUG13525
023860200529     C                   PARM      PAccMde       PChkAccMde                                 BUG15872
023870200529     C                   PARM                    PChkUpdYN                                  BUG15872
023880200529      *
023890200529      * OUTPUTS
023900200529      *
023910200529      * (Current) CUSTOMER in file format
023920200529     C                   PARM                    ChkCusdFmt
023930200529      *
023940200529      * (Current) Base Rate Tax details in file format
023950200529     C                   PARM                    CBrtFilFmt
023960200529      *
023970200529      * (Current) Private Banking Details in file format
023980200529     C                   PARM                    CPrbFilFmt
023990200529      * TI Customer Details in File Format                                                   BUG4967
024000200529     C                   PARM                    CuTIFilFMt                                  BUG4967
024010200529      ** (Current) Global Customer X-Reference in file format                                 CGP001
024020200529     C                   PARM                    CGCuFilFmt                                   CGP001
024030200529     C                   PARM                    SwftFilFmt                                 BUG14929
024040200529     C                   PARM                    SDVSW13                                      CFT050
024050200529     C**********         PARM                    CuFaFilFmt                         CGL132 MD038401B
024060200529     C                   PARM                    CrXcFilFmt                                   CGL132
024070200529     C                   PARM                    CuFaFilFmt                                MD038401B
024080200529     C                   PARM                    CrsdFilFmt                                   CGL157
024090200529     C                   PARM                    PCrsdX                                       CGL157
024100200529                                                                                              CSD079
024110200529      ** (Current) Customer Marketing Information in file format                              CSD079
024120200529                                                                                              CSD079
024130200529     C                   PARM                    CuMiFilFmt                                   CSD079
024140200529                                                                                              CSD079
024150200529      ** (Current) Customer Additional Details in file format                                 CSD079
024160200529                                                                                              CSD079
024170200529     C                   PARM                    CuAdFilFmt                                   CSD079
024180200529                                                                                              CSD079
024190200529      ** (Current) Customer Service Fees Details in file format                               CSD079
024200200529                                                                                              CSD079
024210200529     C                   PARM                    CuFeFilFmt                                   CSD079
024220200529                                                                                              CSD079
024230200529      ** (Current) Customer Cheques & Cards Details in file format                            CSD079
024240200529                                                                                              CSD079
024250200529     C                   PARM                    CuCqFilFmt                                   CSD079
024260200529                                                                                              CSD079
024270200529      ** (Current) Customer Safes Details in file format                                      CSD079
024280200529                                                                                              CSD079
024290200529     C                   PARM                    CuSfFilFmt                                   CSD079
024300200529                                                                                              CSD079
024310200529      ** (Current) Customer Risk Weighted Assets Details in file format                       CSD079
024320200529                                                                                              CSD079
024330200529     C                   PARM                    CuRwFilFmt                                   CSD079
024340200529                                                                                              CSD079
024350200529      ** (Current) Customer Futures & Options Details in file format                          CSD079
024360200529                                                                                              CSD079
024370200529     C                   PARM                    CuFoFilFmt                                   CSD079
024380200529                                                                                              CSD079
024390200529      ** (Current) MIDAS/ABS FF Customers Maintenance in file format                          CSD079
024400200529                                                                                              CSD079
024410200529     C                   PARM                    CuFFFilFmt                                   CSD079
024420200529                                                                                              CSD079
024430200529      ** (Current) Customer Portfolio Mgmt. Details in file format                            CSD079
024440200529                                                                                              CSD079
024450200529     C                   PARM                    CuPmFilFmt                                   CSD079
024460200529                                                                                              CSD079
024470200529      ** (current) Lux(European Reporting ) Details in file format                            CSD079
024480200529                                                                                              CSD079
024490200529     C                   PARM                    CueuFilFmt                                   CSD079
024500200529                                                                                              CSD079
024510200529      ** (Current) Lux(IBLC - Extended Information)details in file                            CSD079
024520200529      ** format                                                                               CSD079
024530200529                                                                                              CSD079
024540200529     C                   PARM                    CuibfFilFmt                                  CSD079
024550200529                                                                                              CER059
024560200529     C                   PARM                    TranInCUAH                                   CER059
024570200529     C                   PARM                    TranInCCTX                                   CER059
024580200529     C                   PARM                    CtnmFilFmt                                AR1086546
024590200529     C                   PARM                    TranInPrim                                   CFT050
024600200529     C                   PARM                    TranInSeco                                   CFT050
024610200529     C                   PARM                    TranInMT3X                                   CFT050
024620200529     C/COPY WNCPYSRC,SDH00751
024630200529      *
024640200529      * OK - Action code
024650200529     C                   PARM      *BLANK        DDACTNOK
024660200529      *
024670200529      * OK - Customer Number
024680200529     C                   PARM                    DDCUSNOK          1
024690200529      *
024700200529      * Error fields/message IDs/message data (arrays) from/to caller
024710200529     C                   PARM      *BLANK        FldNameArr
024720200529     C                   PARM      *BLANK        MsgIdArr
024730200529     C                   PARM      *BLANK        MsgDtaArr
024740200529      *
024750200529      * Array index (3P0) from/to caller
024760200529     C                   PARM      *ZERO         Idx               3 0
024770200529      *                                                                                     BUG23518
024780200529     C                   PARM      *BLANKS       WFldNamArr                                 BUG23518
024790200529     C                   PARM      *BLANKS       WMsgIdArr                                  BUG23518
024800200529     C                   PARM      *BLANKS       WMsgDtaArr                                 BUG23518
024810200529     C                   PARM      *ZEROS        WIdx              3 0                      BUG23518
024820200529      *                                                                                     BUG23518
024830200529     C/COPY WNCPYSRC,SDCUSDDC10
024840200529      *
024850200529      *
024860200529      ** Error if Timestamp is not the same (record has been changed
024870200529      **  by another workstation)
024880200529
024890200529      ** Processing varies according to mode program is running in.
024900200529      ** In interacive mode simply check whether the timestamp field
024910200529      ** has been updated since the original Customer was fetched
024920200529      ** by this program.
024930200529      ** In batch (API input) check return parameters from Retrieve
024940200529      ** module for errors, and send message to system operator.
024950200529
024960200529      ** Interactive mode:
024970200529
024980200529     C     @TYPE         IFEQ      '1'
024990200529
025000200529     C     CHBBTMST      IFNE      A_CUTMST
025010200529     C                   MOVEL     '*RECUPD'     @@RTCD
025020200529     C                   END
025030200529
025040200529      ** Batch mode:
025050200529     C                   ELSE
025060200529     C     DDACTNOK      IFEQ      'N'
025070200529     C     DDCUSNOK      OREQ      'N'
025080200529     C                   MOVEL     '*RECUPD'     @@RTCD
025090200529     C                   Z-ADD     1             C                 2 0
025100200529
025110200529     C     C             DOWLE     ArrayMax
025120200529     C     FldNameArr(C) ANDNE     *BLANKS
025130200529     C                   MOVEL     *BLANKS       DBError          28
025140200529     C                   MOVEL     MsgIDArr(C)   DBError
025150200529     C                   CALLB     'ZAMSGTOOPR'
025160200529     C                   PARM                    MsgSndRtn        10
025170200529     C                   PARM                    DBError
025180200529     C                   PARM                    DummyMsgID
025190200529     C                   PARM                    DummyMsgF
025200200529     C                   ADD       1             C
025210200529     C                   END
025220200529
025230200529     C                   END
025240200529
025250200529     C                   END
025260200529
025270200529     C                   ENDSR
025280200529      ****************************************************************                        CSD021
025290200529      /EJECT                                                                                  CSD021
025300200529      *****************************************************************                       CSD021
025310200529      *                                                               *                       CSD021
025320200529      * SRGenCustNo - Generate Customer Number                        *                       CSD021
025330200529      *                                                               *                       CSD021
025340200529      *****************************************************************                       CSD021
025350200529     C     SRGenCustNo   BEGSR                                                                CSD021
025360200529                                                                                              CSD021
025370200529     C     *LOCK         IN        CNLU                                                       CSD021
025380200529     C                   Eval      New_CNUM = CNLU                                            CSD021
025390200529                                                                                              CSD021
025400200529      ** Loop until a valid customer number is found                                          CSD021
025410200529     C                   Eval      New_CNUMOK = 'N'                                           CSD021
025420200529     C                   DoW       New_CNUMOK = 'N'                                           CSD021
025430200529                                                                                              CSD021
025440200529     C*********          Eval      New_CNUM = New_CNUM + 1                             CSD021 CSD027
025450200529     C                   Eval      #@NOA = New_CNUM                                           CSD027
025460200529     C                   EXSR      #@NUA                                                      CSD027
025470200529     C                   Eval      New_CNUM = #@NOA                                           CSD027
025480200529     C                   Move      New_CNUM      MidasTrNum                                   CSD021
025490200529                                                                                              CSD021
025500200529     C                   CallB     'SDCUSDRTV'                                                CSD021
025510200529      * INPUTS                                                                                CSD021
025520200529      *                                                                                       CSD021
025530200529      * Return code                                                                           CSD021
025540200529     C                   PARM      *BLANK        RetCodeOut                                   CSD021
025550200529      *                                                                                       CSD021
025560200529      * Mode = '*FRONT' (FRONT OFFICE TRANSACTION INTERFACE)                                  CSD021
025570200529      * MODE = '      ' (NOT FRONT OFFICE TRANSACTION INTERFACE)                              CSD021
025580200529      *                                                                                       CSD021
025590200529     C                   PARM                    @@MODE            6                          CSD021
025600200529      *                                                                                       CSD021
025610200529      * Response mode                                                                         CSD021
025620200529     C                   PARM      ' '           @@RSMD            1                          CSD021
025630200529      *                                                                                       CSD021
025640200529      * Action Code                                                                           CSD021
025650200529     C                   PARM      A_CUTYLC      ACTN              1                          CSD021
025660200529      *                                                                                       CSD021
025670200529      * Front Office Transaction ID                                                           CSD021
025680200529     C                   PARM      A_CUFRNT      FOTRID           20                          CSD021
025690200529      *                                                                                       CSD021
025700200529      * (Midas) Customer Reference                                                            CSD021
025710200529     C                   PARM                    MidasTrNum        6                          CSD021
025720200529      * Base Rate Auth req                                                                   BUG1986
025730200529     C                   PARM                    AUTHRQ            1                         BUG1986
025740200529      * Authorisation Mode                                                                   BUG1986
025750200529     C                   PARM                    AUTHMD                                      BUG1986
025760200529      *                                                                                       CSD021
025770200529      *  Base Rate Tax option feature is switched on                                          CSD021
025780200529     C                   PARM                    S01383            1                          CSD021
025790200529      *                                                                                       CSD021
025800200529      *  Private Banking Customer Details is switched on                                      CSD021
025810200529     C                   PARM                    BGN4ST            1                          CSD021
025820200529      ** Global Data Layout feature is switched on                                           BUG1986
025830200529     C                   PARM                    CGP001                                      BUG1986
025840200529      ** Transaction Type                                                                     249593
025850200529     C                   PARM                    PTransType                                   249593
025860200529      ** Acceptance Mode                                                                      CSD031
025870200529     C**********         PARM      PAccMde       PChkAccMde                          CSD031 BUG13525
025880200529      ** Update (Y/N)                                                                         CSD031
025890200529     C**********         PARM                    PChkUpdYN                           CSD031 BUG13525
025900200529     C                   PARM      PAccMde       PChkAccMde                                 BUG15872
025910200529     C                   PARM                    PChkUpdYN                                  BUG15872
025920200529      *                                                                                       CSD021
025930200529      * OUTPUTS                                                                               CSD021
025940200529      *                                                                                       CSD021
025950200529      * (Current) CUSTOMER in file format                                                     CSD021
025960200529     C                   PARM                    ChkCusdFmt                                   CSD021
025970200529      *                                                                                       CSD021
025980200529      * (Current) Base Rate Tax details in file format                                        CSD021
025990200529     C                   PARM                    CBrtFilFmt                                   CSD021
026000200529      *                                                                                       CSD021
026010200529      * (Current) Private Banking Details in file format                                      CSD021
026020200529     C                   PARM                    CPrbFilFmt                                   CSD021
026030200529      * TI Customer Details in File Format                                                   BUG4967
026040200529     C                   PARM                    CuTIFilFMt                                  BUG4967
026050200529      ** (Current) Global Customer X-Reference in file format                                BUG1986
026060200529     C                   PARM                    CGCuFilFmt                                  BUG1986
026070200529     C                   PARM                    SwftFilFmt                                 BUG14929
026080200529     C                   PARM                    SDVSW13                                   MD038401B
026090200529     C                   PARM                    CrXcFilFmt                                MD038401B
026100200529     C                   PARM                    CuFaFilFmt                                MD038401B
026110200529     C                   PARM                    CrsdFilFmt                                   CGL157
026120200529     C                   PARM                    PCrsdF                                       CGL157
026130200529                                                                                              CSD079
026140200529      ** (Current) Customer Marketing Information in file format                              CSD079
026150200529                                                                                              CSD079
026160200529     C                   PARM                    CuMiFilFmt                                   CSD079
026170200529                                                                                              CSD079
026180200529      ** (Current) Customer Additional Details in file format                                 CSD079
026190200529                                                                                              CSD079
026200200529     C                   PARM                    CuAdFilFmt                                   CSD079
026210200529                                                                                              CSD079
026220200529      ** (Current) Customer Service Fees Details in file format                               CSD079
026230200529                                                                                              CSD079
026240200529     C                   PARM                    CuFeFilFmt                                   CSD079
026250200529                                                                                              CSD079
026260200529      ** (Current) Customer Cheques & Cards Details in file format                            CSD079
026270200529                                                                                              CSD079
026280200529     C                   PARM                    CuCqFilFmt                                   CSD079
026290200529                                                                                              CSD079
026300200529      ** (Current) Customer Safes Details in file format                                      CSD079
026310200529                                                                                              CSD079
026320200529     C                   PARM                    CuSfFilFmt                                   CSD079
026330200529                                                                                              CSD079
026340200529      ** (Current) Customer Risk Weighted Assets Details in file format                       CSD079
026350200529                                                                                              CSD079
026360200529     C                   PARM                    CuRwFilFmt                                   CSD079
026370200529                                                                                              CSD079
026380200529      ** (Current) Customer Futures & Options Details in file format                          CSD079
026390200529                                                                                              CSD079
026400200529     C                   PARM                    CuFoFilFmt                                   CSD079
026410200529                                                                                              CSD079
026420200529      ** (Current) MIDAS/ABS FF Customers Maintenance in file format                          CSD079
026430200529                                                                                              CSD079
026440200529     C                   PARM                    CuFFFilFmt                                   CSD079
026450200529                                                                                              CSD079
026460200529      ** (Current) Customer Portfolio Mgmt. Details in file format                            CSD079
026470200529                                                                                              CSD079
026480200529     C                   PARM                    CuPmFilFmt                                   CSD079
026490200529                                                                                              CSD079
026500200529      ** (current) Lux(European Reporting ) Details in file format                            CSD079
026510200529                                                                                              CSD079
026520200529     C                   PARM                    CueuFilFmt                                   CSD079
026530200529                                                                                              CSD079
026540200529      ** (Current) Lux(IBLC - Extended Information)details in file format                     CSD079
026550200529                                                                                              CSD079
026560200529     C                   PARM                    CuibfFilFmt                                  CSD079
026570200529      *                                                                                       CSD021
026580200529      ** (Current) Currency/Time of Netting Details in file format                         AR1086546
026590200529                                                                                           AR1086546
026600200529     C**********         PARM                    CtnmFilFmt                      AR1086546 MD038401B
026610200529     C                   PARM                    TranInCUAH                                   CFT050
026620200529     C                   PARM                    TranInCCTX                                   CFT050
026630200529     C                   PARM                    CtnmFilFmt                                MD038401B
026640200529     C                   PARM                    TranInPrim                                   CFT050
026650200529     C                   PARM                    TranInSeco                                   CFT050
026660200529     C                   PARM                    TranInMT3X                                   CFT050
026670200529      * OK - Action code                                                                      CSD021
026680200529     C                   PARM      *BLANK        DDACTNOK          1                          CSD021
026690200529      *                                                                                       CSD021
026700200529      * OK - Customer Number                                                                  CSD021
026710200529     C                   PARM      *BLANK        DDCUSNOK          1                          CSD021
026720200529      *                                                                                       CSD021
026730200529      * Error fields/message IDs/message data (arrays) from/to caller                         CSD021
026740200529     C                   PARM      *BLANK        FldNameArr                                   CSD021
026750200529     C                   PARM      *BLANK        MsgIdArr                                     CSD021
026760200529     C                   PARM      *BLANK        MsgDtaArr                                    CSD021
026770200529      *                                                                                       CSD021
026780200529      * Array index (3P0) from/to caller                                                      CSD021
026790200529     C                   PARM      *ZERO         Idx               3 0                        CSD021
026800200529      *                                                                                     BUG23518
026810200529     C                   PARM      *BLANKS       WFldNamArr                                 BUG23518
026820200529     C                   PARM      *BLANKS       WMsgIdArr                                  BUG23518
026830200529     C                   PARM      *BLANKS       WMsgDtaArr                                 BUG23518
026840200529     C                   PARM      *ZEROS        WIdx                                       BUG23518
026850200529                                                                                              CSD021
026860200529     C     DDACTNOK      IFNE      'N'                                                        CSD021
026870200529     C     DDCUSNOK      ANDNE     'N'                                                        CSD021
026880200529     C                   Eval      New_CNUMOK = 'Y'                                           CSD021
026890200529     C                   ENDIF                                                                CSD021
026900200529                                                                                              CSD021
026910200529     C                   EndDo                                                                CSD021
026920200529                                                                                              CSD021
026930200529     C                   Eval      CNLU = New_CNUM                                            CSD021
026940200529     C                   OUT       CNLU                                                       CSD021
026950200529                                                                                              CSD021
026960200529     C                   ENDSR                                                                CSD021
026970200529     C*****************************************************************
026980200529      /EJECT
026990200529     C****************************************************************
027000200529     C*                                                              *
027010200529     C* INSERT - INSERT A CUSTOMER                                   *
027020200529     C*                                                              *
027030200529     C****************************************************************
027040200529     C     INSERT        BEGSR
027050200529
027060200529      ** ACCESS CUSTOMER
027070200529
027080200529     C     A_CUCUST      CHAIN     SDCUSTL0                           99
027090200529
027100200529      ** DATABASE ERROR
027110200529
027120200529     C     *IN99         IFEQ      '0'
027130200529     C                   MOVEL     A_CUCUST      DBKEY
027140200529     C                   MOVEL     'SDCUSTPD'    DBFILE                         ************
027150200529     C                   MOVEL     '001'         DBASE                          * DBERR 001*
027160200529     C                   EXSR      SRERR                                        ************
027170200529     C                   END
027180200529
027190200529      ** INITIALIZE CUSTOMER
027200200529
027210200529     C                   CLEAR                   CUSTDF
027220200529
027230200529      ** Store Old fields for comparisons
027240200529     C                   MOVEL(P)  CUSTDF        B_CUSTD
027250200529
027260200529      ** SET CUSTOMER FIELDS ON INSERT
027270200529     C                   EVAL      BBCUST=A_CUCUST
027280200529     C                   EVAL      BBCSSN=A_CUCSSN
027290200529     C                   EVAL      BBCNA1=A_CUCNA1
027300200529     C                   EVAL      BBCNA2=A_CUCNA2
027310200529     C                   EVAL      BBCNA3=A_CUCNA3
027320200529     C                   EVAL      BBCNA4=A_CUCNA4
027330200529     C                   EVAL      BBCRTN=A_CUCRTN
027340200529     C                   EVAL      BBPAIN=A_CUPAIN
027350200529     C                   EVAL      BBCRNM=A_CUCRNM
027360200529     C                   EVAL      BBDRCS=A_CUDRCS
027370200529     C                   EVAL      BBLCCD=A_CULCCD
027380200529     C                   EVAL      BBACOC=A_CUACOC
027390200529     C                   EVAL      BBCNCZ=A_CUCNCZ
027400200529     C                   EVAL      BBCOLC=A_CUCOLC
027410200529     C                   EVAL      BBSSDT=0
027420200529     C                   EVAL      BBDOIC=A_CUDOIC
027430200529     C                   EVAL      BBPCNB=A_CUPCNB
027440200529     C                   EVAL      BBCASC=A_CUCASC
027450200529     C                   EVAL      BBBRCD=A_CUBRCD
027460200529     C                   EVAL      BBBNBI=A_CUBNBI
027470200529     C                   EVAL      BBLINC=A_CULINC
027480200529     C                   EVAL      BBLICD=A_CULICD
027490200529     C                   EVAL      BBCTNB=A_CUCTNB
027500200529     C                   EVAL      BBREID=A_CUREID
027510200529     C                   EVAL      BBBSIN=A_CUBSIN
027520200529     C                   EVAL      BBCSTY=A_CUCSTY
027530200529     C                   EVAL      BBTAIN=A_CUTAIN
027540200529     C                   EVAL      BBCSID=A_CUCSID
027550200529     C     CSW036        IFEQ      'Y'                                                        CSW036
027560200529     C                   EVAL      BBCSI2 = A_CUCSI2                                          CSW036
027570200529     C                   ENDIF                                                                CSW036
027580200529     C                   EVAL      BBSTAD=A_CUSTAD
027590200529     C                   EVAL      BBTXA1=A_CUTXA1
027600200529     C                   EVAL      BBTXA2=A_CUTXA2
027610200529     C                   EVAL      BBTXA3=A_CUTXA3
027620200529     C                   EVAL      BBTXA4=A_CUTXA4
027630200529     C                   EVAL      BBTXA5=A_CUTXA5
027640200529     C                   EVAL      BBCHID=A_CUCHID
027650200529     C                   EVAL      BBCHSC=A_CUCHSC
027660200529     C                   EVAL      BBCABA=A_CUCABA
027670200529     C                   EVAL      BBBFIC=A_CUBFIC
027680200529     C                   EVAL      BBBLCD=A_CUBLCD
027690200529     C                   EVAL      BBFWCD=A_CUFWCD
027700200529     C                   EVAL      BBLCD=BJRDNB
027710200529     C                   EVAL      BBTYLC='I'
027720200529     C                   EVAL      BBLALD=0
027730200529     C                   EVAL      BBLDHD=0
027740200529     C                   EVAL      BBLRLD=0
027750200529     C                   EVAL      BBDTDL=0
027760200529     C                   EVAL      BBLETI=A_CULETI
027770200529     C                   EVAL      BBCMTI=A_CUCMTI
027780200529     C                   EVAL      BBGSFM=A_CUGSFM
027790200529     C                   EVAL      BBSTFG=A_CUSTFG
027800200529     C                   EVAL      BBRWCD=A_CURWCD
027810200529     C                   EVAL      BBNG01=A_CUNG01
027820200529     C                   EVAL      BBNG02=A_CUNG02
027830200529     C                   EVAL      BBNG03=A_CUNG03
027840200529     C                   EVAL      BBNG04=A_CUNG04
027850200529     C                   EVAL      BBNG05=A_CUNG05
027860200529     C                   EVAL      BBNG06=A_CUNG06
027870200529     C                   EVAL      BBNG07=A_CUNG07
027880200529     C                   EVAL      BBNG08=A_CUNG08
027890200529     C                   EVAL      BBNG09=A_CUNG09
027900200529     C                   EVAL      BBNG10=A_CUNG10
027910200529     C                   EVAL      BBNG11=A_CUNG11
027920200529     C                   EVAL      BBNG12=A_CUNG12
027930200529     C                   EVAL      BBNG13=A_CUNG13
027940200529     C                   EVAL      BBNG14=A_CUNG14
027950200529     C                   EVAL      BBNG15=A_CUNG15
027960200529     C                   EVAL      BBDS01=A_CUDS01
027970200529     C                   EVAL      BBDS02=A_CUDS02
027980200529     C                   EVAL      BBDS03=A_CUDS03
027990200529     C                   EVAL      BBDS04=A_CUDS04
028000200529     C                   EVAL      BBDS05=A_CUDS05
028010200529     C                   EVAL      BBDS06=A_CUDS06
028020200529     C                   EVAL      BBDS07=A_CUDS07
028030200529     C                   EVAL      BBDS08=A_CUDS08
028040200529     C                   EVAL      BBDS09=A_CUDS09
028050200529     C                   EVAL      BBDS10=A_CUDS10
028060200529     C                   EVAL      BBDS11=A_CUDS11
028070200529     C                   EVAL      BBDS12=A_CUDS12
028080200529     C                   EVAL      BBDS13=A_CUDS13
028090200529     C                   EVAL      BBDS14=A_CUDS14
028100200529     C                   EVAL      BBDS15=A_CUDS15
028110200529     C                   EVAL      BBDNW1=A_CUDNW1
028120200529     C                   EVAL      BBDNW2=A_CUDNW2
028130200529     C                   EVAL      BBDNW3=A_CUDNW3
028140200529     C                   EVAL      BBDNW4=A_CUDNW4
028150200529     C                   EVAL      BBDNW5=A_CUDNW5
028160200529     C                   EVAL      BBDNW6=A_CUDNW6
028170200529     C                   EVAL      BBDNW7=A_CUDNW7
028180200529     C                   EVAL      BBDNW8=A_CUDNW8
028190200529     C                   EVAL      BBDNW9=A_CUDNW9
028200200529     C                   EVAL      BBCGRP=A_CUCGRP
028210200529     C                   EVAL      BBCDEL=A_CUCDEL
028220200529     C                   EVAL      BBABA2=A_CUABA2
028230200529     C                   EVAL      BBOGID=A_CUOGID
028240200529     C                   EVAL      BBSSDL=A_CUSSDL
028250200529     C                   EVAL      BBORED=BJRDNB
028260200529     C                   EVAL      BBMCAC=A_CUMCAC
028270200529     C                   EVAL      BBCRPC=A_CUCRPC
028280200529     C                   EVAL      BBPSWC=A_CUPSWC
028290200529     C                   EVAL      BBMGTP=A_CUMGTP
028300200529     C                   EVAL      BBNET='N'
028310200529     C                   EVAL      BBNTGP=A_CUNTGP
028320200529     C                   EVAL      BBNTCP='N'
028330200529     C                   EVAL      BBNTND=A_CUNTND
028340200529     C                   EVAL      BBNTMM='N'
028350200529     C                   EVAL      BBTICS=A_CUTICS
028360200529     C                   EVAL      BBSWFI=A_CUSWFI
028370200529     C                   EVAL      BBDINC=A_CUDINC
028380200529     C                   EVAL      BBPRBA=A_CUPRBA
028390200529     C                   EVAL      BBCLSS=A_CUCLSS                                            CDL008
028400200529     C                   EVAL      BBEFDT=A_CUEFDT                                            CDL008
028410200529     C**********         IF        CGL132 = 'Y'                                    MD030958 MD042407
028420200529      ** Extension file - SDCUSTXC                                                            CGL132
028430200529     C                   EVAL      XCCUST = A_CUCUST                                          CGL132
028440200529     C                   EVAL      XCBRCH = A_CUBRCD                                        MD050212
028450200529      ** Alternative Country of Citizenship                                                   CGL132
028460200529     C                   EVAL      XCACCZ=A_XCACCZ                                            CGL132
028470200529      ** Creation Date                                                                        CGL132
028480200529     C                   EVAL      XCCRDT=A_XCCRDT                                            CGL132
028490200529      ** Dormant Indicator                                                                    CGL132
028500200529     C                   EVAL      XCDRMT=A_XCDRMT                                            CGL132
028510200529      ** Last Change User                                                                     CGL132
028520200529     C**********         EVAL      XCLCUS=PSUSER                                     CGL132 MD026835
028530200529     C**********         EVAL      XCLCUS=WKUSER                                  MD026835 MD027492A
028540200529     C                   EVAL      XCLCUS=WLUSER                                           MD027492A
028550200529     C**********         ENDIF                                                     MD030958 MD042407
028560200529                                                                                              CSW024
028570200529     C                   IF        CSW024 = 'Y' and BGMSDL = 'Y'                              CSW024
028580200529     C                   EVAL      BBCORP=A_CUCORP                                            CSW024
028590200529     C                   EVAL      BBCBEI=A_CUCBEI                                            CSW024
028600200529     C                   EVAL      BBRI01=A_CURI01                                            CSW024
028610200529     C                   EVAL      BBRI02=A_CURI02                                            CSW024
028620200529     C                   EVAL      BBRI03=A_CURI03                                            CSW024
028630200529     C                   EVAL      BBRI04=A_CURI04                                            CSW024
028640200529     C                   EVAL      BBRI05=A_CURI05                                            CSW024
028650200529     C                   EVAL      BBFUND=A_CUFUND                                            CSW024
028660200529     C     CSW037        IFEQ      'Y'                                                        CSW037
028670200529     C                   EVAL      BBFNAC=A_CUFNAC                                            CSW037
028680200529     C                   ENDIF                                                                CSW037
028690200529     C                   ENDIF                                                                CSW024
028700200529     C     CSD025        IFEQ      'Y'                                                        CSD025
028710200529     C                   EVAL      BBDEAC = A_CUDEAC                                          CSD025
028720200529     C                   EVAL      BBDEDT = A_CUDEDT                                          CSD025
028730200529     C                   ENDIF                                                                CSD025
028740200529
028750200529      ** Front Office ID
028760200529     C                   EVAL      BBFRNT=A_CUFRNT
028770200529      ** Associated Front Office ID
028780200529     C                   EVAL      BBAFRT=A_CUAFRT
028790200529      ** Repair Location
028800200529     C                   EVAL      BBREPA=A_CUREPA
028810200529      *
028820200529      ** Timestamp
028830200529     C                   CALLB     'ZAGENTMSTM'
028840200529     C                   PARM                    TimeStamp
028850200529
028860200529     C                   EVAL      BBTMST  = TimeStamp
028870200529
028880200529      ** If CSC011 is installed, supply a Front Office ID for the                             CSC011
028890200529      ** transaction even if it originated from SIN module.                                   CSC011
028900200529                                                                                              CSC011
028910200529     C                   IF        CSC011 = 'Y'                                               CSC011
028920200529     C                   IF        BBFRNT = *BLANKS                                           CSC011
028930200529     C                   EVAL      BBFRNT = 'MD' + BBCUST                                     CSC011
028940200529     C                   ENDIF                                                                CSC011
028950200529     C                   ENDIF                                                                CSC011
028960200529                                                                                              CSC011
028970200529      ** If CSD015 = 'Y' and watch list checking applied                                      CSD015
028980200529                                                                                              CSD015
028990200529     C                   IF        CSD015 = 'Y'                                               CSD015
029000200529     C                             AND W1EWLC = 'Y'                                           CSD015
029010200529                                                                                              CSD015
029020200529      ** If user is in the main system                                                        CSD015
029030200529                                                                                              CSD015
029040200529     C                   IF        CSC011 <> 'Y'                                              CSD015
029050200529     C                             OR CSC011 = 'Y' AND S1MAIN = LIBR                          CSD015
029060200529                                                                                              CSD015
029070200529      ** If any of the watch list fields has been entered                                     CSD015
029080200529                                                                                              CSD015
029090200529     C                   IF        BBCNA1 <> *BLANKS                                          CSD015
029100200529     C                             OR BBCNA2 <> *BLANKS                                       CSD015
029110200529     C                             OR BBCNA3 <> *BLANKS                                       CSD015
029120200529     C                             OR BBCNA4 <> *BLANKS                                       CSD015
029130200529     C                             OR BBCSID <> *BLANKS                                       CSD015
029140200529     C                             OR BBCNCZ <> *BLANKS                                       CSD015
029150200529     C                             OR BBCOLC <> *BLANKS                                       CSD015
029160200529                                                                                              CSD015
029170200529     C                   EXSR      SRWTCH                                                     CSD015
029180200529                                                                                              CSD015
029190200529     C                   ENDIF                                                                CSD015
029200200529     C                   ENDIF                                                                CSD015
029210200529     C                   ENDIF                                                                CSD015
029220200529                                                                                              CSD015
029230200529      ** Set Facility Mandatory, Include Offsets, and                                         CLE025
029240200529      ** FX Margin Types flags                                                                CLE025
029250200529                                                                                              CLE025
029260200529     C                   IF        CLE025 = 'Y'                                               CLE025
029270200529     C                             OR  CFX001 = 'Y'                                           CFX001
029280200529     C                   EVAL      BBFCMF = A_CUFCMF                                          CLE025
029290200529     C                   EVAL      BBINOF = A_CUINOF                                          CLE025
029300200529     C                   EVAL      BBMSTF = A_CUMSTF                                          CLE025
029310200529     C                   EVAL      BBIOPC = A_CUIOPC                                          CLE025
029320200529     C                   ENDIF                                                                CLE025
029330200529                                                                                              CSD031
029340200529     C**********         IF        CSD037 = 'Y'                                      CSD031 BUG13525
029350200529     C**********         EVAL      BBAACC = A_CUAACC                                 CSD031 BUG13525
029360200529     C**********         EVAL      BBEACC = BJRDNB                                   CSD031 BUG13525
029370200529     C**********         EVAL      BBGPDT = A_CUGPDT                                 CSD031 BUG13525
029380200529     C**********         ENDIF                                                       CSD031 BUG13525
029390200529                                                                                              CSD079
029400200529      ** Set Fx netting Fields                                                                CSD079
029410200529                                                                                              CSD079
029420200529     C                   IF        CSD079 = 'Y'                                               CSD079
029430200529     C                             AND CDL002 = 'Y'                                           CSD079
029440200529     C                   EVAL      BBNET = A_CUNET                                            CSD079
029450200529     C                   EVAL      BBNTGP = A_CUNTGP                                          CSD079
029460200529     C                   EVAL      BBNTCP = A_CUNTCP                                          CSD079
029470200529     C                   EVAL      BBNTND = A_CUNTND                                          CSD079
029480200529     C                   EVAL      BBNTMM = A_CUNTMM                                          CSD079
029490200529     C                   EVAL      BBTICS = A_CUTICS                                          CSD079
029500200529     C                   EVAL      BBSWFI = A_CUSWFI                                          CSD079
029510200529     C                   ENDIF                                                                CSD079
029520200529                                                                                              CSD079
029530200529      ** Set Fiduciary Deposits Fields                                                        CSD079
029540200529                                                                                              CSD079
029550200529     C                   IF        CSD079 = 'Y'                                               CSD079
029560200529     C                             AND CDL006 = 'Y'                                           CSD079
029570200529     C                   EVAL      BBCOMG = A_CUCOMG                                          CSD079
029580200529     C                   EVAL      BBCHRG = A_CUCHRG                                          CSD079
029590200529     C                   EVAL      BBAGNT = A_CUAGNT                                          CSD079
029600200529     C                   EVAL      BBAGNP = A_CUAGNP                                          CSD079
029610200529     C                   EVAL      BBTRAS = A_CUTRAS                                          CSD079
029620200529     C                   EVAL      BBNAR1 = A_CUNAR1                                          CSD079
029630200529     C                   EVAL      BBNAR2 = A_CUNAR2                                          CSD079
029640200529     C                   EVAL      BBNAR3 = A_CUNAR3                                          CSD079
029650200529     C                   EVAL      BBNAR4 = A_CUNAR4                                          CSD079
029660200529     C                   EVAL      BBDFAC = A_CUDFAC                                          CSD079
029670200529     C                   EVAL      BBDFAS = A_CUDFAS                                          CSD079
029680200529                                                                                              CSD079
029690200529     C                   ENDIF                                                                CSD079
029700200529      **********                                                                  AR679445 MD027492A
029710200529     C**********         MOVE      WKUSER        BBIUSR                           AR679445 MD027492A
029720200529                                                                                           MD027492A
029730200529     C                   EVAL      BBIUSR = WLUSER                                         MD027492A
029740200529     C                   EVAL      BBXUSR = WKUSER                                         MD027492A
029750200529      *
029760200529      ** Update the SWIFT 2007 field details when CSW207 is on                                CSW207
029770200529     C**********         IF        CSW207 = 'Y' OR BGN4ST = 'Y'                      CSW207 BUG15138
029780200529     C     A_CUCUST      CHAIN     SDCSSWL0                                                   CSW207
029790200529     C                   IF        NOT %FOUND(SDCSSWL0)                                       CSW207
029800200529     C                   EVAL      CSCUSD = A_CUCUST                                          CSW207
029810200529     C                   EVAL      CSBRCA = A_CUBRCD                                          CSW207
029820200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                             BUG15138
029830200529     C                   EVAL      CSCICI = A_CUCICI                                          CSW207
029840200529     C                   EVAL      CSCPCI = A_CUCPCI                                          CSW207
029850200529     C                   ENDIF                                                              BUG15138
029860200529     C                   EVAL      CSIBEI = A_CUIBEI                                          CSW207
029870200529     C                   IF        CFT050 = 'Y'                                               CFT050
029880200529     C                   EVAL      CSLEIC = S13DDLEIC                                         CFT050
029890200529     C                   EVAL      CSCLSY = S13DDCLSY                                         CFT050
029900200529     C                   EVAL      CSCLID = S13DDCLID                                         CFT050
029910200529     C                   EVAL      CSBDRK = S13DDBDRK                                         CFT050
029920200529     C                   ENDIF                                                                CFT050
029930200529     C                   WRITE     SDCSSWD0                                                   CSW207
029940200529     C                   ENDIF                                                                CSW207
029950200529     C**********         ENDIF                                                       CSW207 BUG15138
029960200529      *                                                                                       CSW207
029970200529      ** WRITE NEW CUSTOMER
029980200529
029990200529     C                   WRITE     @BBREBG
030000200529     C**********         IF        CGL132 = 'Y'                                    MD030958 MD042407
030010200529      ** Write into extension file - SDCUSTXC                                                 CGL132
030020200529     C                                                                                        CGL132
030030200529     C                   WRITE     SDCUSTX1                                                   CGL132
030040200529     C**********         ENDIF                                                     MD030958 MD042407
030050200529                                                                                              CSD092
030060200529     C                   IF        CSD092 = 'Y' AND                                           CGL132
030070200529     C                             CGL132 = 'N'                                               CGL132
030080200529     C                   IF        S01425 = 'Y' AND                                           CSD092
030090200529     C                             CSD079 = 'Y'                                               CSD092
030100200529     C                   ELSE                                                                 CSD092
030110200529                                                                                              CSD092
030120200529     C                   IF        S01425 <> 'Y' OR CSD079 <> 'Y'                           MD026957
030130200529     C                   CALL      'SD009696'                                                 CSD092
030140200529     C                   PARM      BBCUST        PCUST                                        CSD092
030150200529     C                   PARM      *BLANKS       PBefCUST                                     CSD092
030160200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
030170200529     C                   PARM      *BLANKS       PBefACUS                                     CSD092
030180200529     C                   PARM      *BLANKS       PAftACUS                                     CSD092
030190200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
030200200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL132
030210200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
030220200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
030230200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
030240200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
030250200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
030260200529     C                   PARM      *BLANKS       PAftCUXC                                   MD026854
030270200529     C                   PARM      *BLANKS       PACRV                                        CSD092
030280200529     C                   PARM      *BLANKS       PELEC                                        CGL132
030290200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
030300200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
030310200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
030320200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
030330200529     C                   ENDIF                                                              MD026957
030340200529     C                   ENDIF                                                                CSD092
030350200529     C                   ENDIF                                                                CSD092
030360200529
030370200529     C/COPY WNCPYSRC,SDH00752
030380200529      ** Update Global Customer X-Reference                                                   CGP001
030390200529                                                                                              CGP001
030400200529     C                   IF        CGP001 = 'Y'                                               CGP001
030410200529     C                   EXSR      SRUpdGlbID                                                 CGP001
030420200529     C                   ENDIF                                                                CGP001
030430200529                                                                                              CGP001
030440200529     C/COPY WNCPYSRC,SDCUSDDC03
030450200529     C                   Z-ADD     1             WUNORC            5 0          No of records
030460200529     C                   Z-ADD     *ZERO         WUNOAM            5 0          No of Amend
030470200529     C                   Z-ADD     *ZERO         WUNODL            5 0          No of delete
030480200529     C                   Z-ADD     1             WUNOIN            5 0          No of Insert
030490200529      * Change Standing Data Cont - Standing Data Controls  *
030500200529     C                   MOVEL     'SDCUSTPD'    WFLNAME           8            No of delete
030510200529     C                   EXSR      SNCHRC
030520200529      *                                                                                      BUG3362
030530200529     C                   EXSR      UPDTID                                                    BUG3362
030540200529      *
030550200529      * retrieve marketing groups to pass to SDCLINT for update of CLINTC
030560200529      * Customer marketing groups - Customer Marketing Groups  *
030570200529     C                   EXSR      SORVGN
030580200529                                                                                              CGL132
030590200529     C                   IF        CGL132 = 'Y'                                               CGL132
030600200529                                                                                            MD027606
030610200529     C                   MOVE      TimeStamp     WTime                                      MD027606
030620200529     C     *HMS0         MOVE      WTime         WWTIME                                     MD027606
030630200529                                                                                            MD027606
030640200529     C                   CLEAR                   SDFTCS                                       CGL132
030650200529     C                   EVAL      FACUST = BBCUST                                            CGL132
030660200529     C                   EVAL      FABRCH = BBBRCD                                          MD026518
030670200529     C                   EVAL      FACLAC = A_FVCLAC                                          CGL132
030680200529     C                   EVAL      FACLAD = A_FVCLAD                                          CGL132
030690200529     C                   EVAL      FAPCLA = A_FVPCLA                                          CGL132
030700200529     C                   EVAL      FAHMSV = A_FVHMSV                                          CGL132
030710200529     C                   EVAL      FAHMSD = A_FVHMSD                                          CGL132
030720200529     C                   EVAL      FAHMOV = A_FVHMOV                                          CGL132
030730200529     C                   IF        FAHMOV <> *BLANKS                                        MD027606
030740200529     C                   EVAL      FAHMON = WLUSER                                          MD027606
030750200529     C                   EVAL      FAHMOD = BJRDNB                                          MD027606
030760200529     C                   EVAL      FAHMOT = WWTIME                                          MD027606
030770200529     C                   ENDIF                                                              MD027606
030780200529     C                   EVAL      FAHMD1 = A_FVHMD1                                          CGL132
030790200529     C                   EVAL      FAHMD2 = A_FVHMD2                                          CGL132
030800200529     C                   EVAL      FAHMD3 = A_FVHMD3                                          CGL132
030810200529     C                   EVAL      FAHMD4 = A_FVHMD4                                          CGL132
030820200529     C                   EVAL      FAHMD5 = A_FVHMD5                                          CGL132
030830200529     C                   EVAL      FAHMS1 = A_FVHMS1                                          CGL132
030840200529     C                   EVAL      FAHMS2 = A_FVHMS2                                          CGL132
030850200529     C                   EVAL      FAHMS3 = A_FVHMS3                                          CGL132
030860200529     C                   EVAL      FAHMS4 = A_FVHMS4                                          CGL132
030870200529     C                   EVAL      FAHMS5 = A_FVHMS5                                          CGL132
030880200529     C                   EVAL      FAHMCO = A_FVHMCO                                          CGL132
030890200529     C                   EVAL      FAMCSV = A_FVMCSV                                          CGL132
030900200529     C                   EVAL      FAMCSD = A_FVMCSD                                          CGL132
030910200529     C                   EVAL      FAMCOV = A_FVMCOV                                          CGL132
030920200529     C                   IF        FAMCOV <> *BLANKS                                        MD027606
030930200529     C                   EVAL      FAMCON = WLUSER                                          MD027606
030940200529     C                   EVAL      FAMCOD = BJRDNB                                          MD027606
030950200529     C                   EVAL      FAMCOT = WWTIME                                          MD027606
030960200529     C                   ENDIF                                                              MD027606
030970200529     C                   EVAL      FAMCD1 = A_FVMCD1                                          CGL132
030980200529     C                   EVAL      FAMCD2 = A_FVMCD2                                          CGL132
030990200529     C                   EVAL      FAMCD3 = A_FVMCD3                                          CGL132
031000200529     C                   EVAL      FAMCD4 = A_FVMCD4                                          CGL132
031010200529     C                   EVAL      FAMCD5 = A_FVMCD5                                          CGL132
031020200529     C                   EVAL      FAMCS1 = A_FVMCS1                                          CGL132
031030200529     C                   EVAL      FAMCS2 = A_FVMCS2                                          CGL132
031040200529     C                   EVAL      FAMCS3 = A_FVMCS3                                          CGL132
031050200529     C                   EVAL      FAMCS4 = A_FVMCS4                                          CGL132
031060200529     C                   EVAL      FAMCS5 = A_FVMCS5                                          CGL132
031070200529     C                   EVAL      FAMCCO = A_FVMCCO                                          CGL132
031080200529     C                   EVAL      FARPSV = A_FVRPSV                                          CGL132
031090200529     C                   EVAL      FARPSD = A_FVRPSD                                          CGL132
031100200529     C                   EVAL      FARPOV = A_FVRPOV                                          CGL132
031110200529     C                   IF        FARPOV <> *BLANKS                                        MD027606
031120200529     C                   EVAL      FARPON = WLUSER                                          MD027606
031130200529     C                   EVAL      FARPOD = BJRDNB                                          MD027606
031140200529     C                   EVAL      FARPOT = WWTIME                                          MD027606
031150200529     C                   ENDIF                                                              MD027606
031160200529     C                   EVAL      FARPD1 = A_FVRPD1                                          CGL132
031170200529     C                   EVAL      FARPD2 = A_FVRPD2                                          CGL132
031180200529     C                   EVAL      FARPD3 = A_FVRPD3                                          CGL132
031190200529     C                   EVAL      FARPD4 = A_FVRPD4                                          CGL132
031200200529     C                   EVAL      FARPD5 = A_FVRPD5                                          CGL132
031210200529     C                   EVAL      FARPS1 = A_FVRPS1                                          CGL132
031220200529     C                   EVAL      FARPS2 = A_FVRPS2                                          CGL132
031230200529     C                   EVAL      FARPS3 = A_FVRPS3                                          CGL132
031240200529     C                   EVAL      FARPS4 = A_FVRPS4                                          CGL132
031250200529     C                   EVAL      FARPS5 = A_FVRPS5                                          CGL132
031260200529     C                   EVAL      FARPCO = A_FVRPCO                                          CGL132
031270200529     C                   EVAL      FAAUSV = A_FVAUSV                                          CGL132
031280200529     C                   EVAL      FAAUSD = A_FVAUSD                                          CGL132
031290200529     C                   EVAL      FAAUOV = A_FVAUOV                                          CGL132
031300200529     C                   IF        FAAUOV <> *BLANKS                                        MD027606
031310200529     C                   EVAL      FAAUON = WLUSER                                          MD027606
031320200529     C                   EVAL      FAAUOD = BJRDNB                                          MD027606
031330200529     C                   EVAL      FAAUOT = WWTIME                                          MD027606
031340200529     C                   ENDIF                                                              MD027606
031350200529     C                   EVAL      FAAUD1 = A_FVAUD1                                          CGL132
031360200529     C                   EVAL      FAAUD2 = A_FVAUD2                                          CGL132
031370200529     C                   EVAL      FAAUD3 = A_FVAUD3                                          CGL132
031380200529     C                   EVAL      FAAUD4 = A_FVAUD4                                          CGL132
031390200529     C                   EVAL      FAAUD5 = A_FVAUD5                                          CGL132
031400200529     C                   EVAL      FAAUS1 = A_FVAUS1                                          CGL132
031410200529     C                   EVAL      FAAUS2 = A_FVAUS2                                          CGL132
031420200529     C                   EVAL      FAAUS3 = A_FVAUS3                                          CGL132
031430200529     C                   EVAL      FAAUS4 = A_FVAUS4                                          CGL132
031440200529     C                   EVAL      FAAUS5 = A_FVAUS5                                          CGL132
031450200529     C                   EVAL      FAAUCO = A_FVAUCO                                          CGL132
031460200529     C                   EVAL      FACISV = A_FVCISV                                          CGL132
031470200529     C                   EVAL      FACISD = A_FVCISD                                          CGL132
031480200529     C                   EVAL      FACIOV = A_FVCIOV                                          CGL132
031490200529     C                   IF        FACIOV <> *BLANKS                                        MD027606
031500200529     C                   EVAL      FACION = WLUSER                                          MD027606
031510200529     C                   EVAL      FACIOD = BJRDNB                                          MD027606
031520200529     C                   EVAL      FACIOT = WWTIME                                          MD027606
031530200529     C                   ENDIF                                                              MD027606
031540200529     C                   EVAL      FACID1 = A_FVCID1                                          CGL132
031550200529     C                   EVAL      FACID2 = A_FVCID2                                          CGL132
031560200529     C                   EVAL      FACID3 = A_FVCID3                                          CGL132
031570200529     C                   EVAL      FACID4 = A_FVCID4                                          CGL132
031580200529     C                   EVAL      FACID5 = A_FVCID5                                          CGL132
031590200529     C                   EVAL      FACIS1 = A_FVCIS1                                          CGL132
031600200529     C                   EVAL      FACIS2 = A_FVCIS2                                          CGL132
031610200529     C                   EVAL      FACIS3 = A_FVCIS3                                          CGL132
031620200529     C                   EVAL      FACIS4 = A_FVCIS4                                          CGL132
031630200529     C                   EVAL      FACIS5 = A_FVCIS5                                          CGL132
031640200529     C                   EVAL      FACICO = A_FVCICO                                          CGL132
031650200529     C                   EVAL      FACBSV = A_FVCBSV                                          CGL132
031660200529     C                   EVAL      FACBSD = A_FVCBSD                                          CGL132
031670200529     C                   EVAL      FACBOV = A_FVCBOV                                          CGL132
031680200529     C                   IF        FACBOV <> *BLANKS                                        MD027606
031690200529     C                   EVAL      FACBON = WLUSER                                          MD027606
031700200529     C                   EVAL      FACBOD = BJRDNB                                          MD027606
031710200529     C                   EVAL      FACBOT = WWTIME                                          MD027606
031720200529     C                   ENDIF                                                              MD027606
031730200529     C                   EVAL      FACBD1 = A_FVCBD1                                          CGL132
031740200529     C                   EVAL      FACBD2 = A_FVCBD2                                          CGL132
031750200529     C                   EVAL      FACBD3 = A_FVCBD3                                          CGL132
031760200529     C                   EVAL      FACBD4 = A_FVCBD4                                          CGL132
031770200529     C                   EVAL      FACBD5 = A_FVCBD5                                          CGL132
031780200529     C                   EVAL      FACBS1 = A_FVCBS1                                          CGL132
031790200529     C                   EVAL      FACBS2 = A_FVCBS2                                          CGL132
031800200529     C                   EVAL      FACBS3 = A_FVCBS3                                          CGL132
031810200529     C                   EVAL      FACBS4 = A_FVCBS4                                          CGL132
031820200529     C                   EVAL      FACBS5 = A_FVCBS5                                          CGL132
031830200529     C                   EVAL      FACBCO = A_FVCBCO                                          CGL132
031840200529     C                   EVAL      FACDSV = A_FVCDSV                                          CGL132
031850200529     C                   EVAL      FACDSD = A_FVCDSD                                          CGL132
031860200529     C                   EVAL      FACDOV = A_FVCDOV                                          CGL132
031870200529     C                   IF        FACDOV <> *BLANKS                                        MD027606
031880200529     C                   EVAL      FACDON = WLUSER                                          MD027606
031890200529     C                   EVAL      FACDOD = BJRDNB                                          MD027606
031900200529     C                   EVAL      FACDOT = WWTIME                                          MD027606
031910200529     C                   ENDIF                                                              MD027606
031920200529     C                   EVAL      FACDD1 = A_FVCDD1                                          CGL132
031930200529     C                   EVAL      FACDD2 = A_FVCDD2                                          CGL132
031940200529     C                   EVAL      FACDD3 = A_FVCDD3                                          CGL132
031950200529     C                   EVAL      FACDD4 = A_FVCDD4                                          CGL132
031960200529     C                   EVAL      FACDD5 = A_FVCDD5                                          CGL132
031970200529     C                   EVAL      FACDS1 = A_FVCDS1                                          CGL132
031980200529     C                   EVAL      FACDS2 = A_FVCDS2                                          CGL132
031990200529     C                   EVAL      FACDS3 = A_FVCDS3                                          CGL132
032000200529     C                   EVAL      FACDS4 = A_FVCDS4                                          CGL132
032010200529     C                   EVAL      FACDS5 = A_FVCDS5                                          CGL132
032020200529     C                   EVAL      FACDCO = A_FVCDCO                                          CGL132
032030200529     C                   EVAL      FAGCSV = A_FVGCSV                                          CGL132
032040200529     C                   EVAL      FAGCSD = A_FVGCSD                                          CGL132
032050200529     C                   EVAL      FAGCOV = A_FVGCOV                                          CGL132
032060200529     C                   IF        FAGCOV <> *BLANKS                                        MD027606
032070200529     C                   EVAL      FAGCON = WLUSER                                          MD027606
032080200529     C                   EVAL      FAGCOD = BJRDNB                                          MD027606
032090200529     C                   EVAL      FAGCOT = WWTIME                                          MD027606
032100200529     C                   ENDIF                                                              MD027606
032110200529     C                   EVAL      FAGCD1 = A_FVGCD1                                          CGL132
032120200529     C                   EVAL      FAGCD2 = A_FVGCD2                                          CGL132
032130200529     C                   EVAL      FAGCD3 = A_FVGCD3                                          CGL132
032140200529     C                   EVAL      FAGCD4 = A_FVGCD4                                          CGL132
032150200529     C                   EVAL      FAGCD5 = A_FVGCD5                                          CGL132
032160200529     C                   EVAL      FAGCS1 = A_FVGCS1                                          CGL132
032170200529     C                   EVAL      FAGCS2 = A_FVGCS2                                          CGL132
032180200529     C                   EVAL      FAGCS3 = A_FVGCS3                                          CGL132
032190200529     C                   EVAL      FAGCS4 = A_FVGCS4                                          CGL132
032200200529     C                   EVAL      FAGCS5 = A_FVGCS5                                          CGL132
032210200529     C                   EVAL      FAGCCO = A_FVGCCO                                          CGL132
032220200529     C                   EVAL      FAIDSV = A_FVIDSV                                          CGL132
032230200529     C                   EVAL      FAIDSD = A_FVIDSD                                          CGL132
032240200529     C                   EVAL      FAIDOV = A_FVIDOV                                          CGL132
032250200529     C                   IF        FAIDOV <> *BLANKS                                        MD027606
032260200529     C                   EVAL      FAIDON = WLUSER                                          MD027606
032270200529     C                   EVAL      FAIDOD = BJRDNB                                          MD027606
032280200529     C                   EVAL      FAIDOT = WWTIME                                          MD027606
032290200529     C                   ENDIF                                                              MD027606
032300200529     C                   EVAL      FAIDD1 = A_FVIDD1                                          CGL132
032310200529     C                   EVAL      FAIDD2 = A_FVIDD2                                          CGL132
032320200529     C                   EVAL      FAIDD3 = A_FVIDD3                                          CGL132
032330200529     C                   EVAL      FAIDD4 = A_FVIDD4                                          CGL132
032340200529     C                   EVAL      FAIDD5 = A_FVIDD5                                          CGL132
032350200529     C                   EVAL      FAIDS1 = A_FVIDS1                                          CGL132
032360200529     C                   EVAL      FAIDS2 = A_FVIDS2                                          CGL132
032370200529     C                   EVAL      FAIDS3 = A_FVIDS3                                          CGL132
032380200529     C                   EVAL      FAIDS4 = A_FVIDS4                                          CGL132
032390200529     C                   EVAL      FAIDS5 = A_FVIDS5                                          CGL132
032400200529     C                   EVAL      FAIDCO = A_FVIDCO                                          CGL132
032410200529     C                   EVAL      FAJASV = A_FVJASV                                          CGL132
032420200529     C                   EVAL      FAJASD = A_FVJASD                                          CGL132
032430200529     C                   EVAL      FAJAOV = A_FVJAOV                                          CGL132
032440200529     C                   IF        FAJAOV <> *BLANKS                                        MD027606
032450200529     C                   EVAL      FAJAON = WLUSER                                          MD027606
032460200529     C                   EVAL      FAJAOD = BJRDNB                                          MD027606
032470200529     C                   EVAL      FAJAOT = WWTIME                                          MD027606
032480200529     C                   ENDIF                                                              MD027606
032490200529     C                   EVAL      FAJAD1 = A_FVJAD1                                          CGL132
032500200529     C                   EVAL      FAJAD2 = A_FVJAD2                                          CGL132
032510200529     C                   EVAL      FAJAD3 = A_FVJAD3                                          CGL132
032520200529     C                   EVAL      FAJAD4 = A_FVJAD4                                          CGL132
032530200529     C                   EVAL      FAJAD5 = A_FVJAD5                                          CGL132
032540200529     C                   EVAL      FAJAS1 = A_FVJAS1                                          CGL132
032550200529     C                   EVAL      FAJAS2 = A_FVJAS2                                          CGL132
032560200529     C                   EVAL      FAJAS3 = A_FVJAS3                                          CGL132
032570200529     C                   EVAL      FAJAS4 = A_FVJAS4                                          CGL132
032580200529     C                   EVAL      FAJAS5 = A_FVJAS5                                          CGL132
032590200529     C                   EVAL      FAJACO = A_FVJACO                                          CGL132
032600200529     C                   EVAL      FATESV = A_FVTESV                                          CGL132
032610200529     C                   EVAL      FATESD = A_FVTESD                                          CGL132
032620200529     C                   EVAL      FATEOV = A_FVTEOV                                          CGL132
032630200529     C                   IF        FATEOV <> *BLANKS                                        MD027606
032640200529     C                   EVAL      FATEON = WLUSER                                          MD027606
032650200529     C                   EVAL      FATEOD = BJRDNB                                          MD027606
032660200529     C                   EVAL      FATEOT = WWTIME                                          MD027606
032670200529     C                   ENDIF                                                              MD027606
032680200529     C                   EVAL      FATED1 = A_FVTED1                                          CGL132
032690200529     C                   EVAL      FATED2 = A_FVTED2                                          CGL132
032700200529     C                   EVAL      FATED3 = A_FVTED3                                          CGL132
032710200529     C                   EVAL      FATED4 = A_FVTED4                                          CGL132
032720200529     C                   EVAL      FATED5 = A_FVTED5                                          CGL132
032730200529     C                   EVAL      FATES1 = A_FVTES1                                          CGL132
032740200529     C                   EVAL      FATES2 = A_FVTES2                                          CGL132
032750200529     C                   EVAL      FATES3 = A_FVTES3                                          CGL132
032760200529     C                   EVAL      FATES4 = A_FVTES4                                          CGL132
032770200529     C                   EVAL      FATES5 = A_FVTES5                                          CGL132
032780200529     C                   EVAL      FATECO = A_FVTECO                                          CGL132
032790200529     C                   EVAL      FATXSV = A_FVTXSV                                          CGL132
032800200529     C                   EVAL      FATXSD = A_FVTXSD                                          CGL132
032810200529     C                   EVAL      FATXOV = A_FVTXOV                                          CGL132
032820200529     C                   IF        FATXOV <> *BLANKS                                        MD027606
032830200529     C                   EVAL      FATXON = WLUSER                                          MD027606
032840200529     C                   EVAL      FATXOD = BJRDNB                                          MD027606
032850200529     C                   EVAL      FATXOT = WWTIME                                          MD027606
032860200529     C                   ENDIF                                                              MD027606
032870200529     C                   EVAL      FATXD1 = A_FVTXD1                                          CGL132
032880200529     C                   EVAL      FATXD2 = A_FVTXD2                                          CGL132
032890200529     C                   EVAL      FATXD3 = A_FVTXD3                                          CGL132
032900200529     C                   EVAL      FATXD4 = A_FVTXD4                                          CGL132
032910200529     C                   EVAL      FATXD5 = A_FVTXD5                                          CGL132
032920200529     C                   EVAL      FATXS1 = A_FVTXS1                                          CGL132
032930200529     C                   EVAL      FATXS2 = A_FVTXS2                                          CGL132
032940200529     C                   EVAL      FATXS3 = A_FVTXS3                                          CGL132
032950200529     C                   EVAL      FATXS4 = A_FVTXS4                                          CGL132
032960200529     C                   EVAL      FATXS5 = A_FVTXS5                                          CGL132
032970200529     C                   EVAL      FATXCO = A_FVTXCO                                          CGL132
032980200529     C                   EVAL      FAEXEM = A_FVEXEM                                          CGL132
032990200529     C                   EVAL      FAEXER = A_FVEXER                                          CGL132
033000200529     C                   EVAL      FAEXED = A_FVEXED                                          CGL132
033010200529     C                   EVAL      FAEXET = A_FVEXET                                          CGL132
033020200529     C                   EVAL      FAEXEU = A_FVEXEU                                          CGL132
033030200529     C                   EVAL      FAREPT = A_FVREPT                                          CGL132
033040200529     C                   EVAL      FAGIIN = A_FVGIIN                                          CGL132
033050200529     C                   EVAL      FAGIID = A_FVGIID                                          CGL132
033060200529     C                   EVAL      FAGIIO = A_FVGIIO                                          CGL132
033070200529     C                   EVAL      FAUTIN = A_FVUTIN                                          CGL132
033080200529     C                   EVAL      FAGREC = A_FVGREC                                          CGL132
033090200529     C                   EVAL      FAMAIL = A_FVMAIL                                          CGL132
033100200529     C                   EVAL      FAPHON = A_FVPHON                                          CGL132
033110200529     C                   EVAL      FACSTY = A_FVCSTY                                          CGL132
033120200529     C                   EVAL      FACSST = A_FVCSST                                          CGL132
033130200529     C                   EVAL      FARPTT = A_FVRPTT                                          CGL132
033140200529     C                   EVAL      FARPTR = A_FVRPTR                                          CGL132
033150200529     C                   EVAL      FARPTD = A_FVRPTD                                          CGL132
033160200529     C                   EVAL      FARPTM = A_FVRPTM                                          CGL132
033170200529     C                   IF        FARPTM = '******'                                        MD051206
033180200529     C                   MOVE      BBTMST        WTime                                      MD051206
033190200529     C     *HMS0         MOVE      WTime         FARPTM                                     MD051206
033200200529     C                   ENDIF                                                              MD051206
033210200529     C                   EVAL      FARPTU = A_FVRPTU                                          CGL132
033220200529     C                   EVAL      FAHVAC = A_FVHVAC                                          CGL132
033230200529     C                   EVAL      FAINFC = A_FVINFC                                          CGL132
033240200529     C                   EVAL      FAEXMA = A_FVEXMA                                          CGL132
033250200529     C                   EVAL      FAEXID = A_FVEXID                                          CGL132
033260200529     C                   EVAL      FALDAT = BJRDNB                                            CGL132
033270200529     C                   EVAL      FALCTP = 'I'                                               CGL132
033280200529     C**********         EVAL      FALUSR = PSUSER                                   CGL132 MD026835
033290200529     C**********         EVAL      FALUSR = WKUSER                                 MD026835 MD027492
033300200529     C**********         EVAL      FALUSR = A_FVRPTU                              MD027492 MD027492A
033310200529     C                   EVAL      FALUSR = WLUSER                                         MD027492A
033320200529     C                   EVAL      FAREPA = A_FVREPA                                          CGL132
033330200529     C                   EVAL      FAFOID = A_FVFOID                                          CGL132
033340200529     C                   EVAL      FAREPI = A_FVREPI                                          CGL132
033350200529     C                   WRITE     SDFTCSD0                                                   CGL132
033360200529                                                                                              CGL132
033370200529     C                   IF        CSD092 = 'Y'                                               CGL132
033380200529     C                   EVAL      PAftFTCS = SDFTCS                                        MD026957
033390200529     C                   EVAL      PAftCUXC = SDCUXC                                        MD026957
033400200529     C                   IF        S01425 <> 'Y' OR CSD079 <> 'Y'                           MD026957
033410200529     C                   IF        CGL157 = 'N'                                               CGL157
033420200529     C                   CALL      'SD009696'                                                 CGL132
033430200529     C                   PARM      FACUST        PCUST                                        CGL132
033440200529     C                   PARM      *BLANKS       PBefCUST                                     CGL132
033450200529     C                   PARM      CUSTDF        PAftCUST                                     CGL132
033460200529     C                   PARM      *BLANKS       PBefACUS                                     CGL132
033470200529     C                   PARM      *BLANKS       PAftACUS                                     CGL132
033480200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
033490200529     C                   PARM      SDFTCS        PAftFTCS                                     CGL132
033500200529     C                   PARM      *BLANKS       PBefJACC                                     CGL132
033510200529     C                   PARM      *BLANKS       PAftJACC                                     CGL132
033520200529     C                   PARM      *BLANKS       PBefCUAH                                     CGL132
033530200529     C                   PARM      *BLANKS       PAftCUAH                                     CGL132
033540200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
033550200529     C                   PARM      SDCUXC        PAftCUXC                                   MD026854
033560200529     C                   PARM      *BLANKS       PACRV                                        CGL132
033570200529     C                   PARM      *BLANKS       PELEC                                        CGL132
033580200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
033590200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
033600200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
033610200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
033620200529     C                   ENDIF                                                                CGL157
033630200529     C                   ENDIF                                                              MD026957
033640200529                                                                                              CGL132
033650200529     C                   IF        CGL132 = 'Y' AND                                           CGL132
033660200529     C                             FAHVAC = 'H'                                               CGL132
033670200529     C                   EVAL      KCUST = FACUST                                             CGL132
033680200529     C                   EVAL      KSCDT = BJRDNB                                             CGL132
033690200529     C                   EVAL      KSEQN = 999                                                CGL132
033700200529     C                   EVAL      ARSEQN = 0                                                 CGL132
033710200529     C     KACRV         SETGT     SDACRVL0                                                   CGL132
033720200529     C                   READP     SDACRVL0                                                   CGL132
033730200529                                                                                              CGL132
033740200529     C                   IF        ARCUST = KCUST AND                                         CGL132
033750200529     C                             ARSCDT = KSCDT                                             CGL132
033760200529     C                   EVAL      AVSEQN = ARSEQN + 1                                        CGL132
033770200529     C                   ELSE                                                                 CGL132
033780200529     C                   CLEAR                   SDACRVDF                                   MD045218
033790200529     C                   EVAL      AVSEQN = 1                                                 CGL132
033800200529     C                   ENDIF                                                                CGL132
033810200529                                                                                              CGL132
033820200529     C**********         CLEAR                   SDACRVDF                            CGL132 MD045218
033830200529                                                                                              CGL132
033840200529     C                   EVAL      ARCUST = FACUST                                            CGL132
033850200529     C                   EVAL      ARSEQN = AVSEQN                                            CGL132
033860200529     C                   EVAL      ARPURP = 'FATCA High Value +                               CGL132
033870200529     C                                      Account Review'                                   CGL132
033880200529     C**********         EVAL      ARSCDT = BJRDNB                                   CGL132 MD026502
033890200529     C                   EVAL      ARACRF = SVal2                                             CGL132
033900200529     C                   EVAL      ARCOMP = 'N'                                               CGL132
033910200529                                                                                            MD026502
033920200529      ** Calculate for Schedule Date                                                        MD026502
033930200529     C                   CALL      'SD000164'                                               MD026502
033940200529     C                   PARM      *BLANKS       RtCdScDt          7                        MD026502
033950200529     C                   PARM      ARACRF        AcRvFreq          1                        MD026502
033960200529     C                   PARM      ARCOMP        AcRvComp          1                        MD026502
033970200529     C                   PARM                    BJDFIN                                     MD026502
033980200529     C                   PARM                    BJCYCD                                     MD026502
033990200529     C                   PARM                    BJLCCY                                     MD026502
034000200529     C                   PARM                    BJSLCD                                     MD026502
034010200529     C                   PARM                    BJRDNB                                     MD026502
034020200529     C                   PARM      0             AcRvScDt          5 0                      MD026502
034030200529      ** Account Review Schedule Date                                                       MD026502
034040200529     C                   EVAL      ARSCDT = AcRvScDt                                        MD026502
034050200529                                                                                              CGL132
034060200529      ** Get timestamp.                                                                       CGL132
034070200529                                                                                              CGL132
034080200529     C                   CALLB     'ZAGENTMSTM'                                               CGL132
034090200529     C                   PARM                    WWTMST                                       CGL132
034100200529     C                   MOVE      WWTMST        ARTMST                                       CGL132
034110200529                                                                                              CGL132
034120200529     C                   EVAL      ARMAGE = 'G'                                               CGL132
034130200529     C                   EVAL      ARLTYP = 'I'                                               CGL132
034140200529     C**********         EVAL      ARLUSR = PSUSER                                   CGL132 MD026835
034150200529     C**********         EVAL      ARLUSR = WKUSER                                MD026835 MD027492A
034160200529     C                   EVAL      ARLUSR = WLUSER                                         MD027492A
034170200529     C                   EVAL      ARINDT = BJRDNB                                            CGL132
034180200529     C                   EVAL      ARFOID = *BLANKS                                           CGL132
034190200529                                                                                              CGL132
034200200529     C                   WRITE     SDACRVD0                                                   CGL132
034210200529     C**********         ENDIF                                                      CGL132 MD026499A
034220200529                                                                                              CGL132
034230200529     C                   EVAL      EXDDCUST = ARCUST                                        MD026499
034240200529     C                   EVAL      EXDDSCDF = *BLANKS                                       MD026499
034250200529     C                   MOVEL     ARSCDT        EXDDSCDF                                   MD026499
034260200529     C                   EVAL      EXDDSEQN = %TRIML(%CHAR(ARSEQN):'0')                     MD026499
034270200529     C                   EVAL      EXDDFOID = ARFOID                                        MD026499
034280200529     C                   WRITE     TSDACRVD0                                                MD026499
034290200529                                                                                            MD026499
034300200529     C                   ENDIF                                                             MD026499A
034310200529     C                   ENDIF                                                                CGL132
034320200529     C                   ENDIF                                                                CGL132
034330200529                                                                                              CGL157
034340200529      ** Access CRS Transaction Details if CGL157 is *ON                                      CGL157
034350200529                                                                                              CGL157
034360200529     C                   EVAL      PBefCRSH = *BLANKS                                         CGL177
034370200529     C                   EVAL      PAftCRSH = *BLANKS                                         CGL177
034380200529     C                   IF        CGL157 = 'Y'                                               CGL157
034390200529                                                                                              CGL157
034400200529      ** Write new Transaction Detail                                                         CGL177
034410200529                                                                                              CGL177
034420200529     C                   EVAL      CRCUST = BBCUST                                            CGL177
034430200529     C                   EVAL      CRTYPE = C_CVTYPE                                          CGL177
034440200529     C                   EVAL      CRSTYP = C_CVSTYP                                          CGL177
034450200529     C                   EVAL      CRHVAL = C_CVHVAL                                          CGL177
034460200529     C                   EVAL      CREXMP = C_CVEXMP                                          CGL177
034470200529     C                   EVAL      CREXMR = C_CVEXMR                                          CGL177
034480200529     C                   EVAL      CREXMD = C_CVEXMD                                          CGL177
034490200529     C                   EVAL      CREXMT = C_CVEXMT                                          CGL177
034500200529     C                   EVAL      CREXMU = C_CVEXMU                                          CGL177
034510200529     C                   EVAL      CRINFO = C_CVINFO                                          CGL177
034520200529     C                   EVAL      CREXMG = C_CVEXMG                                          CGL177
034530200529     C                   EVAL      CREXMI = C_CVEXMI                                          CGL177
034540200529     C                   EVAL      CRLDAT = BJRDNB                                            CGL177
034550200529     C                   EVAL      CRLCTP = 'I'                                               CGL177
034560200529     C                   WRITE     SDCRSHD0                                                   CGL157
034570200529     C                   EVAL      PAftCRSH = SDCRSH                                          CGL177
034580200529                                                                                              CGL177
034590200529      ** CRS Country Details                                                                  CGL177
034600200529     C                   EVAL      A = 1                                                      CGL177
034610200529     C                   EVAL      X = 1                                                      CGL157
034620200529     C                   DOW       X < 31                                                     CGL157
034630200529     C                   EVAL      SDVCRSD =  PCrsdF(X)                                       CGL157
034640200529     C                   EVAL      PCrsdZ = PCrsdF(X)                                         CGL157
034650200529     C                   IF        D_CVCTRY <> *Blanks                                        CGL157
034660200529     C                   EVAL      KCUST = BBCUST                                             CGL177
034670200529     C                   EVAL      KCTRY = D_CVCTRY                                           CGL177
034680200529     C     KCRSD         CHAIN     SDCRSDL1                                                   CGL177
034690200529     C                   EVAL      SDCRSDB = SDCRSD                                           CGL177
034700200529     C                   EVAL      CDCUST = BBCUST                                            CGL157
034710200529     C                   EVAL      CDCTRY = D_CVCTRY                                          CGL157
034720200529     C                   EVAL      CDREPT = D_CVREPT                                          CGL157
034730200529     C                   EVAL      CDREPR = D_CVREPR                                          CGL157
034740200529                                                                                            MD036375
034750200529      ** Look for the US Country and use the TIN if provided                                MD036375
034760200529     C                   IF        CGL132 = 'Y' AND                                         MD036375
034770200529     C                             CGL133 = 'N'                                             MD036375
034780200529     C*****BBCUST        CHAIN     SDFTCSL0                             99         MD036375 MD051230
034790200529     C     BBCUST        CHAIN(N)  SDFTCSL0                             99                  MD051230
034800200529                                                                                            MD036375
034810200529      ** Database error                                                                     MD036375
034820200529     C                   IF        NOT %FOUND(SDFTCSL0)                                     MD036375
034830200529     C                   EVAL      DBKEY  = BBCUST                                          MD036375
034840200529     C                   EVAL      DBFILE = 'SDFTCSPD'                                      MD036375
034850200529     C                   EVAL      DBASE  =  801                                            MD036375
034860200529     C                   EXSR      SRErr                                                    MD036375
034870200529     C                   ENDIF                                                              MD036375
034880200529                                                                                            MD036375
034890200529     C                   EVAL      WCTAX = SVal1                                            MD036375
034900200529                                                                                            MD036375
034910200529     C                   IF        BBCOLC = WCTAX                                           MD036375
034920200529     C     BBCUST        CHAIN     SDFTCSL0                             99                  MD051230
034930200529     C                   EVAL      FAUTIN = E5TINO                                          MD036375
034940200529     C                   UPDATE    SDFTCSD0                                                 MD036375
034950200529     C                   ELSE                                                               MD036457
034960200529     C                   IF        D_CVCTRY = WCTAX                                         MD036457
034970200529     C     BBCUST        CHAIN     SDFTCSL0                             99                  MD051230
034980200529     C                   EVAL      FAUTIN = D_CVTINN                                        MD036457
034990200529     C                   UPDATE    SDFTCSD0                                                 MD036457
035000200529     C                   ENDIF                                                              MD036457
035010200529     C                   ENDIF                                                              MD036457
035020200529     C                   ENDIF                                                              MD036375
035030200529                                                                                            MD036375
035040200529     C                   IF        %SUBST(PCrsdZ:138:3) = *Blanks                             CGL157
035050200529     C                   EVAL      CDREPD = *Zero                                             CGL157
035060200529     C                   ELSE                                                                 CGL157
035070200529     C                   MOVE      D_CVREPD      CDREPD                                       CGL157
035080200529     C                   ENDIF                                                                CGL157
035090200529     C                   EVAL      CDREPM = D_CVREPM                                          CGL157
035100200529     C                   IF        CDREPM = '******'                                          CGL177
035110200529     C**********         MOVE      E5TMST        WTime                               CGL177 MD051230
035120200529     C                   MOVE      BBTMST        WTime                                      MD051230
035130200529     C     *HMS0         MOVE      WTime         CDREPM                                       CGL177
035140200529     C                   ENDIF                                                                CGL177
035150200529     C                   EVAL      CDREPU = D_CVREPU                                          CGL157
035160200529     C                   EVAL      CDEVE1 = D_CVEVE1                                          CGL157
035170200529     C                   EVAL      CDEVS1 = D_CVEVS1                                          CGL157
035180200529     C                   EVAL      CDEVE2 = D_CVEVE2                                          CGL157
035190200529     C                   EVAL      CDEVS2 = D_CVEVS2                                          CGL157
035200200529     C                   EVAL      CDEVE3 = D_CVEVE3                                          CGL157
035210200529     C                   EVAL      CDEVS3 = D_CVEVS3                                          CGL157
035220200529     C                   EVAL      CDEVE4 = D_CVEVE4                                          CGL157
035230200529     C                   EVAL      CDEVS4 = D_CVEVS4                                          CGL157
035240200529     C                   EVAL      CDEVE5 = D_CVEVE5                                          CGL157
035250200529     C                   EVAL      CDEVS5 = D_CVEVS5                                          CGL157
035260200529     C                   EVAL      CDTINN = D_CVTINN                                          CGL157
035270200529     C                   EVAL      CDCODO = D_CVCODO                                          CGL157
035280200529     C                   EVAL      CDJACM = D_CVJACM                                          CGL157
035290200529     C                   EVAL      CDMAIL = D_CVMAIL                                          CGL157
035300200529     C                   EVAL      CDPHON = D_CVPHON                                          CGL157
035310200529     C                   EVAL      CDRPAY = D_CVRPAY                                          CGL157
035320200529     C                   EVAL      CDTINS = D_CVTINS                                          CGL177
035330200529     C                   IF        %SUBST(PCrsdZ:207:3) = *Blanks                             CGL157
035340200529     C                   EVAL      CDEFFD = *Zero                                             CGL157
035350200529     C                   ELSE                                                                 CGL157
035360200529     C                   MOVE      D_CVEFFD      CDEFFD                                       CGL157
035370200529     C                   ENDIF                                                                CGL157
035380200529     C                   IF        %SUBST(PCrsdZ:210:3) = *Blanks                             CGL157
035390200529     C                   EVAL      CDEXPD = *Zero                                             CGL157
035400200529     C                   ELSE                                                                 CGL157
035410200529     C                   MOVE      D_CVEXPD      CDEXPD                                       CGL157
035420200529     C                   ENDIF                                                                CGL157
035430200529     C                   IF        %FOUND(SDCRSDL1)                                           CGL177
035440200529     C                   IF        %SUBST(PCrsdZ:3:1) <> '*'                                  CGL177
035450200529     C                   EVAL      %SUBST(PBefCRSD:A:219) = SDCRSDB                           CGL177
035460200529     C                   EVAL      %SUBST(PAftCRSD:A:219) = SDCRSD                            CGL177
035470200529     C                   EVAL      A = A + 229                                                CGL177
035480200529     C                   UPDATE    SDCRSDD0                                                   CGL177
035490200529     C                   ELSE                                                                 CGL177
035500200529     C                   DELETE    SDCRSDD0                                                   CGL177
035510200529     C                   ENDIF                                                                CGL177
035520200529     C                   ELSE                                                                 CGL177
035530200529     C                   IF        %SUBST(PCrsdZ:3:1) <> '*'                                  CGL177
035540200529     C                   EVAL      %SUBST(PBefCRSD:A:219) = *Blanks                           CGL177
035550200529     C                   EVAL      %SUBST(PAftCRSD:A:219) = SDCRSD                            CGL177
035560200529     C                   EVAL      A = A + 229                                                CGL177
035570200529     C                   WRITE     SDCRSDD0                                                   CGL157
035580200529     C                   ENDIF                                                                CGL177
035590200529     C                   ENDIF                                                                CGL177
035600200529     C                   ENDIF                                                                CGL157
035610200529     C                   EVAL      X = X + 1                                                  CGL157
035620200529     C                   ENDDO                                                                CGL157
035630200529     C                   ENDIF                                                                CGL157
035640200529                                                                                              CGL177
035650200529     C                   IF        CSD092 = 'Y'                                               CGL177
035660200529     C                             AND NOT(S01425 = 'Y' AND CSD079 = 'Y')                     CGL177
035670200529     C                   IF        CGL132 = 'Y'                                               CGL177
035680200529     C                   EVAL      PBefFTCS = SDFTCS2                                         CGL177
035690200529     C                   EVAL      PAftFTCS = SDFTCS                                          CGL177
035700200529     C                   ELSE                                                                 CGL177
035710200529     C                   EVAL      PBefFTCS = *BLANKS                                         CGL177
035720200529     C                   EVAL      PAftFTCS = *BLANKS                                         CGL177
035730200529     C                   ENDIF                                                                CGL177
035740200529     C                   IF        CGL157 = 'N'                                               CGL177
035750200529     C                   EVAL      PBefCRSH = *BLANKS                                         CGL177
035760200529     C                   EVAL      PAftCRSH = *BLANKS                                         CGL177
035770200529     C                   EVAL      PBefCRSD = *BLANKS                                         CGL177
035780200529     C                   EVAL      PAftCRSD = *BLANKS                                         CGL177
035790200529     C                   ENDIF                                                                CGL177
035800200529                                                                                            MD041429
035810200529      ** Separate call of History of Customer Info program                                  MD041429
035820200529      ** for CRS Header (Miscellaneous Change)                                              MD041429
035830200529                                                                                            MD041429
035840200529     C                   IF        CGL132 = 'Y'                                               CGL157
035850200529     C                   CALL      'SD009696'                                                 CGL177
035860200529     C                   PARM      BBCUST        PCUST                                        CGL177
035870200529     C                   PARM      *BLANKS       PBefCUST                                     CGL177
035880200529     C                   PARM      CUSTDF        PAftCUST                                     CGL177
035890200529     C                   PARM      *BLANKS       PBefACUS                                     CGL177
035900200529     C                   PARM      *BLANKS       PAftACUS                                     CGL177
035910200529     C                   PARM                    PBefFTCS                                     CGL177
035920200529     C                   PARM                    PAftFTCS                                     CGL177
035930200529     C                   PARM      *BLANKS       PBefJACC                                     CGL177
035940200529     C                   PARM      *BLANKS       PAftJACC                                     CGL177
035950200529     C                   PARM      *BLANKS       PBefCUAH                                   MD054883
035960200529     C                   PARM      *BLANKS       PAftCUAH                                   MD054883
035970200529     C                   PARM      *BLANKS       PBefCUXC                                     CGL177
035980200529     C                   PARM      *BLANKS       PAftCUXC                                     CGL177
035990200529     C                   PARM      *BLANKS       PACRV                                        CGL177
036000200529     C                   PARM      *BLANKS       PELEC                                        CGL177
036010200529     C                   PARM                    PBefCRSH                                     CGL177
036020200529     C                   PARM                    PAftCRSH                                     CGL177
036030200529     C                   PARM      *BLANKS       XBefCRSD                                     CGL177
036040200529     C                   PARM      *BLANKS       XAftCRSD                                     CGL177
036050200529                                                                                              CGL177
036060200529     C                   ELSE                                                                 CGL177
036070200529                                                                                              CGL177
036080200529     C                   CALL      'SD009696'                                                 CGL177
036090200529     C                   PARM      BBCUST        PCUST                                        CGL177
036100200529     C                   PARM      *BLANKS       PBefCUST                                     CGL177
036110200529     C                   PARM      CUSTDF        PAftCUST                                     CGL177
036120200529     C                   PARM      *BLANKS       PBefACUS                                     CGL177
036130200529     C                   PARM      *BLANKS       PAftACUS                                     CGL177
036140200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL177
036150200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL177
036160200529     C                   PARM      *BLANKS       PBefJACC                                     CGL177
036170200529     C                   PARM      *BLANKS       PAftJACC                                     CGL177
036180200529     C                   PARM      *BLANKS       PBefCUAH                                   MD054883
036190200529     C                   PARM      *BLANKS       PAftCUAH                                   MD054883
036200200529     C                   PARM      *BLANKS       PBefCUXC                                     CGL177
036210200529     C                   PARM      *BLANKS       PAftCUXC                                     CGL177
036220200529     C                   PARM      *BLANKS       PACRV                                        CGL177
036230200529     C                   PARM      *BLANKS       PELEC                                        CGL177
036240200529     C                   PARM                    PBefCRSH                                     CGL177
036250200529     C                   PARM                    PAftCRSH                                     CGL177
036260200529     C                   PARM      *BLANKS       XBefCRSD                                   MD041429
036270200529     C                   PARM      *BLANKS       XAftCRSD                                   MD041429
036280200529     C                   ENDIF                                                              MD041429
036290200529                                                                                            MD041429
036300200529      ** and CRS Details (CRS Indicia Change)                                               MD041429
036310200529                                                                                            MD041429
036320200529     C                   CALL      'SD009696'                                               MD041429
036330200529     C                   PARM      BBCUST        PCUST                                      MD041429
036340200529     C                   PARM      *BLANKS       PBefCUST                                   MD041429
036350200529     C                   PARM      *BLANKS       PAftCUST                                   MD041429
036360200529     C                   PARM      *BLANKS       PBefACUS                                   MD041429
036370200529     C                   PARM      *BLANKS       PAftACUS                                   MD041429
036380200529     C                   PARM      *BLANKS       PBefFTCS                                   MD041429
036390200529     C                   PARM      *BLANKS       PAftFTCS                                   MD041429
036400200529     C                   PARM      *BLANKS       PBefJACC                                   MD041429
036410200529     C                   PARM      *BLANKS       PAftJACC                                   MD041429
036420200529     C                   PARM      *BLANKS       PBefCUAH                                   MD054883
036430200529     C                   PARM      *BLANKS       PAftCUAH                                   MD054883
036440200529     C                   PARM      *BLANKS       PBefCUXC                                   MD041429
036450200529     C                   PARM      *BLANKS       PAftCUXC                                   MD041429
036460200529     C                   PARM      *BLANKS       PACRV                                      MD041429
036470200529     C                   PARM      *BLANKS       PELEC                                      MD041429
036480200529     C                   PARM      *BLANKS       PBefCRSH                                   MD041429
036490200529     C                   PARM      *BLANKS       PAftCRSH                                   MD041429
036500200529     C                   PARM                    PBefCRSD                                   MD041429
036510200529     C                   PARM                    PAftCRSD                                   MD041429
036520200529     C                   ENDIF                                                              MD041429
036530200529                                                                                            MD041429
036540200529
036550200529      * Update CLINTCB - Client Details  *
036560200529     C                   CALL      'SDCLINT'
036570200529     C                   PARM      *BLANK        @RTCD
036580200529     C                   PARM      BBCUST        @CUST             6
036590200529     C                   PARM      BBCSSN        @CSSN            10
036600200529     C                   PARM      BBCRTN        @CRTN            10
036610200529     C                   PARM      BBPAIN        @PAIN             1
036620200529     C                   PARM      BBCRNM        @CRNM            20
036630200529     C                   PARM      BBACOC        @ACOC             2
036640200529     C                   PARM      BBCNCZ        @CNCZ             2
036650200529     C                   PARM      BBCOLC        @COLC             2
036660200529     C                   PARM      BBSSDT        @SSDT             5 0
036670200529     C                   PARM      BBDOIC        @DOIC             5 0
036680200529     C                   PARM      BBPCNB        @PCNB             6
036690200529     C                   PARM      BBCASC        @CASC             8
036700200529     C                   PARM      BBBRCD        @BRCD             3
036710200529     C                   PARM      BBBNBI        @BNBI             1
036720200529     C                   PARM      BBLINC        @LINC             2
036730200529     C                   PARM      BBLICD        @LICD             3
036740200529     C                   PARM      BBCTNB        @CTNB            12
036750200529     C                   PARM      BBREID        @REID             4
036760200529     C                   PARM      BBBSIN        @BSIN             1
036770200529     C                   PARM      BBCSTY        @CSTY             1
036780200529     C                   PARM      BBTAIN        @TAIN             1
036790200529     C                   PARM      BBCSID        @CSID            12
036800200529     C                   PARM      BBSTAD        @STAD            12
036810200529     C                   PARM      BBTXA1        @TXA1            10
036820200529     C                   PARM      BBCHID        @CHID             6 0
036830200529     C                   PARM      BBCHSC        @CHSC             6 0
036840200529     C                   PARM      BBCABA        @CABA             3 0
036850200529     C                   PARM      BBRWCD        @RWCD             4
036860200529     C                   PARM      BBCGRP        @CGRP             1
036870200529     C                   PARM      BBABA2        @ABA2             4 0
036880200529     C                   PARM      BBTYLC        @TYLC             1
036890200529     C                   PARM      BJRDNB        @RDNB             5 0
036900200529     C                   PARM      WUGPC1        @GPC1             4
036910200529     C                   PARM      WUGPC2        @GPC2             4
036920200529     C                   PARM      WUGPC3        @GPC3             4
036930200529     C                   PARM      WUGPC4        @GPC4             4
036940200529     C                   PARM      WUGPC5        @GPC5             4
036950200529     C                   PARM      A_ADLNID      @LNID             2                        AR830675
036960200529     C                   PARM      A_ADCTYP      @CTYP            10                        AR830675
036970200529     C/COPY WNCPYSRC,SDCUSDDC06
036980200529      * Send message 'Unable to update'
036990200529     C     @RTCD         IFEQ      '*ERROR*'
037000200529     C                   MOVEL     *BLANK        DBKEY
037010200529     C                   MOVEL     BBCUST        DBKEY
037020200529     C                   MOVEL     'CLINTCB'     DBFILE                         ************
037030200529     C                   MOVEL     '002'         DBASE                          * DBERR 002*
037040200529     C                   EXSR      SRERR                                        ************
037050200529     C                   END
037060200529
037070200529      * Update CLINTCC 2 - Client Details  *
037080200529     C                   CALL      'SDALTNA'
037090200529     C                   PARM      *BLANK        @RTCD
037100200529     C                   PARM      BBCUST        @CUST             6
037110200529     C                   PARM      BBCNA1        @CNA1            35
037120200529     C                   PARM      BBCNA2        @CNA2            35
037130200529     C                   PARM      BBCNA3        @CNA3            35
037140200529     C                   PARM      BBCNA4        @CNA4            35
037150200529     C                   PARM      BBCRTN        @CRTN            10
037160200529     C                   PARM      BBTYLC        @TYLC             1
037170200529     C                   PARM      BJRDNB        @RDNB             5 0
037180200529      * Send message 'Unable to update'
037190200529     C     @RTCD         IFEQ      '*ERROR*'
037200200529     C                   MOVEL     *BLANK        DBKEY
037210200529     C                   MOVEL     BBCUST        DBKEY
037220200529     C                   MOVEL     'CLINTCC'     DBFILE                         ************
037230200529     C                   MOVEL     '003'         DBASE                          * DBERR 003*
037240200529     C                   EXSR      SRERR                                        ************
037250200529     C                   END
037260200529      *
037270200529
037280200529     C                   ENDSR
037290200529     C****************************************************************
037300200529      /EJECT
037310200529     C****************************************************************
037320200529     C*                                                              *
037330200529     C* AMEND  - AMEND A CUSTOMER                                    *
037340200529     C*                                                              *
037350200529     C****************************************************************
037360200529     C     AMEND         BEGSR
037370200529
037380200529      ** ACCESS CUSTOMER DETAILS RECORD
037390200529
037400200529     C*****A_CUCUST      CHAIN     SDCUSTL0                           99                      252069
037410200529     C     A_CUCUST      CHAIN     SDCUSTL0                           9997                    252069
037420200529     C                   EXSR      ChkChain                                                   252069
037430200529
037440200529      ** DATABASE ERROR
037450200529
037460200529     C     *IN99         IFEQ      '1'
037470200529     C     CSD028        ANDEQ     'N'                                                        CSD028
037480200529     C     CSD028        OREQ      'Y'                                                        CSD028
037490200529     C     PTransType    ANDNE     'AUTH'                                                     CSD028
037500200529     C     AUTHRQ        ANDEQ     'Y'                                                      MD053436
037510200529     C                   MOVEL     A_CUCUST      DBKEY
037520200529     C                   MOVEL     'SDCUSTPD'    DBFILE                         ************
037530200529     C                   MOVEL     '004'         DBASE                          * DBERR 004*
037540200529     C                   EXSR      SRERR                                        ************
037550200529     C                   END
037560200529                                                                                              CGL132
037570200529     C                   IF        CGL132 = 'Y'                                               CGL132
037580200529     C                   CLEAR                   CUSTDF2                                      CGL132
037590200529     C                   MOVE      CUSTDF        CUSTDF2                                      CGL132
037600200529     C                   ENDIF                                                                CGL132
037610200529                                                                                              CSD028
037620200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                       CSD028
037630200529     C     A_CUCUST      CHAIN     SDCDSHD0                           99                      CSD028
037640200529     C     *IN99         IFEQ      '1'                                                        CSD028
037650200529     C                   MOVEL     A_CUCUST      DBKEY                                        CSD028
037660200529     C                   MOVEL     'SDCDSHPD'    DBFILE                         ************  CSD028
037670200529     C                   MOVEL     '024'         DBASE                          * DBERR 024*  CSD028
037680200529     C                   EXSR      SRERR                                        ************  CSD028
037690200529     C                   END                                                                  CSD028
037700200529     C                   EVAL      CUSTDF = SDVCDSH                                           CSD028
037710200529     C                   ENDIF                                                                CSD028
037720200529
037730200529      ** UPDATE 'BEFORE' STATUS
037740200529                                                                                              CGL132
037750200529      ** DATABASE ERROR                                                                       CGL132
037760200529                                                                                              CGL132
037770200529     C     A_CUCUST      CHAIN     SDCUSTX1                           99                      CGL132
037780200529     C                   CLEAR                   SDCUXC2                                    MD026854
037790200529     C                   MOVE      SDCUXC        SDCUXC2                                    MD026854
037800200529     C     *IN99         IFEQ      '1'                                                        CGL132
037810200529     C*****CGL132        ANDEQ     'Y'                                             MD030958 MD042407
037820200529     C                   MOVEL     A_CUCUST      DBKEY                                        CGL132
037830200529     C                   MOVEL     'SDCUSTXC'    DBFILE                         ************  CGL132
037840200529     C                   MOVEL     '004'         DBASE                          * DBERR 004*  CGL132
037850200529     C                   EXSR      SRERR                                        ************  CGL132
037860200529     C                   ENDIF                                                                CGL132
037870200529
037880200529     C                   MOVEL(P)  CUSTDF        B_CUSTD
037890200529                                                                                185595
037900200529      ** Check if change of customer branch                                     185595
037910200529                                                                                185595
037920200529     C     BBBRCD        IFNE      A_CUBRCD                                     185595
037930200529     C     BBTAIN        ORNE      A_CUTAIN                                                   217230
037940200529     C                   EVAL      *IN20='1'                                    185595
037950200529     C                   ELSE                                                   185595
037960200529     C                   EVAL      *IN20='0'                                    185595
037970200529     C                   END                                                    185595
037980200529     C/COPY WNCPYSRC,SDCUSDDC04
037990200529
038000200529      ** SET CUSTOMER FIELDS ON AMEND
038010200529
038020200529      * CASE: DB1.Customer Swift Id NE PAR.Customer Swift Id
038030200529     C     BBCSID        IFNE      A_CUCSID
038040200529     C                   CALL      'SD0012U'                            91
038050200529     C                   PARM      BBCSID        @CSIDO           12
038060200529     C                   PARM      A_CUCSID      @CSIDN           12
038070200529     C                   PARM      *BLANK        @SWBL             1
038080200529     C                   PARM      BBCUST        @CNUM             6                          210006
038090200529      * Call to program ended in error
038100200529     C     *IN91         IFEQ      '1'
038110200529     C                   MOVEL     *BLANK        DBKEY
038120200529     C                   MOVEL     BBCSID        DBKEY
038130200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************
038140200529     C                   MOVEL     '005'         DBASE                          * DBERR 005*
038150200529     C                   EXSR      SRERR                                        ************
038160200529     C                   END
038170200529      * CASE: WRK.Swift Blank is True
038180200529     C     @SWBL         IFEQ      '1'
038190200529     C                   MOVEL     *BLANK        DBKEY
038200200529     C                   MOVEL     BBCSID        DBKEY
038210200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************
038220200529     C                   MOVEL     '006'         DBASE                          * DBERR 006*
038230200529     C                   EXSR      SRERR                                        ************
038240200529     C                   END
038250200529     C                   END
038260200529      *                                                                                       CSW036
038270200529      * CASE: DB1.Customer Swift Id 2 NE PAR.Customer Swift Id 2                              CSW036
038280200529     C     CSW036        IFEQ      'Y'                                                        CSW036
038290200529     C     BBCSI2        ANDNE     A_CUCSI2                                                   CSW036
038300200529     C                   CALL      'SD0012U1'                           91                    CSW036
038310200529     C                   PARM      BBCSI2        @CSIDO           12                          CSW036
038320200529     C                   PARM      A_CUCSI2      @CSIDN           12                          CSW036
038330200529     C                   PARM      *BLANK        @SWBL             1                          CSW036
038340200529     C                   PARM      BBCUST        @CNUM             6                          CSW036
038350200529      * Call to program ended in error                                                        CSW036
038360200529     C     *IN91         IFEQ      '1'                                                        CSW036
038370200529     C                   MOVEL     *BLANK        DBKEY                                        CSW036
038380200529     C                   MOVEL     BBCSI2        DBKEY                                        CSW036
038390200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************  CSW036
038400200529     C                   MOVEL     '025'         DBASE                          * DBERR 025*  CSW036
038410200529     C                   EXSR      SRERR                                        ************  CSW036
038420200529     C                   END                                                                  CSW036
038430200529      * CASE: WRK.Swift Blank is True                                                         CSW036
038440200529     C     @SWBL         IFEQ      '1'                                                        CSW036
038450200529     C                   MOVEL     *BLANK        DBKEY                                        CSW036
038460200529     C                   MOVEL     BBCSI2        DBKEY                                        CSW036
038470200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************  CSW036
038480200529     C                   MOVEL     '026'         DBASE                          * DBERR 026*  CSW036
038490200529     C                   EXSR      SRERR                                        ************  CSW036
038500200529     C                   END                                                                  CSW036
038510200529     C                   END                                                                  CSW036
038520200529      *
038530200529      * CASE: DB1.Telex Address 1 NE PAR.Telex Address 1
038540200529     C     BBTXA1        IFNE      A_CUTXA1
038550200529     C                   CALL      'SD0013U'                            91
038560200529     C                   PARM      BBTXA1        @TXA1O           12
038570200529     C                   PARM      BBSTAD        @STADO           12
038580200529     C                   PARM      A_CUTXA1      @TAX1N           12
038590200529     C                   PARM      A_CUSTAD      @STADN           12
038600200529     C                   PARM      *BLANK        @TXBL             1
038610200529      * Call to program ended in error
038620200529     C     *IN91         IFEQ      '1'
038630200529     C                   MOVEL     *BLANK        DBKEY
038640200529     C                   MOVEL     BBTXA1        DBKEY
038650200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************
038660200529     C                   MOVEL     '007'         DBASE                          * DBERR 007*
038670200529     C                   EXSR      SRERR                                        ************
038680200529     C                   END
038690200529      * CASE: WRK.Telex Blank is true
038700200529     C     @TXA1         IFEQ      '1'
038710200529     C                   MOVEL     *BLANK        DBKEY
038720200529     C                   MOVEL     BBTXA1        DBKEY
038730200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************
038740200529     C                   MOVEL     '008'         DBASE                          * DBERR 008*
038750200529     C                   EXSR      SRERR                                        ************
038760200529     C                   END
038770200529      *
038780200529     C                   ELSE
038790200529      * CASE: *OTHERWISE
038800200529      * CASE: DB1.STTX Address NE PAR.STTX Address
038810200529     C     BBSTAD        IFNE      A_CUSTAD
038820200529     C                   CALL      'SD0013U'                            91
038830200529     C                   PARM      BBTXA1        @TXA1O           12
038840200529     C                   PARM      BBSTAD        @STADO           12
038850200529     C                   PARM      A_CUTXA1      @TAX1N           12
038860200529     C                   PARM      A_CUSTAD      @STADN           12
038870200529     C                   PARM      @TXBL         @TXBL             1
038880200529      * Call to program ended in error
038890200529     C     *IN91         IFEQ      '1'
038900200529     C                   MOVEL     *BLANK        DBKEY
038910200529     C                   MOVEL     BBTXA1        DBKEY
038920200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************
038930200529     C                   MOVEL     '009'         DBASE                          * DBERR 009*
038940200529     C                   EXSR      SRERR                                        ************
038950200529     C                   END
038960200529      * CASE: WRK.Telex Blank is true
038970200529     C     @TXA1         IFEQ      '1'
038980200529     C                   MOVEL     *BLANK        DBKEY
038990200529     C                   MOVEL     BBTXA1        DBKEY
039000200529     C                   MOVEL     'MOGREFLZ'    DBFILE                         ************
039010200529     C                   MOVEL     '010'         DBASE                          * DBERR 010*
039020200529     C                   EXSR      SRERR                                        ************
039030200529     C                   END
039040200529     C                   ENDIF
039050200529      *
039060200529     C                   ENDIF
039070200529      *
039080200529      ** MOVE NON-KEY FIELDS
039090200529     C                   EVAL      BBCSSN=A_CUCSSN
039100200529     C                   EVAL      BBCNA1=A_CUCNA1
039110200529     C                   EVAL      BBCNA2=A_CUCNA2
039120200529     C                   EVAL      BBCNA3=A_CUCNA3
039130200529     C                   EVAL      BBCNA4=A_CUCNA4
039140200529     C                   EVAL      BBCRTN=A_CUCRTN
039150200529     C                   EVAL      BBPAIN=A_CUPAIN
039160200529     C                   EVAL      BBCRNM=A_CUCRNM
039170200529     C                   EVAL      BBDRCS=A_CUDRCS
039180200529     C                   EVAL      BBLCCD=A_CULCCD
039190200529     C                   EVAL      BBACOC=A_CUACOC
039200200529     C                   EVAL      BBCNCZ=A_CUCNCZ
039210200529     C                   EVAL      BBCOLC=A_CUCOLC
039220200529     C                   EVAL      BBSSDT=A_CUSSDT
039230200529     C                   EVAL      BBDOIC=A_CUDOIC
039240200529     C                   EVAL      BBPCNB=A_CUPCNB
039250200529     C                   EVAL      BBCASC=A_CUCASC
039260200529     C                   EVAL      BBBRCD=A_CUBRCD
039270200529     C                   EVAL      BBBNBI=A_CUBNBI
039280200529     C                   EVAL      BBLINC=A_CULINC
039290200529     C                   EVAL      BBLICD=A_CULICD
039300200529     C                   EVAL      BBCTNB=A_CUCTNB
039310200529     C                   EVAL      BBREID=A_CUREID
039320200529     C                   EVAL      BBBSIN=A_CUBSIN
039330200529     C                   EVAL      BBCSTY=A_CUCSTY
039340200529     C                   EVAL      BBTAIN=A_CUTAIN
039350200529     C                   EVAL      BBCSID=A_CUCSID
039360200529     C     CSW036        IFEQ      'Y'                                                        CSW036
039370200529     C                   EVAL      BBCSI2 = A_CUCSI2                                          CSW036
039380200529     C                   ENDIF                                                                CSW036
039390200529     C                   EVAL      BBSTAD=A_CUSTAD
039400200529     C                   EVAL      BBTXA1=A_CUTXA1
039410200529     C                   EVAL      BBTXA2=A_CUTXA2
039420200529     C                   EVAL      BBTXA3=A_CUTXA3
039430200529     C                   EVAL      BBTXA4=A_CUTXA4
039440200529     C                   EVAL      BBTXA5=A_CUTXA5
039450200529     C                   EVAL      BBCHID=A_CUCHID
039460200529     C                   EVAL      BBCHSC=A_CUCHSC
039470200529     C                   EVAL      BBCABA=A_CUCABA
039480200529     C                   EVAL      BBBFIC=A_CUBFIC
039490200529     C                   EVAL      BBBLCD=A_CUBLCD
039500200529     C                   EVAL      BBFWCD=A_CUFWCD
039510200529     C                   EVAL      BBLCD=BJRDNB
039520200529     C                   EVAL      BBTYLC='A'
039530200529     C                   EVAL      BBLALD=A_CULALD
039540200529     C                   EVAL      BBLDHD=A_CULDHD
039550200529     C                   EVAL      BBLRLD=A_CULRLD
039560200529     C                   EVAL      BBDTDL=A_CUDTDL
039570200529     C                   EVAL      BBLETI=A_CULETI
039580200529     C                   EVAL      BBCMTI=A_CUCMTI
039590200529     C                   EVAL      BBGSFM=A_CUGSFM
039600200529     C                   EVAL      BBSTFG=A_CUSTFG
039610200529     C                   EVAL      BBRWCD=A_CURWCD
039620200529     C                   EVAL      BBNG01=A_CUNG01
039630200529     C                   EVAL      BBNG02=A_CUNG02
039640200529     C                   EVAL      BBNG03=A_CUNG03
039650200529     C                   EVAL      BBNG04=A_CUNG04
039660200529     C                   EVAL      BBNG05=A_CUNG05
039670200529     C                   EVAL      BBNG06=A_CUNG06
039680200529     C                   EVAL      BBNG07=A_CUNG07
039690200529     C                   EVAL      BBNG08=A_CUNG08
039700200529     C                   EVAL      BBNG09=A_CUNG09
039710200529     C                   EVAL      BBNG10=A_CUNG10
039720200529     C                   EVAL      BBNG11=A_CUNG11
039730200529     C                   EVAL      BBNG12=A_CUNG12
039740200529     C                   EVAL      BBNG13=A_CUNG13
039750200529     C                   EVAL      BBNG14=A_CUNG14
039760200529     C                   EVAL      BBNG15=A_CUNG15
039770200529     C                   EVAL      BBDS01=A_CUDS01
039780200529     C                   EVAL      BBDS02=A_CUDS02
039790200529     C                   EVAL      BBDS03=A_CUDS03
039800200529     C                   EVAL      BBDS04=A_CUDS04
039810200529     C                   EVAL      BBDS05=A_CUDS05
039820200529     C                   EVAL      BBDS06=A_CUDS06
039830200529     C                   EVAL      BBDS07=A_CUDS07
039840200529     C                   EVAL      BBDS08=A_CUDS08
039850200529     C                   EVAL      BBDS09=A_CUDS09
039860200529     C                   EVAL      BBDS10=A_CUDS10
039870200529     C                   EVAL      BBDS11=A_CUDS11
039880200529     C                   EVAL      BBDS12=A_CUDS12
039890200529     C                   EVAL      BBDS13=A_CUDS13
039900200529     C                   EVAL      BBDS14=A_CUDS14
039910200529     C                   EVAL      BBDS15=A_CUDS15
039920200529     C                   EVAL      BBDNW1=A_CUDNW1
039930200529     C                   EVAL      BBDNW2=A_CUDNW2
039940200529     C                   EVAL      BBDNW3=A_CUDNW3
039950200529     C                   EVAL      BBDNW4=A_CUDNW4
039960200529     C                   EVAL      BBDNW5=A_CUDNW5
039970200529     C                   EVAL      BBDNW6=A_CUDNW6
039980200529     C                   EVAL      BBDNW7=A_CUDNW7
039990200529     C                   EVAL      BBDNW8=A_CUDNW8
040000200529     C                   EVAL      BBDNW9=A_CUDNW9
040010200529     C                   EVAL      BBCGRP=A_CUCGRP
040020200529     C                   EVAL      BBCDEL=A_CUCDEL
040030200529     C                   EVAL      BBABA2=A_CUABA2
040040200529     C                   EVAL      BBOGID=A_CUOGID
040050200529     C                   EVAL      BBSSDL=A_CUSSDL
040060200529     C                   EVAL      BBORED=A_CUORED
040070200529     C                   EVAL      BBMCAC=A_CUMCAC
040080200529     C                   EVAL      BBCRPC=A_CUCRPC
040090200529     C                   EVAL      BBPSWC=A_CUPSWC
040100200529     C                   EVAL      BBMGTP=A_CUMGTP
040110200529     C                   EVAL      BBNET=A_CUNET
040120200529     C                   EVAL      BBNTGP=A_CUNTGP
040130200529     C                   EVAL      BBNTCP=A_CUNTCP
040140200529     C                   EVAL      BBNTND=A_CUNTND
040150200529     C                   EVAL      BBNTMM=A_CUNTMM
040160200529     C                   EVAL      BBTICS=A_CUTICS
040170200529     C                   EVAL      BBSWFI=A_CUSWFI
040180200529     C                   EVAL      BBDINC=A_CUDINC
040190200529     C                   EVAL      BBPRBA=A_CUPRBA
040200200529     C                   EVAL      BBCLSS=A_CUCLSS                                            CDL008
040210200529     C                   EVAL      BBEFDT=A_CUEFDT                                            CDL008
040220200529     C                   EVAL      BBCLST=A_CUCLST                                           BUG5409
040230200529     C                   EVAL      BBCLDT=A_CUCLDT                                           BUG5409
040240200529     C**********         IF        CGL132 = 'Y'                                    MD030958 MD042407
040250200529      ** Alternative Country of Citizenship                                                   CGL132
040260200529     C                   EVAL      XCACCZ=A_XCACCZ                                            CGL132
040270200529     C                   EVAL      XCBRCH = A_CUBRCD                                        MD050212
040280200529      ** Creation Date                                                                        CGL132
040290200529     C                   EVAL      XCCRDT=A_XCCRDT                                            CGL132
040300200529      ** Dormant Indicator                                                                    CGL132
040310200529     C                   EVAL      XCDRMT=A_XCDRMT                                            CGL132
040320200529      ** Last Change User                                                                     CGL132
040330200529     C**********         EVAL      XCLCUS=PSUSER                                    CGL132 MD026957B
040340200529     C**********         EVAL      XCLCUS=WKUSER                                 MD026957B MD027492A
040350200529     C                   EVAL      XCLCUS=WLUSER                                           MD027492A
040360200529     C**********         ENDIF                                                     MD030958 MD042407
040370200529                                                                                              CSW024
040380200529     C                   IF        CSW024 = 'Y' and BGMSDL = 'Y'                              CSW024
040390200529     C                   EVAL      BBCORP=A_CUCORP                                            CSW024
040400200529     C                   EVAL      BBCBEI=A_CUCBEI                                            CSW024
040410200529     C                   EVAL      BBRI01=A_CURI01                                            CSW024
040420200529     C                   EVAL      BBRI02=A_CURI02                                            CSW024
040430200529     C                   EVAL      BBRI03=A_CURI03                                            CSW024
040440200529     C                   EVAL      BBRI04=A_CURI04                                            CSW024
040450200529     C                   EVAL      BBRI05=A_CURI05                                            CSW024
040460200529     C                   EVAL      BBFUND=A_CUFUND                                            CSW024
040470200529     C     CSW037        IFEQ      'Y'                                                        CSW037
040480200529     C                   EVAL      BBFNAC=A_CUFNAC                                            CSW037
040490200529     C                   ENDIF                                                                CSW037
040500200529     C                   ENDIF                                                                CSW024
040510200529      *                                                                                       CSD025
040520200529     C/COPY WNCPYSRC,SDCUSDDC19                                                              BUG6444
040530200529     C     CSD025        IFEQ      'Y'                                                        CSD025
040540200529     C                   EVAL      BBDEAC = A_CUDEAC                                          CSD025
040550200529     C                   EVAL      BBDEDT = A_CUDEDT                                          CSD025
040560200529     C                   ENDIF                                                                CSD025
040570200529
040580200529      ** Timestamp
040590200529     C                   CALLB     'ZAGENTMSTM'
040600200529     C                   PARM                    TimeStamp
040610200529     C                   EVAL      BBTMST=TimeStamp                             CAP013
040620200529      ** Front Office ID                                                        CAP013
040630200529     C                   EVAL      BBFRNT=A_CUFRNT                              CAP013
040640200529      ** Associated Front Office ID                                             CAP013
040650200529     C                   EVAL      BBAFRT=A_CUAFRT                              CAP013
040660200529                                                                                              CSD015
040670200529      ** If CSD015 = 'Y' and Watch List Checking is Applied                                   CSD015
040680200529                                                                                              CSD015
040690200529     C                   IF        CSD015 = 'Y'                                               CSD015
040700200529     C                             AND W1EWLC = 'Y'                                           CSD015
040710200529                                                                                              CSD015
040720200529      ** If user is in the main system                                                        CSD015
040730200529                                                                                              CSD015
040740200529     C                   IF        CSC011 <> 'Y'                                              CSD015
040750200529     C                             OR CSC011 = 'Y' AND S1MAIN = LIBR                          CSD015
040760200529                                                                                              CSD015
040770200529      ** Access SDCWHTPD using fucntion type 'SDCUSTPD', identifier                           CSD015
040780200529      ** BBCUST, and branch BBBCRD to verify Hit Unconfirmed Flag                             CSD015
040790200529                                                                                              CSD015
040800200529     C     KCwFld        KLIST                                                                CSD015
040810200529     C                   KFLD                    WFuncType                                    CSD015
040820200529     C                   KFLD                    WIdntifier                                   CSD015
040830200529     C                   KFLD                    WBranch                                      CSD015
040840200529                                                                                              CSD015
040850200529     C                   EVAL      WFuncType = 'SDCUSTPD'                                     CSD015
040860200529     C                   EVAL      WIdntifier = BBCUST                                        CSD015
040870200529     C                   EVAL      WBranch = BBBRCD                                           CSD015
040880200529                                                                                              CSD015
040890200529     C     KCwFld        CHAIN     SDCWHTL1                                                   CSD015
040900200529     C                   IF        NOT %FOUND(SDCWHTL1)                                       CSD015
040910200529     C                   EVAL      WUNCF1 = 'N'                                               CSD015
040920200529     C                   ELSE                                                                 CSD015
040930200529     C                   IF        W3UNCF = 'Y'                                               CSD015
040940200529     C                   EVAL      WUNCF1 = 'Y'                                               CSD015
040950200529     C                   ENDIF                                                                CSD015
040960200529     C                   ENDIF                                                                CSD015
040970200529                                                                                              CSD015
040980200529      ** If any of the watch list fields has changed                                          CSD015
040990200529      ** or Hit Unconfirmed flag is 'Y'                                                       CSD015
041000200529                                                                                              CSD015
041010200529     C                   IF        BBCNA1 <> B_BBCNA1                                         CSD015
041020200529     C                             OR BBCNA2 <> B_BBCNA2                                      CSD015
041030200529     C                             OR BBCNA3 <> B_BBCNA3                                      CSD015
041040200529     C                             OR BBCNA4 <> B_BBCNA4                                      CSD015
041050200529     C                             OR BBCSID <> B_BBCSID                                      CSD015
041060200529     C                             OR BBCNCZ <> B_BBCNCZ                                      CSD015
041070200529     C                             OR BBCOLC <> B_BBCOLC                                      CSD015
041080200529     C                             OR WUNCF1 = 'Y'                                            CSD015
041090200529                                                                                              CSD015
041100200529     C                   EXSR      SRWTCH                                                     CSD015
041110200529                                                                                              CSD015
041120200529     C                   ENDIF                                                                CSD015
041130200529     C                   ENDIF                                                                CSD015
041140200529     C                   ENDIF                                                                CSD015
041150200529                                                                                              CLE025
041160200529      ** Update Facility Mandatory, Include Offsets, and                                      CLE025
041170200529      ** FX Margin Types flags                                                                CLE025
041180200529                                                                                              CLE025
041190200529     C                   IF        CLE025 = 'Y'                                               CLE025
041200200529     C                             OR  CFX001 = 'Y'                                           CFX001
041210200529     C                   EVAL      BBFCMF = A_CUFCMF                                          CLE025
041220200529     C                   EVAL      BBINOF = A_CUINOF                                          CLE025
041230200529     C                   EVAL      BBMSTF = A_CUMSTF                                          CLE025
041240200529     C                   EVAL      BBIOPC = A_CUIOPC                                          CLE025
041250200529     C                   ENDIF                                                                CLE025
041260200529      *                                                                                      BUG3362
041270200529      **  Initialise CUTICS  to 'N', after reversal of TI details                            BUG3362
041280200529      *                                                                                      BUG3362
041290200529     C                   IF        BBTICS = 'D'                                              BUG3362
041300200529     C                   EVAL      WBBTICS=BBTICS                                            BUG3362
041310200529     C                   EVAL      BBTICS = 'N'                                              BUG3362
041320200529     C                   ENDIF                                                               BUG3362
041330200529                                                                                              CSD031
041340200529     C**********         IF        CSD037 = 'Y'                                      CSD031 BUG13525
041350200529     C**********         EVAL      BBAACC = A_CUAACC                                 CSD031 BUG13525
041360200529     C**********         EVAL      BBEACC = A_CUEACC                                 CSD031 BUG13525
041370200529     C**********         EVAL      BBGPDT = A_CUGPDT                                 CSD031 BUG13525
041380200529     C**********         ENDIF                                                       CSD031 BUG13525
041390200529                                                                                              CSD079
041400200529      ** Set Fx netting Fields                                                                CSD079
041410200529                                                                                              CSD079
041420200529     C                   IF        CSD079 = 'Y'                                               CSD079
041430200529     C                             AND CDL002 = 'Y'                                           CSD079
041440200529     C                   EVAL      BBNET = A_CUNET                                            CSD079
041450200529     C                   EVAL      BBNTGP = A_CUNTGP                                          CSD079
041460200529     C                   EVAL      BBNTCP = A_CUNTCP                                          CSD079
041470200529     C                   EVAL      BBNTND = A_CUNTND                                          CSD079
041480200529     C                   EVAL      BBNTMM = A_CUNTMM                                          CSD079
041490200529     C                   EVAL      BBTICS = A_CUTICS                                          CSD079
041500200529     C                   EVAL      BBSWFI = A_CUSWFI                                          CSD079
041510200529                                                                                              CSD079
041520200529     C                   ENDIF                                                                CSD079
041530200529                                                                                              CSD079
041540200529      ** Set Fiduciary Deposits Fields                                                        CSD079
041550200529                                                                                              CSD079
041560200529     C                   IF        CSD079 = 'Y'                                               CSD079
041570200529     C                             AND CDL006 = 'Y'                                           CSD079
041580200529     C                   EVAL      BBCOMG = A_CUCOMG                                          CSD079
041590200529     C                   EVAL      BBCHRG = A_CUCHRG                                          CSD079
041600200529     C                   EVAL      BBAGNT = A_CUAGNT                                          CSD079
041610200529     C                   EVAL      BBAGNP = A_CUAGNP                                          CSD079
041620200529     C                   EVAL      BBTRAS = A_CUTRAS                                          CSD079
041630200529     C                   EVAL      BBNAR1 = A_CUNAR1                                          CSD079
041640200529     C                   EVAL      BBNAR2 = A_CUNAR2                                          CSD079
041650200529     C                   EVAL      BBNAR3 = A_CUNAR3                                          CSD079
041660200529     C                   EVAL      BBNAR4 = A_CUNAR4                                          CSD079
041670200529     C                   EVAL      BBDFAC = A_CUDFAC                                          CSD079
041680200529     C                   EVAL      BBDFAS = A_CUDFAS                                          CSD079
041690200529                                                                                              CSD079
041700200529     C                   ENDIF                                                                CSD079
041710200529      **********                                                                  AR679445 MD027492A
041720200529     C**********         MOVE      WKUSER        BBAUSR                           AR679445 MD027492A
041730200529                                                                                           MD027492A
041740200529     C                   EVAL      BBAUSR = WLUSER                                         MD027492A
041750200529     C                   EVAL      BBXUSR = WKUSER                                         MD027492A
041760200529      *
041770200529      ** Update the SWIFT 2007 field details when CSW207 is on                                CSW207
041780200529     C**********         IF        CSW207 = 'Y' OR BGN4ST = 'Y'                      CSW207 BUG15138
041790200529     C     A_CUCUST      CHAIN     SDCSSWL0                                                   CSW207
041800200529     C                   IF        %FOUND(SDCSSWL0)                                           CSW207
041810200529     C                   EVAL      CSCUSD = A_CUCUST                                          CSW207
041820200529     C                   EVAL      CSBRCA = A_CUBRCD                                          CSW207
041830200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                             BUG15138
041840200529     C                   EVAL      CSCICI = A_CUCICI                                          CSW207
041850200529     C                   EVAL      CSCPCI = A_CUCPCI                                          CSW207
041860200529     C                   ENDIF                                                              BUG15138
041870200529     C                   EVAL      CSIBEI = A_CUIBEI                                          CSW207
041880200529     C**********         IF        CFT050 = 'Y'                                      CFT050 MD028198
041890200529     C                   IF        CSW213 = 'Y'                                             MD028198
041900200529     C                   EVAL      CSLEIC = S13DDLEIC                                         CFT050
041910200529     C                   EVAL      CSCLSY = S13DDCLSY                                         CFT050
041920200529     C                   EVAL      CSCLID = S13DDCLID                                         CFT050
041930200529     C                   ENDIF                                                              MD028198
041940200529     C                   IF        CFT050 = 'Y'                                             MD028198
041950200529     C                   EVAL      CSBDRK = S13DDBDRK                                         CFT050
041960200529     C                   ENDIF                                                                CFT050
041970200529     C                   UPDATE    SDCSSWD0                                                   CSW207
041980200529     C                   ELSE                                                                 CSW207
041990200529     C                   EVAL      CSCUSD = A_CUCUST                                          CSW207
042000200529     C                   EVAL      CSBRCA = A_CUBRCD                                          CSW207
042010200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                             BUG15138
042020200529     C                   EVAL      CSCICI = A_CUCICI                                          CSW207
042030200529     C                   EVAL      CSCPCI = A_CUCPCI                                          CSW207
042040200529     C                   ENDIF                                                              BUG15138
042050200529     C                   EVAL      CSIBEI = A_CUIBEI                                          CSW207
042060200529     C**********         IF        CFT050 = 'Y'                                      CFT050 MD028198
042070200529     C                   IF        CSW213 = 'Y'                                             MD028198
042080200529     C                   EVAL      CSLEIC = A_CULEIC                                          CFT050
042090200529     C                   EVAL      CSCLSY = A_CUCLSY                                          CFT050
042100200529     C                   EVAL      CSCLID = A_CUCLID                                          CFT050
042110200529     C                   ENDIF                                                              MD028198
042120200529     C                   IF        CFT050 = 'Y'                                             MD028198
042130200529     C                   EVAL      CSBDRK = A_CUBDRK                                          CFT050
042140200529     C                   ENDIF                                                                CFT050
042150200529     C                   WRITE     SDCSSWD0                                                   CSW207
042160200529     C                   ENDIF                                                                CSW207
042170200529     C**********         ENDIF                                                       CSW207 BUG15138
042180200529      *                                                                                       CSW207
042190200529      ** UPDATE RECORD
042200200529
042210200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                       CSD028
042220200529     C                                          AND AUTHMD     = *BLANKS                      CSD028
042230200529     C                   UPDATE    SDCDSHD0                                                   CSD028
042240200529     C                   ELSE                                                                 CSD028
042250200529     C                   UPDATE    @BBREBG
042260200529      *                                                                                       CGL132
042270200529      ** UPDATE EXTENSION RECORD                                                              CGL132
042280200529     C**********         IF        CGL132 = 'Y'                                    MD030958 MD042407
042290200529     C                   UPDATE    SDCUSTX1                                                   CGL132
042300200529     C**********         ENDIF                                                     MD030958 MD042407
042310200529     C                   ENDIF                                                                CSD028
042320200529                                                                                              CSD092
042330200529     C**********         IF        CSD092 = 'Y'                                        CSD092 CGL132
042340200529     C                   IF        CSD092 = 'Y' AND                                           CGL132
042350200529     C                             CGL132 = 'N'                                               CGL132
042360200529     C                   IF        S01425 = 'Y' AND                                           CSD092
042370200529     C                             CSD079 = 'Y'                                               CSD092
042380200529     C                   ELSE                                                                 CSD092
042390200529                                                                                              CSD092
042400200529     C                   IF        S01425 <> 'Y' OR CSD079 <> 'Y'                           MD026957
042410200529     C                   CALL      'SD009696'                                                 CSD092
042420200529     C                   PARM      BBCUST        PCUST                                        CSD092
042430200529     C                   PARM      B_CUSTD       PBefCUST                                     CSD092
042440200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
042450200529     C                   PARM      *BLANKS       PBefACUS                                     CSD092
042460200529     C                   PARM      *BLANKS       PAftACUS                                     CSD092
042470200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
042480200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL132
042490200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
042500200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
042510200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
042520200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
042530200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
042540200529     C                   PARM      *BLANKS       PAftCUXC                                   MD026854
042550200529     C                   PARM      *BLANKS       PACRV                                        CSD092
042560200529     C                   PARM      *BLANKS       PELEC                                        CGL132
042570200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
042580200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
042590200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
042600200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
042610200529     C                   ENDIF                                                              MD026957
042620200529     C                   ENDIF                                                                CSD092
042630200529     C                   ENDIF                                                                CSD092
042640200529
042650200529     C/COPY WNCPYSRC,SDH00753
042660200529      ** Update Global Customer X-Reference                                                   CGP001
042670200529                                                                                              CGP001
042680200529     C                   IF        CGP001 = 'Y'                                               CGP001
042690200529     C                   EXSR      SRUpdGlbID                                                 CGP001
042700200529     C                   ENDIF                                                                CGP001
042710200529
042720200529      **If*Midas/TI*Interface*is*on****************************************                  BUG3362
042730200529      **AND*TI*Flag*is*'Y'*then********************************************                  BUG3362
042740200529      *****change*the*TI*Flag*and*update*SDTICSPD*to*generate**************                  BUG3362
042750200529      *****a*journal entry which can be picked up by TI.                                     BUG3362
042760200529      **********                                                                             BUG3362
042770200529     C*****BGN3ST        IFEQ      'Y'                                                       BUG3362
042780200529     C*****BBTICS        ANDEQ     'Y'                                                       BUG3362
042790200529     C*****BBCUST        CHAIN     SDTICSL0                           95                     BUG3362
042800200529     C******IN95         IFEQ      '0'                                                       BUG3362
042810200529     C*****TCFLAG        IFEQ      'Y'                                                       BUG3362
042820200529     C**********         MOVEL     'N'           TCFLAG                                      BUG3362
042830200529     C**********         ELSE                                                                BUG3362
042840200529     C**********         MOVEL     'Y'           TCFLAG                                      BUG3362
042850200529     C**********         ENDIF                                                               BUG3362
042860200529     C**********         UPDATE    @TICSL0                                                   BUG3362
042870200529     C**********         ENDIF                                                               BUG3362
042880200529     C**********         ENDIF                                                               BUG3362
042890200529      *                                                                                      BUG3362
042900200529     C                   EXSR      UPDTID                                                    BUG3362
042910200529      *                                                                                      BUG3362
042920200529      * USER: Processing after Data update
042930200529     C                   Z-ADD     *ZERO         WUNORC                         No of records
042940200529     C                   Z-ADD     1             WUNOAM                         No of Amend
042950200529     C                   Z-ADD     *ZERO         WUNOIN                         No of delete
042960200529     C                   Z-ADD     *ZERO         WUNODL                         No of Insert
042970200529      * Change Standing Data Cont - Standing Data Controls  *
042980200529     C                   MOVEL     'SDCUSTPD'    WFLNAME           8            No of delete
042990200529     C                   EXSR      SNCHRC
043000200529      * Pass parameters for marketing groups to SDCLINT to update CLINTCB
043010200529      * Customer marketing groups - Customer Marketing Groups  *
043020200529     C                   EXSR      SORVGN
043030200529                                                                                              CGL132
043040200529     C                   IF        CGL132 = 'Y'                                               CGL132
043050200529                                                                                              CGL132
043060200529      ** Access customer details recrod                                                       CGL132
043070200529                                                                                              CGL132
043080200529     C     A_CUCUST      CHAIN     SDFTCSL0                           99                      CGL132
043090200529     C                   CLEAR                   SDFTCS2                                      CGL132
043100200529     C                   MOVE      SDFTCS        SDFTCS2                                      CGL132
043110200529                                                                                              CGL132
043120200529      ** Database error                                                                       CGL132
043130200529                                                                                              CGL132
043140200529     C     *IN99         IFEQ      '1'                                                        CGL132
043150200529     C                   MOVEL     A_CUCUST      DBKEY                                        CGL132
043160200529     C                   MOVEL     'SDFTCSPD'    DBFILE                                       CGL132
043170200529     C                   MOVEL     '005'         DBASE                                        CGL132
043180200529     C                   EXSR      SRERR                                                      CGL132
043190200529     C                   END                                                                  CGL132
043200200529                                                                                              CGL132
043210200529     C                   MOVE      TimeStamp     WTime                                        CGL132
043220200529     C     *HMS0         MOVE      WTime         WWTIME                                       CGL132
043230200529     C                   EVAL      WWHVAC = FAHVAC                                            CGL132
043240200529     C                   EVAL      FACUST = BBCUST                                            CGL132
043250200529                                                                                              CGL132
043260200529     C                   IF        FACLAC <> A_FVCLAC                                         CGL132
043270200529     C                   EVAL      A_FVPCLA = FACLAC                                          CGL132
043280200529     C                   ENDIF                                                                CGL132
043290200529                                                                                              CGL132
043300200529     C                   IF        FACIOV <> A_FVCIOV                                         CGL132
043310200529     C                             OR FACICO <> A_FVCICO                                    MD027525
043320200529     C                   EVAL      INCUST = FACUST                                            CGL132
043330200529     C                   EVAL      INUSIN = 'US CITIZENSHIP'                                  CGL132
043340200529     C                   EVAL      INUSSV = FACISV                                            CGL132
043350200529     C                   EVAL      INUSSD = FACISD                                            CGL132
043360200529     C                   EVAL      INUSSM = FACIST                                            CGL132
043370200529     C                   EVAL      INUSOV = FACIOV                                            CGL132
043380200529     C                   EVAL      INUSUN = FACION                                            CGL132
043390200529     C                   EVAL      INUSDT = FACIOD                                            CGL132
043400200529     C                   EVAL      INUSTM = FACIOT                                            CGL132
043410200529     C                   EVAL      INUSCO = FACICO                                            CGL132
043420200529     C                   IF        FACIOT <> *BLANKS                                          CGL132
043430200529     C                   WRITE     SDINCHD0                                                   CGL132
043440200529     C                   ENDIF                                                                CGL132
043450200529     C                   EVAL      FACIOD = BJRDNB                                            CGL132
043460200529     C**********         EVAL      FACION = PSUSER                                   CGL132 MD026835
043470200529     C**********         EVAL      FACION = WKUSER                                MD026835 MD026835A
043480200529     C                   EVAL      FACION = WLUSER                                         MD026835A
043490200529     C                   MOVE      WWTIME        FACIOT                                       CGL132
043500200529     C                   ENDIF                                                                CGL132
043510200529                                                                                              CGL132
043520200529     C                   IF        FATXOV <> A_FVTXOV                                         CGL132
043530200529     C                             OR FATXCO <> A_FVTXCO                                    MD027525
043540200529     C                   EVAL      INCUST = FACUST                                            CGL132
043550200529     C                   EVAL      INUSIN = 'US TIN'                                          CGL132
043560200529     C                   EVAL      INUSSV = FATXSV                                            CGL132
043570200529     C                   EVAL      INUSSD = FATXSD                                            CGL132
043580200529     C                   EVAL      INUSSM = FATXST                                            CGL132
043590200529     C                   EVAL      INUSOV = FATXOV                                            CGL132
043600200529     C                   EVAL      INUSUN = FATXON                                            CGL132
043610200529     C                   EVAL      INUSDT = FATXOD                                            CGL132
043620200529     C                   EVAL      INUSTM = FATXOT                                            CGL132
043630200529     C                   EVAL      INUSCO = FATXCO                                            CGL132
043640200529     C                   IF        FATXOT <> *BLANKS                                          CGL132
043650200529     C                   WRITE     SDINCHD0                                                   CGL132
043660200529     C                   ENDIF                                                                CGL132
043670200529     C                   EVAL      FATXOD = BJRDNB                                            CGL132
043680200529     C**********         EVAL      FATXON = PSUSER                                   CGL132 MD026835
043690200529     C**********         EVAL      FATXON = WKUSER                                MD026835 MD026835A
043700200529     C                   EVAL      FATXON = WLUSER                                         MD026835A
043710200529     C                   MOVE      WWTIME        FATXOT                                       CGL132
043720200529     C                   ENDIF                                                                CGL132
043730200529                                                                                              CGL132
043740200529     C                   IF        FAAUOV <> A_FVAUOV                                         CGL132
043750200529     C                   EVAL      INCUST = FACUST                                            CGL132
043760200529     C                   EVAL      INUSIN = 'US Authority Holder'                             CGL132
043770200529     C                   EVAL      INUSSV = FAAUSV                                            CGL132
043780200529     C                   EVAL      INUSSD = FAAUSD                                            CGL132
043790200529     C                   EVAL      INUSSM = FAAUST                                            CGL132
043800200529     C                   EVAL      INUSOV = FAAUOV                                            CGL132
043810200529     C                   EVAL      INUSUN = FAAUON                                            CGL132
043820200529     C                   EVAL      INUSDT = FAAUOD                                            CGL132
043830200529     C                   EVAL      INUSTM = FAAUOT                                            CGL132
043840200529     C                   EVAL      INUSCO = FAAUCO                                            CGL132
043850200529     C                   IF        FAAUOT <> *BLANKS                                          CGL132
043860200529     C                   WRITE     SDINCHD0                                                   CGL132
043870200529     C                   ENDIF                                                                CGL132
043880200529     C                   EVAL      FAAUOD = BJRDNB                                            CGL132
043890200529     C**********         EVAL      FAAUON = PSUSER                                   CGL132 MD026835
043900200529     C**********         EVAL      FAAUON = WKUSER                                MD026835 MD026835A
043910200529     C                   EVAL      FAAUON = WLUSER                                         MD026835A
043920200529     C                   MOVE      WWTIME        FAAUOT                                       CGL132
043930200529     C                   ENDIF                                                                CGL132
043940200529                                                                                              CGL132
043950200529     C                   IF        FACDOV <> A_FVCDOV                                         CGL132
043960200529     C                             OR FACDCO <> A_FVCDCO                                    MD027525
043970200529     C                   EVAL      INCUST = FACUST                                            CGL132
043980200529     C                   EVAL      INUSIN = 'US COUNTRY OF +                                  CGL132
043990200529     C                                      DOMICILE'                                         CGL132
044000200529     C                   EVAL      INUSSV = FACDSV                                            CGL132
044010200529     C                   EVAL      INUSSD = FACDSD                                            CGL132
044020200529     C                   EVAL      INUSSM = FACDST                                            CGL132
044030200529     C                   EVAL      INUSOV = FACDOV                                            CGL132
044040200529     C                   EVAL      INUSUN = FACDON                                            CGL132
044050200529     C                   EVAL      INUSDT = FACDOD                                            CGL132
044060200529     C                   EVAL      INUSTM = FACDOT                                            CGL132
044070200529     C                   EVAL      INUSCO = FACDCO                                            CGL132
044080200529     C                   IF        FACDOT <> *BLANKS                                          CGL132
044090200529     C                   WRITE     SDINCHD0                                                   CGL132
044100200529     C                   ENDIF                                                                CGL132
044110200529     C                   EVAL      FACDOD = BJRDNB                                            CGL132
044120200529     C**********         EVAL      FACDON = PSUSER                                   CGL132 MD026835
044130200529     C**********         EVAL      FACDON = WKUSER                                MD026835 MD026835A
044140200529     C                   EVAL      FACDON = WLUSER                                         MD026835A
044150200529     C                   MOVE      WWTIME        FACDOT                                       CGL132
044160200529     C                   ENDIF                                                                CGL132
044170200529                                                                                              CGL132
044180200529     C                   IF        FATEOV <> A_FVTEOV                                         CGL132
044190200529     C                             OR FATECO <> A_FVTECO                                    MD027525
044200200529     C                   EVAL      INCUST = FACUST                                            CGL132
044210200529     C                   EVAL      INUSIN = 'US TELEPHONE'                                    CGL132
044220200529     C                   EVAL      INUSSV = FATESV                                            CGL132
044230200529     C                   EVAL      INUSSD = FATESD                                            CGL132
044240200529     C                   EVAL      INUSSM = FATEST                                            CGL132
044250200529     C                   EVAL      INUSOV = FATEOV                                            CGL132
044260200529     C                   EVAL      INUSUN = FATEON                                            CGL132
044270200529     C                   EVAL      INUSDT = FATEOD                                            CGL132
044280200529     C                   EVAL      INUSTM = FATEOT                                            CGL132
044290200529     C                   EVAL      INUSCO = FATECO                                            CGL132
044300200529     C                   IF        FATEOT <> *BLANKS                                          CGL132
044310200529     C                   WRITE     SDINCHD0                                                   CGL132
044320200529     C                   ENDIF                                                                CGL132
044330200529     C                   EVAL      FATEOD = BJRDNB                                            CGL132
044340200529     C**********         EVAL      FATEON = PSUSER                                   CGL132 MD026835
044350200529     C**********         EVAL      FATEON = WKUSER                                MD026835 MD026835A
044360200529     C                   EVAL      FATEON = WLUSER                                         MD026835A
044370200529     C                   MOVE      WWTIME        FATEOT                                       CGL132
044380200529     C                   ENDIF                                                                CGL132
044390200529                                                                                              CGL132
044400200529     C                   IF        FAGCOV <> A_FVGCOV                                         CGL132
044410200529     C                             OR FAGCCO <> A_FVGCCO                                    MD027525
044420200529     C                   EVAL      INCUST = FACUST                                            CGL132
044430200529     C                   EVAL      INUSIN = 'US GREEN CARD'                                   CGL132
044440200529     C                   EVAL      INUSSV = FAGCSV                                            CGL132
044450200529     C                   EVAL      INUSSD = FAGCSD                                            CGL132
044460200529     C                   EVAL      INUSSM = FAGCST                                            CGL132
044470200529     C                   EVAL      INUSOV = FAGCOV                                            CGL132
044480200529     C                   EVAL      INUSUN = FAGCON                                            CGL132
044490200529     C                   EVAL      INUSDT = FAGCOD                                            CGL132
044500200529     C                   EVAL      INUSTM = FAGCOT                                            CGL132
044510200529     C                   EVAL      INUSCO = FAGCCO                                            CGL132
044520200529     C                   IF        FAGCOT <> *BLANKS                                          CGL132
044530200529     C                   WRITE     SDINCHD0                                                   CGL132
044540200529     C                   ENDIF                                                                CGL132
044550200529     C                   EVAL      FAGCOD = BJRDNB                                            CGL132
044560200529     C**********         EVAL      FAGCON = PSUSER                                   CGL132 MD026835
044570200529     C**********         EVAL      FAGCON = WKUSER                                MD026835 MD026835A
044580200529     C                   EVAL      FAGCON = WLUSER                                         MD026835A
044590200529     C                   MOVE      WWTIME        FAGCOT                                       CGL132
044600200529     C                   ENDIF                                                                CGL132
044610200529                                                                                              CGL132
044620200529     C                   IF        FACBOV <> A_FVCBOV                                         CGL132
044630200529     C                             OR FACBCO <> A_FVCBCO                                    MD027525
044640200529     C                   EVAL      INCUST = FACUST                                            CGL132
044650200529     C                   EVAL      INUSIN = 'US COUNTRY OF +                                  CGL132
044660200529     C                                      BIRTH'                                            CGL132
044670200529     C                   EVAL      INUSSV = FACBSV                                            CGL132
044680200529     C                   EVAL      INUSSD = FACBSD                                            CGL132
044690200529     C                   EVAL      INUSSM = FACBST                                            CGL132
044700200529     C                   EVAL      INUSOV = FACBOV                                            CGL132
044710200529     C                   EVAL      INUSUN = FACBON                                            CGL132
044720200529     C                   EVAL      INUSDT = FACBOD                                            CGL132
044730200529     C                   EVAL      INUSTM = FACBOT                                            CGL132
044740200529     C                   EVAL      INUSCO = FACBCO                                            CGL132
044750200529     C                   IF        FACBOT <> *BLANKS                                          CGL132
044760200529     C                   WRITE     SDINCHD0                                                   CGL132
044770200529     C                   ENDIF                                                                CGL132
044780200529     C                   EVAL      FACBOD = BJRDNB                                            CGL132
044790200529     C**********         EVAL      FACBON = PSUSER                                   CGL132 MD026835
044800200529     C**********         EVAL      FACBON = WKUSER                                MD026835 MD026835A
044810200529     C                   EVAL      FACBON = WLUSER                                         MD026835A
044820200529     C                   MOVE      WWTIME        FACBOT                                       CGL132
044830200529     C                   ENDIF                                                                CGL132
044840200529                                                                                              CGL132
044850200529     C                   IF        FAJAOV <> A_FVJAOV                                         CGL132
044860200529     C                             OR FAJACO <> A_FVJACO                                    MD027525
044870200529     C                   EVAL      INCUST = FACUST                                            CGL132
044880200529     C                   EVAL      INUSIN = 'US JOINT ACCOUNT +                               CGL132
044890200529     C                                      MEMBER'                                           CGL132
044900200529     C                   EVAL      INUSSV = FAJASV                                            CGL132
044910200529     C                   EVAL      INUSSD = FAJASD                                            CGL132
044920200529     C                   EVAL      INUSSM = FAJAST                                            CGL132
044930200529     C                   EVAL      INUSOV = FAJAOV                                            CGL132
044940200529     C                   EVAL      INUSUN = FAJAON                                            CGL132
044950200529     C                   EVAL      INUSDT = FAJAOD                                            CGL132
044960200529     C                   EVAL      INUSTM = FAJAOT                                            CGL132
044970200529     C                   EVAL      INUSCO = FAJACO                                            CGL132
044980200529     C                   IF        FAJAOT <> *BLANKS                                          CGL132
044990200529     C                   WRITE     SDINCHD0                                                   CGL132
045000200529     C                   ENDIF                                                                CGL132
045010200529     C                   EVAL      FAJAOD = BJRDNB                                            CGL132
045020200529     C**********         EVAL      FAJAON = PSUSER                                   CGL132 MD026835
045030200529     C**********         EVAL      FAJAON = WKUSER                                MD026835 MD026835A
045040200529     C                   EVAL      FAJAON = WLUSER                                         MD026835A
045050200529     C                   MOVE      WWTIME        FAJAOT                                       CGL132
045060200529     C                   ENDIF                                                                CGL132
045070200529                                                                                              CGL132
045080200529     C                   IF        FAHMOV <> A_FVHMOV                                         CGL132
045090200529     C                             OR FAHMCO <> A_FVHMCO                                    MD027525
045100200529     C                   EVAL      INCUST = FACUST                                            CGL132
045110200529     C                   EVAL      INUSIN = 'HOLD MAIL'                                       CGL132
045120200529     C                   EVAL      INUSSV = FAHMSV                                            CGL132
045130200529     C                   EVAL      INUSSD = FAHMSD                                            CGL132
045140200529     C                   EVAL      INUSSM = FAHMST                                            CGL132
045150200529     C                   EVAL      INUSOV = FAHMOV                                            CGL132
045160200529     C                   EVAL      INUSUN = FAHMON                                            CGL132
045170200529     C                   EVAL      INUSDT = FAHMOD                                            CGL132
045180200529     C                   EVAL      INUSTM = FAHMOT                                            CGL132
045190200529     C                   EVAL      INUSCO = FAHMCO                                            CGL132
045200200529     C                   IF        FAHMOT <> *BLANKS                                          CGL132
045210200529     C                   WRITE     SDINCHD0                                                   CGL132
045220200529     C                   ENDIF                                                                CGL132
045230200529     C                   EVAL      FAHMOD = BJRDNB                                            CGL132
045240200529     C**********         EVAL      FAHMON = PSUSER                                   CGL132 MD026835
045250200529     C**********         EVAL      FAHMON = WKUSER                                MD026835 MD026835A
045260200529     C                   EVAL      FAHMON = WLUSER                                         MD026835A
045270200529     C                   MOVE      WWTIME        FAHMOT                                       CGL132
045280200529     C                   ENDIF                                                                CGL132
045290200529                                                                                              CGL132
045300200529     C                   IF        FARPOV <> A_FVRPOV                                         CGL132
045310200529     C                             OR FARPCO <> A_FVRPCO                                    MD027525
045320200529     C                   EVAL      INCUST = FACUST                                            CGL132
045330200529     C                   EVAL      INUSIN = 'REG PAYMENT +                                    CGL132
045340200529     C                                      INST TO US'                                       CGL132
045350200529     C                   EVAL      INUSSV = FARPSV                                            CGL132
045360200529     C                   EVAL      INUSSD = FARPSD                                            CGL132
045370200529     C                   EVAL      INUSSM = FARPST                                            CGL132
045380200529     C                   EVAL      INUSOV = FARPOV                                            CGL132
045390200529     C                   EVAL      INUSUN = FARPON                                            CGL132
045400200529     C                   EVAL      INUSDT = FARPOD                                            CGL132
045410200529     C                   EVAL      INUSTM = FARPOT                                            CGL132
045420200529     C                   EVAL      INUSCO = FARPCO                                            CGL132
045430200529     C                   IF        FARPOT <> *BLANKS                                          CGL132
045440200529     C                   WRITE     SDINCHD0                                                   CGL132
045450200529     C                   ENDIF                                                                CGL132
045460200529     C                   EVAL      FARPOD = BJRDNB                                            CGL132
045470200529     C**********         EVAL      FARPON = PSUSER                                   CGL132 MD026835
045480200529     C**********         EVAL      FARPON = WKUSER                                MD026835 MD026835A
045490200529     C                   EVAL      FARPON = WLUSER                                         MD026835A
045500200529     C                   MOVE      WWTIME        FARPOT                                       CGL132
045510200529     C                   ENDIF                                                                CGL132
045520200529                                                                                              CGL132
045530200529     C                   IF        FAIDOV <> A_FVIDOV                                         CGL132
045540200529     C                             OR FAIDCO <> A_FVIDCO                                    MD027525
045550200529     C                   EVAL      INCUST = FACUST                                            CGL132
045560200529     C                   EVAL      INUSIN = 'US IDENTITY +                                    CGL132
045570200529     C                                      DOCUMENT'                                         CGL132
045580200529     C                   EVAL      INUSSV = FAIDSV                                            CGL132
045590200529     C                   EVAL      INUSSD = FAIDSD                                            CGL132
045600200529     C                   EVAL      INUSSM = FAIDST                                            CGL132
045610200529     C                   EVAL      INUSOV = FAIDOV                                            CGL132
045620200529     C                   EVAL      INUSUN = FAIDON                                            CGL132
045630200529     C                   EVAL      INUSDT = FAIDOD                                            CGL132
045640200529     C                   EVAL      INUSTM = FAIDOT                                            CGL132
045650200529     C                   EVAL      INUSCO = FAIDCO                                            CGL132
045660200529     C                   IF        FAIDOT <> *BLANKS                                          CGL132
045670200529     C                   WRITE     SDINCHD0                                                   CGL132
045680200529     C                   ENDIF                                                                CGL132
045690200529     C                   EVAL      FAIDOD = BJRDNB                                            CGL132
045700200529     C**********         EVAL      FAIDON = PSUSER                                   CGL132 MD026835
045710200529     C**********         EVAL      FAIDON = WKUSER                                MD026835 MD026835A
045720200529     C                   EVAL      FAIDON = WLUSER                                         MD026835A
045730200529     C                   MOVE      WWTIME        FAIDOT                                       CGL132
045740200529     C                   ENDIF                                                                CGL132
045750200529                                                                                              CGL132
045760200529     C                   IF        FAMCOV <> A_FVMCOV                                         CGL132
045770200529     C                             OR FAMCCO <> A_FVMCCO                                    MD027525
045780200529     C                   EVAL      INCUST = FACUST                                            CGL132
045790200529     C                   EVAL      INUSIN = 'MAILING +                                        CGL132
045800200529     C                                      COUNTRY'                                          CGL132
045810200529     C                   EVAL      INUSSV = FAMCSV                                            CGL132
045820200529     C                   EVAL      INUSSD = FAMCSD                                            CGL132
045830200529     C                   EVAL      INUSSM = FAMCST                                            CGL132
045840200529     C                   EVAL      INUSOV = FAMCOV                                            CGL132
045850200529     C                   EVAL      INUSUN = FAMCON                                            CGL132
045860200529     C                   EVAL      INUSDT = FAMCOD                                            CGL132
045870200529     C                   EVAL      INUSTM = FAMCOT                                            CGL132
045880200529     C                   EVAL      INUSCO = FAMCCO                                            CGL132
045890200529     C                   IF        FAMCOT <> *BLANKS                                          CGL132
045900200529     C                   WRITE     SDINCHD0                                                   CGL132
045910200529     C                   ENDIF                                                                CGL132
045920200529     C                   EVAL      FAMCOD = BJRDNB                                            CGL132
045930200529     C**********         EVAL      FAMCON = PSUSER                                   CGL132 MD026835
045940200529     C**********         EVAL      FAMCON = WKUSER                                MD026835 MD026835A
045950200529     C                   EVAL      FAMCON = WLUSER                                         MD026835A
045960200529     C                   MOVE      WWTIME        FAMCOT                                       CGL132
045970200529     C                   ENDIF                                                                CGL132
045980200529                                                                                              CGL132
045990200529     C                   EVAL      FACLAC = A_FVCLAC                                          CGL132
046000200529     C                   EVAL      FACLAD = A_FVCLAD                                          CGL132
046010200529     C                   EVAL      FAPCLA = A_FVPCLA                                          CGL132
046020200529     C                   EVAL      FAHMSV = A_FVHMSV                                          CGL132
046030200529     C                   EVAL      FAHMSD = A_FVHMSD                                          CGL132
046040200529     C                   EVAL      FAHMOV = A_FVHMOV                                          CGL132
046050200529     C                   EVAL      FAHMD1 = A_FVHMD1                                          CGL132
046060200529     C                   EVAL      FAHMD2 = A_FVHMD2                                          CGL132
046070200529     C                   EVAL      FAHMD3 = A_FVHMD3                                          CGL132
046080200529     C                   EVAL      FAHMD4 = A_FVHMD4                                          CGL132
046090200529     C                   EVAL      FAHMD5 = A_FVHMD5                                          CGL132
046100200529     C                   EVAL      FAHMS1 = A_FVHMS1                                          CGL132
046110200529     C                   EVAL      FAHMS2 = A_FVHMS2                                          CGL132
046120200529     C                   EVAL      FAHMS3 = A_FVHMS3                                          CGL132
046130200529     C                   EVAL      FAHMS4 = A_FVHMS4                                          CGL132
046140200529     C                   EVAL      FAHMS5 = A_FVHMS5                                          CGL132
046150200529     C                   EVAL      FAHMCO = A_FVHMCO                                          CGL132
046160200529     C                   EVAL      FAMCSV = A_FVMCSV                                          CGL132
046170200529     C                   EVAL      FAMCSD = A_FVMCSD                                          CGL132
046180200529     C                   EVAL      FAMCOV = A_FVMCOV                                          CGL132
046190200529     C                   EVAL      FAMCD1 = A_FVMCD1                                          CGL132
046200200529     C                   EVAL      FAMCD2 = A_FVMCD2                                          CGL132
046210200529     C                   EVAL      FAMCD3 = A_FVMCD3                                          CGL132
046220200529     C                   EVAL      FAMCD4 = A_FVMCD4                                          CGL132
046230200529     C                   EVAL      FAMCD5 = A_FVMCD5                                          CGL132
046240200529     C                   EVAL      FAMCS1 = A_FVMCS1                                          CGL132
046250200529     C                   EVAL      FAMCS2 = A_FVMCS2                                          CGL132
046260200529     C                   EVAL      FAMCS3 = A_FVMCS3                                          CGL132
046270200529     C                   EVAL      FAMCS4 = A_FVMCS4                                          CGL132
046280200529     C                   EVAL      FAMCS5 = A_FVMCS5                                          CGL132
046290200529     C                   EVAL      FAMCCO = A_FVMCCO                                          CGL132
046300200529     C                   EVAL      FARPSV = A_FVRPSV                                          CGL132
046310200529     C                   EVAL      FARPSD = A_FVRPSD                                          CGL132
046320200529     C                   EVAL      FARPOV = A_FVRPOV                                          CGL132
046330200529     C                   EVAL      FARPD1 = A_FVRPD1                                          CGL132
046340200529     C                   EVAL      FARPD2 = A_FVRPD2                                          CGL132
046350200529     C                   EVAL      FARPD3 = A_FVRPD3                                          CGL132
046360200529     C                   EVAL      FARPD4 = A_FVRPD4                                          CGL132
046370200529     C                   EVAL      FARPD5 = A_FVRPD5                                          CGL132
046380200529     C                   EVAL      FARPS1 = A_FVRPS1                                          CGL132
046390200529     C                   EVAL      FARPS2 = A_FVRPS2                                          CGL132
046400200529     C                   EVAL      FARPS3 = A_FVRPS3                                          CGL132
046410200529     C                   EVAL      FARPS4 = A_FVRPS4                                          CGL132
046420200529     C                   EVAL      FARPS5 = A_FVRPS5                                          CGL132
046430200529     C                   EVAL      FARPCO = A_FVRPCO                                          CGL132
046440200529     C                   EVAL      FAAUSV = A_FVAUSV                                          CGL132
046450200529     C                   EVAL      FAAUSD = A_FVAUSD                                          CGL132
046460200529     C                   EVAL      FAAUOV = A_FVAUOV                                          CGL132
046470200529     C                   EVAL      FAAUD1 = A_FVAUD1                                          CGL132
046480200529     C                   EVAL      FAAUD2 = A_FVAUD2                                          CGL132
046490200529     C                   EVAL      FAAUD3 = A_FVAUD3                                          CGL132
046500200529     C                   EVAL      FAAUD4 = A_FVAUD4                                          CGL132
046510200529     C                   EVAL      FAAUD5 = A_FVAUD5                                          CGL132
046520200529     C                   EVAL      FAAUS1 = A_FVAUS1                                          CGL132
046530200529     C                   EVAL      FAAUS2 = A_FVAUS2                                          CGL132
046540200529     C                   EVAL      FAAUS3 = A_FVAUS3                                          CGL132
046550200529     C                   EVAL      FAAUS4 = A_FVAUS4                                          CGL132
046560200529     C                   EVAL      FAAUS5 = A_FVAUS5                                          CGL132
046570200529     C                   EVAL      FAAUCO = A_FVAUCO                                          CGL132
046580200529     C                   EVAL      FACISV = A_FVCISV                                          CGL132
046590200529     C                   EVAL      FACISD = A_FVCISD                                          CGL132
046600200529     C                   EVAL      FACIOV = A_FVCIOV                                          CGL132
046610200529     C                   EVAL      FACID1 = A_FVCID1                                          CGL132
046620200529     C                   EVAL      FACID2 = A_FVCID2                                          CGL132
046630200529     C                   EVAL      FACID3 = A_FVCID3                                          CGL132
046640200529     C                   EVAL      FACID4 = A_FVCID4                                          CGL132
046650200529     C                   EVAL      FACID5 = A_FVCID5                                          CGL132
046660200529     C                   EVAL      FACIS1 = A_FVCIS1                                          CGL132
046670200529     C                   EVAL      FACIS2 = A_FVCIS2                                          CGL132
046680200529     C                   EVAL      FACIS3 = A_FVCIS3                                          CGL132
046690200529     C                   EVAL      FACIS4 = A_FVCIS4                                          CGL132
046700200529     C                   EVAL      FACIS5 = A_FVCIS5                                          CGL132
046710200529     C                   EVAL      FACICO = A_FVCICO                                          CGL132
046720200529     C                   EVAL      FACBSV = A_FVCBSV                                          CGL132
046730200529     C                   EVAL      FACBSD = A_FVCBSD                                          CGL132
046740200529     C                   EVAL      FACBOV = A_FVCBOV                                          CGL132
046750200529     C                   EVAL      FACBD1 = A_FVCBD1                                          CGL132
046760200529     C                   EVAL      FACBD2 = A_FVCBD2                                          CGL132
046770200529     C                   EVAL      FACBD3 = A_FVCBD3                                          CGL132
046780200529     C                   EVAL      FACBD4 = A_FVCBD4                                          CGL132
046790200529     C                   EVAL      FACBD5 = A_FVCBD5                                          CGL132
046800200529     C                   EVAL      FACBS1 = A_FVCBS1                                          CGL132
046810200529     C                   EVAL      FACBS2 = A_FVCBS2                                          CGL132
046820200529     C                   EVAL      FACBS3 = A_FVCBS3                                          CGL132
046830200529     C                   EVAL      FACBS4 = A_FVCBS4                                          CGL132
046840200529     C                   EVAL      FACBS5 = A_FVCBS5                                          CGL132
046850200529     C                   EVAL      FACBCO = A_FVCBCO                                          CGL132
046860200529     C                   EVAL      FACDSV = A_FVCDSV                                          CGL132
046870200529     C                   EVAL      FACDSD = A_FVCDSD                                          CGL132
046880200529     C                   EVAL      FACDOV = A_FVCDOV                                          CGL132
046890200529     C                   EVAL      FACDD1 = A_FVCDD1                                          CGL132
046900200529     C                   EVAL      FACDD2 = A_FVCDD2                                          CGL132
046910200529     C                   EVAL      FACDD3 = A_FVCDD3                                          CGL132
046920200529     C                   EVAL      FACDD4 = A_FVCDD4                                          CGL132
046930200529     C                   EVAL      FACDD5 = A_FVCDD5                                          CGL132
046940200529     C                   EVAL      FACDS1 = A_FVCDS1                                          CGL132
046950200529     C                   EVAL      FACDS2 = A_FVCDS2                                          CGL132
046960200529     C                   EVAL      FACDS3 = A_FVCDS3                                          CGL132
046970200529     C                   EVAL      FACDS4 = A_FVCDS4                                          CGL132
046980200529     C                   EVAL      FACDS5 = A_FVCDS5                                          CGL132
046990200529     C                   EVAL      FACDCO = A_FVCDCO                                          CGL132
047000200529     C                   EVAL      FAGCSV = A_FVGCSV                                          CGL132
047010200529     C                   EVAL      FAGCSD = A_FVGCSD                                          CGL132
047020200529     C                   EVAL      FAGCOV = A_FVGCOV                                          CGL132
047030200529     C                   EVAL      FAGCD1 = A_FVGCD1                                          CGL132
047040200529     C                   EVAL      FAGCD2 = A_FVGCD2                                          CGL132
047050200529     C                   EVAL      FAGCD3 = A_FVGCD3                                          CGL132
047060200529     C                   EVAL      FAGCD4 = A_FVGCD4                                          CGL132
047070200529     C                   EVAL      FAGCD5 = A_FVGCD5                                          CGL132
047080200529     C                   EVAL      FAGCS1 = A_FVGCS1                                          CGL132
047090200529     C                   EVAL      FAGCS2 = A_FVGCS2                                          CGL132
047100200529     C                   EVAL      FAGCS3 = A_FVGCS3                                          CGL132
047110200529     C                   EVAL      FAGCS4 = A_FVGCS4                                          CGL132
047120200529     C                   EVAL      FAGCS5 = A_FVGCS5                                          CGL132
047130200529     C                   EVAL      FAGCCO = A_FVGCCO                                          CGL132
047140200529     C                   EVAL      FAIDSV = A_FVIDSV                                          CGL132
047150200529     C                   EVAL      FAIDSD = A_FVIDSD                                          CGL132
047160200529     C                   EVAL      FAIDOV = A_FVIDOV                                          CGL132
047170200529     C                   EVAL      FAIDD1 = A_FVIDD1                                          CGL132
047180200529     C                   EVAL      FAIDD2 = A_FVIDD2                                          CGL132
047190200529     C                   EVAL      FAIDD3 = A_FVIDD3                                          CGL132
047200200529     C                   EVAL      FAIDD4 = A_FVIDD4                                          CGL132
047210200529     C                   EVAL      FAIDD5 = A_FVIDD5                                          CGL132
047220200529     C                   EVAL      FAIDS1 = A_FVIDS1                                          CGL132
047230200529     C                   EVAL      FAIDS2 = A_FVIDS2                                          CGL132
047240200529     C                   EVAL      FAIDS3 = A_FVIDS3                                          CGL132
047250200529     C                   EVAL      FAIDS4 = A_FVIDS4                                          CGL132
047260200529     C                   EVAL      FAIDS5 = A_FVIDS5                                          CGL132
047270200529     C                   EVAL      FAIDCO = A_FVIDCO                                          CGL132
047280200529     C                   EVAL      FAJASV = A_FVJASV                                          CGL132
047290200529     C                   EVAL      FAJASD = A_FVJASD                                          CGL132
047300200529     C                   EVAL      FAJAOV = A_FVJAOV                                          CGL132
047310200529     C                   EVAL      FAJAD1 = A_FVJAD1                                          CGL132
047320200529     C                   EVAL      FAJAD2 = A_FVJAD2                                          CGL132
047330200529     C                   EVAL      FAJAD3 = A_FVJAD3                                          CGL132
047340200529     C                   EVAL      FAJAD4 = A_FVJAD4                                          CGL132
047350200529     C                   EVAL      FAJAD5 = A_FVJAD5                                          CGL132
047360200529     C                   EVAL      FAJAS1 = A_FVJAS1                                          CGL132
047370200529     C                   EVAL      FAJAS2 = A_FVJAS2                                          CGL132
047380200529     C                   EVAL      FAJAS3 = A_FVJAS3                                          CGL132
047390200529     C                   EVAL      FAJAS4 = A_FVJAS4                                          CGL132
047400200529     C                   EVAL      FAJAS5 = A_FVJAS5                                          CGL132
047410200529     C                   EVAL      FAJACO = A_FVJACO                                          CGL132
047420200529     C                   EVAL      FATESV = A_FVTESV                                          CGL132
047430200529     C                   EVAL      FATESD = A_FVTESD                                          CGL132
047440200529     C                   EVAL      FATEOV = A_FVTEOV                                          CGL132
047450200529     C                   EVAL      FATED1 = A_FVTED1                                          CGL132
047460200529     C                   EVAL      FATED2 = A_FVTED2                                          CGL132
047470200529     C                   EVAL      FATED3 = A_FVTED3                                          CGL132
047480200529     C                   EVAL      FATED4 = A_FVTED4                                          CGL132
047490200529     C                   EVAL      FATED5 = A_FVTED5                                          CGL132
047500200529     C                   EVAL      FATES1 = A_FVTES1                                          CGL132
047510200529     C                   EVAL      FATES2 = A_FVTES2                                          CGL132
047520200529     C                   EVAL      FATES3 = A_FVTES3                                          CGL132
047530200529     C                   EVAL      FATES4 = A_FVTES4                                          CGL132
047540200529     C                   EVAL      FATES5 = A_FVTES5                                          CGL132
047550200529     C                   EVAL      FATECO = A_FVTECO                                          CGL132
047560200529     C                   EVAL      FATXSV = A_FVTXSV                                          CGL132
047570200529     C                   EVAL      FATXSD = A_FVTXSD                                          CGL132
047580200529     C                   EVAL      FATXOV = A_FVTXOV                                          CGL132
047590200529     C                   EVAL      FATXD1 = A_FVTXD1                                          CGL132
047600200529     C                   EVAL      FATXD2 = A_FVTXD2                                          CGL132
047610200529     C                   EVAL      FATXD3 = A_FVTXD3                                          CGL132
047620200529     C                   EVAL      FATXD4 = A_FVTXD4                                          CGL132
047630200529     C                   EVAL      FATXD5 = A_FVTXD5                                          CGL132
047640200529     C                   EVAL      FATXS1 = A_FVTXS1                                          CGL132
047650200529     C                   EVAL      FATXS2 = A_FVTXS2                                          CGL132
047660200529     C                   EVAL      FATXS3 = A_FVTXS3                                          CGL132
047670200529     C                   EVAL      FATXS4 = A_FVTXS4                                          CGL132
047680200529     C                   EVAL      FATXS5 = A_FVTXS5                                          CGL132
047690200529     C                   EVAL      FATXCO = A_FVTXCO                                          CGL132
047700200529     C                   EVAL      FAEXEM = A_FVEXEM                                          CGL132
047710200529     C                   EVAL      FAEXER = A_FVEXER                                          CGL132
047720200529     C                   EVAL      FAEXED = A_FVEXED                                          CGL132
047730200529     C                   EVAL      FAEXET = A_FVEXET                                          CGL132
047740200529     C                   EVAL      FAEXEU = A_FVEXEU                                          CGL132
047750200529     C                   EVAL      FAREPT = A_FVREPT                                          CGL132
047760200529     C                   EVAL      FAGIIN = A_FVGIIN                                          CGL132
047770200529     C                   EVAL      FAGIID = A_FVGIID                                          CGL132
047780200529     C                   EVAL      FAGIIO = A_FVGIIO                                          CGL132
047790200529     C                   EVAL      FAUTIN = A_FVUTIN                                          CGL132
047800200529     C                   IF        CGL133 = 'N'                                               CGL132
047810200529     C                   IF        FAUTIN = *BLANKS                                           CGL132
047820200529     C                   MOVE      FACUST        PCustNo                                      CGL132
047830200529     C                   EVAL      WCTAX = SVal3                                              CGL132
047840200529     C                   MOVE      *BLANKS       FAUTIN                                       CGL132
047850200529     C**********         IF        E5TNC5 = WCTAX                                    CGL132 MD026550
047860200529     C**********         MOVEL     E5TIN5        FAUTIN                              CGL132 MD026550
047870200529     C**********         ENDIF                                                       CGL132 MD026550
047880200529     C**********         IF        E5TNC4 = WCTAX                                    CGL132 MD026550
047890200529     C**********         MOVEL     E5TIN4        FAUTIN                              CGL132 MD026550
047900200529     C**********         ENDIF                                                       CGL132 MD026550
047910200529     C**********         IF        E5TNC3 = WCTAX                                    CGL132 MD026550
047920200529     C**********         MOVEL     E5TIN3        FAUTIN                              CGL132 MD026550
047930200529     C**********         ENDIF                                                       CGL132 MD026550
047940200529     C**********         IF        E5TNC2 = WCTAX                                    CGL132 MD026550
047950200529     C**********         MOVEL     E5TIN2        FAUTIN                              CGL132 MD026550
047960200529     C**********         ENDIF                                                       CGL132 MD026550
047970200529     C**********         IF        BBCOLC = WCTAX                                    CGL132 MD026550
047980200529     C**********         MOVEL     E5TINO        FAUTIN                              CGL132 MD026550
047990200529     C**********         ENDIF                                                       CGL132 MD026550
048000200529     C                   IF        A_ADTNC5 = WCTAX                                         MD026550
048010200529     C                   MOVEL     A_ADTIN5      FAUTIN                                     MD026550
048020200529     C                   ENDIF                                                              MD026550
048030200529     C                   IF        A_ADTNC4 = WCTAX                                         MD026550
048040200529     C                   MOVEL     A_ADTIN4      FAUTIN                                     MD026550
048050200529     C                   ENDIF                                                              MD026550
048060200529     C                   IF        A_ADTNC3 = WCTAX                                         MD026550
048070200529     C                   MOVEL     A_ADTIN3      FAUTIN                                     MD026550
048080200529     C                   ENDIF                                                              MD026550
048090200529     C                   IF        A_ADTNC2 = WCTAX                                         MD026550
048100200529     C                   MOVEL     A_ADTIN2      FAUTIN                                     MD026550
048110200529     C                   ENDIF                                                              MD026550
048120200529     C                   IF        BBCOLC = WCTAX                                           MD026550
048130200529     C                   MOVEL     A_ADTINO      FAUTIN                                     MD026550
048140200529     C                   ENDIF                                                              MD026550
048150200529     C                   ENDIF                                                                CGL132
048160200529     C                   ENDIF                                                                CGL132
048170200529     C                   EVAL      FAGREC = A_FVGREC                                          CGL132
048180200529     C                   EVAL      FAMAIL = A_FVMAIL                                          CGL132
048190200529     C                   EVAL      FAPHON = A_FVPHON                                          CGL132
048200200529     C                   EVAL      FACSTY = A_FVCSTY                                          CGL132
048210200529     C                   EVAL      FACSST = A_FVCSST                                          CGL132
048220200529     C                   EVAL      FARPTT = A_FVRPTT                                          CGL132
048230200529     C                   EVAL      FARPTR = A_FVRPTR                                          CGL132
048240200529     C                   EVAL      FARPTD = A_FVRPTD                                          CGL132
048250200529     C                   EVAL      FARPTM = A_FVRPTM                                          CGL132
048260200529     C                   IF        FARPTM = '******'                                        MD051206
048270200529     C                   MOVE      BBTMST        WTime                                      MD051206
048280200529     C     *HMS0         MOVE      WTime         FARPTM                                     MD051206
048290200529     C                   ENDIF                                                              MD051206
048300200529     C                   EVAL      FARPTU = A_FVRPTU                                          CGL132
048310200529     C                   EVAL      FAHVAC = A_FVHVAC                                          CGL132
048320200529     C                   EVAL      FAINFC = A_FVINFC                                          CGL132
048330200529     C                   EVAL      FAEXMA = A_FVEXMA                                          CGL132
048340200529     C                   EVAL      FAEXID = A_FVEXID                                          CGL132
048350200529     C                   EVAL      FALDAT = BJRDNB                                            CGL132
048360200529     C                   EVAL      FALCTP = 'A'                                               CGL132
048370200529     C**********         EVAL      FALUSR = PSUSER                                   CGL132 MD026835
048380200529     C**********         EVAL      FALUSR = WKUSER                                MD026835 MD027492A
048390200529     C                   EVAL      FALUSR = WLUSER                                         MD027492A
048400200529     C                   UPDATE    SDFTCSD0                                                   CGL132
048410200529                                                                                              CGL132
048420200529     C                   IF        CSD092 = 'Y'                                               CGL132
048430200529     C                   EVAL      PBefFTCS = SDFTCS2                                       MD026957
048440200529     C                   EVAL      PAftFTCS = SDFTCS                                        MD026957
048450200529     C                   EVAL      PBefCUXC = SDCUXC2                                       MD026957
048460200529     C                   EVAL      PAftCUXC = SDCUXC                                        MD026957
048470200529     C                   IF        S01425 <> 'Y' OR CSD079 <> 'Y'                           MD026957
048480200529     C                   CALL      'SD009696'                                                 CGL132
048490200529     C                   PARM      FACUST        PCUST                                        CGL132
048500200529     C                   PARM      CUSTDF2       PBefCUST                                     CGL132
048510200529     C                   PARM      CUSTDF        PAftCUST                                     CGL132
048520200529     C                   PARM      *BLANKS       PBefACUS                                     CGL132
048530200529     C                   PARM      *BLANKS       PAftACUS                                     CGL132
048540200529     C                   PARM      SDFTCS2       PBefFTCS                                     CGL132
048550200529     C                   PARM      SDFTCS        PAftFTCS                                     CGL132
048560200529     C                   PARM      *BLANKS       PBefJACC                                     CGL132
048570200529     C                   PARM      *BLANKS       PAftJACC                                     CGL132
048580200529     C                   PARM      *BLANKS       PBefCUAH                                     CGL132
048590200529     C                   PARM      *BLANKS       PAftCUAH                                     CGL132
048600200529     C                   PARM      SDCUXC2       PBefCUXC                                   MD026854
048610200529     C                   PARM      SDCUXC        PAftCUXC                                   MD026854
048620200529     C                   PARM      *BLANKS       PACRV                                        CGL132
048630200529     C                   PARM      *BLANKS       PELEC                                        CGL132
048640200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
048650200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
048660200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
048670200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
048680200529     C                   ENDIF                                                              MD026957
048690200529     C                   ENDIF                                                                CGL132
048700200529                                                                                              CGL132
048710200529     C                   IF        CGL132 = 'Y' AND                                           CGL132
048720200529     C                             FAHVAC = 'H' AND                                           CGL132
048730200529     C                             WWHVAC <> 'H' AND                                          CGL132
048740200529     C                             CSD092 = 'Y'                                               CGL132
048750200529     C                   EVAL      KCUST = FACUST                                             CGL132
048760200529     C                   EVAL      KSCDT = BJRDNB                                             CGL132
048770200529     C                   EVAL      KSEQN = 999                                                CGL132
048780200529     C                   EVAL      ARSEQN = 0                                                 CGL132
048790200529     C     KACRV         SETGT     SDACRVL0                                                   CGL132
048800200529     C                   READP     SDACRVL0                                                   CGL132
048810200529                                                                                              CGL132
048820200529     C                   IF        ARCUST = KCUST AND                                         CGL132
048830200529     C                             ARSCDT = KSCDT                                             CGL132
048840200529     C                   EVAL      AVSEQN = ARSEQN + 1                                        CGL132
048850200529     C                   ELSE                                                                 CGL132
048860200529     C                   CLEAR                   SDACRVDF                                   MD045218
048870200529     C                   EVAL      AVSEQN = 1                                                 CGL132
048880200529     C                   ENDIF                                                                CGL132
048890200529                                                                                              CGL132
048900200529     C**********         CLEAR                   SDACRVDF                            CGL132 MD045218
048910200529                                                                                              CGL132
048920200529     C                   EVAL      ARCUST = FACUST                                            CGL132
048930200529     C                   EVAL      ARSEQN = AVSEQN                                            CGL132
048940200529     C                   EVAL      ARPURP = 'FATCA High Value +                               CGL132
048950200529     C                                      Account Review'                                   CGL132
048960200529     C**********         EVAL      ARSCDT = BJRDNB                                   CGL132 MD026502
048970200529     C                   EVAL      ARACRF = SVal2                                             CGL132
048980200529     C                   EVAL      ARCOMP = 'N'                                               CGL132
048990200529      ** Calculate for Schedule Date                                                        MD026502
049000200529     C                   CALL      'SD000164'                                               MD026502
049010200529     C                   PARM      *BLANKS       RtCdScDt          7                        MD026502
049020200529     C                   PARM      ARACRF        AcRvFreq          1                        MD026502
049030200529     C                   PARM      ARCOMP        AcRvComp          1                        MD026502
049040200529     C                   PARM                    BJDFIN                                     MD026502
049050200529     C                   PARM                    BJCYCD                                     MD026502
049060200529     C                   PARM                    BJLCCY                                     MD026502
049070200529     C                   PARM                    BJSLCD                                     MD026502
049080200529     C                   PARM                    BJRDNB                                     MD026502
049090200529     C                   PARM      0             AcRvScDt          5 0                      MD026502
049100200529      ** Account Review Schedule Date                                                       MD026502
049110200529     C                   EVAL      ARSCDT = AcRvScDt                                        MD026502
049120200529                                                                                              CGL132
049130200529      ** Get timestamp.                                                                       CGL132
049140200529                                                                                              CGL132
049150200529     C                   CALLB     'ZAGENTMSTM'                                               CGL132
049160200529     C                   PARM                    WWTMST                                       CGL132
049170200529     C                   MOVE      WWTMST        ARTMST                                       CGL132
049180200529                                                                                              CGL132
049190200529     C                   EVAL      ARMAGE = 'G'                                               CGL132
049200200529     C                   EVAL      ARLTYP = 'I'                                               CGL132
049210200529     C**********         EVAL      ARLUSR = PSUSER                                   CGL132 MD026835
049220200529     C**********         EVAL      ARLUSR = WKUSER                                MD026835 MD027492A
049230200529     C                   EVAL      ARLUSR = WLUSER                                         MD027492A
049240200529     C                   EVAL      ARINDT = BJRDNB                                            CGL132
049250200529     C                   EVAL      ARFOID = *BLANKS                                           CGL132
049260200529                                                                                              CGL132
049270200529     C                   WRITE     SDACRVD0                                                   CGL132
049280200529                                                                                              CGL132
049290200529     C                   EVAL      EXDDCUST = ARCUST                                        MD026499
049300200529     C                   EVAL      EXDDSCDF = *BLANKS                                       MD026499
049310200529     C                   MOVEL     ARSCDT        EXDDSCDF                                   MD026499
049320200529     C                   EVAL      EXDDSEQN = %TRIML(%CHAR(ARSEQN):'0')                     MD026499
049330200529     C                   EVAL      EXDDFOID = ARFOID                                        MD026499
049340200529     C                   WRITE     TSDACRVD0                                                MD026499
049350200529                                                                                            MD026499
049360200529     C                   ENDIF                                                                CGL132
049370200529     C                   ENDIF                                                                CGL132
049380200529                                                                                              CGL157
049390200529      ** Access CRS Transaction Details if CGL157 is *ON                                      CGL157
049400200529                                                                                              CGL157
049410200529     C                   IF        CGL157 = 'Y'                                               CGL157
049420200529     C     A_CUCUST      CHAIN     SDCRSHL0                             99                    CGL157
049430200529     C                   EVAL      PBefCRSH = SDCRSH                                          CGL177
049440200529                                                                                              CGL157
049450200529      ** Initialize Transaction Detail                                                        CGL157
049460200529                                                                                              CGL157
049470200529     C                   CLEAR                   SDCRSH                                       CGL157
049480200529                                                                                              CGL157
049490200529     C                   EVAL      CRCUST = BBCUST                                            CGL157
049500200529     C                   EVAL      CRTYPE = C_CVTYPE                                          CGL157
049510200529     C                   EVAL      CRSTYP = C_CVSTYP                                          CGL157
049520200529     C                   EVAL      CRHVAL = C_CVHVAL                                          CGL157
049530200529     C                   EVAL      CREXMP = C_CVEXMP                                          CGL157
049540200529     C                   EVAL      CREXMR = C_CVEXMR                                          CGL157
049550200529     C                   EVAL      CREXMD = C_CVEXMD                                          CGL157
049560200529     C                   EVAL      CREXMT = C_CVEXMT                                          CGL157
049570200529     C                   EVAL      CREXMU = C_CVEXMU                                          CGL157
049580200529     C                   EVAL      CRINFO = C_CVINFO                                          CGL157
049590200529     C                   EVAL      CREXMG = C_CVEXMG                                          CGL157
049600200529     C                   EVAL      CREXMI = C_CVEXMI                                          CGL157
049610200529     C                   EVAL      PAftCRSH = SDCRSH                                          CGL177
049620200529     C                                                                                        CGL157
049630200529     C                   UPDATE    SDCRSHD0                                                   CGL157
049640200529                                                                                              CGL157
049650200529      ** Update CRS Country Details                                                           CGL157
049660200529     C                   EVAL      A = 1                                                      CGL177
049670200529     C                   EVAL      X = 1                                                      CGL157
049680200529     C                   EVAL      PBefCRSD = *BLANKS                                         CGL177
049690200529     C                   EVAL      PAftCRSD = *BLANKS                                         CGL177
049700200529     C                   DOW       X < 31                                                     CGL157
049710200529     C                   EVAL      SDVCRSD = PCrsdF(X)                                        CGL157
049720200529     C                   EVAL      PCrsdZ = PCrsdF(X)                                         CGL157
049730200529     C                   IF        D_CVCTRY <> *Blanks                                        CGL157
049740200529     C                   EVAL      KCUST = BBCUST                                             CGL177
049750200529     C                   EVAL      KCTRY = D_CVCTRY                                           CGL177
049760200529     C     KCRSD         CHAIN     SDCRSDL1                                                   CGL177
049770200529     C                   EVAL      SDCRSDB = SDCRSD                                           CGL177
049780200529     C                   EVAL      CDCUST = BBCUST                                            CGL157
049790200529     C                   EVAL      CDCTRY = D_CVCTRY                                          CGL157
049800200529     C                   EVAL      CDREPT = D_CVREPT                                          CGL157
049810200529     C                   EVAL      CDREPR = D_CVREPR                                          CGL157
049820200529                                                                                            MD036375
049830200529      ** Look for the US Country and use the TIN if provided                                MD036375
049840200529     C                   IF        CGL132 = 'Y' AND                                         MD036375
049850200529     C                             CGL133 = 'N'                                             MD036375
049860200529     C*****BBCUST        CHAIN     SDFTCSL0                             99         MD036375 MD051230
049870200529     C     BBCUST        CHAIN(N)  SDFTCSL0                             99                  MD051230
049880200529                                                                                            MD036375
049890200529      ** Database error                                                                     MD036375
049900200529     C                   IF        NOT %FOUND(SDFTCSL0)                                     MD036375
049910200529     C                   EVAL      DBKEY  = BBCUST                                          MD036375
049920200529     C                   EVAL      DBFILE = 'SDFTCSPD'                                      MD036375
049930200529     C                   EVAL      DBASE  =  801                                            MD036375
049940200529     C                   EXSR      SRErr                                                    MD036375
049950200529     C                   ENDIF                                                              MD036375
049960200529                                                                                            MD036375
049970200529     C                   EVAL      WCTAX = SVal1                                            MD036375
049980200529                                                                                            MD036375
049990200529     C                   IF        BBCOLC = WCTAX                                           MD036375
050000200529     C     BBCUST        CHAIN     SDFTCSL0                             99                  MD051230
050010200529     C                   EVAL      FAUTIN = E5TINO                                          MD036375
050020200529     C                   UPDATE    SDFTCSD0                                                 MD036375
050030200529     C                   ELSE                                                               MD036457
050040200529     C                   IF        D_CVCTRY = WCTAX                                         MD036457
050050200529     C     BBCUST        CHAIN     SDFTCSL0                             99                  MD051230
050060200529     C                   EVAL      FAUTIN = D_CVTINN                                        MD036457
050070200529     C                   UPDATE    SDFTCSD0                                                 MD036457
050080200529     C                   ENDIF                                                              MD036457
050090200529     C                   ENDIF                                                              MD036457
050100200529     C                   ENDIF                                                              MD036375
050110200529                                                                                            MD036375
050120200529     C                   IF        %SUBST(PCrsdZ:138:3) = *Blanks                             CGL157
050130200529     C                   EVAL      CDREPD = *Zero                                             CGL157
050140200529     C                   ELSE                                                                 CGL157
050150200529     C                   MOVE      D_CVREPD      CDREPD                                       CGL157
050160200529     C                   ENDIF                                                                CGL157
050170200529     C                   EVAL      CDREPM = D_CVREPM                                          CGL157
050180200529     C                   IF        CDREPM = '******'                                          CGL177
050190200529     C**********         MOVE      E5TMST        WTime                               CGL177 MD051393
050200200529     C                   MOVE      BBTMST        WTime                                      MD051393
050210200529     C     *HMS0         MOVE      WTime         CDREPM                                       CGL177
050220200529     C                   ENDIF                                                                CGL177
050230200529     C                   EVAL      CDREPU = D_CVREPU                                          CGL157
050240200529     C                   EVAL      CDEVE1 = D_CVEVE1                                          CGL157
050250200529     C                   EVAL      CDEVS1 = D_CVEVS1                                          CGL157
050260200529     C                   EVAL      CDEVE2 = D_CVEVE2                                          CGL157
050270200529     C                   EVAL      CDEVS2 = D_CVEVS2                                          CGL157
050280200529     C                   EVAL      CDEVE3 = D_CVEVE3                                          CGL157
050290200529     C                   EVAL      CDEVS3 = D_CVEVS3                                          CGL157
050300200529     C                   EVAL      CDEVE4 = D_CVEVE4                                          CGL157
050310200529     C                   EVAL      CDEVS4 = D_CVEVS4                                          CGL157
050320200529     C                   EVAL      CDEVE5 = D_CVEVE5                                          CGL157
050330200529     C                   EVAL      CDEVS5 = D_CVEVS5                                          CGL157
050340200529     C                   EVAL      CDTINN = D_CVTINN                                          CGL157
050350200529     C                   EVAL      CDCODO = D_CVCODO                                          CGL157
050360200529     C                   EVAL      CDJACM = D_CVJACM                                          CGL157
050370200529     C                   EVAL      CDMAIL = D_CVMAIL                                          CGL157
050380200529     C                   EVAL      CDPHON = D_CVPHON                                          CGL157
050390200529     C                   EVAL      CDRPAY = D_CVRPAY                                          CGL157
050400200529     C                   EVAL      CDTINS = D_CVTINS                                          CGL177
050410200529     C                   IF        %SUBST(PCrsdZ:207:3) = *Blanks                             CGL157
050420200529     C                   EVAL      CDEFFD = *Zero                                             CGL157
050430200529     C                   ELSE                                                                 CGL157
050440200529     C                   MOVE      D_CVEFFD      CDEFFD                                       CGL157
050450200529     C                   ENDIF                                                                CGL157
050460200529     C                   IF        %SUBST(PCrsdZ:210:3) = *Blanks                             CGL157
050470200529     C                   EVAL      CDEXPD = *Zero                                             CGL157
050480200529     C                   ELSE                                                                 CGL157
050490200529     C                   MOVE      D_CVEXPD      CDEXPD                                       CGL157
050500200529     C                   ENDIF                                                                CGL157
050510200529                                                                                              CGL157
050520200529     C                   IF        %FOUND(SDCRSDL1)                                           CGL177
050530200529     C                   IF        %SUBST(PCrsdZ:3:1) <> '*'                                  CGL177
050540200529     C                   EVAL      %SUBST(PBefCRSD:A:219) = SDCRSDB                           CGL177
050550200529     C                   EVAL      %SUBST(PAftCRSD:A:219) = SDCRSD                            CGL177
050560200529     C                   EVAL      A = A + 229                                                CGL177
050570200529     C                   UPDATE    SDCRSDD0                                                   CGL177
050580200529     C                   ELSE                                                                 CGL177
050590200529     C                   DELETE    SDCRSDD0                                                   CGL177
050600200529     C                   ENDIF                                                                CGL177
050610200529     C                   ELSE                                                                 CGL177
050620200529     C                   IF        %SUBST(PCrsdZ:3:1) <> '*'                                  CGL177
050630200529     C                   EVAL      %SUBST(PBefCRSD:A:219) = *Blanks                           CGL177
050640200529     C                   EVAL      %SUBST(PAftCRSD:A:219) = SDCRSD                            CGL177
050650200529     C                   EVAL      A = A + 229                                                CGL177
050660200529     C                   WRITE     SDCRSDD0                                                   CGL157
050670200529     C                   ENDIF                                                                CGL177
050680200529     C                   ENDIF                                                                CGL177
050690200529     C                   ENDIF                                                                CGL157
050700200529     C                   EVAL      X = X + 1                                                  CGL157
050710200529     C                   ENDDO                                                                CGL157
050720200529     C                   ENDIF                                                                CGL157
050730200529     C                   IF        CSD092 = 'Y'                                               CGL177
050740200529     C                             AND (S01425 <> 'Y' OR CSD079 <> 'Y')                     MD051563
050750200529     C                   IF        CGL132 = 'Y'                                               CGL177
050760200529     C                   EVAL      PBefFTCS = SDFTCS2                                         CGL177
050770200529     C                   EVAL      PAftFTCS = SDFTCS                                          CGL177
050780200529     C                   ELSE                                                                 CGL177
050790200529     C                   EVAL      PBefFTCS = *BLANKS                                         CGL177
050800200529     C                   EVAL      PAftFTCS = *BLANKS                                         CGL177
050810200529     C                   ENDIF                                                                CGL177
050820200529     C                   IF        CGL157 = 'N'                                               CGL177
050830200529     C                   EVAL      PBefCRSH = *BLANKS                                         CGL177
050840200529     C                   EVAL      PAftCRSH = *BLANKS                                         CGL177
050850200529     C                   EVAL      PBefCRSD = *BLANKS                                         CGL177
050860200529     C                   EVAL      PAftCRSD = *BLANKS                                         CGL177
050870200529     C                   ENDIF                                                                CGL177
050880200529                                                                                            MD041429
050890200529      ** Separate call of History of Customer Info program                                  MD041429
050900200529      ** for CRS Header (Miscellaneous Change)                                              MD041429
050910200529                                                                                            MD041429
050920200529     C                   IF        CGL132 = 'Y'                                             MD041429
050930200529     C                   CALL      'SD009696'                                               MD041429
050940200529     C                   PARM      BBCUST        PCUST                                      MD041429
050950200529     C                   PARM      *BLANKS       PBefCUST                                   MD041429
050960200529     C                   PARM      CUSTDF        PAftCUST                                   MD041429
050970200529     C                   PARM      *Blanks       PBefACUS                                   MD041429
050980200529     C                   PARM      *Blanks       PAftACUS                                   MD041429
050990200529     C                   PARM                    PBefFTCS                                   MD041429
051000200529     C                   PARM                    PAftFTCS                                   MD041429
051010200529     C                   PARM      *BLANKS       PBefJACC                                   MD041429
051020200529     C                   PARM      *BLANKS       PAftJACC                                   MD041429
051030200529     C                   PARM      *BLANKS       PBefCUAH                                   MD041429
051040200529     C                   PARM      *BLANKS       PAftCUAH                                   MD041429
051050200529     C                   PARM      *BLANKS       PBefCUXC                                   MD041429
051060200529     C                   PARM      *BLANKS       PAftCUXC                                   MD041429
051070200529     C                   PARM      *BLANKS       PACRV                                      MD041429
051080200529     C                   PARM      *BLANKS       PELEC                                      MD041429
051090200529     C                   PARM                    PBefCRSH                                   MD041429
051100200529     C                   PARM                    PAftCRSH                                   MD041429
051110200529     C                   PARM                    PBefCRSD                                   MD041429
051120200529     C                   PARM                    PAftCRSD                                   MD041429
051130200529                                                                                            MD041429
051140200529     C                   ELSE                                                               MD041429
051150200529                                                                                            MD041429
051160200529     C                   CALL      'SD009696'                                               MD041429
051170200529     C                   PARM      BBCUST        PCUST                                      MD041429
051180200529     C                   PARM      *BLANKS       PBefCUST                                   MD041429
051190200529     C                   PARM      CUSTDF        PAftCUST                                   MD041429
051200200529     C                   PARM      *BLANKS       PBefACUS                                   MD041429
051210200529     C                   PARM      *BLANKS       PAftACUS                                   MD041429
051220200529     C                   PARM      *BLANKS       PBefFTCS                                   MD041429
051230200529     C                   PARM      *BLANKS       PAftFTCS                                   MD041429
051240200529     C                   PARM      *BLANKS       PBefJACC                                   MD041429
051250200529     C                   PARM      *BLANKS       PAftJACC                                   MD041429
051260200529     C                   PARM      *BLANKS       PBefCUAH                                   MD041429
051270200529     C                   PARM      *BLANKS       PAftCUAH                                   MD041429
051280200529     C                   PARM      *BLANKS       PBefCUXC                                   MD041429
051290200529     C                   PARM      *BLANKS       PAftCUXC                                   MD041429
051300200529     C                   PARM      *BLANKS       PACRV                                      MD041429
051310200529     C                   PARM      *BLANKS       PELEC                                      MD041429
051320200529     C                   PARM                    PBefCRSH                                   MD041429
051330200529     C                   PARM                    PAftCRSH                                   MD041429
051340200529     C                   PARM                    PBefCRSD                                   MD041429
051350200529     C                   PARM                    PAftCRSD                                   MD041429
051360200529     C                   ENDIF                                                              MD041429
051370200529                                                                                            MD041429
051380200529     C                   ENDIF                                                                CGL157
051390200529
051400200529
051410200529      * Update CLINTCB - Client Details  *
051420200529     C                   CALL      'SDCLINT'
051430200529     C                   PARM      *BLANK        @RTCD             7
051440200529     C                   PARM      BBCUST        @CUST             6
051450200529     C                   PARM      BBCSSN        @CSSN            10
051460200529     C                   PARM      BBCRTN        @CRTN            10
051470200529     C                   PARM      BBPAIN        @PAIN             1
051480200529     C                   PARM      BBCRNM        @CRNM            20
051490200529     C                   PARM      BBACOC        @ACOC             2
051500200529     C                   PARM      BBCNCZ        @CNCZ             2
051510200529     C                   PARM      BBCOLC        @COLC             2
051520200529     C                   PARM      BBSSDT        @SSDT             5 0
051530200529     C                   PARM      BBDOIC        @DOIC             5 0
051540200529     C                   PARM      BBPCNB        @PCNB             6
051550200529     C                   PARM      BBCASC        @CASC             8
051560200529     C                   PARM      BBBRCD        @BRCD             3
051570200529     C                   PARM      BBBNBI        @BNBI             1
051580200529     C                   PARM      BBLINC        @LINC             2
051590200529     C                   PARM      BBLICD        @LICD             3
051600200529     C                   PARM      BBCTNB        @CTNB            12
051610200529     C                   PARM      BBREID        @REID             4
051620200529     C                   PARM      BBBSIN        @BSIN             1
051630200529     C                   PARM      BBCSTY        @CSTY             1
051640200529     C                   PARM      BBTAIN        @TAIN             1
051650200529     C                   PARM      BBCSID        @CSID            12
051660200529     C                   PARM      BBSTAD        @STAD            12
051670200529     C                   PARM      BBTXA1        @TXA1            10
051680200529     C                   PARM      BBCHID        @CHID             6 0
051690200529     C                   PARM      BBCHSC        @CHSC             6 0
051700200529     C                   PARM      BBCABA        @CABA             3 0
051710200529     C                   PARM      BBRWCD        @RWCD             4
051720200529     C                   PARM      BBCGRP        @CGRP             1
051730200529     C                   PARM      BBABA2        @ABA2             4 0
051740200529     C                   PARM      BBTYLC        @TYLC             1
051750200529     C                   PARM      BJRDNB        @RDNB             5 0
051760200529     C                   PARM      WUGPC1        @GPC1             4
051770200529     C                   PARM      WUGPC2        @GPC2             4
051780200529     C                   PARM      WUGPC3        @GPC3             4
051790200529     C                   PARM      WUGPC4        @GPC4             4
051800200529     C                   PARM      WUGPC5        @GPC5             4
051810200529     C                   PARM      A_ADLNID      @LNID             2                        AR830675
051820200529     C                   PARM      A_ADCTYP      @CTYP            10                        AR830675
051830200529     C/COPY WNCPYSRC,SDCUSDDC07
051840200529      * Send message 'Unable to update'
051850200529     C     @RTCD         IFEQ      '*ERROR*'
051860200529     C                   MOVEL     *BLANK        DBKEY
051870200529     C                   MOVEL     BBCUST        DBKEY
051880200529     C                   MOVEL     'CLINTCB'     DBFILE                         ************
051890200529     C                   MOVEL     '011'         DBASE                          * DBERR 011*
051900200529     C                   EXSR      SRERR                                        ************
051910200529     C                   END
051920200529
051930200529      * Update CLINTCC 2 - Client Details  *
051940200529     C                   CALL      'SDALTNA'
051950200529     C                   PARM      *BLANK        @RTCD             7
051960200529     C                   PARM      BBCUST        @CUST             6
051970200529     C                   PARM      BBCNA1        @CNA1            35
051980200529     C                   PARM      BBCNA2        @CNA2            35
051990200529     C                   PARM      BBCNA3        @CNA3            35
052000200529     C                   PARM      BBCNA4        @CNA4            35
052010200529     C                   PARM      BBCRTN        @CRTN            10
052020200529     C                   PARM      BBTYLC        @TYLC             1
052030200529     C                   PARM      BJRDNB        @RDNB             5 0
052040200529      * Send message 'Unable to update'
052050200529     C     @RTCD         IFEQ      '*ERROR*'
052060200529     C                   MOVEL     *BLANK        DBKEY
052070200529     C                   MOVEL     BBCUST        DBKEY
052080200529     C                   MOVEL     'CLINTCC'     DBFILE                         ************
052090200529     C                   MOVEL     '012'         DBASE                          * DBERR 012*
052100200529     C                   EXSR      SRERR                                        ************
052110200529     C                   END
052120200529      *
052130200529                                                                                            MD027115
052140200529     C                   IF        CGL132 = 'Y'                                             MD027115
052150200529      ** Update exceptions on Joint Account                                                 MD027115
052160200529                                                                                            MD027115
052170200529     C     BBCUST        SETLL     SDJACCL4                                                 MD027115
052180200529     C     BBCUST        READE     SDJACCL4                                                 MD027115
052190200529                                                                                            MD027115
052200200529     C                   DOW       NOT %EOF(SDJACCL4)                                       MD027115
052210200529                                                                                            MD027115
052220200529     C                   CALL      'SD000715'                                               MD027115
052230200529     C                   PARM                    JCJANO                                     MD027115
052240200529     C                   PARM      '1'           PCommitCUSD                                MD043029
052250200529     C                   PARM      '0'           PCommitNAHL                                MD043029
052260200529                                                                                            MD027115
052270200529     C     BBCUST        READE     SDJACCL4                                                 MD027115
052280200529     C                   ENDDO                                                              MD027115
052290200529                                                                                            MD027115
052300200529     C                   ENDIF                                                              MD027115
052310200529                                                                                            MD027115
052320200529     C                   ENDSR
052330200529     C****************************************************************
052340200529      /EJECT
052350200529     C****************************************************************
052360200529     C*                                                              *
052370200529     C* DELETE - DELETE A CUSTOMER                                   *
052380200529     C*                                                              *
052390200529     C****************************************************************
052400200529     C     DELETE        BEGSR
052410200529
052420200529      ** ACCESS CUSTOMER
052430200529
052440200529     C*****A_CUCUST      CHAIN     SDCUSTL0                           99                      252069
052450200529     C     A_CUCUST      CHAIN     SDCUSTL0                           9997                    252069
052460200529     C                   EXSR      ChkChain                                                   252069
052470200529
052480200529      ** DATABASE ERROR
052490200529
052500200529     C     *IN99         IFEQ      '1'
052510200529     C                   MOVEL     A_CUCUST      DBKEY
052520200529     C                   MOVEL     'SDCUSTPD'    DBFILE                         ************
052530200529     C                   MOVEL     '013'         DBASE                          * DBERR 013*
052540200529     C                   EXSR      SRERR                                        ************
052550200529     C                   END
052560200529
052570200529      ** UPDATE 'BEFORE' STATUS
052580200529
052590200529     C                   MOVEL(P)  CUSTDF        B_CUSTD
052600200529
052610200529      ** SET CUSTOMER FIELDS ON DELETE
052620200529
052630200529     C                   EVAL      BBLCD=BJRDNB
052640200529     C                   EVAL      BBDTDL=BJRDNB
052650200529     C                   EVAL      BBTYLC='D'
052660200529
052670200529      ** Timestamp
052680200529     C                   CALLB     'ZAGENTMSTM'
052690200529     C                   PARM                    TimeStamp
052700200529
052710200529     C                   EVAL      BBTMST = TimeStamp
052720200529
052730200529      ** Front Office ID                                                        CAP013
052740200529     C                   EVAL      BBFRNT=A_CUFRNT                              CAP013
052750200529      ** Associated Front Office ID                                             CAP013
052760200529     C                   EVAL      BBAFRT=A_CUAFRT                              CAP013
052770200529      *
052780200529      ** Update the SWIFT 2007 field details when CSW207 is on                                CSW207
052790200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                               CSW207
052800200529     C     A_CUCUST      CHAIN     SDCSSWL0                                                   CSW207
052810200529     C                   IF        %FOUND(SDCSSWL0)                                           CSW207
052820200529     C                   EVAL      CSCUSD = A_CUCUST                                          CSW207
052830200529     C                   EVAL      CSBRCA = A_CUBRCD                                          CSW207
052840200529     C                   EVAL      CSCICI = A_CUCICI                                          CSW207
052850200529     C                   EVAL      CSCPCI = A_CUCPCI                                          CSW207
052860200529     C                   EVAL      CSIBEI = A_CUIBEI                                          CSW207
052870200529     C**********         IF        CFT050 = 'Y'                                      CFT050 MD028198
052880200529     C                   IF        CSW213 = 'Y'                                             MD028198
052890200529     C                   EVAL      CSLEIC = S13DDLEIC                                         CFT050
052900200529     C                   EVAL      CSCLSY = S13DDCLSY                                         CFT050
052910200529     C                   EVAL      CSCLID = S13DDCLID                                         CFT050
052920200529     C                   ENDIF                                                              MD028198
052930200529     C                   IF        CFT050 = 'Y'                                             MD028198
052940200529     C                   EVAL      CSBDRK = S13DDBDRK                                         CFT050
052950200529     C                   ENDIF                                                                CFT050
052960200529     C                   UPDATE    SDCSSWD0                                                   CSW207
052970200529     C                   ENDIF                                                                CSW207
052980200529     C                   ENDIF                                                                CSW207
052990200529      *                                                                                       CSW207
053000200529      ** UPDATE RECORD
053010200529
053020200529     C                   UPDATE    @BBREBG
053030200529                                                                                              CGL132
053040200529     C                   IF        CGL132 = 'Y'                                               CGL132
053050200529     C     A_CUCUST      CHAIN     SDFTCSL0                           99                      CGL132
053060200529                                                                                              CGL132
053070200529      ** Database error                                                                       CGL132
053080200529                                                                                              CGL132
053090200529     C     *IN99         IFEQ      '1'                                                        CGL132
053100200529     C                   MOVEL     A_CUCUST      DBKEY                                        CGL132
053110200529     C                   MOVEL     'SDFTCSPD'    DBFILE                                       CGL132
053120200529     C                   MOVEL     '006'         DBASE                                        CGL132
053130200529     C                   EXSR      SRERR                                                      CGL132
053140200529     C                   ENDIF                                                                CGL132
053150200529     C                   EVAL      FALDAT = BJRDNB                                            CGL132
053160200529     C                   EVAL      FALCTP = 'D'                                               CGL132
053170200529     C**********         EVAL      FALUSR = PSUSER                                   CGL132 MD026835
053180200529     C**********         EVAL      FALUSR = WKUSER                                MD026835 MD027492A
053190200529     C                   EVAL      FALUSR = WLUSER                                         MD027492A
053200200529     C                   UPDATE    SDFTCSD0                                                   CGL132
053210200529     C                   ENDIF                                                                CGL132
053220200529                                                                                              CSD092
053230200529     C                   IF        CSD092 = 'Y'                                               CSD092
053240200529     C                   IF        S01425 = 'Y' AND                                           CSD092
053250200529     C                             CSD079 = 'Y'                                               CSD092
053260200529     C                   ELSE                                                                 CSD092
053270200529                                                                                              CSD092
053280200529     C                   IF        S01425 <> 'Y' OR CSD079 <> 'Y'                           MD026957
053290200529     C                   CALL      'SD009696'                                                 CSD092
053300200529     C                   PARM      BBCUST        PCUST                                        CSD092
053310200529     C                   PARM      B_CUSTD       PBefCUST                                     CSD092
053320200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
053330200529     C                   PARM      *BLANKS       PBefACUS                                     CSD092
053340200529     C                   PARM      *BLANKS       PAftACUS                                     CSD092
053350200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
053360200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL132
053370200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
053380200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
053390200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
053400200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
053410200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
053420200529     C                   PARM      *BLANKS       PAftCUXC                                   MD026854
053430200529     C                   PARM      *BLANKS       PACRV                                        CSD092
053440200529     C                   PARM      *BLANKS       PELEC                                        CGL132
053450200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
053460200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
053470200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
053480200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
053490200529     C                   ENDIF                                                              MD026957
053500200529     C                   ENDIF                                                                CSD092
053510200529     C                   ENDIF                                                                CSD092
053520200529                                                                                              CGL157
053530200529     C                   IF        CGL157 = 'Y'                                               CGL157
053540200529     C     A_CUCUST      CHAIN     SDCRSHL0                             99                    CGL157
053550200529     C                   EVAL      PBefCRSH = SDCRSH                                          CGL177
053560200529                                                                                              CGL157
053570200529     C                   EVAL      CRLDAT = BJRDNB                                            CGL157
053580200529     C                   EVAL      CRLCTP = 'D'                                               CGL157
053590200529     C                   EVAL      PAftCRSH = SDCRSH                                          CGL177
053600200529                                                                                              CGL157
053610200529     C                   UPDATE    SDCRSHD0                                                   CGL157
053620200529                                                                                              CGL157
053630200529     C                   CALL      'SD009696'                                                 CGL157
053640200529     C                   PARM      E5CUST        PCUST                                        CGL157
053650200529     C                   PARM      *BLANKS       PBefCUST                                     CGL157
053660200529     C                   PARM      *BLANKS       PAftCUST                                     CGL157
053670200529     C                   PARM      B_CUADF       PBefACUS                                     CGL157
053680200529     C**********         PARM      CUSTDF        PAftACUS                            CGL157 MD054883
053690200529     C                   PARM      CUADF         PAftACUS                                   MD054883
053700200529     C                   PARM                    PBefFTCS                                     CGL157
053710200529     C                   PARM                    PAftFTCS                                     CGL157
053720200529     C                   PARM      *BLANKS       PBefJACC                                     CGL157
053730200529     C                   PARM      *BLANKS       PAftJACC                                     CGL157
053740200529     C                   PARM      *BLANKS       PBefCUAH                                   MD054883
053750200529     C                   PARM      *BLANKS       PAftCUAH                                   MD054883
053760200529     C                   PARM      *BLANKS       PBefCUXC                                     CGL157
053770200529     C                   PARM      *BLANKS       PAftCUXC                                     CGL157
053780200529     C                   PARM      *BLANKS       PACRV                                        CGL157
053790200529     C                   PARM      *BLANKS       PELEC                                        CGL157
053800200529     C                   PARM                    PBefCRSH                                     CGL157
053810200529     C                   PARM                    PAftCRSH                                     CGL157
053820200529     C                   PARM      *BLANKS       XBefCRSD                                     CGL157
053830200529     C                   PARM      *BLANKS       XAftCRSD                                     CGL157
053840200529                                                                                              CGL157
053850200529     C                   ENDIF                                                                CGL157
053860200529
053870200529      * USER: Processing after Data update
053880200529     C                   MOVEL     CUSTDF        WUDELR
053890200529      * Write Deleted Record - SD Deleted Records File  *
053900200529     C                   CLEAR                   PBRC
053910200529     C                   MOVEL     'SDCUSTPD'    PBFNME
053920200529     C                   MOVEL     A_CUCUST      PBLKEY
053930200529     C                   MOVEL     WUDR01        PBDR01
053940200529     C                   MOVEL     WUDR02        PBDR02
053950200529     C                   MOVEL     WUDR03        PBDR03
053960200529     C                   MOVEL     WUDR04        PBDR04
053970200529     C                   MOVEL     WUDR05        PBDR05
053980200529     C                   MOVEL     WUDR06        PBDR06
053990200529     C                   MOVEL     WUDR07        PBDR07
054000200529     C                   MOVEL     WUDR08        PBDR08
054010200529     C                   MOVEL     WUDR09        PBDR09
054020200529     C                   MOVEL     WUDR10        PBDR10
054030200529     C                   MOVEL     WUDR11        PBDR11
054040200529     C                   MOVEL     WUDR12        PBDR12
054050200529     C                   MOVEL     BJRDNB        PBLCD
054060200529     C                   MOVEL     'D'           PBTYLC
054070200529
054080200529     C                   CALL      'SD0520X'
054090200529     C                   PARM      *BLANK        @RTCD
054100200529     C                   PARM                    PBRC
054110200529      * Error detected?
054120200529     C     @RTCD         IFEQ      '*ERROR*'
054130200529     C                   MOVEL     *BLANK        DBKEY
054140200529     C                   MOVEL     A_CUCUST      DBKEY
054150200529     C                   MOVEL     'SDDELRL0'    DBFILE                         ************
054160200529     C                   MOVEL     '014'         DBASE                          * DBERR 014*
054170200529     C                   EXSR      SRERR                                        ************
054180200529     C                   END
054190200529
054200200529     C                   Z-ADD     -1            WUNORC                         No of records
054210200529     C                   Z-ADD     *ZERO         WUNOAM                         No of Amend
054220200529     C                   Z-ADD     *ZERO         WUNOIN                         No of delete
054230200529     C                   Z-ADD     1             WUNODL                         No of Insert
054240200529      * Change Standing Data Cont - Standing Data Controls  *
054250200529     C                   MOVEL     'SDCUSTPD'    WFLNAME           8            No of delete
054260200529     C                   EXSR      SNCHRC
054270200529
054280200529     C                   EXSR      UPDTID                                                    BUG3362
054290200529      *                                                                                      BUG3362
054300200529     C                   MOVEL     'D'           BBTYLC
054310200529      * Update CLINTCB - Client Details  *
054320200529     C                   CALL      'SDCLINT'
054330200529     C                   PARM      *BLANK        @RTCD
054340200529     C                   PARM      BBCUST        @CUST             6
054350200529     C                   PARM      BBCSSN        @CSSN            10
054360200529     C                   PARM      BBCRTN        @CRTN            10
054370200529     C                   PARM      BBPAIN        @PAIN             1
054380200529     C                   PARM      BBCRNM        @CRNM            20
054390200529     C                   PARM      BBACOC        @ACOC             2
054400200529     C                   PARM      BBCNCZ        @CNCZ             2
054410200529     C                   PARM      BBCOLC        @COLC             2
054420200529     C                   PARM      BBSSDT        @SSDT             5 0
054430200529     C                   PARM      BBDOIC        @DOIC             5 0
054440200529     C                   PARM      BBPCNB        @PCNB             6
054450200529     C                   PARM      BBCASC        @CASC             8
054460200529     C                   PARM      BBBRCD        @BRCD             3
054470200529     C                   PARM      BBBNBI        @BNBI             1
054480200529     C                   PARM      BBLINC        @LINC             2
054490200529     C                   PARM      BBLICD        @LICD             3
054500200529     C                   PARM      BBCTNB        @CTNB            12
054510200529     C                   PARM      BBREID        @REID             4
054520200529     C                   PARM      BBBSIN        @BSIN             1
054530200529     C                   PARM      BBCSTY        @CSTY             1
054540200529     C                   PARM      BBTAIN        @TAIN             1
054550200529     C                   PARM      BBCSID        @CSID            12
054560200529     C                   PARM      BBSTAD        @STAD            12
054570200529     C                   PARM      BBTXA1        @TXAI            10
054580200529     C                   PARM      BBCHID        @CHID             6 0
054590200529     C                   PARM      BBCHSC        @CHSC             6 0
054600200529     C                   PARM      BBCABA        @CABA             3 0
054610200529     C                   PARM      BBRWCD        @RWCD             4
054620200529     C                   PARM      BBCGRP        @CGRP             1
054630200529     C                   PARM      BBABA2        @ABA2             4 0
054640200529     C                   PARM      BBTYLC        @TYLC             1
054650200529     C                   PARM      BJRDNB        @RUNDNB           5 0
054660200529     C                   PARM      WUGPC1        @GPC1             4
054670200529     C                   PARM      WUGPC2        @GPC2             4
054680200529     C                   PARM      WUGPC3        @GPC3             4
054690200529     C                   PARM      WUGPC4        @GPC4             4
054700200529     C                   PARM      WUGPC5        @GPC5             4
054710200529     C                   PARM      A_ADLNID      @LNID             2                        AR830675
054720200529     C                   PARM      A_ADCTYP      @CTYP            10                        AR830675
054730200529     C/COPY WNCPYSRC,SDCUSDDC09
054740200529      * Send message 'Unable to update'
054750200529     C     @RTCD         IFEQ      '*ERROR*'
054760200529     C                   MOVEL     *BLANK        DBKEY
054770200529     C                   MOVEL     BBCUST        DBKEY
054780200529     C                   MOVEL     'CLINTCB'     DBFILE                         ************
054790200529     C                   MOVEL     '015'         DBASE                          * DBERR 015*
054800200529     C                   EXSR      SRERR                                        ************
054810200529     C                   END
054820200529
054830200529      * Update CLINTCC 2 - Client Details  *
054840200529     C                   CALL      'SDALTNA'
054850200529     C                   PARM      *BLANK        @RTCD
054860200529     C                   PARM      BBCUST        @CUST             6
054870200529     C                   PARM      BBCNA1        @CNA1            35
054880200529     C                   PARM      BBCNA2        @CNA2            35
054890200529     C                   PARM      BBCNA3        @CNA3            35
054900200529     C                   PARM      BBCNA4        @CNA4            35
054910200529     C                   PARM      BBCRTN        @CRTN            10
054920200529     C                   PARM      BBTYLC        @TYLC             1
054930200529     C                   PARM      BJRDNB        @RUNDNB           5 0
054940200529      * Send message 'Unable to update'
054950200529     C     @RTCD         IFEQ      '*ERROR*'
054960200529     C                   MOVEL     *BLANK        DBKEY
054970200529     C                   MOVEL     BBCUST        DBKEY
054980200529     C                   MOVEL     'CLINTCC'     DBFILE                         ************
054990200529     C                   MOVEL     '016'         DBASE                          * DBERR 016*
055000200529     C                   EXSR      SRERR                                        ************
055010200529     C                   END
055020200529      *
055030200529      * Check/Tag records - Alternate Names & Address  *
055040200529     C                   EXSR      SRRVGN
055050200529
055060200529      *
055070200529     C                   ENDSR
055080200529     C****************************************************************
055090200529      /EJECT                                                                                  CSD007
055100200529     C****************************************************************                        CSD007
055110200529     C*                                                              *                        CSD007
055120200529     C* CLOSE - CLOSE A CUSTOMER                                     *                        CSD007
055130200529     C*                                                              *                        CSD007
055140200529     C****************************************************************                        CSD007
055150200529     C     CLOSE         BEGSR                                                                CSD007
055160200529                                                                                              CSD007
055170200529      ** ACCESS CUSTOMER                                                                      CSD007
055180200529                                                                                              CSD007
055190200529     C*****A_CUCUST      CHAIN     SDCUSTL0                           99               CSD007 252069
055200200529     C     A_CUCUST      CHAIN     SDCUSTL0                           9997                    252069
055210200529     C                   EXSR      ChkChain                                                   252069
055220200529                                                                                              CSD007
055230200529      ** DATABASE ERROR                                                                       CSD007
055240200529                                                                                              CSD007
055250200529     C     *IN99         IFEQ      '1'                                                        CSD007
055260200529     C                   MOVEL     A_CUCUST      DBKEY                                        CSD007
055270200529     C                   MOVEL     'SDCUSTPD'    DBFILE                         ************  CSD007
055280200529     C                   MOVEL     '021'         DBASE                          * DBERR 021*  CSD007
055290200529     C                   EXSR      SRERR                                        ************  CSD007
055300200529     C                   END                                                                  CSD007
055310200529                                                                                              CSD007
055320200529      ** UPDATE 'BEFORE' STATUS                                                               CSD007
055330200529                                                                                              CSD007
055340200529     C                   MOVEL(P)  CUSTDF        B_CUSTD                                      CSD007
055350200529                                                                                              CSD007
055360200529      ** SET CUSTOMER FIELDS ON CLOSURE                                                       CSD007
055370200529                                                                                              CSD007
055380200529     C                   EVAL      BBLCD=BJRDNB                                               CSD007
055390200529     C                   EVAL      BBCLDT=BJRDNB                                              CSD007
055400200529     C                   EVAL      BBCLST='Y'                                                 CSD007
055410200529     C                   EVAL      BBTYLC='A'                                                 CSD007
055420200529                                                                                              CSD007
055430200529      ** Timestamp                                                                            CSD007
055440200529     C                   CALLB     'ZAGENTMSTM'                                               CSD007
055450200529     C                   PARM                    TimeStamp                                    CSD007
055460200529                                                                                              CSD007
055470200529     C                   EVAL      BBTMST = TimeStamp                                         CSD007
055480200529      ** Logically delete the retail accounts first                                           CSD023
055490200529                                                                                              CSD023
055500200529     C                   if        csd023 = 'Y'                                               CSD023
055510200529                                                                                              CSD023
055520200529     C     w0key1        klist                                                                CSD023
055530200529     C                   kfld                    w0cnum                                       CSD023
055540200529     C                   kfld                    w0ccy                                        CSD023
055550200529     C                   kfld                    w0acod                                       CSD023
055560200529     C                   kfld                    w0acsq                                       CSD023
055570200529     C                   kfld                    w0brca                                       CSD023
055580200529                                                                                              CSD023
055590200529     C                   move      BBCUST        w0cnum                                       CSD023
055600200529     C                   move      *loval        w0ccy                                        CSD023
055610200529     C                   move      *loval        w0acod                                       CSD023
055620200529     C                   move      *loval        w0acsq                                       CSD023
055630200529     C                   move      *loval        w0brca                                       CSD023
055640200529                                                                                              CSD023
055650200529     C                   move      *off          APIRetc                                      CSD023
055660200529                                                                                              CSD023
055670200529     C     w0key1        setll     ACCNTABF                               99                  CSD023
055680200529                                                                                              CSD023
055690200529     C     *in99         ifeq      *off                                                       CSD023
055700200529                                                                                              CSD023
055710200529     C                   read(N)   ACCNTABF                             9898                  CSD023
055720200529                                                                                              CSD023
055730200529     C     *in98         doweq     *off                                                       CSD023
055740200529     C     cnum          andeq     w0cnum                                                     CSD023
055750200529     C     APIRetc       andeq     *off                                                       CSD023
055760200529                                                                                              CSD023
055770200529      ** Only live retail accounts must be considered                                         CSD023
055780200529     C                   if        ATYP='R' and RECI='D' and ACST<>'C'                        CSD023
055790200529                                                                                              CSD023
055800200529     C                   move      CNUM          w1cnum                                       CSD023
055810200529     C                   move      CCY           w1ccy                                        CSD023
055820200529     C                   move      ACOD          w1acod                                       CSD023
055830200529     C                   move      ACSQ          w1acsq                                       CSD023
055840200529     C                   move      BRCA          w1brca                                       CSD023
055850200529                                                                                              CSD023
055860200529     C                   call      'SDC000801'                                                CSD023
055870200529     C                   parm                    w1accn                                       CSD023
055880200529     C                   parm      *off          APIRetc                                      CSD023
055890200529                                                                                              CSD023
055900200529     C                   endif                                                                CSD023
055910200529                                                                                              CSD023
055920200529     C                   read(N)   ACCNTABF                             9898                  CSD023
055930200529     C                   enddo                                                                CSD023
055940200529                                                                                              CSD023
055950200529     C                   endif                                                                CSD023
055960200529                                                                                              CSD023
055970200529      * Error detected?                                                                       CSD023
055980200529     C     APIRetc       ifeq      *on                                                        CSD023
055990200529     C                   movel     *BLANK        dbkey                                        CSD023
056000200529     C                   movel     'w0key1'      dbkey                                        CSD023
056010200529     C                   movel     'ACCNT   '    dbfile                         ************  CSD023
056020200529     C                   movel     '030'         dbase                          * DBERR 030*  CSD023
056030200529     C                   exsr      srerr                                        ************  CSD023
056040200529     C                   endif                                                                CSD023
056050200529                                                                                              CSD023
056060200529     C                   endif                                                                CSD023
056070200529                                                                                              CSD023
056080200529      *                                                                                       CSD007
056090200529      ** UPDATE RECORD                                                                        CSD007
056100200529                                                                                              CSD007
056110200529     C                   UPDATE    @BBREBG                                                    CSD007
056120200529                                                                                              CSD092
056130200529     C                   IF        CSD092 = 'Y'                                               CSD092
056140200529     C                   IF        S01425 = 'Y' AND                                           CSD092
056150200529     C                             CSD079 = 'Y'                                               CSD092
056160200529     C                   ELSE                                                                 CSD092
056170200529                                                                                              CSD092
056180200529     C                   CALL      'SD009696'                                                 CSD092
056190200529     C                   PARM      BBCUST        PCUST                                        CSD092
056200200529     C                   PARM      B_CUSTD       PBefCUST                                     CSD092
056210200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
056220200529     C                   PARM      *BLANKS       PBefACUS                                     CSD092
056230200529     C                   PARM      *BLANKS       PAftACUS                                     CSD092
056240200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
056250200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL132
056260200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
056270200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
056280200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
056290200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
056300200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
056310200529     C                   PARM      *BLANKS       PAftCUXC                                   MD026854
056320200529     C                   PARM      *BLANKS       PACRV                                        CSD092
056330200529     C                   PARM      *BLANKS       PELEC                                        CGL132
056340200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
056350200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
056360200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
056370200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
056380200529     C                   ENDIF                                                                CSD092
056390200529     C                   ENDIF                                                                CSD092
056400200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                               CSW207
056410200529     C     A_CUCUST      CHAIN     SDCSSWL0                                                   CSW207
056420200529     C                   IF        %FOUND(SDCSSWL0)                                           CSW207
056430200529     C                   UPDATE    SDCSSWD0                                                   CSW207
056440200529     C                   ENDIF                                                                CSW207
056450200529     C                   ENDIF                                                                CSW207
056460200529                                                                                              CSD007
056470200529     C                   Z-ADD     *ZERO         WUNORC                         No of records CSD007
056480200529     C                   Z-ADD     1             WUNOAM                         No of Amend   CSD007
056490200529     C                   Z-ADD     *ZERO         WUNOIN                         No of Inserts CSD007
056500200529     C                   Z-ADD     *ZERO         WUNODL                         No of Deletes CSD007
056510200529      * Change Standing Data Cont - Standing Data Controls  *                                 CSD007
056520200529     C                   MOVEL     'SDCUSTPD'    WFLNAME           8            No of delete  CSD007
056530200529     C                   EXSR      SNCHRC                                                     CSD007
056540200529                                                                                              CSD007
056550200529     C                   ENDSR                                                                CSD007
056560200529     C****************************************************************                        CSD007
056570200529      /EJECT                                                                                  CSD007
056580200529     C****************************************************************                        CSD007
056590200529     C*                                                              *                        CSD007
056600200529     C* RELEASE - RELEASE A CUSTOMER                                 *                        CSD007
056610200529     C*                                                              *                        CSD007
056620200529     C****************************************************************                        CSD007
056630200529     C     RELEASE       BEGSR                                                                CSD007
056640200529                                                                                              CSD007
056650200529      ** ACCESS CUSTOMER                                                                      CSD007
056660200529                                                                                              CSD007
056670200529     C*****A_CUCUST      CHAIN     SDCUSTL0                           99               CSD007 252069
056680200529     C     A_CUCUST      CHAIN     SDCUSTL0                           9997                    252069
056690200529     C                   EXSR      ChkChain                                                   252069
056700200529                                                                                              CSD007
056710200529      ** DATABASE ERROR                                                                       CSD007
056720200529                                                                                              CSD007
056730200529     C     *IN99         IFEQ      '1'                                                        CSD007
056740200529     C                   MOVEL     A_CUCUST      DBKEY                                        CSD007
056750200529     C                   MOVEL     'SDCUSTPD'    DBFILE                         ************  CSD007
056760200529     C                   MOVEL     '022'         DBASE                          * DBERR 022*  CSD007
056770200529     C                   EXSR      SRERR                                        ************  CSD007
056780200529     C                   END                                                                  CSD007
056790200529                                                                                              CSD007
056800200529      ** UPDATE 'BEFORE' STATUS                                                               CSD007
056810200529                                                                                              CSD007
056820200529     C                   MOVEL(P)  CUSTDF        B_CUSTD                                      CSD007
056830200529                                                                                              CSD007
056840200529      ** SET CUSTOMER FIELDS ON CLOSURE                                                       CSD007
056850200529                                                                                              CSD007
056860200529     C                   EVAL      BBLCD=BJRDNB                                               CSD007
056870200529     C                   EVAL      BBCLDT=BJRDNB                                              CSD007
056880200529     C                   EVAL      BBCLST=' '                                                 CSD007
056890200529     C                   EVAL      BBTYLC='A'                                                 CSD007
056900200529                                                                                              CSD007
056910200529      ** Timestamp                                                                            CSD007
056920200529     C                   CALLB     'ZAGENTMSTM'                                               CSD007
056930200529     C                   PARM                    TimeStamp                                    CSD007
056940200529                                                                                              CSD007
056950200529     C                   EVAL      BBTMST = TimeStamp                                         CSD007
056960200529      *                                                                                       CSD007
056970200529      ** UPDATE RECORD                                                                        CSD007
056980200529                                                                                              CSD007
056990200529     C                   UPDATE    @BBREBG                                                    CSD007
057000200529                                                                                              CGL132
057010200529     C                   IF        CSD092 = 'Y'                                               CGL132
057020200529                                                                                              CGL132
057030200529     C                   CALL      'SD009696'                                                 CGL132
057040200529     C                   PARM      BBCUST        PCUST                                        CGL132
057050200529     C                   PARM      B_CUSTD       PBefCUST                                     CGL132
057060200529     C                   PARM      CUSTDF        PAftCUST                                     CGL132
057070200529     C                   PARM      *BLANKS       PBefACUS                                     CGL132
057080200529     C                   PARM      *BLANKS       PAftACUS                                     CGL132
057090200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
057100200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL132
057110200529     C                   PARM      *BLANKS       PBefJACC                                     CGL132
057120200529     C                   PARM      *BLANKS       PAftJACC                                     CGL132
057130200529     C                   PARM      *BLANKS       PBefCUAH                                     CGL132
057140200529     C                   PARM      *BLANKS       PAftCUAH                                     CGL132
057150200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
057160200529     C                   PARM      *BLANKS       PAftCUXC                                   MD026854
057170200529     C                   PARM      *BLANKS       PACRV                                        CGL132
057180200529     C                   PARM      *BLANKS       PELEC                                        CGL132
057190200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
057200200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
057210200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
057220200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
057230200529     C                   ENDIF                                                                CGL132
057240200529                                                                                              CGL132
057250200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                               CSW207
057260200529     C     A_CUCUST      CHAIN     SDCSSWL0                                                   CSW207
057270200529     C                   IF        %FOUND(SDCSSWL0)                                           CSW207
057280200529     C                   UPDATE    SDCSSWD0                                                   CSW207
057290200529     C                   ENDIF                                                                CSW207
057300200529     C                   ENDIF                                                                CSW207
057310200529                                                                                              CSD007
057320200529     C                   Z-ADD     *ZERO         WUNORC                         No of records CSD007
057330200529     C                   Z-ADD     1             WUNOAM                         No of Amend   CSD007
057340200529     C                   Z-ADD     *ZERO         WUNOIN                         No of Inserts CSD007
057350200529     C                   Z-ADD     *ZERO         WUNODL                         No of Deletes CSD007
057360200529      * Change Standing Data Cont - Standing Data Controls  *                                 CSD007
057370200529     C                   MOVEL     'SDCUSTPD'    WFLNAME           8            No of delete  CSD007
057380200529     C                   EXSR      SNCHRC                                                     CSD007
057390200529                                                                                              CSD007
057400200529     C                   ENDSR                                                                CSD007
057410200529     C****************************************************************                        CSD007
057420200529      /EJECT
057430200529     C*****************************************************************
057440200529     C*                                                               *
057450200529     C* SNCHRC - Change Standing Data Controls                        *
057460200529     C*                                                               *
057470200529     C*****************************************************************
057480200529     C     SNCHRC        BEGSR
057490200529
057500200529     C                   MOVEL     *BLANK        W0RTN             7
057510200529      *
057520200529      * Move key fields to @AHREAU
057530200529     C                   MOVEL     *BLANK        AHFLNM
057540200529     C                   MOVEL     WFLNAME       AHFLNM
057550200529      *
057560200529     C     KLCHSN        KLIST
057570200529     C                   KFLD                    AHFLNM
057580200529     C     KLCHSN        CHAIN     @AHREAU                            90
057590200529
057600200529      ** DATABASE ERROR
057610200529
057620200529     C     *IN90         IFEQ      '1'
057630200529     C                   MOVEL     AHFLNM        DBKEY
057640200529     C                   MOVEL     'SDFCTLL0'    DBFILE                         ************
057650200529     C                   MOVEL     '017'         DBASE                          * DBERR 017*
057660200529     C                   EXSR      SRERR                                        ************
057670200529     C                   END
057680200529
057690200529      * USER: Processing after Data read
057700200529     C                   ADD       AHNORC        WUNORC
057710200529     C                   ADD       AHNOIN        WUNOIN
057720200529     C                   ADD       AHNOAM        WUNOAM
057730200529     C                   ADD       AHNODL        WUNODL
057740200529      * Move non-key fields to @AHREAU
057750200529     C                   Z-ADD     WUNORC        AHNORC
057760200529     C                   Z-ADD     WUNOIN        AHNOIN
057770200529     C                   Z-ADD     WUNOAM        AHNOAM
057780200529     C                   Z-ADD     WUNODL        AHNODL
057790200529      *
057800200529      * Update record
057810200529     C                   UPDATE    @AHREAU
057820200529      *
057830200529     C                   ENDSR
057840200529     C*****************************************************************
057850200529      /EJECT
057860200529     C*****************************************************************
057870200529     C*                                                               *
057880200529     C* SORVGN - Customer Marketing Groups                            *
057890200529     C*                                                               *
057900200529     C*****************************************************************
057910200529     C     SORVGN        BEGSR
057920200529
057930200529      * Define keylist
057940200529     C     KRSSO         KLIST
057950200529     C                   KFLD                    D7CUST
057960200529      *
057970200529      * Move fields to key list
057980200529     C                   MOVEL     BBCUST        D7CUST
057990200529     C     KRSSO         CHAIN     @D7REJB                            90
058000200529
058010200529      ** DATABASE ERROR
058020200529
058030200529     C     *IN90         IFEQ      '1'
058040200529      * USER: Processing if Data record not found
058050200529     C**********         MOVEL     *BLANK        WUGPC1            4                        MD031234
058060200529     C**********         MOVEL     *BLANK        WUGPC2            4                        MD031234
058070200529     C**********         MOVEL     *BLANK        WUGPC3            4                        MD031234
058080200529     C**********         MOVEL     *BLANK        WUGPC4            4                        MD031234
058090200529     C**********         MOVEL     *BLANK        WUGPC5            4                        MD031234
058100200529     C                   MOVEL     A_MIGPC1      WUGPC1            4                        MD031234
058110200529     C                   MOVEL     A_MIGPC2      WUGPC2            4                        MD031234
058120200529     C                   MOVEL     A_MIGPC3      WUGPC3            4                        MD031234
058130200529     C                   MOVEL     A_MIGPC4      WUGPC4            4                        MD031234
058140200529     C                   MOVEL     A_MIGPC5      WUGPC5            4                        MD031234
058150200529     C                   GOTO      SOEXIT
058160200529     C                   END
058170200529
058180200529      * USER: Process Data record
058190200529      * PAR = DB1 By name
058200200529     C     *IN90         IFEQ      '0'
058210200529     C**********         MOVEL     D7GPC1        WUGPC1                                     MD020755
058220200529     C**********         MOVEL     D7GPC2        WUGPC2                                     MD020755
058230200529     C**********         MOVEL     D7GPC3        WUGPC3                                     MD020755
058240200529     C**********         MOVEL     D7GPC4        WUGPC4                                     MD020755
058250200529     C**********         MOVEL     D7GPC5        WUGPC5                                     MD020755
058260200529     C                   MOVEL     A_MIGPC1      WUGPC1                                     MD020755
058270200529     C                   MOVEL     A_MIGPC2      WUGPC2                                     MD020755
058280200529     C                   MOVEL     A_MIGPC3      WUGPC3                                     MD020755
058290200529     C                   MOVEL     A_MIGPC4      WUGPC4                                     MD020755
058300200529     C                   MOVEL     A_MIGPC5      WUGPC5                                     MD020755
058310200529     C                   END
058320200529
058330200529      *
058340200529     C     SOEXIT        ENDSR
058350200529     C*****************************************************************
058360200529      /EJECT
058370200529     C*****************************************************************
058380200529     C*                                                               *
058390200529     C* SRRVGN - Check/Tag records - Alternate Names & Address        *
058400200529     C*                                                               *
058410200529     C*****************************************************************
058420200529     C     SRRVGN        BEGSR
058430200529
058440200529     C                   MOVEL     *BLANK        W0RTN             7
058450200529      * Define keylist
058460200529     C     KPSSR         KLIST
058470200529     C                   KFLD                    BCCUST
058480200529     C                   KFLD                    BCADCD
058490200529     C     KRSSR         KLIST
058500200529     C                   KFLD                    BCCUST
058510200529      * Move key fields to key list
058520200529     C                   MOVEL     BBCUST        BCCUST
058530200529     C                   MOVEL     *BLANK        BCADCD
058540200529     C     KPSSR         SETLL     SDALTNL1
058550200529     C     KRSSR         READE     SDALTNL1                               90
058560200529
058570200529     C     *IN90         IFEQ      '1'
058580200529     C                   MOVEL     'USR0083'     W0RTN
058590200529     C                   END
058600200529     C     *IN90         DOWEQ     '0'
058610200529      * Delete Names & Addresses - Alternate Names & Address  *
058620200529     C                   EXSR      SSCHRC
058630200529     C     KRSSR         READE     SDALTNL1                               90
058640200529     C                   END
058650200529      *
058660200529     C     SREXIT        ENDSR
058670200529     C*****************************************************************
058680200529      /EJECT
058690200529     C*****************************************************************
058700200529     C*                                                               *
058710200529     C* SSCHRC - Delete Names & Addresses - Alternate Names & Address *
058720200529     C*                                                               *
058730200529     C*****************************************************************
058740200529     C     SSCHRC        BEGSR
058750200529      *
058760200529     C                   MOVEL     *BLANK        W0RTN             7
058770200529      *
058780200529      * Move key fields to @BCREDD (SDALTNL0)
058790200529      *
058800200529     C     KLCHSS        KLIST
058810200529     C                   KFLD                    BCCUST
058820200529     C                   KFLD                    BCADCD
058830200529     C                   MOVEL     BBCUST        BCCUST
058840200529     C                   MOVEL     *BLANK        BCADCD
058850200529     C     KLCHSS        CHAIN     SDALTNL0                           90
058860200529
058870200529      ** DATABASE ERROR
058880200529     C     *IN90         IFEQ      '1'
058890200529     C                   MOVEL     'Y2U0009'     W0RTN
058900200529     C                   GOTO      SSEXIT
058910200529     C                   END
058920200529
058930200529      * Move non-key fields to @BCREDD
058940200529     C                   Z-ADD     BJRDNB        BCLCD
058950200529     C                   MOVEL     'D'           BCTYLC
058960200529      * Update record
058970200529     C                   UPDATE    @BCREDD
058980200529      * USER: Processing after Data read
058990200529     C                   Z-ADD     -1            WUNORC
059000200529     C                   Z-ADD     *ZERO         WUNOIN
059010200529     C                   Z-ADD     *ZERO         WUNOAM
059020200529     C                   Z-ADD     1             WUNODL
059030200529      * Change Standing Data Cont - Standing Data Controls  *
059040200529     C                   MOVEL     'SDALTNPD'    WFLNAME           8            No of delete
059050200529     C                   EXSR      SNCHRC
059060200529      * Update CLINTCC - Alternate Names & Address  *
059070200529     C                   CALL      'CLINTCC'
059080200529     C                   PARM      *BLANK        @RTCD             7
059090200529     C                   PARM      BCCUST        @CUST             6
059100200529     C                   PARM      BCADCD        @ADCD             1
059110200529     C                   PARM      BCCNA1        @CNA1            35
059120200529     C                   PARM      BCCNA2        @CNA2            35
059130200529     C                   PARM      BCCNA3        @CNA3            35
059140200529     C                   PARM      BCCNA4        @CNA4            35
059150200529     C                   PARM      BCCRTN        @CRTN            10
059160200529     C                   PARM      BCCTNB        @CTNB            12
059170200529     C                   PARM      BCTXNB        @TXNB            12
059180200529     C                   PARM      BCCNCD        @CNCD             2
059190200529     C                   PARM      BJRDNB        @RDNB             5 0
059200200529     C                   PARM      'D'           @TYLC             1
059210200529      * Send message 'Unable to update'
059220200529     C     @RTCD         IFEQ      '*ERROR*'
059230200529     C                   MOVEL     *BLANK        DBKEY
059240200529     C                   MOVEL     BCCUST        DBKEY
059250200529     C                   MOVEL     'CLINTCC'     DBFILE                         ************
059260200529     C                   MOVEL     '018'         DBASE                          * DBERR 018*
059270200529     C                   EXSR      SRERR                                        ************
059280200529     C                   END
059290200529      *
059300200529      *
059310200529     C     SSEXIT        ENDSR
059320200529     C*****************************************************************
059330200529      /EJECT
059340200529     C********************************************************************
059350200529     C*                                                                  *
059360200529      * UPDBRT - UPDATE CUSTOMER BASE RATE TAX DETAILS IF S01383 = 'Y'   *
059370200529     C*                                                                  *
059380200529     C********************************************************************
059390200529     C     UPDBRT        BEGSR
059400200529
059410200529     C     PTYKEY        KLIST
059420200529     C                   KFLD                    XCNUM
059430200529     C                   KFLD                    PTYSQN
059440200529
059450200529      ** ACCESS CUSTOMER BASE RATE TAX DETAILS
059460200529
059470200529     C     BRCNUM        CHAIN     SDCBRTL1                           98
059480200529
059490200529      * Note file values for participant BRT
059500200529     C                   MOVE      H1BRTL        OLDBR1            1
059510200529     C                   MOVE      H2BRTL        OLDBR2            1
059520200529     C                   MOVE      H3BRTL        OLDBR3            1
059530200529     C                   MOVE      H4BRTL        OLDBR4            1
059540200529     C                   MOVE      H5BRTL        OLDBR5            1
059550200529     C                   MOVE      *BLANK        OLDBRT            1
059560200529     C                   MOVE      *BLANK        NEWBRT            1
059570200529
059580200529      ** DATABASE ERROR
059590200529      ** IF INSERT, BUT RECORD PRESENT ALREADY
059600200529      ** OR IF NOT INSERT, BUT NO RECORD FOUND
059610200529
059620200529      ** Skip validation if the customer came from the acceptance file.                       CSD031
059630200529                                                                                              CSD031
059640200529     C**********         IF        PAccMde <> 'A'                                    CSD031 BUG13525
059650200529     C     BRCHTP        IFEQ      'I'
059660200529     C     A_CUTYLC      ANDEQ     'I'                                                        201011
059670200529     C     *IN98         ANDEQ     '0'
059680200529     C     BRCHTP        ORNE      'I'
059690200529     C     *IN98         ANDEQ     '1'
059700200529     C                   MOVEL     BRCNUM        DBKEY
059710200529     C                   MOVEL     'SDCBRTL1'    DBFILE                         ************
059720200529     C                   MOVEL     '019'         DBASE                          * DBERR 019*
059730200529     C                   EXSR      SRERR                                        ************
059740200529     C                   END
059750200529     C**********         ENDIF                                                       CSD031 BUG13525
059760200529
059770200529      ** Update with details from valid BRT DETAILS record
059780200529
059790200529      ** SET SDCBRTPD FIELDS
059800200529     C                   EVAL      XRECI=BRRECI
059810200529     C                   EVAL      XCNUM=BRCNUM
059820200529     C                   EVAL      ACHLRT=BRAHLT
059830200529     C                   EVAL      H1TITL=BR1TIT
059840200529     C                   EVAL      H1NAME=BR1NAM
059850200529     C                   EVAL      H1INIT=BR1INI
059860200529     C                   EVAL      H1ADR1=BR1AD1
059870200529     C                   EVAL      H1ADR2=BR1AD2
059880200529     C                   EVAL      H1ADR3=BR1AD3
059890200529     C                   EVAL      H1PCD1=BR1PC1
059900200529     C                   EVAL      H1PCD2=BR1PC2
059910200529     C                   EVAL      H1BRTL=BR1BRL
059920200529     C                   EVAL      H1NINO=BR1NIN
059930200529     C                   EVAL      H1DOB= BR1DOB
059940200529     C                   EVAL      H1SEQN=BR1SQN
059950200529
059960200529     C                   EVAL      H2TITL=BR2TIT
059970200529     C                   EVAL      H2NAME=BR2NAM
059980200529     C                   EVAL      H2INIT=BR2INI
059990200529     C                   EVAL      H2ADR1=BR2AD1
060000200529     C                   EVAL      H2ADR2=BR2AD2
060010200529     C                   EVAL      H2ADR3=BR2AD3
060020200529     C                   EVAL      H2PCD1=BR2PC1
060030200529     C                   EVAL      H2PCD2=BR2PC2
060040200529     C                   EVAL      H2BRTL=BR2BRL
060050200529     C                   EVAL      H2NINO=BR2NIN
060060200529     C                   EVAL      H2DOB=BR2DOB
060070200529     C                   EVAL      H2SEQN=BR2SQN
060080200529
060090200529     C                   EVAL      H3TITL=BR3TIT
060100200529     C                   EVAL      H3NAME=BR3NAM
060110200529     C                   EVAL      H3INIT=BR3INI
060120200529     C                   EVAL      H3ADR1=BR3AD1
060130200529     C                   EVAL      H3ADR2=BR3AD2
060140200529     C                   EVAL      H3ADR3=BR3AD3
060150200529     C                   EVAL      H3PCD1=BR3PC1
060160200529     C                   EVAL      H3PCD2=BR3PC2
060170200529     C                   EVAL      H3BRTL=BR3BRL
060180200529     C                   EVAL      H3NINO=BR3NIN
060190200529     C                   EVAL      H3DOB=BR3DOB
060200200529     C                   EVAL      H3SEQN=BR3SQN
060210200529
060220200529     C                   EVAL      H4TITL=BR4TIT
060230200529     C                   EVAL      H4NAME=BR4NAM
060240200529     C                   EVAL      H4INIT=BR4INI
060250200529     C                   EVAL      H4ADR1=BR4AD1
060260200529     C                   EVAL      H4ADR2=BR4AD2
060270200529     C                   EVAL      H4ADR3=BR4AD3
060280200529     C                   EVAL      H4PCD1=BR4PC1
060290200529     C                   EVAL      H4PCD2=BR4PC2
060300200529     C                   EVAL      H4BRTL=BR4BRL
060310200529     C                   EVAL      H4NINO=BR4NIN
060320200529     C                   EVAL      H4DOB=BR4DOB
060330200529     C                   EVAL      H4SEQN=BR4SQN
060340200529
060350200529     C                   EVAL      H5TITL=BR5TIT
060360200529     C                   EVAL      H5NAME=BR5NAM
060370200529     C                   EVAL      H5INIT=BR5INI
060380200529     C                   EVAL      H5ADR1=BR5AD1
060390200529     C                   EVAL      H5ADR2=BR5AD2
060400200529     C                   EVAL      H5ADR3=BR5AD3
060410200529     C                   EVAL      H5PCD1=BR5PC1
060420200529     C                   EVAL      H5PCD2=BR5PC2
060430200529     C                   EVAL      H5BRTL=BR5BRL
060440200529     C                   EVAL      H5NINO=BR5NIN
060450200529     C                   EVAL      H5DOB=BR5DOB
060460200529     C                   EVAL      H5SEQN=BR5SQN
060470200529
060480200529     C                   EVAL      TAXIND=BRTXIN
060490200529     C                   EVAL      PSTR=BRPSTR                                                CRE007
060500200529     C                   EVAL      NXASQN=BRNASQ
060510200529     C                   EVAL      ACHCGD=BRAHCD
060520200529     C                   EVAL      XLCD=BRXLCD
060530200529     C                   EVAL      XCHTP=BRCHTP
060540200529     C                   EVAL      XTNLU=0
060550200529
060560200529      *
060570200529      * Update or write record in SDCBRTPD
060580200529      *
060590200529     C     *IN98         IFEQ      '1'
060600200529     C                   WRITE     SDCBRTD0
060610200529     C                   ELSE
060620200529     C                   UPDATE    SDCBRTD0
060630200529     C                   ENDIF
060640200529
060650200529
060660200529      ** Update BRT Particpator History file
060670200529      ** With details from valid BRT Participator History file
060680200529
060690200529     C     ACTN          IFNE      'I'
060700200529     C     ACTN          ANDNE     'A'
060710200529     C                   GOTO      EndUPDBRT
060720200529     C                   ENDIF
060730200529
060740200529     C     BRAHLT        IFNE      'I'
060750200529     C     BRAHLT        ANDNE     'J'
060760200529     C     BRAHLT        ANDNE     'R'                                                        201011
060770200529     C                   GOTO      EndUPDBRT
060780200529     C                   ENDIF
060790200529
060800200529     C                   EVAL      XCNUM=BRCNUM
060810200529
060820200529     C     BR1NAM        IFNE      *BLANK
060830200529
060840200529     C                   EVAL      PTYSQN=BR1SQN
060850200529
060860200529      ** Access BRT participator history details
060870200529     C     PTYKEY        CHAIN     PTYHSTPD                           94
060880200529
060890200529      ** Set PTYHSTPD fields
060900200529     C                   EVAL      XRECI=BRRECI
060910200529     C                   EVAL      XCNUM=BRCNUM
060920200529     C                   EVAL      PTTITL=BR1TIT
060930200529     C                   EVAL      PTNAME=BR1NAM
060940200529     C                   EVAL      PTINIT=BR1INI
060950200529     C                   EVAL      PTADR1=BR1AD1
060960200529     C                   EVAL      PTADR2=BR1AD2
060970200529     C                   EVAL      PTADR3=BR1AD3
060980200529     C                   EVAL      PTPCD1=BR1PC1
060990200529     C                   EVAL      PTPCD2=BR1PC2
061000200529     C                   EVAL      PTNINO=BR1NIN
061010200529     C                   EVAL      PTDOB=BR1DOB
061020200529     C                   EVAL      PTYSQN=BR1SQN
061030200529     C                   EVAL      LFLAGS=*BLANKS
061040200529     C                   EVAL      EFFLDS=*ZEROS
061050200529     C                   EVAL      LCHGDS=*ZEROS
061060200529     C                   EVAL      XLCD=BRXLCD
061070200529     C                   EVAL      XCHTP=BRCHTP
061080200529     C                   EVAL      XTNLU=*ZERO
061090200529
061100200529      *
061110200529      * Update or write record in PTYHSTPD
061120200529     C     *IN94         IFEQ      '0'
061130200529      *
061140200529     C                   EVAL      PTYSQN=BR1SQN
061150200529     C                   EVAL      OLDBRT=OLDBR1
061160200529     C                   EVAL      NEWBRT=BR1BRL
061170200529     C                   EXSR      CHKPRT
061180200529     C                   MOVEA     LFLG          LFLAGS
061190200529     C                   MOVE      EFFLDA        EFFLDS
061200200529     C                   MOVE      LCHGDA        LCHGDS
061210200529      *
061220200529     C                   UPDATE    PTYHSTF
061230200529      *
061240200529     C                   ELSE
061250200529      *
061260200529     C     ACTN          IFEQ      'I'
061270200529     C                   Z-ADD     BJRDNB        LCHD(1)
061280200529     C                   Z-ADD     APR6CY        EFLD(1)
061290200529     C                   MOVE      BR1BRL        LFLG(1)
061300200529     C                   ELSE
061310200529     C                   EVAL      PTYSQN=BR1SQN
061320200529     C                   EVAL      OLDBRT=OLDBR1
061330200529     C                   EVAL      NEWBRT=BR1BRL
061340200529     C                   EXSR      CHKPRT
061350200529     C                   ENDIF
061360200529      *
061370200529     C                   MOVEA     LFLG          LFLAGS
061380200529     C                   MOVE      EFFLDA        EFFLDS
061390200529     C                   MOVE      LCHGDA        LCHGDS
061400200529      *
061410200529     C                   WRITE     PTYHSTF
061420200529      *
061430200529     C                   ENDIF
061440200529      *
061450200529     C                   ENDIF
061460200529
061470200529     C     BR2NAM        IFNE      *BLANK
061480200529
061490200529     C                   EVAL      PTYSQN=BR2SQN
061500200529
061510200529      ** Access BRT participator history details
061520200529     C     PTYKEY        CHAIN     PTYHSTPD                           94
061530200529
061540200529      ** Set PTYHSTPD fields
061550200529     C                   EVAL      XRECI=BRRECI
061560200529     C                   EVAL      XCNUM=BRCNUM
061570200529     C                   EVAL      PTTITL=BR2TIT
061580200529     C                   EVAL      PTNAME=BR2NAM
061590200529     C                   EVAL      PTINIT=BR2INI
061600200529     C                   EVAL      PTADR1=BR2AD1
061610200529     C                   EVAL      PTADR2=BR2AD2
061620200529     C                   EVAL      PTADR3=BR2AD3
061630200529     C                   EVAL      PTPCD1=BR2PC1
061640200529     C                   EVAL      PTPCD2=BR2PC2
061650200529     C                   EVAL      PTNINO=BR2NIN
061660200529     C                   EVAL      PTDOB=BR2DOB
061670200529     C                   EVAL      PTYSQN=BR2SQN
061680200529     C                   EVAL      LFLAGS=*ZEROS
061690200529     C                   EVAL      EFFLDS=*ZEROS
061700200529     C                   EVAL      LCHGDS=*BLANKS
061710200529     C                   EVAL      XLCD=BRXLCD
061720200529     C                   EVAL      XCHTP=BRCHTP
061730200529     C                   EVAL      XTNLU=BRTNLU
061740200529
061750200529      *
061760200529      * Update or write record in PTYHSTPD
061770200529     C     *IN94         IFEQ      '0'
061780200529      *
061790200529     C                   EVAL      PTYSQN=BR2SQN
061800200529     C                   EVAL      OLDBRT=OLDBR2
061810200529     C                   EVAL      NEWBRT=BR2BRL
061820200529     C                   EXSR      CHKPRT
061830200529     C                   MOVEA     LFLG          LFLAGS
061840200529     C                   MOVE      EFFLDA        EFFLDS
061850200529     C                   MOVE      LCHGDA        LCHGDS
061860200529      *
061870200529     C                   UPDATE    PTYHSTF
061880200529      *
061890200529     C                   ELSE
061900200529      *
061910200529     C     ACTN          IFEQ      'I'
061920200529     C                   Z-ADD     BJRDNB        LCHD(1)
061930200529     C                   Z-ADD     APR6CY        EFLD(1)
061940200529     C                   MOVE      BR2BRL        LFLG(1)
061950200529     C                   ELSE
061960200529     C                   EVAL      PTYSQN=BR2SQN
061970200529     C                   EVAL      OLDBRT=OLDBR2
061980200529     C                   EVAL      NEWBRT=BR2BRL
061990200529     C                   EXSR      CHKPRT
062000200529     C                   ENDIF
062010200529      *
062020200529     C                   MOVEA     LFLG          LFLAGS
062030200529     C                   MOVE      EFFLDA        EFFLDS
062040200529     C                   MOVE      LCHGDA        LCHGDS
062050200529      *
062060200529     C                   WRITE     PTYHSTF
062070200529      *
062080200529     C                   ENDIF
062090200529      *
062100200529     C                   ENDIF
062110200529
062120200529     C     BR3NAM        IFNE      *BLANK
062130200529
062140200529     C                   EVAL      PTYSQN=BR3SQN
062150200529
062160200529      ** Access BRT participator history details
062170200529     C     PTYKEY        CHAIN     PTYHSTPD                           94
062180200529
062190200529      ** Set PTYHSTPD fields
062200200529     C                   EVAL      XRECI=BRRECI
062210200529     C                   EVAL      XCNUM=BRCNUM
062220200529     C                   EVAL      PTTITL=BR3TIT
062230200529     C                   EVAL      PTNAME=BR3NAM
062240200529     C                   EVAL      PTINIT=BR3INI
062250200529     C                   EVAL      PTADR1=BR3AD1
062260200529     C                   EVAL      PTADR2=BR3AD2
062270200529     C                   EVAL      PTADR3=BR3AD3
062280200529     C                   EVAL      PTPCD1=BR3PC1
062290200529     C                   EVAL      PTPCD2=BR3PC2
062300200529     C                   EVAL      PTNINO=BR3NIN
062310200529     C                   EVAL      PTDOB=BR3DOB
062320200529     C                   EVAL      PTYSQN=BR3SQN
062330200529     C                   EVAL      LFLAGS=*ZEROS
062340200529     C                   EVAL      EFFLDS=*ZEROS
062350200529     C                   EVAL      LCHGDS=*BLANKS
062360200529     C                   EVAL      XLCD=BRXLCD
062370200529     C                   EVAL      XCHTP=BRCHTP
062380200529     C                   EVAL      XTNLU=BRTNLU
062390200529
062400200529      *
062410200529      * Update or write record in PTYHSTPD
062420200529     C     *IN94         IFEQ      '0'
062430200529      *
062440200529     C                   EVAL      PTYSQN=BR3SQN
062450200529     C                   EVAL      OLDBRT=OLDBR3
062460200529     C                   EVAL      NEWBRT=BR3BRL
062470200529     C                   EXSR      CHKPRT
062480200529     C                   MOVEA     LFLG          LFLAGS
062490200529     C                   MOVE      EFFLDA        EFFLDS
062500200529     C                   MOVE      LCHGDA        LCHGDS
062510200529      *
062520200529     C                   UPDATE    PTYHSTF
062530200529      *
062540200529     C                   ELSE
062550200529      *
062560200529     C     ACTN          IFEQ      'I'
062570200529     C                   Z-ADD     BJRDNB        LCHD(1)
062580200529     C                   Z-ADD     APR6CY        EFLD(1)
062590200529     C                   MOVE      BR3BRL        LFLG(1)
062600200529     C                   ELSE
062610200529     C                   EVAL      PTYSQN=BR3SQN
062620200529     C                   EVAL      OLDBRT=OLDBR3
062630200529     C                   EVAL      NEWBRT=BR3BRL
062640200529     C                   EXSR      CHKPRT
062650200529     C                   ENDIF
062660200529      *
062670200529     C                   MOVEA     LFLG          LFLAGS
062680200529     C                   MOVE      EFFLDA        EFFLDS
062690200529     C                   MOVE      LCHGDA        LCHGDS
062700200529      *
062710200529     C                   WRITE     PTYHSTF
062720200529      *
062730200529     C                   ENDIF
062740200529      *
062750200529     C                   ENDIF
062760200529
062770200529     C     BR4NAM        IFNE      *BLANK
062780200529
062790200529     C                   EVAL      PTYSQN=BR4SQN
062800200529
062810200529      ** Access BRT participator history details
062820200529     C     PTYKEY        CHAIN     PTYHSTPD                           94
062830200529
062840200529      ** Set PTYHSTPD fields
062850200529     C                   EVAL      XRECI=BRRECI
062860200529     C                   EVAL      XCNUM=BRCNUM
062870200529     C                   EVAL      PTTITL=BR4TIT
062880200529     C                   EVAL      PTNAME=BR4NAM
062890200529     C                   EVAL      PTINIT=BR4INI
062900200529     C                   EVAL      PTADR1=BR4AD1
062910200529     C                   EVAL      PTADR2=BR4AD2
062920200529     C                   EVAL      PTADR3=BR4AD3
062930200529     C                   EVAL      PTPCD1=BR4PC1
062940200529     C                   EVAL      PTPCD2=BR4PC2
062950200529     C                   EVAL      PTNINO=BR4NIN
062960200529     C                   EVAL      PTDOB=BR4DOB
062970200529     C                   EVAL      PTYSQN=BR4SQN
062980200529     C                   EVAL      LFLAGS=*ZEROS
062990200529     C                   EVAL      EFFLDS=*ZEROS
063000200529     C                   EVAL      LCHGDS=*BLANKS
063010200529     C                   EVAL      XLCD=BRXLCD
063020200529     C                   EVAL      XCHTP=BRCHTP
063030200529     C                   EVAL      XTNLU=BRTNLU
063040200529
063050200529      *
063060200529      * Update or write record in PTYHSTPD
063070200529     C     *IN94         IFEQ      '0'
063080200529      *
063090200529     C                   EVAL      PTYSQN=BR4SQN
063100200529     C                   EVAL      OLDBRT=OLDBR4
063110200529     C                   EVAL      NEWBRT=BR4BRL
063120200529     C                   EXSR      CHKPRT
063130200529     C                   MOVEA     LFLG          LFLAGS
063140200529     C                   MOVE      EFFLDA        EFFLDS
063150200529     C                   MOVE      LCHGDA        LCHGDS
063160200529      *
063170200529     C                   UPDATE    PTYHSTF
063180200529      *
063190200529     C                   ELSE
063200200529      *
063210200529     C     ACTN          IFEQ      'I'
063220200529     C                   Z-ADD     BJRDNB        LCHD(1)
063230200529     C                   Z-ADD     APR6CY        EFLD(1)
063240200529     C                   MOVE      BR4BRL        LFLG(1)
063250200529     C                   ELSE
063260200529     C                   EVAL      PTYSQN=BR4SQN
063270200529     C                   EVAL      OLDBRT=OLDBR4
063280200529     C                   EVAL      NEWBRT=BR4BRL
063290200529     C                   EXSR      CHKPRT
063300200529     C                   ENDIF
063310200529      *
063320200529     C                   MOVEA     LFLG          LFLAGS
063330200529     C                   MOVE      EFFLDA        EFFLDS
063340200529     C                   MOVE      LCHGDA        LCHGDS
063350200529      *
063360200529     C                   WRITE     PTYHSTF
063370200529      *
063380200529     C                   ENDIF
063390200529      *
063400200529     C                   ENDIF
063410200529
063420200529     C     BR5NAM        IFNE      *BLANK
063430200529
063440200529     C                   EVAL      PTYSQN=BR5SQN
063450200529
063460200529      ** Access BRT participator history details
063470200529     C     PTYKEY        CHAIN     PTYHSTPD                           94
063480200529
063490200529      ** Set PTYHSTPD fields
063500200529     C                   EVAL      XRECI=BRRECI
063510200529     C                   EVAL      XCNUM=BRCNUM
063520200529     C                   EVAL      PTTITL=BR5TIT
063530200529     C                   EVAL      PTNAME=BR5NAM
063540200529     C                   EVAL      PTINIT=BR5INI
063550200529     C                   EVAL      PTADR1=BR5AD1
063560200529     C                   EVAL      PTADR2=BR5AD2
063570200529     C                   EVAL      PTADR3=BR5AD3
063580200529     C                   EVAL      PTPCD1=BR5PC1
063590200529     C                   EVAL      PTPCD2=BR5PC2
063600200529     C                   EVAL      PTNINO=BR5NIN
063610200529     C                   EVAL      PTDOB=BR5DOB
063620200529     C                   EVAL      PTYSQN=BR5SQN
063630200529     C                   EVAL      LFLAGS=*ZEROS
063640200529     C                   EVAL      EFFLDS=*ZEROS
063650200529     C                   EVAL      LCHGDS=*BLANKS
063660200529     C                   EVAL      XLCD=BRXLCD
063670200529     C                   EVAL      XCHTP=BRCHTP
063680200529     C                   EVAL      XTNLU=BRTNLU
063690200529
063700200529      *
063710200529      * Update or write record in PTYHSTPD
063720200529     C     *IN94         IFEQ      '0'
063730200529      *
063740200529     C                   EVAL      PTYSQN=BR5SQN
063750200529     C                   EVAL      OLDBRT=OLDBR5
063760200529     C                   EVAL      NEWBRT=BR5BRL
063770200529     C                   EXSR      CHKPRT
063780200529     C                   MOVEA     LFLG          LFLAGS
063790200529     C                   MOVE      EFFLDA        EFFLDS
063800200529     C                   MOVE      LCHGDA        LCHGDS
063810200529      *
063820200529     C                   UPDATE    PTYHSTF
063830200529      *
063840200529     C                   ELSE
063850200529      *
063860200529     C     ACTN          IFEQ      'I'
063870200529     C                   Z-ADD     BJRDNB        LCHD(1)
063880200529     C                   Z-ADD     APR6CY        EFLD(1)
063890200529     C                   MOVE      BR5BRL        LFLG(1)
063900200529     C                   ELSE
063910200529     C                   EVAL      PTYSQN=BR5SQN
063920200529     C                   EVAL      OLDBRT=OLDBR5
063930200529     C                   EVAL      NEWBRT=BR5BRL
063940200529     C                   EXSR      CHKPRT
063950200529     C                   ENDIF
063960200529      *
063970200529     C                   MOVEA     LFLG          LFLAGS
063980200529     C                   MOVE      EFFLDA        EFFLDS
063990200529     C                   MOVE      LCHGDA        LCHGDS
064000200529      *
064010200529     C                   WRITE     PTYHSTF
064020200529      *
064030200529     C                   ENDIF
064040200529      *
064050200529     C                   ENDIF
064060200529
064070200529      *
064080200529     C     EndUPDBRT     ENDSR
064090200529     C****************************************************************
064100200529      /EJECT
064110200529      ********************************************************************                   BUG3362
064120200529      *                                                                  *                   BUG3362
064130200529      * UPDTID - Update TI Customer Details if CSD012 is 'Y'             *                   BUG3362
064140200529      *                                                                  *                   BUG3362
064150200529      ********************************************************************                   BUG3362
064160200529     C     UPDTID        BEGSR                                                               BUG3362
064170200529      *                                                                                      BUG3362
064180200529      ** Access TI Customer Details File                                                     BUG3362
064190200529      *                                                                                      BUG3362
064200200529     C     BGN3ST        IFEQ      'Y'                                                       BUG3362
064210200529     C     BBTICS        ANDEQ     'Y'                                                       BUG3362
064220200529     C     BGN3ST        OREQ      'Y'                                                       BUG3362
064230200529     C     WBBTICS       ANDEQ     'D'                                                       BUG3362
064240200529     C     CTI006        OREQ      'Y'                                                      MD030956
064250200529     C     BBTICS        ANDEQ     'Y'                                                      MD030956
064260200529     C     CTI006        OREQ      'Y'                                                      MD030956
064270200529     C     WBBTICS       ANDEQ     'D'                                                      MD030956
064280200529     C     A_TCCFXC      IFNE      *BLANKS                                                   BG12238
064290200529     C     A_TCETIT      ORNE      *BLANKS                                                   BG12238
064300200529     C     A_TCPFXC      ORNE      *BLANKS                                                   BG12238
064310200529     C     A_TCSALU      ORNE      *BLANKS                                                   BG12238
064320200529     C     A_TCTELX      ORNE      *BLANKS                                                   BG12238
064330200529     C     A_TCTXAB      ORNE      *BLANKS                                                   BG12238
064340200529     C     A_TCFXNO      ORNE      *BLANKS                                                   BG12238
064350200529     C     A_TCZPCD      ORNE      *BLANKS                                                   BG12238
064360200529     C     A_TCTRFM      ORNE      *BLANKS                                                   BG12238
064370200529     C     A_TCDLNG      ORNE      *BLANKS                                                   BG12238
064380200529     C     A_TCANAL      ORNE      *BLANKS                                                   BG12238
064390200529     C     A_TCMLBR      ORNE      *BLANKS                                                   BG12238
064400200529     C                   IF        CSD028 = 'Y' AND PTransType = 'AUTH'                       CSD028
064410200529     C     BBCUST        CHAIN     SDTDSHL0                           95                      CSD028
064420200529     C                   ELSE                                                                 CSD028
064430200529     C     BBCUST        CHAIN     SDTICSL0                           95                     BUG3362
064440200529     C                   ENDIF                                                                CSD028
064450200529      *                                                                                      BUG3362
064460200529      * Check if INSERT or AMEND                                                             BG12238
064470200529      *                                                                                      BG12238
064480200529     C     A_TCTYLC      IFNE      'D'                                                       BG12238
064490200529     C     *IN95         IFEQ      '1'                                                       BG12238
064500200529     C                   MOVEL     'I'           A_TCTYLC                                    BG12238
064510200529     C                   ELSE                                                                BG12238
064520200529      *                                                                                      BG12238
064530200529     C                   MOVEL     'A'           A_TCTYLC                                    BG12238
064540200529     C                   ENDIF                                                               BG12238
064550200529     C                   ENDIF                                                               BG12238
064560200529      ***Database Error If INSERT, but record present already                        BUG3362 BG12238
064570200529      **********                                                                     BUG3362 BG12238
064580200529     C*****A_CUTYLC      IFEQ      'I'                                               BUG3362 BG12238
064590200529     C******IN95         ANDEQ     '0'                                               BUG3362 BG12238
064600200529     C**********         MOVEL     BBCUST        DBKEY                               BUG3362 BG12238
064610200529     C**********         MOVEL     'SDTICSPD'    DBFILE                 ************ BUG3362 BG12238
064620200529     C**********         MOVEL     '023'         DBASE                  * DBERR 023* BUG3362 BG12238
064630200529     C**********         EXSR      SRERR                                ************ BUG3362 BG12238
064640200529     C**********         ELSE                                                        BUG3362 BG12238
064650200529      *                                                                                      BUG3362
064660200529      ** if valid                                                                            BUG3362
064670200529      *                                                                                      BUG3362
064680200529     C     TCFLAG        IFEQ      'Y'                                                       BUG3362
064690200529     C                   MOVEL     'N'           TCFLAG                                      BUG3362
064700200529     C                   ELSE                                                                BUG3362
064710200529     C                   MOVEL     'Y'           TCFLAG                                      BUG3362
064720200529     C                   ENDIF                                                               BUG3362
064730200529      *                                                                                      BUG3362
064740200529      ** move values from SDVTID to fields of SDTICSL0                                       BUG3362
064750200529      *                                                                                      BUG3362
064760200529     C                   EVAL      TCCUST =A_TCCUST                                          BUG3362
064770200529     C                   EVAL      TCCFXC =A_TCCFXC                                          BUG3362
064780200529     C                   EVAL      TCPFXC =A_TCPFXC                                          BUG3362
064790200529     C                   EVAL      TCETIT =A_TCETIT                                          BUG3362
064800200529     C                   EVAL      TCSALU =A_TCSALU                                          BUG3362
064810200529     C                   EVAL      TCTELX =A_TCTELX                                          BUG3362
064820200529     C                   EVAL      TCTXAB =A_TCTXAB                                          BUG3362
064830200529     C                   EVAL      TCFXNO =A_TCFXNO                                          BUG3362
064840200529     C                   EVAL      TCZPCD =A_TCZPCD                                          BUG3362
064850200529     C                   EVAL      TCTRFM =A_TCTRFM                                          BUG3362
064860200529     C                   EVAL      TCDLNG =A_TCDLNG                                          BUG3362
064870200529     C                   EVAL      TCANAL =A_TCANAL                                          BUG3362
064880200529     C                   EVAL      TCMLBR =A_TCMLBR                                          BUG3362
064890200529     C                   EVAL      TCTYLC =A_TCTYLC                                          BUG3362
064900200529      *                                                                                      BUG3362
064910200529      ** initialise A_TCLCD when WBBTICS = D, i.e. no details to amend on                    BUG3362
064920200529      ** PF/SDTICSPD to avoid db problem on decimal data error                               BUG3362
064930200529      *                                                                                      BUG3362
064940200529     C     WBBTICS       IFEQ      'D'                                                       BUG3362
064950200529     C     WBBTICS       OREQ      ' '                                                       BUG4810
064960200529     C                   EVAL      A_TCLCD=0                                                 BUG3362
064970200529     C                   ENDIF                                                               BUG3362
064980200529      *                                                                                      BUG3362
064990200529     C                   EVAL      TCLCD  =A_TCLCD                                           BUG3362
065000200529     C                   EVAL      TCCSSN =A_TCCSSN                                          BUG3362
065010200529     C                   EVAL      TCFLAG =A_TCFLAG                                          BUG3362
065020200529      *                                                                                      BUG3362
065030200529      ** Check appropriate action on file SDTICSL0                                           BUG3362
065040200529      *                                                                                      BUG3362
065050200529     C*****A_CUTYLC      IFEQ      'I'                                               BUG3362 BG12238
065060200529     C*****A_CUTYLC      OREQ      'A'                                               BUG3362 BG12238
065070200529     C******IN95         ANDEQ     '1'                                               BUG3362 BG12238
065080200529     C     A_TCTYLC      IFEQ      'I'                                                       BG12238
065090200529      *                                                                                      BUG3362
065100200529      ** to ensure that error will not occur when SDVTID is blank(coming from APTRANVU)      BUG3362
065110200529      *                                                                                      BUG3362
065120200529     C     TCCUST        IFNE      *BLANKS                                                   BUG3362
065130200529      *                                                                                      BUG3362
065140200529     C                   WRITE     @TICSL0                                                   BUG3362
065150200529      *                                                                                      BUG3362
065160200529     C**********         Z-ADD     *ZERO         WUNORC                              BUG3362 BUG4201
065170200529     C                   Z-ADD     1             WUNORC                                      BUG4201
065180200529     C                   Z-ADD     *ZERO         WUNOAM                                      BUG3362
065190200529     C                   Z-ADD     1             WUNOIN                                      BUG3362
065200200529     C                   Z-ADD     *ZERO         WUNODL                                      BUG3362
065210200529     C                   ENDIF                                                               BUG3362
065220200529      *                                                                                      BUG3362
065230200529     C                   ELSE                                                                BUG3362
065240200529      *                                                                                      BUG3362
065250200529     C*****A_CUTYLC      IFEQ      'A'                                               BUG3362 BG12238
065260200529     C     A_TCTYLC      IFEQ      'A'                                                       BG12238
065270200529     C     BBTICS        ANDEQ     'Y'                                                       BUG3362
065280200529     C******IN95         ANDEQ     '0'                                               BUG3362 BG12238
065290200529      *                                                                                      BUG3362
065300200529     C     TCCUST        IFNE      *BLANKS                                                   BUG3362
065310200529     C                   UPDATE    @TICSL0                                                   BUG3362
065320200529      *                                                                                      BUG3362
065330200529      ** USER: Processing after Data update                                                  BUG3362
065340200529      *                                                                                      BUG3362
065350200529     C                   Z-ADD     *ZERO         WUNORC                                      BUG3362
065360200529     C                   Z-ADD     1             WUNOAM                                      BUG3362
065370200529     C                   Z-ADD     *ZERO         WUNOIN                                      BUG3362
065380200529     C                   Z-ADD     *ZERO         WUNODL                                      BUG3362
065390200529     C                   ENDIF                                                               BUG3362
065400200529      *                                                                                      BUG3362
065410200529     C                   ELSE                                                                BUG3362
065420200529      *                                                                                      BUG3362
065430200529      ** Delete action or WBBTICS = 'D'                                                      BUG3362
065440200529      *                                                                                      BUG3362
065450200529     C*****A_CUTYLC      IFEQ      'D'                                               BUG3362 BG12238
065460200529     C     A_TCTYLC      IFEQ      'D'                                                       BG12238
065470200529     C     BBTICS        ANDNE     'D'                                                       BUG3362
065480200529     C*****A_CUTYLC      OREQ      'A'                                               BUG3362 BG12238
065490200529     C     A_TCTYLC      OREQ      'A'                                                       BG12238
065500200529     C     WBBTICS       ANDEQ     'D'                                                       BUG3362
065510200529      *                                                                                      BUG3362
065520200529     C                   DELETE    @TICSL0                                                   BUG3362
065530200529      * USER: Processing after Data update                                                   BUG3362
065540200529     C                   MOVEL     SDTICDF       WUDELR                                      BUG3362
065550200529      * Write Deleted Record - SD Deleted Records File  *                                    BUG3362
065560200529     C                   CLEAR                   PBRC                                        BUG3362
065570200529     C                   MOVEL     'SDTICDPD'    PBFNME                                      BUG3362
065580200529     C                   MOVEL     A_TCCUST      PBLKEY                                      BUG3362
065590200529     C                   MOVEL     WUDR01        PBDR01                                      BUG3362
065600200529     C                   MOVEL     WUDR02        PBDR02                                      BUG3362
065610200529     C                   MOVEL     WUDR03        PBDR03                                      BUG3362
065620200529     C                   MOVEL     WUDR04        PBDR04                                      BUG3362
065630200529     C                   MOVEL     WUDR05        PBDR05                                      BUG3362
065640200529     C                   MOVEL     WUDR06        PBDR06                                      BUG3362
065650200529     C                   MOVEL     WUDR07        PBDR07                                      BUG3362
065660200529     C                   MOVEL     WUDR08        PBDR08                                      BUG3362
065670200529     C                   MOVEL     WUDR09        PBDR09                                      BUG3362
065680200529     C                   MOVEL     WUDR10        PBDR10                                      BUG3362
065690200529     C                   MOVEL     WUDR11        PBDR11                                      BUG3362
065700200529     C                   MOVEL     WUDR12        PBDR12                                      BUG3362
065710200529     C                   MOVEL     BJRDNB        PBLCD                                       BUG3362
065720200529     C                   MOVEL     'D'           PBTYLC                                      BUG3362
065730200529                                                                                             BUG3362
065740200529     C                   CALL      'SD0520X'                                                 BUG3362
065750200529     C                   PARM      *BLANK        @RTCD                                       BUG3362
065760200529     C                   PARM                    PBRC                                        BUG3362
065770200529      * Error detected?                                                                      BUG3362
065780200529     C     @RTCD         IFEQ      '*ERROR*'                                                 BUG3362
065790200529     C                   MOVEL     *BLANK        DBKEY                                       BUG3362
065800200529     C                   MOVEL     A_TCCUST      DBKEY                                       BUG3362
065810200529     C                   MOVEL     'SDDELRL0'    DBFILE                         ************ BUG3362
065820200529     C                   MOVEL     '014'         DBASE                          * DBERR 014* BUG3362
065830200529     C                   EXSR      SRERR                                        ************ BUG3362
065840200529     C                   END                                                                 BUG3362
065850200529                                                                                             BUG3362
065860200529     C                   Z-ADD     -1            WUNORC                         No of recordsBUG3362
065870200529     C                   Z-ADD     *ZERO         WUNOAM                         No of Amend  BUG3362
065880200529     C                   Z-ADD     *ZERO         WUNOIN                         No of delete BUG3362
065890200529     C                   Z-ADD     1             WUNODL                         No of Insert BUG3362
065900200529      * Change Standing Data Cont - Standing Data Controls  *                                BUG3362
065910200529     C                   ENDIF                                                               BUG3362
065920200529     C                   ENDIF                                                               BUG3362
065930200529     C                   ENDIF                                                               BUG3362
065940200529      * Change Standing Data Cont - Standing Data Controls  *                                BUG3362
065950200529     C                   MOVEL     'SDTICSPD'    WFLNAME                                     BUG3362
065960200529     C                   EXSR      SNCHRC                                                    BUG3362
065970200529     C**********         ENDIF                                                       BUG3362 BG12238
065980200529     C                   ENDIF                                                               BG12238
065990200529     C                   ENDIF                                                               BUG3362
066000200529      *                                                                                      BUG3362
066010200529     C                   ENDSR                                                               BUG3362
066020200529      *                                                                                      BUG3362
066030200529      *****************************************************************
066040200529      * CHKPRT - Check Particpator History File and Update According'y*
066050200529      *****************************************************************
066060200529     C     CHKPRT        BEGSR
066070200529     C
066080200529     C     INTKEY        KLIST
066090200529     C                   KFLD                    XCNUM
066100200529     C                   KFLD                    KDATE             5 0
066110200529     C
066120200529     C**  IF THE BRT LIABLE FLAG HAS CHANGED CALCULATE THE DATE
066130200529     C**  FROM WHICH THE NEW VALUE IS TO BE EFFECTIVE.
066140200529     C**
066150200529     C     OLDBRT        IFNE      NEWBRT
066160200529     C                   EXSR      BRTFL
066170200529     C**
066180200529     C**  IF THE EFFECTIVE DATE IS THE SAME AS AN EXISTING DATE
066190200529     C**  IN THE EFFECTIVE DATE ARRAY.
066200200529     C**
066210200529     C                   Z-ADD     1             Z                 2 0
066220200529     C     EFF           LOOKUP    EFLD(Z)                                89
066230200529     C**
066240200529     C     *IN89         IFEQ      '1'
066250200529     C**
066260200529     C**  CHECK IF ANY INTEREST PAYMENTS HAVE BEEN MADE BETWEEN THE
066270200529     C**  EFFECTIVE DATE AND TODAY'S DATE.
066280200529     C**
066290200529     C                   Z-ADD     EFF           KDATE
066300200529     C     INTKEY        SETLL     INTPSLF6
066310200529     C                   READ      INTPSLF6                               89
066320200529     C**
066330200529     C     *IN89         IFEQ      '0'
066340200529     C     XCNUM         ANDEQ     A_CNUM
066350200529     C     A_IPDT        ANDLT     BJRDNB
066360200529     C     A_IPDT        ANDGE     EFF
066370200529     C**
066380200529     C**  IF PAYMENTS MADE THE NEXT AVAILABLE ARRAY ELEMENTS ARE
066390200529     C**  UPDATED WITH THE NEW DATA.
066400200529     C**
066410200529     C                   Z-ADD     1             W                 2 0
066420200529     C     *BLANKS       LOOKUP    LFLG(W)                                89
066430200529     C**
066440200529     C                   MOVEA     NEWBRT        LFLG(W)
066450200529     C                   Z-ADD     EFF           EFLD(W)
066460200529     C                   Z-ADD     BJRDNB        LCHD(W)
066470200529     C**
066480200529     C**  IF NO PAYMENTS HAVE BEEN MADE THEN THE CURRENT ELEMENT
066490200529     C**  IS OVERWRITTEN AND ALL SUBSEQUENT ELEMENTS ARE CLEARED.
066500200529     C**
066510200529     C                   ELSE
066520200529     C                   MOVEA     NEWBRT        LFLG(Z)
066530200529     C                   Z-ADD     EFF           EFLD(Z)
066540200529     C                   Z-ADD     BJRDNB        LCHD(Z)
066550200529     C**
066560200529     C     Z             DOUEQ     10
066570200529     C                   ADD       1             Z
066580200529     C                   MOVEA     *BLANKS       LFLG(Z)
066590200529     C                   Z-ADD     *ZEROS        EFLD(Z)
066600200529     C                   Z-ADD     *ZEROS        LCHD(Z)
066610200529     C                   END
066620200529     C**
066630200529     C                   END
066640200529     C**
066650200529     C**  IF EFFECTIVE DATE DOES NOT MATCH AN EXISTING EFFECTIVE DATE
066660200529     C**  UPDATE THE NEXT ARRAY ELEMENTS WITH THE NEW DATA.
066670200529     C**
066680200529     C                   ELSE
066690200529     C                   Z-ADD     1             W
066700200529     C     *BLANKS       LOOKUP    LFLG(W)                                89
066710200529     C**
066720200529     C                   MOVEA     NEWBRT        LFLG(W)
066730200529     C                   Z-ADD     EFF           EFLD(W)
066740200529     C                   Z-ADD     BJRDNB        LCHD(W)
066750200529     C                   END
066760200529      *
066770200529     C                   END
066780200529
066790200529     C                   ENDSR
066800200529      *****************************************************************
066810200529      /EJECT
066820200529      *****************************************************************
066830200529      *   BRTFL - TO CALCULATE THE EFFECTIVE DATE DEPENDING           *
066840200529      *           ON THE BRT LIABLE FLAG FOR THE PARTICIPANT.         *
066850200529      *****************************************************************
066860200529     C     BRTFL         BEGSR
066870200529
066880200529     C**  SET DEFAULT EFFECTIVE DATE TO APRIL 6TH OF CURRENT TAX YEAR
066890200529     C**
066900200529     C                   Z-ADD     APR6CY        EFF               5 0
066910200529     C**
066920200529     C**  IF THE BRT IS 'N' AND A S352 STATEMENT HAS BEEN PRODUCED
066930200529     C**  EFFECTIVE DATE WILL BE SET TO THE LAST INTEREST DATE
066940200529     C**  PAYMENT ON THE INTEREST PAYMENT HISTORY FILE.
066950200529     C**
066960200529     C     NEWBRT        IFEQ      'N'
066970200529     C                   Z-ADD     99999         KDATE
066980200529     C     INTKEY        SETGT     INTPSLF7
066990200529     C                   READP     INTPSLF7                               89
067000200529     C**
067010200529     C     *IN89         IFEQ      '0'
067020200529     C     XCNUM         ANDEQ     B_CNUM
067030200529     C**
067040200529     C                   Z-ADD     B_IPDT        EFF
067050200529     C**
067060200529     C**  IF NO S352 STATEMENT HAS BEEN PRODUCED THE EFFECTIVE DATE
067070200529     C**  WILL BE SET TO APRIL 6TH OF THE CURRENT TAX YEAR.
067080200529     C**
067090200529     C                   ELSE
067100200529     C                   Z-ADD     APR6CY        EFF
067110200529     C                   Z-ADD     00000         KDATE
067120200529     C     INTKEY        SETLL     INTPSLF8
067130200529     C                   READ      INTPSLF8                               89
067140200529     C**
067150200529     C     *IN89         IFEQ      '0'
067160200529     C     XCNUM         ANDEQ     C_CNUM
067170200529     C                   Z-ADD     APR6CY        EFF
067180200529     C**
067190200529     C**  IF ANY INTEREST PAYMENTS HAVE BEEN MADE IN THE CURRENT TAX
067200200529     C**  YEAR, SEND MESSAGE 'INTEREST ADJUSTMENT ....'
067210200529     C**
067220200529     C     C_IPDT        IFGE      APR6CY
067230200529     C                   MOVEL     'Y'           INADJR            1
067240200529     C                   END
067250200529     C**
067260200529     C                   END
067270200529     C**
067280200529     C                   END
067290200529     C**
067300200529     C**  IF THE BRT IS 'Y' OR 'X' THE EFFECTIVE DATE WILL BE SET TO
067310200529     C**  THE LAST INTEREST PAYMENT DATE ON THE INTEREST PAYMENT
067320200529     C**  HISTORY FILE. IF THERE HAVE BEEN NO INTEREST PAYMENTS
067330200529     C**  FOR THIS ACCOUNT IN THE CURRENT TAX YEAR THE EFFECTIVE
067340200529     C**  DATE WILL BE SET TO APRIL 6TH OF THE CURRENT TAX YEAR.
067350200529     C**
067360200529     C                   ELSE
067370200529     C                   Z-ADD     99999         KDATE
067380200529     C     INTKEY        SETGT     INTPSLF6
067390200529     C                   READP     INTPSLF6                               89
067400200529     C**
067410200529     C     *IN89         IFEQ      '0'
067420200529     C     XCNUM         ANDEQ     A_CNUM
067430200529     C                   Z-ADD     A_IPDT        EFF
067440200529     C                   ELSE
067450200529     C                   Z-ADD     APR6CY        EFF
067460200529     C                   END
067470200529     C**
067480200529     C                   END
067490200529     C**
067500200529
067510200529     C                   ENDSR
067520200529      ********************************************************************
067530200529      /EJECT
067540200529      ********************************************************************
067550200529      *                                                                  *
067560200529      * UPDPRB - UPDATE PRIVATE BANKING DETAILS IF BGN4ST = 'Y'          *
067570200529      *                                                                  *
067580200529      ********************************************************************
067590200529     C     UPDPRB        BEGSR
067600200529
067610200529     C     ACTN          IFEQ      'D'
067620200529     C                   MOVE      'C'           A_PBRECI
067630200529     C                   ELSE
067640200529     C                   MOVE      'D'           A_PBRECI
067650200529     C                   ENDIF
067660200529     C                   MOVE      BJRDNB        A_PBLCHD
067670200529     C                   MOVE      ACTN          A_PBCHTP
067680200529     C                   MOVE      A_CUCUST      A_PBCNUM
067690200529
067700200529      ** ACCESS PRIVATE BANKING CUSTOMER DETAILS
067710200529
067720200529     C     A_PBCNUM      CHAIN     SDPBDSL0                           98
067730200529
067740200529      ** DATABASE ERROR
067750200529      ** IF INSERT, BUT RECORD PRESENT ALREADY
067760200529      ** OR IF NOT INSERT, BUT NO RECORD FOUND
067770200529
067780200529      ** Skip validation if the customer came from the acceptance file.                       CSD031
067790200529                                                                                              CSD031
067800200529     C**********         IF        PAccMde <> 'A'                                    CSD031 BUG13525
067810200529     C     A_PBCHTP      IFEQ      'I'
067820200529     C     *IN98         ANDEQ     '0'
067830200529     C     A_PBCHTP      ORNE      'I'
067840200529     C     *IN98         ANDEQ     '1'
067850200529     C                   MOVEL     A_PBCNUM      DBKEY
067860200529     C                   MOVEL     'SDPBDSL0'    DBFILE                         ************
067870200529     C                   MOVEL     '020'         DBASE                          * DBERR 020*
067880200529     C                   EXSR      SRERR                                        ************
067890200529     C                   END
067900200529     C**********         ENDIF                                                       CSD031 BUG13525
067910200529
067920200529      ** Update with details from valid Private Banking record
067930200529
067940200529      ** SET SDPBDSPD FIELDS
067950200529
067960200529     C                   EVAL      D_PBCNUM = A_PBCNUM
067970200529     C                   EVAL      D_PBRECI = A_PBRECI
067980200529     C                   EVAL      D_PBHOLD = A_PBHOLD
067990200529     C                   EVAL      D_PBNUAC = A_PBNUAC
068000200529     C                   EVAL      D_PBAGEN = A_PBAGEN
068010200529     C                   EVAL      D_PBCOUN = A_PBCOUN
068020200529     C                   EVAL      D_PBREPB = A_PBREPB
068030200529     C                   EVAL      D_PBPBST = A_PBPBST
068040200529     C                   EVAL      D_PBLCHD = A_PBLCHD
068050200529     C                   EVAL      D_PBCHTP = A_PBCHTP
068060200529                                                                                185595
068070200529      ***Set*timestamp*if*change*of branch*****************************                185595 202931
068080200529      ** Set timestamp                                                                        202931
068090200529                                                                                185595
068100200529     C***20*****         EVAL      D_PBTMES = BBTMST                                   185595 202931
068110200529     C                   EVAL      D_PBTMES = BBTMST                                          202931
068120200529
068130200529     C                   EVAL      D_PBFRNT = A_PBFRNT                                      AR971184
068140200529     C                   EVAL      D_PBAFRT = A_PBAFRT                                      AR971184
068150200529     C                   EVAL      D_PBAFRT = A_PBAFRT                                      AR971184
068160200529                                                                                            AR971184
068170200529      ** If CSC011 is installed, supply a Front Office ID for the                             CSC011
068180200529      ** transaction even if it originated from SIN module.                                   CSC011
068190200529                                                                                              CSC011
068200200529     C                   IF        CSC011 = 'Y'                                               CSC011
068210200529     C                   IF        A_PBFRNT = *BLANKS                                         CSC011
068220200529     C                   EVAL      D_PBFRNT = BBFRNT                                          CSC011
068230200529     C                   ENDIF                                                                CSC011
068240200529     C                   ENDIF                                                                CSC011
068250200529      *
068260200529      * Update or write record in SDPBDSPD
068270200529      *
068280200529     C     *IN98         IFEQ      '1'
068290200529     C                   WRITE     SDPBDSD0
068300200529     C                   ELSE
068310200529     C                   UPDATE    SDPBDSD0
068320200529     C                   ENDIF
068330200529
068340200529      *
068350200529     C     EndUPDPRB     ENDSR
068360200529     C****************************************************************
068370200529      /EJECT                                                                                  CGP001
068380200529      ********************************************************************                    CGP001
068390200529      *                                                                  *                    CGP001
068400200529      * SRUpdGlbID -  Update Global ID X-Reference if CGP001 = 'Y'       *                    CGP001
068410200529      *                                                                  *                    CGP001
068420200529      ********************************************************************                    CGP001
068430200529     C     SRUpdGlbID    BEGSR                                                                CGP001
068440200529                                                                                              CGP001
068450200529      ** Chain GPCUSTXL0                                                                      CGP001
068460200529                                                                                              CGP001
068470200529     C                   EVAL      K_BRCD = A_CUBRCD                                         BUG2313
068480200529     C                   EVAL      K_CUST = A_CUCUST                                         BUG2313
068490200529     C     KGlbKey       CHAIN     GPCUSTXL0                          98                      CGP001
068500200529                                                                                              CGP001
068510200529      ** Check if Global Customer is blanks                                                   CGP001
068520200529                                                                                              CGP001
068530200529     C                   IF        V_DDGCUS = *BLANKS                                         CGP001
068540200529                                                                                              CGP001
068550200529     C                   IF        *IN98 = *OFF                                               CGP001
068560200529     C                   DELETE    GPCUSTXD0                                                  CGP001
068570200529     C                   ENDIF                                                                CGP001
068580200529                                                                                              CGP001
068590200529     C                   ELSE                                                                 CGP001
068600200529                                                                                              CGP001
068610200529     C                   IF        *IN98 = *ON                                                CGP001
068620200529                                                                                              CGP001
068630200529      ** if no record found write a new record                                                CGP001
068640200529                                                                                              CGP001
068650200529     C                   EVAL      G_CUBRCD = A_CUBRCD                                        CGP001
068660200529     C                   EVAL      G_CUCUST = A_CUCUST                                        CGP001
068670200529     C                   EVAL      G_CUGCUS = V_DDGCUS                                        CGP001
068680200529     C                   WRITE     GPCUSTXD0                                                  CGP001
068690200529     C                   ELSE                                                                 CGP001
068700200529                                                                                              CGP001
068710200529      ** if record found update record                                                        CGP001
068720200529                                                                                              CGP001
068730200529     C                   EVAL      G_CUBRCD = A_CUBRCD                                        CGP001
068740200529     C                   EVAL      G_CUCUST = A_CUCUST                                        CGP001
068750200529     C                   EVAL      G_CUGCUS = V_DDGCUS                                        CGP001
068760200529     C                   UPDATE    GPCUSTXD0                                                  CGP001
068770200529     C                   ENDIF                                                                CGP001
068780200529                                                                                              CGP001
068790200529     C                   ENDIF                                                                CGP001
068800200529                                                                                              CGP001
068810200529     C                   ENDSR                                                                CGP001
068820200529     C****************************************************************                        252069
068830200529      /EJECT                                                                                  252069
068840200529      ********************************************************************                    252069
068850200529      *                                                                  *                    252069
068860200529      * ChkChain - Exit SDCUSDUPD if there is record locking in SDCUSTL0 *                    252069
068870200529      *                                                                  *                    252069
068880200529      ********************************************************************                    252069
068890200529     C     ChkChain      BEGSR                                                                252069
068900200529     C     *IN97         IFEQ      *ON                                                        252069
068910200529     C     STATUS        ANDEQ     01218                                                      252069
068920200529     C                   EVAL      @@RTCD = '*LOCKED'                                         252069
068930200529     C                   GOTO      EXIT                                                       252069
068940200529     C                   ENDIF                                                                252069
068950200529     C                   ENDSR                                                                252069
068960200529      ****************************************************************                        CGP001
068970200529      /EJECT
068980200529      *****************************************************************
068990200529      *                                                               *
069000200529      * *INZSR - Program Initialisation routine                       *
069010200529      *                                                               *
069020200529      * Called by: Main processing                                    *
069030200529      *                                                               *
069040200529      * Calls: None                                                   *
069050200529      *                                                               *
069060200529      *****************************************************************
069070200529     C     *INZSR        BEGSR
069080200529      *                                                                                       CSD012
069090200529      * Override SDCDSHL0                                                                     CSD012
069100200529     C                   Z-ADD     50            CMDLEN           15 5                        CSD012
069110200529     C                   CALL      'QCMDEXC'                                                  CSD012
069120200529     C                   PARM                    CMD1                                         CSD012
069130200529     C                   PARM                    CMDLEN                                       CSD012
069140200529      * Override SDCBSHL0                                                                     CSD012
069150200529     C                   CALL      'QCMDEXC'                                                  CSD012
069160200529     C                   PARM                    CMD2                                         CSD012
069170200529     C                   PARM                    CMDLEN                                       CSD012
069180200529      * Override SDPBSHL0                                                                     CSD012
069190200529     C                   CALL      'QCMDEXC'                                                  CSD012
069200200529     C                   PARM                    CMD3                                         CSD012
069210200529     C                   PARM                    CMDLEN                                       CSD012
069220200529      * Override SDTDSHL0                                                                    BUG3362
069230200529     C                   CALL      'QCMDEXC'                                                 BUG3362
069240200529     C                   PARM                    CMD4                                        BUG3362
069250200529     C                   PARM                    CMDLEN                                      BUG3362
069260200529      * Override SDSWSHL0                                                                   BUG14969
069270200529     C                   CALL      'QCMDEXC'                                                BUG14969
069280200529     C                   PARM                    CMD5                                       BUG14969
069290200529     C                   PARM                    CMDLEN                                     BUG14969
069300200529      * Override SDCUSXL0                                                                     CGL132
069310200529     C                   Z-ADD     50            CMDLEN                                       CGL132
069320200529     C                   CALL      'QCMDEXC'                                                  CGL132
069330200529     C                   PARM                    CMDXC                                        CGL132
069340200529     C                   PARM                    CMDLEN           15 5                        CGL132
069350200529      * Override SDFTNHL0                                                                   MD027115
069360200529     C                   CALL      'QCMDEXC'                                                MD027115
069370200529     C                   PARM                    CMDNH                                      MD027115
069380200529     C                   PARM                    CMDLEN                                     MD027115
069390200529      * Override SDFTCSL0                                                                   MD027115
069400200529     C                   CALL      'QCMDEXC'                                                MD027115
069410200529     C                   PARM                    CMDCS                                      MD027115
069420200529     C                   PARM                    CMDLEN                                     MD027115
069430200529      ** Override SDCRSHL1                                                                  MD051230
069440200529     C                   CALL      'QCMDEXC'                                                MD051230
069450200529     C                   PARM                    CMDCR                                      MD051230
069460200529     C                   PARM                    CMDLEN                                     MD051230
069470200529      *
069480200529      **  PROGRAM PARAMETERS
069490200529      *
069500200529     C     *ENTRY        PLIST
069510200529     C                   PARM                    @@RTCD            7
069520200529     C                   PARM                    SDVCUSD
069530200529     C                   PARM                    SDVCUXC                                      CGL132
069540200529     C                   PARM                    SDVCUBR
069550200529     C                   PARM                    SDVCUPB
069560200529     C                   PARM                    SDVTID                                      BUG3362
069570200529     C                   PARM                    SDVSWSD                                      CSW207
069580200529     C                   PARM                    SDVSW13                                      CFT050
069590200529     C                   PARM                    SDVCUMI                                      CSD079
069600200529     C                   PARM                    SDVCUAD                                      CSD079
069610200529     C                   PARM                    SDVCUFE                                      CSD079
069620200529     C                   PARM                    SDVCUCQ                                      CSD079
069630200529     C                   PARM                    SDVCUSF                                      CSD079
069640200529     C                   PARM                    SDVCURW                                      CSD079
069650200529     C                   PARM                    SDVCUFO                                      CSD079
069660200529     C                   PARM                    SDVCUFF                                      CSD079
069670200529     C                   PARM                    SDVCUPM                                      CSD079
069680200529     C                   PARM                    SDVCUEU                                      CSD079
069690200529     C                   PARM                    SDVCUIB                                      CSD079
069700200529     C**********         PARM                    SDVFTCS                             CGL132 MD026755
069710200529     C                   PARM                    SDVCTNM                                   AR1086546
069720200529     C                   PARM                    SDVFTCS                                    MD026755
069730200529      ** Externally described DS for CRS valid Transaction Detail                             CGL157
069740200529     C                   PARM                    SDVCRSH                                      CGL157
069750200529     C                   PARM                    PCrsdF                                       CGL157
069760200529      * Base Rate Auth req                                                                    CSD012
069770200529     C                   PARM                    AUTHRQ            1                          CSD012
069780200529      * Authorisation Mode                                                                    CSD012
069790200529     C                   PARM                    AUTHMD            1                          CSD012
069800200529     C                   PARM                    V_DDGCUS         10                          CGP001
069810200529     C                   PARM                    S01383            1
069820200529     C                   PARM                    CSW024            1                          CSW024
069830200529     C                   PARM                    CGP001            1                          CGP001
069840200529     C                   PARM                    CLE025                                       CLE025
069850200529     C                   PARM                    CFX001                                       CFX001
069860200529      * Transaction Type                                                                      CSD028
069870200529     C                   PARM                    PTransType                                   CSD028
069880200529     C                   PARM                    DACTN             1                          CSD028
069890200529     C                   PARM                    CTI006            1                        MD030956
069900200529      ** Acceptance Mode                                                                      CSD031
069910200529     C**********         PARM                    PAccMde                             CSD031 BUG13525
069920200529      ** Update (Y/N)                                                                         CSD031
069930200529     C**********         PARM                    PUpdYN                              CSD031 BUG13525
069940200529     C/COPY WNCPYSRC,SDCUSDDC08
069950200529                                                                                              CGL132
069960200529     C     KACRV         KLIST                                                                CGL132
069970200529     C                   KFLD                    KCUST                                        CGL132
069980200529     C                   KFLD                    KSCDT                                        CGL132
069990200529     C                   KFLD                    KSEQN                                        CGL132
070000200529                                                                                              CGL157
070010200529     C     KCRSD         KLIST                                                                CGL157
070020200529     C                   KFLD                    KCUST                                        CGL157
070030200529     C                   KFLD                    KCTRY                                        CGL157
070040200529                                                                                              CSD079
070050200529      ** Get Rundate - Rundate                                                                CSD079
070060200529                                                                                              CSD079
070070200529     C     *DTAARA       DEFINE                  RUNDAT                                       CSD079
070080200529     C                   IN        RUNDAT                                                     CSD079
070090200529      **********                                                                   MD026835 MD027492
070100200529      ***Retrieve ZMUSER details.                                                  MD026835 MD027492
070110200529     C******DTAARA       DEFINE                  ZMUSER                            MD026835 MD027492
070120200529     C**********         IN        ZMUSER                                          MD026835 MD027492
070130200529      **********                                                                   MD026835 MD027492
070140200529     C**********         IF        PSUSER = 'QUSER'                                MD026835 MD027492
070150200529     C**********         EVAL      WKUSER = WUSRID                                 MD026835 MD027492
070160200529     C**********         ELSE                                                      MD026835 MD027492
070170200529     C**********         EVAL      WKUSER = PSUSER                                 MD026835 MD027492
070180200529     C**********         ENDIF                                                     MD026835 MD027492
070190200529      **********                                                                   MD026835 MD027492
070200200529      *
070210200529      ** ACCESS BANK DETAILS
070220200529      *
070230200529     C                   CALLB     'AOBANKR0'
070240200529     C                   PARM      '*MSG    '    @RTCD             7
070250200529     C                   PARM      '*FIRST  '    @OPTN             7
070260200529     C     SDBANK        PARM      SDBANK        DSFDY
070270200529      *
070280200529      * DATABASE ERROR
070290200529      *
070300200529     C     @RTCD         IFNE      *BLANK
070310200529     C                   MOVEL     @OPTN         DBKEY
070320200529     C                   MOVEL     'SDBANKPD'    DBFILE                         *************
070330200529     C                   MOVEL     '900'         DBASE                          * DBERR 900 *
070340200529     C                   EXSR      SRERR                                        *************
070350200529     C                   ELSE                                                                 CSD079
070360200529     C                   MOVEL     BJMRDT        WUMRDT                                       CSD079
070370200529     C                   MOVEL     BJRDNB        WURDNB                                       CSD079
070380200529     C                   END
070390200529      *
070400200529      ** ACCESS GENERAL LEDGER DETAILS
070410200529      *
070420200529     C**********         CALLB     'AOGELRR0'                                                 CGL029
070430200529     C                   CALLB     'AOGELRR1'                                                 CGL029
070440200529     C                   PARM      '*MSG    '    @RTCD
070450200529     C                   PARM      '*FIRST  '    @OPTN
070460200529     C*****SDGELR        PARM      SDGELR        DSFDY                                        CGL029
070470200529     C     SDGELR        PARM      SDGELR        DSSDY                                        CGL029
070480200529      *
070490200529      * DATABASE ERROR
070500200529      *
070510200529     C     @RTCD         IFNE      *BLANK
070520200529     C                   MOVEL     @OPTN         DBKEY
070530200529     C                   MOVEL     'SDGELRPD'    DBFILE                         *************
070540200529     C                   MOVEL     '901'         DBASE                          * DBERR 901 *
070550200529     C                   EXSR      SRERR                                        *************
070560200529     C                   END
070570200529      *
070580200529      ** ACCESS MIDAS MODULE DETAILS
070590200529      *
070600200529     C                   CALLB     'AOMMODR0'
070610200529     C                   PARM      '*MSG    '    @RTCD
070620200529     C                   PARM      '*FIRST  '    @OPTN
070630200529     C     SDMMOD        PARM      SDMMOD        DSFDY
070640200529      *
070650200529      * DATABASE ERROR
070660200529      *
070670200529     C     @RTCD         IFNE      *BLANK
070680200529     C                   MOVEL     @OPTN         DBKEY
070690200529     C                   MOVEL     'SDMMODPD'    DBFILE                         *************
070700200529     C                   MOVEL     '902'         DBASE                          * DBERR 902 *
070710200529     C                   EXSR      SRERR                                        *************
070720200529     C                   END
070730200529      *
070740200529     C/COPY WNCPYSRC,SDCUSDDC05
070750200529      ** ACCESS SECURITIES TRADING DETAILS
070760200529      ** (If module present)                                                                  202380
070770200529      *
070780200529     C     BGSECS        IFEQ      'Y'                                                        202380
070790200529     C                   CALLB     'AOSTRDR0'
070800200529     C                   PARM      '*MSG    '    @RTCD             7
070810200529     C                   PARM      '*FIRST  '    @OPTN             7
070820200529     C     SDSTRD        PARM      SDSTRD        DSSDY
070830200529      *
070840200529      * DATABASE ERROR
070850200529      *
070860200529     C     @RTCD         IFNE      *BLANK
070870200529     C                   MOVEL     @OPTN         DBKEY
070880200529     C                   MOVEL     'SDSTRDPD'    DBFILE                         *************
070890200529     C                   MOVEL     '903'         DBASE                          * DBERR 903 *
070900200529     C                   EXSR      SRERR                                        *************
070910200529     C                   END
070920200529     C                   ENDIF                                                                202380
070930200529     C/COPY WNCPYSRC,SDCUSDDC11
070940200529      *
070950200529      ** ACCESS PORTFOLIO MANAGEMENT DETAILS
070960200529      *
070970200529     C     BGPFMG        IFEQ      'Y'
070980200529     C                   CALLB     'AOPORTR0'
070990200529     C                   PARM      '*MSG    '    @RTCD             7
071000200529     C                   PARM      '*FIRST  '    @OPTN             7
071010200529     C     SDPORT        PARM      SDPORT        DSSDY
071020200529      *
071030200529      * DATABASE ERROR
071040200529      *
071050200529     C     @RTCD         IFNE      *BLANK
071060200529     C                   MOVEL     @OPTN         DBKEY
071070200529     C                   MOVEL     'SDPORTPD'    DBFILE                         *************
071080200529     C                   MOVEL     '904'         DBASE                          * DBERR 904 *
071090200529     C                   EXSR      SRERR                                        *************
071100200529     C                   END
071110200529                                                                                              CSD079
071120200529      ** Portfolios Supported is Customer                                                     CSD079
071130200529                                                                                              CSD079
071140200529     C     FCPORS        IFEQ      'C'                                                        CSD079
071150200529     C                   MOVEL     'Y'           WUPMSC                                       CSD079
071160200529     C                   ELSE                                                                 CSD079
071170200529                                                                                              CSD079
071180200529      ** Retrieve Int Cust Branch - Branch Codes                                              CSD079
071190200529                                                                                              CSD079
071200200529     C                   EXSR      TWRVGN                                                     CSD079
071210200529                                                                                              CSD079
071220200529      ** Return code is Customer on branch codes                                              CSD079
071230200529                                                                                              CSD079
071240200529     C     W0RTN         IFEQ      'BRANCH'                                                   CSD079
071250200529     C                   MOVEL     'Y'           WUPMSC                                       CSD079
071260200529     C                   ELSE                                                                 CSD079
071270200529     C                   MOVEL     'N'           WUPMSC                                       CSD079
071280200529     C                   ENDIF                                                                CSD079
071290200529     C                   ENDIF                                                                CSD079
071300200529     C                   ELSE                                                                 CSD079
071310200529     C                   MOVEL     'N'           WUPMSC                                       CSD079
071320200529     C                   END
071330200529                                                                                              CSC011
071340200529      ** Check if CSC011 is installed                                                         CSC011
071350200529                                                                                              CSC011
071360200529     C                   EVAL      CSC011 = 'N'                                               CSC011
071370200529                                                                                              CSC011
071380200529     C                   CALLB     'AOSARDR0'                                                 CSC011
071390200529     C                   PARM      *BLANKS       PRtCd                                        CSC011
071400200529     C                   PARM      '*VERIFY'     POptn                                        CSC011
071410200529     C                   PARM      'CSC011'      PSard                                        CSC011
071420200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSC011
071430200529                                                                                              CSC011
071440200529      ** Database error                                                                       CSC011
071450200529                                                                                              CSC011
071460200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSC011
071470200529     C                             (PRtCd <> '*NRF   ')                                       CSC011
071480200529     C                   EVAL      DBKEY = 'CSC011'                                           CSC011
071490200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSC011
071500200529     C                   EVAL      DBASE = 905                                                CSC011
071510200529     C                   EXSR      SRERR                                                      CSC011
071520200529     C                   ENDIF                                                                CSC011
071530200529                                                                                              CSC011
071540200529     C                   IF        PRtCd = *BLANKS                                            CSC011
071550200529     C                   EVAL      CSC011 = 'Y'                                               CSC011
071560200529     C**********         IN        SDSTAT                                              CSC011 CSD015
071570200529     C                   IN        SC24X7                                                     CSC011
071580200529     C                   ENDIF                                                                CSC011
071590200529                                                                                              CGL132
071600200529      ** Check if CGL132 is installed                                                         CGL132
071610200529                                                                                              CGL132
071620200529     C                   EVAL      CGL132 = 'N'                                               CGL132
071630200529                                                                                              CGL132
071640200529     C                   CALLB     'AOSARDR0'                                                 CGL132
071650200529     C                   PARM      *BLANKS       PRtCd                                        CGL132
071660200529     C                   PARM      '*VERIFY'     POptn                                        CGL132
071670200529     C                   PARM      'CGL132'      PSard                                        CGL132
071680200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CGL132
071690200529                                                                                              CGL132
071700200529      ** Database error                                                                       CGL132
071710200529                                                                                              CGL132
071720200529     C                   IF        (Prtcd <> *BLANKS) and                                     CGL132
071730200529     C                             (Prtcd <> '*NRF   ')                                       CGL132
071740200529     C                   EVAL      DBKEY = 'CGL132'                                           CGL132
071750200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CGL132
071760200529     C                   EVAL      DBASE = 906                                                CGL132
071770200529     C                   EXSR      SRERR                                                      CGL132
071780200529     C                   ENDIF                                                                CGL132
071790200529                                                                                              CGL132
071800200529     C                   IF        PRtCd = *BLANKS                                            CGL132
071810200529     C                   EVAL      CGL132 = 'Y'                                               CGL132
071820200529     C                   ENDIF                                                                CGL132
071830200529                                                                                              CGL132
071840200529      ** Check if CGL133 is installed                                                         CGL132
071850200529                                                                                              CGL132
071860200529     C                   EVAL      CGL133 = 'N'                                               CGL132
071870200529                                                                                              CGL132
071880200529     C                   CALLB     'AOSARDR0'                                                 CGL132
071890200529     C                   PARM      *BLANKS       PRtCd                                        CGL132
071900200529     C                   PARM      '*VERIFY'     POptn                                        CGL132
071910200529     C                   PARM      'CGL133'      PSard                                        CGL132
071920200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CGL132
071930200529                                                                                              CGL132
071940200529      ** Database error                                                                       CGL132
071950200529                                                                                              CGL132
071960200529     C                   IF        (Prtcd <> *BLANKS) and                                     CGL132
071970200529     C                             (Prtcd <> '*NRF   ')                                       CGL132
071980200529     C                   EVAL      DBKEY = 'CGL133'                                           CGL132
071990200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CGL132
072000200529     C                   EVAL      DBASE = 914                                                CGL132
072010200529     C                   EXSR      SRERR                                                      CGL132
072020200529     C                   ENDIF                                                                CGL132
072030200529                                                                                              CGL132
072040200529     C                   IF        PRtCd = *BLANKS                                            CGL132
072050200529     C                   EVAL      CGL133 = 'Y'                                               CGL132
072060200529     C                   ENDIF                                                                CGL132
072070200529                                                                                              CGL157
072080200529      ** Check if CGL157 is installed                                                         CGL157
072090200529                                                                                              CGL157
072100200529     C                   EVAL      CGL157 = 'N'                                               CGL157
072110200529                                                                                              CGL157
072120200529     C                   CALLB     'AOSARDR0'                                                 CGL157
072130200529     C                   PARM      *BLANKS       PRtCd                                        CGL157
072140200529     C                   PARM      '*VERIFY'     POptn                                        CGL157
072150200529     C                   PARM      'CGL157'      PSard                                        CGL157
072160200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CGL157
072170200529                                                                                              CGL157
072180200529      ** Database error                                                                       CGL157
072190200529                                                                                              CGL157
072200200529     C                   IF        (Prtcd <> *BLANKS) and                                     CGL157
072210200529     C                             (Prtcd <> '*NRF   ')                                       CGL157
072220200529     C                   EVAL      DBKEY = 'CGL157'                                           CGL157
072230200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CGL157
072240200529     C                   EVAL      DBASE = 918                                                CGL157
072250200529     C                   EXSR      SRERR                                                      CGL157
072260200529     C                   ENDIF                                                                CGL157
072270200529                                                                                              CGL157
072280200529     C                   IF        PRtCd = *BLANKS                                            CGL157
072290200529     C                   EVAL      CGL157 = 'Y'                                               CGL157
072300200529     C                   ENDIF                                                                CGL157
072310200529                                                                                              CGL157
072320200529                                                                                              CSD015
072330200529     C                   IN        SDSTAT                                                     CSD015
072340200529                                                                                              CSD021
072350200529      ** Check if CSD021 is installed                                                         CSD021
072360200529                                                                                              CSD021
072370200529     C                   EVAL      CSD021 = 'N'                                               CSD021
072380200529                                                                                              CSD021
072390200529     C                   CALLB     'AOSARDR0'                                                 CSD021
072400200529     C                   PARM      *BLANKS       PRtCd                                        CSD021
072410200529     C                   PARM      '*VERIFY'     POptn                                        CSD021
072420200529     C                   PARM      'CSD021'      PSard                                        CSD021
072430200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD021
072440200529                                                                                              CSD021
072450200529      ** Database error                                                                       CSD021
072460200529                                                                                              CSD021
072470200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSD021
072480200529     C                             (PRtCd <> '*NRF   ')                                       CSD021
072490200529     C                   EVAL      DBKEY = 'CSD021'                                           CSD021
072500200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD021
072510200529     C                   EVAL      DBASE = 910                                                CSD021
072520200529     C                   EXSR      SRERR                                                      CSD021
072530200529     C                   ENDIF                                                                CSD021
072540200529                                                                                              CSD021
072550200529     C                   IF        PRtCd = *BLANKS                                            CSD021
072560200529     C                   EVAL      CSD021 = 'Y'                                               CSD021
072570200529     C******DTAARA***    DEFINE                  CNLU              6 0                 CSD021 CSD027
072580200529     C     *DTAARA       DEFINE                  CNLU              6                          CSD027
072590200529     C                   ENDIF                                                                CSD021
072600200529                                                                                              CSD090
072610200529      ** Check if CSD090 is installed                                                         CSD090
072620200529                                                                                              CSD090
072630200529     C                   EVAL      CSD090 = 'N'                                               CSD090
072640200529                                                                                              CSD090
072650200529     C                   CALLB     'AOSARDR0'                                                 CSD090
072660200529     C                   PARM      *BLANKS       PRtCd                                        CSD090
072670200529     C                   PARM      '*VERIFY'     POptn                                        CSD090
072680200529     C                   PARM      'CSD090'      PSard                                        CSD090
072690200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD090
072700200529                                                                                              CSD090
072710200529      ** Database error                                                                       CSD090
072720200529                                                                                              CSD090
072730200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSD090
072740200529     C                             (PRtCd <> '*NRF   ')                                       CSD090
072750200529     C                   EVAL      DBKEY = 'CSD090'                                           CSD090
072760200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD090
072770200529     C                   EVAL      DBASE = 927                                                CSD090
072780200529     C                   EXSR      SRERR                                                      CSD090
072790200529     C                   ENDIF                                                                CSD090
072800200529                                                                                              CSD090
072810200529     C                   IF        PRtCd = *BLANKS                                            CSD090
072820200529     C                   EVAL      CSD090 = 'Y'                                               CSD090
072830200529     C                   ENDIF                                                                CSD090
072840200529                                                                                              CSD090
072850200529      *
072860200529      ** Open files
072870200529      *
072880200529      *    Base Rate Tax files
072890200529     C     S01383        IFEQ      'Y'
072900200529     C                   OPEN      SDCBRTL1
072910200529     C                   OPEN      PTYHSTPD
072920200529     C                   END
072930200529      *    Trade Innovation file
072940200529     C     BGN3ST        IFEQ      'Y'
072950200529     C     CTI006        OREQ      'Y'                                                      MD030956
072960200529     C                   OPEN      SDTICSL0
072970200529     C                   END
072980200529      *
072990200529     C**   ROUTINE TO CALCULATE DAY NUMBER OF APRIL 6TH FOR CURRENT TAX YEAR
073000200529     C*
073010200529     C                   MOVE      '0'           *IN98
073020200529     C                   Z-ADD     BJRDNB        ZDAYNO
073030200529     C                   EXSR      ZDATE2
073040200529     C                   MOVE      ZDATEB        DATE
073050200529     C**
073060200529     C     MONTH         IFLT      4
073070200529     C     MONTH         OREQ      4
073080200529     C     DAY           ANDLT     6
073090200529     C                   SUB       1             YEAR
073100200529     C                   END
073110200529     C**
073120200529     C                   MOVE      '06'          TDAY
073130200529     C                   MOVE      '04'          TMONTH
073140200529     C                   MOVE      YEAR          TYEAR
073150200529     C**
073160200529     C                   MOVE      TDATE         ZDATEA
073170200529     C                   EXSR      ZDATE1
073180200529     C                   Z-ADD     ZDAYNO        APR6CY            5 0
073190200529     C*
073200200529     C*******************EVAL      K_BRCD = A_CUBRCD                                  CGP001 BUG2313
073210200529     C*******************EVAL      K_CUST = A_CUCUST                                  CGP001 BUG2313
073220200529     C     KGlbKey       KLIST                                                                CGP001
073230200529     C                   KFLD                    K_BRCD                                       CGP001
073240200529     C                   KFLD                    K_CUST                                       CGP001
073250200529                                                                                              CGP001
073260200529     C/COPY WNCPYSRC,SDCUSDDC02
073270200529                                                                                              CSD015
073280200529      ** Check if CSD015 is installed                                                         CSD015
073290200529                                                                                              CSD015
073300200529     C                   CALLB     'AOSARDR0'                                                 CSD015
073310200529     C                   PARM      *BLANKS       PRtCd                                        CSD015
073320200529     C                   PARM      '*VERIFY'     POptn                                        CSD015
073330200529     C                   PARM      'CSD015'      PSard                                        CSD015
073340200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD015
073350200529                                                                                              CSD015
073360200529      ** Database error                                                                       CSD015
073370200529                                                                                              CSD015
073380200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSD015
073390200529     C                             (PRtCd <> '*NRF   ')                                       CSD015
073400200529     C                   EVAL      DBKEY = 'CSD015'                                           CSD015
073410200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD015
073420200529     C                   EVAL      DBASE = 906                                                CSD015
073430200529     C                   EXSR      SRERR                                                      CSD015
073440200529     C                   ENDIF                                                                CSD015
073450200529                                                                                              CSD015
073460200529      ** If Enhancement CSD015 is installed, access SDWLCCPD to                               CSD015
073470200529      ** see if 'SDCUSD' fucntion code is available.                                          CSD015
073480200529                                                                                              CSD015
073490200529     C                   IF        PRtCd = *BLANKS                                            CSD015
073500200529     C                   EVAL      CSD015 = 'Y'                                               CSD015
073510200529     C                   ELSE                                                                 CSD015
073520200529     C                   EVAL      CSD015 = 'N'                                               CSD015
073530200529     C                   ENDIF                                                                CSD015
073540200529                                                                                              CSD015
073550200529     C                   IF        CSD015 = 'Y'                                               CSD015
073560200529                                                                                              CSD015
073570200529     C                   CALLB     'AOWLCCR0'                                                 CSD015
073580200529     C                   PARM      *BLANKS       PRtCd                                        CSD015
073590200529     C                   PARM      '*KEY   '     POptn                                        CSD015
073600200529     C                   PARM      'SDCUSD'      PFncCd                                       CSD015
073610200529     C     SDWLCC        PARM      SDWLCC        DSFDY                                        CSD015
073620200529                                                                                              CSD015
073630200529      ** Database error                                                                       CSD015
073640200529                                                                                              CSD015
073650200529     C                   IF        (PRtCd <> *BLANKS)                                         CSD015
073660200529     C                             AND (PRTCD <> '*NRF')                                      CSD015
073670200529     C                   EVAL      DBKEY = 'SDCUSD'                                           CSD015
073680200529     C                   EVAL      DBFILE = 'SDWLCCPD'                                        CSD015
073690200529     C                   EVAL      DBASE = 907                                                CSD015
073700200529     C                   EXSR      SRERR                                                      CSD015
073710200529     C                   ENDIF                                                                CSD015
073720200529                                                                                              CSD015
073730200529      ** Access SDCWCDPD to get the 5 Private Customer Industry Code                          CSD015
073740200529                                                                                              CSD015
073750200529     C                   CALLB     'AOCWCDR0'                                                 CSD015
073760200529     C                   PARM      *BLANKS       PRTCD                                        CSD015
073770200529     C                   PARM      '*FIRST '     POPTN                                        CSD015
073780200529     C     WDSCWCD       PARM      WDSCWCD       DSSDY                                        CSD015
073790200529                                                                                              CSD015
073800200529      ** Database error                                                                       CSD015
073810200529                                                                                              CSD015
073820200529     C                   IF        (PRtCd <> *BLANKS)                                         CSD015
073830200529     C                   EVAL      DBKEY = POPTN                                              CSD015
073840200529     C                   EVAL      DBFILE = 'SDCWCDPD'                                        CSD015
073850200529     C                   EVAL      DBASE = 908                                                CSD015
073860200529     C                   EXSR      SRERR                                                      CSD015
073870200529     C                   ENDIF                                                                CSD015
073880200529                                                                                              CSD015
073890200529     C                   ENDIF                                                                CSD015
073900200529                                                                                              CSD015
073910200529      ** Check if CCF001 is installed                                                         CSD015
073920200529                                                                                              CSD015
073930200529     C                   EVAL      CCF001 = 'N'                                               CSD015
073940200529     C                   CALLB     'AOSARDR0'                                                 CSD015
073950200529     C                   PARM      *BLANKS       PRtCd                                        CSD015
073960200529     C                   PARM      '*VERIFY'     POptn                                        CSD015
073970200529     C                   PARM      'CCF001'      PSard                                        CSD015
073980200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD015
073990200529                                                                                              CSD015
074000200529      ** Database error                                                                       CSD015
074010200529                                                                                              CSD015
074020200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSD015
074030200529     C                             (PRtCd <> '*NRF   ')                                       CSD015
074040200529     C                   EVAL      DBKEY = 'CCF001'                                           CSD015
074050200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD015
074060200529     C                   EVAL      DBASE = 909                                                CSD015
074070200529     C                   EXSR      SRERR                                                      CSD015
074080200529     C                   ENDIF                                                                CSD015
074090200529                                                                                              CSD015
074100200529     C                   IF        PRtCd = *BLANKS                                            CSD015
074110200529     C                   EVAL      CCF001 = 'Y'                                               CSD015
074120200529     C                   ENDIF                                                                CSD015
074130200529                                                                                              CSD015
074140200529      ** Check if CSW036 is installed                                                         CSW036
074150200529                                                                                              CSW036
074160200529     C                   EVAL      CSW036 = 'N'                                               CSW036
074170200529     C                   CALLB     'AOSARDR0'                                                 CSW036
074180200529     C                   PARM      *BLANKS       PRtCd                                        CSW036
074190200529     C                   PARM      '*VERIFY'     POptn                                        CSW036
074200200529     C                   PARM      'CSW036'      PSard                                        CSW036
074210200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSW036
074220200529                                                                                              CSW036
074230200529      ** Database error                                                                       CSW036
074240200529                                                                                              CSW036
074250200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSW036
074260200529     C                             (PRtCd <> '*NRF   ')                                       CSW036
074270200529     C                   EVAL      DBKEY = 'CSW036'                                           CSW036
074280200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSW036
074290200529     C                   EVAL      DBASE = 910                                                CSW036
074300200529     C                   EXSR      SRERR                                                      CSW036
074310200529     C                   ENDIF                                                                CSW036
074320200529                                                                                              CSW036
074330200529     C                   IF        PRtCd = *BLANKS                                            CSW036
074340200529     C                   MOVE      'Y'           CSW036            1                          CSW036
074350200529     C                   ENDIF                                                                CSW036
074360200529      ** Check if CSW037 is installed                                                         CSW037
074370200529                                                                                              CSW037
074380200529     C                   EVAL      CSW037 = 'N'                                               CSW037
074390200529     C                   CALLB     'AOSARDR0'                                                 CSW037
074400200529     C                   PARM      *BLANKS       PRtCd                                        CSW037
074410200529     C                   PARM      '*VERIFY'     POptn                                        CSW037
074420200529     C                   PARM      'CSW037'      PSard                                        CSW037
074430200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSW037
074440200529                                                                                              CSW037
074450200529      ** Database error                                                                       CSW037
074460200529                                                                                              CSW037
074470200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSW037
074480200529     C                             (PRtCd <> '*NRF   ')                                       CSW037
074490200529     C                   EVAL      DBKEY = 'CSW037'                                           CSW037
074500200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSW037
074510200529     C                   EVAL      DBASE = 909                                                CSW037
074520200529     C                   EXSR      SRERR                                                      CSW037
074530200529     C                   ENDIF                                                                CSW037
074540200529                                                                                              CSW037
074550200529     C                   IF        PRtCd = *BLANKS                                            CSW037
074560200529     C                   MOVE      'Y'           CSW037            1                          CSW037
074570200529     C                   ENDIF                                                                CSW037
074580200529      ** Check if CSD025 is installed                                                         CSD025
074590200529                                                                                              CSD025
074600200529     C                   EVAL      CSD025 = 'N'                                               CSD025
074610200529     C                   CALLB     'AOSARDR0'                                                 CSD025
074620200529     C                   PARM      *BLANKS       PRtCd                                        CSD025
074630200529     C                   PARM      '*VERIFY'     POptn                                        CSD025
074640200529     C                   PARM      'CSD025'      PSard                                        CSD025
074650200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD025
074660200529                                                                                              CSD025
074670200529      ** Database error                                                                       CSD025
074680200529                                                                                              CSD025
074690200529     C                   IF        (PRtCd <> *BLANKS) and                                     CSD025
074700200529     C                             (PRtCd <> '*NRF   ')                                       CSD025
074710200529     C                   EVAL      DBKEY = 'CSD025'                                           CSD025
074720200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD025
074730200529     C                   EVAL      DBASE = 911                                                CSD025
074740200529     C                   EXSR      SRERR                                                      CSD025
074750200529     C                   ENDIF                                                                CSD025
074760200529                                                                                              CSD025
074770200529     C                   IF        PRtCd = *BLANKS                                            CSD025
074780200529     C                   MOVE      'Y'           CSD025            1                          CSD025
074790200529     C                   ENDIF                                                                CSD025
074800200529                                                                                              CSD023
074810200529      ** Check if enhancement CSD023 (Automatic Cust Closure) is on                           CSD023
074820200529                                                                                              CSD023
074830200529     C                   CALLB     'AOSARDR0'                                                 CSD023
074840200529     C                   PARM      *BLANKS       PRTCD                                        CSD023
074850200529     C                   PARM      '*VERIFY'     POPTN                                        CSD023
074860200529     C                   PARM      'CSD023'      PSARD                                        CSD023
074870200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD023
074880200529                                                                                              CSD023
074890200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD023
074900200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD023
074910200529     C                   EVAL      DBKEY = 'CSD023'                                           CSD023
074920200529     C                   EVAL      DBASE = 912                                                CSD023
074930200529     C                   EXSR      SRERR                                                      CSD023
074940200529     C                   ENDIF                                                                CSD023
074950200529                                                                                              CSD023
074960200529     C                   IF        PRTCD = *BLANKS                                            CSD023
074970200529     C                   EVAL      CSD023 = 'Y'                                               CSD023
074980200529     C                   OPEN      ACCNT                                                      CSD023
074990200529     C                   ELSE                                                                 CSD023
075000200529     C                   EVAL      CSD023 = 'N'                                               CSD023
075010200529     C                   ENDIF                                                                CSD023
075020200529      *                                                                                       CSD028
075030200529      ** Check if enhancement CSD028 (KYC) is on                                              CSD028
075040200529      *                                                                                       CSD028
075050200529     C                   CALLB     'AOSARDR0'                                                 CSD028
075060200529     C                   PARM      *BLANKS       PRTCD                                        CSD028
075070200529     C                   PARM      '*VERIFY'     POPTN                                        CSD028
075080200529     C                   PARM      'CSD028'      PSARD                                        CSD028
075090200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD028
075100200529      *                                                                                       CSD028
075110200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD028
075120200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD028
075130200529     C                   EVAL      DBKEY = 'CSD028'                                           CSD028
075140200529     C                   EVAL      DBASE = 913                                                CSD028
075150200529     C                   EXSR      SRERR                                                      CSD028
075160200529     C                   ENDIF                                                                CSD028
075170200529      *                                                                                       CSD028
075180200529     C                   IF        PRTCD = *BLANKS                                            CSD028
075190200529     C                   EVAL      CSD028 = 'Y'                                               CSD028
075200200529     C                   OPEN      SDCDSHL0                                                 MD055210
075210200529     C                   ELSE                                                                 CSD028
075220200529     C                   EVAL      CSD028 = 'N'                                               CSD028
075230200529     C                   ENDIF                                                                CSD028
075240200529                                                                                              CSD031
075250200529      ** Check if CSD037 is enabled.                                                          CSD031
075260200529                                                                                              CSD031
075270200529     C**********         CALLB     'AOSARDR0'                                        CSD031 BUG13525
075280200529     C**********         PARM      *BLANKS       PRtCd                               CSD031 BUG13525
075290200529     C**********         PARM      '*VERIFY'     POptn                               CSD031 BUG13525
075300200529     C**********         PARM      'CSD037'      PSARD                               CSD031 BUG13525
075310200529     C*****SCSARD        PARM      SCSARD        DSFDY                               CSD031 BUG13525
075320200529                                                                                              CSD031
075330200529     C**********         IF        PRtCd = *BLANKS                                   CSD031 BUG13525
075340200529     C**********         EVAL      CSD037 = 'Y'                                      CSD031 BUG13525
075350200529     C**********         ELSE                                                        CSD031 BUG13525
075360200529                                                                                              CSD031
075370200529     C**********         IF        PRtCd <> '*NRF   '                                CSD031 BUG13525
075380200529     C******LOCK         IN        LDA                                               CSD031 BUG13525
075390200529     C**********         EVAL      DBFile = 'SCSARDPD'                               CSD031 BUG13525
075400200529     C**********         EVAL      DBKey = 'CSD037'                                  CSD031 BUG13525
075410200529     C**********         EVAL      DBase = 101                                       CSD031 BUG13525
075420200529     C**********         OUT       LDA                                               CSD031 BUG13525
075430200529     C**********         EXSR      SRERR                                             CSD031 BUG13525
075440200529     C**********         ENDIF                                                       CSD031 BUG13525
075450200529                                                                                              CSD031
075460200529     C**********         ENDIF                                                       CSD031 BUG13525
075470200529                                                                                              CSD079
075480200529      ** Check if enhancement S01425 is on                                                    CSD079
075490200529                                                                                              CSD079
075500200529     C                   CALLB     'AOSARDR0'                                                 CSD079
075510200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
075520200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
075530200529     C                   PARM      'S01425'      PSARD                                        CSD079
075540200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
075550200529                                                                                              CSD079
075560200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
075570200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
075580200529     C                   EVAL      DBKEY  = 'S01425'                                          CSD079
075590200529     C                   EVAL      DBASE  = 920                                               CSD079
075600200529     C                   EXSR      SRERR                                                      CSD079
075610200529     C                   ENDIF                                                                CSD079
075620200529      *                                                                                       CSD079
075630200529     C                   IF        PRTCD = *BLANKS                                            CSD079
075640200529     C                   EVAL      S01425 = 'Y'                                               CSD079
075650200529     C                   ELSE                                                                 CSD079
075660200529     C                   EVAL      S01425 = 'N'                                               CSD079
075670200529     C                   ENDIF                                                                CSD079
075680200529                                                                                              CSD079
075690200529      ** Check if enhancement CSD008 is on                                                    CSD079
075700200529                                                                                              CSD079
075710200529     C                   CALLB     'AOSARDR0'                                                 CSD079
075720200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
075730200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
075740200529     C                   PARM      'CSD008'      PSARD                                        CSD079
075750200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
075760200529                                                                                              CSD079
075770200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
075780200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
075790200529     C                   EVAL      DBKEY  = 'CSD008'                                          CSD079
075800200529     C                   EVAL      DBASE  = 921                                               CSD079
075810200529     C                   EXSR      SRERR                                                      CSD079
075820200529     C                   ENDIF                                                                CSD079
075830200529                                                                                              CSD079
075840200529     C                   IF        PRTCD = *BLANKS                                            CSD079
075850200529     C                   EVAL      CSD008 = 'Y'                                               CSD079
075860200529     C                   ELSE                                                                 CSD079
075870200529     C                   EVAL      CSD008 = 'N'                                               CSD079
075880200529     C                   ENDIF                                                                CSD079
075890200529                                                                                              CSD079
075900200529      ** Check if enhancement CDL002 is on                                                    CSD079
075910200529                                                                                              CSD079
075920200529     C                   CALLB     'AOSARDR0'                                                 CSD079
075930200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
075940200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
075950200529     C                   PARM      'CDL002'      PSARD                                        CSD079
075960200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
075970200529                                                                                              CSD079
075980200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
075990200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
076000200529     C                   EVAL      DBKEY  = 'CDL002'                                          CSD079
076010200529     C                   EVAL      DBASE  = 922                                               CSD079
076020200529     C                   EXSR      SRERR                                                      CSD079
076030200529     C                   ENDIF                                                                CSD079
076040200529      *                                                                                       CSD079
076050200529     C                   IF        PRTCD = *BLANKS                                            CSD079
076060200529     C                   EVAL      CDL002 = 'Y'                                               CSD079
076070200529     C                   ELSE                                                                 CSD079
076080200529     C                   EVAL      CDL002 = 'N'                                               CSD079
076090200529     C                   ENDIF                                                                CSD079
076100200529                                                                                              CSD079
076110200529      ** Check if enhancement CDL006 is on                                                    CSD079
076120200529                                                                                              CSD079
076130200529     C                   CALLB     'AOSARDR0'                                                 CSD079
076140200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
076150200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
076160200529     C                   PARM      'CDL006'      PSARD                                        CSD079
076170200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
076180200529                                                                                              CSD079
076190200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
076200200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
076210200529     C                   EVAL      DBKEY  = 'CDL006'                                          CSD079
076220200529     C                   EVAL      DBASE  = 923                                               CSD079
076230200529     C                   EXSR      SRERR                                                      CSD079
076240200529     C                   ENDIF                                                                CSD079
076250200529      *                                                                                       CSD079
076260200529     C                   IF        PRTCD = *BLANKS                                            CSD079
076270200529     C                   EVAL      CDL006 = 'Y'                                               CSD079
076280200529     C                   ELSE                                                                 CSD079
076290200529     C                   EVAL      CDL006 = 'N'                                               CSD079
076300200529     C                   ENDIF                                                                CSD079
076310200529                                                                                              CSD079
076320200529      ** Check if enhancement CGL018 is on                                                    CSD079
076330200529                                                                                              CSD079
076340200529     C                   CALLB     'AOSARDR0'                                                 CSD079
076350200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
076360200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
076370200529     C                   PARM      'CGL018'      PSARD                                        CSD079
076380200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
076390200529                                                                                              CSD079
076400200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
076410200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
076420200529     C                   EVAL      DBKEY  = 'CGL018'                                          CSD079
076430200529     C                   EVAL      DBASE  = 924                                               CSD079
076440200529     C                   EXSR      SRERR                                                      CSD079
076450200529     C                   ENDIF                                                                CSD079
076460200529      *                                                                                       CSD079
076470200529     C                   IF        PRTCD = *BLANKS                                            CSD079
076480200529     C                   EVAL      CGL018 = 'Y'                                               CSD079
076490200529     C                   ELSE                                                                 CSD079
076500200529     C                   EVAL      CGL018 = 'N'                                               CSD079
076510200529     C                   ENDIF                                                                CSD079
076520200529                                                                                              CSD079
076530200529      ** Check if enhancement ULX004 is on                                                    CSD079
076540200529                                                                                              CSD079
076550200529     C                   CALLB     'AOSARDR0'                                                 CSD079
076560200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
076570200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
076580200529     C                   PARM      'ULX004'      PSARD                                        CSD079
076590200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
076600200529                                                                                              CSD079
076610200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
076620200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
076630200529     C                   EVAL      DBKEY  = 'ULX004'                                          CSD079
076640200529     C                   EVAL      DBASE  = 915                                               CSD079
076650200529     C                   EXSR      SRERR                                                      CSD079
076660200529     C                   ENDIF                                                                CSD079
076670200529                                                                                              CSD079
076680200529     C                   IF        PRTCD = *BLANKS                                            CSD079
076690200529     C                   EVAL      ULX004 = 'Y'                                               CSD079
076700200529     C                   ELSE                                                                 CSD079
076710200529     C                   EVAL      ULX004 = 'N'                                               CSD079
076720200529     C                   ENDIF                                                                CSD079
076730200529                                                                                              CSD079
076740200529      ** Check if enhancement ULX609 is on                                                    CSD079
076750200529                                                                                              CSD079
076760200529     C                   CALLB     'AOSARDR0'                                                 CSD079
076770200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
076780200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
076790200529     C                   PARM      'ULX609'      PSARD                                        CSD079
076800200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
076810200529                                                                                              CSD079
076820200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
076830200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
076840200529     C                   EVAL      DBKEY  = 'ULX609'                                          CSD079
076850200529     C                   EVAL      DBASE  = 916                                               CSD079
076860200529     C                   EXSR      SRERR                                                      CSD079
076870200529     C                   ENDIF                                                                CSD079
076880200529      *                                                                                       CSD079
076890200529     C                   IF        PRTCD = *BLANKS                                            CSD079
076900200529     C                   EVAL      ULX609 = 'Y'                                               CSD079
076910200529     C                   ELSE                                                                 CSD079
076920200529     C                   EVAL      ULX609 = 'N'                                               CSD079
076930200529     C                   ENDIF                                                                CSD079
076940200529                                                                                              CSD079
076950200529      ** Check if enhancement ULX043 is on                                                    CSD079
076960200529                                                                                              CSD079
076970200529     C                   CALLB     'AOSARDR0'                                                 CSD079
076980200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
076990200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
077000200529     C                   PARM      'ULX043'      PSARD                                        CSD079
077010200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
077020200529                                                                                              CSD079
077030200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
077040200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
077050200529     C                   EVAL      DBKEY  = 'ULX043'                                          CSD079
077060200529     C                   EVAL      DBASE  = 917                                               CSD079
077070200529     C                   EXSR      SRERR                                                      CSD079
077080200529     C                   ENDIF                                                                CSD079
077090200529                                                                                              CSD079
077100200529     C                   IF        PRTCD = *BLANKS                                            CSD079
077110200529     C                   EVAL      ULX043 = 'Y'                                               CSD079
077120200529     C                   ELSE                                                                 CSD079
077130200529     C                   EVAL      ULX043 = 'N'                                               CSD079
077140200529     C                   ENDIF                                                                CSD079
077150200529                                                                                              CSD079
077160200529     ** Check if enhancement CSD079 is on                                                     CSD079
077170200529                                                                                              CSD079
077180200529     C                   CALLB     'AOSARDR0'                                                 CSD079
077190200529     C                   PARM      *BLANKS       PRTCD                                        CSD079
077200200529     C                   PARM      '*VERIFY'     POPTN                                        CSD079
077210200529     C                   PARM      'CSD079'      PSARD                                        CSD079
077220200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD079
077230200529                                                                                              CSD079
077240200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD079
077250200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD079
077260200529     C                   EVAL      DBKEY  = 'CSD079'                                          CSD079
077270200529     C                   EVAL      DBASE  = 925                                               CSD079
077280200529     C                   EXSR      SRERR                                                      CSD079
077290200529     C                   ENDIF                                                                CSD079
077300200529      *                                                                                       CSD079
077310200529     C                   IF        PRTCD = *BLANKS                                            CSD079
077320200529     C                   EVAL      CSD079 = 'Y'                                               CSD079
077330200529     C                   ELSE                                                                 CSD079
077340200529     C                   EVAL      CSD079 = 'N'                                               CSD079
077350200529     C                   ENDIF                                                                CSD079
077360200529                                                                                              CSD079
077370200529     C                   IF        PRTCD = *BLANKS                                            CSD079
077380200529     C                   OPEN      SDCMRKL0                                                   CSD079
077390200529     C                   OPEN      SDACUSL0                                                   CSD079
077400200529     C                   OPEN      SDCFCDL0                                                   CSD079
077410200529     C                   OPEN      SDCHEQL0                                                   CSD079
077420200529     C                   OPEN      SDSAFEL0                                                   CSD079
077430200529     C                   OPEN      SDFOCSL0                                                   CSD079
077440200529     C                   OPEN      SDFOX1L0                                                   CSD079
077450200529     C                   OPEN      SDPLCSL0                                                   CSD079
077460200529     C                   ENDIF                                                                CSD079
077470200529      *                                                                                      BUG3362
077480200529      ** initialise WBBTICS equal to blank                                                   BUG3362
077490200529      *                                                                                      BUG3362
077500200529     C                   MOVE      ' '           WBBTICS           1                         BUG3362
077510200529      *                                                                                      BUG3362
077520200529      ** Check if SWIFT 2007 is installed                                                     CSW207
077530200529                                                                                              CSW207
077540200529     C                   CALL      'SWIF2007'                                                 CSW207
077550200529     C                   PARM      *BLANKS       PRtCd                                        CSW207
077560200529                                                                                              CSW207
077570200529     C                   IF        PRtCd = 'CSW2007'                                          CSW207
077580200529     C                   EVAL      CSW207 = 'Y'                                               CSW207
077590200529     C                   ELSE                                                                 CSW207
077600200529     C                   EVAL      CSW207 = 'N'                                               CSW207
077610200529     C                   ENDIF                                                                CSW207
077620200529                                                                                              CGL132
077630200529     C                   IF        CGL132 = 'Y'                                               CGL132
077640200529                                                                                              CGL132
077650200529     C                   CALL      'AOSVALR0'                                                 CGL132
077660200529     C                   PARM      *BLANKS       PRtcd                                        CGL132
077670200529     C                   PARM      SysVal1       SValK1                                       CGL132
077680200529     C                   PARM                    SVal1                                        CGL132
077690200529     C                   PARM      SysVal2       SValK2                                       CGL132
077700200529     C                   PARM                    SVal2                                        CGL132
077710200529     C                   PARM      SysVal3       SValK3                                       CGL132
077720200529     C                   PARM                    SVal3                                        CGL132
077730200529     C                   PARM                    SValK4                                       CGL132
077740200529     C                   PARM                    SVal4                                        CGL132
077750200529     C                   PARM                    SValK5                                       CGL132
077760200529     C                   PARM                    SVal5                                        CGL132
077770200529     C                   PARM                    SValK6                                       CGL132
077780200529     C                   PARM                    SVal6                                        CGL132
077790200529     C                   PARM                    SValK7                                       CGL132
077800200529     C                   PARM                    SVal7                                        CGL132
077810200529     C                   PARM                    SValK8                                       CGL132
077820200529     C                   PARM                    SVal8                                        CGL132
077830200529     C                   PARM                    SValK9                                       CGL132
077840200529     C                   PARM                    SVal9                                        CGL132
077850200529     C                   PARM                    SValK0                                       CGL132
077860200529     C                   PARM                    SVal10                                       CGL132
077870200529                                                                                              CGL132
077880200529     C                   IF        PRtcd <> *Blanks  AND                                      CGL132
077890200529     C                             PRtcd <> '*NRF   '                                         CGL132
077900200529     C                   EVAL      DBFILE = 'SDSVALPD'                                        CGL132
077910200529     C                   EVAL      DBKEY = SValK1                                             CGL132
077920200529     C                   EVAL      DBASE = 907                                                CGL132
077930200529     C                   EVAL      DBPGM = 'SDCUSDUPD'                                        CGL132
077940200529     C                   EXSR      SRERR                                                      CGL132
077950200529     C                   ENDIF                                                                CGL132
077960200529     C                   ENDIF                                                                CGL132
077970200529                                                                                              CSW207
077980200529      ** Check if Watch List Element (CSD083) is on                                           CSD083
077990200529                                                                                              CSD083
078000200529     C                   CALLB     'AOSARDR0'                                                 CSD083
078010200529     C                   PARM      *BLANKS       PRTCD                                        CSD083
078020200529     C                   PARM      '*VERIFY'     POPTN                                        CSD083
078030200529     C                   PARM      'CSD083'      PSARD                                        CSD083
078040200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD083
078050200529                                                                                              CSD083
078060200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD083
078070200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD083
078080200529     C                   EVAL      DBKEY  = 'CSD083'                                          CSD083
078090200529     C                   EVAL      DBASE  = 926                                               CSD083
078100200529     C                   EXSR      SRERR                                                      CSD083
078110200529     C                   ENDIF                                                                CSD083
078120200529      *                                                                                       CSD083
078130200529     C                   IF        PRTCD = *BLANKS                                            CSD083
078140200529     C                   EVAL      CSD015 = 'N'                                               CSD083
078150200529     C                   ENDIF                                                                CSD083
078160200529      *                                                                                       CLE134
078170200529      ** Check if enhancement CLE134 is on                                                    CLE134
078180200529      *                                                                                       CLE134
078190200529     C                   CALLB     'AOSARDR0'                                                 CLE134
078200200529     C                   PARM      *BLANKS       PRTCD                                        CLE134
078210200529     C                   PARM      '*VERIFY'     POPTN                                        CLE134
078220200529     C                   PARM      'CLE134'      PSARD                                        CLE134
078230200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CLE134
078240200529                                                                                              CLE134
078250200529     C                   IF        PRTCD <> *BLANKS                                           CLE134
078260200529     C                             AND PRTCD <> '*NRF   '                                     CLE134
078270200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CLE134
078280200529     C                   EVAL      DBKEY = 'CLE134'                                           CLE134
078290200529     C                   EVAL      DBASE = 930                                                CLE134
078300200529     C                   EXSR      SRERR                                                      CLE134
078310200529     C                   ENDIF                                                                CLE134
078320200529                                                                                              CLE134
078330200529     C                   IF        PRTCD = *BLANKS                                            CLE134
078340200529     C                   EVAL      CLE134 = 'Y'                                               CLE134
078350200529                                                                                              CLE134
078360200529     C                   ELSE                                                                 CLE134
078370200529     C                   EVAL      CLE134 = 'N'                                               CLE134
078380200529     C                   ENDIF                                                                CLE134
078390200529      *                                                                                    AR1086546
078400200529     C                   CALLB     'AOSARDR0'                                              AR1086546
078410200529     C                   PARM      *BLANKS       PRTCD                                     AR1086546
078420200529     C                   PARM      '*VERIFY'     POPTN                                     AR1086546
078430200529     C                   PARM      'CDL025'      PSARD                                     AR1086546
078440200529     C     SCSARD        PARM      SCSARD        DSFDY                                     AR1086546
078450200529                                                                                           AR1086546
078460200529     C                   IF        PRTCD       = *BLANKS                                   AR1086546
078470200529     C                   EVAL      CDL025      = 'Y'                                       AR1086546
078480200529     C                   ELSE                                                              AR1086546
078490200529     C                   EVAL      CDL025      = 'N'                                       AR1086546
078500200529     C                   ENDIF                                                             AR1086546
078510200529                                                                                           AR1086546
078520200529                                                                                              CSD083
078530200529      ** Check if account review (CSD092) is on                                               CSD092
078540200529                                                                                              CSD092
078550200529     C                   CALLB     'AOSARDR0'                                                 CSD092
078560200529     C                   PARM      *BLANKS       PRTCD                                        CSD092
078570200529     C                   PARM      '*VERIFY'     POPTN                                        CSD092
078580200529     C                   PARM      'CSD092'      PSARD                                        CSD092
078590200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CSD092
078600200529                                                                                              CSD092
078610200529     C                   IF        PRTCD <> *BLANKS  AND  PRTCD <> '*NRF   '                  CSD092
078620200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CSD092
078630200529     C                   EVAL      DBKEY  = 'CSD092'                                          CSD092
078640200529     C                   EVAL      DBASE  = 929                                               CSD092
078650200529     C                   EXSR      SRERR                                                      CSD092
078660200529     C                   ENDIF                                                                CSD092
078670200529      *                                                                                       CSD092
078680200529     C                   IF        PRTCD = *BLANKS                                            CSD092
078690200529     C                   EVAL      CSD092 = 'Y'                                               CSD092
078700200529     C                   ENDIF                                                                CSD092
078710200529                                                                                              CSD092
078720200529      *                                                                                       CFT050
078730200529      ** Check if CFT050 is installed                                                         CFT050
078740200529      *                                                                                       CFT050
078750200529     C                   EVAL      CFT050 = 'N'                                               CFT050
078760200529                                                                                              CFT050
078770200529     C                   CALLB     'AOSARDR0'                                                 CFT050
078780200529     C                   PARM      *BLANKS       PRtCd                                        CFT050
078790200529     C                   PARM      '*VERIFY'     POptn                                        CFT050
078800200529     C                   PARM      'CFT050'      PSard                                        CFT050
078810200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CFT050
078820200529                                                                                              CFT050
078830200529      ** Database error                                                                       CFT050
078840200529                                                                                              CFT050
078850200529     C                   IF        (PRtCd <> *BLANKS) and                                     CFT050
078860200529     C                             (PRtCd <> '*NRF   ')                                       CFT050
078870200529     C                   EVAL      DBKEY = 'CSW213'                                           CFT050
078880200529     C                   EVAL      DBFILE = 'SCSARDPD'                                        CFT050
078890200529     C                   EVAL      DBASE = 928                                                CFT050
078900200529     C                   EXSR      SRERR                                                      CFT050
078910200529     C                   ELSE                                                                 CFT050
078920200529     C                   EVAL      CFT050 = 'Y'                                               CFT050
078930200529     C                   ENDIF                                                                CFT050
078940200529      *                                                                                     MD028198
078950200529      ** Check if SWIFT 2013 is installed                                                   MD028198
078960200529      *                                                                                     MD028198
078970200529     C                   CALL      'SWIF2013'                                               MD028198
078980200529     C                   PARM      *BLANKS       PRtCd                                      MD028198
078990200529                                                                                            MD028198
079000200529     C                   IF        PRtCd  = 'CSW2013'                                       MD028198
079010200529     C                   EVAL      CSW213 = 'Y'                                             MD028198
079020200529     C                   ELSE                                                               MD028198
079030200529     C                   EVAL      CSW213 = 'N'                                             MD028198
079040200529     C                   ENDIF                                                              MD028198
079050200529      *                                                                                       CER050
079060200529     C                   CALLB     'AOSARDR0'                                                 CER050
079070200529     C                   PARM      *BLANKS       PRTCD                                        CER050
079080200529     C                   PARM      '*VERIFY'     POPTN                                        CER050
079090200529     C                   PARM      'CER050'      PSARD                                        CER050
079100200529     C     SCSARD        PARM      SCSARD        DSFDY                                        CER050
079110200529                                                                                              CER050
079120200529     C                   IF        PRTCD       = *BLANKS                                      CER050
079130200529     C                   EVAL      CER050      = 'Y'                                          CER050
079140200529     C                   ELSE                                                                 CER050
079150200529     C                   EVAL      CER050      = 'N'                                          CER050
079160200529     C                   ENDIF                                                                CER050
079170200529      *                                                                                       CER050
079180200529     C                   ENDSR
079190200529     C****************************************************************
079200200529      /EJECT
079210200529      *****************************************************************
079220200529      *                                                               *
079230200529      *  ZDATE1 - Validate & convert date to a day number             *
079240200529      *                                                               *
079250200529      *****************************************************************
079260200529     C     ZDATE1        BEGSR
079270200529
079280200529     C                   CALLB     'ZDATE1'
079290200529     C                   PARM                    ZDATEA            6
079300200529     C                   PARM                    ZDAYNO            5 0
079310200529     C                   PARM                    BJDFIN
079320200529     C                   PARM                    ErrorFlag         1
079330200529
079340200529     C                   ENDSR
079350200529      *****************************************************************
079360200529      /EJECT
079370200529      *****************************************************************
079380200529      *                                                               *
079390200529      * ZDATE2 - Format a date for output                             *
079400200529      *                                                               *
079410200529      *****************************************************************
079420200529     C     ZDATE2        BEGSR
079430200529
079440200529     C                   CALLB     'ZDATE2'
079450200529     C                   PARM                    ZDAYNO            5 0
079460200529     C                   PARM                    BJDFIN
079470200529     C                   PARM                    ZDATEB            6 0
079480200529     C                   PARM                    ZADATE            7
079490200529
079500200529     C                   ENDSR
079510200529      *****************************************************************
079520200529     C*                                                              *
079530200529     C* SRERR - EXCEPTION ERRORS                                     *
079540200529     C*                                                              *
079550200529     C****************************************************************
079560200529     C     SRERR         BEGSR
079570200529     C*
079580200529     C                   MOVEL     '*ERROR '     @@RTCD
079590200529     C                   MOVEL     'SDCUSDUPD'   DBPGM            10
079600200529     C                   MOVE      '1'           *INU7
079610200529     C                   MOVE      '1'           *INU8
079620200529     C                   MOVE      '1'           *INLR
079630200529     C                   DUMP
079640200529     C*
079650200529     C**  TERMINATE THE PROGRAM
079660200529     C*
079670200529     C                   RETURN
079680200529     C*
079690200529     C                   ENDSR
079700200529      *****************************************************************                       CSD015
079710200529      /EJECT                                                                                  CSD015
079720200529      *****************************************************************                       CSD015
079730200529      *                                                               *                       CSD015
079740200529      * SRWTCH - Set-up parameter and send transaction details to     *                       CSD015
079750200529      *          Compliance Watch by calling the Engine program       *                       CSD015
079760200529      *                                                               *                       CSD015
079770200529      *****************************************************************                       CSD015
079780200529     C     SRWTCH        BEGSR                                                                CSD015
079790200529                                                                                              CSD015
079800200529      ** Set-up first parameter for Compliance Engine                                         CSD015
079810200529                                                                                              CSD015
079820200529     C                   EVAL      PDSWLTD = *BLANKS                                          CSD015
079830200529     C                   EVAL      W4AMT1 = 0                                                 CSD015
079840200529     C                   EVAL      W4AMT2 = 0                                                 CSD015
079850200529     C                   EVAL      W4ITEM = 'SDCUSD'                                          CSD015
079860200529     C                   EVAL      W4IDEN = BBCUST                                            CSD015
079870200529     C                   EVAL      W4BRCH = BBBRCD                                            CSD015
079880200529     C                   EVAL      W4FUNT = 'SDCUSTPD'                                        CSD015
079890200529     C                   EVAL      W4CNUM = BBCUST                                            CSD015
079900200529                                                                                              CSD015
079910200529      ** Get Main System Prefix from data area SC24X7 if enhancement                          CSD015
079920200529      ** CSC011 is installed, else get it from SDSTAT                                         CSD015
079930200529                                                                                              CSD015
079940200529     C                   IF        CSC011 = 'Y'                                               CSD015
079950200529     C                   EVAL      W4SYSM = S1MAIN                                            CSD015
079960200529     C                   ELSE                                                                 CSD015
079970200529     C                   EVAL      W4SYSM = LIBR                                              CSD015
079980200529     C                   ENDIF                                                                CSD015
079990200529                                                                                              CSD015
080000200529      ** If Concord Interface Development is installed (CCF001)                               CSD015
080010200529                                                                                              CSD015
080020200529     C                   IF        CCF001 = 'Y'                                               CSD015
080030200529                                                                                              CSD015
080040200529      ** If Corporate Customer is 'Y'                                                         CSD015
080050200529                                                                                              CSD015
080060200529     C                   IF        BBCRPC = 'Y'                                               CSD015
080070200529     C                   EVAL      W4CTYP = 'C'                                               CSD015
080080200529     C                   ELSE                                                                 CSD015
080090200529     C                   EVAL      W4CTYP = 'I'                                               CSD015
080100200529     C                   ENDIF                                                                CSD015
080110200529                                                                                              CSD015
080120200529     C                   ELSE                                                                 CSD015
080130200529                                                                                              CSD015
080140200529      ** If Local Industry Code is not blank or not equal to any                              CSD015
080150200529      ** of the five Private Customer Industry Code                                           CSD015
080160200529                                                                                              CSD015
080170200529     C                   IF        BBLICD <> *BLANKS                                          CSD015
080180200529     C                             AND BBLICD <> W1IND1                                       CSD015
080190200529     C                             AND BBLICD <> W1IND2                                       CSD015
080200200529     C                             AND BBLICD <> W1IND3                                       CSD015
080210200529     C                             AND BBLICD <> W1IND4                                       CSD015
080220200529     C                             AND BBLICD <> W1IND5                                       CSD015
080230200529     C                   EVAL      W4CTYP = 'C'                                               CSD015
080240200529     C                   ELSE                                                                 CSD015
080250200529     C                   EVAL      W4CTYP = 'I'                                               CSD015
080260200529     C                   ENDIF                                                                CSD015
080270200529                                                                                              CSD015
080280200529     C                   ENDIF                                                                CSD015
080290200529                                                                                              CSD015
080300200529      ** Get the Counter Party (Midas Report Name + Customer Report Town)                     CSD015
080310200529                                                                                              CSD015
080320200529     C                   MOVEL     BBCRNM        W4CUST                                       CSD015
080330200529     C                   MOVE      BBCRTN        W4CUST                                       CSD015
080340200529                                                                                              CSD015
080350200529      ** Get converted dates                                                                  CSD015
080360200529                                                                                              CSD015
080370200529     C                   MOVE      '00000'       PINDATE                                      CSD015
080380200529     C                   EXSR      SRCVTDATE                                                  CSD015
080390200529     C                   MOVE      PCVTDDATE     W4DDAT                                       CSD015
080400200529                                                                                              CSD015
080410200529     C                   MOVE      '00000'       PINDATE                                      CSD015
080420200529     C                   EXSR      SRCVTDATE                                                  CSD015
080430200529     C                   MOVE      PCVTDDATE     W4VDAT                                       CSD015
080440200529                                                                                              CSD015
080450200529     C                   MOVE      '00000'       PINDATE                                      CSD015
080460200529     C                   EXSR      SRCVTDATE                                                  CSD015
080470200529     C                   MOVE      PCVTDDATE     W4MDAT                                       CSD015
080480200529                                                                                              CSD015
080490200529      ** Set-up second parameter for Compliance Engine                                        CSD015
080500200529                                                                                              CSD015
080510200529     C                   EVAL      PDSXML = *BLANKS                                           CSD015
080520200529                                                                                              CSD015
080530200529      ** Set-up Customer Name                                                                 CSD015
080540200529                                                                                              CSD015
080550200529     C                   IF        BBCNA1 <> B_BBCNA1                                         CSD015
080560200529     C                             OR WUNCF1 = 'Y'                                            CSD015
080570200529     C                   IF        BBCNA1 <> *BLANKS                                          CSD015
080580200529     C                   CAT       ARRTAG(1):0   PDSXML                                       CSD015
080590200529     C                   CAT       BBCNA1:0      PDSXML                                       CSD015
080600200529     C                   CAT       ARRTAG(2):0   PDSXML                                       CSD015
080610200529     C                   ENDIF                                                                CSD015
080620200529     C                   ENDIF                                                                CSD015
080630200529                                                                                              CSD015
080640200529      ** Set-up Address Lines                                                                 CSD015
080650200529                                                                                              CSD015
080660200529     C                   IF        BBCNA2 <> B_BBCNA2                                         CSD015
080670200529     C                             OR BBCNA3 <> B_BBCNA3                                      CSD015
080680200529     C                             OR BBCNA4 <> B_BBCNA4                                      CSD015
080690200529     C                             OR WUNCF1 = 'Y'                                            CSD015
080700200529     C                   EVAL      WADDAL = *BLANKS                                           CSD015
080710200529     C                   CAT       BBCNA2:0      WADDAL                                       CSD015
080720200529     C                   CAT       BBCNA3:1      WADDAL                                       CSD015
080730200529     C                   CAT       BBCNA4:1      WADDAL                                       CSD015
080740200529     C                   IF        WADDAL <> *BLANKS                                          CSD015
080750200529     C                   CAT       ARRTAG(3):0   PDSXML                                       CSD015
080760200529     C                   CAT       WADDAL:0      PDSXML                                       CSD015
080770200529     C                   CAT       ARRTAG(4):0   PDSXML                                       CSD015
080780200529     C                   ENDIF                                                                CSD015
080790200529     C                   ENDIF                                                                CSD015
080800200529                                                                                              CSD015
080810200529      ** Set-up SWIFT Identifier                                                              CSD015
080820200529                                                                                              CSD015
080830200529     C                   IF        BBCSID <> B_BBCSID                                         CSD015
080840200529     C                             OR WUNCF1 = 'Y'                                            CSD015
080850200529     C                   IF        BBCSID <> *BLANKS                                          CSD015
080860200529     C                   CAT       ARRTAG(5):0   PDSXML                                       CSD015
080870200529     C                   CAT       BBCSID:0      PDSXML                                       CSD015
080880200529     C                   CAT       ARRTAG(6):0   PDSXML                                       CSD015
080890200529     C                   ENDIF                                                                CSD015
080900200529     C                   ENDIF                                                                CSD015
080910200529                                                                                              CSD015
080920200529      ** Set-up Country of Citizenship                                                        CSD015
080930200529                                                                                              CSD015
080940200529     C                   IF        BBCNCZ <> B_BBCNCZ                                         CSD015
080950200529     C                             OR WUNCF1 = 'Y'                                            CSD015
080960200529     C                   IF        BBCNCZ <> *BLANKS                                          CSD015
080970200529     C                   CAT       ARRTAG(7):0   PDSXML                                       CSD015
080980200529     C                   CAT       BBCNCZ:0      PDSXML                                       CSD015
080990200529     C                   CAT       ARRTAG(8):0   PDSXML                                       CSD015
081000200529     C                   ENDIF                                                                CSD015
081010200529     C                   ENDIF                                                                CSD015
081020200529                                                                                              CSD015
081030200529      ** Set-up Country of Domicile                                                           CSD015
081040200529                                                                                              CSD015
081050200529     C                   IF        BBCOLC <> B_BBCOLC                                         CSD015
081060200529     C                             OR WUNCF1 = 'Y'                                            CSD015
081070200529     C                   IF        BBCOLC <> *BLANKS                                          CSD015
081080200529     C                   CAT       ARRTAG(9):0   PDSXML                                       CSD015
081090200529     C                   CAT       BBCOLC:0      PDSXML                                       CSD015
081100200529     C                   CAT       ARRTAG(10):0  PDSXML                                       CSD015
081110200529     C                   ENDIF                                                                CSD015
081120200529     C                   ENDIF                                                                CSD015
081130200529                                                                                              CSD015
081140200529      ** Send transaction details to Compliance Watch                                         CSD015
081150200529                                                                                              CSD015
081160200529     C                   IF        PDSXML <> *BLANKS                                          CSD015
081170200529     C                   CALL      'SDCWLCHK'                                                 CSD015
081180200529     C                   PARM                    PDSWLTD                                      CSD015
081190200529     C                   PARM                    PDSXML                                       CSD015
081200200529     C                   ENDIF                                                                CSD015
081210200529                                                                                              CSD015
081220200529     C                   ENDSR                                                                CSD015
081230200529      *****************************************************************                       CSD015
081240200529      /EJECT                                                                                  CSD015
081250200529      *****************************************************************                       CSD015
081260200529      *                                                               *                       CSD015
081270200529      * SRXWTCH - Set-up parameter and send transaction details to    *                       CSD015
081280200529      *          Compliance Watch by calling the Engine program for   *                       CSD015
081290200529      *          Standing Data Authorisation enhancement              *                       CSD015
081300200529      *                                                               *                       CSD015
081310200529      *****************************************************************                       CSD015
081320200529     C     SRXWTCH       BEGSR                                                                CSD015
081330200529                                                                                              CSD015
081340200529      ** Set-up first parameter for Compliance Engine                                         CSD015
081350200529                                                                                              CSD015
081360200529     C                   EVAL      PDSWLTD = *BLANKS                                          CSD015
081370200529     C                   EVAL      W4AMT1 = 0                                                 CSD015
081380200529     C                   EVAL      W4AMT2 = 0                                                 CSD015
081390200529     C                   EVAL      W4ITEM = 'SDCUSD'                                          CSD015
081400200529     C                   EVAL      W4IDEN = T_BBCUST                                          CSD015
081410200529     C                   EVAL      W4BRCH = T_BBBRCD                                          CSD015
081420200529     C                   EVAL      W4FUNT = 'SDCUSTPD'                                        CSD015
081430200529     C                   EVAL      W4CNUM = T_BBCUST                                          CSD015
081440200529                                                                                              CSD015
081450200529      ** Get Main System Prefix from data area SC24X7 if enhancement                          CSD015
081460200529      ** CSC011 is installed, else get it from SDSTAT                                         CSD015
081470200529                                                                                              CSD015
081480200529     C                   IF        CSC011 = 'Y'                                               CSD015
081490200529     C                   EVAL      W4SYSM = S1MAIN                                            CSD015
081500200529     C                   ELSE                                                                 CSD015
081510200529     C                   EVAL      W4SYSM = LIBR                                              CSD015
081520200529     C                   ENDIF                                                                CSD015
081530200529                                                                                              CSD015
081540200529      ** If Concord Interface Development is installed (CCF001)                               CSD015
081550200529                                                                                              CSD015
081560200529     C                   IF        CCF001 = 'Y'                                               CSD015
081570200529                                                                                              CSD015
081580200529      ** If Corporate Customer is 'Y'                                                         CSD015
081590200529                                                                                              CSD015
081600200529     C                   IF        T_BBCRPC = 'Y'                                             CSD015
081610200529     C                   EVAL      W4CTYP = 'C'                                               CSD015
081620200529     C                   ELSE                                                                 CSD015
081630200529     C                   EVAL      W4CTYP = 'I'                                               CSD015
081640200529     C                   ENDIF                                                                CSD015
081650200529                                                                                              CSD015
081660200529     C                   ELSE                                                                 CSD015
081670200529                                                                                              CSD015
081680200529      ** If Local Industry Code is not blank or not equal to any                              CSD015
081690200529      ** of the five Private Customer Industry Code                                           CSD015
081700200529                                                                                              CSD015
081710200529     C                   IF        T_BBLICD <> *BLANKS                                        CSD015
081720200529     C                             AND T_BBLICD <> W1IND1                                     CSD015
081730200529     C                             AND T_BBLICD <> W1IND2                                     CSD015
081740200529     C                             AND T_BBLICD <> W1IND3                                     CSD015
081750200529     C                             AND T_BBLICD <> W1IND4                                     CSD015
081760200529     C                             AND T_BBLICD <> W1IND5                                     CSD015
081770200529     C                   EVAL      W4CTYP = 'C'                                               CSD015
081780200529     C                   ELSE                                                                 CSD015
081790200529     C                   EVAL      W4CTYP = 'I'                                               CSD015
081800200529     C                   ENDIF                                                                CSD015
081810200529                                                                                              CSD015
081820200529     C                   ENDIF                                                                CSD015
081830200529                                                                                              CSD015
081840200529      ** Get the Counter Party (Midas Report Name + Customer Report Town)                     CSD015
081850200529                                                                                              CSD015
081860200529     C                   MOVEL     T_BBCRNM      W4CUST                                       CSD015
081870200529     C                   MOVE      T_BBCRTN      W4CUST                                       CSD015
081880200529                                                                                              CSD015
081890200529      ** Get converted dates                                                                  CSD015
081900200529                                                                                              CSD015
081910200529     C                   MOVE      '00000'       PINDATE                                      CSD015
081920200529     C                   EXSR      SRCVTDATE                                                  CSD015
081930200529     C                   MOVE      PCVTDDATE     W4DDAT                                       CSD015
081940200529                                                                                              CSD015
081950200529     C                   MOVE      '00000'       PINDATE                                      CSD015
081960200529     C                   EXSR      SRCVTDATE                                                  CSD015
081970200529     C                   MOVE      PCVTDDATE     W4VDAT                                       CSD015
081980200529                                                                                              CSD015
081990200529     C                   MOVE      '00000'       PINDATE                                      CSD015
082000200529     C                   EXSR      SRCVTDATE                                                  CSD015
082010200529     C                   MOVE      PCVTDDATE     W4MDAT                                       CSD015
082020200529                                                                                              CSD015
082030200529      ** Set-up second parameter for Compliance Engine                                        CSD015
082040200529                                                                                              CSD015
082050200529     C                   EVAL      PDSXML = *BLANKS                                           CSD015
082060200529                                                                                              CSD015
082070200529      ** Set-up Customer Name                                                                 CSD015
082080200529                                                                                              CSD015
082090200529     C                   IF        T_BBCNA1 <> B_BBCNA1                                       CSD015
082100200529     C                             OR WUNCF1 = 'Y'                                            CSD015
082110200529     C                   IF        T_BBCNA1 <> *BLANKS                                        CSD015
082120200529     C                   CAT       ARRTAG(1):0   PDSXML                                       CSD015
082130200529     C                   CAT       T_BBCNA1:0    PDSXML                                       CSD015
082140200529     C                   CAT       ARRTAG(2):0   PDSXML                                       CSD015
082150200529     C                   ENDIF                                                                CSD015
082160200529     C                   ENDIF                                                                CSD015
082170200529                                                                                              CSD015
082180200529      ** Set-up Address Lines                                                                 CSD015
082190200529                                                                                              CSD015
082200200529     C                   IF        T_BBCNA2 <> B_BBCNA2                                       CSD015
082210200529     C                             OR T_BBCNA3 <> B_BBCNA3                                    CSD015
082220200529     C                             OR T_BBCNA4 <> B_BBCNA4                                    CSD015
082230200529     C                             OR WUNCF1 = 'Y'                                            CSD015
082240200529     C                   EVAL      WADDAL = *BLANKS                                           CSD015
082250200529     C                   CAT       T_BBCNA2:0    WADDAL                                       CSD015
082260200529     C                   CAT       T_BBCNA3:1    WADDAL                                       CSD015
082270200529     C                   CAT       T_BBCNA4:1    WADDAL                                       CSD015
082280200529     C                   IF        WADDAL <> *BLANKS                                          CSD015
082290200529     C                   CAT       ARRTAG(3):0   PDSXML                                       CSD015
082300200529     C                   CAT       WADDAL:0      PDSXML                                       CSD015
082310200529     C                   CAT       ARRTAG(4):0   PDSXML                                       CSD015
082320200529     C                   ENDIF                                                                CSD015
082330200529     C                   ENDIF                                                                CSD015
082340200529                                                                                              CSD015
082350200529      ** Set-up SWIFT Identifier                                                              CSD015
082360200529                                                                                              CSD015
082370200529     C                   IF        T_BBCSID <> B_BBCSID                                       CSD015
082380200529     C                             OR WUNCF1 = 'Y'                                            CSD015
082390200529     C                   IF        T_BBCSID <> *BLANKS                                        CSD015
082400200529     C                   CAT       ARRTAG(5):0   PDSXML                                       CSD015
082410200529     C                   CAT       T_BBCSID:0    PDSXML                                       CSD015
082420200529     C                   CAT       ARRTAG(6):0   PDSXML                                       CSD015
082430200529     C                   ENDIF                                                                CSD015
082440200529     C                   ENDIF                                                                CSD015
082450200529                                                                                              CSD015
082460200529      ** Set-up Country of Citizenship                                                        CSD015
082470200529                                                                                              CSD015
082480200529     C                   IF        T_BBCNCZ <> B_BBCNCZ                                       CSD015
082490200529     C                             OR WUNCF1 = 'Y'                                            CSD015
082500200529     C                   IF        T_BBCNCZ <> *BLANKS                                        CSD015
082510200529     C                   CAT       ARRTAG(7):0   PDSXML                                       CSD015
082520200529     C                   CAT       T_BBCNCZ:0    PDSXML                                       CSD015
082530200529     C                   CAT       ARRTAG(8):0   PDSXML                                       CSD015
082540200529     C                   ENDIF                                                                CSD015
082550200529     C                   ENDIF                                                                CSD015
082560200529                                                                                              CSD015
082570200529      ** Set-up Country of Domicile                                                           CSD015
082580200529                                                                                              CSD015
082590200529     C                   IF        T_BBCOLC <> B_BBCOLC                                       CSD015
082600200529     C                             OR WUNCF1 = 'Y'                                            CSD015
082610200529     C                   IF        T_BBCOLC <> *BLANKS                                        CSD015
082620200529     C                   CAT       ARRTAG(9):0   PDSXML                                       CSD015
082630200529     C                   CAT       T_BBCOLC:0    PDSXML                                       CSD015
082640200529     C                   CAT       ARRTAG(10):0  PDSXML                                       CSD015
082650200529     C                   ENDIF                                                                CSD015
082660200529     C                   ENDIF                                                                CSD015
082670200529                                                                                              CSD015
082680200529      ** Send transaction details to Compliance Watch                                         CSD015
082690200529                                                                                              CSD015
082700200529     C                   IF        PDSXML <> *BLANKS                                          CSD015
082710200529     C                   CALL      'SDCWLCHK'                                                 CSD015
082720200529     C                   PARM                    PDSWLTD                                      CSD015
082730200529     C                   PARM                    PDSXML                                       CSD015
082740200529     C                   ENDIF                                                                CSD015
082750200529                                                                                              CSD015
082760200529     C                   ENDSR                                                                CSD015
082770200529      *****************************************************************                       CSD015
082780200529      /EJECT                                                          *                       CSD015
082790200529      *****************************************************************                       CSD015
082800200529      *                                                               *                       CSD015
082810200529      * SrCvtDate - Convert dates to be used for Watch Engine Program *                       CSD015
082820200529      *                                                               *                       CSD015
082830200529      *****************************************************************                       CSD015
082840200529     C     SRCVTDATE     BEGSR                                                                CSD015
082850200529                                                                                              CSD015
082860200529     C                   CALLB     'ZACVTDATE'                                                CSD015
082870200529     C                   PARM      *BLANKS       PRTCD                                        CSD015
082880200529     C                   PARM                    PINDATE                                      CSD015
082890200529     C                   PARM                    POUTDATE                                     CSD015
082900200529     C                   PARM                    PCVTDDATE                                    CSD015
082910200529                                                                                              CSD015
082920200529     C                   ENDSR                                                                CSD015
082930200529                                                                                              CSD015
082940200529      *****************************************************************                       CSD015
082950200529      /EJECT                                                          *                       CSD027
082960200529      *****************************************************************                       CSD027
082970200529      *                                                               *                       CSD027
082980200529      * #@NUA -  "ADD" 1 to an alphanumeric customer number           *                       CSD027
082990200529      *                                                               *                       CSD027
083000200529      *****************************************************************                       CSD027
083010200529     C     #@NUA         BEGSR                                                                CSD027
083020200529      *                                                                                       CSD027
083030200529     C     *IN99         IFEQ      *OFF                                                       CSD027
083040200529     C                   MOVEL     'OFF'         IN99              3                          CSD027
083050200529     C                   ELSE                                                                 CSD027
083060200529     C                   MOVEL     'ON '         IN99                                         CSD027
083070200529     C                   END                                                                  CSD027
083080200529      *                                                                                       CSD027
083090200529     C                   MOVEA     #@NOA         #@CN                                         CSD027
083100200529     C                   Z-ADD     1             #@@6              2 0                        CSD027
083110200529     C                   Z-ADD     1             #@@5              2 0                        CSD027
083120200529     C                   Z-ADD     1             #@@4              2 0                        CSD027
083130200529     C                   Z-ADD     1             #@@3              2 0                        CSD027
083140200529     C                   Z-ADD     1             #@@2              2 0                        CSD027
083150200529     C                   Z-ADD     1             #@@1              2 0                        CSD027
083160200529      * Find chars                                                                            CSD027
083170200529     C     #@CN(6)       LOOKUP    #@VC(#@@6)                             99                  CSD027
083180200529     C     #@CN(5)       LOOKUP    #@VC(#@@5)                             99                  CSD027
083190200529     C     #@CN(4)       LOOKUP    #@VC(#@@4)                             99                  CSD027
083200200529     C     #@CN(3)       LOOKUP    #@VC(#@@3)                             99                  CSD027
083210200529     C     #@CN(2)       LOOKUP    #@VC(#@@2)                             99                  CSD027
083220200529     C     #@CN(1)       LOOKUP    #@VC(#@@1)                             99                  CSD027
083230200529      * Add 1 to last char                                                                    CSD027
083240200529     C                   ADD       1             #@@6                                         CSD027
083250200529     C     #@@6          IFGT      36                                                         CSD027
083260200529     C                   Z-ADD     1             #@@6                                         CSD027
083270200529     C                   ADD       1             #@@5                                         CSD027
083280200529     C                   END                                                                  CSD027
083290200529      *  Fifth char                                                                           CSD027
083300200529     C     #@@5          IFGT      36                                                         CSD027
083310200529     C                   Z-ADD     1             #@@5                                         CSD027
083320200529     C                   ADD       1             #@@4                                         CSD027
083330200529     C                   END                                                                  CSD027
083340200529      *  Fourth char                                                                          CSD027
083350200529     C     #@@4          IFGT      36                                                         CSD027
083360200529     C                   Z-ADD     1             #@@4                                         CSD027
083370200529     C                   ADD       1             #@@3                                         CSD027
083380200529     C                   END                                                                  CSD027
083390200529      *  Third char                                                                           CSD027
083400200529     C     #@@3          IFGT      36                                                         CSD027
083410200529     C                   Z-ADD     1             #@@3                                         CSD027
083420200529     C                   ADD       1             #@@2                                         CSD027
083430200529     C                   END                                                                  CSD027
083440200529      *  Second char                                                                          CSD027
083450200529     C     #@@2          IFGT      36                                                         CSD027
083460200529     C                   Z-ADD     1             #@@2                                         CSD027
083470200529     C                   ADD       1             #@@1                                         CSD027
083480200529     C                   END                                                                  CSD027
083490200529      *                                                                                       CSD027
083500200529     C                   MOVEL     #@VC(#@@1)    #@CN(1)                                      CSD027
083510200529     C                   MOVEL     #@VC(#@@2)    #@CN(2)                                      CSD027
083520200529     C                   MOVEL     #@VC(#@@3)    #@CN(3)                                      CSD027
083530200529     C                   MOVEL     #@VC(#@@4)    #@CN(4)                                      CSD027
083540200529     C                   MOVEL     #@VC(#@@5)    #@CN(5)                                      CSD027
083550200529     C                   MOVEL     #@VC(#@@6)    #@CN(6)                                      CSD027
083560200529      *                                                                                       CSD027
083570200529     C                   MOVEA     #@CN          #@NOA             6                          CSD027
083580200529     C*                                                                                       CSD027
083590200529     C     IN99          IFEQ      'OFF'                                                      CSD027
083600200529     C                   MOVEL     *OFF          *IN99                                        CSD027
083610200529     C                   ELSE                                                                 CSD027
083620200529     C                   MOVEL     *ON           *IN99                                        CSD027
083630200529     C                   END                                                                  CSD027
083640200529      *                                                                                       CSD027
083650200529     C                   ENDSR                                                                CSD027
083660200529                                                                                              CSD027
083670200529      *****************************************************************                       CSD027
083680200529      /EJECT                                                          *                       CSD027
083690200529     C****************************************************************
083700200529      *                                                               *                       CSD079
083710200529      *  TWRVGN - Retrieve Int Cust Branch - Branch Codes             *                       CSD079
083720200529      *                                                               *                       CSD079
083730200529      *****************************************************************                       CSD079
083740200529     CSR   TWRVGN        BEGSR                                                                CSD079
083750200529     C                   MOVEL     *BLANK        W0RTN                                        CSD079
083760200529     C     A_CUCUST      SETLL     @BRCHFM                                                    CSD079
083770200529     C     A_CUCUST      READE     @BRCHFM                                90                  CSD079
083780200529     C     *IN90         IFEQ      *ON                                                        CSD079
083790200529                                                                                              CSD079
083800200529      ** Data record not found                                                                CSD079
083810200529                                                                                              CSD079
083820200529     C                   MOVEL     *BLANK        W0RTN                                        CSD079
083830200529     C                   LEAVESR                                                              CSD079
083840200529     C                   END                                                                  CSD079
083850200529      *                                                                                       CSD079
083860200529     C     *IN90         DOWEQ     *OFF                                                       CSD079
083870200529                                                                                              CSD079
083880200529      ** USER: Process Data record                                                            CSD079
083890200529                                                                                              CSD079
083900200529     C                   MOVEL     *BLANK        W0RTN                                        CSD079
083910200529     C                   MOVEL     'BRANCH'      W0RTN                                        CSD079
083920200529     C     A_CUCUST      READE     @BRCHFM                                90                  CSD079
083930200529     C                   ENDDO                                                                CSD079
083940200529     C                   ENDSR                                                                CSD079
083950200529      *****************************************************************                       CSD079
083960200529      /EJECT                                                                                  CSD079
083970200529      *****************************************************************                       CSD079
083980200529      *                                                               *                       CSD079
083990200529      * UPDMID - Update Customer Marketing Info. Details if CSD079    *                       CSD079
084000200529      *          is 'Y'                                               *                       CSD079
084010200529      *                                                               *                       CSD079
084020200529      *****************************************************************                       CSD079
084030200529     C     UPDMID        BEGSR                                                                CSD079
084040200529                                                                                              CSD079
084050200529      ** Access Customer Marketing Info. Details File                                         CSD079
084060200529                                                                                              CSD079
084070200529     C                   CLEAR                   CUMIF                                        CSD079
084080200529      *                                                                                       CSD079
084090200529     C                   IF        CSD021 = 'Y'                                             BUG16705
084100200529     C                   EVAL      A_MICUST = A_CUCUST                                      BUG16705
084110200529     C                   ENDIF                                                              BUG16705
084120200529                                                                                            BUG16705
084130200529     C     A_MICUST      CHAIN     SDCMRKL0                           95                      CSD079
084140200529                                                                                              CSD079
084150200529      ** Database Error If INSERT, but record present already                                 CSD079
084160200529                                                                                              CSD079
084170200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
084180200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
084190200529     C     A_CUTYLC      ORNE      'I'                                                        CSD079
084200200529     C     *IN95         ANDEQ     *ON                                                        CSD079
084210200529     C                   MOVEL     A_MICUST      DBKEY                                        CSD079
084220200529     C                   MOVEL     'SDCMRKPD'    DBFILE                                       CSD079
084230200529     C                   MOVEL     031           DBASE                                        CSD079
084240200529     C                   EXSR      SRERR                                                      CSD079
084250200529     C                   ENDIF                                                                CSD079
084260200529      *                                                                                       CSD079
084270200529      ** Update Before Status                                                                 CSD079
084280200529                                                                                              CSD079
084290200529     C                   MOVEL(P)  CUMIF         B_CUMIF                                      CSD079
084300200529                                                                                              CSD079
084310200529      ** move values from SDVCUMI to fields of SDCMRKL0                                       CSD079
084320200529                                                                                              CSD079
084330200529     C                   EVAL      D7CUST =A_MICUST                                           CSD079
084340200529     C                   EVAL      D7GPC1 =A_MIGPC1                                           CSD079
084350200529     C                   EVAL      D7GPC2 =A_MIGPC2                                           CSD079
084360200529     C                   EVAL      D7GPC3 =A_MIGPC3                                           CSD079
084370200529     C                   EVAL      D7GPC4 =A_MIGPC4                                           CSD079
084380200529     C                   EVAL      D7GPC5 =A_MIGPC5                                           CSD079
084390200529     C                   EVAL      D7LCD  =BJRDNB                                             CSD079
084400200529     C                   EVAL      D7TYLC =A_MITYLC                                           CSD079
084410200529     C                   IF        CSD090 = 'Y'                                               CSD090
084420200529     C                   EVAL      D7CSDE = A_MICSDE                                          CSD090
084430200529     C                   ENDIF                                                                CSD090
084440200529                                                                                              CSD079
084450200529      ** Insert                                                                               CSD079
084460200529                                                                                              CSD079
084470200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
084480200529     C     *IN95         ANDEQ     *ON                                                        CSD079
084490200529      *                                                                                       CSD079
084500200529     C                   WRITE     @D7REJA                                                    CSD079
084510200529                                                                                              CSD079
084520200529      ** USER: Processing after Insert                                                        CSD079
084530200529                                                                                              CSD079
084540200529     C                   Z-ADD     1             WUNORC                                       CSD079
084550200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
084560200529     C                   Z-ADD     1             WUNOIN                                       CSD079
084570200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
084580200529      *                                                                                       CSD079
084590200529     C                   ENDIF                                                                CSD079
084600200529                                                                                              CSD079
084610200529      ** Amend                                                                                CSD079
084620200529                                                                                              CSD079
084630200529     C     A_CUTYLC      IFEQ      'A'                                                        CSD079
084640200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
084650200529      *                                                                                       CSD079
084660200529     C                   UPDATE    @D7REJA                                                    CSD079
084670200529                                                                                              CSD079
084680200529      ** USER: Processing after Update                                                        CSD079
084690200529                                                                                              CSD079
084700200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
084710200529     C                   Z-ADD     1             WUNOAM                                       CSD079
084720200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
084730200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
084740200529     C                   ENDIF                                                                CSD079
084750200529                                                                                              CSD079
084760200529      ** Delete                                                                               CSD079
084770200529                                                                                              CSD079
084780200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD079
084790200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
084800200529                                                                                              CSD079
084810200529     C                   DELETE    @D7REJA                                                    CSD079
084820200529                                                                                              CSD079
084830200529      ** USER: Processing after Delete                                                        CSD079
084840200529                                                                                              CSD079
084850200529     C                   MOVEL     B_CUMIF       WUDELR                                       CSD079
084860200529                                                                                              CSD079
084870200529      ** Write Deleted Record - SD Deleted Records File                                       CSD079
084880200529                                                                                              CSD079
084890200529     C                   CLEAR                   PBRC                                         CSD079
084900200529     C                   MOVEL     'SDCMRKPD'    PBFNME                                       CSD079
084910200529     C                   MOVEL     A_MICUST      PBLKEY                                       CSD079
084920200529     C                   MOVEL     WUDR01        PBDR01                                       CSD079
084930200529     C                   MOVEL     WUDR02        PBDR02                                       CSD079
084940200529     C                   MOVEL     WUDR03        PBDR03                                       CSD079
084950200529     C                   MOVEL     WUDR04        PBDR04                                       CSD079
084960200529     C                   MOVEL     WUDR05        PBDR05                                       CSD079
084970200529     C                   MOVEL     WUDR06        PBDR06                                       CSD079
084980200529     C                   MOVEL     WUDR07        PBDR07                                       CSD079
084990200529     C                   MOVEL     WUDR08        PBDR08                                       CSD079
085000200529     C                   MOVEL     WUDR09        PBDR09                                       CSD079
085010200529     C                   MOVEL     WUDR10        PBDR10                                       CSD079
085020200529     C                   MOVEL     WUDR11        PBDR11                                       CSD079
085030200529     C                   MOVEL     WUDR12        PBDR12                                       CSD079
085040200529     C                   MOVEL     BJRDNB        PBLCD                                        CSD079
085050200529     C                   MOVEL     'D'           PBTYLC                                       CSD079
085060200529                                                                                              CSD079
085070200529     C                   CALL      'SD0520X'                                                  CSD079
085080200529     C                   PARM      *BLANK        @RTCD                                        CSD079
085090200529     C                   PARM                    PBRC                                         CSD079
085100200529                                                                                              CSD079
085110200529      ** Error detected?                                                                      CSD079
085120200529                                                                                              CSD079
085130200529     C     @RTCD         IFEQ      '*ERROR*'                                                  CSD079
085140200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
085150200529     C                   MOVEL     A_MICUST      DBKEY                                        CSD079
085160200529     C                   MOVEL     'SDDELRL0'    DBFILE                                       CSD079
085170200529     C                   MOVEL     032           DBASE                                        CSD079
085180200529     C                   EXSR      SRERR                                                      CSD079
085190200529     C                   ENDIF                                                                CSD079
085200200529                                                                                              CSD079
085210200529     C                   Z-ADD     -1            WUNORC                                       CSD079
085220200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
085230200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
085240200529     C                   Z-ADD     1             WUNODL                                       CSD079
085250200529     C                   ENDIF                                                                CSD079
085260200529                                                                                              CSD079
085270200529      ** Change Standing Data Cont - Standing Data Controls                                   CSD079
085280200529                                                                                              CSD079
085290200529     C                   MOVEL     'SDCMRKPD'    WFLNAME                                      CSD079
085300200529     C                   EXSR      SNCHRC                                                     CSD079
085310200529      *                                                                                       CSD079
085320200529     C                   ENDSR                                                                CSD079
085330200529      *                                                                                       CSD079
085340200529      *****************************************************************                       CSD079
085350200529      /EJECT                                                                                  CSD079
085360200529      *****************************************************************                       CSD079
085370200529      *                                                               *                       CSD079
085380200529      * UPDADD - Update Customer Additional Details.                  *                       CSD079
085390200529      *                                                               *                       CSD079
085400200529      *****************************************************************                       CSD079
085410200529     C     UPDADD        BEGSR                                                                CSD079
085420200529                                                                                              CSD079
085430200529      ** Access Customer Additional Details File                                              CSD079
085440200529                                                                                              CSD079
085450200529     C                   CLEAR                   CUADF                                        CSD079
085460200529      *                                                                                       CSD079
085470200529     C                   IF        CSD021 = 'Y'                                             BUG16705
085480200529     C                   EVAL      A_ADCUST = A_CUCUST                                      BUG16705
085490200529     C                   ENDIF                                                              BUG16705
085500200529                                                                                            BUG16705
085510200529     C     A_ADCUST      CHAIN     SDACUSL0                           95                      CSD079
085520200529                                                                                              CSD079
085530200529      ** Database Error If INSERT, but record present already                                 CSD079
085540200529                                                                                              CSD079
085550200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
085560200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
085570200529     C     A_CUTYLC      ORNE      'I'                                                        CSD079
085580200529     C     *IN95         ANDEQ     *ON                                                        CSD079
085590200529     C                   MOVEL     A_ADCUST      DBKEY                                        CSD079
085600200529     C                   MOVEL     'SDACUSPD'    DBFILE                                       CSD079
085610200529     C                   MOVEL     033           DBASE                                        CSD079
085620200529     C                   EXSR      SRERR                                                      CSD079
085630200529     C                   ENDIF                                                                CSD079
085640200529                                                                                              CSD079
085650200529      ** Update Before Status                                                                 CSD079
085660200529                                                                                              CSD079
085670200529     C                   MOVEL(P)  CUADF         B_CUADF                                      CSD079
085680200529                                                                                              CSD079
085690200529      ** move values from SDVCUAD to fields of SDACUSL0                                       CSD079
085700200529                                                                                              CSD079
085710200529     C                   EVAL      E5CUST = A_ADCUST                                          CSD079
085720200529     C                   EVAL      E5LCD  = RDNB                                              CSD079
085730200529     C                   EVAL      E5TYLC = A_ADTYLC                                          CSD079
085740200529     C                   EVAL      E5ALTN = A_ADALTN                                          CSD079
085750200529     C                   EVAL      E5IDNO = A_ADIDNO                                          CSD079
085760200529     C                   EVAL      E5FXNB = A_ADFXNB                                          CSD079
085770200529     C                   EVAL      E5TXNB = A_ADTXNB                                          CSD079
085780200529     C                   EVAL      E5DOLV = A_ADDOLV                                          CSD079
085790200529     C                   EVAL      E5PRVO = A_ADPRVO                                          CSD079
085800200529     C                   EVAL      E5MDTL = A_ADMDTL                                          CSD079
085810200529     C                   EVAL      E5CNA1 = A_ADCNA1                                          CSD079
085820200529     C                   EVAL      E5CNA2 = A_ADCNA2                                          CSD079
085830200529     C                   EVAL      E5CNA3 = A_ADCNA3                                          CSD079
085840200529     C                   EVAL      E5CNA4 = A_ADCNA4                                          CSD079
085850200529     C                   EVAL      E5CWL1 = A_ADCWL1                                          CSD079
085860200529     C                   EVAL      E5CWL2 = A_ADCWL2                                          CSD079
085870200529     C                   EVAL      E5CWL3 = A_ADCWL3                                          CSD079
085880200529     C                   EVAL      E5CWL4 = A_ADCWL4                                          CSD079
085890200529     C                   EVAL      E5BRTH = A_ADBRTH                                          CSD079
085900200529     C                   EVAL      E5BRT1 = A_ADBRT1                                          CSD079
085910200529     C                   EVAL      E5BRT2 = A_ADBRT2                                          CSD079
085920200529     C                   EVAL      E5CWL5 = A_ADCWL5                                          CSD079
085930200529     C                   EVAL      E5CITY = A_ADCITY                                          CSD079
085940200529     C                   EVAL      E5ZIPC = A_ADZIPC                                          CSD079
085950200529     C                   EVAL      E5TINO = A_ADTINO                                          CSD079
085960200529     C                   EVAL      E5IDTP = A_ADIDTP                                          CSD079
085970200529     C                   EVAL      E5ISCT = A_ADISCT                                          CSD079
085980200529     C                   EVAL      E5ISDT = A_ADISDT                                          CSD079
085990200529     C                   EVAL      E5DBTH = A_ADDBTH                                          CSD079
086000200529     C                   EVAL      E5BTHC = A_ADBTHC                                          CSD079
086010200529     C                   EVAL      E5BTHT = A_ADBTHT                                          CSD079
086020200529     C                   EVAL      E5JATP = A_ADJATP                                          CSD079
086030200529     C                   EVAL      E5REPI = A_ADREPI                                          CSD079
086040200529     C                   EVAL      E5FRNT = *BLANKS                                           CSD079
086050200529     C                   EVAL      E5CSSN = A_ADCSSN                                          CSD079
086060200529     C                   EVAL      E5TMST = TimeStamp                                         CSD079
086070200529     C                   EVAL      E5FL01 = A_ADFL01                                          CSD079
086080200529     C                   EVAL      E5FL02 = A_ADFL02                                          CSD079
086090200529     C                   EVAL      E5FL03 = A_ADFL03                                          CSD079
086100200529     C                   EVAL      E5FL04 = A_ADFL04                                          CSD079
086110200529     C                   EVAL      E5FL05 = A_ADFL05                                          CSD079
086120200529     C                   EVAL      E5FL06 = A_ADFL06                                          CSD079
086130200529     C                   EVAL      E5FL07 = A_ADFL07                                          CSD079
086140200529     C                   EVAL      E5FL08 = A_ADFL08                                          CSD079
086150200529     C                   EVAL      E5FL09 = A_ADFL09                                          CSD079
086160200529     C                   EVAL      E5FL10 = A_ADFL10                                          CSD079
086170200529     C                   IF        CSW207 = 'Y' OR BGN4ST = 'Y'                             BUG14992
086180200529     C                   EVAL      E5ISCD = A_ADISCD                                        BUG14992
086190200529     C                   ELSE                                                               BUG14992
086200200529     C                   EVAL      E5ISCD = *BLANKS                                         BUG14992
086210200529     C                   ENDIF                                                              BUG14992
086220200529                                                                                              CSD079
086230200529     C                   EVAL      E5TITL = A_ADTITL                                          CER059
086240200529     C                   EVAL      E5MDNM = A_ADMDNM                                          CER059
086250200529     C                   EVAL      E5SHRF = A_ADSHRF                                          CER059
086260200529     C                   EVAL      E5PIND = A_ADPIND                                          CER059
086270200529     C                   EVAL      E5DCID = A_ADDCID                                          CER059
086280200529     C                   EVAL      E5DIPL = A_ADDIPL                                          CER059
086290200529     C                   EVAL      E5EXDT = A_ADEXDT                                          CER059
086300200529     C                   EVAL      E5EXTH = A_ADEXTH                                          CER059
086310200529     C                   EVAL      E5EADT = A_ADEADT                                          CER059
086320200529     C                   EVAL      E5EVDT = A_ADEVDT                                          CER059
086330200529     C                   EVAL      E5ETXT = A_ADETXT                                          CER059
086340200529     C                   EVAL      E5CDCL = A_ADCDCL                                          CER059
086350200529     C                   EVAL      E5S24C = A_ADS24C                                          CER059
086360200529     C                   EVAL      E5REM1 = A_ADREM1                                          CER059
086370200529     C                   EVAL      E5REM2 = A_ADREM2                                          CER059
086380200529     C                   EVAL      E5REM3 = A_ADREM3                                          CER059
086390200529     C                   EVAL      E5STCD = A_ADSTCD                                          CER059
086400200529     C                   EVAL      E5RLAF = A_ADRLAF                                          CER059
086410200529                                                                                              CER059
086420200529     C                   EVAL      E5FXCU = A_ADFXCU                                          CER059
086430200529     C                   EVAL      E5SMBR = A_ADSMBR                                          CER059
086440200529     C                   EVAL      E5SECU = A_ADSECU                                          CER059
086450200529     C                   EVAL      E5LNID = A_ADLNID                                          CER059
086460200529     C                   EVAL      E5CTYP = A_ADCTYP                                          CER059
086470200529     C                   EVAL      E5ZCFG = A_ADZCFG                                          CER059
086480200529     C                   EVAL      E5BSCC = A_ADBSCC                                          CER059
086490200529     C                   EVAL      E5ECAC = A_ADECAC                                          CER059
086500200529     C                   EVAL      E5BIST = A_ADBIST                                          CER059
086510200529     C                   EVAL      E5ABSK = A_ADABSK                                          CER059
086520200529     C                   EVAL      E5BEXT = A_ADBEXT                                          CER059
086530200529     C                   EVAL      E5RIGR = A_ADRIGR                                          CER070
086540200529     C                   EVAL      E5RECH = A_ADRECH                                          CER071
086550200529      ** Alternative Tax Identification Numbers                                               CGL132
086560200529     C                   EVAL      E5TIN2 = A_ADTIN2                                          CGL132
086570200529     C                   EVAL      E5TNC2 = A_ADTNC2                                          CGL132
086580200529     C                   EVAL      E5TIN3 = A_ADTIN3                                          CGL132
086590200529     C                   EVAL      E5TNC3 = A_ADTNC3                                          CGL132
086600200529     C                   EVAL      E5TIN4 = A_ADTIN4                                          CGL132
086610200529     C                   EVAL      E5TNC4 = A_ADTNC4                                          CGL132
086620200529     C                   EVAL      E5TIN5 = A_ADTIN5                                          CGL132
086630200529     C                   EVAL      E5TNC5 = A_ADTNC5                                          CGL132
086640200529                                                                                              CGL157
086650200529      ** Effective / Expiry Dates 1 - 10                                                      CGL157
086660200529     C                   EVAL      E5EFF1 = A_ADEFF1                                          CGL157
086670200529     C                   EVAL      E5EXP1 = A_ADEXP1                                          CGL157
086680200529     C                   EVAL      E5EFF2 = A_ADEFF2                                          CGL157
086690200529     C                   EVAL      E5EXP2 = A_ADEXP2                                          CGL157
086700200529     C                   EVAL      E5EFF3 = A_ADEFF3                                          CGL157
086710200529     C                   EVAL      E5EXP3 = A_ADEXP3                                          CGL157
086720200529     C                   EVAL      E5EFF4 = A_ADEFF4                                          CGL157
086730200529     C                   EVAL      E5EXP4 = A_ADEXP4                                          CGL157
086740200529     C                   EVAL      E5EFF5 = A_ADEFF5                                          CGL157
086750200529     C                   EVAL      E5EXP5 = A_ADEXP5                                          CGL157
086760200529                                                                                              CGL157
086770200529      ** Update the Additional field details for CGL157                                       CGL157
086780200529      ** Mailing Countries                                                                    CGL157
086790200529     C                   EVAL      E5CTR1 = A_ADCTR1                                          CGL157
086800200529     C                   EVAL      E5CTR2 = A_ADCTR2                                          CGL157
086810200529     C                   EVAL      E5CTR3 = A_ADCTR3                                          CGL157
086820200529     C                   EVAL      E5CTR4 = A_ADCTR4                                          CGL157
086830200529     C                   EVAL      E5CTR5 = A_ADCTR5                                          CGL157
086840200529      ** Phone Number Countries                                                               CGL157
086850200529     C                   EVAL      E5PHN1 = A_ADPHN1                                          CGL157
086860200529     C                   EVAL      E5PHN2 = A_ADPHN2                                          CGL157
086870200529     C                   EVAL      E5PHN3 = A_ADPHN3                                          CGL157
086880200529     C                   EVAL      E5PHN4 = A_ADPHN4                                          CGL157
086890200529     C                   EVAL      E5PHN5 = A_ADPHN5                                          CGL157
086900200529                                                                                              CGL157
086910200529      *                                                                                       CLE134
086920200529     C                   IF        CLE134 = 'Y'                                               CLE134
086930200529     C                   EVAL      E5PDCU = A_ADPDCU                                          CLE134
086940200529     C                   ENDIF                                                                CLE134
086950200529                                                                                              CER059
086960200529     C                   EVAL      E5FRNT = A_ADFRNT                                        AR971184
086970200529     C                   EVAL      E5REPA = A_ADREPA                                        AR971184
086980200529      *                                                                                       CER050
086990200529     C                   IF        CER050 = 'Y'                                               CER050
087000200529     C                   If        A_ADAPRC = *Blanks                                         CER050
087010200529     C                   EVAL      E5APRC = 'Y'                                               CER050
087020200529     C                   else                                                                 CER050
087030200529     C                   EVAL      E5APRC = A_ADAPRC                                          CER050
087040200529     C                   Endif                                                                CER050
087050200529     C                   ENDIF                                                                CER050
087060200529                                                                                            AR971184
087070200529      ** Insert                                                                               CSD079
087080200529                                                                                              CSD079
087090200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
087100200529     C     *IN95         ANDEQ     *ON                                                        CSD079
087110200529                                                                                              CSD079
087120200529      ** If enhancement CSD015 is installed and W1EWLC = 'Y'                                  CSD079
087130200529                                                                                              CSD079
087140200529     C                   IF        CSD015 = 'Y' AND                                           CSD079
087150200529     C                             W1EWLC = 'Y'                                               CSD079
087160200529                                                                                              CSD079
087170200529      ** If user is in the main system                                                        CSD079
087180200529                                                                                              CSD079
087190200529     C                   IF        CSC011 = 'N' OR                                            CSD079
087200200529     C                             CSC011 = 'Y' AND                                           CSD079
087210200529     C                             S1MAIN = LIBR                                              CSD079
087220200529                                                                                              CSD079
087230200529      ** If any of the watch list fields have been entered                                    CSD079
087240200529                                                                                              CSD079
087250200529     C                   IF        E5CNA1 <> *BLANKS  OR                                      CSD079
087260200529     C                             E5CNA2 <> *BLANKS  OR                                      CSD079
087270200529     C                             E5CNA3 <> *BLANKS  OR                                      CSD079
087280200529     C                             E5CNA4 <> *BLANKS  OR                                      CSD079
087290200529     C                             E5IDNO <> *BLANKS  OR                                      CSD079
087300200529     C                             E5BRTH <> 0                                                CSD079
087310200529                                                                                              CSD079
087320200529     C                   EXSR      SRADWTCH                                                   CSD079
087330200529                                                                                              CSD079
087340200529     C                   ENDIF                                                                CSD079
087350200529                                                                                              CSD079
087360200529     C                   ENDIF                                                                CSD079
087370200529                                                                                              CSD079
087380200529     C                   ENDIF                                                                CSD079
087390200529                                                                                              CSD079
087400200529     C                   WRITE     @ACUSL0                                                    CSD079
087410200529                                                                                              CSD092
087420200529     C                   IF        CSD092 = 'Y'                                               CSD092
087430200529     C                   IF        CGL157 = 'Y'                                               CGL157
087440200529     C                   CALL      'SD009696'                                                 CGL157
087450200529     C                   PARM      E5CUST        PCUST                                        CGL157
087460200529     C                   PARM      *BLANKS       PBefCUST                                     CGL157
087470200529     C                   PARM      CUSTDF        PAftCUST                                     CGL157
087480200529     C                   PARM      *BLANKS       PBefACUS                                     CGL157
087490200529     C                   PARM      CUADF         PAftACUS                                     CGL157
087500200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL157
087510200529     C                   PARM                    PAftFTCS                                     CGL157
087520200529     C                   PARM      *BLANKS       PBefJACC                                     CGL157
087530200529     C                   PARM      *BLANKS       PAftJACC                                     CGL157
087540200529     C                   PARM      *BLANKS       PBefCUAH                                     CGL157
087550200529     C                   PARM      *BLANKS       PAftCUAH                                     CGL157
087560200529     C                   PARM      *BLANKS       PBefCUXC                                     CGL157
087570200529     C                   PARM                    PAftCUXC                                     CGL157
087580200529     C                   PARM      *BLANKS       PACRV                                        CGL157
087590200529     C                   PARM      *BLANKS       PELEC                                        CGL157
087600200529     C                   PARM                    PBefCRSH                                     CGL157
087610200529     C                   PARM                    PAftCRSH                                     CGL157
087620200529     C                   PARM                    PBefCRSD                                     CGL157
087630200529     C                   PARM                    PAftCRSD                                     CGL157
087640200529     C                   ELSE                                                                 CGL157
087650200529     C                   CALL      'SD009696'                                                 CSD092
087660200529     C                   PARM      E5CUST        PCUST                                        CSD092
087670200529     C                   PARM      *BLANKS       PBefCUST                                     CSD092
087680200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
087690200529     C                   PARM      *BLANKS       PBefACUS                                     CSD092
087700200529     C                   PARM      CUADF         PAftACUS                                     CSD092
087710200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
087720200529     C**********         PARM      *BLANKS       PAftFTCS                            CGL132 MD026957
087730200529     C                   PARM                    PAftFTCS                                   MD026957
087740200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
087750200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
087760200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
087770200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
087780200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
087790200529     C**********         PARM      *BLANKS       PAftCUXC                          MD026854 MD026957
087800200529     C                   PARM                    PAftCUXC                                   MD026957
087810200529     C                   PARM      *BLANKS       PACRV                                        CSD092
087820200529     C                   PARM      *BLANKS       PELEC                                        CGL132
087830200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
087840200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
087850200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
087860200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
087870200529     C                   ENDIF                                                                CGL157
087880200529     C                   ENDIF                                                                CSD092
087890200529                                                                                              CSD079
087900200529     C                   ENDIF                                                                CSD079
087910200529                                                                                              CSD079
087920200529      ** Amend                                                                                CSD079
087930200529                                                                                              CSD079
087940200529     C     A_CUTYLC      IFEQ      'A'                                                        CSD079
087950200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
087960200529                                                                                              CSD079
087970200529      ** If CSD015 = 'Y' and watch list checking applied                                      CSD079
087980200529                                                                                              CSD079
087990200529     C                   IF        CSD015 = 'Y' AND                                           CSD079
088000200529     C                             W1EWLC = 'Y'                                               CSD079
088010200529                                                                                              CSD079
088020200529      ** If user is in the main system                                                        CSD079
088030200529                                                                                              CSD079
088040200529     C                   IF        CSC011 = 'N' OR                                            CSD079
088050200529     C                             CSC011 = 'Y' AND                                           CSD079
088060200529     C                             S1MAIN = LIBR                                              CSD079
088070200529                                                                                              CSD079
088080200529      ** Access SDCWHTPD using function type 'SDACUSPD', identifier                           CSD079
088090200529      ** BBCUST, and branch BBBCRD to verify Hit Unconfirmed Flag                             CSD079
088100200529                                                                                              CSD079
088110200529     C                   EVAL      WFuncType = 'SDACUSPD'                                     CSD079
088120200529     C                   EVAL      WIdntifier = A_ADCUST                                      CSD079
088130200529     C                   EVAL      WBranch = BBBRCD                                           CSD079
088140200529                                                                                              CSD079
088150200529     C     KCwFld        CHAIN     SDCWHTL1                                                   CSD079
088160200529     C                   IF        NOT %FOUND(SDCWHTL1)                                       CSD079
088170200529     C                   EVAL      WUNCF1 = 'N'                                               CSD079
088180200529     C                   ELSE                                                                 CSD079
088190200529     C                   IF        W3UNCF = 'Y'                                               CSD079
088200200529     C                   EVAL      WUNCF1 = 'Y'                                               CSD079
088210200529     C                   ENDIF                                                                CSD079
088220200529                                                                                              CSD079
088230200529     C                   ENDIF                                                                CSD079
088240200529                                                                                              CSD079
088250200529      ** If any of the watch list fields has been entered                                     CSD079
088260200529                                                                                              CSD079
088270200529     C                   IF        E5CNA1 <> B_E5CNA1  OR                                     CSD079
088280200529     C                             E5CNA2 <> B_E5CNA2  OR                                     CSD079
088290200529     C                             E5CNA3 <> B_E5CNA3  OR                                     CSD079
088300200529     C                             E5CNA4 <> B_E5CNA4  OR                                     CSD079
088310200529     C                             E5IDNO <> B_E5IDNO  OR                                     CSD079
088320200529     C                             E5BRTH <> B_E5BRTH  OR                                     CSD079
088330200529     C                             WUNCF1 = 'Y'                                               CSD079
088340200529                                                                                              CSD079
088350200529     C                   EXSR      SRADWTCH                                                   CSD079
088360200529                                                                                              CSD079
088370200529     C                   ENDIF                                                                CSD079
088380200529                                                                                              CSD079
088390200529     C                   ENDIF                                                                CSD079
088400200529                                                                                              CSD079
088410200529     C                   ENDIF                                                                CSD079
088420200529                                                                                              CSD079
088430200529     C                   UPDATE    @ACUSL0                                                    CSD079
088440200529                                                                                              CSD092
088450200529     C                   IF        CSD092 = 'Y'                                               CSD092
088460200529      ** Ensure parameters are properly populated                                           MD051563
088470200529     C                   IF        CGL132 = 'Y'                                             MD051563
088480200529     C                   EVAL      PBefFTCS = SDFTCS2                                       MD051563
088490200529     C                   EVAL      PAftFTCS = SDFTCS                                        MD051563
088500200529     C                   ELSE                                                               MD051563
088510200529     C                   EVAL      PBefFTCS = *BLANKS                                       MD051563
088520200529     C                   EVAL      PAftFTCS = *BLANKS                                       MD051563
088530200529     C                   ENDIF                                                              MD051563
088540200529     C                   IF        CGL157 = 'N'                                             MD051563
088550200529     C                   EVAL      PBefCRSH = *BLANKS                                       MD051563
088560200529     C                   EVAL      PAftCRSH = *BLANKS                                       MD051563
088570200529     C                   EVAL      PBefCRSD = *BLANKS                                       MD051563
088580200529     C                   EVAL      PAftCRSD = *BLANKS                                       MD051563
088590200529     C                   ENDIF                                                              MD051563
088600200529      *                                                                                     MD051563
088610200529     C                   CALL      'SD009696'                                                 CSD092
088620200529     C                   PARM      E5CUST        PCUST                                        CSD092
088630200529     C                   PARM      B_CUSTD       PBefCUST                                     CSD092
088640200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
088650200529     C                   PARM      B_CUADF       PBefACUS                                     CSD092
088660200529     C                   PARM      CUADF         PAftACUS                                     CSD092
088670200529     C**********         PARM      *BLANKS       PBefFTCS                            CGL132 MD026957
088680200529     C**********         PARM      *BLANKS       PAftFTCS                            CGL132 MD026957
088690200529     C                   PARM                    PBefFTCS                                   MD026957
088700200529     C                   PARM                    PAftFTCS                                   MD026957
088710200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
088720200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
088730200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
088740200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
088750200529     C                   PARM                    PBefCUXC                                   MD026957
088760200529     C                   PARM                    PAftCUXC                                   MD026957
088770200529     C                   PARM      *BLANKS       PACRV                                        CSD092
088780200529     C                   PARM      *BLANKS       PELEC                                        CGL132
088790200529     C**********         PARM      *BLANKS       PBefCRSH                            CGL177 MD051563
088800200529     C**********         PARM      *BLANKS       PAftCRSH                            CGL177 MD051563
088810200529     C**********         PARM      *BLANKS       PBefCRSD                            CGL177 MD051563
088820200529     C**********         PARM      *BLANKS       PAftCRSD                            CGL177 MD051563
088830200529     C                   PARM                    PBefCRSH                                   MD051563
088840200529     C                   PARM                    PAftCRSH                                   MD051563
088850200529     C                   PARM                    PBefCRSD                                   MD051563
088860200529     C                   PARM                    PAftCRSD                                   MD051563
088870200529     C                   ENDIF                                                                CSD092
088880200529                                                                                              CSD079
088890200529     C                   ENDIF                                                                CSD079
088900200529                                                                                              CSD079
088910200529                                                                                              CSD079
088920200529      ** Delete                                                                               CSD079
088930200529                                                                                              CSD079
088940200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD079
088950200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
088960200529                                                                                              CSD079
088970200529     C                   DELETE    @ACUSL0                                                    CSD079
088980200529                                                                                              CSD092
088990200529     C                   IF        CSD092 = 'Y'                                               CSD092
089000200529     C                   CALL      'SD009696'                                                 CSD092
089010200529     C                   PARM      E5CUST        PCUST                                        CSD092
089020200529     C                   PARM      B_CUSTD       PBefCUST                                     CSD092
089030200529     C                   PARM      CUSTDF        PAftCUST                                     CSD092
089040200529     C                   PARM      *BLANKS       PBefACUS                                     CSD092
089050200529     C                   PARM      CUADF         PAftACUS                                     CSD092
089060200529     C                   PARM      *BLANKS       PBefFTCS                                     CGL132
089070200529     C                   PARM      *BLANKS       PAftFTCS                                     CGL132
089080200529     C                   PARM      *BLANKS       PBefJACC                                     CSD092
089090200529     C                   PARM      *BLANKS       PAftJACC                                     CSD092
089100200529     C                   PARM      *BLANKS       PBefCUAH                                     CSD092
089110200529     C                   PARM      *BLANKS       PAftCUAH                                     CSD092
089120200529     C                   PARM      *BLANKS       PBefCUXC                                   MD026854
089130200529     C                   PARM      *BLANKS       PAftCUXC                                   MD026854
089140200529     C                   PARM      *BLANKS       PACRV                                        CSD092
089150200529     C                   PARM      *BLANKS       PELEC                                        CGL132
089160200529     C                   PARM      *BLANKS       PBefCRSH                                     CGL177
089170200529     C                   PARM      *BLANKS       PAftCRSH                                     CGL177
089180200529     C                   PARM      *BLANKS       PBefCRSD                                     CGL177
089190200529     C                   PARM      *BLANKS       PAftCRSD                                     CGL177
089200200529     C                   ENDIF                                                                CSD092
089210200529                                                                                              CSD079
089220200529      ** USER: Processing after Delete                                                        CSD079
089230200529                                                                                              CSD079
089240200529     C                   MOVEL     B_CUADF       WUDELR                                       CSD079
089250200529                                                                                              CSD079
089260200529      ** Write Deleted Record - SD Deleted Records File                                       CSD079
089270200529                                                                                              CSD079
089280200529     C                   CLEAR                   PBRC                                         CSD079
089290200529     C                   MOVEL     'SDACUSPD'    PBFNME                                       CSD079
089300200529     C                   MOVEL     A_ADCUST      PBLKEY                                       CSD079
089310200529     C                   MOVEL     WUDR01        PBDR01                                       CSD079
089320200529     C                   MOVEL     WUDR02        PBDR02                                       CSD079
089330200529     C                   MOVEL     WUDR03        PBDR03                                       CSD079
089340200529     C                   MOVEL     WUDR04        PBDR04                                       CSD079
089350200529     C                   MOVEL     WUDR05        PBDR05                                       CSD079
089360200529     C                   MOVEL     WUDR06        PBDR06                                       CSD079
089370200529     C                   MOVEL     WUDR07        PBDR07                                       CSD079
089380200529     C                   MOVEL     WUDR08        PBDR08                                       CSD079
089390200529     C                   MOVEL     WUDR09        PBDR09                                       CSD079
089400200529     C                   MOVEL     WUDR10        PBDR10                                       CSD079
089410200529     C                   MOVEL     WUDR11        PBDR11                                       CSD079
089420200529     C                   MOVEL     WUDR12        PBDR12                                       CSD079
089430200529     C                   MOVEL     RDNB          PBLCD                                        CSD079
089440200529     C                   MOVEL     'D'           PBTYLC                                       CSD079
089450200529                                                                                              CSD079
089460200529     C                   CALL      'SD0520X'                                                  CSD079
089470200529     C                   PARM      *BLANK        @RTCD                                        CSD079
089480200529     C                   PARM                    PBRC                                         CSD079
089490200529                                                                                              CSD079
089500200529      ** Error detected?                                                                      CSD079
089510200529                                                                                              CSD079
089520200529     C     @RTCD         IFEQ      '*ERROR*'                                                  CSD079
089530200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
089540200529     C                   MOVEL     A_ADCUST      DBKEY                                        CSD079
089550200529     C                   MOVEL     'SDDELRL0'    DBFILE                                       CSD079
089560200529     C                   MOVEL     034           DBASE                                        CSD079
089570200529     C                   EXSR      SRERR                                                      CSD079
089580200529     C                   ENDIF                                                                CSD079
089590200529                                                                                              CSD079
089600200529     C                   ENDIF                                                                CSD079
089610200529                                                                                              CSD079
089620200529     C                   ENDSR                                                                CSD079
089630200529                                                                                              CSD079
089640200529      *****************************************************************                       CSD079
089650200529      /EJECT                                                                                  CSD079
089660200529      *****************************************************************                       CSD079
089670200529      *                                                               *                       CSD079
089680200529      *  UPDSFD - Update Customer Service Fees Details                *                       CSD079
089690200529      *                                                               *                       CSD079
089700200529      *****************************************************************                       CSD079
089710200529     C     UPDSFD        BEGSR                                                                CSD079
089720200529                                                                                              CSD079
089730200529      ** Access Customer Service Fees Details File                                            CSD079
089740200529                                                                                              CSD079
089750200529     C                   CLEAR                   CUFEF                                        CSD079
089760200529      *                                                                                       CSD079
089770200529     C                   IF        CSD021 = 'Y'                                             BUG16705
089780200529     C                   EVAL      F_SFCUST = A_CUCUST                                      BUG16705
089790200529     C                   ENDIF                                                              BUG16705
089800200529                                                                                            BUG16705
089810200529     C     F_SFCUST      CHAIN     SDCFCDL0                           95                      CSD079
089820200529                                                                                              CSD079
089830200529      ** Check if INSERT or AMEND                                                            BG12238
089840200529                                                                                             BG12238
089850200529     C     F_SFTYLC      IFNE      'D'                                                       BG12238
089860200529     C     *IN95         IFEQ      '1'                                                       BG12238
089870200529     C                   MOVEL     'I'           F_SFTYLC                                    BG12238
089880200529     C                   ELSE                                                                BG12238
089890200529      *                                                                                      BG12238
089900200529     C                   MOVEL     'A'           F_SFTYLC                                    BG12238
089910200529     C                   ENDIF                                                               BG12238
089920200529     C                   ENDIF                                                               BG12238
089930200529      ***Database Error If INSERT, but record present already                         CRE026 BG12238
089940200529      **********                                                                      CRE026 BG12238
089950200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
089960200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
089970200529     C*****A_CUTYLC      ORNE      'I'                                                CRE026 BG12238
089980200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
089990200529     C**********         MOVEL     F_SFCUST      DBKEY                                CRE026 BG12238
090000200529     C**********         MOVEL     'SDCFCDPD'    DBFILE                 ************  CRE026 BG12238
090010200529     C**********         MOVEL     035           DBASE                  * DBERR 035*  CRE026 BG12238
090020200529     C**********         EXSR      SRERR                                ************  CRE026 BG12238
090030200529     C**********         ENDIF                                                        CRE026 BG12238
090040200529                                                                                              CSD079
090050200529      ** Update Before Status                                                                 CSD079
090060200529                                                                                              CSD079
090070200529     C                   MOVEL(P)  CUFEF         B_CUFEF                                      CSD079
090080200529                                                                                              CSD079
090090200529      ** move values from SDVCUFE to fields of SDCFCDL0                                       CSD079
090100200529                                                                                              CSD079
090110200529     C                   EVAL      E6CUST = F_SFCUST                                          CSD079
090120200529     C                   EVAL      E6LCD  = RDNB                                              CSD079
090130200529     C                   EVAL      E6TYLC = F_SFTYLC                                          CSD079
090140200529     C                   EVAL      E6HMIN = F_SFHMIN                                          CSD079
090150200529     C                   EVAL      E6NAIN = F_SFNAIN                                          CSD079
090160200529     C                   EVAL      E6SMAC = F_SFSMAC                                          CSD079
090170200529     C                   EVAL      E6SBCH = F_SFSBCH                                          CSD079
090180200529     C                   EVAL      E6SCCY = F_SFSCCY                                          CSD079
090190200529     C                   EVAL      E6PFCD = F_SFPFCD                                          CSD079
090200200529     C                   EVAL      E6PCAC = F_SFPCAC                                          CSD079
090210200529     C                   EVAL      E6PCHM = F_SFPCHM                                          CSD079
090220200529     C                   EVAL      E6TAIF = F_SFTAIF                                          CSD079
090230200529                                                                                              CSD079
090240200529      ** Insert                                                                               CSD079
090250200529                                                                                              CSD079
090260200529     C     F_SFTYLC      IFEQ      'I'                                                       BG12238
090270200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
090280200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
090290200529                                                                                              CRE079
090300200529     C                   WRITE     @CFCDL0                                                    CSD079
090310200529                                                                                              CSD079
090320200529      ** USER: Processing after Insert                                                        CSD079
090330200529                                                                                              CSD079
090340200529     C                   Z-ADD     1             WUNORC                                       CSD079
090350200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
090360200529     C                   Z-ADD     1             WUNOIN                                       CSD079
090370200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
090380200529                                                                                              CSD079
090390200529     C                   ENDIF                                                                CSD079
090400200529                                                                                              CSD079
090410200529      ** Amend                                                                                CSD079
090420200529                                                                                              CSD079
090430200529     C     F_SFTYLC      IFEQ      'A'                                                       BG12238
090440200529     C*****A_CUTYLC      IFEQ      'A'                                                CRE026 BG12238
090450200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
090460200529                                                                                              CSD079
090470200529     C                   UPDATE    @CFCDL0                                                    CSD079
090480200529                                                                                              CSD079
090490200529      ** USER: Processing after Update                                                        CSD079
090500200529                                                                                              CSD079
090510200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
090520200529     C                   Z-ADD     1             WUNOAM                                       CSD079
090530200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
090540200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
090550200529     C                   ENDIF                                                                CSD079
090560200529                                                                                              CSD079
090570200529      ** Delete                                                                               CSD079
090580200529                                                                                              CSD079
090590200529     C     F_SFTYLC      IFEQ      'D'                                                       BG12238
090600200529     C*****A_CUTYLC      IFEQ      'D'                                                CRE026 BG12238
090610200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
090620200529                                                                                              CSD079
090630200529     C                   DELETE    @CFCDL0                                                    CSD079
090640200529                                                                                              CSD079
090650200529      ** USER: Processing after Delete                                                        CSD079
090660200529                                                                                              CSD079
090670200529     C                   MOVEL     B_CUFEF       WUDELR                                       CSD079
090680200529                                                                                              CSD079
090690200529      ** Write Deleted Record - SD Deleted Records File                                       CSD079
090700200529                                                                                              CSD079
090710200529     C                   CLEAR                   PBRC                                         CSD079
090720200529     C                   MOVEL     'SDCFCDPD'    PBFNME                                       CSD079
090730200529     C                   MOVEL     F_SFCUST      PBLKEY                                       CSD079
090740200529     C                   MOVEL     WUDR01        PBDR01                                       CSD079
090750200529     C                   MOVEL     WUDR02        PBDR02                                       CSD079
090760200529     C                   MOVEL     WUDR03        PBDR03                                       CSD079
090770200529     C                   MOVEL     WUDR04        PBDR04                                       CSD079
090780200529     C                   MOVEL     WUDR05        PBDR05                                       CSD079
090790200529     C                   MOVEL     WUDR06        PBDR06                                       CSD079
090800200529     C                   MOVEL     WUDR07        PBDR07                                       CSD079
090810200529     C                   MOVEL     WUDR08        PBDR08                                       CSD079
090820200529     C                   MOVEL     WUDR09        PBDR09                                       CSD079
090830200529     C                   MOVEL     WUDR10        PBDR10                                       CSD079
090840200529     C                   MOVEL     WUDR11        PBDR11                                       CSD079
090850200529     C                   MOVEL     WUDR12        PBDR12                                       CSD079
090860200529     C                   MOVEL     RDNB          PBLCD                                        CSD079
090870200529     C                   MOVEL     'D'           PBTYLC                                       CSD079
090880200529                                                                                              CSD079
090890200529     C                   CALL      'SD0520X'                                                  CSD079
090900200529     C                   PARM      *BLANK        @RTCD                                        CSD079
090910200529     C                   PARM                    PBRC                                         CSD079
090920200529                                                                                              CSD079
090930200529      ** Error detected?                                                                      CSD079
090940200529                                                                                              CSD079
090950200529     C     @RTCD         IFEQ      '*ERROR*'                                                  CSD079
090960200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
090970200529     C                   MOVEL     F_SFCUST      DBKEY                                        CSD079
090980200529     C                   MOVEL     'SDDELRL0'    DBFILE                                       CSD079
090990200529     C                   MOVEL     036           DBASE                                        CSD079
091000200529     C                   EXSR      SRERR                                                      CSD079
091010200529     C                   ENDIF                                                                CSD079
091020200529                                                                                              CSD079
091030200529     C                   Z-ADD     -1            WUNORC                                       CSD079
091040200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
091050200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
091060200529     C                   Z-ADD     1             WUNODL                                       CSD079
091070200529     C                   ENDIF                                                                CSD079
091080200529                                                                                              CSD079
091090200529      ** Change Standing Data Cont - Standing Data Controls                                   CSD079
091100200529                                                                                              CSD079
091110200529     C                   MOVEL     'SDCFCDPD'    WFLNAME                                      CSD079
091120200529     C                   EXSR      SNCHRC                                                     CSD079
091130200529                                                                                              CSD079
091140200529     C                   ENDSR                                                                CSD079
091150200529                                                                                              CSD079
091160200529      *****************************************************************                       CSD079
091170200529      /EJECT                                                                                  CSD079
091180200529      *****************************************************************                       CSD079
091190200529      *                                                               *                       CSD079
091200200529      * UPDCQD - Update Cheques & Cards Details                       *                       CSD079
091210200529      *                                                               *                       CSD079
091220200529      *****************************************************************                       CSD079
091230200529     C     UPDCQD        BEGSR                                                                CSD079
091240200529                                                                                              CSD079
091250200529      ** Access Cheques & Cards Details File                                                  CSD079
091260200529                                                                                              CSD079
091270200529     C                   CLEAR                   CUCQF                                        CSD079
091280200529      *                                                                                       CSD079
091290200529     C                   IF        CSD021 = 'Y'                                             BUG16705
091300200529     C                   EVAL      A_CCCUST = A_CUCUST                                      BUG16705
091310200529     C                   ENDIF                                                              BUG16705
091320200529                                                                                            BUG16705
091330200529     C     A_CCCUST      CHAIN     SDCHEQPF                           95                      CSD079
091340200529                                                                                              CSD079
091350200529      ** Database Error                                                                       CSD079
091360200529                                                                                              CSD079
091370200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
091380200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
091390200529     C     A_CUTYLC      ORNE      'I'                                                        CSD079
091400200529     C     *IN95         ANDEQ     *ON                                                        CSD079
091410200529     C                   MOVEL     A_CCCUST      DBKEY                                        CSD079
091420200529     C                   MOVEL     'SDCHEQPD'    DBFILE                                       CSD079
091430200529     C                   MOVEL     037           DBASE                                        CSD079
091440200529     C                   EXSR      SRERR                                                      CSD079
091450200529     C                   ENDIF                                                                CSD079
091460200529                                                                                              CSD079
091470200529      ** Update Before Status                                                                 CSD079
091480200529                                                                                              CSD079
091490200529     C                   MOVEL(P)  CUCQF         B_CUCQF                                      CSD079
091500200529                                                                                              CSD079
091510200529      ** Move fields to SDCHEQPF which are common for Insert, Amend &                         CSD079
091520200529      ** Delete                                                                               CSD079
091530200529                                                                                              CSD079
091540200529     C                   EVAL      SCRECI = A_CCRECI                                          CSD079
091550200529     C                   TIME                    SCTLUP                                       CSD079
091560200529     C                   EVAL      SCDLUP = W_DLUP                                            CSD079
091570200529     C                   EVAL      SCMLUP = W_MLUP                                            CSD079
091580200529     C                   EVAL      SCYLUP = W_YLUP                                            CSD079
091590200529     C                   EVAL      SCCHTP = A_CCCHTP                                          CSD079
091600200529     C                   EVAL      SCLCD  = BJRDNB                                            CSD079
091610200529     C                   EVAL      SCTNLU = A_CCTNLU                                          CSD079
091620200529     C                   EVAL      SCCUST = A_CCCUST                                          CSD079
091630200529     C                   EVAL      SCCSSN = A_CCCSSN                                          CSD079
091640200529     C                   EVAL      SCCRNM = A_CCCRNM                                          CSD079
091650200529     C                   EVAL      SCCRTN = A_CCCRTN                                          CSD079
091660200529     C                   EVAL      SCCAC1 = A_CCCAC1                                          CSD079
091670200529     C                   EVAL      SCDIS1 = A_CCDIS1                                          CSD079
091680200529     C                   EVAL      SCDRE1 = A_CCDRE1                                          CSD079
091690200529     C                   EVAL      SCCAC2 = A_CCCAC2                                          CSD079
091700200529     C                   EVAL      SCDIS2 = A_CCDIS2                                          CSD079
091710200529     C                   EVAL      SCDRE2 = A_CCDRE2                                          CSD079
091720200529     C                   EVAL      SCCAC3 = A_CCCAC3                                          CSD079
091730200529     C                   EVAL      SCDIS3 = A_CCDIS3                                          CSD079
091740200529     C                   EVAL      SCDRE3 = A_CCDRE3                                          CSD079
091750200529     C                   EVAL      SCCAC4 = A_CCCAC4                                          CSD079
091760200529     C                   EVAL      SCDIS4 = A_CCDIS4                                          CSD079
091770200529     C                   EVAL      SCDRE4 = A_CCDRE4                                          CSD079
091780200529     C                   EVAL      SCCAC5 = A_CCCAC5                                          CSD079
091790200529     C                   EVAL      SCDIS5 = A_CCDIS5                                          CSD079
091800200529     C                   EVAL      SCDRE5 = A_CCDRE5                                          CSD079
091810200529     C                   EVAL      SCCTX1 = A_CCCTX1                                          CSD079
091820200529     C                   EVAL      SCCQF1 = A_CCCQF1                                          CSD079
091830200529     C                   EVAL      SCCQT1 = A_CCCQT1                                          CSD079
091840200529     C                   EVAL      SCCQQ1 = A_CCCQQ1                                          CSD079
091850200529     C                   EVAL      SCCQI1 = A_CCCQI1                                          CSD079
091860200529     C                   EVAL      SCCQF2 = A_CCCQF2                                          CSD079
091870200529     C                   EVAL      SCCQT2 = A_CCCQT2                                          CSD079
091880200529     C                   EVAL      SCCQQ2 = A_CCCQQ2                                          CSD079
091890200529     C                   EVAL      SCCQI2 = A_CCCQI2                                          CSD079
091900200529     C                   EVAL      SCCQF3 = A_CCCQF3                                          CSD079
091910200529     C                   EVAL      SCCQT3 = A_CCCQT3                                          CSD079
091920200529     C                   EVAL      SCCQQ3 = A_CCCQQ3                                          CSD079
091930200529     C                   EVAL      SCCQI3 = A_CCCQI3                                          CSD079
091940200529     C                   EVAL      SCCQF4 = A_CCCQF4                                          CSD079
091950200529     C                   EVAL      SCCQT4 = A_CCCQT4                                          CSD079
091960200529     C                   EVAL      SCCQQ4 = A_CCCQQ4                                          CSD079
091970200529     C                   EVAL      SCCQI4 = A_CCCQI4                                          CSD079
091980200529     C                   EVAL      SCCQF5 = A_CCCQF5                                          CSD079
091990200529     C                   EVAL      SCCQT5 = A_CCCQT5                                          CSD079
092000200529     C                   EVAL      SCCQQ5 = A_CCCQQ5                                          CSD079
092010200529     C                   EVAL      SCCQI5 = A_CCCQI5                                          CSD079
092020200529     C                   EVAL      SCCTX2 = A_CCCTX2                                          CSD079
092030200529     C                   EVAL      SCCAN1 = A_CCCAN1                                          CSD079
092040200529     C                   EVAL      SCCAL1 = A_CCCAL1                                          CSD079
092050200529     C                   EVAL      SCCAI1 = A_CCCAI1                                          CSD079
092060200529     C                   EVAL      SCCAE1 = A_CCCAE1                                          CSD079
092070200529     C                   EVAL      SCCAN2 = A_CCCAN2                                          CSD079
092080200529     C                   EVAL      SCCAL2 = A_CCCAL2                                          CSD079
092090200529     C                   EVAL      SCCAI2 = A_CCCAI2                                          CSD079
092100200529     C                   EVAL      SCCAE2 = A_CCCAE2                                          CSD079
092110200529     C                   EVAL      SCCAN3 = A_CCCAN3                                          CSD079
092120200529     C                   EVAL      SCCAL3 = A_CCCAL3                                          CSD079
092130200529     C                   EVAL      SCCAI3 = A_CCCAI3                                          CSD079
092140200529     C                   EVAL      SCCAE3 = A_CCCAE3                                          CSD079
092150200529     C                   EVAL      SCCAN4 = A_CCCAN4                                          CSD079
092160200529     C                   EVAL      SCCAL4 = A_CCCAL4                                          CSD079
092170200529     C                   EVAL      SCCAI4 = A_CCCAI4                                          CSD079
092180200529     C                   EVAL      SCCAE4 = A_CCCAE4                                          CSD079
092190200529     C                   EVAL      SCCAN5 = A_CCCAN5                                          CSD079
092200200529     C                   EVAL      SCCAL5 = A_CCCAL5                                          CSD079
092210200529     C                   EVAL      SCCAI5 = A_CCCAI5                                          CSD079
092220200529     C                   EVAL      SCCAE5 = A_CCCAE5                                          CSD079
092230200529                                                                                              CSD079
092240200529      ** Insert Processing                                                                    CSD079
092250200529                                                                                              CSD079
092260200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
092270200529     C     *IN95         ANDEQ     *ON                                                        CSD079
092280200529                                                                                              CSD079
092290200529      ** Move fields for Insert                                                               CSD079
092300200529                                                                                              CSD079
092310200529     C                   WRITE     SDCHEQPF                                                   CSD079
092320200529                                                                                              CSD079
092330200529      ** USER: Processing after Insert                                                        CSD079
092340200529                                                                                              CSD079
092350200529     C                   Z-ADD     1             WUNORC                                       CSD079
092360200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
092370200529     C                   Z-ADD     1             WUNOIN                                       CSD079
092380200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
092390200529      *                                                                                       CSD079
092400200529     C                   ENDIF                                                                CSD079
092410200529                                                                                              CSD079
092420200529      ** Amend Processing                                                                     CSD079
092430200529                                                                                              CSD079
092440200529     C     A_CUTYLC      IFEQ      'A'                                                        CSD079
092450200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
092460200529                                                                                              CSD079
092470200529      ** Move fields for Amend                                                                CSD079
092480200529                                                                                              CSD079
092490200529     C                   UPDATE    SDCHEQPF                                                   CSD079
092500200529                                                                                              CSD079
092510200529      ** USER: Processing after Update                                                        CSD079
092520200529                                                                                              CSD079
092530200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
092540200529     C                   Z-ADD     1             WUNOAM                                       CSD079
092550200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
092560200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
092570200529                                                                                              CSD079
092580200529     C                   ENDIF                                                                CSD079
092590200529                                                                                              CSD079
092600200529      ** Delete Processing                                                                    CSD079
092610200529      ** Database Error If Delete, but record not present                                     CSD079
092620200529                                                                                              CSD079
092630200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD079
092640200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
092650200529                                                                                              CSD079
092660200529      ** Move fields for Delete                                                               CSD079
092670200529                                                                                              CSD079
092680200529     C                   UPDATE    SDCHEQPF                                                   CSD079
092690200529                                                                                              CSD079
092700200529     C                   Z-ADD     -1            WUNORC                                       CSD079
092710200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
092720200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
092730200529     C                   Z-ADD     1             WUNODL                                       CSD079
092740200529     C                   ENDIF                                                                CSD079
092750200529                                                                                              CSD079
092760200529      ** Change Standing Data Cont - Standing Data Controls                                   CSD079
092770200529                                                                                              CSD079
092780200529     C                   MOVEL     'SDCHEQPD'    WFLNAME                                      CSD079
092790200529     C                   EXSR      SNCHRC                                                     CSD079
092800200529                                                                                              CSD079
092810200529     C                   ENDSR                                                                CSD079
092820200529                                                                                              CSD079
092830200529      *****************************************************************                       CSD079
092840200529      /EJECT                                                                                  CSD079
092850200529      *****************************************************************                       CSD079
092860200529      *                                                               *                       CSD079
092870200529      *  UPDSAD - Update Customer Safes Details                       *                       CSD079
092880200529      *                                                               *                       CSD079
092890200529      *****************************************************************                       CSD079
092900200529     C     UPDSAD        BEGSR                                                                CSD079
092910200529                                                                                              CSD079
092920200529      ** Access Customer Safes Details File                                                   CSD079
092930200529                                                                                              CSD079
092940200529     C                   CLEAR                   CUSFF                                        CSD079
092950200529                                                                                              CSD079
092960200529     C                   IF        CSD021 = 'Y'                                             BUG16705
092970200529     C                   EVAL      A_SFCUST = A_CUCUST                                      BUG16705
092980200529     C                   ENDIF                                                              BUG16705
092990200529                                                                                            BUG16705
093000200529     C     A_SFCUST      CHAIN     SDSAFEL0                           95                      CSD079
093010200529                                                                                              CSD079
093020200529      ** Database Error If INSERT, but record present already                                 CSD079
093030200529                                                                                              CSD079
093040200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
093050200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
093060200529     C     A_CUTYLC      ORNE      'I'                                                        CSD079
093070200529     C     *IN95         ANDEQ     *ON                                                        CSD079
093080200529     C                   MOVEL     A_SFCUST      DBKEY                                        CSD079
093090200529     C                   MOVEL     'SDSAFEPD'    DBFILE                                       CSD079
093100200529     C                   MOVEL     038           DBASE                                        CSD079
093110200529     C                   EXSR      SRERR                                                      CSD079
093120200529     C                   ENDIF                                                                CSD079
093130200529                                                                                              CSD079
093140200529      ** Update Before Status                                                                 CSD079
093150200529                                                                                              CSD079
093160200529     C                   MOVEL(P)  CUSFF         B_CUSFF                                      CSD079
093170200529                                                                                              CSD079
093180200529      ** move values from SDVCUSF to fields of SDSAFEL0                                       CSD079
093190200529                                                                                              CSD079
093200200529     C                   EVAL      SARECI = A_SFRECI                                          CSD079
093210200529     C                   TIME                    SATLUP                                       CSD079
093220200529     C                   EVAL      SADLUP = W_DLUP                                            CSD079
093230200529     C                   EVAL      SAMLUP = W_MLUP                                            CSD079
093240200529     C                   EVAL      SAYLUP = W_YLUP                                            CSD079
093250200529     C                   EVAL      SACHTP = A_SFCHTP                                          CSD079
093260200529     C                   EVAL      SALCD  = BJRDNB                                            CSD079
093270200529     C                   EVAL      SATNLU = A_SFTNLU                                          CSD079
093280200529     C                   EVAL      SACUST = A_SFCUST                                          CSD079
093290200529     C                   EVAL      SACSSN = A_SFCSSN                                          CSD079
093300200529     C                   EVAL      SACRNM = A_SFCRNM                                          CSD079
093310200529     C                   EVAL      SACRTN = A_SFCRTN                                          CSD079
093320200529     C                   EVAL      SASFN1 = A_SFSFN1                                          CSD079
093330200529     C                   EVAL      SASFS1 = A_SFSFS1                                          CSD079
093340200529     C                   EVAL      SASFI1 = A_SFSFI1                                          CSD079
093350200529     C                   EVAL      SASFN2 = A_SFSFN2                                          CSD079
093360200529     C                   EVAL      SASFS2 = A_SFSFS2                                          CSD079
093370200529     C                   EVAL      SASFI2 = A_SFSFI2                                          CSD079
093380200529     C                   EVAL      SASFN3 = A_SFSFN3                                          CSD079
093390200529     C                   EVAL      SASFS3 = A_SFSFS3                                          CSD079
093400200529     C                   EVAL      SASFI3 = A_SFSFI3                                          CSD079
093410200529     C                   EVAL      SASFN4 = A_SFSFN4                                          CSD079
093420200529     C                   EVAL      SASFS4 = A_SFSFS4                                          CSD079
093430200529     C                   EVAL      SASFI4 = A_SFSFI4                                          CSD079
093440200529     C                   EVAL      SASFN5 = A_SFSFN5                                          CSD079
093450200529     C                   EVAL      SASFS5 = A_SFSFS5                                          CSD079
093460200529     C                   EVAL      SASFI5 = A_SFSFI5                                          CSD079
093470200529                                                                                              CSD079
093480200529      ** Insert                                                                               CSD079
093490200529                                                                                              CSD079
093500200529     C     A_CUTYLC      IFEQ      'I'                                                        CSD079
093510200529     C     *IN95         ANDEQ     *ON                                                        CSD079
093520200529     C                   WRITE     SDSAFEPF                                                   CSD079
093530200529      *                                                                                       CSD079
093540200529      ** USER: Processing after Insert                                                        CSD079
093550200529      *                                                                                       CSD079
093560200529     C                   Z-ADD     1             WUNORC                                       CSD079
093570200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
093580200529     C                   Z-ADD     1             WUNOIN                                       CSD079
093590200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
093600200529                                                                                              CSD079
093610200529     C                   ENDIF                                                                CSD079
093620200529                                                                                              CSD079
093630200529      ** Amend                                                                                CSD079
093640200529                                                                                              CSD079
093650200529     C     A_CUTYLC      IFEQ      'A'                                                        CSD079
093660200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
093670200529                                                                                              CSD079
093680200529     C                   UPDATE    SDSAFEPF                                                   CSD079
093690200529                                                                                              CSD079
093700200529      ** USER: Processing after Update                                                        CSD079
093710200529                                                                                              CSD079
093720200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
093730200529     C                   Z-ADD     1             WUNOAM                                       CSD079
093740200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
093750200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
093760200529     C                   ENDIF                                                                CSD079
093770200529                                                                                              CSD079
093780200529      ** Delete                                                                               CSD079
093790200529                                                                                              CSD079
093800200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD079
093810200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
093820200529                                                                                              CSD079
093830200529     C                   UPDATE    SDSAFEPF                                                   CSD079
093840200529                                                                                              CSD079
093850200529      ** USER: Processing after Delete                                                        CSD079
093860200529                                                                                              CSD079
093870200529     C                   MOVEL     B_CUFOF       WUDELR                                       CSD079
093880200529                                                                                              CSD079
093890200529     C                   Z-ADD     -1            WUNORC                                       CSD079
093900200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
093910200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
093920200529     C                   Z-ADD     1             WUNODL                                       CSD079
093930200529     C                   ENDIF                                                                CSD079
093940200529                                                                                              CSD079
093950200529      ** Change Standing Data Cont - Standing Data Controls                                   CSD079
093960200529                                                                                              CSD079
093970200529     C                   MOVEL     'SDSAFEPD'    WFLNAME                                      CSD079
093980200529     C                   EXSR      SNCHRC                                                     CSD079
093990200529                                                                                              CSD079
094000200529     C                   ENDSR                                                                CSD079
094010200529                                                                                              CSD079
094020200529      *****************************************************************                       CSD079
094030200529      /EJECT                                                                                  CSD079
094040200529      *****************************************************************                       CSD079
094050200529      *                                                               *                       CSD079
094060200529      *  UPDFOD - Update Customer Futures & Option Details            *                       CSD079
094070200529      *                                                               *                       CSD079
094080200529      *****************************************************************                       CSD079
094090200529     C     UPDFOD        BEGSR                                                                CSD079
094100200529                                                                                              CSD079
094110200529      ** Access Customer Futures and Option Details File                                      CSD079
094120200529                                                                                              CSD079
094130200529     C                   CLEAR                   CUFOF                                        CSD079
094140200529                                                                                              CSD079
094150200529     C                   IF        CSD021 = 'Y'                                             BUG16705
094160200529     C                   EVAL      A_FOCUST = A_CUCUST                                      BUG16705
094170200529     C                   ENDIF                                                              BUG16705
094180200529                                                                                            BUG16705
094190200529     C     A_FOCUST      CHAIN     SDFOCSL0                           95                      CSD079
094200200529                                                                                              CSD079
094210200529      * Check if INSERT or AMEND                                                             BG12238
094220200529      *                                                                                      BG12238
094230200529     C     A_FOTYLC      IFNE      'D'                                                       BG12238
094240200529     C     *IN95         IFEQ      '1'                                                       BG12238
094250200529     C                   MOVEL     'I'           A_FOTYLC                                    BG12238
094260200529     C                   ELSE                                                                BG12238
094270200529      *                                                                                      BG12238
094280200529     C                   MOVEL     'A'           A_FOTYLC                                    BG12238
094290200529     C                   ENDIF                                                               BG12238
094300200529     C                   ENDIF                                                               BG12238
094310200529      ***Database Error If INSERT, but record present already                         CRE026 BG12238
094320200529      **********                                                                      CRE026 BG12238
094330200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
094340200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
094350200529     C*****A_CUTYLC      ORNE      'I'                                                CRE026 BG12238
094360200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
094370200529     C**********         MOVEL     A_FOCUST      DBKEY                                CRE026 BG12238
094380200529     C**********         MOVEL     'SDFOCSPD'    DBFILE                 ************  CRE026 BG12238
094390200529     C**********         MOVEL     039           DBASE                  * DBERR 039*  CRE026 BG12238
094400200529     C**********         EXSR      SRERR                                ************  CRE026 BG12238
094410200529     C**********         ENDIF                                                        CRE026 BG12238
094420200529                                                                                              CSD079
094430200529      ** Update Before Status                                                                 CSD079
094440200529                                                                                              CSD079
094450200529     C                   MOVEL(P)  CUFOF         B_CUFOF                                      CSD079
094460200529                                                                                              CSD079
094470200529      ** move values from SDVCUFO to fields of SDFOCSL0                                       CSD079
094480200529                                                                                              CSD079
094490200529     C                   EVAL      BHCUST = A_FOCUST                                          CSD079
094500200529     C                   EVAL      BHCYCD = A_FOCYCD                                          CSD079
094510200529     C                   EVAL      BHLCD  = RDNB                                              CSD079
094520200529     C                   EVAL      BHTYLC = A_FOTYLC                                          CSD079
094530200529     C                   EVAL      BHSTFQ = A_FOSTFQ                                          CSD079
094540200529     C                   EVAL      BHDMFS = A_FODMFS                                          CSD079
094550200529     C                   EVAL      BHNSDT = A_FONSDT                                          CSD079
094560200529     C                   EVAL      BHFACO = A_FOFACO                                          CSD079
094570200529     C                   EVAL      BHBKIN = A_FOBKIN                                          CSD079
094580200529     C                   EVAL      BHSTTY = A_FOSTTY                                          CSD079
094590200529     C                   EVAL      BHSMAC = A_FOSMAC                                          CSD079
094600200529     C                   EVAL      BHCPNO = A_FOCPNO                                          CSD079
094610200529     C                   EVAL      BHCOAD = A_FOCOAD                                          CSD079
094620200529     C                   EVAL      BHFTAO = A_FOFTAO                                          CSD079
094630200529     C                   EVAL      BHTXCI = A_FOTXCI                                          CSD079
094640200529     C                   EVAL      BHCTLM = A_FOCTLM                                          CSD079
094650200529     C                   EVAL      BHRVFQ = A_FORVFQ                                          CSD079
094660200529     C                   EVAL      BHRVBD = A_FORVBD                                          CSD079
094670200529     C                   EVAL      BHNRDT = A_FONRDT                                          CSD079
094680200529     C                   EVAL      BHPCIN = A_FOPCIN                                          CSD079
094690200529     C                   EVAL      BHACIN = A_FOACIN                                          CSD079
094700200529     C                   EVAL      BHCODE = A_FOCODE                                          CSD079
094710200529     C                   EVAL      BHCOAM = A_FOCOAM                                          CSD079
094720200529     C                   EVAL      BHSEBR = A_FOSEBR                                          CSD079
094730200529                                                                                              CSD079
094740200529      ** Insert                                                                               CSD079
094750200529                                                                                              CSD079
094760200529     C     A_FOTYLC      IFEQ      'I'                                                       BG12238
094770200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
094780200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
094790200529                                                                                              CSD079
094800200529     C                   WRITE     @BHRED0                                                    CSD079
094810200529                                                                                              CSD079
094820200529      ** USER: Processing after Insert                                                        CSD079
094830200529                                                                                              CSD079
094840200529     C                   Z-ADD     1             WUNORC                                       CSD079
094850200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
094860200529     C                   Z-ADD     1             WUNOIN                                       CSD079
094870200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
094880200529                                                                                              CSD079
094890200529     C                   ENDIF                                                                CSD079
094900200529                                                                                              CSD079
094910200529      ** Amend                                                                                CSD079
094920200529                                                                                              CSD079
094930200529     C     A_FOTYLC      IFEQ      'A'                                                       BG12238
094940200529     C*****A_CUTYLC      IFEQ      'A'                                                CRE026 BG12238
094950200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
094960200529                                                                                              CSD079
094970200529     C                   UPDATE    @BHRED0                                                    CSD079
094980200529                                                                                              CSD079
094990200529      ** USER: Processing after Update                                                        CSD079
095000200529                                                                                              CSD079
095010200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
095020200529     C                   Z-ADD     1             WUNOAM                                       CSD079
095030200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
095040200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
095050200529     C                   ENDIF                                                                CSD079
095060200529                                                                                              CSD079
095070200529      ** Delete                                                                               CSD079
095080200529                                                                                              CSD079
095090200529     C     A_FOTYLC      IFEQ      'D'                                                       BG12238
095100200529     C*****A_CUTYLC      IFEQ      'D'                                                CRE026 BG12238
095110200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
095120200529                                                                                              CSD079
095130200529     C                   DELETE    @BHRED0                                                    CSD079
095140200529                                                                                              CSD079
095150200529      ** USER: Processing after Delete                                                        CSD079
095160200529                                                                                              CSD079
095170200529     C                   MOVEL     B_CUFOF       WUDELR                                       CSD079
095180200529                                                                                              CSD079
095190200529      ** Write Deleted Record - SD Deleted Records File                                       CSD079
095200200529                                                                                              CSD079
095210200529     C                   CLEAR                   PBRC                                         CSD079
095220200529     C                   MOVEL     'SDFOCSPD'    PBFNME                                       CSD079
095230200529     C                   MOVEL     A_FOCUST      PBLKEY                                       CSD079
095240200529     C                   MOVEL     WUDR01        PBDR01                                       CSD079
095250200529     C                   MOVEL     WUDR02        PBDR02                                       CSD079
095260200529     C                   MOVEL     WUDR03        PBDR03                                       CSD079
095270200529     C                   MOVEL     WUDR04        PBDR04                                       CSD079
095280200529     C                   MOVEL     WUDR05        PBDR05                                       CSD079
095290200529     C                   MOVEL     WUDR06        PBDR06                                       CSD079
095300200529     C                   MOVEL     WUDR07        PBDR07                                       CSD079
095310200529     C                   MOVEL     WUDR08        PBDR08                                       CSD079
095320200529     C                   MOVEL     WUDR09        PBDR09                                       CSD079
095330200529     C                   MOVEL     WUDR10        PBDR10                                       CSD079
095340200529     C                   MOVEL     WUDR11        PBDR11                                       CSD079
095350200529     C                   MOVEL     WUDR12        PBDR12                                       CSD079
095360200529     C                   MOVEL     RDNB          PBLCD                                        CSD079
095370200529     C                   MOVEL     'D'           PBTYLC                                       CSD079
095380200529                                                                                              CSD079
095390200529     C                   CALL      'SD0520X'                                                  CSD079
095400200529     C                   PARM      *BLANK        @RTCD                                        CSD079
095410200529     C                   PARM                    PBRC                                         CSD079
095420200529                                                                                              CSD079
095430200529      ** Error detected?                                                                      CSD079
095440200529                                                                                              CSD079
095450200529     C     @RTCD         IFEQ      '*ERROR*'                                                  CSD079
095460200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
095470200529     C                   MOVEL     A_FOCUST      DBKEY                                        CSD079
095480200529     C                   MOVEL     'SDDELRL0'    DBFILE                                       CSD079
095490200529     C                   MOVEL     040           DBASE                                        CSD079
095500200529     C                   EXSR      SRERR                                                      CSD079
095510200529     C                   ENDIF                                                                CSD079
095520200529                                                                                              CSD079
095530200529     C                   Z-ADD     -1            WUNORC                                       CSD079
095540200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
095550200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
095560200529     C                   Z-ADD     1             WUNODL                                       CSD079
095570200529     C                   ENDIF                                                                CSD079
095580200529                                                                                              CSD079
095590200529      ** Change Standing Data Cont - Standing Data Controls                                   CSD079
095600200529                                                                                              CSD079
095610200529     C                   MOVEL     'SDFOCSPD'    WFLNAME                                      CSD079
095620200529     C                   EXSR      SNCHRC                                                     CSD079
095630200529                                                                                              CSD079
095640200529      ** Update FOCLT - Futures & Options Clients                                             CSD079
095650200529      *                                                                                      BG12238
095660200529     C                   CALL      'FOCLT'                              90                    CSD079
095670200529                                                                                              CSD079
095680200529      ** Return Code                                                                          CSD079
095690200529                                                                                              CSD079
095700200529     C     @RTCD         PARM      *BLANK        WQ0086                                       CSD079
095710200529                                                                                              CSD079
095720200529      ** Customer No.                                                                         CSD079
095730200529                                                                                              CSD079
095740200529     C                   PARM      BHCUST        WQ0087                                       CSD079
095750200529                                                                                              CSD079
095760200529      ** Currency Code                                                                        CSD079
095770200529                                                                                              CSD079
095780200529     C                   PARM      BHCYCD        WQ0088                                       CSD079
095790200529                                                                                              CSD079
095800200529      ** Statement Freq                                                                       CSD079
095810200529                                                                                              CSD079
095820200529     C                   PARM      BHSTFQ        WQ0089                                       CSD079
095830200529                                                                                              CSD079
095840200529      ** Day in month                                                                         CSD079
095850200529                                                                                              CSD079
095860200529     C                   PARM      BHDMFS        WQ0090                                       CSD079
095870200529                                                                                              CSD079
095880200529      ** Next statement                                                                       CSD079
095890200529                                                                                              CSD079
095900200529     C                   PARM      BHNSDT        WQ0091                                       CSD079
095910200529                                                                                              CSD079
095920200529      ** For Account of                                                                       CSD079
095930200529                                                                                              CSD079
095940200529     C                   PARM      BHFACO        WQ0092                                       CSD079
095950200529                                                                                              CSD079
095960200529      ** Broker Indic.                                                                        CSD079
095970200529                                                                                              CSD079
095980200529     C                   PARM      BHBKIN        WQ0093                                       CSD079
095990200529                                                                                              CSD079
096000200529      ** Settlement Type                                                                      CSD079
096010200529                                                                                              CSD079
096020200529     C                   PARM      BHSTTY        WQ0094                                       CSD079
096030200529     C                   PARM      BHSMAC        WQ0095                                       CSD079
096040200529                                                                                              CSD079
096050200529      ** Counterparty                                                                         CSD079
096060200529                                                                                              CSD079
096070200529     C                   PARM      BHCPNO        WQ0096                                       CSD079
096080200529                                                                                              CSD079
096090200529      ** Correspondence                                                                       CSD079
096100200529                                                                                              CSD079
096110200529     C                   PARM      BHCOAD        WQ0097                                       CSD079
096120200529                                                                                              CSD079
096130200529      ** For the Atten.                                                                       CSD079
096140200529                                                                                              CSD079
096150200529     C                   PARM      BHFTAO        WQ0098                                       CSD079
096160200529                                                                                              CSD079
096170200529      ** Telex Confirm                                                                        CSD079
096180200529                                                                                              CSD079
096190200529     C                   PARM      BHTXCI        WQ0099                                       CSD079
096200200529                                                                                              CSD079
096210200529      ** Contract Limit                                                                       CSD079
096220200529                                                                                              CSD079
096230200529     C                   PARM      BHCTLM        WQ0100                                       CSD079
096240200529                                                                                              CSD079
096250200529      ** Revaluation Fq                                                                       CSD079
096260200529                                                                                              CSD079
096270200529     C                   PARM      BHRVFQ        WQ0101                                       CSD079
096280200529                                                                                              CSD079
096290200529      ** Revaluation Ba                                                                       CSD079
096300200529                                                                                              CSD079
096310200529     C                   PARM      BHRVBD        WQ0102                                       CSD079
096320200529                                                                                              CSD079
096330200529      ** Next revaluation                                                                     CSD079
096340200529                                                                                              CSD079
096350200529     C                   PARM      BHNRDT        WQ0103                                       CSD079
096360200529                                                                                              CSD079
096370200529      ** Positions comb                                                                       CSD079
096380200529                                                                                              CSD079
096390200529     C                   PARM      BHPCIN        WQ0104                                       CSD079
096400200529                                                                                              CSD079
096410200529      ** Automatic Clos                                                                       CSD079
096420200529                                                                                              CSD079
096430200529     C                   PARM      BHACIN        WQ0105                                       CSD079
096440200529                                                                                              CSD079
096450200529      ** Collateral Dsc                                                                       CSD079
096460200529                                                                                              CSD079
096470200529     C                   PARM      BHCODE        WQ0106                                       CSD079
096480200529                                                                                              CSD079
096490200529      ** Collateral Amt                                                                       CSD079
096500200529                                                                                              CSD079
096510200529     C                   PARM      BHCOAM        WQ0107                                       CSD079
096520200529                                                                                              CSD079
096530200529      ** Settlement Br.                                                                       CSD079
096540200529                                                                                              CSD079
096550200529     C                   PARM      BHSEBR        WQ0108                                       CSD079
096560200529                                                                                              CSD079
096570200529      ** Type of Lst Chg                                                                      CSD079
096580200529                                                                                              CSD079
096590200529     C                   PARM      BHTYLC        WQ0109                                       CSD079
096600200529                                                                                              CSD079
096610200529      ** Run day Number                                                                       CSD079
096620200529                                                                                              CSD079
096630200529     C                   PARM      RDNB          WQ0110                                       CSD079
096640200529                                                                                              CSD079
096650200529      ** Error detected?                                                                      CSD079
096660200529                                                                                              CSD079
096670200529     C     *IN90         IFEQ      *ON                                                        CSD079
096680200529     C     @RTCD         OREQ      '*ERROR*'                                                  CSD079
096690200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
096700200529     C                   MOVEL     A_FOCUST      DBKEY                                        CSD079
096710200529     C                   MOVEL     'FOCLT'       DBFILE                                       CSD079
096720200529     C                   MOVEL     041           DBASE                                        CSD079
096730200529     C                   EXSR      SRERR                                                      CSD079
096740200529     C                   ENDIF                                                                CSD079
096750200529                                                                                              CSD079
096760200529     C                   ENDSR                                                                CSD079
096770200529                                                                                              CSD079
096780200529      *****************************************************************                       CSD079
096790200529      /EJECT                                                                                  CSD079
096800200529      *****************************************************************                       CSD079
096810200529      *                                                               *                       CSD079
096820200529      *  UPDFFD - Update MIDAS/ABS FF Customers Maintenance Details   *                       CSD079
096830200529      *                                                               *                       CSD079
096840200529      *****************************************************************                       CSD079
096850200529     C     UPDFFD        BEGSR                                                                CSD079
096860200529                                                                                              CSD079
096870200529      ** Access MIDAS/ABS FF Customers Maintenance Details File                               CSD079
096880200529                                                                                              CSD079
096890200529     C                   CLEAR                   CUFF                                         CSD079
096900200529                                                                                              CSD079
096910200529     C                   IF        CSD021 = 'Y'                                             BUG16705
096920200529     C                   EVAL      LXCUST = A_CUCUST                                        BUG16705
096930200529     C                   ENDIF                                                              BUG16705
096940200529                                                                                            BUG16705
096950200529     C     LXCUST        CHAIN     SDFOX1L0                           95                      CSD079
096960200529      *                                                                                       CSD079
096970200529      ***Database Error If INSERT, but record present already                         CRE026 BG12238
096980200529      **********                                                                      CRE026 BG12238
096990200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
097000200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
097010200529     C*****A_CUTYLC      ORNE      'I'                                                CRE026 BG12238
097020200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
097030200529     C**********         MOVEL     LXCUST        DBKEY                                CRE026 BG12238
097040200529     C**********         MOVEL     'SDFOX1PD'    DBFILE                 ************  CRE026 BG12238
097050200529     C**********         MOVEL     050           DBASE                  * DBERR 050*  CRE026 BG12238
097060200529     C**********         EXSR      SRERR                                ************  CRE026 BG12238
097070200529     C**********         ENDIF                                                                CSD079
097080200529                                                                                              CSD079
097090200529      ** Update Before Status                                                                 CSD079
097100200529                                                                                              CSD079
097110200529     C                   MOVEL(P)  CUFF          B_CUFF                                       CSD079
097120200529                                                                                              CSD079
097130200529      ** move values from SDVCUFF to fields of SDFOX1L0                                       CSD079
097140200529                                                                                              CSD079
097150200529     C                   EVAL      CACUST = LXCUST                                            CSD079
097160200529     C                   EVAL      CANETA = LXNETA                                            CSD079
097170200529                                                                                              CSD079
097180200529      ** Insert                                                                               CSD079
097190200529                                                                                              CSD079
097200200529     C     A_FOTYLC      IFEQ      'I'                                                       BG12238
097210200529     C*****A_CUTYLC      IFEQ      'I'                                                CSD079 BG12238
097220200529     C******IN95         ANDEQ     '1'                                                CSD079 BG12238
097230200529                                                                                              CSD079
097240200529     C                   WRITE     SDFOCSD6                                                   CSD079
097250200529                                                                                              CSD079
097260200529      ** USER: Processing after Insert                                                        CSD079
097270200529                                                                                              CSD079
097280200529     C                   Z-ADD     1             WUNORC                                       CSD079
097290200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
097300200529     C                   Z-ADD     1             WUNOIN                                       CSD079
097310200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
097320200529                                                                                              CSD079
097330200529     C                   ENDIF                                                                CSD079
097340200529                                                                                              CSD079
097350200529      ** Amend                                                                                CSD079
097360200529                                                                                              CSD079
097370200529     C     A_FOTYLC      IFEQ      'A'                                                        CSD079
097380200529     C*****A_CUTYLC      IFEQ      'A'                                                CRE026 BG12238
097390200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
097400200529                                                                                              CRE026
097410200529     C                   UPDATE    SDFOCSD6                                                   CSD079
097420200529                                                                                              CSD079
097430200529      ** USER: Processing after Update                                                        CSD079
097440200529                                                                                              CSD079
097450200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
097460200529     C                   Z-ADD     1             WUNOAM                                       CSD079
097470200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
097480200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
097490200529     C                   ENDIF                                                                CSD079
097500200529                                                                                              CSD079
097510200529      ** Delete                                                                               CSD079
097520200529                                                                                              CSD079
097530200529     C     A_CUTYLC      IFEQ      'D'                                                        CSD079
097540200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
097550200529                                                                                              CSD079
097560200529     C                   DELETE    SDFOCSD6                                                   CSD079
097570200529                                                                                              CSD079
097580200529      ** USER: Processing after Delete                                                        CSD079
097590200529                                                                                              CSD079
097600200529     C                   MOVEL     B_CUFF        WUDELR                                       CSD079
097610200529                                                                                              CSD079
097620200529      ** Write Deleted Record - SD Deleted Records File                                       CSD079
097630200529                                                                                              CSD079
097640200529     C                   CLEAR                   PBRC                                         CSD079
097650200529     C                   MOVEL     'SDFOX1PD'    PBFNME                                       CSD079
097660200529     C                   MOVEL     LXCUST        PBLKEY                                       CSD079
097670200529     C                   MOVEL     WUDR01        PBDR01                                       CSD079
097680200529     C                   MOVEL     WUDR02        PBDR02                                       CSD079
097690200529     C                   MOVEL     WUDR03        PBDR03                                       CSD079
097700200529     C                   MOVEL     WUDR04        PBDR04                                       CSD079
097710200529     C                   MOVEL     WUDR05        PBDR05                                       CSD079
097720200529     C                   MOVEL     WUDR06        PBDR06                                       CSD079
097730200529     C                   MOVEL     WUDR07        PBDR07                                       CSD079
097740200529     C                   MOVEL     WUDR08        PBDR08                                       CSD079
097750200529     C                   MOVEL     WUDR09        PBDR09                                       CSD079
097760200529     C                   MOVEL     WUDR10        PBDR10                                       CSD079
097770200529     C                   MOVEL     WUDR11        PBDR11                                       CSD079
097780200529     C                   MOVEL     WUDR12        PBDR12                                       CSD079
097790200529     C                   MOVEL     RDNB          PBLCD                                        CSD079
097800200529     C                   MOVEL     'D'           PBTYLC                                       CSD079
097810200529                                                                                              CSD079
097820200529     C                   CALL      'SD0520X'                                                  CSD079
097830200529     C                   PARM      *BLANK        @RTCD                                        CSD079
097840200529     C                   PARM                    PBRC                                         CSD079
097850200529                                                                                              CSD079
097860200529      ** Error detected?                                                                      CSD079
097870200529                                                                                              CSD079
097880200529     C     @RTCD         IFEQ      '*ERROR*'                                                  CSD079
097890200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
097900200529     C                   MOVEL     LXCUST        DBKEY                                        CSD079
097910200529     C                   MOVEL     'SDDELRL0'    DBFILE                                       CSD079
097920200529     C                   MOVEL     051           DBASE                                        CSD079
097930200529     C                   EXSR      SRERR                                                      CSD079
097940200529     C                   ENDIF                                                                CSD079
097950200529                                                                                              CSD079
097960200529     C                   Z-ADD     -1            WUNORC                                       CSD079
097970200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
097980200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
097990200529     C                   Z-ADD     1             WUNODL                                       CSD079
098000200529     C                   ENDIF                                                                CSD079
098010200529                                                                                              CSD079
098020200529      ***Change*Standing*Data*Cont*-*Standing*Data*Controls************              CSD079 BUG27943
098030200529                                                                                              CSD079
098040200529     C**********         MOVEL     'SDFOX1PD'    WFLNAME                             CSD079 BUG27943
098050200529     C**********         EXSR      SNCHRC                                            CSD079 BUG27943
098060200529                                                                                              CSD079
098070200529     C                   ENDSR                                                                CSD079
098080200529                                                                                              CSD079
098090200529      *****************************************************************                       CSD079
098100200529      /EJECT                                                                                  CSD079
098110200529      *****************************************************************                       CSD079
098120200529      *                                                               *                       CSD079
098130200529      *  UPDPMD - Update Customer Portfolio Management                *                       CSD079
098140200529      *                                                               *                       CSD079
098150200529      *****************************************************************                       CSD079
098160200529     C     UPDPMD        BEGSR                                                                CSD079
098170200529                                                                                              CSD079
098180200529      ** Update PM PORTFOLIO DEFINITION AUDIT File                                            CSD079
098190200529                                                                                              CSD079
098200200529     C     BGN4ST        IFEQ      'Y'                                                        CSD079
098210200529                                                                                              CSD079
098220200529     C     A_PMDFPO      IFEQ      *BLANKS                                                    CSD079
098230200529     C     *LOVAL        SETLL     PBTMPDLL                                                   CSD079
098240200529     C                   READ      PBTMPDLL                               89                  CSD079
098250200529     C                   ELSE                                                                 CSD079
098260200529     C     A_PMDFPO      SETLL     PBTMPDLL                                                   CSD079
098270200529     C     A_PMDFPO      READE     PBTMPDLL                               89                  CSD079
098280200529     C                   ENDIF                                                                CSD079
098290200529                                                                                              CSD079
098300200529     C                   IF        CSD021 = 'Y'                                             BUG16705
098310200529     C                   EVAL      A_PMCUST = A_CUCUST                                      BUG16705
098320200529     C                   ENDIF                                                              BUG16705
098330200529                                                                                            BUG16705
098340200529     C                   MOVE      A_PMCUST      PNCNUM                                       CSD079
098350200529     C                   MOVEL     'I'           PNCHTP                                       CSD079
098360200529     C                   Z-ADD     RDNB          PNLCD                                        CSD079
098370200529     C                   MOVEL     'D'           PNRECI                                       CSD079
098380200529     C     *IN89         IFEQ      *OFF                                                       CSD079
098390200529     C                   MOVE      PNPTFR        A_PMDFPO                                     CSD079
098400200529     C                   Z-ADD     WUDLUP        PNDLUP                                       CSD079
098410200529     C                   MOVEL     WUMLUP        PNMLUP                                       CSD079
098420200529     C                   Z-ADD     WUYLUP        PNYLUP                                       CSD079
098430200529     C                   ENDIF                                                                CSD079
098440200529     C                   MOVE      A_PMDFPO      PNPTFR                                       CSD079
098450200529     C                   TIME                    PNTLUP                                       CSD079
098460200529                                                                                              CSD079
098470200529     C     A_PMCSBY      IFEQ      *BLANK                                                     CSD079
098480200529     C                   MOVE      *BLANKS       A_PMDFPO                                     CSD079
098490200529     C                   ELSE                                                                 CSD079
098500200529     C**********         MOVEL     A_PMCUST      PNPTCY                             CSD079 AR1081787
098510200529     C                   MOVEL     A_PMCSBY      PNPTCY                             CSD079 AR1081787
098520200529     C                   Z-ADD     A_PMBYDP      PNPCDP                                       CSD079
098530200529     C                   MOVE      PNPTFR        PNPTFR                                       CSD079
098540200529     C                   MOVEL     PNPTFN        PNPTFN                                       CSD079
098550200529     C                   Z-ADD     RDNB          PNDPOP                                       CSD079
098560200529     C                   MOVEL     'M'           PNMNGI                                       CSD079
098570200529     C                   MOVEL     'N'           PNIPIN                                       CSD079
098580200529     C                   MOVEL     'N'           PNCYIN                                       CSD079
098590200529     C                   MOVEL     'N'           PNYPIN                                       CSD079
098600200529     C                   MOVEL     'N'           PNNPIN                                       CSD079
098610200529     C                   MOVEL     PNRPYP        PNRPYP                                       CSD079
098620200529     C                   Z-ADD     99999         PNPSDT                                       CSD079
098630200529     C                   Z-ADD     01            PNACSQ                                       CSD079
098640200529     C                   ENDIF                                                                CSD079
098650200529     C                   ENDIF                                                                CSD079
098660200529                                                                                              CSD079
098670200529      ** CASE: *OTHERWISE                                                                     CSD079
098680200529                                                                                              CSD079
098690200529     C                   MOVEL     *BLANK        WURTCD                                       CSD079
098700200529     C                   MOVEL     '*PMCUSTV'    WUPMAC                                       CSD079
098710200529     C                   MOVEL     A_PMCUST      WUCUST                                       CSD079
098720200529     C                   MOVEL     *BLANK        WUBKCD                                       CSD079
098730200529     C                   MOVEL     A_PMDFPO      WUPTRF                                       CSD079
098740200529     C                   MOVEL     *BLANK        WUSCPF                                       CSD079
098750200529     C                   MOVEL     *BLANK        WUSCPT                                       CSD079
098760200529     C                   MOVEL     PSProcName    WUPGMN                                       CSD079
098770200529                                                                                              CSD079
098780200529      ** Call PMZ0010 - Book Details                                                          CSD079
098790200529                                                                                              CSD079
098800200529     C                   CALL      'PMZ0010'                            90                    CSD079
098810200529     C     WURTCD        PARM      WURTCD        WQ0035                                       CSD079
098820200529     C     WUPMAC        PARM      WUPMAC        WQ0036                                       CSD079
098830200529     C     WUCUST        PARM      WUCUST        WQ0037                                       CSD079
098840200529     C     WUBKCD        PARM      WUBKCD        WQ0038                                       CSD079
098850200529     C     WUPTRF        PARM      WUPTRF        WQ0039                                       CSD079
098860200529     C     WUSCPF        PARM      WUSCPF        WQ0040                                       CSD079
098870200529     C     WUSCPT        PARM      WUSCPT        WQ0041                                       CSD079
098880200529     C     WUPGMN        PARM      WUPGMN        WQ0042                                       CSD079
098890200529                                                                                              CSD079
098900200529     C     *IN90         IFEQ      *ON                                                        CSD079
098910200529                                                                                              CSD079
098920200529      ** Call to program ended in error                                                       CSD079
098930200529                                                                                              CSD079
098940200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
098950200529     C                   MOVEL     PNCNUM        DBKEY                                        CSD079
098960200529     C                   MOVEL     'PMPORTPD'    DBFILE                                       CSD079
098970200529     C                   MOVEL     070           DBASE                                        CSD079
098980200529     C                   EXSR      SRERR                                                      CSD079
098990200529     C                   ENDIF                                                                CSD079
099000200529                                                                                              CSD079
099010200529      ** Return Code work field is NORMAL                                                     CSD079
099020200529                                                                                              CSD079
099030200529     C     WURTCD        IFEQ      *BLANK                                                     CSD079
099040200529     C     BGN4ST        ANDNE     'Y'                                                        CSD079
099050200529     C     WURTCD        OREQ      *BLANK                                                     CSD079
099060200529     C     WUSCPF        ANDNE     *BLANK                                                     CSD079
099070200529     C     WUSCPF        ANDNE     FCR997                                                     CSD079
099080200529     C     BGN4ST        ANDEQ     'Y'                                                        CSD079
099090200529     C                   MOVEL     WUSCPF        #1DFPO                                       CSD079
099100200529     C                   ELSE                                                                 CSD079
099110200529     C     A_PMDFPO      IFNE      *BLANKS                                                    CSD079
099120200529     C     PNCHTP        ANDEQ     'I'                                                        CSD079
099130200529     C     A_PMDFPO      ANDNE     FCR997                                                     CSD079
099140200529     C     BGN4ST        ANDEQ     'Y'                                                        CSD079
099150200529     C                   MOVEL     'D'           PNRECI                                       CSD079
099160200529                                                                                              CSD079
099170200529     C     PNMGTP        IFEQ      *ZEROS                                                     CSD079
099180200529     C                   Z-ADD     1             PNMGTP                                       CSD079
099190200529     C                   ENDIF                                                                CSD079
099200200529                                                                                              CSD079
099210200529     C     PNINTP        IFEQ      *ZEROS                                                     CSD079
099220200529     C                   Z-ADD     1             PNINTP                                       CSD079
099230200529     C                   ENDIF                                                                CSD079
099240200529                                                                                              CSD079
099250200529     C                   WRITE     PMPORTP0                                                   CSD079
099260200529                                                                                              CSD079
099270200529      ** Access to trailer                                                                    CSD079
099280200529                                                                                              CSD079
099290200529     C     1             CHAIN     PMPORTPA                           80                      CSD079
099300200529     C     *IN80         IFEQ      *ON                                                        CSD079
099310200529                                                                                              CSD079
099320200529      ** Write Trailer                                                                        CSD079
099330200529                                                                                              CSD079
099340200529     C                   MOVE      'Z'           PNRECI                                       CSD079
099350200529     C                   WRITE     PMPORTZ0                                                   CSD079
099360200529     C                   ELSE                                                                 CSD079
099370200529                                                                                              CSD079
099380200529     C                   ADD       1             PNNORE                                       CSD079
099390200529     C                   UPDATE    PMPORTZ0                                                   CSD079
099400200529                                                                                              CSD079
099410200529     C                   ENDIF                                                                CSD079
099420200529     C                   ENDIF                                                                CSD079
099430200529                                                                                              CSD079
099440200529     C                   END                                                                  CSD079
099450200529                                                                                              CSD079
099460200529      ** Access Customer Portfolio Management Details File                                    CSD079
099470200529                                                                                              CSD079
099480200529     C                   CLEAR                   CUPMF                                        CSD079
099490200529                                                                                              CSD079
099500200529     C     A_PMCUST      CHAIN     @PLCSL0                            95                      CSD079
099510200529                                                                                              CSD079
099520200529      ** Check if INSERT or AMEND                                                            BG12238
099530200529                                                                                             BG12238
099540200529     C     A_PMTYLC      IFNE      'D'                                                       BG12238
099550200529     C     *IN95         IFEQ      '1'                                                       BG12238
099560200529     C                   MOVEL     'I'           A_PMTYLC                                    BG12238
099570200529     C                   ELSE                                                                BG12238
099580200529      *                                                                                      BG12238
099590200529     C                   MOVEL     'A'           A_PMTYLC                                    BG12238
099600200529     C                   ENDIF                                                               BG12238
099610200529     C                   ENDIF                                                               BG12238
099620200529                                                                                              CSD079
099630200529      ** Insert Processing                                                                    CSD079
099640200529                                                                                              CSD079
099650200529                                                                                              CSD079
099660200529      ***Database Error If INSERT, but record present already                         CRE026 BG12238
099670200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
099680200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
099690200529     C*****A_CUTYLC      ORNE      'I'                                                CRE026 BG12238
099700200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
099710200529     C**********         MOVEL     A_PMCUST      DBKEY                                CRE026 BG12238
099720200529     C**********         MOVEL     'SDPLCSPD'    DBFILE                 ************  CRE026 BG12238
099730200529     C**********         MOVEL     042           DBASE                  * DBERR 042*  CRE026 BG12238
099740200529     C**********         EXSR      SRERR                                ************  CRE026 BG12238
099750200529     C**********         ENDIF                                                                CSD079
099760200529                                                                                              CSD079
099770200529      ** Update Before Status                                                                 CSD079
099780200529                                                                                              CSD079
099790200529     C                   MOVEL(P)  CUPMF         B_CUPMF                                      CSD079
099800200529                                                                                              CSD079
099810200529      ** Move all fields to @PLCSL0                                                           CSD079
099820200529                                                                                              CSD079
099830200529     C                   EVAL      QBCUST =A_PMCUST                                           CSD079
099840200529     C                   EVAL      QBLCD  =A_PMLCD                                            CSD079
099850200529     C                   EVAL      QBRECI =A_PMRECI                                           CSD079
099860200529     C                   EVAL      QBDLUP = WUDLUP                                            CSD079
099870200529     C                   EVAL      QBMLUP = WUMLUP                                            CSD079
099880200529     C                   EVAL      QBYLUP = WUYLUP                                            CSD079
099890200529     C                   EVAL      QBTLUP =A_PMTLUP                                           CSD079
099900200529     C                   EVAL      QBTNLU =A_PMTNLU                                           CSD079
099910200529     C                   EVAL      QBBDAT =A_PMBDAT                                           CSD079
099920200529     C                   EVAL      QBLANG =A_PMLANG                                           CSD079
099930200529     C                   EVAL      QBCSBY =A_PMCSBY                                           CSD079
099940200529     C                   EVAL      QBBYDP =A_PMBYDP                                           CSD079
099950200529     C                   EVAL      QBSAFI =A_PMSAFI                                           CSD079
099960200529     C                   EVAL      QBDCMS =A_PMDCMS                                           CSD079
099970200529     C                   EVAL      QBVLFQ =A_PMVLFQ                                           CSD079
099980200529     C                   EVAL      QBVLDM =A_PMVLDM                                           CSD079
099990200529     C                   EVAL      QBVLND =A_PMVLND                                           CSD079
100000200529     C                   EVAL      QBS1VR =A_PMS1VR                                           CSD079
100010200529     C                   EVAL      QBS2VR =A_PMS2VR                                           CSD079
100020200529     C                   EVAL      QBS3VR =A_PMS3VR                                           CSD079
100030200529     C                   EVAL      QBS4VR =A_PMS4VR                                           CSD079
100040200529     C                   EVAL      QBS5VR =A_PMS5VR                                           CSD079
100050200529     C                   EVAL      QBS6VR =A_PMS6VR                                           CSD079
100060200529     C                   EVAL      QBS7VR =A_PMS7VR                                           CSD079
100070200529     C                   EVAL      QBS8VR =A_PMS8VR                                           CSD079
100080200529     C                   EVAL      QBAPBC =A_PMAPBC                                           CSD079
100090200529     C                   EVAL      QBPPCS =A_PMPPCS                                           CSD079
100100200529     C                   EVAL      QBDFPO =A_PMDFPO                                           CSD079
100110200529     C                   EVAL      QBINSU =A_PMINSU                                           CSD079
100120200529     C                   EVAL      QBCYSU =A_PMCYSU                                           CSD079
100130200529     C                   EVAL      QBSECO =A_PMSECO                                           CSD079
100140200529                                                                                              CSD079
100150200529      ** Insert                                                                               CSD079
100160200529                                                                                              CSD079
100170200529     C     A_PMTYLC      IFEQ      'I'                                                       BG12238
100180200529     C*****A_CUTYLC      IFEQ      'I'                                                CRE026 BG12238
100190200529     C******IN95         ANDEQ     '1'                                                CRE026 BG12238
100200200529                                                                                              CSD079
100210200529     C                   EVAL      QBTYLC =A_PMTYLC                                           CSD079
100220200529     C                   EVAL      QBPFM7 ='N'                                                CSD079
100230200529     C                   EVAL      QBPFM8 ='N'                                                CSD079
100240200529     C                   EVAL      QBPFM9 ='N'                                                CSD079
100250200529                                                                                              CSD079
100260200529     C                   WRITE     @PLCSL0                                                    CSD079
100270200529                                                                                              CSD079
100280200529      ** USER: Processing after Insert                                                        CSD079
100290200529                                                                                              CSD079
100300200529     C                   Z-ADD     1             WUNORC                                       CSD079
100310200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
100320200529     C                   Z-ADD     1             WUNOIN                                       CSD079
100330200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
100340200529                                                                                              CSD079
100350200529     C                   ENDIF                                                                CSD079
100360200529                                                                                              CSD079
100370200529      ** Amend Processing                                                                     CSD079
100380200529      ** Database Error If Amend, but record not present                                      CSD079
100390200529                                                                                              CSD079
100400200529     C     A_PMTYLC      IFEQ      'A'                                                       BG12238
100410200529     C*****A_CUTYLC      IFEQ      'A'                                                CRE026 BG12238
100420200529     C******IN95         ANDEQ     '0'                                                CRE026 BG12238
100430200529                                                                                              CSD079
100440200529      ** Has this record been inserted today?                                                 CSD079
100450200529                                                                                              CSD079
100460200529     C                   MOVEL     'N'           WURITD                                       CSD079
100470200529     C     WURDNB        IFEQ      QBLCD                                                      CSD079
100480200529     C     QBTYLC        IFEQ      'I'                                                        CSD079
100490200529     C                   MOVEL     'Y'           WURITD                                       CSD079
100500200529     C                   ENDIF                                                                CSD079
100510200529     C                   ENDIF                                                                CSD079
100520200529                                                                                              CSD079
100530200529     C     WURITD        IFEQ      'Y'                                                        CSD079
100540200529     C                   MOVEL     'I'           QBTYLC                                       CSD079
100550200529     C                   ELSE                                                                 CSD079
100560200529     C                   MOVEL     A_PMTYLC      QBTYLC                                       CSD079
100570200529     C                   ENDIF                                                                CSD079
100580200529                                                                                              CSD079
100590200529      ** Move all fields to @PLCSL0                                                           CSD079
100600200529                                                                                              CSD079
100610200529     C                   EVAL      QBPFM7 =A_PMPFM7                                           CSD079
100620200529     C                   EVAL      QBPFM8 =A_PMPFM8                                           CSD079
100630200529     C                   EVAL      QBPFM9 =A_PMPFM9                                           CSD079
100640200529                                                                                              CSD079
100650200529     C                   UPDATE    @PLCSL0                                                    CSD079
100660200529                                                                                              CSD079
100670200529      ** USER: Processing after Update                                                        CSD079
100680200529                                                                                              CSD079
100690200529     C                   Z-ADD     *ZERO         WUNORC                                       CSD079
100700200529     C                   Z-ADD     1             WUNOAM                                       CSD079
100710200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
100720200529     C                   Z-ADD     *ZERO         WUNODL                                       CSD079
100730200529                                                                                              CSD079
100740200529     C                   ENDIF                                                                CSD079
100750200529                                                                                              CSD079
100760200529      ** Delete Processing                                                                    CSD079
100770200529      ** Database Error If Delete, but record not present                                     CSD079
100780200529                                                                                              CSD079
100790200529     C     A_PMTYLC      IFEQ      'D'                                                       BG12238
100800200529     C*****A_CUTYLC      IFEQ      'D'                                                CRE026 BG12238
100810200529     C     *IN95         ANDEQ     *OFF                                                       CSD079
100820200529      *                                                                                       CSD079
100830200529     C                   DELETE    @PLCSL0                                                    CSD079
100840200529                                                                                              CSD079
100850200529      ** USER: Processing after Delete                                                        CSD079
100860200529                                                                                              CSD079
100870200529     C                   MOVEL     B_CUPMF       WUDELR                                       CSD079
100880200529                                                                                              CSD079
100890200529      ** Write Deleted Record - SD Deleted Records File                                       CSD079
100900200529                                                                                              CSD079
100910200529     C                   CLEAR                   PBRC                                         CSD079
100920200529     C                   MOVEL     'SDPLCSPD'    PBFNME                                       CSD079
100930200529     C                   MOVEL     A_PMCUST      PBLKEY                                       CSD079
100940200529     C                   MOVEL     WUDR01        PBDR01                                       CSD079
100950200529     C                   MOVEL     WUDR02        PBDR02                                       CSD079
100960200529     C                   MOVEL     WUDR03        PBDR03                                       CSD079
100970200529     C                   MOVEL     WUDR04        PBDR04                                       CSD079
100980200529     C                   MOVEL     WUDR05        PBDR05                                       CSD079
100990200529     C                   MOVEL     WUDR06        PBDR06                                       CSD079
101000200529     C                   MOVEL     WUDR07        PBDR07                                       CSD079
101010200529     C                   MOVEL     WUDR08        PBDR08                                       CSD079
101020200529     C                   MOVEL     WUDR09        PBDR09                                       CSD079
101030200529     C                   MOVEL     WUDR10        PBDR10                                       CSD079
101040200529     C                   MOVEL     WUDR11        PBDR11                                       CSD079
101050200529     C                   MOVEL     WUDR12        PBDR12                                       CSD079
101060200529     C                   MOVEL     WURDNB        PBLCD                                        CSD079
101070200529     C                   MOVEL     'D'           PBTYLC                                       CSD079
101080200529                                                                                              CSD079
101090200529     C                   CALL      'SD0520X'                                                  CSD079
101100200529     C                   PARM      *BLANK        @RTCD                                        CSD079
101110200529     C                   PARM                    PBRC                                         CSD079
101120200529                                                                                              CSD079
101130200529      ** Error detected?                                                                      CSD079
101140200529                                                                                              CSD079
101150200529     C     @RTCD         IFEQ      '*ERROR*'                                                  CSD079
101160200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
101170200529     C                   MOVEL     A_PMCUST      DBKEY                                        CSD079
101180200529     C                   MOVEL     'SDDELRL0'    DBFILE                                       CSD079
101190200529     C                   MOVEL     043           DBASE                                        CSD079
101200200529     C                   EXSR      SRERR                                                      CSD079
101210200529     C                   ENDIF                                                                CSD079
101220200529                                                                                              CSD079
101230200529     C                   Z-ADD     -1            WUNORC                                       CSD079
101240200529     C                   Z-ADD     *ZERO         WUNOAM                                       CSD079
101250200529     C                   Z-ADD     *ZERO         WUNOIN                                       CSD079
101260200529     C                   Z-ADD     1             WUNODL                                       CSD079
101270200529     C                   ENDIF                                                                CSD079
101280200529                                                                                              CSD079
101290200529      ** Change Standing Data Cont - Standing Data Controls                                   CSD079
101300200529                                                                                              CSD079
101310200529     C                   MOVEL     'SDPLCSPD'    WFLNAME                                      CSD079
101320200529     C                   EXSR      SNCHRC                                                     CSD079
101330200529      *                                                                                       CSD079
101340200529     C                   ENDSR                                                                CSD079
101350200529      *                                                                                       CSD079
101360200529      *****************************************************************                       CSD079
101370200529      /EJECT                                                                                  CSD079
101380200529      *****************************************************************                       CSD079
101390200529      *                                                               *                       CSD079
101400200529      *  UPDRWN - Update Customer Risk Weighted Assets                *                       CSD079
101410200529      *                                                               *                       CSD079
101420200529      *****************************************************************                       CSD079
101430200529     C     UPDRWN        BEGSR                                                                CSD079
101440200529                                                                                              CSD079
101450200529     C                   CALLB     'SDRWANUPD'                                                CSD079
101460200529                                                                                              CSD079
101470200529      ** Ensure correct parameters for this UPD function                                      CSD079
101480200529                                                                                              CSD079
101490200529     C                   PARM      *BLANKS       @RTCD                                        CSD079
101500200529     C                   PARM                    SDVCURW                                      CSD079
101510200529     C                   PARM      'Y'           From_Cust                                    CSD079
101520200529                                                                                              CSD079
101530200529      ** If there were any errors in the update functions,                                    CSD079
101540200529                                                                                              CSD079
101550200529     C     @RTCD         IFNE      *BLANK                                                     CSD079
101560200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
101570200529     C                   MOVEL     BBCUST        DBKEY                                        CSD079
101580200529     C                   MOVEL     'SDCRWAPD'    DBFILE                                       CSD079
101590200529     C                   MOVEL     071           DBASE                                        CSD079
101600200529     C                   EXSR      SRERR                                                      CSD079
101610200529     C                   ENDIF                                                                CSD079
101620200529                                                                                              CSD079
101630200529     C                   ENDSR                                                                CSD079
101640200529                                                                                              CSD079
101650200529      *****************************************************************                       CSD079
101660200529      /EJECT                                                                                  CSD079
101670200529      *****************************************************************                       CSD079
101680200529      *                                                               *                       CSD079
101690200529      *  UPDCUX2 - Update Lux(European Reporting)Customer file        *                       CSD079
101700200529      *                                                               *                       CSD079
101710200529      *****************************************************************                       CSD079
101720200529     C     UPDCUX2       BEGSR                                                                CSD079
101730200529                                                                                              CSD079
101740200529     C     ACTN          IFNE      'I'                                                        CSD079
101750200529     C                   EVAL      WFIND = 'Y'                                                CSD079
101760200529     C                   ELSE                                                               BUG13594
101770200529     C                   EVAL      WFIND = *BLANKS                                          BUG13594
101780200529     C                   ENDIF                                                                CSD079
101790200529                                                                                              CSD079
101800200529     C                   IF        CSD021 = 'Y'                                             BUG16705
101810200529     C                   EVAL      A_#6LXVFCUST = A_CUCUST                                  BUG16705
101820200529     C                   ENDIF                                                              BUG16705
101830200529                                                                                            BUG16705
101840200529     C                   CALLB     'SDCUSD2UP'                                                CSD079
101850200529                                                                                              CSD079
101860200529      ** Ensure correct parameters for this UPD function                                      CSD079
101870200529                                                                                              CSD079
101880200529     C                   PARM                    ACTN                                         CSD079
101890200529     C                   PARM                    @RTCD                                        CSD079
101900200529     C                   PARM                    WFIND                                        CSD079
101910200529     C                   PARM                    SDVCUEU                                      CSD079
101920200529     C                   PARM                    CueuFilFmt                                   CSD079
101930200529                                                                                              CSD079
101940200529      ** If there were any errors in the update functions                                     CSD079
101950200529                                                                                              CSD079
101960200529     C     @RTCD         IFNE      *BLANK                                                     CSD079
101970200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
101980200529     C                   MOVEL     VFCUST        DBKEY                                        CSD079
101990200529     C                   MOVEL     'SDCUX2PD'    DBFILE                                       CSD079
102000200529     C                   MOVEL     052           DBASE                                        CSD079
102010200529     C                   EXSR      SRERR                                                      CSD079
102020200529     C                   ENDIF                                                                CSD079
102030200529                                                                                              CSD079
102040200529     C                   ENDSR                                                                CSD079
102050200529                                                                                              CSD079
102060200529      *****************************************************************                       CSD079
102070200529      /EJECT                                                                                  CSD079
102080200529      *****************************************************************                       CSD079
102090200529      *                                                               *                       CSD079
102100200529      * UPDCUX1 - Update Lux(IBLC - Extended Information)Customer file*                       CSD079
102110200529      *                                                               *                       CSD079
102120200529      *****************************************************************                       CSD079
102130200529     C     UPDCUX1       BEGSR                                                                CSD079
102140200529                                                                                              CSD079
102150200529     C     ACTN          IFNE      'I'                                                        CSD079
102160200529     C                   EVAL      WFIND = 'Y'                                                CSD079
102170200529     C                   ELSE                                                               BUG13594
102180200529     C                   EVAL      WFIND = *BLANKS                                          BUG13594
102190200529     C                   ENDIF                                                                CSD079
102200200529                                                                                              CSD079
102210200529     C                   IF        CSD021 = 'Y'                                             BUG16705
102220200529     C                   EVAL      A_#LLXCUCNUM = A_CUCUST                                  BUG16705
102230200529     C                   ENDIF                                                              BUG16705
102240200529                                                                                            BUG16705
102250200529     C                   CALLB     'SDCUSD3UP'                                                CSD079
102260200529                                                                                              CSD079
102270200529      ** Ensure correct parameters for this UPD function                                      CSD079
102280200529                                                                                              CSD079
102290200529     C                   PARM                    ACTN                                         CSD079
102300200529     C                   PARM                    @RTCD                                        CSD079
102310200529     C                   PARM                    WFIND                                        CSD079
102320200529     C                   PARM                    SDVCUIB                                      CSD079
102330200529     C                   PARM                    CuibfFilFmt                                  CSD079
102340200529                                                                                              CSD079
102350200529      ** If there were any errors in the update functions                                     CSD079
102360200529                                                                                              CSD079
102370200529     C     @RTCD         IFNE      *BLANK                                                     CSD079
102380200529     C                   MOVEL     *BLANK        DBKEY                                        CSD079
102390200529     C                   MOVEL     CUCNUM        DBKEY                                        CSD079
102400200529     C                   MOVEL     'SDCUX1PD'    DBFILE                                       CSD079
102410200529     C                   MOVEL     053           DBASE                                        CSD079
102420200529     C                   EXSR      SRERR                                                      CSD079
102430200529     C                   ENDIF                                                                CSD079
102440200529                                                                                              CSD079
102450200529     C                   ENDSR                                                                CSD079
102460200529                                                                                              CSD079
102470200529     C*****************************************************************                       CSD079
102480200529      /EJECT                                                                                  CSD079
102490200529      *****************************************************************                       CSD079
102500200529      *                                                               *                       CSD079
102510200529      * SRADWTCH - Set-up parameter and send Additional Customer      *                       CSD079
102520200529      *          details to Compliance Watch by calling the Engine    *                       CSD079
102530200529      *          program for Standing Data Authorisation enhancement  *                       CSD079
102540200529      *                                                               *                       CSD079
102550200529      *****************************************************************                       CSD079
102560200529     C     SRADWTCH      BEGSR                                                                CSD079
102570200529                                                                                              CSD079
102580200529      ** Set-up first parameter for Compliance Engine                                         CSD079
102590200529                                                                                              CSD079
102600200529     C                   EVAL      PDSWLTD = *BLANKS                                          CSD079
102610200529     C                   EVAL      W4AMT1 = 0                                                 CSD079
102620200529     C                   EVAL      W4AMT2 = 0                                                 CSD079
102630200529     C                   EVAL      W4ITEM = 'SDCUSA'                                          CSD079
102640200529     C                   EVAL      W4IDEN = E5CUST                                            CSD079
102650200529     C                   EVAL      W4BRCH = BBBRCD                                            CSD079
102660200529     C                   EVAL      W4FUNT = 'SDACUSPD'                                        CSD079
102670200529     C                   EVAL      W4CNUM = E5CUST                                            CSD079
102680200529                                                                                              CSD079
102690200529      ** Get Main System Prefix from data area SC24X7 if enhancement                          CSD079
102700200529      ** CSC011 is installed, else get it from SDSTAT                                         CSD079
102710200529                                                                                              CSD079
102720200529     C                   IF        CSC011 = 'Y'                                               CSD079
102730200529     C                   EVAL      W4SYSM = S1MAIN                                            CSD079
102740200529     C                   ELSE                                                                 CSD079
102750200529     C                   EVAL      W4SYSM = LIBR                                              CSD079
102760200529     C                   ENDIF                                                                CSD079
102770200529                                                                                              CSD079
102780200529      ** If Concord Interface Development is installed (CCF001)                               CSD079
102790200529                                                                                              CSD079
102800200529     C                   IF        CCF001 = 'Y'                                               CSD079
102810200529                                                                                              CSD079
102820200529      ** If Corporate Customer is 'Y'                                                         CSD079
102830200529                                                                                              CSD079
102840200529     C                   IF        BBCRPC = 'Y'                                               CSD079
102850200529     C                   EVAL      W4CTYP = 'C'                                               CSD079
102860200529     C                   ELSE                                                                 CSD079
102870200529     C                   EVAL      W4CTYP = 'I'                                               CSD079
102880200529     C                   ENDIF                                                                CSD079
102890200529                                                                                              CSD079
102900200529     C                   ELSE                                                                 CSD079
102910200529                                                                                              CSD079
102920200529      ** If Local Industry Code is not blank or not equal to any                              CSD079
102930200529      ** of the five Private Customer Industry Code                                           CSD079
102940200529                                                                                              CSD079
102950200529     C                   IF        BBLICD <> *BLANKS                                          CSD079
102960200529     C                             AND BBLICD <> W1IND1                                       CSD079
102970200529     C                             AND BBLICD <> W1IND2                                       CSD079
102980200529     C                             AND BBLICD <> W1IND3                                       CSD079
102990200529     C                             AND BBLICD <> W1IND4                                       CSD079
103000200529     C                             AND BBLICD <> W1IND5                                       CSD079
103010200529     C                   EVAL      W4CTYP = 'C'                                               CSD079
103020200529     C                   ELSE                                                                 CSD079
103030200529     C                   EVAL      W4CTYP = 'I'                                               CSD079
103040200529     C                   ENDIF                                                                CSD079
103050200529                                                                                              CSD079
103060200529     C                   ENDIF                                                                CSD079
103070200529                                                                                              CSD079
103080200529      ** Get the Counter Party (Midas Report Name + Customer Report Town)                     CSD079
103090200529                                                                                              CSD079
103100200529     C                   MOVEL     BBCRNM        W4CUST                                       CSD079
103110200529     C                   MOVE      BBCRTN        W4CUST                                       CSD079
103120200529                                                                                              CSD079
103130200529      ** Get converted dates                                                                  CSD079
103140200529                                                                                              CSD079
103150200529     C                   MOVE      '00000'       PINDATE                                      CSD079
103160200529     C                   EXSR      SRCVTDATE                                                  CSD079
103170200529     C                   MOVE      PCVTDDATE     W4DDAT                                       CSD079
103180200529                                                                                              CSD079
103190200529     C                   MOVE      '00000'       PINDATE                                      CSD079
103200200529     C                   EXSR      SRCVTDATE                                                  CSD079
103210200529     C                   MOVE      PCVTDDATE     W4VDAT                                       CSD079
103220200529                                                                                              CSD079
103230200529     C                   MOVE      '00000'       PINDATE                                      CSD079
103240200529     C                   EXSR      SRCVTDATE                                                  CSD079
103250200529     C                   MOVE      PCVTDDATE     W4MDAT                                       CSD079
103260200529                                                                                              CSD079
103270200529      ** Set-up second parameter for Compliance Engine                                        CSD079
103280200529                                                                                              CSD079
103290200529     C                   EVAL      PDSXML = *BLANKS                                           CSD079
103300200529                                                                                              CSD079
103310200529      ** Set-up Customer Name                                                                 CSD079
103320200529                                                                                              CSD079
103330200529     C                   IF        A_ADCNA1 <> B_E5CNA1                                       CSD079
103340200529     C                             OR WUNCF1 = 'Y'                                            CSD079
103350200529     C                   IF        A_ADCNA1 <> *BLANKS                                        CSD079
103360200529     C                   CAT       ARRTAG(1):0   PDSXML                                       CSD079
103370200529     C                   CAT       A_ADCNA1:0    PDSXML                                       CSD079
103380200529     C                   CAT       ARRTAG(2):0   PDSXML                                       CSD079
103390200529     C                   ENDIF                                                                CSD079
103400200529     C                   ENDIF                                                                CSD079
103410200529                                                                                              CSD079
103420200529      ** Set-up Address Lines                                                                 CSD079
103430200529                                                                                              CSD079
103440200529     C                   IF        A_ADCNA2 <> B_E5CNA2                                       CSD079
103450200529     C                             OR A_ADCNA3 <> B_E5CNA3                                    CSD079
103460200529     C                             OR A_ADCNA4 <> B_E5CNA4                                    CSD079
103470200529     C                             OR WUNCF1 = 'Y'                                            CSD079
103480200529     C                   EVAL      WADDAL = *BLANKS                                           CSD079
103490200529     C                   CAT       A_ADCNA2:0    WADDAL                                       CSD079
103500200529     C                   CAT       A_ADCNA3:1    WADDAL                                       CSD079
103510200529     C                   CAT       A_ADCNA4:1    WADDAL                                       CSD079
103520200529     C                   IF        WADDAL <> *BLANKS                                          CSD079
103530200529     C                   CAT       ARRTAG(3):0   PDSXML                                       CSD079
103540200529     C                   CAT       WADDAL:0      PDSXML                                       CSD079
103550200529     C                   CAT       ARRTAG(4):0   PDSXML                                       CSD079
103560200529     C                   ENDIF                                                                CSD079
103570200529     C                   ENDIF                                                                CSD079
103580200529                                                                                              CSD079
103590200529      ** Set-up Identity Number                                                               CSD079
103600200529                                                                                              CSD079
103610200529     C                   IF        A_ADIDNO <> B_E5IDNO                                       CSD079
103620200529     C                             OR WUNCF1 = 'Y'                                            CSD079
103630200529     C                   IF        A_ADIDNO <> *BLANKS                                        CSD079
103640200529     C                   CAT       ARRTAG(11):0  PDSXML                                       CSD079
103650200529     C                   CAT       A_ADIDNO:0    PDSXML                                       CSD079
103660200529     C                   CAT       ARRTAG(12):0  PDSXML                                       CSD079
103670200529     C                   ENDIF                                                                CSD079
103680200529     C                   ENDIF                                                                CSD079
103690200529                                                                                              CSD079
103700200529      ** Set-up Date of Birth                                                                 CSD079
103710200529                                                                                              CSD079
103720200529     C                   IF        A_ADBRTH <> B_E5BRTH                                       CSD079
103730200529     C                             OR WUNCF1 = 'Y'                                            CSD079
103740200529     C                   IF        A_ADBRTH > 0                                               CSD079
103750200529                                                                                              CSD079
103760200529      ** Convert Day No to DDMMMYY format                                                     CSD079
103770200529                                                                                              CSD079
103780200529     C                   CALLB     'ZDATE2'                                                   CSD079
103790200529     C                   PARM                    A_ADBRTH                                     CSD079
103800200529     C                   PARM                    BJDFIN                                       CSD079
103810200529     C                   PARM      *ZEROS        ZDATE                                        CSD079
103820200529     C                   PARM      *BLANK        ZADATE                                       CSD079
103830200529      *                                                                                       CSD079
103840200529     C                   CAT       ARRTAG(13):0  PDSXML                                       CSD079
103850200529     C                   CAT       ZADATE:0      PDSXML                                       CSD079
103860200529     C                   CAT       ARRTAG(14):0  PDSXML                                       CSD079
103870200529     C                   ENDIF                                                                CSD079
103880200529     C                   ENDIF                                                                CSD079
103890200529                                                                                              CSD079
103900200529      ** Send transaction details to Compliance Watch                                         CSD079
103910200529                                                                                              CSD079
103920200529     C                   IF        PDSXML <> *BLANKS                                          CSD079
103930200529     C                   CALL      'SDCWLCHK'                                                 CSD079
103940200529     C                   PARM                    PDSWLTD                                      CSD079
103950200529     C                   PARM                    PDSXML                                       CSD079
103960200529     C                   ENDIF                                                                CSD079
103970200529                                                                                              CSD079
103980200529     C                   ENDSR                                                                CSD079
103990200529      *****************************************************************                       CSD079
104000200529      /EJECT                                                                                  259191
104010200529      *****************************************************************                    AR1086546
104020200529      *                                                               *                    AR1086546
104030200529      *  UPDCTNM - Update Currency/Time of Netting Details            *                    AR1086546
104040200529      *                                                               *                    AR1086546
104050200529      *****************************************************************                    AR1086546
104060200529     C     UPDCTNM       BEGSR                                                             AR1086546
104070200529                                                                                           AR1086546
104080200529     C                   CALLB     'SDCTNMUPD'                                             AR1086546
104090200529                                                                                           AR1086546
104100200529      ** Ensure correct parameters for this UPD function                                   AR1086546
104110200529                                                                                           AR1086546
104120200529     C                   PARM      *BLANKS       @RTCD                                     AR1086546
104130200529     C                   PARM                    SDVCTNM                                   AR1086546
104140200529     C                   PARM      'Y'           From_Cust                                 AR1086546
104150200529                                                                                           AR1086546
104160200529      ** If there were any errors in the update functions,                                 AR1086546
104170200529                                                                                           AR1086546
104180200529     C     @RTCD         IFNE      *BLANK                                                  AR1086546
104190200529     C                   MOVEL     *BLANK        DBKEY                                     AR1086546
104200200529     C                   MOVEL     BBCUST        DBKEY                                     AR1086546
104210200529     C                   MOVEL     'SDCTNMPD'    DBFILE                                    AR1086546
104220200529     C                   MOVEL     072           DBASE                                     AR1086546
104230200529     C                   EXSR      SRERR                                                   AR1086546
104240200529     C                   ENDIF                                                             AR1086546
104250200529                                                                                           AR1086546
104260200529     C                   ENDSR                                                             AR1086546
104270200529                                                                                           AR1086546
104280200529      *****************************************************************                    AR1086546
104290200529**  CPY@
104300200529(c) Finastra International Limited 2001
104310200529** CMD1                                                                                       CSD012
104320200529OVRDBF FILE(SDCDSHL0) TOFILE(SDCDSHL0) SHARE(*NO)                                             CSD012
104330200529** CMD2                                                                                       CSD012
104340200529OVRDBF FILE(SDCBSHL0) TOFILE(SDCBSHL0) SHARE(*NO)                                             CSD012
104350200529** CMD3                                                                                       CSD012
104360200529OVRDBF FILE(SDPBSHL0) TOFILE(SDPBSHL0) SHARE(*NO)                                             CSD012
104370200529** CMD4                                                                                      BUG3362
104380200529OVRDBF FILE(SDTDSHL0) TOFILE(SDTDSHL0) SHARE(*NO)                                            BUG3362
104390200529** CMD5                                                                                     BUG14969
104400200529OVRDBF FILE(SDSWSHL0) TOFILE(SDSWSHL0) SHARE(*NO)                                           BUG14969
104410200529** CMDXC                                                                                      CGL132
104420200529OVRDBF FILE(SDCUSXL0) TOFILE(SDCUSXL0) SHARE(*NO)                                             CGL132
104430200529** CMDNH                                                                                    MD027115
104440200529OVRDBF FILE(SDFTNHL0) TOFILE(SDFTNHL0) SHARE(*NO)                                           MD027115
104450200529** CMDCS                                                                                    MD027115
104460200529OVRDBF FILE(SDFTCSL0) TOFILE(SDFTCSL0) SHARE(*NO)                                           MD027115
104470200529** CMDCR                                                                                    MD051230
104480200529OVRDBF FILE(SDCRSHL1) TOFILE(SDCRSHL1) SHARE(*NO)                                           MD051230
104490200529**  ARRTAG                                                                                    CSD015
104500200529<Customer Name>                                                                               CSD015
104510200529</Customer Name>                                                                              CSD015
104520200529<Address Lines>                                                                               CSD015
104530200529</Address Lines>                                                                              CSD015
104540200529<SWIFT BIC>                                                                                   CSD015
104550200529</SWIFT BIC>                                                                                  CSD015
104560200529<Country of Citizenship>                                                                      CSD015
104570200529</Country of Citizenship>                                                                     CSD015
104580200529<Country of Domicile>                                                                         CSD015
104590200529</Country of Domicile>                                                                        CSD015
104600200529<Identity Number>                                                                             CSD079
104610200529</Identity Number>                                                                            CSD079
104620200529<Date of Birth>                                                                               CSD079
104630200529</Date of Birth>                                                                              CSD079
104640200529** #@VC                                                                                       CSD027
104650200529ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789                                                          CSD027
