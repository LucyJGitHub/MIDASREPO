     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Italian Features Extension Files Purge')      *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SDM100 - Italian Features Extension Files Purge              *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2007            *
      *                                                               *
      *  Last Amend No. LUC139             Date 08Jan21               *
      *  Prev Amend No. CER010             Date 03Dec20               *
      *                 BUG14131*CREATE    Date 06Jun07               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  LUC139 - UCI Italian returns upgrade to FM2.1                *
      *  CER010 - PUMA II Interface to Minerva Upgrade to FM2.1       *
      *  BUG14131 - Correction in CER009 Deliverable Data             *
      *                                                               *
      *****************************************************************
      *
      ** Extension Files
      *
     FREACT1PDUF  E                    DISK         KINFSR *PSSR
     F*DLIRT1PDUF  E                    DISK         KINFSR *PSSR                LUC139
     FLECLT1PDUF  E                    DISK         KINFSR *PSSR
     FLEFCT1PDUF  E                    DISK         KINFSR *PSSR
     F**TIPT1PDUF  E                    DISK         KINFSR *PSSR                LUC139
     FDLFXT1PDUF  E                    DISK         KINFSR *PSSR
     FLEGTT1PDUF  E                    DISK         KINFSR *PSSR
     FDLNPT1PDUF  E                    DISK         KINFSR *PSSR
     F**RECUT1PDUF  E                    DISK         KINFSR *PSSR               LUC139
     FSDACT1PDUF  E                    DISK         KINFSR *PSSR
     FSDBKT1PDUF  E                    DISK         KINFSR *PSSR
     FSDCTT1PDUF  E                    DISK         KINFSR *PSSR
     FSDCRT1PDUF  E                    DISK         KINFSR *PSSR
     FSDCUT2PDUF  E                    DISK         KINFSR *PSSR
     FSDCUT1PDUF  E                    DISK         KINFSR *PSSR
     F**RESTT1PDUF  E                    DISK         KINFSR *PSSR               LUC139
     FDLLDT1PDUF  E                    DISK         KINFSR *PSSR                 LUC139
      *
      ** Main Files
      *
     FACCNTL0 IF  E           K        DISK         KINFSR *PSSR
     FCLOAN   IF  E           K        DISK         KINFSR *PSSR
     F            CLOANHHF                          KIGNORE
     F            CLOANCKF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
     F*CUSEX   IF  E           K        DISK         KINFSR *PSSR                         LUC139
     F*            CUSEXH1F                          KIGNORE                              LUC139
     F*            CUSEXZ1F                          KIGNORE                              LUC139
     FDEALSALLIF  E           K        DISK         KINFSR *PSSR
     F            DEALSDEF                          KIGNORE
     F            DLEHISD0                          KIGNORE
     F            MMDELDP0                          KIGNORE
     F            MMDENBP0                          KIGNORE
     F            MMDENSP0                          KIGNORE
     F            FXDEALP0                          KIGNORE
     FFCLTY   IF  E           K        DISK         KINFSR *PSSR
     F            FCLTYHHF                          KIGNORE
     F            FCLTYFNF                          KIGNORE
     F            FCLTYZZF                          KIGNORE
     FGTEES   IF  E           K        DISK         KINFSR *PSSR
     F            GTEESHHF                          KIGNORE
     F            GTEESZZF                          KIGNORE
     F*INPAY   IF  E           K        DISK         KINFSR *PSSR                         LUC139
     FMLOAN   IF  E           K        DISK         KINFSR *PSSR
     F            CLOANHHF                          KIGNORE
     F            CLOANCLF                          KRENAMEMLOANCLF
     F            CLOANCKF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
     F*OTPAY   IF  E           K        DISK         KINFSR *PSSR                         LUC139
     FSDACODL0IF  E           K        DISK         KINFSR *PSSR
     FSDBOOKL0IF  E           K        DISK         KINFSR *PSSR
     FSDCTRYL0IF  E           K        DISK         KINFSR *PSSR
     FSDCURRL0IF  E           K        DISK         KINFSR *PSSR
     FSDCUSTL0IF  E           K        DISK         KINFSR *PSSR
     F*STAND   IF  E           K        DISK         KINFSR *PSSR                         LUC139
     F*            STANDSAF                          KIGNORE                              LUC139
      *
     IGTEESGTF
     I              COLC                            GCOLC
      *
     C           KACC      KLIST
     C                     KFLD           PQCNUM
     C                     KFLD           PQCCY
     C                     KFLD           PQACOD
     C                     KFLD           PQACSQ
     C                     KFLD           PQBRCA
      *
     C           KFAC      KLIST
     C                     KFLD           PRCNUM
     C                     KFLD           PRFACT
     C                     KFLD           PRFCNO
      *
     C           KGUA      KLIST
     C                     KFLD           XPCNUM
     C                     KFLD           XPFCLN
     C                     KFLD           XPGUSN
      *
      ** MAIN LINE: one subroutine per extension file
      *
     C                     EXSR ACODXP
     C                     EXSR BOOKXP
     C                     EXSR CTRYXP
     C                     EXSR CURRXP
     C                     EXSR CUSTXP
     C**********           EXSR CUSXXP                                                LUC139
     C                     EXSR FCTYXP
     C**********           EXSR FRIRXP                                                LUC139
     C**********           EXSR FUTRXP                                                LUC139
     C                     EXSR FXDLXP
     C                     EXSR GLACXP
     C                     EXSR GUARXP
     C                     EXSR MMDLXP
     C                     EXSR LOANXP
     C**********           EXSR STANXP                                                LUC139
     C                     EXSR CUSTXI
      *
     C                     MOVE *ON       *INLR
      /EJECT
      *****************************************************************
      *                                                               *
      *  ACODXP - Purge SDACT1PD (Account Codes Puma extension)       *
      *                                                               *
      *****************************************************************
      *
     C           ACODXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ SDACT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PMACCD    CHAINSDACODL0             02
     C           *IN02     IFEQ *ON
     C                     DELETSDACT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ SDACT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      *  BOOKXP - Purge SDBKT1PD (Book Codes Puma extension)          *
      *                                                               *
      *****************************************************************
      *
     C           BOOKXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ SDBKT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PDBKCD    CHAINSDBOOKL0             02
     C           *IN02     IFEQ *ON
     C                     DELETSDBKT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ SDBKT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      *  CTRYXP - Purge SDCTT1PD (Country Codes Puma extension)       *
      *                                                               *
      *****************************************************************
      *
     C           CTRYXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ SDCTT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PECNCD    CHAINSDCTRYL0             02
     C           *IN02     IFEQ *ON
     C                     DELETSDCTT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ SDCTT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * CURRXP - Purge SDCRT1PD (Currencies Puma extension)           *
      *                                                               *
      *****************************************************************
      *
     C           CURRXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ SDCRT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PBCYCD    CHAINSDCURRL0             02
     C           *IN02     IFEQ *ON
     C                     DELETSDCRT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ SDCRT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * CUSTXP - Purge SDCUT1PD (Customers Puma extension)            *
      *                                                               *
      *****************************************************************
      *
     C           CUSTXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ SDCUT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           BBCUST    CHAINSDCUSTL0             02
     C           *IN02     IFEQ *ON
     C                     DELETSDCUT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ SDCUT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * CUSXXP - Purge RECUT1PD (Customer Exchanges Puma extension)   *
      *                                                               *
      *****************************************************************
      *
     C********** CUSXXP    BEGSR                                                            LUC139
      *
      ** For each extension record
      *
     C**********           READ RECUT1D0                 01                                 LUC139
     C********** *IN01     DOWEQ*OFF                                                        LUC139
      *
      ** If main record not found, delete extension record
      *
     C********** PVIPDN    CHAINCUSEX                02                                     LUC139
     C********** *IN02     IFEQ *ON                                                         LUC139
     C**********           DELETRECUT1D0                                                    LUC139
     C**********           ENDIF                                                            LUC139
      *
      ** Read the next record
      *
     C**********           READ RECUT1D0                 01                                 LUC139
      *
     C**********           ENDDO                                                            LUC139
      *
     C**********           ENDSR                                                            LUC139
      /EJECT
      *****************************************************************
      *                                                               *
      * FCTYXP - Purge LEFCT1PD (Facilities Puma extension)           *
      *                                                               *
      *****************************************************************
      *
     C           FCTYXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ LEFCT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           KFAC      CHAINFCLTY                02
     C           *IN02     IFEQ *ON
     C                     DELETLEFCT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ LEFCT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * FRIRXP - Purge DLIRT1PD (FRA/IRS Deals Puma extension)        *
      *                                                               *
      *****************************************************************
      *
     C********** FRIRXP    BEGSR                                                           LUC139
      *
      ** For each extension record
      *
     C**********           READ DLIRT1D0                 01                                LUC139
     C********** *IN01     DOWEQ*OFF                                                       LUC139
      *
      ** If main record not found, delete extension record
      *
     C********** PKDLNO    CHAINDEALSDGF             02                                    LUC139
     C********** *IN02     IFEQ *ON                                                        LUC139
     C********** PKDLNO    CHAINDLGHISD0             03                                    LUC139
     C********** *IN03     IFEQ *ON                                                        LUC139
     C**********           DELETDLIRT1D0                                                   LUC139
     C**********           ENDIF                                                           LUC139
     C**********           ENDIF                                                           LUC139
      *
      ** Read the next record
      *
     C**********           READ DLIRT1D0                 01                                LUC139
      *
     C**********           ENDDO                                                           LUC139
      *
     C**********           ENDSR                                                           LUC139
      /EJECT
      *****************************************************************
      *                                                               *
      * FUTRXP - Purge FTIPT1PD (Funds Transfer Puma extension)       *
      *                                                               *
      *****************************************************************
      *
     C********** FUTRXP    BEGSR                                                    LUC139
      *
      ** For each extension record
      *
     C**********           READ FTIPT1D0                 01                         LUC139
     C********** *IN01     DOWEQ*OFF                                                LUC139
      *
      ** If main record not found, delete extension record
      *
     C********** IPPREF    CHAININPAY                02                             LUC139
     C********** *IN02     IFEQ *ON                                                 LUC139
     C********** IPPREF    CHAINOTPAY                03                             LUC139
     C********** *IN03     IFEQ *ON                                                 LUC139
     C**********           DELETFTIPT1D0                                            LUC139
     C**********           ENDIF                                                    LUC139
     C**********           ENDIF                                                    LUC139
      *
      ** Read the next record
      *
     C**********           READ FTIPT1D0                 01                         LUC139
      *
     C**********           ENDDO                                                    LUC139
      *
     C**********           ENDSR                                                    LUC139
      /EJECT
      *****************************************************************
      *                                                               *
      * FXDLXP - Purge DLFXT1PD (FX Deals Puma extension)             *
      *                                                               *
      *****************************************************************
      *
     C           FXDLXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ DLFXT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PJDN38    CHAINDEALSDBF             02
     C           *IN02     IFEQ *ON
     C           PJDN38    CHAINDLBHISD0             03
     C           *IN03     IFEQ *ON
     C                     DELETDLFXT1D0
     C                     ENDIF
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ DLFXT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * GLACXP - Purge REACT1PD (Accounts Puma extension)             *
      *                                                               *
      *****************************************************************
      *
     C           GLACXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ REACT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           KACC      CHAINACCNTL0              02
     C           *IN02     IFEQ *ON
     C                     DELETREACT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ REACT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * GUARXP - Purge LEGTT1PD (Guarantees Puma extension)           *
      *                                                               *
      *****************************************************************
      *
     C           GUARXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ LEGTT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           KGUA      CHAINGTEES                02
     C           *IN02     IFEQ *ON
     C                     DELETLEGTT1D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ LEGTT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * LOANXP - Purge LECLT1PD (Loans Puma extension)                *
      *                                                               *
      *****************************************************************
      *
     C           LOANXP    BEGSR
      *
      ** For each extension record
      *
     C                     READ LECLT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PFLNRF    CHAINCLOAN                02
     C           *IN02     IFEQ *ON
     C           PFLNRF    CHAINMLOANCLF             03
     C           *IN03     IFEQ *ON
     C                     DELETLECLT1D0
     C                     ENDIF
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ LECLT1D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * MMDLXP - Purge DLNPT1PD (MM Deals Puma extension)             *
      *                                                               *
      *****************************************************************
      *
     C           MMDLXP    BEGSR
      *
      ** For each extension record - NEGOTIABLE ASSETS                                      LUC139
      *
     C                     READ DLNPT1D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PIDN38    CHAINDEALSDDF             04
     C           *IN04     IFEQ *ON
     C           PIDN38    CHAINDLDHISD0             05
     C           *IN05     IFEQ *ON
     C                     DELETDLNPT1D0
     C                     ENDIF
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ DLNPT1D0                 01
      *
     C                     ENDDO
      *
      ** For each extension record  - MM DEALS                                              LUC139
      *                                                                                     LUC139
     C                     READ DLLDT1D0                 01                                 LUC139
     C           *IN01     DOWEQ*OFF                                                        LUC139
      *                                                                                     LUC139
      ** If main record not found, delete extension record                                  LUC139
      *                                                                                     LUC139
     C           PIDN38    CHAINDEALSDCF             02                                     LUC139
     C           *IN02     IFEQ *ON                                                         LUC139
     C           PIDN38    CHAINDLCHISD0             03                                     LUC139
     C           *IN03     IFEQ *ON                                                         LUC139
     C                     DELETDLLDT1D0                                                    LUC139
     C                     ENDIF                                                            LUC139
     C                     ENDIF                                                            LUC139
      *                                                                                     LUC139
      ** Read the next record                                                               LUC139
      *                                                                                     LUC139
     C                     READ DLLDT1D0                 01                                 LUC139
      *                                                                                     LUC139
     C                     ENDDO                                                            LUC139
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * STANXP - Purge RESTT1PD (Standing Orders Puma extension)      *
      *                                                               *
      *****************************************************************
      *
     C********** STANXP    BEGSR                                                              LUC139
      *
      ** For each extension record
      *
     C**********           READ RESTT1D0                 01                                   LUC139
     C********** *IN01     DOWEQ*OFF                                                          LUC139
      *
      ** If main record not found, delete extension record
      *
     C********** PWSTOR    CHAINSTAND                02                                       LUC139
     C********** *IN02     IFEQ *ON                                                           LUC139
     C**********           DELETRESTT1D0                                                      LUC139
     C**********           ENDIF                                                              LUC139
      *
      ** Read the next record
      *
     C**********           READ RESTT1D0                 01                                   LUC139
      *
     C**********           ENDDO                                                              LUC139
      *
     C**********           ENDSR                                                              LUC139
      /EJECT
      *****************************************************************
      *                                                               *
      * CUSTXI - Purge SDCUT2PD (Customers Italian extension)         *
      *                                                               *
      *****************************************************************
      *
     C           CUSTXI    BEGSR
      *
      ** For each extension record
      *
     C                     READ SDCUT2D0                 01
     C           *IN01     DOWEQ*OFF
      *
      ** If main record not found, delete extension record
      *
     C           PCCUST    CHAINSDCUSTL0             02
     C           *IN02     IFEQ *ON
     C                     DELETSDCUT2D0
     C                     ENDIF
      *
      ** Read the next record
      *
     C                     READ SDCUT2D0                 01
      *
     C                     ENDDO
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     MOVE *ON       *INU7
     C                     MOVE *ON       *INU8
     C                     MOVE *ON       *INLR
      *
     C                     DUMP
     C                     ENDIF
      *
     C                     ENDSR
