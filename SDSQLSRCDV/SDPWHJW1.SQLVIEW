/*******************************************************************************/
/*                                                                             */
/*       Midas - Standing Data Module                                          */
/*                                                                             */
/*       SDPWHJW1 - Midas SD Midas system pulldown list headers Joint          */
/*                                                                             */
/*       (c) Finastra International Limited 2020                               */
/*                                                                             */
/*       Last Amend No. MD056557 *CREATE   Date 31Aug20                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       MD056557 - Deliverable Data Split for Pulldown                        */
/*                                                                             */
/*******************************************************************************/
                                                                                :
  create view                                                                   :
  **********/**********                                                         :
                                                                                :
  (                                                                             :
       GHHIND                                                                   :
     , GHMMID                                                                   :
     , GLGRUP                                                                   :
     , GHDESC                                                                   :
     , GHMMSN                                                                   :
     , GTSARN                                                                   :
     , FOMMIN                                                                   :
     , GTAVAL                                                                   :
     , SARN                                                                     :
     , ENABLD                                                                   :
     , GTDIND                                                                   :
     , GHZONE                                                                   :
     , GHMODE                                                                   :
  )                                                                             :
  as select                                                                     :
       a.GHHIND                                                                 :
     , a.GHMMID                                                                 :
     , a.GLGRUP                                                                 :
     , a.GHDESC                                                                 :
     , a.GHMMSN                                                                 :
     , b.GTSARN                                                                 :
     , d.FOMMIN                                                                 :
     , b.GTAVAL                                                                 :
     , c.SARN                                                                   :
     , c.ENABLD                                                                 :
     , b.GTDIND                                                                 :
     , a.GHZONE                                                                 :
     , a.GHMODE                                                                 :
  from SDPWHJW0 a                                                               :
  LEFT OUTER JOIN SCSARWPD b on                                                 :
  ( a.GHHIND = b.GTHIND )                                                       :
  LEFT OUTER JOIN SCSRDXTD c on                                                 :
  ( b.GTSARN = c.SARN )                                                         :
  LEFT OUTER JOIN SDMMIDPD d on                                                 :
  ( a.GHMMSN = d.FOMMSN)                                                        :
                                                                                :
  WHERE                                                                         :
  ( b.GTSARN IS NULL AND d.FOMMIN = 'Y' AND b.GTDIND IS NULL ) OR               :
  ( b.GTSARN IS NOT NULL AND c.SARN IS NOT NULL AND c.ENABLD = 'E'              :
  AND b.GTAVAL = 'Y' AND d.FOMMIN = 'Y' AND b.GTDIND IS NULL ) OR               :
  ( b.GTSARN IS NOT NULL AND c.SARN IS NULL AND b.GTAVAL = 'N'                  :
  AND d.FOMMIN = 'Y' AND b.GTDIND IS NULL ) OR                                  :
  ( b.GTSARN IS NOT NULL AND c.SARN IS NOT NULL AND c.ENABLD = 'D'              :
  AND b.GTAVAL = 'N' AND d.FOMMIN = 'Y' AND b.GTDIND IS NULL )                  :
                                                                                :
  rcdfmt SDPWHJT1;                                                              :
                                                                                :
  label on table     **********/**********                                      :
   is 'Midas SD Midas system pulldown list headers Joint';                      :
                                                                                :
/******************************************************************************/
