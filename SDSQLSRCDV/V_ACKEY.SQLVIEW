/*******************************************************************************/
/*                                                                             */
/*       Midas - Standing Data Module                                          */
/*                                                                             */
/*       V_ACKEY - Account Keys View (Dealing, Securities, Funds Transfer)     */
/*                                                                             */
/*       (c) Finastra International Limited 2005                               */
/*                                                                             */
/*       Last Amend No. CSD103             Date 10Aug20                        */
/*       Prev Amend No. MD046248           Date 27Oct17                        */
/*                      CLE164             Date 18Aug14                        */
/*                      AR1022007          Date 23Aug12                        */
/*                      CLE134             Date 01Aug12                        */
/*                      CER049             Date 06Dec10                        */
/*                      CER059             Date 19Jul10                        */
/*                      CER047             Date 19May08                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/* Midas Plus 1.4 Base --------------------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      CSD031             Date 10Apr06                        */
/*                      BUG1119            Date 12Apr06                        */
/*                      BUG1100            Date 10Apr06                        */
/*                      BUG10491           Date 08Feb06                        */
/*                      CLE042             Date 06Sep05                        */
/*                      CAK001  *CREATE    Date 02Nov05                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CSD103 - LIBOR Deregulation - Common Layer/Standing Data (Recompile)  */
/*       MD046248 - Finastra Rebranding                                        */
/*       CLE164 - CLE134 Enhancement F (Repayment Methodology)                 */
/*                (Recompile)                                                  */
/*       AR1022007 - [PDP] CC001 - Incorporate SM007 in PDP (Recompile)        */
/*       CLE134 - Past Due Call Loan Processing (Recompile)                    */
/*       CER049 - Stamp Tax (Recompile)                                        */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER047 - German Features LF037-00 Reporting §24c                      */
/*                (Recompile)                                                  */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       BUG11190 - Book Code for Future & Options has a length of 2A.         */
/*       BUG11004 - Module should be FF for Future and Options instead of FT   */
/*       BUG10491 - Enhancement on CAK001                                      */
/*       CLE042 - Extended Loan Sub Type (Recompile)                           */
/*       CAK001 - Account Keys                                                 */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW
  **********/**********
  AS
  SELECT 'DL' AS MOD,
         AKEY AS ACCTKEY,
         SUBSTRING(AKEY, 1, 2) AS TRANSTYP,
         SUBSTRING(AKEY, 3, 1) AS EVENTTYP,
         SUBSTRING(AKEY, 4, 2) AS TRSUBTYP,
         '   ' AS INVTYP,
         '  ' AS BOOKCOD,
         ' ' AS PROCTYPE,
         DIGITS(ACD1) AS ACD1,
         DIGITS(ACD2) AS ACD2,
         DIGITS(ACD3) AS ACD3,
         DIGITS(ACD4) AS ACD4,
         DIGITS(ACD5) AS ACD5,
         DIGITS(ACD6) AS ACD6,
         PRF1, PRF2, PRF3, PRF4, PRF5, PRF6,
         NCD1 AS NC1, NCD2 AS NC2, NCD3 AS NC3,
*********NCD4*AS*NC4,*NCD5*AS*NC5,*NCD6*AS*NC6,*NCD1*AS*NCX*********************            BUG10491
         NCD4 AS NC4, NCD5 AS NC5, NCD6 AS NC6, NCD1 AS NCX,                                BUG10491
         SUBSTRING(AKEY, 11, 4) AS CLASS                                                    BUG10491
  FROM ACKEYAL
  WHERE SUBSTRING(AKEY, 1, 2) IN (SELECT DTPE11 FROM FDDTSTPD)
  UNION
  SELECT 'LE' AS MOD,
         AKEY AS ACCTKEY,
         SUBSTRING(AKEY, 1, 2) AS TRANSTYP,
         SUBSTRING(AKEY, 3, 1) AS EVENTTYP,
         SUBSTRING(AKEY, 4, 2) AS TRSUBTYP,
         '   ' AS INVTYP,
         '  ' AS BOOKCOD,
         ' ' AS PROCTYPE,
         DIGITS(ACD1) AS ACD1,
         DIGITS(ACD2) AS ACD2,
         DIGITS(ACD3) AS ACD3,
         DIGITS(ACD4) AS ACD4,
         DIGITS(ACD5) AS ACD5,
         DIGITS(ACD6) AS ACD6,
         PRF1, PRF2, PRF3, PRF4, PRF5, PRF6,
         NCD1 AS NC1, NCD2 AS NC2, NCD3 AS NC3,
*********NCD4*AS*NC4,*NCD5*AS*NC5,*NCD6*AS*NC6,*NCD1*AS*NCX*********************            BUG10491
         NCD4 AS NC4, NCD5 AS NC5, NCD6 AS NC6, NCD1 AS NCX,                                BUG10491
         SUBSTRING(AKEY, 11, 4) AS CLASS                                                    BUG10491
  FROM ACKEYAL
  WHERE SUBSTRING(AKEY, 1, 2) IN (SELECT AYLNTY FROM SDLOANPD)
  UNION
  SELECT 'SE' AS MOD,
         ACKE AS ACCTKEY,
         '  ' AS TRANSTYP,
         SUBSTRING(ACKE, 4, 1) AS EVENTTYP,
         '  ' AS TRSUBTYP,
         SUBSTRING(ACKE, 1, 3) AS INVTYP,
         SUBSTRING(ACKE, 7, 2) AS BOOKCOD,
         ' ' AS PROCTYPE,
         DIGITS(ACD1) AS ACD1,
         DIGITS(ACD2) AS ACD2,
         DIGITS(ACD3) AS ACD3,
         DIGITS(ACD4) AS ACD4,
         DIGITS(ACD5) AS ACD5,
         DIGITS(ACD6) AS ACD6,
         PRF1, PRF2, PRF3, PRF4, PRF5, PRF6,
         NCDA1 AS NC1, NCDA2 AS NC2, NCDA3 AS NC3,
*********NCDA4*AS*NC4,*NCDA5*AS*NC5,*NCDA6*AS*NC6,*NCDA1*AS*NCX*****************            BUG10491
         NCDA4 AS NC4, NCDA5 AS NC5, NCDA6 AS NC6, NCDA1 AS NCX,                            BUG10491
         '    ' AS CLASS                                                                    BUG10491
  FROM SEACKD
  UNION
**SELECT*'FT'*AS*MOD,***********************************************************            BUG11004
  SELECT 'FF' AS MOD,                                                                       BUG11004
         FFKY AS ACCTKEY,
         '  ' AS TRANSTYP,
         SUBSTRING(FFKY, 3, 1) AS EVENTTYP,
         '  ' AS TRSUBTYP,
         '   ' AS INVTYP,
*********SUBSTRING(FFKY,*4,*1)*AS*BOOKCOD,**************************************            BUG11190
         SUBSTRING(FFKY, 4, 2) AS BOOKCOD,                                                  BUG11190
         SUBSTRING(FFKY, 2, 1) AS PROCTYPE,
         DIGITS(ACD1) AS ACD1,
         DIGITS(ACD2) AS ACD2,
         DIGITS(ACD3) AS ACD3,
         DIGITS(ACD4) AS ACD4,
         DIGITS(ACD5) AS ACD5,
         DIGITS(ACD6) AS ACD6,
         PRF1, PRF2, PRF3, PRF4, PRF5, PRF6,
         NRC1 AS NC1, NRC2 AS NC2, NRC3 AS NC3,
*********NRC4*AS*NC4,*NRC5*AS*NC5,*NRC6*AS*NC6,*NRC1*AS*NCX*********************            BUG10491
         NRC4 AS NC4, NRC5 AS NC5, NRC6 AS NC6, NRC1 AS NCX,                                BUG10491
         '    ' AS CLASS                                                                    BUG10491
  FROM FACKYD
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Account Keys Temporary View                       ';                     :
                                                                                :
