     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Investment types maintenance')                *
/*XBI1*: OVRDBF FILE(INVTPX) TOFILE(INVTP) SHARE(*NO)               : *
/*XBI2*  OVRDBF FILE(GPPRDXL0) TOFILE(GPPRODXL0)                      *                       CGP001
/*XBI3*  OVRDBF FILE(GPINSXL0) TOFILE(GPINSTXL0)                      *                       CGP001
      *****************************************************************
      *                                                               *
      *  Midas - Securities Trading Module                            *
      *                                                               *
      *  SE0020 - INVESTMENT TYPES MAINTENANCE                        *
      *                                                               *
      *  Function: This program allows the maintenance and validation *
      *   (I/C)    of Investment Types.                               *
      *                                                               *
      *  Called By: SEC02 - Input Cycle Processing                    *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD029691           Date 13Aug14               *
      *                 MD029686           Date 13Aug14               *
      *                 MD021025           Date 24Jun13               *
      *                 255423             Date 13Nov12               *
      *                 AR317764           Date 22Aug12               *
      *                 255460             Date 14Sep10               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG23049           Date 23Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 241200             Date 27Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 CSE071             Date 19Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6307            Date 18Mar05               *
      *                 BUG6203            Date 16Mar05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 BUG3122            Date 17Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2210            Date 07May04               *
      *                 BG1350             Date 01Mar04               *
      *                 CAAA02             Date 05Feb04               *
      *                 CGP001             Date 23May03               *
      *                 207543             Date 17JUL02               *
      *                 CSE037             Date 29Apr02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSE032             Date 13Dec01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE022             Date 29Mar01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 176813             Date 05Feb01               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             DATE 28Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPL002             DATE 08Mar99               *
      *                 S01408             DATE 14Jan98               *
      *                 066850             DATE 29OCT97               *
      *                 104633             DATE 07NOV96               *
      *                 S01408             DATE 13AUG96               *
      *                 S01408             DATE 01FEB96               *
      *                 S01408             DATE 07SEP95               *
      *                 088309             DATE 15JUN95               *
      *                 085494             DATE 06JUN95               *
      *                 080770             DATE 28DEC94               *
      *                 080099             DATE 20DEC94               *
      *                 S01486  LV         DATE 18OCT94               *
      *                 S01496  JSV        DATE 05OCT94               *
      *                 S01502             DATE 08JUL94               *
      *                 067123             DATE 15JUN94               *
      *                 064332             DATE 19APR94               *
      *                 052254             DATE 05JAN94               *
      *                 E48038             DATE  1FEB93               *
      *                 E44886             DATE 23SEP92               *
      *                 S01397             DATE 14SEP92               *
      *                 E25992             DATE 04JLY91               *
      *                 E24360             DATE 18JAN91               *
      *                 S01117             DATE 26NOV90               *
      *                 S01269             DATE 01AUG90               *
      *                 E22170             DATE 02AUG90               *
      *                 E22109             DATE 10JUN90               *
      *                 E20987             DATE 30JAN90               *
      *                 S01232             DATE 12DEC89               *
      *                 E20020             DATE 30OCT89               *
      *                 E19899             DATE 18OCT89               *
      *                 S01199             DATE 01/08/89              *
      *                 S01219             DATE 27/07/89              *
      *                 E16868             DATE 02/03/89              *
      *                 S01179             DATE 21/10/88              *
      *                 S01176             DATE 10/11/88              *
      *                 S01169             DATE 10/11/88              *
      *                 E14434             DATE 26/07/88              *
      *                 S01158             DATE 05/05/88              *
      *                 S05434             DATE 29/01/88              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD029691 - Incorrect validation of Yield Basis with CSE032.  *
      *  MD029686 - Unable to access investment type menu due to      *
      *             encountered database error 03.                    *
      *  MD021025 - Validate non-blank action codes only              *
      *  255423 - SD system shows an error in correct field (Action)  *
      *           by highlighting (in red color) the field.           *
      *  AR317764 - Unable to extract data from some fields of RUDWH  *
      *             library tables - Securities. Initialise NDEC      *
      *             field to zero. (Child: AR317765)                  *
      *  255460 - Use Reverse Image attribute for errors to prevent   *
      *           unexpected symbol caused by BITON.                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  BUG23049 - "Instrument Type" Field missing from Investment   *
      *             Type API                                          *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  241200 - Do not allow Day Basis 4 for Discounts.             *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6307- Global Product and Instrument should be non-manda-  *
      *           tory.                                               *
      *  BUG6203 - User able to insert Investment type without        *
      *            currency                                           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2210- Price and trade basis fields become amendable when  *
      *           error occurred during amendment.                    *
      *  BG1350 - Errors in investment types input                    *
      *  CAAA02 - Midasplus webfacing changes                         *
      *  CGP001 - Global Processing                                   *
      *  207543 - CEU018 NOT WORKING ON A PRICE BASIS, MISSING A PART *
      *           OF AUS047.                                          *
      *  CSE037 - Countervalue rounding                               *
      *  CSE032 - Allow entry of yield basis if trade basis and       *
      *           price basis are 'P'                                 *
      *  CSE022 - Depository Definition Enhancement                   *
      *  176813 - Fix to prevent DB error in depo movements           *
      *           in API programs. APPLIED FIX 164689.                *
      *  CPB001 - 'Private Banking' Module                            *
      *  CPL002   Midas-Plato Interface.                              *
      *  S01408 - Addition core hook SE0020E001.                      *
      *  066850 - When roll down of screen page requested, it always  *
      *           displays the first page.  Fixed to display the      *
      *           correct previous page.                              *
      *  104633 - GUI Amendments to DSPF with non-standard footers    *
      *  S01408 - Addition core hook SE0020FFP1.                      *
      *         - Addition core hook SE0020CCP7.                      *
      *         - Addition core hook SE0020CCP6.                      *
      *  S01408 - Addition core hook SE0020CCP5.                      *
      *  S01408 - Addition core hook SE0020IIP1.                      *
      *           Addition core hook SE0020IIP2.                      *
      *           Addition core hook SE0020CCP1.                      *
      *           Addition core hook SE0020CCP2.                      *
      *           Addition core hook SE0020CCP3.                      *
      *           Addition core hook SE0020CCP4.                      *
      *           Addition core hook SE0020EEP1.                      *
      *           Addition core hook SE0020EEP2.                      *
      *  088309 - Allow price basis 'U' for processing type '1'.      *
      *  085494 - Prevent deletion if investment type if there are    *
      *           live securities for this investment type.           *
      *  080870 - Screen should be redisplayed after '?' selection.   *
      *  080099 - '?' processing on Instrument type does not work     *
      *           properly.                                           *
      *  S01486 - Incorporation of PM Enhancement  (S01235).          *
      *  S01496 - Incorporation of Jyske Enhancements (S10981).       *
      *  S01502 - BLI Telekurs processing. Recompiled due to change   *
      *           in length of SESTAT, 133 Long.                      *
      *  067123 - Prevent program crash if more tham 19 screen errors.*
      *           Increase array size to 40.                          *
      *  064332 - Added validation for Price Basis.                   *
      *  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
      *           to 10,9                                             *
      *  E48038 - CURSOR POSITIONING PROBLEMS                         *
      *         - COMPOUNDING FREQUENCY NOT BEING INITIALISED         *
      *  E44886 - Error fix for S01397 to correctly display 3 new     *
      *           fields                                              *
      *  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
      *          - New Zealand Bond Formula.                          *
      *  E25992 - DAY BASIS 5 IS ALSO VALID FOR DEFAULT DAY BASIS     *
      *  E24360 - SETTLEMENT DEPOTS CAN ONLY HAVE A CLASSIFICATION    *
      *           TYPE OF E,K,C,X OR M ON THE SECURITY CLIENT FILE.   *
      *  S01117 - Multibranching.                                     *
      *  S01269 - Trade authorisation: Recompiled for change to file  *
      *           TABSE                                               *
      *  E22170 - It is possible to ignore ERROR CODE 226, for the    *
      *           Market Indicator field by pressing ENTER twice.     *
      *  E22109 - ROLLUP/ROLLDOWN did not function correctly.         *
      *  E20987 - VLDCMDKEY is now 13 on the DDS, not 15. Program     *
      *           amended in line with fix (E16868).                  *
      *  S01232 - Australian Yields - add Yield Method 'AU'.          *
      *  E20020 - Contingent Liability field should default to'N',    *
      *           not blank  (FS Page 4-5).                           *
      *  E19899 - Recompiled for 'RATING' field changes.              *
      *  S01199 - Help System.                                        *
      *  S01219 - SE Module functionality split.                      *
      *  E16868 - When return to detail screen from HELP, only the    *
      *           Investment Type Name is displayed.                  *
      *           (Change made to SE0020DF thus SE0020 recompiled).   *
      *  S01179 - The keyword RTGAID is no longer supported on AS400  *
      *   and command keys and indicators have been used to replace   *
      *   this in the display file. To disrupt the structure of the   *
      *   program as little as possible a new subroutine - ASCHGS -   *
      *   has been coded. This moves the values which would have      *
      *   been passed to the program (via RTGAID) into the AID        *
      *   field depending on which function key has been pressed.     *
      *  S01176 - SEC. TRAD. 3.1                                      *
      *  S01169 - JULIUS BAER INCORPORATION                           *
      *  E14434 - FOR PROC. TYPES 2,4 & 7, CONVERTIBLE INDICATOR      *
      *           MUST BE BLANK. BUT IF LEFT BLANK 'N' IS WRITTEN     *
      *           TO FILE, CAUSING ERROR ON AMENDMENT.                *
      *  S01158 - POST INCORPORATION DEVELOPMENT FIX                  *
      *  S05434 - INSERT OF NEW FIELD, THE VALUATION                  *
      *           SEQUENCE NUMBER, FOR VALUATIONS                     *
      *                                                               *
      *****************************************************************
      *
     FSE0020DFCF  E                    WORKSTN      KINFDS SCRDS
     F                                        RRN   KSFILE SUBFLREC
     FINVTP   UF  E           K        DISK         KCOMIT       A
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     FINVTPX  IF  E           K        DISK
     F            INVTPDF                           KRENAMEINVTPDFX
     FINVTPA  UF  E                    DISK         KCOMIT
     FSECTYC  IF  E           K        DISK                               085494
     F***TABSE***IF**E****       K        DISK                            S01117
     F**ICD*1*****TABTB10F                          KIGNORE               S01117
     F************TABTB11F                          KIGNORE               S01117
     F************TABTB40F                          KIGNORE               S01117
     F**CCY*1*****TABTG10F                          KIGNORE               S01117
     F************TABTG20F                          KIGNORE               S01117
     F**DCNR******TABLETHF                          KIGNORE               S01176
     F************TABLETJF                          KIGNORE               S01117
     F************TABLETLF                          KIGNORE               S01117
     F************TABLET2F                          KIGNORE               S01117
     F************TABLET3F                          KIGNORE               S01117
     F************TABTE10F                          KIGNORE               S01117
     F************TABTE20F                          KIGNORE               S01117
     F**DIND******TABLETNF                          KIGNORE               S01176
     F************TABLETKF                          KIGNORE               S01117
     F************TABLETPF                          KIGNORE               S01117
     F************TABLETRF                          KIGNORE               S01117
     F*
     FSEMKC   IF  E           K        DISK
     F*
     F***CLINT***IF**E***        K        DISK                            S01117
     F************CLINTCAF                          KIGNORE               S01117
     F************CLINTC1F                          KIGNORE               S01117
     F************CLINTCCF                          KIGNORE               S01117
     F***SNAME***IF**E***        K        DISK                            S01117
     F************CLINTCBF                          KRENAMESNAMEF         S01117
     F*                                                                   S01408
     FGPPRDXL0UF  E           K        DISK                      A    UC                      CGP001
     F                                              KINFSR *PSSR                              CGP001
     F            GPPRODXD0                         KRENAMEGPPRDXD0                           CGP001
     F                                              KCOMIT                                    CGP001
      ** Midas GP Global Products X-Reference                                                 CGP001
      *                                                                                       CGP001
     FGPINSXL0UF  E           K        DISK                      A    UC                      CGP001
     F                                              KINFSR *PSSR                              CGP001
     F            GPINSTXD0                         KRENAMEGPINSXD0                           CGP001
     F                                              KCOMIT                                    CGP001
      ** Midas GP Global Instruments X-Reference                                              CGP001
      *                                                                                       CGP001
     F/COPY WNCPYSRC,SE0020FFP1                                           S01408
     F*                                                                   S01408
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   01  - S/SUBFLCTL  SFLDSP                                    *
     F*   02  - S/SUBFLCTL  SFLDSPCTL                                 *
     F*   03  - S/SUBFLCTL  SFLEND                                    *
     F*   04  - S/SUBFLCTL  SFLMSG                                    *
     F*   05  - S/KEYINPUT  Protect/Non-Display on location           *
     F*   06  - S/RECDETLS  Protect fields                            *
     F*                                                               *
     F*   10  - Start  Screen                                         *
     F*   11  - Review Screen                                         *
     F*   12  - Update Screen                                         *
     F*   13  - VLDCMDKEY                                             *   E16868
     F*   15  - Title only Investment Type Screen                     *   S01176
     F****16**-*YIELD*TYPE*'AU'*************************************S01397E44886
     F*                                                               *
     F* 26-27 - Number or Shortname entered                           *
     F*                                                               *
     F*   20  - S/KEYINPUT  An Error on Screen                        *
     F*   21  - S/KEYINPUT  Error-ACTN                                *
     F*   22  - S/KEYINPUT  Error-SCCYI                               *
     F*   23  - S/KEYINPUT  Error-SINVT                               *
     F*                                                               *
     F*   30  - S/RECDETLS  An Error on Screen                        *
     F*   31  - S/RECDETLS  Invalid Investment Name                   *
     F*   32  - S/RECDETLS  Invalid Processing Type                   *
     F*   33  - S/RECDETLS  Invalid Convertible Indicator             *
     F*   34  - S/RECDETLS  Invalid Price Basis                       *
     F*   35  - S/RECDETLS  Invalid Trade Basis                       *
     F*   36  - S/RECDETLS  Invalid Market Centre                     *
     F*   37  - S/RECDETLS  Invalid Yield Basis                       *
     F*   38  - S/RECDETLS  Invalid Settlement Depot 1                *
     F*   39  - S/RECDETLS  Invalid SEDOL/TELEKURS/CUSIP 1            *
     F*   40  - S/RECDETLS  Invalid Settlement Depot 2                *
     F*   41  - S/RECDETLS  Invalid SEDOL/TELEKURS/CUSIP 2            *
     F*   42  - S/RECDETLS  Invalid Settlement Depot 3                *
     F*   43  - S/RECDETLS  Invalid SEDOL/TELEKURS/CUSIP 3            *
     F*   44  - S/RECDETLS  Invalid Collateral Margin                 *
     F*   45  - S/RECDETLS  Invalid Exposure Percentage               *
     F*   46  - S/RECDETLS  Invalid Valuation Sequence Number         *   S05434
      *   47  - S/RECDETLS  Product Code Error                        *                       CGP001
      *   48  - S/RECDETLS  Instrument Code Error                     *                       CGP001
     F*   50  - S/RECDETLS  Yield Basis Table Look-up                 *
     F*   51  - S/RECDETLS  Blank Settlement Depot encountered        *
     F*   52  - S/RECDETLS  Protect Price/Trade Basis unless 1        *
     F*   53  - S/RECDETLS  Number of Decimal places incorrect        *                       CSE037
     F*   54  - S/RECDETLS  Prompt at Security level flag incorrect   *                       CSE037
     F*                                                               *
     F*   55  - ROLLUP                                                *   S01179
     F*   56  - ROLLDOWN                                              *   S01179
     F*   57  - HELP                                                  *   S01179
     F*                                                               *   S01179
     F*   60  - Add record                                            *
     F*   61  - Amend S01496 is switch *ON                            *   S01496
     F*   62  - Midas-Plato Interface is installed                    *   CPL002
     F*   63  - Countervalue rounding is installed                    *                       CSE037
      *   64  - Global Processing is enabled                          *                       CGP001
     F*                                                               *
     F*   65  - S/RECDETLS  Invalid Include In Account Key            *   S01176
     F*   66  - S/RECDETLS  Invalid Default Multi-Currency Indicator  *   S01176
     F*   67  - S/RECDETLS  Invalid Default Value Currency            *   S01176
     F*   68  - S/RECDETLS  Invalid Default Value Date Default        *   S01176
     F*   69  - S/RECDETLS  Invalid Default Ex-Date Default           *   S01176
     F*   70  - S/RECDETLS  Invalid Default Trade Denomination        *   S01176
     F*   71  - S/RECDETLS  Invalid Default Industry Code             *   S01176
     F*   72  - S/RECDETLS  Invalid Default Sector Code               *   S01176
     F*   73  - S/RECDETLS  Invalid Default Market Indicator          *   S01176
     F*   74  - S/RECDETLS  Invalid Default Rating                    *   S01176
     F*   75  - S/RECDETLS  Invalid Default Country of Risk           *   S01176
     F*   76  - S/RECDETLS  Invalid Default Day Basis                 *   S01176
     F*   77  - S/RECDETLS  Invalid Default Divisor Basis             *   S01176
     F*   78  - S/RECDETLS  Invalid Default Contingent Liability Ind. *   S01176
     F*   79  - S/RECDETLS  INVALID DEFAULT COMPOUNDING FREQ.         *   S01397
     F*   80  - S/RECDETLS  INVALID DEFAULT DISCOUNT BASIS            *   S01397
     F*   81  - S/RECDETLS  INVALID DEFAULT DISC. LAST BASIS          *   S01397
     F*   82  - S/RECDETLS  INVALID PRICE TOLERANCE                   *   S01496
     F*   83  - S/VALIDD    INVALID INSTRUMENT TYPE NARR              *   S01486
     F*   84  - PORTFOLIO MANAGEMENT PRESENT                          *   S01486
     F*   85  - '?' FOUND IN LOKUP                                    *   080099
      *   86  - Product and Instrument Code Search (CHAIN) Indicator  *                       CGP001
      *   87  - Highlight Error Code.                                 *                       255460
      *   88  - Highlight Infor Message.                              *                       255460
     F*                                                               *
     F*   96  - BOF in INVTPX.                                        *   066850
     F*   97  - Work                                                  *
     F*   98  - DATF = MMDDYY                                         *
     F*   99  - Work                                                  *
     F*                                                               *
     F*   U4  - Portfolio Management present                          *   S01486
     F*   U7  - Database Error                                        *
     F*   U8  - Program Error                                         *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  NAME   - FUNCTION                                            *
     F*                                                               *
     F*  START  - PROCESS START SCREEN                                *
     F*  REVIEW - PROCESS REVIEW SCREEN                               *
     F*  UPDATE - PROCESS UPDATE SCREEN                               *
     F*                                                               *
     F*  VALIDK - VALIDATE KEY INPUT - START/REVIEW SCREEN            *
     F*  VALIDD - VALIDATE DETAIL INPUT - UPDATE SCREEN               *
     F*                                                               *
     F*  INITRC - INITIALISE DATA RECORD                              *
     F*  TRSFS  - TRANSFER DATA FROM RECORD TO SCREEN                 *
     F*  UPDFLS - UPDATE ALL FILES                                    *
     F*                                                               *
     F*  INFSR  - ERROR HANDLING                                      *
     F*                                                               *
     F*  ZALIGN - CHECK FIELD NUMERIC                                 *
     F***ZSYSTM*-*GET*INSTALLATION*CONTROL*RECORD*(TABTB10)************   S01117
     F*  ZTNLU1 - GET NEXT TRANSACTION NUMBER FROM DATA AREA          *
     F*  ZSEDIT   Insert dec. point and sign into numeric field and   *   S01496
     F*           blank out leading zeros, optionally inserting commas*   S01496
     F*                                                               *
     F*****************************************************************
      /EJECT
     F/COPY WNCPYSRC,SE0020F001
      *
      ** window processing array                                                              CSE037
     E                    WNE     1   2 76               Window Error Message                 CSE037
     E/COPY WNCPYSRC,SE0020E001                                           S01408
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZALIGNZ1
     E                    DET       256  1
     E********************ERR        19  4                                067123
     E                    ERR        40  4                                067123
     E*                                                                   S01408
     E/COPY WNCPYSRC,SE0020EEP2                                           S01408
     E*                                                                   S01408
     E                    INF     1  12 76                                085494
     E**************      INF     1  11 76                                085494
     E*                                                                   S01408
     E/COPY WNCPYSRC,SE0020EEP1                                           S01408
     E*                                                                   S01408
     E**************      TYDBS  11  11  2                                S01232
     E                    TYDBS  12  12  2                                S01232
     E/COPY WNCPYSRC,SE0020E002
     E                    LICP        9  1               LICENSED PROC TYPS01219
     E*                                                                   080099
     E** Array for instrument type field                                  080099
     E                    INP         3  1                                080099
      /EJECT
     I*                                                                   S01408
     I/COPY WNCPYSRC,SE0020IIP2                                           S01408
     I*                                                                   S01408
     I              'GOGETZONE'           C         GOPGM                                     CGP001
     I              'ERROR IN GOGETZONE'  C         GOMSG                                     CGP001
      ** Global Processing Constants                                                          CGP001
      *                                                                                       CGP001
     ICPYR@#      DS
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I            DS
     I*
      ** for window processing                                                                CSE037
     I/COPY QWINDSRC,SE0020GDTA                                                               CSE037
     I** KEY FIELDS
     I*
     I                                        1 014 SCRCTL
     I                                        1   1 REVW
     I                                        2   2 ACTN
     I                                        3 008 INPK
     I                                        3 005 CCYI
     I                                      006 008 INVT
     I                                      009 014 PAGK
     I                                      009 011 PCCYI
     I                                      012 014 PINVT
     IDETREC    E DSINVTPD
     I*
     I** DATA STRUCTURE FOR INITIALISING A RECORD
     I*
     I              CCYI                            CCYIX
     I              INVT                            INVTX
     I/COPY WNCPYSRC,SE0020I001
     I***DETS***E DSSE0020DF                                              S01179
     IDETS        DS                                                      S01179
     I                                        5  24 SINAM                 S01179
     I                                       25  25 SPROT                 S01179
     I                                       26  26 SCNVI                 S01179
     I                                       27  27 SPRBS                 S01179
     I                                       28  28 STRBS                 S01179
     I                                       29  30 SDMKT                 S01179
     I                                       31  32 SYDBS                 S01179
     I                                       33  42 SSDC1                 S01179
     I                                       43  43 SSTC1                 S01179
     I                                       44  53 SSDC2                 S01179
     I                                       54  54 SSTC2                 S01179
     I                                       55  64 SSDC3                 S01179
     I                                       65  65 SSTC3                 S01179
     I                                       66  68 SCMGN                 S01179
     I                                       69  71 SEXPC                 S01179
     I**********                             72  740LNNBRD          S01179S01496
     I**********                             75  770PSNBRD          S01179S01496
     I                                       72  77 SPRTO                 S01496
     I                                       78  800LNNBRD                S01496
     I                                       81  830PSNBRD                S01496
     I*
0273 I            DS
0274 I                                        1  10 CUSTWK
0275 I                                        1   6 SCSNMA
0276 I                                        7  10 SCSNMB
     I***SCRMSG******DS**********************    1 152                    067123
     ISCRMSG      DS                          1 236                       067123
     I*
     I** DATA STRUCTURE FOR ERROR MESSAGES TO SCREEN
     I*
     I*************************************** 1  76 ERR                   067123
     I                                        1 160 ERR                   067123
     I                                        1  76 ERRMSG
     I***************************************77 152 INFMSG                067123
     I                                      161 236 INFMSG                067123
     ISCRDS       DS
     I*
     I** DISPLAY FORMAT STATUS DATA STRUCTURE
     I*
     I                                      287 288 AID
     I            DS
     I*
     I* DATA STRUCTURE FOR CURRENCY, INDUSTRY CDE + CNTRY OF RISK TABLES  S01176
     I*
     I                                        1  12 KCCYI
     I                                        1   20KLNO
     I                                        3   8 KFIL1
     I                                        3   9 KFIL3                 S01176
     I                                        3  10 KFIL4                 S01176
     I                                        9  11 KLKEY
     I                                       10  12 KDIND                 S01176
     I                                       11  12 KDCNR                 S01176
     I                                       12  12 KFIL2
     IINFDS       DS
     I*
     I** DATA STRUCTURE FOR RPG 01021 ERROR HANDLING
     I*
     I                                     *STATUS  STATUS
     I*
     I***LDA*******UDS                            256                     S01117
     ILDA         DS                            256                       S01117
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I** *LOCK IN LDA immediately before and OUT LDA immediately          S01117
     I** after each database error handling.                              S01117
     I*
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*
     IRUNDT       DS                                                      S01117
     I*                                                                   S01117
     I** DATA AREA RUNDAT                                                 S01117
     I*                                                                   S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*                                                                   S01117
     I** DATA AREA OF MENU USER                                           S01117
     I*                                                                   S01117
     IZMUSER      DS                             17                       S01117
     I                                       11  13 USRBCH                S01117
     I*                                                                   S01117
     I/COPY ZSRSRC,ZTNLU1Z1
     ICMTTXT      DS
     I*
     I** DATA STRUCTURE FOR SETUP OF COMMIT TEXT
     I*
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNX
     I                                       26  35 USIDX
     I                                       51 306 DET
     I           SDS
     I                                      244 246 WSID
     I                                      254 263 USID
     IVDATS       DS                                                      S01176
     I*                                                                   S01176
     I** DATA STRUCTURE FOR VAL.DATE/EX-DATE DEFAULT ERR CHECKS           S01176
     I*                                                                   S01176
     I                                        1   3 VDT                   S01176
     I                                        1   1 VN1                   S01176
     I                                        2   2 VN2                   S01176
     I                                        3   3 VCH                   S01176
     I** DATA STRUCTURE FOR SESTAT                                        S01219
     ISESTAT    E DS                                                      S01219
     I*                                                                   S01219
     I                                       64  72 WSTAT                 S01219
     I*                                                                   S01117
     I/COPY WNCPYSRC,SE0020I002
     I*                                                                   S01176
     I** BANK     DETAILS                                                 S01117
     I*                                                                   S01117
     ISDBANK    E DSSDBANKPD                                              S01176
     I*                                                                   S01117
     I** CURRENCY DETAILS                                                 S01117
     I*                                                                   S01117
     ISDCURR    E DSSDCURRPD                                              S01117
     I*                                                                   S01117
     I** COUNTRIES DETAILS                                                S01117
     I*                                                                   S01117
     ISDCTRY    E DSSDCTRYPD                                              S01117
     I*                                                                   S01117
     I** LOCAL INDUSTRY CODES                                             S01117
     I*                                                                   S01117
     ISDINDS    E DSSDINDSPD                                              S01117
     I*                                                                   S01117
     I** CLIENT DETAILS                                                   S01117
     I*                                                                   S01117
     ISDCUST    E DSSDCUSTPD                                              S01117
     I*                                                                   S01117
     I**SECURITY CLIENT DETAILS                                           S01117
     I*                                                                   S01117
     ISDSECS    E DSSDSECSPD                                              S01117
     I*                                                                   S01486
     I** PORTFOLIO MANAGEMENT ICD                                         S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I*                                                                   S01486
     I** INSTRUMENT TYPES                                                 S01486
     I*                                                                   S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I*                                                                   CPL002
     ISDMMOD    E DSSDMMODPD                                              CPL002
     I*                                                                   S01117
     I** MIDAS Modules                                                    CPL002
      *                                                                                       CGP001
     ISCSARD    E DSSCSARDPD                                                                  CGP001
     I              LCD                             SARLCD                                    CGP001
      ** Switchable Feature Details Data Structure                                            CGP001
      *                                                                                       CGP001
     IGPPROD    E DSGPPRODPD                                                                  CGP001
     I              PDLCD                           PDGLCD                                    CGP001
     I              PDCHTP                          PDGCHT                                    CGP001
      ** Global Product Code Details Data Structure                                           CGP001
      *                                                                                       CGP001
     IGPINST    E DSGPINSTPD                                                                  CGP001
      ** Global Instrument Code Details Data Structure                                        CGP001
      *                                                                                       CGP001
     I** FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE               S01117
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I*                                                                   S01117
     I** SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE               S01117
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01117
     I*                                                                   S01117
     I*                                                                   S01408
     I/COPY WNCPYSRC,SE0020IIP1                                           S01408
      *
     IDATALX      DS                           1024                                           CER001
     I                                        1   3 #1CCYI                                    CER001
     I                                        4   6 #1INVT                                    CER001
     I*                                                                   S01408
     C/EJECT
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
     C*
     C**  DEFINE KEY LIST FOR CHAINING TO INVTP FILE
     C*
     C           INVTPK    KLIST
     C                     KFLD           CCYI
     C                     KFLD           INVT
     C*
     C**  DEFINE KEY LIST FOR CHAINING TO SECTYC FILE                     085494
     C*                                                                   085494
     C           SECTYK    KLIST                                          085494
     C                     KFLD           INVT                            085494
     C                     KFLD           CCYI                            085494
     C*                                                                   085494
     C****DEFINE*KEY*LIST FOR CURRENCY TABLE                              S01117
     C*****************                                                   S01117
     C***********KTG10F    KLIST                                          S01117
     C*****************    KFLD           KCCYI                           S01117
     C*
     C**  DEFINE KEY LIST FOR MARKET CENTRES (SEMKC) FILE
     C*
     C           KMARKT    KLIST
     C                     KFLD           SDMKT
      *                                                                                       CGP001
      ** Global Processing X-Reference Key List                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     KLIST                                                              CGP001
     C                     KFLD           KZONE  10                                           CGP001
     C                     KFLD           KMOD    2                                           CGP001
     C                     KFLD           KTRTP   5                                           CGP001
     C                     KFLD           KTRST   5                                           CGP001
     C*
     C** PREPARE LDA
     C*
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'SE0020'  DBPGM
     C                     OUT  LDA                                       S01117
     C*
     C** PREPARE COMIT TEXT
     C*
     C                     MOVEL'SE'      MDID
     C                     MOVEL'SE0020'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELUSID      USIDX
     C*
     C***********          MOVEL'SE0020'  HBPGM   8        *FOR CALL MHELPS01199
     C                     MOVEL*BLANK    WBLNK   1
     C**********           BITOF'01234567'HI      1        *FOR HI INTNSTY                    255460
     C**********           BITON'267'     HI                                                  255460
     C**********           MOVELHI        INF,7                                               255460
     C**********           MOVELHI        INF,8                                               255460
     C**********           MOVELHI        INF,9                                               255460
     C**********           MOVELHI        INF,10                                              255460
     C**********           MOVELHI        INF,11                                              255460
     C**********           MOVELHI        INF,12                                       085494 255460
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0020CCP1                                           S01408
     C*                                                                   S01408
     C**GET*INSTALLATION*CONTROL*DATA*RECORD*1****************************S01117
     C***********                                                         S01117
     C***********          EXSR ZSYSTM                                    S01117
     C***********                                                         S01117
     C**ERROR*IN*ZSYSTM                                                   S01117
     C***********                                                         S01117
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          END                                            S01117
     C*                                                                   S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01117
     C*                                                                   S01117
     C           DATF      COMP 'M'                      98               S01117
     C*                                                                   S01117
     C** IN THE DATAAREA ZMUSER                                           S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0020CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01117
     C*                                                                   S01219
     C** DEFINE DATA AREA SESTAT                                          S01219
     C*                                                                   S01219
     C           *NAMVAR   DEFN           SESTAT                          S01219
     C                     IN   SESTAT                                    S01219
     C*                                                                   S01219
     C** STORE LICENSED PROCESSING TYPES IN AN ARRAY FOR USE WHEN         S01219
     C** VALIDATING PROCESSING TYPE                                       S01219
     C*                                                                   S01219
     C                     MOVEAWSTAT     LICP                            S01219
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0020CCP6                                           S01408
     C*                                                                   S01408
      *                                                                   S01496
      **  Access SAR details file to see if JYSKE Enhcmts is installed.   S01496
      *                                                                   S01496
     C                     CALL 'AOSARDR0'                                S01496
     C                     PARM '       ' @RTCD   7                       S01496
     C                     PARM '*VERIFY' @OPTN   7                       S01496
     C                     PARM 'S01496'  WSARD   6                       S01496
      *                                                                   S01496
     C           @RTCD     IFEQ *BLANK                                    S01496
     C                     MOVE 'Y'       S01496  1                       S01496
     C                     MOVE *ON       *IN61                           S01496
     C                     ENDIF                                          S01496
      *                                                                   CSE032
      **  Determine if feature CSE032 is installed.                       CSE032
      *                                                                   CSE032
     C                     MOVE 'N'       CSE032  1                       CSE032
     C                     CALL 'AOSARDR0'                                CSE032
     C                     PARM '       ' @RTCD                           CSE032
     C                     PARM '*VERIFY' @OPTN                           CSE032
     C                     PARM 'CSE032'  WSARD                           CSE032
      *                                                                   CSE032
     C           @RTCD     IFEQ *BLANK                                    CSE032
     C                     MOVE 'Y'       CSE032                          CSE032
     C                     END                                            CSE032
      *                                                                   CSE037
      **  Determine if feature CSE037 is installed.                       CSE037
      *                                                                   CSE037
     C                     MOVE 'N'       CSE037  1                       CSE037
     C                     CALL 'AOSARDR0'                                CSE037
     C                     PARM '       ' @RTCD                           CSE037
     C                     PARM '*VERIFY' @OPTN                           CSE037
     C                     PARM 'CSE037'  WSARD                           CSE037
      *                                                                   CSE037
     C           @RTCD     IFEQ *BLANK                                    CSE037
     C                     MOVE 'Y'       CSE037                          CSE037
     C                     MOVE *ON       *IN63                           CSE037
     C                     END                                            CSE037
      *                                                                   207543
      **  Determine if feature CEU018 is installed.                       207543
      *                                                                   207543
     C                     MOVE 'N'       CEU018  1                       207543
     C                     CALL 'AOSARDR0'                                207543
     C                     PARM '       ' @RTCD                           207543
     C                     PARM '*VERIFY' @OPTN                           207543
     C                     PARM 'CEU018'  WSARD                           207543
      *                                                                   207543
     C           @RTCD     IFEQ *BLANK                                    207543
     C                     MOVE 'Y'       CEU018                          207543
     C                     END                                            207543
      *                                                                                       CER001
      ** Access SAR details file to see if ULX004 is installed.                               CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD   7        B:Return code                      CER001
     C                     PARM '*VERIFY' @OPTN   7        I:Option                           CER001
     C                     PARM 'ULX004'  @SARD   6        I:Key field                        CER001
     C                     PARM *BLANK    @FMT  200        O:Format                           CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX004  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX004                                              CER001
     C                     END                                                                CER001
      *                                                                                       CER001
      ** Access SAR details file to see if ULX043 is installed.                               CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD   7        B:Return code                      CER001
     C                     PARM '*VERIFY' @OPTN   7        I:Option                           CER001
     C                     PARM 'ULX043'  @SARD   6        I:Key field                        CER001
     C                     PARM *BLANK    @FMT  200        O:Format                           CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     END                                                                CER001
      *                                                                                     BUG23049
      ** Access SAR details file to see if CGL014 is installed.                             BUG23049
      *                                                                                     BUG23049
     C                     CALL 'AOSARDR0'                                                  BUG23049
     C                     PARM '       ' @RTCD   7        B:Return code                    BUG23049
     C                     PARM '*VERIFY' @OPTN   7        I:Option                         BUG23049
     C                     PARM 'CGL014'  @SARD   6        I:Key field                      BUG23049
     C                     PARM *BLANK    @FMT  200        O:Format                         BUG23049
      *                                                                                     BUG23049
     C           @RTCD     IFEQ *BLANK                                                      BUG23049
     C                     MOVE 'Y'       CGL014  1                                         BUG23049
     C                     ELSE                                                             BUG23049
     C                     MOVE 'N'       CGL014                                            BUG23049
     C                     END                                                              BUG23049
      *                                                                                       CGP001
      ** Check if CGP001 is enabled.                                                          CGP001
      *                                                                                       CGP001
     C                     CALL 'AOSARDR0'                                                    CGP001
     C                     PARM *BLANKS   PRTCD   7                                           CGP001
     C                     PARM '*VERIFY' POPTN   7                                           CGP001
     C                     PARM 'CGP001'  PSARD   6                                           CGP001
     C           SCSARD    PARM SCSARD    DSFDY                                               CGP001
      *                                                                                       CGP001
     C                     MOVE 'N'       CGP001  1                                           CGP001
     C           PRTCD     IFEQ *BLANKS                                                       CGP001
     C                     MOVE 'Y'       CGP001                                              CGP001
     C                     MOVE *ON       *IN64                                               CGP001
      *                                                                                       CGP001
      ** Open the Global Processing Files.                                                    CGP001
      *                                                                                       CGP001
     C                     OPEN GPPRDXL0                                                      CGP001
     C                     OPEN GPINSXL0                                                      CGP001
      *                                                                                       CGP001
      ** Get the Zone.                                                                        CGP001
      *                                                                                       CGP001
     C                     EXSR SRGPGZ                                                        CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PRTCD     IFNE '*NRF'                                                        CGP001
     C           *LOCK     IN   LDA                                                           CGP001
     C                     MOVEL'SCSARDPD'DBFILE                                              CGP001
     C                     MOVEL'CGP001'  DBKEY                                               CGP001
     C                     Z-ADD5         DBASE                                               CGP001
     C                     OUT  LDA                                                           CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
     C*                                                                   S01486
     C*  CHECK FOR PM MODULE PRESENT                                      S01486
     C           *INU4     IFEQ '1'                                       S01486
     C********** CGL014    OREQ 'Y'                                                BUG23049 MD029686
     C                     MOVE '1'       *IN84                           S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*FIRST ' P@OPTN  7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C*                                                                   S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL'03'      DBASE            **DB ERROR 03**S01486
     C                     MOVEL'SDPORTPD'DBFILE                          S01486
     C                     MOVEL*BLANKS   DBKEY                           S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     END                                            S01486
      *                                                                   CPL002
      ** Get Module Information                                           CPL002
      *                                                                   CPL002
     C                     CALL 'AOMMODR0'                                CPL002
     C                     PARM *BLANKS   P@RTCD  7                       CPL002
     C                     PARM '*FIRST ' P@OPTN  7                       CPL002
     C           SDMMOD    PARM SDMMOD    DSFDY                           CPL002
      *                                                                   CPL002
      **  Error in access program?                                        CPL002
      *                                                                   CPL002
     C           P@RTCD    IFNE *BLANKS                                   CPL002
     C           *LOCK     IN   LDA                                       CPL002
     C                     MOVEL'SDMMODPD'DBFILE           ************   CPL002
     C                     Z-ADD004       DBASE            * DBERR 04 *   CPL002
     C                     CLEARDBKEY                      ************   CPL002
     C                     OUT  LDA                                       CPL002
     C                     EXSR *PSSR                                     CPL002
     C                     ENDIF                                          CPL002
      *                                                                   CPL002
      ** Is Midas-Plato Interface installed?                              CPL002
      *                                                                   CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C                     MOVE *ON       *IN62                           CPL002
     C                     ENDIF                                          CPL002
     C*                                                                   CPB001
     C** Sets indacator 84 ON if PB presents                              CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C           CGL014    OREQ 'Y'                                                         BUG23049
     C                     MOVE *ON       *IN84                           CPB001
     C                     ENDIF                                          CPB001
     C*
     C** PROCEED TO START SCREEN UNLESS UPDATE SCREEN DUE(INFSR CALLED)
     C*
     C           *INU7     IFNE '1'
     C           *IN,12    ANDNE'1'                        *ON IF INFSR
     C                     MOVEA'1'       *IN,10
     C                     END
      *
      ***  Do Until Command 3 or Database Error
      *
     C           AID       DOUEQ'01'
     C           *INU7     OREQ '1'
     C*
     C           *IN10     CASEQ'1'       START
     C           *IN11     CASEQ'1'       REVIEW
     C           *IN12     CASEQ'1'       UPDATE
     C*
     C                     END
     C                     END
     C*
     C** IF U7 ON, END PROGRAM
     C*
     C           *INU7     IFEQ '1'
     C                     MOVEL'1'       *INU8
     C                     END
     C*
     C/COPY WNCPYSRC,SE0020CCP5
     C*
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
      *                                                               *
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     CLOSEGPPRDXL0                                                      CGP001
     C                     CLOSEGPINSXL0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     SETON                         LR
      *                                                               *
      *================================================================
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  START - S/R TO OUTPUT AND PROCESS KEY FIELDS SCREEN          *
     C*                                                               *
     C*****************************************************************
     C*
     C           START     BEGSR
     C*
     C** INITIALISE SCREEN DATA
     C*
     C                     Z-ADD2         LNNBRK
     C                     Z-ADD10        PSNBRK
     C                     MOVEA'0'       *IN,10
     C                     MOVEA'00000'   *IN,20
     C                     MOVEL*BLANK    SCRCTL
     C*
     C                     MOVEL*BLANK    SCCYI
     C                     MOVEL*BLANK    SINVT
     C*
     C** CLEAR WHOLE SCREEN
     C*
     C                     WRITECLSCREEN
     C*
     C** D O   U N T I L   C H A N G E  O F  S C R E E N   -  S T A R T
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
      *
      ***  Start Screen Output
      *
     C                     MOVELINF,1     INFMSG
     C*********************WRITEKEYINPUT                                  CAAA02
     C                     WRITEMESSAGES
     C                     WRITEKEYINPUT                                  CAAA02
     C                     READ KEYINPUT                 99
     C                     MOVELERRMSG    HERCD 160
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C*
     C***C*K*3*,*H*E*L*P*,*O*R**E*N*T*E*R***P*R*E*S*S*E*D**-**S*T*A*R*T   S01199
     C** C K 3 , O R  E N T E R   P R E S S E D  -  S T A R T             S01199
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
     C** CK3
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,10
     C**HELP***********************************************************   S01199
     C***********          ELSE                                           S01199
     C***********AID       IFEQ 'HP'                                      S01199
     C***********          MOVELHERCD     ERRMSG                          S01199
     C***********ERR,1     IFNE *BLANK                                    S01199
     C***********          MOVELHI        ERRMSG                          S01199
     C***********          END                                            S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C*
     C* ENTER
     C                     ELSE
     C*                                                                   S01117
     C** CHECK IF SELECTION IS REQUESTED                                  S01117
     C*                                                                   S01117
     C                     MOVELSCCYI     @STP    1                       S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANK    @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM SCCYI     @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVE '0'       *IN,22                          S01117
     C                     MOVE A6CYCD    SCCYI                           S01117
     C                     ELSE                                           S01117
     C                     MOVE *BLANKS   SCCYI                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C*
     C** VALIDATE KEY INPUT
     C*
     C                     EXSR VALIDK
      *
      ***  Determine Screen change
      *
     C           SCRMSG    IFEQ *BLANK
     C***********CCYI      IFEQ *BLANK                                    S01176
     C           INVT      IFEQ *BLANK                                    S01176
     C                     MOVEA'1'       *IN,11
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C                     END
     C*                                                                   S01117
     C                     END                                            S01117
     C*
     C***********          END                                            S01199
     C*
     C***C*K*3*,*H*E*L*P*,*O*R**E*N*T*E*R***P*R*E*S*S*E*D***-**E*N*D      S01199
     C** C K 3 , O R  E N T E R   P R E S S E D   -  E N D                S01199
     C                     END
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N   -  E N D
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  REVIEW - S/R TO PROCESS SUBFILE SELECTION SCREEN             *
     C*                                                               *
     C*****************************************************************
     C*
     C           REVIEW    BEGSR                           *** REVIEW ***
     C*
     C                     MOVEA'0'       *IN,11
     C                     MOVEL'RA'      AID
     C*
     C** D O   U N T I L   C H A N G E  O F  S C R E E N   -  S T A R T
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
     C** I F  R O L L   U P / D O W N   O R   E N T E R   P R E S S E D
     C*
     C** R E B U I L D   S U B F I L E                     -  S T A R T
     C*
     C           AID       IFEQ 'DN'
     C           AID       OREQ 'UP'
     C           AID       OREQ 'RA'
     C                     MOVEA'000'     *IN,1
     C                     MOVEA'1'       *IN,4
     C                     Z-ADD*ZERO     RRN
     C**********           WRITESUBFLCTL                                  E22109
     C*
     C** ROLLUP OR ROLLDOWN
     C*
     C           AID       IFEQ 'DN'
     C*                                                                   066850
     C           WCCYI     IFNE *BLANKS                                   066850
     C           WINVT     ANDNE*BLANKS                                   066850
     C*                                                                   066850
     C** Set the file to the first record of the current page.            066850
     C*                                                                   066850
     C                     MOVELWCCYI     CCYI                            066850
     C                     MOVELWINVT     INVT                            066850
     C           INVTPK    SETLLINVTPX                                    066850
     C*                                                                   066850
     C** Get the key for the first record of the previous page.           066850
     C*                                                                   066850
     C                     Z-ADD0         CNT     20                      066850
     C           CNT       DOUEQ19                                        066850
     C           *IN96     OREQ '1'                                       066850
     C                     READPINVTPX                 9696               066850
     C                     ADD  1         CNT                             066850
     C                     END                                            066850
     C*                                                                   066850
     C** Set the key to the first record of the file if BOF.              066850
     C*                                                                   066850
     C           *IN96     IFEQ '1'                                       066850
     C                     MOVEL*BLANK    CCYI                            066850
     C                     MOVEL*BLANK    INVT                            066850
     C           INVTPK    SETLLINVTPX                                    066850
     C                     END                                            066850
     C*                                                                   066850
     C                     ELSE                                           066850
     C                     MOVEL*BLANK    CCYI
     C                     MOVEL*BLANK    INVT
     C           INVTPK    SETLLINVTPX
     C                     END                                            066850
     C*                                                                   066850
     C                     MOVEL*BLANK    WCCYI                           066850
     C                     MOVEL*BLANK    WINVT                           066850
     C*                                                                   066850
     C                     ELSE
     C                     MOVELPCCYI     CCYI
     C                     MOVELPINVT     INVT
     C           INVTPK    SETLLINVTPX
     C                     END
     C*                                                                   E22109
     C** CLEAR SUBFILE                                                    E22109
     C*                                                                   E22109
     C                     WRITESUBFLCTL                                  E22109
     C*
     C** READ IN DETAILS-FILL UP SUBFILE
     C*
     C           RRN       DOUEQ18
     C           *IN,99    OREQ '1'
     C*
     C** DO UNTIL PAGE IS FULL
     C*
     C                     READ INVTPX                   99
     C*                                                                   066850
     C** Save the key of the first record of the current page.            066850
     C*                                                                   066850
     C           RRN       IFEQ 0                                         066850
     C                     MOVELCCYI      WCCYI   3                       066850
     C                     MOVELINVT      WINVT   3                       066850
     C                     END                                            066850
     C*                                                                   066850
     C           *IN,99    IFEQ '0'
     C*
     C           RECI      IFEQ '*'
     C                     MOVEL'D'       STAT    1
     C                     ELSE
     C                     MOVEL*BLANK    STAT
     C                     END
     C*
     C                     ADD  1         RRN     40     04
      *                                                                                       BG1350
      ** Get the Global Product and Instrument Codes                                          BG1350
      ** if CGP001 is enabled.                                                                BG1350
      *                                                                                       BG1350
     C           CGP001    IFEQ 'Y'                                                           BG1350
     C                     MOVELCCYI      XCCYI   3                                           BG1350
     C                     MOVELINVT      XINVT   3                                           BG1350
     C                     EXSR SRGPPI                                                        BG1350
     C                     ENDIF                                                              BG1350
     C*
     C                     WRITESUBFLREC
     C*
     C                     END
     C                     END
     C*
     C** READ ONE MORE RECORD FOR NEXT SCREEN
     C*
     C           *IN,99    IFEQ '0'
     C                     READ INVTPX                   99
     C                     END
     C*
     C** SAVE THE 'REVIEW FROM' KEY FOR THE START OF THIS CURRENT PAGE
     C*
     C                     MOVELPAGK      PPAGK 006
     C*
     C** IF NOT EOF SET NEXT 'REVIEW FROM' KEY ELSE SET IT TO BLANK
     C*
     C           *IN,99    IFEQ '0'
     C                     MOVELINPK      PAGK
     C                     ELSE
     C                     MOVEL*BLANK    PAGK
     C                     SETON                     03                   E22109
     C                     END
     C*
     C** FOR SUBFILE CONTROL
     C*
     C           *IN,4     IFEQ '1'
     C                     MOVEA'010'     *IN,1
     C                     ELSE
     C***********          MOVEA'111'     *IN,1                           E22109
     C                     MOVEA'11'      *IN,1                           E22109
     C                     END
      *
      ** R E B U I L D   S U B F I L E     -     E N D
      ***  End of AID = 'DN', 'UP', or 'RA'.
     C                     END
      *
      ***  Review Screen Output
      *
     C                     MOVELINF,2     INFMSG
     C****************     WRITESUBFLCTL                   CAAA02
     C           *IN,4     IFEQ '1'
     C                     WRITENORECS
     C                     END
     C                     WRITEMESSAGES
     C                     WRITESUBFLCTL                   CAAA02
     C                     READ SUBFLCTL                 99
     C                     MOVELERRMSG    HERCD
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C                     MOVEL*BLANK    REVW
     C*
     C***C*K*3*,*C*K12*,*H*E*L*P*,*R*E*C*O*R*D**S*E*L*E*C*T*-*S*T*A*R*T   S01199
     C** C K 3 , C K12 , R E C O R D  S E L E C T - S T A R T             S01199
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
     C** CK3
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,11
     C** CK12
     C                     ELSE
     C           AID       IFEQ '05'
     C                     MOVEA'1'       *IN,10
     C**HELP***********************************************************   S01199
     C***********          ELSE                                           S01199
     C***********AID       IFEQ 'HP'                                      S01199
     C***********          MOVELHERCD     ERRMSG                          S01199
     C***********ERR,1     IFNE *BLANK                                    S01199
     C***********          MOVELHI        ERRMSG                          S01199
     C***********          END                                            S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C*
     C* RECORD SELECT
     C                     ELSE
     C                     MOVEA'1'       *IN,99
     C           *IN,04    IFEQ '0'
     C                     READCSUBFLREC                 99
     C                     END
      *
      ***  Record Select validation
      *
     C           *IN99     IFEQ '0'
     C                     MOVELCCYI      SCCYI
     C                     MOVELINVT      SINVT
     C                     EXSR VALIDK
     C           SCRMSG    IFEQ *BLANK
     C                     MOVEA'1'       *IN,12
     C                     MOVEL'Y'       REVW
     C                     END
     C                     END
     C*
     C***********          END                                            S01199
     C                     END
     C*
     C***C*K*3*,*C*K12*,*H*E*L*P*,*R*E*C*O*R*D**S*E*L*E*C*T*-**E*N*D      S01199
     C** C K 3 , C K12 , R E C O R D  S E L E C T -  E N D                S01199
     C                     END
     C*
     C** D O   U N T I L   C H A N G E  O F  S C R E E N   -  E N D
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  UPDATE - S/R TO PROCESS DETAIL SCREEN AND UPDATE FILE        *
     C*                                                               *
     C*****************************************************************
     C*
     C           UPDATE    BEGSR                           *** UPDATE ***
     C*
     C                     Z-ADD5         LNNBRD
     C                     Z-ADD25        PSNBRD
     C                     MOVEA'1'       *IN,5
     C                     MOVEA'0'       *IN,12
     C                     MOVEA'0'       *IN,15                          S01176
     C                     MOVEA'00000000'*IN,30
     C                     MOVEA'00000000'*IN,38
     C                     MOVEA'000'     *IN,46
     C**********           MOVEA'000'     *IN,50                                              CSE037
     C                     MOVEA'00000'   *IN,50                                              CSE037
     C                     MOVEA'00000000'*IN,65                          E48038
     C                     MOVEA'000000'  *IN,73                          E48038
     C                     MOVEA'000'     *IN,79                          E48038
     C           S01496    IFEQ 'Y'                                       S01496
     C                     MOVE '0'       *IN82                           S01496
     C                     ENDIF                                          S01496
     C                     MOVE '0'       *IN83                           S01486
     C                     MOVE '0'       *IN88                                               255460
     C*
     C** GET RECORD OFF FILE AND STORE TNLU FOR CHECK AT UPDATE TIME
     C*
     C                     Z-ADD*ZERO     STNLU   50
     C           INVTPK    CHAININVTPX               99
     C           *IN,99    IFEQ '0'
     C                     Z-ADDTNLU      STNLU
     C                     END
     C*
     C* IF INSERT (NEW OR OVER DELETED RECORD) INITIALIZE RECORD DETAIL
     C*
     C           ACTN      IFEQ 'I'
     C           *IN,99    OREQ '1'
     C*
     C** INITIALIZE ALL FIELDS ON THE RECORD (IE ZEROIZE/BLANK OUT)
     C*
     C                     EXSR INITRC
     C*
     C                     END
     C*
     C** IF DELETED RECORD - ENQUIRY ONLY
     C*
     C           RECI      IFEQ '*'
     C                     MOVEL'E'       ACTN
     C                     MOVEL'DELETED' DELT    7
     C                     ELSE
     C                     MOVEL*BLANK    DELT
     C                     END
     C*
     C** TRANSLATE RECORD DETAILS FROM FILE LAYOUT TO SCREEN LAYOUT
     C*
     C                     EXSR TRSFS
     C*
     C** IF DELETE/ENQUIRY PROTECT FIELD INPUT ON S/RECDETLS
     C*
     C           ACTN      IFEQ 'D'
     C           ACTN      OREQ 'E'
     C                     MOVEA'1'       *IN,6
     C                     Z-ADD1         LNNBRD                          S01158
     C                     Z-ADD1         PSNBRD                          S01158
     C                     END
     C*
     C** IF NOT INSERT, PROTECT PRICE BASIS & TRADE BASIS
     C*
     C           ACTN      IFNE 'I'
     C                     MOVEA'1'       *IN,52
     C                     END
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N   -  S T A R T
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
      *
      ***  Load Up Info Messages
      *
     C           INFMSG    IFEQ *BLANK
     C           ACTN      IFEQ 'I'
     C                     MOVELINF,3     INFMSG
     C                     END
     C           ACTN      IFEQ 'A'
     C                     MOVELINF,4     INFMSG
     C                     END
     C           ACTN      IFEQ 'E'
     C                     MOVELINF,5     INFMSG
     C                     END
     C*                                                                   085494
     C           ACTN      IFEQ 'D'
     C*                                                                   085494
     C* IF THERE ARE LIVE SECURITIES WITH THIS INVESTMENT TYPE, DELETE    085494
     C* NOT ALLOWED, ELSE DISPLAY 'F10 TO DELETE'                         085494
     C*                                                                   085494
     C           SECTYK    CHAINSECTYC               99                   085494
     C           *IN99     IFEQ *OFF                                      085494
     C                     MOVELINF,12    INFMSG                          085494
     C                     MOVEL'1'       *IN88                                               255460
     C                     MOVE 'N'       DLTALW  1                       085494
     C                     ELSE                                           085494
     C                     MOVELINF,6     INFMSG
     C                     MOVE 'Y'       DLTALW  1                       085494
     C                     END                                            085494
     C*                                                                   085494
     C                     END
     C                     END
      *
      ***  Detail Screen Output
      *
     C**    CHECK IF TITLE ONLY INV. TYPE SCREEN                          S01176
     C*                                                                   S01176
     C           CCYI      IFEQ *BLANK                                    S01176
     C                     MOVEA'1'       *IN,15                          S01176
     C                     END                                            S01176
      *                                                                   S01176
      *****Set*Indicator*for*Australian*Yield.*********************S01397 E44886
      ***********                                                  S01397 E44886
     C***********YDBS      IFEQ 'AU'                               S01397 E44886
     C***********          SETON                     16            S01397 E44886
     C***********          ELSE                                    S01397 E44886
     C***********          SETOF                     16            S01397 E44886
     C***********          END                                     S01397 E44886
      *                                                                   S01397
     C                     WRITEKEYINPUT
     C***********          WRITERECDETLS                                  CAAA02
     C                     WRITEMESSAGES
     C                     WRITERECDETLS                                  CA0002
     C                     READ RECDETLS                 99
     C                     MOVELERRMSG    HERCD
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C/COPY WNCPYSRC,SE0020C009
     C*
     C***C*K*3*,*C*K12*,*H*E*L*P*,*R*O*L*L*U*P*/*D*O*W*N****-**S*T*A*R*T  S01199
     C** C K 3 , C K12 , R O L L U P / D O W N    -  S T A R T            S01199
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
     C** CK3
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,12
     C*                                                                   S01179
     C** CK12
     C                     ELSE
     C           AID       IFEQ '05'
     C                     MOVEA'1'       *IN,10
     C*                                                                   S01179
     C***HELP**********************************************************   S01199
     C***********          ELSE                                           S01199
     C***********AID       IFEQ 'HP'                                      S01199
     C***********          MOVELHERCD     ERRMSG                          S01199
     C***********ERR,1     IFNE *BLANK                                    S01199
     C***********          MOVELHI        ERRMSG                          S01199
     C***********          END                                            S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C*
     C** ROLLUP
     C                     ELSE
     C           AID       IFEQ 'UP'
     C           ACTN      ANDNE'I'
     C                     READ INVTPX                   12
     C           *IN,12    IFEQ '1'
     C                     MOVELINF,7     INFMSG
     C                     MOVEL'1'       *IN88                                               255460
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C*                                                                   S01179
     C** ROLLDOWN
     C                     ELSE
     C           AID       IFEQ 'DN'
     C           ACTN      ANDNE'I'
     C                     READPINVTPX                   12
     C           *IN,12    IFEQ '1'
     C                     MOVELINF,8     INFMSG
     C                     MOVEL'1'       *IN88                                               255460
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C*
     C***NOT*CK3*CK12*HELP*ROLLUP*ROLLDOWN*****************************   S01199
     C** NOT CK3, CK12, ROLLUP, ROLLDOWN                                  S01199
     C*
     C                     ELSE
     C*                                                                   S01117
     C** CHECK IF SELECTION REQUESTED                                     S01117
     C*                                                                   S01117
     C                     EXSR CHKSEL                                    S01117
     C*                                                                   S01117
     C** IF NO SELECTION REQUESTED                                        S01117
     C*                                                                   S01117
     C           @SEL      IFEQ 'N'                                       S01117
     C*
     C** V A L I D A T E   D E T A I L   S C R E E N   I N P U T
     C*
     C                     EXSR VALIDD
     C*
     C** N O    D E T A I L   S C R E E N    E R R O R S    -  S T A R T
      *
      ** window processing                                                                    CSE037
     C           SCRMSG    IFEQ *BLANK                                                        CSE037
      *                                                                                       CER001
     C                     MOVEL*BLANK    WF12    1                                           CER001
     C           WF12      DOWEQ*BLANK                                                        CER001
     C           AID       ANDNE*BLANKS                                                       CER001
     C                     MOVE SCCYI     #1CCYI                                              CER001
     C                     MOVE SINVT     #1INVT                                              CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C                     CALL 'SE0021'                                                      CER001
     C                     PARM *BLANK    RTNCD   7        Return Code                        CER001
     C                     PARM           ACTN             Action Code                        CER001
     C                     PARM           DATALX           Trans Data                         CER001
     C                     PARM *BLANK    W0RTN   7                                           CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                                                     CER001
     C           W0RTN     OREQ 'Y2U0004'                                                     CER001
     C           W0RTN     OREQ 'USR0563'                                                     CER001
     C                     MOVEL'Y'       WF12                                                CER001
     C                     LEAVE                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Display 3rd screen                                                                   CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     CALL 'SE0022'                                                      CER001
     C                     PARM *BLANK    RTNCD   7        Return Code                        CER001
     C                     PARM           ACTN             Action Code                        CER001
     C                     PARM           DATALX           Trans Data                         CER001
     C                     PARM *BLANK    W0RTN   7                                           CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                                                     CER001
     C                     ITER                                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     MOVEL'Y'       WF12                                                CER001
     C                     LEAVE                                                              CER001
     C                     ENDDO                                                              CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C           ULX043    OREQ 'Y'                                                           CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0563'                  *IF1                               CER001
      *                                                                                       CER001
      ** Send message 'WN Window Error'                                                       CER001
      *                                                                                       CER001
     C                     MOVELWNE,1     INFMSG           Message id.                        CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** Return code is *DBF update error                                                     CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'Y2U0004'                  *IF2                               CER001
      *                                                                                       CER001
      ** Send message 'WN Database Error'                                                     CER001
      *                                                                                       CER001
     C                     MOVELWNE,2     INFMSG           Message id.                        CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** Return code is *Previous Screen                                                      CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                  *IF3                               CER001
     C                     GOTO UPDT01                     *QUIT                              CER001
     C                     ENDIF                           *FI3                               CER001
     C                     ENDIF                           *FI2                               CER001
     C                     ENDIF                           *FI1                               CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     MOVEL'SE0020'  ##PGM  10                                           CSE037
      * WM call Window Manager - Window manager  *                                            CSE037
     C                     CALL 'WN0010'                                                      CSE037
     C                     PARM           ##PGM            Program                            CSE037
     C                     PARM *BLANK    FKEY    2        Function Key                       CSE037
     C                     PARM           ACTN             Action Code                        CSE037
     C                     PARM           DATA             Trans Data                         CSE037
     C                     PARM *BLANK    W0RTN   7        Return Code                        CSE037
     C                     PARM           SPARE 256        Spare WM parm                      CSE037
      * WM Check Return                                                                       CSE037
      *CASE:     PAR.*Return code is *User QUIT requested                                     CSE037
     C           W0RTN     IFEQ 'Y2U9999'                  *IF                                CSE037
     C                     MOVE '01'      AID                                                 CSE037
     C                     MOVE '1'       *IN12                                               CSE037
     C                     ELSE                                                               CSE037
      *CASE:     PAR.*Return code is WN Window Error                                          CSE037
     C           W0RTN     IFEQ 'USR0563'                  *IF                                CSE037
      * Send message 'WN Window Error'                                                        CSE037
     C                     MOVELWNE,1     INFMSG           Message id.                        CSE037
     C                     ELSE                                                               CSE037
      *CASE:     PAR.*Return code is *DBF update error                                        CSE037
     C           W0RTN     IFEQ 'Y2U0004'                  *IF                                CSE037
      * Send message 'WN Database Error'                                                      CSE037
     C                     MOVELWNE,2     INFMSG           Message id.                        CSE037
     C                     ELSE                                                               CSE037
      *CASE:     PAR.*Return code is *Previous Screen                                         CSE037
     C           W0RTN     IFEQ 'USR0790'                  *IF                                CSE037
     C                     GOTO UPDT01                     *QUIT                              CSE037
     C                     END                             *FI                                CSE037
     C                     END                             *FI                                CSE037
     C                     END                             *FI                                CSE037
     C                     END                             *FI                                CSE037
     C                     END                             *FI                                CSE037
     C*
     C/COPY WNCPYSRC,SE0020C004
     C           SCRMSG    IFEQ *BLANK
     C           AID       ANDEQ'RA'
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0020CCP3                                           S01408
     C*                                                                   S01408
     C*
     C** FOR REC.ADVANCE DETERMINE WHAT SCREEN TO RETURN TO
     C*
     C           REVW      IFEQ 'Y'
     C                     MOVELPPAGK     PAGK
     C                     MOVEA'1'       *IN,11
     C                     ELSE
     C                     MOVEA'1'       *IN,10
     C                     END
     C/COPY WNCPYSRC,SE0020C011
     C*
     C*      U  P  D  A  T  E      F  I  L  E  S
     C*
     C* IF THERE ARE LIVE SECURITIES WITH THIS INVESTMENT TYPE, DELETE    085494
     C* NOT ALLOWED, ELSE DISPLAY 'F10 TO DELETE'                         085494
     C*                                                                   085494
     C/COPY WNCPYSRC,SE0020C012
     C           ACTN      IFEQ 'D'                                       085494
     C           SECTYK    CHAINSECTYC               99                   085494
     C           *IN99     IFEQ *OFF                                      085494
     C                     MOVELINF,12    INFMSG                          085494
     C                     MOVEL'1'       *IN88                                               255460
     C                     MOVE 'N'       DLTALW  1                       085494
     C                     ELSE                                           085494
     C                     MOVELINF,6     INFMSG                          085494
     C                     MOVE 'Y'       DLTALW  1                       085494
     C                     END                                            085494
     C                     END                                            085494
     C*
     C           ACTN      IFEQ 'I'
     C           ACTN      OREQ 'A'
     C           ACTN      OREQ 'D'
     C           DLTALW    ANDEQ'Y'                                       085494
     C/COPY WNCPYSRC,SE0020C015
     C                     EXSR UPDFLS
     C/COPY WNCPYSRC,SE0020C013
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0020CCP4                                           S01408
     C*                                                                   S01408
     C*
      ***  End of No Detail Screen errors
     C                     END
     C*                                                                   S01117
     C** END OF NO SELECTION REQUESTED                                    S01117
     C*                                                                   S01117
     C                     END                                            S01117
      *
      ** for window processing                                                                CSE037
     C           UPDT01    TAG                                                                CSE037
      *                                                                                       CSE037
     C/COPY WNCPYSRC,SE0020C005
     C*
     C***C*K*3*,*C*K12*,*H*E*L*P*,*R*O*L*L*U*P*/*D*O*W*N****-**E*N*D      S01199
      ***  End of If/Else AID = 'DN', not Insert                          S01199
     C                     END
      ***  End of If/Else AID = 'UP', not Insert
     C                     END
     C***********          END                                            S01199
      ***  End of If/Else AID = '05'
     C                     END
      ***  End of If/Else AID = '01'
     C                     END
     C*
     C                     MOVELCCYI      SCCYI
     C                     MOVELINVT      SINVT
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N   -  E N D
     C                     END
     C                     MOVEA'00'      *IN,5
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT                                                              S01179
     C*****************************************************************   S01179
     C*            ****** AS400 CONVERSION ******                     *   S01179
     C*                                                               *   S01179
     C*  ASCHGS S/R TO MOVE THE APPROPRIATE VALUES INTO FIELD AID,    *   S01179
     C*  DEPENDING ON WHICH FUNCTION KEY HAS BEEN PRESSED.            *   S01179
     C*  CALLED FROM UPDATE                                           *   S01179
     C*                                                               *   S01179
     C*****************************************************************   S01179
     C*                                                                   S01179
     C           ASCHGS    BEGSR                           *** ASCHGS *** S01179
     C*                                                                   S01179
     C** If ENTER pressed, the VLDCMDKEY indicator will be off            S01179
     C*                                                                   S01179
     C************IN15     IFEQ '0'                               S01179  E20987
     C           *IN13     IFEQ '0'                                       E20987
     C                     MOVE 'RA'      AID                             S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C** If F3                                                            S01179
     C*                                                                   S01179
     C           *INKC     IFEQ '1'                                       S01179
     C                     MOVE '01'      AID                             S01179
     C                     MOVE '0'       *INKC                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C** If F10                                                           S01179
     C*                                                                   S01179
     C           *INKJ     IFEQ '1'                                       S01179
     C                     MOVE '04'      AID                             S01179
     C                     MOVE '0'       *INKJ                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C** If F12                                                           S01179
     C*                                                                   S01179
     C           *INKL     IFEQ '1'                                       S01179
     C                     MOVE '05'      AID                             S01179
     C                     MOVE '0'       *INKL                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C** If ROLLUP pressed                                                S01179
     C*                                                                   S01179
     C           *IN55     IFEQ '1'                                       S01179
     C                     MOVE 'UP'      AID                             S01179
     C                     MOVE '0'       *IN55                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C** If ROLLDOWN pressed                                              S01179
     C*                                                                   S01179
     C           *IN56     IFEQ '1'                                       S01179
     C                     MOVE 'DN'      AID                             S01179
     C                     MOVE '0'       *IN56                           S01179
     C                     END                                            S01179
     C*                                                                   E22109
     C** If ROLLUP pressed (SUBFILE)                                      E22109
     C*                                                                   E22109
     C           *IN25     IFEQ '1'                                       E22109
     C                     MOVE 'UP'      AID                             E22109
     C                     MOVE '0'       *IN25                           E22109
     C                     END                                            E22109
     C*                                                                   E22109
     C** If ROLLDOWN pressed (SUBFILE)                                    E22109
     C*                                                                   E22109
     C           *IN26     IFEQ '1'                                       E22109
     C                     MOVE 'DN'      AID                             E22109
     C                     MOVE '0'       *IN26                           E22109
     C                     END                                            E22109
     C*                                                                   E22109
     C***If*HELP*key*pressed************************************* S01179  S01199
     C***********                                                 S01179  S01199
     C************IN57     IFEQ '1'                               S01179  S01199
     C***********          MOVE 'HP'      AID                     S01179  S01199
     C***********          MOVE '0'       *IN57                   S01179  S01199
     C***********          END                                    S01179  S01199
     C*                                                                   S01179
     C                     ENDSR                                          S01179
     C*                                                                   S01179
     C*****************************************************************   S01179
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  VALIDK - S/R TO VALIDATE KEY FIELDS                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           VALIDK    BEGSR                           *** VALIDK ***
     C*
     C                     MOVEA'00000'   *IN,20
     C                     Z-ADD2         LNNBRK  30
     C                     Z-ADD10        PSNBRK  30
     C                     MOVEL'0'       *IN87                                               255460
     C*
     C** VALIDATE KEY INPUT
     C*
     C                     Z-ADD*ZERO     EC      40
      *
      ***  Action Code, if entered, must be I, A, E or D.
      *
     C           ACTN      IFNE *BLANK
     C           ACTN      ANDNE'I'
     C           ACTN      ANDNE'A'
     C           ACTN      ANDNE'E'
     C           ACTN      ANDNE'D'
     C                     MOVEA'1'       *IN,21
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C**   IF SINGLE BRANCH ENVIRONMENT                                   S01117
     C*                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C**                                                                  S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         EC                              S01117
     C                     MOVEA' 302'    ERR,EC                          S01117
     C**********           MOVELHI        ERRMSG                                       S01117 255460
     C                     MOVEL'1'       *IN87                                               255460
     C                     MOVEL*BLANK    AID                             S01117
     C                     SETON                     21                   S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C**   IF MULTIBRANCHING ENVIRONMENT                                  S01117
     C*                                                                   S01117
     C           ACTN      IFNE ' '                                                         MD021025
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM USRBCH    @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C**                                                                  S01117
     C           @ERR      IFEQ 2                                         S01117
     C                     ADD  1         EC                              S01117
     C                     MOVEA' 304'    ERR,EC                          S01117
     C**********           MOVELHI        ERRMSG                                       S01117 255460
     C                     MOVEL'1'       *IN87                                               255460
     C                     MOVEL*BLANK    AID                             S01117
     C                     SETON                     21                   S01117
     C                     END                                            S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     ADD  1         EC                              S01117
     C                     MOVEA' 303'    ERR,EC                          S01117
     C**********           MOVELHI        ERRMSG                                       S01117 255460
     C                     MOVEL'1'       *IN87                                               255460
     C                     MOVEL*BLANK    AID                             S01117
     C                     SETON                     21                   S01117
     C                     END                                            S01117
     C                     ENDIF                                                            MD021025
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END
     C*
     C***CHECK*FOR*ACTION*CODE*BLANK*BUT*INVT*INPUT                                   S01176 BUG6203
     C*
     C********** ACTN      IFEQ *BLANK                                                       BUG6203
     C***********SCCYI     IFNE *BLANK                     *CCYI INPUT    S01176
     C***********SINVT     ORNE *BLANK                     *INVT INPUT    S01176
     C********** SINVT     ANDNE*BLANK                                                S01176 BUG6203
     C***********          MOVEA'111'     *IN,21                          S01176
     C**********           MOVEA'101'     *IN,21                                      S01176 BUG6203
     C**********           END                                                               BUG6203
     C***********          ELSE                                           S00176
     C*
     C***CHECK*FOR*ACTION*CODE*INPUT*BUT*INVT*BLANK                                   S01176 BUG6203
     C*
     C***********SCCYI     IFEQ *BLANK                     *CCYI NOT INPUTS01176
     C***********SINVT     OREQ *BLANK                     *INVT NOT INPUTS01176
     C********** SINVT     IFEQ *BLANK                                                S01176 BUG6203
     C********** ACTN      ANDNE*BLANK                                                S01176 BUG6203
     C***********          MOVEA'111'     *IN,21                          S01176
     C**********           MOVEA'101'     *IN,21                                      S01176 BUG6203
     C***********          END                             *SCCYI         S01176
     C**********           END                                                               BUG6203
      *                                                                                      BUG6203
      ** Check if ACTN equal to blank and if SCCYI or SINVT                                  BUG6203
      ** not equal to blank                                                                  BUG6203
      *                                                                                      BUG6203
     C           ACTN      IFEQ *BLANK                                                       BUG6203
     C           SCCYI     IFNE *BLANK                                                       BUG6203
     C           SINVT     ORNE *BLANK                                                       BUG6203
     C                     MOVEA'111'     *IN,21                                             BUG6203
     C                     ENDIF                                                             BUG6203
     C                     ELSE                                                              BUG6203
      *                                                                                      BUG6203
      ** Check if SCCYI equal to blank and if SINVT or ACTN                                  BUG6203
      ** not equal to blank                                                                  BUG6203
      *                                                                                      BUG6203
     C           SCCYI     IFEQ *BLANK                                                       BUG6203
     C********** SINVT     OREQ *BLANK                                                BUG6203 255423
     C********** ACTN      ANDNE*BLANK                                                BUG6203 255423
     C**********           MOVEA'111'     *IN,21                                      BUG6203 255423
     C                     MOVEA'1'       *IN,22                                              255423
     C                     ENDIF                                                              255423
     C           SINVT     IFEQ *BLANK                                                        255423
     C                     MOVEA'1'       *IN,23                                              255423
     C                     ENDIF                                                             BUG6203
     C                     ENDIF                                                             BUG6203
     C*
     C           *IN,21    IFEQ '1'
     C           *IN,22    OREQ '1'                                                           255423
     C           *IN,23    OREQ '1'                                                           255423
     C**********           ADD  1         EC         21                                       255423
     C                     ADD  1         EC                                                  255423
     C                     MOVEL' 100'    ERR,EC
     C                     Z-ADD2         LNNBRK
     C                     Z-ADD10        PSNBRK     20
     C                     END
      *
      ***  Action Code can't be 'D' if SFLG is on.
      *
     C           ACTN      IFEQ 'D'
     C***********SFLG      ANDEQ1                                         S01117
     C           BJSUC     ANDEQ'Y'                                       S01117
     C                     ADD  1         EC         21
     C                     MOVEL' 101'    ERR,EC
     C  N20                Z-ADD2         LNNBRK
     C  N20                Z-ADD10        PSNBRK     20
     C                     END
     C*
     C** A C T I O N    C O D E    I N P U T - CHECK KEY FIELDS
     C*
     C** IF INSERT, CHECK VALID CURRENCY CODE (IF INPUT)                  S01176
     C*                                                                   S01176
     C***********ACTN      IFEQ 'I'                                       S01176
     C           SCCYI     IFNE *BLANK                                    S01176
     C*                                                                   S01117
     C***********          Z-ADD20        KLNO                            S01117
     C***********          MOVEL*BLANK    KFIL1                           S01117
     C***********          MOVELSCCYI     KLKEY                           S01117
     C***********          MOVEL'1'       KFIL2                           S01117
     C***********KTG10F    CHAINTABTG10F             99                   S01117
     C************IN,99    IFNE '1'                                       S01117
     C***********RECI      IFNE 'D'                                       S01117
     C***********          MOVEA'1'       *IN,99                          S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C***********                                                         S01117
     C************IN,99    IFEQ '1'                                       S01117
     C*                                                                   S01117
     C*    ACCESS CURRENCY FILE SDCURRPD                                  S01117
     C*                                                                   S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM SCCYI     @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CURRENCY                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         22                   S01117
     C                     MOVEL' 102'    ERR,EC                          S01117
     C  N20                Z-ADD2         LNNBRK                          S01117
     C  N20                Z-ADD23        PSNBRK     20                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** N O   E R R O R  O N  K E Y  F I E L D S
     C*
     C************IN,22    IFNE '1'                                       S01176
     C************IN,23    ANDNE'1'                                       S01176
     C************IN,24    ANDNE'1'                                       S01176
     C           *IN,21    IFNE '1'                                       S01176
     C           *IN,22    ANDNE'1'                                       S01176
     C           *IN,23    ANDNE'1'                                       S01176
     C*
     C** SET UP KEY FOR INVTPX
     C*
     C                     MOVELSCCYI     CCYI
     C                     MOVELSINVT     INVT
     C*
     C** A C T I O N    C O D E    I
     C*
     C           ACTN      IFEQ 'I'
     C           INVTPK    CHAININVTPX               99
     C  N99      RECI      COMP '*'                      99
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0020CCP7                                           S01408
     C*                                                                   S01408
     C           *IN99     IFEQ '0'
     C***********CCYI      OREQ *BLANK                                    S01176
     C                     MOVEA'111'     *IN,22
     C                     ADD  1         EC
     C                     MOVEL' 103'    ERR,EC
     C  N20                Z-ADD2         LNNBRK
     C  N20                Z-ADD23        PSNBRK     20
     C                     END
     C*
     C** A C T I O N    C O D E    A , D
     C*
     C                     ELSE
     C           ACTN      IFEQ 'A'
     C           ACTN      OREQ 'D'
     C           INVTPK    CHAININVTPX               99
     C  N99      RECI      COMP '*'                      99
     C           *IN99     IFEQ '1'
     C                     MOVEA'111'     *IN,22
     C                     ADD  1         EC
     C                     MOVEL' 103'    ERR,EC
     C  N20                Z-ADD2         LNNBRK
     C  N20                Z-ADD23        PSNBRK     20
     C                     END
     C*
     C** A C T I O N    C O D E    E
     C*
     C                     ELSE
     C           ACTN      IFEQ 'E'
     C           INVTPK    CHAININVTPX               99
     C           *IN99     IFEQ '1'
     C                     MOVEA'111'     *IN,22
     C                     ADD  1         EC
     C                     MOVEL' 103'    ERR,EC
     C  N20                Z-ADD2         LNNBRK
     C  N20                Z-ADD23        PSNBRK     20
     C                     END
     C*
     C                     END
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** ERROR ON SCREEN, HIGHLIGHT ERROR CODES
     C*
     C           EC        IFNE *ZERO
     C**********           MOVELHI        ERRMSG                                              255460
     C                     MOVEL'1'       *IN87                                               255460
     C                     MOVEL*BLANK    AID
     C                     END
     C                     ENDSR
     C*****************************************************************
      /EJECT                                                              S01117
     C*****************************************************************   S01117
     C*                                                               *   S01117
     C*  CHKSEL - S/R TO CHECK IF SELECTION IS REQUESTED IN DETAIL    *   S01117
     C*           SCREEN                                              *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           CHKSEL    BEGSR                                          S01117
     C*                                                                   S01117
     C                     MOVE 'N'       @SEL    1                       S01117
     C*                                                                   S01117
     C                     MOVELSSDC1     @STP                            S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     MOVE 'Y'       @SEL                            S01117
     C                     MOVEL'?'       TSDC1   6                       S01117
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM TSDC1     @AENB   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   SSDC1                           S01117
     C                     MOVE 0         *IN,38                          S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVELBFCUST    SSDC1                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELSSDC2     @STP                            S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     MOVE 'Y'       @SEL                            S01117
     C                     MOVEL'?'       TSDC2   6                       S01117
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM TSDC2     @AENB   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   SSDC2                           S01117
     C                     MOVE 0         *IN,40                          S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVELBFCUST    SSDC2                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELSSDC3     @STP                            S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     MOVE 'Y'       @SEL                            S01117
     C                     MOVEL'?'       TSDC3   6                       S01117
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM TSDC3     @AENB   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   SSDC3                           S01117
     C                     MOVE 0         *IN,42                          S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVELBFCUST    SSDC3                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELSDVCY     @STP                            S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     MOVE 'Y'       @SEL                            S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM SDVCY     @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   SDVCY                           S01117
     C                     MOVE 0         *IN,67                          S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVE A6CYCD    SDVCY                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELSDIND     @STP                            S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     MOVE 'Y'       @SEL                            S01117
     C                     CALL 'AOINDSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SDIND     @CDNB   3                       S01117
     C           SDINDS    PARM SDINDS    DSFDY                           S01117
     C*                                                                   S01117
     C                     MOVE '0'       *IN,71                          S01117
     C                     MOVE *BLANKS   SDIND                           S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVE AOLICD    SDIND                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELSDCNR     @STP                            S01117
     C           @STP      IFEQ '?'                                       S01117
     C                     MOVE 'Y'       @SEL                            S01117
     C                     CALL 'AOCTRYR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SDCNR     @AXCD   2                       S01117
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   SDCNR                           S01117
     C                     MOVE '0'       *IN,75                          S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C                     MOVE A4CNCD    SDCNR                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*****************************************************************   S01117
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  VALIDD - S/R TO VALIDATE DETAIL SCREEN                       *
     C*                                                               *
     C*****************************************************************
     C*
     C           VALIDD    BEGSR
     C*
     C                     MOVEA'00000000'*IN,30
     C                     MOVEA'00000000'*IN,38
     C                     MOVEA'000'     *IN,46
     C**********           MOVEA'00'      *IN,50                                              CSE037
     C                     MOVEA'00000'   *IN,50                                              CSE037
     C                     MOVEA'00000000'*IN,65                          S01176
     C                     MOVEA'000000'  *IN,73                          S01176
     C                     MOVEA'000'     *IN,79                          E44886
     C           S01496    IFEQ 'Y'                                       S01496
     C                     MOVEA'0'       *IN,82                          S01496
     C                     ENDIF                                          S01496
     C                     MOVE '0'       *IN83                           S01486
     C                     MOVEL'0'       *IN87                                               255460
     C                     MOVEL'0'       *IN88                                               255460
      *                                                                                      BUG2210
      ** Switch ON *IN52 when  action code is not I to protect the fields                    BUG2210
      ** for Price and Trade basis during amendment.                                         BUG2210
      *                                                                                      BUG2210
     C           ACTN      IFNE 'I'                                                          BUG2210
     C                     MOVEA'1'       *IN,52                                             BUG2210
     C                     END                                                               BUG2210
      *                                                                                      BUG2210
     C                     Z-ADD5         LNNBRD  30
     C                     Z-ADD25        PSNBRD  30
     C*
     C** VALIDATE DETAIL INPUT
     C*
     C                     Z-ADD*ZERO     EC
     C*
     C** ENTER KEY PRESSED
     C*
     C           AID       IFEQ 'RA'
     C*
     C** ACTION = I OR A
     C*
     C           ACTN      IFEQ 'I'
     C           ACTN      OREQ 'A'
     C*
     C** VALIDATION OF FIELDS FOR INSERT/AMEND
     C*
     C** TRANSLATE AND VALIDATE SINAM (#ALPV) - INVESTMENT NAME
     C*
     C                     MOVELSINAM     INAM
     C*
     C           SINAM     IFEQ *BLANK
     C                     ADD  1         EC         31
     C                     MOVEL' 200'    ERR,EC
     C  N30                Z-ADD05        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C*                                                                   S01176
     C**  I F   T I T L E    O N L Y    S C R E E N ,   O N L Y           S01176
     C**  V A L I D A T E    I N V E S T M E N T    N A M E.              S01176
     C*                                                                   S01176
     C           *IN,15    IFEQ '0'                                       S01176
     C*                                                                   S01176
     C*
     C** TRANSLATE AND VALIDATE SPROT (#ALPV) - PROCESSING TYPE
     C*
     C                     MOVELSPROT     PROT
     C*
     C           SPROT     IFEQ *BLANK
     C           SPROT     ORLT '1'
     C***********SPROT     ORGT '8'                                       S01176
     C           SPROT     ORGT '9'                                       S01176
     C                     ADD  1         EC         32
     C                     MOVEL' 201'    ERR,EC
     C  N30                Z-ADD06        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C*                                                                   S01219
     C** USER MUST BE LICENSED TO PROCESSING TYPE ENTERED                 S01219
     C** NOTE:ALL USERS LICENSED TO PROCESSING TYPE 1                     S01219
     C*                                                                   S01219
     C                     ELSE                                           S01219
     C           SPROT     IFGT '1'                                       S01219
     C                     MOVE SPROT     P       10                      S01219
     C           LICP,P    IFNE 'Y'                                       S01219
     C                     ADD  1         EC         32                   S01219
     C                     MOVEL' 236'    ERR,EC                          S01219
     C  N30                Z-ADD06        LNNBRD                          S01219
     C  N30                Z-ADD25        PSNBRD     30                   S01219
     C                     END                                            S01219
     C                     END                                            S01219
     C*                                                                   S01219
     C                     END
     C*
     C** TRANSLATE AND VALIDATE SCNVI (#ALPV) - CONVERTIBLE IND
     C*
     C           SCNVI     IFNE *BLANK                                    S01158
     C                     MOVELSCNVI     CNVI
     C                     ELSE                                           S01158
     C                     MOVEL'N'       CNVI                            S01158
     C                     END                                            S01158
     C*
     C** MUST BE BLANK FOR PROC. TYPES 2,4,7,9                            S01176
     C*
     C** IF PROCESSING TYPE IS VALID                                      S01219
     C*                                                                   S01219
     C           *IN32     IFEQ '0'                                       S01219
     C*                                                                   S01219
     C           SPROT     IFEQ '2'
     C           SPROT     OREQ '4'
     C           SPROT     OREQ '7'
     C           SPROT     OREQ '9'                                       S01176
     C           SCNVI     IFNE *BLANK
     C           ACTN      ANDEQ'I'                                       S01169
     C                     ADD  1         EC         33
     C                     MOVEL' 202'    ERR,EC
     C  N30                Z-ADD07        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C*
     C                     ELSE
     C*
     C           SCNVI     IFNE *BLANK
     C           SCNVI     ANDNE'Y'
     C           SCNVI     ANDNE'N'
     C                     ADD  1         EC         33
     C                     MOVEL' 203'    ERR,EC
     C  N30                Z-ADD07        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C                     END
     C*                                                                   S01219
     C                     END                                            S01219
     C*
     C** TRANSLATE AND VALIDATE SPRBS (#ALPV) - PRICE BASIS
     C*
     C** IF LEFT BLANK, SET DEFAULT ACCORDING TO PROCESSING TYPE
     C*
     C           SPRBS     IFEQ *BLANK
     C*                                                                   S01219
     C** IF PROCESSING TYPE IS VALID                                      S01219
     C*                                                                   S01219
     C           *IN32     IFEQ '0'                                       S01219
     C*                                                                   S01219
     C           SPROT     IFEQ '2'
     C           SPROT     OREQ '4'
     C           SPROT     OREQ '7'
     C                     MOVEL'U'       PRBS
     C                     ELSE
     C                     MOVEL'P'       PRBS
     C                     END
     C                     END                                            S01219
     C*                                                                   S01219
     C                     ELSE
     C*
     C                     MOVELSPRBS     PRBS
     C*
     C           SPRBS     IFNE 'P'
     C           SPRBS     ANDNE'U'
     C                     ADD  1         EC         34
     C                     MOVEL' 204'    ERR,EC
     C  N30                Z-ADD08        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C*                                                                   064332
     C           SPRBS     IFEQ 'U'                                       064332
     C           SPROT     ANDNE'1'                                       088309
     C           SPROT     ANDNE'2'                                       064332
     C           SPROT     ANDNE'4'                                       064332
     C           SPROT     ANDNE'7'                                       064332
     C                     ADD  1         EC         34                   064332
     C                     MOVEL' 253'    ERR,EC                          064332
     C  N30                Z-ADD08        LNNBRD                          064332
     C  N30                Z-ADD25        PSNBRD     30                   064332
     C                     END                                            064332
     C*                                                                   064332
     C           SPRBS     IFEQ 'P'                                       064332
     C           SPROT     IFEQ '2'                                       064332
     C           SPROT     OREQ '4'                                       064332
     C           SPROT     OREQ '7'                                       064332
     C                     ADD  1         EC         34                   064332
     C                     MOVEL' 253'    ERR,EC                          064332
     C  N30                Z-ADD08        LNNBRD                          064332
     C  N30                Z-ADD25        PSNBRD     30                   064332
     C                     END                                            064332
     C                     END                                            064332
     C*                                                                   064332
     C                     END
     C*
     C*
     C** TRANSLATE AND VALIDATE STRBS (#ALPV) - TRADE BASIS
     C*
     C                     MOVELSTRBS     TRBS
     C*
     C           STRBS     IFNE 'P'
     C           STRBS     ANDNE'D'
     C           STRBS     ANDNE'Y'
     C                     ADD  1         EC         35
     C                     MOVEL' 205'    ERR,EC
     C  N30                Z-ADD09        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C*
     C** MUST BE P FOR PROC. TYPES 2,4,7
     C*
     C** IF PROCESSING TYPE IS VALID                                      S01219
     C*                                                                   S01219
     C           *IN32     IFEQ '0'                                       S01219
     C*                                                                   S01219
     C           SPROT     IFEQ '2'
     C           SPROT     OREQ '4'
     C           SPROT     OREQ '7'
     C           STRBS     IFNE 'P'
     C                     ADD  1         EC         35
     C                     MOVEL' 206'    ERR,EC
     C  N30                Z-ADD09        LNNBRD
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C                     END
     C*                                                                   S01219
     C                     END                                            S01219
     C*
     C** TRANSLATE AND VALIDATE SDMKT (#ALPV) - MARKET CENTRE
     C*
     C                     MOVELSDMKT     DMKT
     C*
     C** MUST BE AN ACTIVE RECORD ON PF/SEMKCD IF ENTERED
     C*
     C           SDMKT     IFNE *BLANKS
     C           KMARKT    CHAINSEMKCDF              99
     C           *IN,99    IFNE '1'
     C           RECI      IFEQ '*'
     C                     MOVEA'1'       *IN,99
     C                     END
     C                     END
     C*
     C           *IN,99    IFEQ '1'
     C                     ADD  1         EC         36
     C                     MOVEL' 207'    ERR,EC
     C**N30******          Z-ADD10        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD13        LNNBRD                          E48038
     C  N30                Z-ADD71        PSNBRD     30                   E48038
     C                     END
     C                     END
     C*
     C** TRANSLATE AND VALIDATE SYDBS (#ALPV) - YIELD BASIS
     C*
     C                     MOVELSYDBS     YDBS
     C*
     C           CSE032    IFNE 'Y'                                       CSE032
     C** MUST BE ENTERED IF TRADE BASIS = Y
     C*
     C           STRBS     IFEQ 'Y'
     C/COPY WNCPYSRC,SE0020C003
     C           SYDBS     IFEQ *BLANK
     C                     MOVEA'1'       *IN,37
     C                     END
     C*
     C** ....OTHERWISE MUST NOT BE ENTERED
     C*
     C                     ELSE
     C           SYDBS     IFNE *BLANK
     C                     MOVEA'1'       *IN,37
     C                     END
     C                     END
     C                     ELSE                                           CSE032
     C*                                                                   CSE032
     C** CSE032 is 'Y'.                                                   CSE032
     C** Must be entered if trade basis = Y.                              CSE032
     C** or if trade basis and price basis are 'P'.                       CSE032
     C           STRBS     IFEQ 'Y'                                       CSE032
     C           STRBS     OREQ 'P'                                       CSE032
     C           SPRBS     ANDEQ'P'                                       CSE032
     C           STRBS     OREQ 'P'                                                         MD029691
     C           SPRBS     ANDEQ*BLANK                                                      MD029691
     C           PRBS      ANDEQ'P'                                                         MD029691
     C           SYDBS     IFEQ *BLANK                                    CSE032
     C                     MOVEA'1'       *IN,37                          CSE032
     C                     END                                            CSE032
     C** ....otherwise must not be entered.                               CSE032
     C                     ELSE                                           CSE032
     C           SYDBS     IFNE *BLANK                                    CSE032
     C                     MOVEA'1'       *IN,37                          CSE032
     C                     END                                            CSE032
     C                     END                                            CSE032
     C                     END                                            CSE032
     C*
     C           *IN,37    IFEQ '1'
     C                     ADD  1         EC         37
     C                     MOVEL' 208'    ERR,EC
     C**N30******          Z-ADD11        LNNBRD                          E48038
     C  N30                Z-ADD10        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30
     C/COPY WNCPYSRC,SE0020C010
     C                     END
     C*
     C** IF ENTERED, MUST BE IN TABLE OF VALID CODES
     C*
     C           SYDBS     IFNE *BLANK
     C           SYDBS     LOKUPTYDBS                    50
     C           *IN,50    IFEQ '0'
     C                     ADD  1         EC         37
     C                     MOVEL' 209'    ERR,EC
     C**N30******          Z-ADD11        LNNBRD                          E48038
     C  N30                Z-ADD10        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C                     END
     C***********SYDBS     IFEQ 'AU'                               S01397 E44886
     C***********          SETON                     16            S01397 E44886
     C***********          END                                     S01397 E44886
     C*
     C** TRANSLATE AND VALIDATE SSDC1 (#NUMV) - SETTLEMENT DEPOT 1
     C*
     C****************     MOVE SSDC1     CUSTWK                          S01117
     C**********           Z-ADD0         SDC1                                                CSD027
     C                     MOVE *BLANKS   SDC1                                                CSD027
     C           SSDC1     IFEQ *BLANK
     C                     MOVEA'1'       *IN,51
     C                     ELSE
     C**********           Z-ADD0         SDC1                                                CSD027
     C                     MOVE *BLANKS   SDC1                                                CSD027
     C****************     SETOF                     2627                 S01117
     C****************                                                    S01117
0389 C***CHECK*TO*SEE*IF MORE THAN 6 CHARS ENTERED                        S01117
     C****************                                                    S01117
0390 C***********SCSNMB    IFNE *BLANK                                    S01117
     C****************     MOVE '1'       *IN26                           S01117
     C****************     END                                            S01117
     C****************                                                    S01117
0392 C***IF*NOT*MORE*THAN 6 CHARS, CHECK FIRST 6 CHARS NUMERIC            S01117
     C****************                                                    S01117
0390 C************IN26     IFEQ '0'                                       S01117
     C****************     MOVE *BLANKS   ZFIELD                          S01117
     C****************     MOVELSCSNMA    ZFIELD                          S01117
     C****************     Z-ADD*ZEROS    ZADEC                           S01117
     C****************     Z-ADD6         ZADIG                           S01117
     C****************     EXSR ZALIGN                                    S01117
     C************IN99     IFEQ '1'                                       S01117
     C****************     SETON                     26                   S01117
     C****************     ELSE                                           S01117
     C****************     SETON                     27                   S01117
     C****************     END                                            S01117
0390 C****************     END                                            S01117
     C****************                                                    S01117
0397 C*****IF*S/NAME*GET CLINT REC.                                       S01117
     C****************                                                    S01117
0390 C************IN26     IFEQ '1'                                       S01117
0399 C***********SSDC1     CHAINSNAME                99                   S01117
     C**N99******RECI*     COMP 'D'                  9999                 S01117
     C****************     END                                            S01117
     C****************                                                    S01117
0410 C*****IF*CUST*NO. - CHECK IT EXISTS ON CLINT                         S01117
     C****************                                                    S01117
0390 C************IN27     IFEQ '1'                                       S01117
0413 C****************     MOVE SCSNMA    CNUM                            S01117
0414 C***********CNUM*     CHAINCLINTCBF             99                   S01117
     C**N99******RECI*     COMP 'D'                  9999                 S01117
     C****************     END                                            S01117
     C****************                                                    S01117
0410 C*****IF*ON*CLINTCB - CHECK IT EXISTS ON CLINTSE                     S01117
     C****************                                                    S01117
0390 C************IN99     IFEQ '0'                                       S01117
0414 C***********CNUM*     CHAINCLINTSEF             99                   S01117
     C**N99******RECI*     COMP 'D'                  9999                 S01117
     C****************     END                                            S01117
     C************IN99     IFEQ '1'                                       S01117
     C****************     ADD  1         EC         38                   S01117
     C****************     MOVEL' 221'    ERR,EC                          S01117
     C**N30***********     Z-ADD12        LNNBRD                          S01117
     C**N30***********     Z-ADD25        PSNBRD     30                   S01117
     C****************     ELSE                                           S01117
     C****************     Z-ADDCNUM      SDC1                            S01117
     C****************     END                                            S01117
     C****************     END                                            S01117
     C*                                                                   S01117
     C** CHECK IF CLIENT IS A CUSTOMER FOR MIDAS AND SECURITY TRADING     S01117
     C*                                                                   S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SSDC1     @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CUSTOMER                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         38                   S01117
     C                     MOVEL' 221'    ERR,EC                          S01117
     C*                                                                   S01117
     C**N30******          Z-ADD12        LNNBRD                    S01117E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01117E48038
     C  N30                Z-ADD7         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           S01117
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM BBCUST    @AENB   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         38                   S01117
     C*                                                                   S01117
     C** INVALID CUSTOMER                                                 S01117
     C*                                                                   S01117
     C                     MOVEL' 221'    ERR,EC                          S01117
     C*                                                                   S01117
     C**N30******          Z-ADD12        LNNBRD                    S01117E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01117E48038
     C  N30                Z-ADD7         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           S01117
     C           BFCLAS    IFNE 'E'                                       E24360
     C********** BFCLAS    ANDNE'K'                                       E24360              CSE022
     C           BFCLAS    ANDNE'C'                                       E24360
     C           BFCLAS    ANDNE'X'                                       E24360
     C           BFCLAS    ANDNE'M'                                       E24360
     C                     ADD  1         EC         38                   E24360
     C                     MOVEL' 250'    ERR,EC                          E24360
     C**N30******          Z-ADD12        LNNBRD                    E24360E48038
     C**N30******          Z-ADD25        PSNBRD     30             E24360E48038
     C  N30                Z-ADD7         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           E24360
     C                     MOVE BBCUST    SDC1                            S01117
     C                     END                                            E24360
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** TRANSLATE AND VALIDATE SSTC1 (#ALPV) - SEDOL/TELEKURS/CUSIP 1
     C*
     C                     MOVELSSTC1     STC1
     C*
     C** MAY ONLY BE ENTERED IF CORRESPONDING SETT. DEPOT ENTERED
     C*
     C           SSTC1     IFNE *BLANK
     C           SSDC1     IFEQ *BLANK
     C                     ADD  1         EC         39
     C                     MOVEL' 212'    ERR,EC
     C**N30******          Z-ADD13        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD7         LNNBRD                          E48038
     C  N30                Z-ADD61        PSNBRD     30                   E48038
     C                     END
     C*
     C           SSTC1     IFNE 'S'
     C           SSTC1     ANDNE'T'
     C           SSTC1     ANDNE'C'
     C                     ADD  1         EC         39
     C                     MOVEL' 213'    ERR,EC
     C**N30******          Z-ADD13        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD7         LNNBRD                          E48038
     C  N30                Z-ADD61        PSNBRD     30                   E48038
     C                     END
     C                     END
     C*
     C** TRANSLATE AND VALIDATE SSDC2 (#NUMV) - SETTLEMENT DEPOT 2
     C*
     C**********           Z-ADD0         SDC2                                                CSD027
     C                     MOVE *BLANKS   SDC2                                                CSD027
     C           SSDC2     IFEQ *BLANK
     C                     MOVEA'1'       *IN,51
     C                     ELSE
     C*
     C* CHECK FOR PREVIOUS BLANK
     C*
     C           *IN51     IFEQ '1'
     C                     ADD  1         EC         40
     C                     MOVEL' 210'    ERR,EC
     C**N30******          Z-ADD14        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD8         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     END
      *
     C*****************    MOVE SSDC2     CUSTWK                          S01117
     C*****************    SETOF                     2627                 S01117
     C*****************                                                   S01117
0389 C***CHECK*TO*SEE*IF MORE THAN 6 CHARS ENTERED                        S01117
     C*****************                                                   S01117
0390 C***********SCSNMB    IFNE *BLANK                                    S01117
     C*****************    MOVE '1'       *IN26                           S01117
     C*****************    END                                            S01117
     C*****************                                                   S01117
0392 C***IF*NOT*MORE*THAN 6 CHARS, CHECK FIRST 6 CHARS NUMERIC            S01117
     C*****************                                                   S01117
0390 C************IN26*    IFEQ '0'                                       S01117
     C*****************    MOVE *BLANKS   ZFIELD                          S01117
     C*****************    MOVELSCSNMA    ZFIELD                          S01117
     C*****************    Z-ADD*ZEROS    ZADEC                           S01117
     C*****************    Z-ADD6         ZADIG                           S01117
     C*****************    EXSR ZALIGN                                    S01117
     C************IN99*    IFEQ '1'                                       S01117
     C*****************    SETON                     26                   S01117
     C*****************    ELSE                                           S01117
     C*****************    SETON                     27                   S01117
     C*****************    END                                            S01117
0390 C*****************    END                                            S01117
     C*****************                                                   S01117
0397 C*****IF*S/NAME*GET CLINT REC.                                       S01117
     C*****************                                                   S01117
0390 C************IN26*    IFEQ '1'                                       S01117
0399 C***********SSDC2*    CHAINSNAME                99                   S01117
     C**N99******RECI**    COMP 'D'                  9999                 S01117
     C*****************    END                                            S01117
     C*****************                                                   S01117
0410 C*****IF*CUST*NO.*- CHECK IT EXISTS ON CLINT                         S01117
     C*****************                                                   S01117
0390 C************IN27*    IFEQ '1'                                       S01117
0413 C*****************    MOVE SCSNMA    CNUM                            S01117
0414 C***********CNUM**    CHAINCLINTCBF             99                   S01117
     C**N99******RECI**    COMP 'D'                  9999                 S01117
     C*****************    END                                            S01117
     C*****************                                                   S01117
0410 C*****IF*ON*CLINTCB - CHECK IT EXISTS ON CLINTSE                     S01117
     C*****************                                                   S01117
0390 C************IN99*    IFEQ '0'                                       S01117
0414 C***********CNUM**    CHAINCLINTSEF             99                   S01117
     C**N99******RECI**    COMP 'D'                  9999                 S01117
     C*****************    END                                            S01117
     C************IN99*    IFEQ '1'                                       S01117
     C*****************    ADD  1         EC         40                   S01117
     C*****************    MOVEL' 221'    ERR,EC                          S01117
     C**N30************    Z-ADD14        LNNBRD                          S01117
     C**N30************    Z-ADD25        PSNBRD     30                   S01117
     C*****************    ELSE                                           S01117
     C*****************    Z-ADDCNUM      SDC2                            S01117
     C*****************    END                                            S01117
     C*****************    END                                            S01117
     C*                                                                   S01117
     C** CHECK IF CLIENT IS A CUSTOMER FOR MIDAS AND SECURITY TRADING     S01117
     C*                                                                   S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SSDC2     @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CUSTOMER                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         40                   S01117
     C                     MOVEL' 221'    ERR,EC                          S01117
     C*                                                                   S01117
     C**N30******          Z-ADD14        LNNBRD                    S01117E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01117E48038
     C  N30                Z-ADD8         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM BBCUST    @AENB   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CUSTOMER                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         40                   S01117
     C                     MOVEL' 221'    ERR,EC                          S01117
     C*                                                                   S01117
     C**N30******          Z-ADD14        LNNBRD                    S01117E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01117E48038
     C  N30                Z-ADD8         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           S01117
     C           BFCLAS    IFNE 'E'                                       E24360
     C********** BFCLAS    ANDNE'K'                                       E24360              CSE022
     C           BFCLAS    ANDNE'C'                                       E24360
     C           BFCLAS    ANDNE'X'                                       E24360
     C           BFCLAS    ANDNE'M'                                       E24360
     C                     ADD  1         EC         40                   E24360
     C                     MOVEL' 250'    ERR,EC                          E24360
     C**N30******          Z-ADD14        LNNBRD                    E24360E48038
     C**N30******          Z-ADD25        PSNBRD     30             E24360E48038
     C  N30                Z-ADD8         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           E24360
     C                     MOVE BBCUST    SDC2                            S01117
     C                     END                                            E24360
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** TRANSLATE AND VALIDATE SSTC2 (#ALPV) - SEDOL/TELEKURS/CUSIP 2
     C*
     C                     MOVELSSTC2     STC2
     C*
     C** MAY ONLY BE ENTERED IF CORRESPONDING SETT. DEPOT ENTERED
     C*
     C           SSTC2     IFNE *BLANK
     C           SSDC2     IFEQ *BLANK
     C                     ADD  1         EC         41
     C                     MOVEL' 212'    ERR,EC
     C**N30******          Z-ADD15        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD8         LNNBRD                          E48038
     C  N30                Z-ADD61        PSNBRD     30                   E48038
     C                     END
     C*
     C           SSTC2     IFNE 'S'
     C           SSTC2     ANDNE'T'
     C           SSTC2     ANDNE'C'
     C                     ADD  1         EC         41
     C                     MOVEL' 213'    ERR,EC
     C**N30******          Z-ADD15        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD8         LNNBRD                          E48038
     C  N30                Z-ADD61        PSNBRD     30                   E48038
     C                     END
     C                     END
     C*
     C** TRANSLATE AND VALIDATE SSDC3 (#NUMV) - SETTLEMENT DEPOT 3
     C*
     C**********           Z-ADD0         SDC3                                                CSD027
     C                     MOVE *BLANKS   SDC3                                                CSD027
     C           SSDC3     IFEQ *BLANK
     C                     MOVEA'1'       *IN,51
     C                     ELSE
     C           *IN51     IFEQ '1'
     C                     ADD  1         EC         42
     C                     MOVEL' 210'    ERR,EC
     C**N30******          Z-ADD16        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD9         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     END
     C****************     MOVE SSDC3     CUSTWK                          S01117
     C****************     SETOF                     2627                 S01117
     C****************                                                    S01117
0389 C***CHECK*TO*SEE*IF MORE THAN 6 CHARS ENTERED                        S01117
     C****************                                                    S01117
0390 C***********SCSNMB    IFNE *BLANK                                    S01117
     C****************     MOVE '1'       *IN26                           S01117
     C****************     END                                            S01117
     C****************                                                    S01117
0392 C***IF*NOT*MORE*THAN 6 CHARS, CHECK FIRST 6 CHARS NUMERIC            S01117
     C****************                                                    S01117
0390 C************IN26     IFEQ '0'                                       S01117
     C****************     MOVE *BLANKS   ZFIELD                          S01117
     C****************     MOVELSCSNMA    ZFIELD                          S01117
     C****************     Z-ADD*ZEROS    ZADEC                           S01117
     C****************     Z-ADD6         ZADIG                           S01117
     C****************     EXSR ZALIGN                                    S01117
     C************IN99     IFEQ '1'                                       S01117
     C****************     SETON                     26                   S01117
     C****************     ELSE                                           S01117
     C****************     SETON                     27                   S01117
     C****************     END                                            S01117
0390 C****************     END                                            S01117
     C****************                                                    S01117
0397 C*****IF*S/NAME*GET CLINT REC.                                       S01117
     C****************                                                    S01117
0390 C************IN26     IFEQ '1'                                       S01117
0399 C***********SSDC3     CHAINSNAME                99                   S01117
     C**N99******RECI*     COMP 'D'                  9999                 S01117
     C****************     END                                            S01117
     C****************                                                    S01117
0410 C*****IF*CUST*NO. - CHECK IT EXISTS ON CLINT                         S01117
     C****************                                                    S01117
0390 C************IN27     IFEQ '1'                                       S01117
0413 C****************     MOVE SCSNMA    CNUM                            S01117
0414 C***********CNUM*     CHAINCLINTCBF             99                   S01117
     C**N99******RECI*     COMP 'D'                  9999                 S01117
     C****************     END                                            S01117
     C****************                                                    S01117
0410 C*****IF*ON*CLINTCB - CHECK IT EXISTS ON CLINTSE                     S01117
     C****************                                                    S01117
0390 C************IN99     IFEQ '0'                                       S01117
0414 C***********CNUM*     CHAINCLINTSEF             99                   S01117
     C**N99******RECI*     COMP 'D'                  9999                 S01117
     C****************     END                                            S01117
     C************IN99     IFEQ '1'                                       S01117
     C****************     ADD  1         EC         42                   S01117
     C****************     MOVEL' 221'    ERR,EC                          S01117
     C**N30***********     Z-ADD16        LNNBRD                          S01117
     C**N30***********     Z-ADD25        PSNBRD     30                   S01117
     C****************     ELSE                                           S01117
     C****************     Z-ADDCNUM      SDC3                            S01117
     C****************     END                                            S01117
     C****************     END                                            S01117
     C*                                                                   S01117
     C** CHECK IF CLIENT IS A CUSTOMER FOR MIDAS AND SECURITY TRADING     S01117
     C*                                                                   S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SSDC3     @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CUSTOMER                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         42                   S01117
     C                     MOVEL' 221'    ERR,EC                          S01117
     C*                                                                   S01117
     C**N30******          Z-ADD16        LNNBRD                    S01117E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01117E48038
     C  N30                Z-ADD9         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM BBCUST    @AENB   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CUSTOMER                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         42                   S01117
     C                     MOVEL' 221'    ERR,EC                          S01117
     C*                                                                   S01117
     C**N30******          Z-ADD16        LNNBRD                    S01117E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01117E48038
     C  N30                Z-ADD9         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           S01117
     C           BFCLAS    IFNE 'E'                                       E24360
     C********** BFCLAS    ANDNE'K'                                       E24360              CSE022
     C           BFCLAS    ANDNE'C'                                       E24360
     C           BFCLAS    ANDNE'X'                                       E24360
     C           BFCLAS    ANDNE'M'                                       E24360
     C                     ADD  1         EC         42                   E24360
     C                     MOVEL' 250'    ERR,EC                          E24360
     C**N30******          Z-ADD16        LNNBRD                    E24360E48038
     C**N30******          Z-ADD25        PSNBRD     30             E24360E48038
     C  N30                Z-ADD9         LNNBRD                          E48038
     C  N30                Z-ADD36        PSNBRD     30                   E48038
     C                     ELSE                                           E24360
     C                     MOVE BBCUST    SDC3                            S01117
     C                     END                                            E24360
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** TRANSLATE AND VALIDATE SSTC3 (#ALPV) - SEDOL/TELEKURS/CUSIP 3
     C*
     C                     MOVELSSTC3     STC3
     C*
     C** MAY ONLY BE ENTERED IF CORRESPONDING SETT. DEPOT ENTERED
     C*
     C           SSTC3     IFNE *BLANK
     C           SSDC3     IFEQ *BLANK
     C                     ADD  1         EC         43
     C                     MOVEL' 212'    ERR,EC
     C**N30******          Z-ADD17        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD9         LNNBRD                          E48038
     C  N30                Z-ADD61        PSNBRD     30                   E48038
     C                     END
     C*
     C           SSTC3     IFNE 'S'
     C           SSTC3     ANDNE'T'
     C           SSTC3     ANDNE'C'
     C                     ADD  1         EC         43
     C                     MOVEL' 213'    ERR,EC
     C**N30******          Z-ADD17        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD9         LNNBRD                          E48038
     C  N30                Z-ADD61        PSNBRD     30                   E48038
     C                     END
     C                     END
     C*
     C** TRANSLATE AND VALIDATE SCMGN (#NUMV) - COLLATERAL MARGIN
     C*
     C** IF LEFT BLANK, INSERT DEFAULT OF 100
     C*
     C           SCMGN     IFEQ *BLANKS
     C           SCMGN     OREQ *ZERO
     C                     Z-ADD100       CMGN
     C                     ELSE
     C                     Z-ADD3         ZADIG
     C                     Z-ADD0         ZADEC
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE SCMGN     ZFIELD
     C*
     C                     EXSR ZALIGN
     C*
     C           *IN99     IFEQ '0'
     C                     MOVE ZFIELD    SCMGN
     C                     MOVE ZFIELD    CMGN
     C           SCMGN     COMP '100'                99
     C  N99      SCMGN     COMP '001'                  99
     C                     END
     C*
     C           *IN99     IFEQ '1'
     C                     ADD  1         EC         44
     C                     MOVEL' 214'    ERR,EC
     C**N30******          Z-ADD18        LNNBRD                          E48038
     C**N30******          Z-ADD25        PSNBRD     30                   E48038
     C  N30                Z-ADD10        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END
     C                     END
      *                                                                                       CGP001
      ** Validate the Global Product Code if CGP001 is enabled.                               CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRVGPC                                                        CGP001
     C                     ENDIF                                                              CGP001
     C*
     C** TRANSLATE AND VALIDATE SEXPC (#NUMV) - EXPOSURE PERCENTAGE
     C*
     C** IF LEFT BLANK, INSERT DEFAULT OF 100
     C*
     C           SEXPC     IFEQ *BLANKS
     C           SEXPC     OREQ *ZERO
     C                     Z-ADD100       EXPC
     C                     ELSE
     C                     Z-ADD3         ZADIG
     C                     Z-ADD0         ZADEC
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE SEXPC     ZFIELD
     C*
     C                     EXSR ZALIGN
     C*
     C           *IN99     IFEQ '0'
     C                     MOVE ZFIELD    SEXPC
     C                     MOVE ZFIELD    EXPC
     C           SEXPC     COMP '100'                99
     C  N99      SEXPC     COMP '001'                  99
     C                     END
     C*
     C           *IN99     IFEQ '1'
     C                     ADD  1         EC         45
     C                     MOVEL' 215'    ERR,EC
     C**N30******          Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD11        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30
     C                     END
     C                     END
     C*                                                                   S01176
     C**  TRANSLATE AND VALIDATE SINAK - INCLUDE IN A/C KEY               S01176
     C*                                                                   S01176
     C           SINAK     IFNE *BLANK                                    S01176
     C           SINAK     ANDNE'Y'                                       S01176
     C           SINAK     ANDNE'N'                                       S01176
     C                     ADD  1         EC         65                   S01176
     C                     MOVEL' 216'    ERR,EC                          S01176
     C**N30******          Z-ADD20        LNNBRD                    S01176E48038
     C**N30******          Z-ADD25        PSNBRD     30             S01176E48038
     C  N30                Z-ADD11        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C           SINAK     IFEQ *BLANK                                    S01176
     C                     MOVE 'Y'       INAK                            S01176
     C                     ELSE                                           S01176
     C                     END                                            S01176
     C                     MOVELSINAK     INAK                            S01176
      *                                                                                       CGP001
      ** Validate the Global Instrument Code if CGP001 is enabled.                            CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRVGIC                                                        CGP001
     C                     ENDIF                                                              CGP001
     C*                                                                   S01176
     C*                                                                   S01176
     C**  TRANSLATE AND VALIDATE SDMCY - DEF. MULTI-CCY IND               S01176
     C*                                                                   S01176
     C           SDMCY     IFNE *BLANK                                    S01176
     C           SDMCY     ANDNE'Y'                                       S01176
     C           SDMCY     ANDNE'N'                                       S01176
     C                     ADD  1         EC         66                   S01176
     C                     MOVEL' 217'    ERR,EC                          S01176
     C**N30******          Z-ADD8         LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD13        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C           SDMCY     IFEQ *BLANK                                    S01176
     C                     MOVE 'N'       DMCY                            S01176
     C                     ELSE                                           S01176
     C                     END                                            S01176
     C                     MOVELSDMCY     DMCY                            S01176
     C*                                                                   S01176
     C**  TRANSLATE AND VALIDATE SDVCY - DEF VALUE CCY                    S01176
     C*                                                                   S01176
     C           SDVCY     IFNE *BLANK                                    S01176
     C           SDMCY     ANDEQ'Y'                                       S01176
     C                     ADD  1         EC         67                   S01176
     C                     MOVEL' 218'    ERR,EC                          S01176
     C**N30******          Z-ADD9         LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD13        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C           SDVCY     IFEQ SCCYI                                     S01176
     C                     ADD  1         EC         67                   S01176
     C                     MOVEL' 219'    ERR,EC                          S01176
     C**N30******          Z-ADD9         LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD13        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C*                                                                   S01176
     C           SDVCY     IFNE *BLANK                                    S01176
     C****************     Z-ADD20        KLNO                      S01176S01117
     C****************     MOVEL*BLANK    KFIL1                     S01176S01117
     C****************     MOVELSDVCY     KLKEY                     S01176S01117
     C*****************    MOVEL'1'       KFIL2                     S01176S01117
     C***********KTG10F    CHAINTABTG10F             99             S01176S01117
     C************IN,99    IFNE '1'                                 S01176S01117
     C***********RECI**    IFNE 'D'                                 S01176S01117
     C*****************    MOVEA'1'       *IN,99                    S01176S01117
     C*****************    END                                      S01176S01117
     C*****************    END                                      S01176S01117
     C*****************                                             S01176S01117
     C************IN,99    IFEQ '1'                                       S01117
     C*
     C*    ACCESS CURRENCY FILE SDCURRPD                                  S01117
     C*                                                                   S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM SDVCY     @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CURRENCY                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         67                   S01176
     C                     MOVEL' 220'    ERR,EC                          S01176
     C**N30******          Z-ADD9         LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD13        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C                     MOVELSDVCY     DVCY                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDVDT - VALUE DATE DEFAULT                S01176
     C*                                                                   S01176
     C           SDVLD     IFNE *BLANK                                    S01176
     C                     MOVE *BLANKS   VDT                             S01176
     C                     MOVELSDVLD     VDT                             S01176
     C           VN1       IFGT '9'                                       S01176
     C           VN1       ORLT '0'                                       S01176
     C                     ADD  1         EC         68                   S01176
     C                     MOVEL' 235'    ERR,EC                          S01176
     C**N30******          Z-ADD10        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C           VN2       IFGT '9'                                       S01176
     C           VN2       ORLT '0'                                       S01176
     C                     ADD  1         EC         68                   S01176
     C                     MOVEL' 235'    ERR,EC                          S01176
     C**N30******          Z-ADD10        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C           VCH       IFNE 'A'                                       S01176
     C           VCH       ANDNE'W'                                       S01176
     C                     ADD  1         EC         68                   S01176
     C                     MOVEL' 235'    ERR,EC                          S01176
     C**N30******          Z-ADD10        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C                     MOVELSDVLD     DVDT                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDEXD - EX-DATE DATE DEFAULT              S01176
     C*
     C           SDEXD     IFNE *BLANK                                    S01176
     C                     MOVE *BLANKS   VDT                             S01176
     C                     MOVELSDEXD     VDT                             S01176
     C*                                                                   S01176
     C           VN1       IFGT '9'                                       S01176
     C           VN1       ORLT '0'                                       S01176
     C                     ADD  1         EC         69                   S01176
     C                     MOVEL' 222'    ERR,EC                          S01176
     C**N30******          Z-ADD11        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C*                                                                   S01176
     C           VN2       IFGT '9'                                       S01176
     C           VN2       ORLT '0'                                       S01176
     C                     ADD  1         EC         69                   S01176
     C                     MOVEL' 222'    ERR,EC                          S01176
     C**N30******          Z-ADD11        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C*                                                                   S01176
     C           VCH       IFNE 'A'                                       S01176
     C           VCH       ANDNE'W'                                       S01176
     C                     ADD  1         EC         69                   S01176
     C                     MOVEL' 222'    ERR,EC                          S01176
     C**N30******          Z-ADD11        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C                     MOVELSDEXD     DEXD                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDTRD - DEF. TRADE DENOMINATION           S01176
     C*                                                                   S01176
     C           SDTRD     IFNE *BLANK                                    S01176
      *                                                                   207543
      *  TRANSLATE AND VALIDATE SDTRD - DEF. TRADE DENOMINATION           207543
      *                                                                   207543
     C           CEU018    IFEQ 'Y'                                       207543
      *                                                                   207543
     C           SPROT     IFEQ '7'                                       207543
     C           SPROT     OREQ '8'                                       207543
     C           SPROT     OREQ '9'                                       207543
     C           SPROT     OREQ '1'                                       207543
     C                     ADD  1         EC         70    *              207543
     C                     MOVEL' 223'    ERR,EC                          207543
     C  N30                Z-ADD15        LNNBRD                          207543
     C  N30                Z-ADD25        PSNBRD     30    *              207543
     C                     END                                            207543
      *                                                                   207543
     C                     ELSE                                           207543
      *                                                                   207543
     C/COPY WNCPYSRC,SE0020C006
     C           SPROT     IFEQ '7'                                       S01176
     C           SPROT     OREQ '8'                                       S01176
     C                     ADD  1         EC         70                   S01176
     C                     MOVEL' 223'    ERR,EC                          S01176
     C**N30******          Z-ADD12        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD15        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
      *                                                                   207543
     C                     END                                            207543
      *                                                                   207543
     C/COPY WNCPYSRC,SE0020C007
     C*                                                                   S01176
     C           SDTRD     IFNE *ZEROS                                    S01176
     C           SDTRD     ANDNE*BLANKS                                   S01176
     C                     Z-ADD7         ZADIG                           S01176
     C/COPY WNCPYSRC,SE0020C001
     C                     Z-ADD0         ZADEC                           S01176
     C                     MOVE *BLANK    ZFIELD                          S01176
     C                     MOVE SDTRD     ZFIELD                          S01176
     C                     EXSR ZALIGN                                    S01176
     C                     MOVE ZFIELD    DTRD                            S01176
     C                     ELSE                                           S01176
     C                     MOVE *BLANKS   DTRD                            S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDIND - DEFAULT INDUSTRY CODE             S01176
     C*                                                                   S01176
     C           SDIND     IFNE *BLANK                                    S01176
     C                     CALL 'AOINDSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SDIND     @CDNB   3                       S01117
     C           SDINDS    PARM SDINDS    DSFDY                           S01117
     C*
     C****************     Z-ADD61        KLNO                      S01176S01117
     C****************     MOVE *BLANK    KFIL3                     S01176S01117
     C****************     MOVE SDIND     KDIND                     S01176S01117
     C***********KTG10F    CHAINTABLETNF             99             S01176S01117
     C************IN,99    IFEQ '1'                                 S01176S01117
     C*                                                                   S01117
     C** INVALID INDUSTRY                                                 S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         71                   S01176
     C*                                                                   S01117
     C                     MOVEL' 224'    ERR,EC                          S01117
     C**N30******          Z-ADD13        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD16        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C                     MOVELSDIND     DIND                            S01176
     C*                                                                   S01176
     C** TRANSLATE SDSEC - DEFAULT SECTOR (NO VALIDATION)                 S01176
     C                     MOVE SDSEC     DSEC                            S01176
     C*                                                                   S01176
     C** TRANSLATE SDRAT - DEFAULT RATING (NO VALIDATION)                 S01176
     C                     MOVE SDRAT     DRAT                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDMAR - DEF MARKET INDICATOR              S01176
     C*                                                                   S01176
     C           SDMAR     IFNE *BLANK                                    S01176
     C           SDMAR     IFNE 'G'                                       S01176
     C           SDMAR     ANDNE'P'                                       S01176
     C           SDMAR     ANDNE'S'                                       S01176
     C                     ADD  1         EC         73                   S01176
     C                     MOVEL' 225'    ERR,EC                          S01176
     C**N30******          Z-ADD15        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD71        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C           ACTN      IFEQ 'A'                                       S01176
     C           DMAR      IFGT SDMAR                                     S01176
     C                     ADD  1         EC         73                   S01176
     C                     MOVEL' 226'    ERR,EC                          S01176
     C**N30******          Z-ADD15        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD14        LNNBRD                          E48038
     C  N30                Z-ADD71        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C*                                                                   E22170
     C** Only update DMAR If no Errors produced in validation of SDMAR    E22170
     C*                                                                   E22170
     C***********LNNBRD    IFNE 15                                  E22170E48038
     C***********PSNBRD    ANDNE67                                  E22170E48038
     C           LNNBRD    IFNE 14                                        E48038
     C           PSNBRD    ANDNE71                                        E48038
     C                     MOVELSDMAR     DMAR                            S01176
     C                     END                                            E22170
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDCNR - DEFAULT COUNTRY OF RISK           S01176
     C*                                                                   S01176
     C           SDCNR     IFNE *BLANK                                    S01176
     C                     CALL 'AOCTRYR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM SDCNR     @AXCD   2                       S01117
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01117
     C*****************    Z-ADD50        KLNO                      S01176S01117
     C*****************    MOVE *BLANK    KFIL4                     S01176S01117
     C*****************    MOVE SDCNR     KDCNR                     S01176S01117
     C***********KTG10F    CHAINTABLETHF             99             S01176S01117
     C*****************                                             S01176S01117
     C************IN,99    IFEQ '1'                                 S01176S01117
     C*
     C** INVALID COUNTRY INPUT
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         EC         75
     C                     MOVEL' 227'    ERR,EC                          S01117
     C  N30                Z-ADD17        LNNBRD                          S01176
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C                     MOVELSDCNR     DCYR                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDDYB - DEFAULT DAY BASIS                 S01176
     C*                                                                   S01176
     C           SDDYB     IFNE *BLANK                                    S01176
     C           SDDYB     IFNE '1'                                       S01176
     C           SDDYB     ANDNE'2'                                       S01176
     C           SDDYB     ANDNE'3'                                       S01176
     C           SDDYB     ANDNE'4'                                       S01176
     C           SDDYB     ANDNE'5'                                       E25992
     C           SDDYB     ANDNE'6'                                       S01176
     C                     ADD  1         EC         76                   S01176
     C                     MOVEL' 228'    ERR,EC                          S01176
     C  N30                Z-ADD18        LNNBRD                          S01176
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C*                                                                   S01176
     C           STRBS     IFNE 'D'                                       S01176
     C           SPROT     IFEQ '2'                                       S01176
     C           SPROT     OREQ '4'                                       S01176
     C           SPROT     OREQ '7'                                       S01176
     C                     ADD  1         EC         76                   S01176
     C                     MOVEL' 229'    ERR,EC                          S01176
     C  N30                Z-ADD18        LNNBRD                          S01176
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
      *                                                                                       241200
      ** Discounts must not be Day Basis 4.                                                   241200
      *                                                                                       241200
     C           STRBS     IFEQ 'D'                                                           241200
     C           SDDYB     ANDEQ'4'                                                           241200
     C                     ADD  1         EC         76                                       241200
     C                     MOVEL' 239'    ERR,EC                                              241200
     C  N30                Z-ADD18        LNNBRD                                              241200
     C  N30                Z-ADD25        PSNBRD     30                                       241200
     C                     ENDIF                                                              241200
      *                                                                                       241200
     C                     END                                            S01176
     C                     MOVELSDDYB     DDYB                            S01176
     C*                                                                   S01176
     C** TRANSLATE AND VALIDATE SDDVB - DEFAULT DIVISOR BASIS             S01176
     C*                                                                   S01176
     C/COPY WNCPYSRC,SE0020C014
     C           SDDVB     IFNE *BLANK                                    S01176
     C           SDDVB     IFNE '1'                                       S01176
     C           SDDVB     ANDNE'2'                                       S01176
     C           SDDVB     ANDNE'3'                                       S01176
     C           SDDVB     ANDNE'5'                                       S01176
     C                     ADD  1         EC         77                   S01176
     C                     MOVEL' 230'    ERR,EC                          S01176
     C**N30******          Z-ADD19        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD18        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C*                                                                   S01176
     C           STRBS     IFNE 'D'                                       S01176
     C           SPROT     IFEQ '2'                                       S01176
     C           SPROT     OREQ '4'                                       S01176
     C           SPROT     OREQ '7'                                       S01176
     C                     ADD  1         EC         77                   S01176
     C                     MOVEL' 232'    ERR,EC                          S01176
     C**N30******          Z-ADD19        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD18        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C           STRBS     IFEQ 'D'                                       S01176
     C           SDDVB     ANDEQ'5'                                       S01176
     C                     ADD  1         EC         77                   S01176
     C                     MOVEL' 231'    ERR,EC                          S01176
     C**N30******          Z-ADD19        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD18        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C                     MOVELSDDVB     DDVB                            S01176
     C*                                                                   S01176
     C**  TRANSLATE AND VALIDATE SDCNT - DEF CONT. LIAB IND.              S01176
     C*
     C*   Default SDCNT to 'N'                                            E20020
     C*                                                                   E20020
     C           SDCNT     IFEQ *BLANK                                    E20020
     C                     MOVE 'N'       SDCNT                           E20020
     C                     END                                            E20020
     C*                                                                   E20020
     C***********SDCNT     IFNE *BLANK                             S01176 E20020
     C***********SDCNT     ANDNE'Y'                                S01176 E20020
     C           SDCNT     IFNE 'Y'                                       E20020
     C           SDCNT     ANDNE'N'                                       S01176
     C                     ADD  1         EC         78                   S01176
     C                     MOVEL' 233'    ERR,EC                          S01176
     C**N30******          Z-ADD20        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD17        LNNBRD                          E48038
     C  N30                Z-ADD59        PSNBRD     30                   E48038
     C                     END                                            S01176
     C*                                                                   S01176
     C           SDCNT     IFEQ 'Y'                                       S01176
     C           SPROT     IFEQ '2'                                       S01176
     C           SPROT     OREQ '4'                                       S01176
     C           SPROT     OREQ '7'                                       S01176
     C                     ADD  1         EC         78                   S01176
     C                     MOVEL' 234'    ERR,EC                          S01176
     C**N30******          Z-ADD20        LNNBRD                    S01176E48038
     C**N30******          Z-ADD67        PSNBRD     30             S01176E48038
     C  N30                Z-ADD17        LNNBRD                          E48038
     C  N30                Z-ADD59        PSNBRD     30                   E48038
     C                     END                                            S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C***********SDCNT     IFEQ *BLANK                             S01176 E20020
     C***********          MOVEL'N'       DCNL                     S01176 E20020
     C***********          ELSE                                    S01176 E20020
     C***********          END                                     S01176 E20020
     C                     MOVELSDCNT     DCNL                            S01176
      *                                                                   S01176
     C           S01496    IFEQ 'Y'                                       S01496
     C*                                                                   S01496
     C* TRANSLATE AND VALIDATE SPRTO - PRICE TOLERANCE                    S01496
     C*                                                                   S01496
     C* IF LEFT BLANK, INSERT DEFAULT OF 10                               S01496
     C*                                                                   S01496
     C           SPRTO     IFEQ *BLANKS                                   S01496
     C                     MOVE '10.000'  SPRTO                           S01496
     C                     END                                            S01496
     C                     Z-ADD2         ZADIG                           S01496
     C                     Z-ADD3         ZADEC                           S01496
     C                     MOVE *BLANK    ZFIELD                          S01496
     C                     MOVE SPRTO     ZFIELD                          S01496
     C                     EXSR ZALIGN                                    S01496
     C           *IN99     IFEQ '0'                                       S01496
     C                     MOVE ZFIELD    PRTO                            S01496
     C                     Z-ADD3         ZADEC                           S01496
     C                     EXSR ZEDIT                                     S01496
     C                     MOVE ZFIELD    SPRTO                           S01496
     C                     END                             *IN99          S01496
     C           *IN99     IFEQ '1'                                       S01496
     C                     ADD  1         EC         82    *              S01496
     C                     MOVEL' 237'    ERR,EC                          S01496
     C  N30                Z-ADD20        LNNBRD                          S01496
     C  N30                Z-ADD25        PSNBRD     30    *              S01496
     C                     END                             *IN99          S01496
     C*                                                                   S01496
     C                     ENDIF                                          S01496
     C*                                                                   S01496
     C** TRANSLATE AND VALIDATE SINNR - INTRUMENT TYPE NARRATIVE          S01486
     C*                                                                   S01486
     C           *INU4     IFEQ '1'                                       S01486
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C           CGL014    OREQ 'Y'                                                         BUG23049
     C                     MOVE '1'       *IN84                           S01486
     C                     MOVE '0'       *IN99                           S01486
     C*                                                                   080099
     C** Resolve '?' before validation                                    080099
     C*                                                                   080099
     C                     MOVEASINNR     INP                             080099
     C           '?'       LOKUPINP                      85               080099
     C*                                                                   080099
     C           *IN85     IFEQ '1'                                       080099
     C                     CALL 'AOPLINR0'                                080099
     C                     PARM *BLANKS   P@RTCD                          080099
     C                     PARM '*KEY'    P@OPTN                          080099
     C                     PARM '?'       P@KEY3                          080099
     C           SDPLIN    PARM SDPLIN    DSFDY                           080099
     C*                                                                   080099
     C** If selection made, move value to screen field                    080099
     C*                                                                   080099
     C           P@RTCD    IFEQ *BLANKS                                   080099
     C                     MOVELPDINNR    SINNR                           080099
     C                     ELSE                                           080099
     C                     MOVE *BLANKS   SINNR                           080099
     C                     MOVE *BLANKS   P@RTCD                          080099
     C                     END                                            080099
     C** Force screen to be redisplayed                                   080770
     C                     MOVE *BLANKS   AID                             080770
     C*                                                                   080099
     C                     END                                            080099
     C*                                                                   S01486
     C           SINNR     IFEQ *BLANKS                                   S01486
     C           *INU4     ANDEQ'0'                                       CPB001
     C           CGL014    ANDEQ'N'                                                         BUG23049
     C           SINNR     OREQ FCDINR                                    S01486
     C           *INU4     ANDEQ'0'                                       CPB001
     C           CGL014    ANDEQ'N'                                                         BUG23049
     C                     MOVE FCDINR    SINNR                           S01486
     C                     ELSE                                           S01486
     C           SINNR     IFNE *BLANKS                                                     BUG23049
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY'    P@OPTN                          S01486
     C                     PARM SINNR     P@KEY3  3                       S01486
     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
     C                     ELSE                                                             BUG23049
     C                     MOVE *BLANKS   P@RTCD                                            BUG23049
     C                     ENDIF                                                            BUG23049
     C                     ENDIF                                          S01486
     C*                                                                   S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C                     MOVE '1'       *IN83                           S01486
     C**********           ADD  1         EC         78            S01486 CPB001
     C                     ADD  1         EC         83                   CPB001
     C**********           MOVEL' 235'    ERR,EC                   S01486 CPB001
     C                     MOVEL' 238'    ERR,EC                          CPB001
     C  N30                Z-ADD21        LNNBRD                          S01486
     C**N30*****           Z-ADD25        PSNBRD     30    *       S01486 CPB001
     C  N30                Z-ADD51        PSNBRD     30    *              CPB001
     C                     ELSE                                           S01486
     C                     MOVE SINNR     INNR                            S01486
     C                     ENDIF                                          S01486
     C*                                                                   S01486
     C                     ENDIF                                          S01486
      *                                                                   S01176
      ***  Translate and validate SDCMF - Default Compuonding Frequency   S01397
      *                                                                   S01397
     C           SDCMF     IFNE *BLANKS                                   S01397
     C                     MOVE *BLANKS   ZFIELD                          S01397
     C                     MOVELSDCMF     ZFIELD                          S01397
     C                     Z-ADD0         ZADEC                           S01397
     C                     Z-ADD2         ZADIG                           S01397
     C                     EXSR ZALIGN                                    S01397
      *                                                                   S01397
      ***  Must be numeric.                                               S01397
      *                                                                   S01397
     C           *IN99     IFEQ '1'                                       S01397
     C                     ADD  1         EC                              S01397
     C                     MOVEL' 240'    ERR,EC                          S01397
     C                     SETON                     79                   S01397
     C  N30                Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
      *                                                                   S01397
     C************IN30     IFNE '1'                                 S01397E48038
     C***********          SETON                     30             S01397E48038
     C***********          END                                      S01397E48038
      *                                                                   S01397
     C                     ELSE                                           S01397
     C                     MOVE ZFIELD    NDCMF  160                      S01397
     C                     MOVE ZFIELD    SDCMF                           S01397
     C***********          MOVELSDCMF     DCMF                     S01397 E44886
      *                                                                   S01397
      ***  Must be within 1 to 12.                                        S01397
      *                                                                   S01397
     C           NDCMF     IFLT 1                                         S01397
     C           NDCMF     ORGT 12                                        S01397
     C                     ADD  1         EC                              S01397
     C                     MOVEL' 241'    ERR,EC                          S01397
     C                     SETON                     79                   S01397
     C  N30                Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
      *                                                                   S01397
     C************IN30     IFNE '1'                                 S01397E48038
     C***********          SETON                     30             S01397E48038
     C***********          END                                      S01397E48038
      *                                                                   S01397
     C                     END                                            S01397
     C                     END                                            S01397
     C                     END                                            S01397
      *                                                                   S01397
      ***  Translate and Validate SDDSB - Default Discount Basis.         S01397
      *                                                                   S01397
     C           SDDSB     IFNE *BLANKS                                   S01397
     C                     MOVE *BLANKS   ZFIELD                          S01397
     C                     MOVELSDDSB     ZFIELD                          S01397
     C                     Z-ADD0         ZADEC                           S01397
     C                     Z-ADD1         ZADIG                           S01397
     C                     EXSR ZALIGN                                    S01397
      *                                                                   S01397
      ***  Must be numeric.                                               S01397
      *                                                                   S01397
     C           *IN99     IFEQ '1'                                       S01397
     C                     ADD  1         EC                              S01397
     C                     MOVEL' 242'    ERR,EC                          S01397
     C                     SETON                     80                   S01397
     C  N30                Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
      *                                                                   S01397
     C************IN30     IFNE '1'                                 S01397E48038
     C***********          SETON                     30             S01397E48038
     C***********          END                                      S01397E48038
      *                                                                   S01397
     C                     ELSE                                           S01397
     C***********          MOVE SDDSB     DDSB                     S01397 E44886
      *                                                                   S01397
      ***  Must be either 2 or 5.                                         S01397
      *                                                                   S01397
     C           SDDSB     IFNE '2'                                       S01397
     C           SDDSB     ANDNE'5'                                       S01397
     C                     ADD  1         EC                              S01397
     C                     MOVEL' 243'    ERR,EC                          S01397
     C                     SETON                     80                   S01397
     C  N30                Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD51        PSNBRD     30                   E48038
      *                                                                   S01397
     C************IN30     IFNE '1'                                 S01397E48038
     C***********          SETON                     30             S01397E48038
     C***********          END                                      S01397E48038
      *                                                                   S01397
     C                     END                                            S01397
     C                     END                                            S01397
     C                     END                                            S01397
      *                                                                   S01397
      ***  Translate and Validate SDDLS - Default Dis. Last Coupon.       S01397
      *                                                                   S01397
     C           SDDLS     IFNE *BLANKS                                   S01397
      *                                                                   S01397
      ***  Must be either 'Y' or 'N'.                                     S01397
      *                                                                   S01397
     C           SDDLS     IFNE 'Y'                                       S01397
     C           SDDLS     ANDNE'N'                                       S01397
     C                     ADD  1         EC                              S01397
     C                     MOVEL' 244'    ERR,EC                          S01397
     C                     SETON                     81                   S01397
     C  N30                Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD78        PSNBRD     30                   E48038
      *                                                                   S01397
     C************IN30     IFNE '1'                                 S01397E48038
     C***********          SETON                     30             S01397E48038
     C***********          END                                      S01397E48038
      *                                                                   S01397
     C                     END                                            S01397
      *                                                                   S01397
      ***  Default SDDLS to 'N'.                                          S01397
      *                                                                   S01397
     C                     ELSE                                           S01397
     C           SYDBS     IFEQ 'AU'                                      E44886
     C                     MOVEL'N'       SDDLS                           S01397
     C                     END                                            E44886
     C                     END                                            S01397
     C***********          MOVELSDDLS     DDLS                     S01397 E44886
     C*                                                                   S01176
      ***  If yield basis is not 'AU', compounding frequency, discount    E44886
     C*     basis or discount last coupon should not be entered           E44886
     C*                                                                   E44886
     C           SYDBS     IFNE 'AU'                                      E44886
     C           SDCMF     IFNE *BLANKS                                   E44886
     C           SDDSB     ORNE *BLANKS                                   E44886
     C           SDDLS     ORNE *BLANKS                                   E44886
     C                     ADD  1         EC                              E44886
     C                     MOVEL' 245'    ERR,EC                          E44886
     C                     SETON                     798081               E44886
     C  N30                Z-ADD19        LNNBRD                          E48038
     C  N30                Z-ADD25        PSNBRD     30                   E48038
      *                                                                   E44886
     C************IN30     IFNE '1'                                 E44886E48038
     C***********          SETON                     30             E44886E48038
     C***********          END                                      E44886E48038
      *                                                                   E44886
     C                     END                                            E44886
     C                     END                                            E44886
     C*                                                                   E44886
     C           SYDBS     IFEQ 'AU'                                      E44886
     C           *IN30     IFNE '1'                                       E44886
     C                     MOVELSDCMF     DCMF                            E44886
     C                     MOVELSDDSB     DDSB                            E44886
     C                     MOVELSDDLS     DDLS                            E44886
     C                     END                                            E44886
     C                     ELSE                                           E44886
     C                     Z-ADD*ZERO     DCMF                            E44886
     C                     MOVEL*BLANKS   DDSB                            E44886
     C                     MOVEL*BLANKS   DDLS                            E44886
     C                     END                                            E44886
     C                     END                                            S01176
      *                                                                   CPL002
      ** Is Midas-Plato Interface installed?                              CPL002
      *                                                                   CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
      *                                                                   CPL002
      ***  Translate and Validate SDRCD -                                 CPL002
      ***                Midas-Plato Default Reporting Group              CPL002
      *                                                                   CPL002
     C                     MOVE SDRCD     PLDRCD                          CPL002
      *                                                                   CPL002
      ***  Translate and Validate SDPCD -                                 CPL002
      ***                Midas-Plato Default Pricing Group                CPL002
      *                                                                   CPL002
     C                     MOVE SDPCD     PLDPCD                          CPL002
      *                                                                   CPL002
     C                     ENDIF                                          CPL002
      *                                                                                       CSE037
      ** Is Countervalue rounding installed?                                                  CSE037
      *                                                                                       CSE037
     C           CSE037    IFEQ 'Y'                                                           CSE037
      *                                                                                       CSE037
      ***  Translate and Validate number of decimal places                                    CSE037
      *                                                                                       CSE037
     C           SNDEC     IFLT '0'                                                           CSE037
     C           SNDEC     ORGT '8'                                                           CSE037
     C                     ADD  1         EC         53                                       CSE037
     C                     MOVEL' 246'    ERR,EC                                              CSE037
     C  N30                Z-ADD21        LNNBRD                                              CSE037
     C  N30                Z-ADD51        PSNBRD     30                                       CSE037
     C                     ELSE                                                               CSE037
     C                     MOVELSNDEC     NDEC                                                CSE037
      ** default to 8 if not set                                                              CSE037
     C           NDEC      IFEQ *ZERO                                                         CSE037
     C                     Z-ADD8         NDEC                                                CSE037
     C                     END                                                                CSE037
     C                     END                                                                CSE037
      *                                                                                       CSE037
      ***  Translate and Validate prompt at security level flag                               CSE037
      *                                                                                       CSE037
     C           SSFLG     IFNE 'Y'                                                           CSE037
     C           SSFLG     ANDNE'N'                                                           CSE037
     C                     ADD  1         EC         54                                       CSE037
     C                     MOVEL' 247'    ERR,EC                                              CSE037
     C  N30                Z-ADD21        LNNBRD                                              CSE037
     C  N30                Z-ADD79        PSNBRD     30                                       CSE037
     C                     ELSE                                                               CSE037
     C                     MOVELSSFLG     SFLG                                                CSE037
     C                     END                                                                CSE037
      *                                                                                       CSE037
     C                     ENDIF                                                              CSE037
     C*
     C                     ELSE
     C*
     C** IF ACTION=D WITH ENTER PRESSED THEN ERROR
     C*
     C           ACTN      IFEQ 'D'
     C           DLTALW    IFEQ 'Y'                                       085494
     C                     MOVELINF,9     INFMSG
     C                     MOVEL'1'       *IN88                                               255460
     C                     ELSE                                           085494
     C                     MOVELINF,12    INFMSG                          085494
     C                     MOVEL'1'       *IN88                                               255460
     C                     END                                            085494
     C                     END
     C                     END
     C                     ELSE
     C*
     C** IF COMMAND 10 TAKEN
     C*
     C           AID       IFEQ '04'
     C*
     C** COMMAND 10 TAKEN CORRECTLY WHEN ACTION IS D-FORCE 'RECORD ADVANCE'
     C*
     C           ACTN      IFEQ 'D'
     C                     MOVEL'RA'      AID
     C*
     C** COMMAND 10 TAKEN INCORRECTLY WHEN ACTION IS NOT D-HENCE ERROR
     C*
     C                     ELSE
     C                     MOVELINF,10    INFMSG
     C                     MOVEL'1'       *IN88                                               255460
     C                     END
     C                     END
     C*
     C                     END
     C*
     C           EC        IFNE *ZERO
     C**********           MOVELHI        ERRMSG                                              255460
     C                     MOVEL'1'       *IN87                                               255460
     C                     END
     C                     ENDSR
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  INITRC - S/R TO INITIALISE ALL FILE FIELDS TO ZERO/BLANK     *
     C*                                                               *
     C*****************************************************************
     C*
     C           INITRC    BEGSR
     C*
     C** INITIALIZE ALL DATA ON RECORD DEFINED IN DETREC (KEY EXCLUDED)
     C*
     C                     MOVEL*BLANK    DETREC
     C**********           Z-ADD*ZERO     SDC1                                                CSD027
     C**********           Z-ADD*ZERO     SDC2                                                CSD027
     C**********           Z-ADD*ZERO     SDC3                                                CSD027
     C                     MOVE *BLANKS   SDC1                                                CSD027
     C                     MOVE *BLANKS   SDC2                                                CSD027
     C                     MOVE *BLANKS   SDC3                                                CSD027
     C                     Z-ADD*ZERO     CMGN
     C                     Z-ADD*ZERO     EXPC
     C*********  S01496    IFEQ 'Y'                                 S01496176813
     C                     Z-ADD*ZERO     PRTO                            S01496
     C*********            ENDIF                                    S01496176813
     C                     Z-ADD*ZERO     DTRD                            S01176
     C                     Z-ADD*ZERO     LCD
     C                     Z-ADD*ZERO     TNLU
     C                     Z-ADD*ZERO     DCMF                            E48038
     C                     Z-ADD*ZERO     NDEC                                              AR317764
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  TRSFS - S/R TO FORMAT RECORD FIELDS FOR SCREEN               *
     C*                                                               *
     C*****************************************************************
     C*
     C           TRSFS     BEGSR
     C*
     C** TRANSLATE RECORD DETAILS FROM FILE LAYOUT TO SCREEN LAYOUT
     C*
     C*
     C** TRANSLATE INAM (#ALPV) - INVESTMENT NAME
     C*
     C                     MOVELINAM      SINAM
     C*
     C** TRANSLATE PROT (#ALPV) - PROCESSING TYPE
     C*
     C                     MOVELPROT      SPROT
     C*
     C** TRANSLATE CNVI (#ALPV) - CONVERTIBLE IND
     C*
     C*                                                                   E14434
     C** IF PROC. TYPE IS 2,4 OR 7,  MOVE BLANK INTO SCNVI.               E14434
     C*                                                                   E14434
     C           SPROT     IFNE '2'                                       E14434
     C           SPROT     ANDNE'4'                                       E14434
     C           SPROT     ANDNE'7'                                       E14434
     C                     MOVELCNVI      SCNVI
     C                     ELSE                                           E14434
     C                     MOVE *BLANKS   SCNVI                           E14434
     C                     END                                            E14434
     C*
     C** TRANSLATE PRBS (#ALPV) - PRICE BASIS
     C*
     C                     MOVELPRBS      SPRBS
     C*
     C** TRANSLATE TRBS (#ALPV) - TRADE BASIS
     C*
     C                     MOVELTRBS      STRBS
     C*
     C** TRANSLATE DMKT (#ALPV) - MARKET CENTRE
     C*
     C                     MOVELDMKT      SDMKT
     C*
     C** TRANSLATE YDBS (#ALPV) - YIELD BASIS
     C*
     C                     MOVELYDBS      SYDBS
     C*
     C** TRANSLATE SDC1 (#NUMV) - SETTLEMENT DEPOT 1
     C*
     C                     MOVEL*BLANK    SSDC1
     C********** SDC1      IFNE *ZERO                                                         CSD027
     C           SDC1      IFNE *BLANKS                                                       CSD027
     C                     MOVELSDC1      SSDC1
     C                     END
     C*
     C** TRANSLATE STC1 (#ALPV) - SEDOL/TELEKURS/CUSIP 1
     C*
     C                     MOVELSTC1      SSTC1
     C*
     C** TRANSLATE SDC2 (#NUMV) - SETTLEMENT DEPOT 2
     C*
     C                     MOVEL*BLANK    SSDC2
     C********** SDC2      IFNE *ZERO                                                         CSD027
     C           SDC2      IFNE *BLANKS                                                       CSD027
     C                     MOVELSDC2      SSDC2
     C                     END
     C*
     C** TRANSLATE STC2 (#ALPV) - SEDOL/TELEKURS/CUSIP 2
     C*
     C                     MOVELSTC2      SSTC2
     C*
     C** TRANSLATE SDC3 (#NUMV) - SETTLEMENT DEPOT 3
     C*
     C                     MOVEL*BLANK    SSDC3
     C********** SDC3      IFNE *ZERO                                                         CSD027
     C           SDC3      IFNE *BLANKS                                                       CSD027
     C                     MOVELSDC3      SSDC3
     C                     END
     C*
     C** TRANSLATE STC3 (#ALPV) - SEDOL/TELEKURS/CUSIP 3
     C*
     C                     MOVELSTC3      SSTC3
     C*
     C** TRANSLATE CMGN (#NUMV) - COLLATERAL MARGIN
     C*
     C           CMGN      IFNE *ZERO
     C                     MOVELCMGN      SCMGN
     C                     ELSE
     C                     MOVEL*BLANK    SCMGN
     C                     END
     C*
     C** TRANSLATE EXPC (#NUMV) - EXPOSURE PERCENT
     C*
     C           EXPC      IFNE *ZERO
     C                     MOVELEXPC      SEXPC
     C                     ELSE
     C                     MOVEL*BLANK    SEXPC
     C                     END
     C** TRANSLATE DIND (#ALPV) - DEFAULT INDUSTRY CODE                   S01176
     C*                                                                   S01176
     C                     MOVELDIND      SDIND                           S01176
     C*                                                                   S01496
     C           S01496    IFEQ 'Y'                                       S01496
     C*                                                                   S01496
     C* TRANSLATE PRTO (#NUMV) - PRICE TOLERANCE                          S01496
     C*                                                                   S01496
     C           ACTN      IFEQ 'I'                                       S01496
     C                     MOVE '10.000'  SPRTO                           S01496
     C                     ELSE                                           S01496
     C                     MOVE *BLANKS   ZFIELD                          S01496
     C                     MOVE PRTO      ZFIELD                          S01496
     C                     Z-ADD3         ZADEC                           S01496
     C                     EXSR ZEDIT                                     S01496
     C                     MOVE ZFIELD    SPRTO                           S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C                     ENDIF                                          S01496
     C*                                                                   S01176
     C** TRANSLATE DVCY (#ALPV) - DEFAULT VALUE CCY                       S01176
     C*                                                                   S01176
     C                     MOVELDVCY      SDVCY                           S01176
     C*                                                                   S01176
     C** TRANSLATE DMCY (#ALPV) - DEFAULT MULTI CCY IND                   S01176
     C*                                                                   S01176
     C                     MOVELDMCY      SDMCY                           S01176
     C*                                                                   S01176
     C** TRANSLATE DSEC (#ALPV) - DEFAULT SECTOR CODE                     S01176
     C*                                                                   S01176
     C                     MOVELDSEC      SDSEC                           S01176
     C*                                                                   S01176
     C** TRANSLATE DRAT (#ALPV) - DEFAULT RATING                          S01176
     C*                                                                   S01176
     C                     MOVELDRAT      SDRAT                           S01176
     C*                                                                   S01176
     C** TRANSLATE DMAR (#ALPV) - DEFAULT MARKET IND                      S01176
     C*                                                                   S01176
     C                     MOVELDMAR      SDMAR                           S01176
     C*                                                                   S01176
     C** TRANSLATE DCYR (#ALPV) - DEFAULT COUNTRY OF RISK                 S01176
     C*                                                                   S01176
     C                     MOVELDCYR      SDCNR                           S01176
     C*                                                                   S01176
     C** TRANSLATE DTRD (#NUMV) - DEFAULT TRADE DENOMINATION              S01176
     C*                                                                   S01176
     C           DTRD      IFNE *ZERO                                     S01176
     C                     MOVELDTRD      SDTRD                           S01176
     C                     ELSE                                           S01176
     C                     MOVEL*BLANK    SDTRD                           S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C** TRANSLATE DEXD (#ALPV) - DEFAULT EX DATE                         S01176
     C*                                                                   S01176
     C                     MOVELDEXD      SDEXD                           S01176
     C*                                                                   S01176
     C** TRANSLATE DVDT (#ALPV) - DEFAULT VALUE DATE                      S01176
     C*                                                                   S01176
     C                     MOVELDVDT      SDVLD                           S01176
     C*                                                                   S01176
     C** TRANSLATE DDYB (#ALPV) - DEFAULT DAY BASIS                       S01176
     C*                                                                   S01176
     C                     MOVELDDYB      SDDYB                           S01176
     C*                                                                   S01176
     C** TRANSLATE DDVB (#ALPV) - DEFAULT DIVISOR BASIS                   S01176
     C*                                                                   S01176
     C                     MOVELDDVB      SDDVB                           S01176
     C*                                                                   S01176
     C** TRANSLATE DCNL (#ALPV) - DEFAULT CONT LIAB IND                   S01176
     C*                                                                   S01176
     C                     MOVELDCNL      SDCNT                           S01176
     C*                                                                   S01176
     C** TRANSLATE INAK (#ALPV) - DEFAULT INCL IN A/C KEY                 S01176
     C*                                                                   S01176
     C                     MOVELINAK      SINAK                           S01176
      *                                                                   S01176
      ***  Translate DCMF - Default Compounding Frequency.                S01397
      *                                                                   S01397
     C           DCMF      IFNE *ZERO                                     S01397
     C                     MOVELDCMF      SDCMF                           S01397
     C                     ELSE                                           S01397
     C                     MOVEL*BLANK    SDCMF                           S01397
     C                     END                                            S01397
      *                                                                   S01397
      ***  Translate DDLS - Default Discounted Last Coupon.               S01397
      *                                                                   S01397
     C                     MOVELDDLS      SDDLS                           S01397
      *                                                                   S01397
      ***  Translate DDSB - Default Discount Basis.                       S01397
      *                                                                   S01397
     C                     MOVELDDSB      SDDSB                           S01397
      *                                                                   S01397
     C* TRANSLATE INNR (#ALPV) - INSTRUMENT TYPE NARRATIVE                S01486
     C*                                                                   S01486
     C                     MOVELINNR      SINNR                           S01486
      *                                                                   CPL002
      ** Is Midas-Plato Interface installed?                              CPL002
      *                                                                   CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
      *                                                                   CPL002
      **  Translate PLDRCD - Midas-Plato                                  CPL002
      **                     Default Reporting Group                      CPL002
      *                                                                   CPL002
     C                     MOVELPLDRCD    SDRCD                           CPL002
      *                                                                   CPL002
      **  Translate PLDPCD - Midas-Plato                                  CPL002
      **                     Default Pricing Group                        CPL002
      *                                                                   CPL002
     C                     MOVELPLDPCD    SDPCD                           CPL002
      *                                                                   CPL002
     C                     ENDIF                                          CPL002
      *                                                                   CPL002
     C*                                                                   S01486
      *                                                                                       CSE037
      ** Is Countervalue rounding installed?                                                  CSE037
      *                                                                                       CSE037
     C           CSE037    IFEQ 'Y'                                                           CSE037
      *                                                                                       CSE037
      **  Translate Number of decimal places                                                  CSE037
      *                                                                                       CSE037
     C                     MOVELNDEC      SNDEC                                               CSE037
      *                                                                                       CSE037
      **  Translate Prompt at security level flag                                             CSE037
      *                                                                                       CSE037
     C                     MOVELSFLG      SSFLG                                               CSE037
      *                                                                                       CSE037
     C                     ENDIF                                                              CSE037
      *                                                                                       CSE037
     C/COPY WNCPYSRC,SE0020C002
      *                                                                                       CGP001
      ** Move the Global Product and Instrument Codes to screen fields                        CGP001
      ** if CGP001 is enabled.                                                                CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C           ACTN      IFEQ 'I'                                                           CGP001
     C                     MOVE *BLANKS   #1PRDC                                              CGP001
     C                     MOVE *BLANKS   #1INSC                                              CGP001
     C                     ELSE                                                               CGP001
     C                     MOVELSCCYI     XCCYI                                               BG1350
     C                     MOVELSINVT     XINVT                                               BG1350
     C                     EXSR SRGPPI                                                        CGP001
     C                     ENDIF                                                              CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* UPDFLS - S/R TO UPDATE FILE RECORDS                           *
     C*                                                               *
     C*****************************************************************
     C*
     C           UPDFLS    BEGSR
     C*
     C**  U P D A T E   F I L E S
     C*
     C** INITIALIZE ALL FIELDS ON THE RECORD (IE ZEROIZE/BLANK OUT)
     C*
     C                     EXSR INITRC
     C*
     C                     EXSR ZTNLU1
     C*
     C                     MOVEL*BLANK    INFMSG
     C*
     C*                I  N  S  E  R  T  S                 -  S T A R T
     C*
     C           ACTN      IFEQ 'I'
     C           INVTPK    CHAININVTPDF              60
     C           TNLU      IFNE STNLU
     C                     Z-ADD01021     STATUS
     C                     EXSR INFSR
     C                     ELSE
     C*
     C** TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
     C*
     C                     EXSR VALIDD
      *                                                                                       CGP001
      ** Save the Global Product and Instrument Codes to the Cross-                           CGP001
      ** Reference Files if CGP001 is enabled.                                                CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRGPXU                                                        CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     MOVEL'D'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'I'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
     C   60                WRITEINVTPDF
     C  N60                UPDATINVTPDF
     C                     ELSE
     C*
     C**                I  N  S  E  R  T  S                 -  E N D
     C*
     C**                A  M  E  N  D  S                    -  S T A R T
     C*
     C           ACTN      IFEQ 'A'
     C           INVTPK    CHAININVTPDF              60
     C           TNLU      IFNE STNLU
     C                     Z-ADD01021     STATUS
     C                     EXSR INFSR
     C                     ELSE
     C*
     C** TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
     C*
     C                     EXSR VALIDD
      *                                                                                       CGP001
      ** Save the Global Product and Instrument Codes to the Cross-                           CGP001
      ** Reference Files if CGP001 is enabled.                                                CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRGPXU                                                        CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     MOVEL'D'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'A'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
     C  N60                UPDATINVTPDF
     C                     ELSE
     C*
     C**               A  M  E  N  D  S                    -  E N D
     C*
     C**               D  E  L  E  T  E  S                 -  S T A R T
     C*
     C           ACTN      IFEQ 'D'
     C           INVTPK    CHAININVTPDF              60
     C           TNLU      IFNE STNLU
     C                     Z-ADD01021     STATUS
     C                     EXSR INFSR
     C                     ELSE
      *                                                                                       CGP001
      ** Enforce referential integrity if CGP001 is enabled.                                  CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRGPXD                                                        CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     MOVEL'*'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'D'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
     C  N60                UPDATINVTPDF
     C                     END
     C*
     C**               D  E  L  E  T  E  S                 -  E N D
     C*
     C                     END
     C                     END
     C*
     C** GET AUDIT RECORD
     C*
     C           1         CHAININVTPAF              U7
     C*
     C** UPDATE AUDIT RECORD IF FOUND
     C*
     C           *INU7     IFEQ '0'
     C*
     C           ACTN      IFEQ 'I'
     C                     ADD  1         SINS
     C                     ADD  1         NORE
     C                     END
     C*
     C           ACTN      IFEQ 'A'
     C                     ADD  1         SAMD
     C                     END
     C*
     C           ACTN      IFEQ 'D'
     C                     ADD  1         SDEL
     C                     SUB  1         NORE
     C                     END
     C*
     C** FORMAT COMIT TEXT
     C*
     C                     TIME           MTIME
     C                     MOVELACTN      ACTNX
     C                     MOVEASCRCTL    DET,01
     C                     MOVEADETS      DET,09
     C*
     C** UPDATE AUDIT RECORD
     C                     UPDATINVTPAF
     C*
     C** C  O  M  I  T
     C*
     C           CMTTXT    COMIT
     C*
     C                     ELSE
     C           *LOCK     IN   LDA                                       S01117
     C****************     MOVEL'02'      DBASE                           S01117
     C                     Z-ADD2         DBASE            ***************S01117
     C                     MOVEL'INVTP'   DBFILE           * DB ERROR 02 *
     C                     MOVEL'AUDIT'   DBKEY            ***************
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
AW   C****************     SETON                     U8                   S01117
     C                     END
     C*
     C                     ENDSR
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRVGPC - Validates the Global Product Code.                  *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRVGPC    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE *BLANKS   WERR    4                                           CGP001
      *                                                                                       CGP001
      ** Product Code must be entered.                                                        CGP001
      *                                                                                       CGP001
     C********** #1PRDC    IFEQ *BLANKS                                               CGP001 BUG6307
     C**********           MOVE '260'     WERR                                        CGP001 BUG6307
     C**********           ELSE                                                       CGP001 BUG6307
      *                                                                                      BUG6307
     C           #1PRDC    IFNE *BLANKS                                                      BUG6307
      *                                                                                       CGP001
     C                     CALL 'AOGPRDR0'                                                    CGP001
     C                     PARM *BLANKS   PRTCD                                               CGP001
     C                     PARM '*KEY   ' POPTN                                               CGP001
     C                     PARM #1PRDC    PGPRD  10                                           CGP001
     C           GPPROD    PARM GPPROD    DSFDY                                               CGP001
      *                                                                                       CGP001
     C           PRTCD     IFEQ *BLANKS                                                       CGP001
      *                                                                                       CGP001
     C           '?'       SCAN #1PRDC    WIDX    20                                          CGP001
     C           WIDX      IFNE *ZERO                                                         CGP001
     C                     MOVE *BLANKS   AID                                                 CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE PGPRD     #1PRDC                                              CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C                     SELEC                                                              CGP001
     C           PRTCD     WHEQ '*NOSEL '                                                     CGP001
     C                     MOVE '260'     WERR                                                CGP001
      *                                                                                       CGP001
      ** Invalid Product Code.                                                                CGP001
      *                                                                                       CGP001
     C           PRTCD     WHEQ '*NRF   '                                                     CGP001
     C                     MOVE '261'     WERR                                                CGP001
     C                     OTHER                                                              CGP001
     C           *LOCK     IN   LDA                                                           CGP001
     C                     MOVEL'GPPRODPD'DBFILE                                              CGP001
     C                     MOVELPGPRD     DBKEY                                               CGP001
     C                     Z-ADD6         DBASE                                               CGP001
     C                     OUT  LDA                                                           CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDSL                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C           WERR      IFNE *BLANKS                                                       CGP001
     C                     ADD  1         EC                                                  CGP001
     C                     MOVE WERR      ERR,EC                                              CGP001
     C                     MOVE *ON       *IN47                                               CGP001
      *                                                                                       CGP001
     C           *IN30     IFEQ *OFF                                                          CGP001
     C                     Z-ADD10        LNNBRD                                              CGP001
     C                     Z-ADD71        PSNBRD                                              CGP001
     C                     MOVE *ON       *IN30                                               CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRVGIC - Validates the Global Instrument Code.               *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRVGIC    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE *BLANKS   WERR                                                CGP001
      *                                                                                       CGP001
      ** Instrument Code must be entered.                                                     CGP001
      *                                                                                       CGP001
     C********** #1INSC    IFEQ *BLANKS                                               CGP001 BUG6307
     C**********           MOVE '262'     WERR                                        CGP001 BUG6307
     C**********           ELSE                                                       CGP001 BUG6307
      *                                                                                      BUG6307
     C           #1INSC    IFNE *BLANKS                                                      BUG6307
      *                                                                                       CGP001
     C                     CALL 'AOGINSR0'                                                    CGP001
     C                     PARM *BLANKS   PRTCD                                               CGP001
     C                     PARM '*KEY   ' POPTN                                               CGP001
     C                     PARM #1INSC    PGINS  10                                           CGP001
     C           GPINST    PARM GPINST    DSFDY                                               CGP001
      *                                                                                       CGP001
     C           PRTCD     IFEQ *BLANKS                                                       CGP001
      *                                                                                       CGP001
     C           '?'       SCAN #1INSC    WIDX    20                                          CGP001
     C           WIDX      IFNE *ZERO                                                         CGP001
     C                     MOVE *BLANKS   AID                                                 CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE PGINS     #1INSC                                              CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C                     SELEC                                                              CGP001
     C           PRTCD     WHEQ '*NOSEL '                                                     CGP001
     C                     MOVE '262'     WERR                                                CGP001
      *                                                                                       CGP001
      ** Invalid Instrument Code.                                                             CGP001
      *                                                                                       CGP001
     C           PRTCD     WHEQ '*NRF   '                                                     CGP001
     C                     MOVE '263'     WERR                                                CGP001
     C                     OTHER                                                              CGP001
     C           *LOCK     IN   LDA                                                           CGP001
     C                     MOVEL'GPINSTPD'DBFILE                                              CGP001
     C                     MOVELPGINS     DBKEY                                               CGP001
     C                     Z-ADD7         DBASE                                               CGP001
     C                     OUT  LDA                                                           CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDSL                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C           WERR      IFNE *BLANKS                                                       CGP001
     C                     ADD  1         EC                                                  CGP001
     C                     MOVE WERR      ERR,EC                                              CGP001
     C                     MOVE *ON       *IN48                                               CGP001
      *                                                                                       CGP001
     C           *IN30     IFEQ *OFF                                                          CGP001
     C                     Z-ADD11        LNNBRD                                              CGP001
     C                     Z-ADD71        PSNBRD                                              CGP001
     C                     MOVE *ON       *IN30                                               CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPPI - Gets the Global Product and Instrument Codes.       *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPPI    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE *BLANKS   #1PRDC                                              CGP001
     C                     MOVE *BLANKS   #1INSC                                              CGP001
      *                                                                                       CGP001
     C                     MOVE WZONE     KZONE                                               CGP001
     C                     MOVE 'SE'      KMOD                                                CGP001
     C*********************MOVELSINVT     KTRTP                                        CGP001 BG1350
     C*********************MOVELSCCYI     KTRST                                        CGP001 BG1350
     C                     MOVELXINVT     KTRTP                                               BG1350
     C                     MOVELXCCYI     KTRST                                               BG1350
      *                                                                                       CGP001
     C           KGPXR     CHAINGPPRDXL0            N86                                       CGP001
      *                                                                                       CGP001
     C           *IN86     IFEQ *OFF                                                          CGP001
     C                     MOVE PDGPRD    #1PRDC                                              CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPINSXL0            N86                                       CGP001
      *                                                                                       CGP001
     C           *IN86     IFEQ *OFF                                                          CGP001
     C                     MOVE INGINS    #1INSC                                              CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPXU - Writes and updates records on the Global            *                       CGP001
      *           Processing Cross-Reference Files.                   *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPXU    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE WZONE     KZONE                                               CGP001
     C                     MOVE 'SE'      KMOD                                                CGP001
     C                     MOVELSINVT     KTRTP                                               CGP001
     C                     MOVELSCCYI     KTRST                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPPRDXL0             43                                       CGP001
      *                                                                                       CGP001
     C           *IN43     IFEQ *ON                                                           CGP001
     C                     MOVE KZONE     PDZONE                                              CGP001
     C                     MOVE KMOD      PDMOD                                               CGP001
     C                     MOVE KTRTP     PDTRTP                                              CGP001
     C                     MOVE KTRST     PDTRST                                              CGP001
     C                     MOVE #1PRDC    PDGPRD                                              CGP001
     C                     WRITEGPPRDXD0                                                      CGP001
     C                     ELSE                                                               CGP001
     C                     MOVE #1PRDC    PDGPRD                                              CGP001
     C                     UPDATGPPRDXD0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPINSXL0             43                                       CGP001
      *                                                                                       CGP001
     C           *IN43     IFEQ *ON                                                           CGP001
     C                     MOVE KZONE     INZONE                                              CGP001
     C                     MOVE KMOD      INMOD                                               CGP001
     C                     MOVE KTRTP     INTRTP                                              CGP001
     C                     MOVE KTRST     INTRST                                              CGP001
     C                     MOVE #1INSC    INGINS                                              CGP001
     C                     WRITEGPINSXD0                                                      CGP001
     C                     ELSE                                                               CGP001
     C                     MOVE #1INSC    INGINS                                              CGP001
     C                     UPDATGPINSXD0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPXD - Deletes records on the Global Processing Cross-     *                       CGP001
      *           Reference Files.                                    *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPXD    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE WZONE     KZONE                                               CGP001
     C                     MOVE 'SE'      KMOD                                                CGP001
     C                     MOVELSINVT     KTRTP                                               CGP001
     C                     MOVELSCCYI     KTRST                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPPRDXL0             43                                       CGP001
      *                                                                                       CGP001
     C           *IN43     IFEQ *OFF                                                          CGP001
     C                     DELETGPPRDXD0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPINSXL0             43                                       CGP001
      *                                                                                       CGP001
     C           *IN43     IFEQ *OFF                                                          CGP001
     C                     DELETGPINSXD0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPGZ - Gets the Zone via GOGETZONE.                        *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPGZ    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     CALL GOPGM                                                         CGP001
     C                     PARM *BLANKS   PZRTCD  7                                           CGP001
     C                     PARM *BLANKS   PZERMS 50                                           CGP001
     C                     PARM 'N'       PZFCHK  1                                           CGP001
     C                     PARM *BLANKS   PZZONE 10                                           CGP001
     C                     PARM *BLANKS   PZSHTC  4                                           CGP001
     C                     PARM *ZERO     PZRDNB  50                                          CGP001
     C                     PARM *ZERO     PZDNWD  50                                          CGP001
     C                     PARM *BLANKS   PZBCCY  3                                           CGP001
     C                     PARM *ZERO     PZNJOB  10                                          CGP001
      *                                                                                       CGP001
     C           PZRTCD    IFEQ *BLANKS                                                       CGP001
     C                     MOVE PZZONE    WZONE  10                                           CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PZRTCD    IFEQ '*ERROR'                                                      CGP001
     C                     MOVELGOMSG     PZERMS                                              CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* INFSR - FILE EXCEPTION/ERROR HANDLING SUBROUTINE              *
     C*                                                               *
     C*****************************************************************
     C*
     C           INFSR     BEGSR
     C*
     C**   CHECK ERROR TYPE
     C*
     C                     MOVEL'0'       *IN88                                               255460
     C           STATUS    IFEQ 01021
     C*
     C**   CHAIN TO FILE TO GET CURRENT DETAILS
     C*
     C           INVTPK    CHAININVTPDF              99
     C*
     C           *IN,99    IFEQ '0'
     C*
     C**   ROLL BACK UPDATES ALREADY DONE
     C*
     C                     ROLBK
     C*
     C**   RECORD ALREADY EXISTS
     C*
     C           RECI      IFEQ 'D'
     C                     MOVEL'A'       ACTN
     C                     ELSE
     C                     MOVEL'E'       ACTN
     C                     END
     C                     MOVEA'001'     *IN,10
     C                     MOVELINF,11    INFMSG
     C                     MOVEL'1'       *IN88                                               255460
     C*
     C                     MOVEL'*DETC'   EXTTAG  6
     C*
     C                     ELSE
     C*
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C*
     C                     ELSE
     C*
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C*
     C                     ENDSREXTTAG
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *   S01117
     C* *PSSR - SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS        *   S01117
     C*                                                               *   S01117
     C* CALLED FROM : AFTER ABNORMAL OPERATION OCCURS                 *   S01117
     C*                                                               *   S01117
     C* CALLS : NOTHING                                               *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
      /EJECT
     C/COPY ZSRSRC,ZALIGNZ2
      /EJECT
     C*/COPY* ZSRSRC,ZSYSTMZ1***                                          S01117
      *EJECT********************                                          S01117
     C/COPY ZSRSRC,ZTNLU1Z2
      /EJECT
     C/COPY ZSRSRC,ZEDITZ2                                                S01496
      /EJECT                                                              S01496
      ***
      * /104633/
      *INF,6  DELETION F3:F10 to delete this record:F12:Rollup:Rolldown:Help
      *INF,9  F10 is required
      *INF,10 F10 is not required
     C/COPY WNCPYSRC,SE0020C008
** WINDOW PROCESSING ERROR MESSAGES                                       CSE037
WINDOW ERROR
WN DATABASE ERROR
**  CPY@
(c) Finastra International Limited 2001
** INF
 Enter:Action Code I,A,D,E and selection:Review from point:F3:Help
 Enter:Review from point:Action Code A,D,E:F3:F12:Rollup:Rolldown:Help
 INSERTION Enter:F3:F12:Help
 AMENDMENT Enter:F3:F12:Rollup:Rolldown:Help
 ENQUIRY Enter:F3:F12:Rollup:Rolldown:Help
 DELETION F3:F10=Delete record:F12:Rollup:Rolldown:Help
 Rollup is not possible
 Rolldown is not possible
 F10=Confirm
 
 Record has been updated by another workstation
 Delete not allowed - live securities exist for this investment type
** TYDBS    - VALID YIELD BASIS CODES  - S01232 - Australian yield
A C J R S U W Y DADMDYAU
     X/COPY WNCPYSRC,SE0020X001
