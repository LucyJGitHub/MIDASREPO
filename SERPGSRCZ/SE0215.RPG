000100200610     H        1
000200200610     F*****************************************************************
000300200610/*STD *  RPGBASE                                                      *
000400200610/*EXI *  TEXT('Midas SE Customer portfolio valuation enquiry')        *
000500200610     F*****************************************************************
000600200610     F*                                                               *
000700200610     F*  Midas - Securities Trading Module                            *
000800200610     F*                                                               *
000900200610     F*  SE0215 - CUSTOMER PORTFOLIO VALUATION ENQUIRY                *
001000200610     F*                                                               *
001100200610     F*  Function:  This program displays the current Position for    *
001200200610     F*   (I/C)     each Security for the requested Client on a Trade *
001300200610     F*             or Value date basis, decided by the bank on ICD.  *
001400200610     F*             Both the Book Price and the Current Market Price  *
001500200610     F*             are shown, with the Book and Market Value in the  *
001600200610     F*             Security Currency and the Portfolio Currency of   *
001700200610     F*             the Customer. In a Multi-branch environment, the  *
001800200610     F*             User may also enter a Branch.                     *
001900200610     F*             Each option available from this enquiry is held   *
002000200610     F*             as a record on PF/SECOND - Linked Enquiry Control *
002100200610     F*             file with fields: Calling Program, Option         *
002200200610     F*             Selected, Called Program.                         *
002300200610     F*                                                               *
002400200610     F*  Calls:     F6 may be taken to call SE0270 - Customer         *
002500200610     F*             Shortname Enquiry.                                *
002600200610     F*             Options may be taken against a Security to call:  *
002700200610     F*             1) SE0245 - Security Details Enquiry              *
002800200610     F*             2) SE0220 - Customer Portfolio Movements Enquiry  *
002900200610     F*             3) SE0205 - Client Holdings Enquiry.              *
003000200610     F*             4) SE7572 - Corporate Action - Retrieve General   *   CSE007
003100200610     F*                         Block Security Indicators.            *   CSE007
003200200610     F*             5) SE7574 - Corporate Action - Retrieve General   *   CSE007
003300200610     F*                         Block Customer Indicators.            *   CSE007
003400200610     F*             6) SE7576 - Corporate Action - Retrieve Specific  *   CSE007
003500200610     F*                         Block Indicators.                     *   CSE007
003600200610     F*                                                               *
003700200610     F*  Called By: SEC04 - CL Component to Control SE Enquiries      *
003800200610     F*                                                               *
003900200610      *  (c) Finastra International Limited 2001                      *
004000200610      *                                                               *
004100200610      *  Last Amend No. 248698             Date 01Jun20               *
004200200610      *  Prev Amend No. 261507             Date 22May20               *
004300200610      *                 MD046248           Date 27Oct17               *
004400200610      *                 226449             Date 24Jun15               *
004500200610      *                 MD034776           Date 08Jul15               *
004600200610      *                 AR1067108          Date 11Dec12               *
004700200610      *                 AR1001183A         Date 20Nov12               *
004800200610      * Bank Fusion Midas 1.4 Base -----------------------------------*
004900200610      * Midas Plus 1.4 Base 04 ---------------------------------------*
005000200610      * Midas Plus 1.4 Base ------------------------------------------*
005100200610      * Midas Plus 1.3 ----------- Base ------------------------------*
005200200610      *                 234300             Date 29Sep06               *
005300200610      *                 BUG11745           Date 21Jul06               *
005400200610      *                 CSD031             Date 10Apr06               *
005500200610      *                 CSD027A            Date 11May06               *
005600200610      *                 CSD027             Date 09Dec05               *
005700200610      *                 233736             Date 26Sep05               *
005800200610      *                 CSE071             Date 19Jul05               *
005900200610      *                 229857             Date 07Oct04               *
006000200610      *                 227267             Date 10Jun04               *
006100200610      *                 226570             Date 27Jun04               *
006200200610      *                 CSW037A            Date 02May05               *
006300200610      *                 CSD025             Date 11Jan05               *
006400200610      *                 CSW037             Date 15Dec04               *
006500200610      *                 CSW036             Date 15Dec04               *
006600200610      *                 BUG3122            Date 17Jul04               *
006700200610      *                 CGL014             Date 20Oct03               *
006800200610      *                 CLE025             Date 20Oct03               *
006900200610      *                 CGL029             Date 01Sep03               *
007000200610      *                 208241             Date 21Aug02               *
007100200610      *                 207543             Date 17Jul02               *
007200200610      *                 194370             Date 12Jul01               *
007300200610      *                 180056             Date 18Oct00               *
007400200610      *                 CSE035             Date 22Apr02               *
007500200610      *                 206316             Date 19Jul02               *
007600200610      * Midas Release 4.01 -------------------------------------------*
007700200610      *                 CPK015             Date 17Jun01               *
007800200610      *                 CSE031             Date 06Dec01               *
007900200610      *                 180707             Date 25Jul00               *
008000200610      *                 159599             Date 27Sep01               *
008100200610      * Midas Release 4 --------------- Base -------------------------*
008200200610      *                 177982             Date 21Jun01               *
008300200610      *                 162056             Date 30Apr01               *
008400200610      *                 127566             Date 09May01               *
008500200610      * Midas DBA 3.03 -----------------------------------------------*
008600200610      *                 140272             Date 20Apr00               *
008700200610      * Midas DBA 3.02 -----------------------------------------------*
008800200610      *                 CGL011             Date 20Sep99               *
008900200610      * Midas DBA 3.00 ---------------- Base -------------------------*
009000200610     F*                 130862             Date 18Oct98               *
009100200610      *                 151945             Date 06Jan99               *
009200200610     F*                 111490             DATE 29Apr98               *
009300200610     F*                 CEU017             Date 03Avr98               *
009400200610     F*                 CSE007             Date 09Jan98               *
009500200610     F*                 099435             DATE 16FEB98               *
009600200610     F*                 CSE005             DATE 04FEB97               *
009700200610     F*                 103446             DATE 13JAN96               *
009800200610     F*                 084704             DATE 01AUG96               *
009900200610     F*                 083039             DATE 01AUG96               *
010000200610     F*                 059110             DATE 25JUL96               *
010100200610     F*                 089937             DATE 03JUL96               *
010200200610     F*                 088047             DATE 26JUN96               *
010300200610     F*                 100228             DATE 30MAY96               *
010400200610     F*                 067645             DATE 30APR96               *
010500200610     F*                 099886             DATE 17APR96               *
010600200610     F*                 100017             DATE 17APR96               *
010700200610     F*                 092199             DATE 24OCT95               *
010800200610     F*                 090500             DATE 24OCT95               *
010900200610     F*                 090314             DATE 24OCT95               *
011000200610     F*                 073603             DATE 24OCT95               *
011100200610     F*                 088776             DATE 24OCT95               *
011200200610     F*                 092961             DATE 04OCT95               *
011300200610     F*                 091254             DATE 20OCT95               *
011400200610     F*                 088303             DATE 21JUN95               *
011500200610     F*                 086491             DATE 15JUN95               *
011600200610     F*                 S01496  JSV        DATE 07OCT94               *
011700200610     F*                 064575             DATE 15AUG94               *
011800200610     F*                 S01408             DATE 19MAY94               *
011900200610     F*                 065301             DATE 05MAY94               *
012000200610     F*                 052254             DATE 07JAN94               *
012100200610     F*                 S01401             DATE 16JUN93               *
012200200610     F*                 E39495             DATE 17FEB93               *
012300200610     F*                 E47922             DATE  1FEB93               *
012400200610     F*                 S01397             DATE 10SEP92               *
012500200610     F*                 E38091             DATE 28APR92               *
012600200610     F*                 E38110             DATE 28APR92               *
012700200610     F*                 E38908             DATE 28APR92               *
012800200610     F*                 E38094             DATE 28APR92               *
012900200610     F*                 E37290             DATE 22APR92               *
013000200610     F*                 E36865             DATE 16MAR92               *
013100200610     F*                 E35920             DATE 13FEB92               *
013200200610     F*                 E34849             DATE 29JAN92               *
013300200610     F*                 E31795             DATE 28NOV91               *
013400200610     F*                 E31789             DATE 28NOV91               *
013500200610     F*                 E31776             DATE 27NOV91               *
013600200610     F*                 E27934             DATE 22OCT91               *
013700200610     F*                 E26473             DATE 05SEP91               *
013800200610     F*                 E27092             DATE 04SEP91               *
013900200610     F*                 S01117             DATE 28FEB91               *
014000200610     F*                 S01195             DATE 28FEB91               *
014100200610     F*                 S01220             DATE 28FEB91               *
014200200610     F*                 E23955             DATE 24OCT90               *
014300200610     F*                 S01269             DATE 18JUL90               *
014400200610     F*                 S01271             DATE 19JUN90               *
014500200610     F*                 E21668             DATE 01MAY90               *
014600200610     F*                 E21616             DATE 03APR90               *
014700200610     F*                 E20651             DATE 10JAN90               *
014800200610     F*                 S01232             DATE 30NOV89               *
014900200610     F*                 E20380             DATE 29NOV89               *
015000200610     F*                 E20158             DATE 15NOV89               *
015100200610     F*                 E19838             DATE 25OCT89               *
015200200610     F*                 S01199             DATE 03AUG89               *
015300200610     F*                 E16894             DATE 22/06/89              *
015400200610     F*                 E16772             DATE 19/06/89              *
015500200610     F*                 E15851             DATE 26/05/89              *
015600200610     F*                 E15850             DATE 26/05/89              *
015700200610     F*                 E15694             DATE 28/03/89              *
015800200610     F*                 E17130             DATE 22/02/89              *
015900200610     F*                 S01179             DATE 21/10/88              *
016000200610     F*                 S01176             DATE 20/10/88              *
016100200610     F*                 S01186             DATE 15/09/88              *
016200200610     F*                 E13571             DATE 31/07/88              *
016300200610     F*                 E14057             DATE 01/07/88              *
016400200610     F*                 S01158             DATE 12/05/88              *
016500200610     F*                 S01155             DATE 28/04/88              *
016600200610     F*                                                               *
016700200610     F*---------------------------------------------------------------*
016800200610      *                                                               *
016900200610      *  248698 - Rounding discrepancies on some SE reports. Applied  *
017000200610      *           fix 228682.                                         *
017100200610      *  228682 - Recompiled due to ZCNSDZ1 changes. Applied 176594.  *
017200200610      *  261507 - Truncation of Average Price in display screen.      *
017300200610      *           Introduced new field BKPRR with length 23 with 8    *
017400200610      *           decimal places to be used as a result field when    *
017500200610      *           computing the average price to avoid truncation of  *
017600200610      *           the value.                                          *
017700200610      *  MD046248 - Finastra Rebranding                               *
017800200610      *  226449 - Recompiled over changes made in /COPY ZDYYRZ3.      *
017900200610      *         - Applied for MD034387.                               *
018000200610      *  MD034776 - Reverse AR1001183A to allow negative interest     *
018100200610      *             rate. (Recompile)                                 *
018200200610      *  AR1067108 - PMC1140 Component failed during Clean COB        *
018300200610      *              Applied fix AR1001183A                           *
018400200610      *  AR1001183A - Coupon rate was still used in computation of    *
018500200610      *              interest instead of using the details in FRN tab *
018600200610      *              (Reopen) (Recompile)                             *
018700200610      *  234300 - Recompiled over changed in PF/HSTTRD.               *
018800200610      *  BUG11745 - Customer defaults to 000000                       *
018900200610      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
019000200610      *  CSD027A - Conversion Of Customer Number to Alpha             *
019100200610      *  CSD027 - Conversion Of Customer Number to Alpha              *
019200200610      *  233736 - Included display of the average fiscal price for    *
019300200610      *           securities which are subject to EU tax. Used module *
019400200610      *           SEETCPRTV to get the average fiscal price of the    *
019500200610      *           latest position and had this called when reading    *
019600200610      *           CDEPF, in place of CDEPP, to get the average of all *
019700200610      *           portfolios.  Also applied core fix 159599 to ensure *
019800200610      *           that all client holdings are being displayed.       *
019900200610      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
020000200610      *  229857 - Recompiled due to change in ZYLDZ2.                 *
020100200610      *  227267 - POSITION BLOCKED ALTHOUGH NO BLOCK FOR ALLOCATION   *
020200200610      *  226570 - Recompiled due to change in ZYLDZ2.                 *
020300200610      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
020400200610      *  CSD025 - Customer De-Activation                              *
020500200610      *  CSW037 - Additional Field Data on MT300/MT320                *
020600200610      *  CSW036 - Dual SWIFT BIC held on Client Details               *
020700200610      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
020800200610      *  CGL014 - Collaterals Processing                              *
020900200610      *  CLE025 - Credit Lines (Recompile)                            *
021000200610      *  CGL029 - Increase Account Code to 10 digits                  *
021100200610      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
021200200610      *  207543 - CEU018 not working on a price basis.                *
021300200610      *           Recompiled over changed ZYLDZ2.                     *
021400200610      *  194370 - Recompile after change on copy sources ZYLDZ2,      *
021500200610      *           For securities with divisor basis = '5' and first   *
021600200610      *           coupon date > valuation date (rundate + 1), set     *
021700200610      *           event control date to first coupon date before      *
021800200610      *           processing SR/ZDYYR. This is to ensure that the     *
021900200610      *           correct hypothetical last and next coupon dates are *
022000200610      *           used in deriving the price/yield rate.              *
022100200610      *  180056 - Recompiled over changed in ZDYYRZ3.                 *
022200200610      *  CSE035 - NX/NNX Coupon Payment Processing.                   *
022300200610      *           Recompile over changed ZACCRZ1/ZYLDZ2/ZYCEZ1
022400200610      *  206316 - Recompiled over changed ZLCDZ1.                     *
022500200610      *  CPK015 - Conversion of ZYIELD from PLI to RPG.               *
022600200610      *           Recompile over changed ZYLDZ2.                      *
022700200610      *  CSE031 - Coupon Fixing for Floating Rate Notes.              *
022800200610      *           (recompilation due to change to ZNCD/ZLCD/ZACCR)    *
022900200610      *  180707 - No Position Settlements generated. Recompile over   *
023000200610      *           changes in /COPY ZNCDZ3.                            *
023100200610      *  159599 - Some client holdings are not apprearing in Customer *
023200200610      *           Portforlio Valuation Enquiry.                       *
023300200610      *  177982 - Average price problem when previous position and    *
023400200610      *           actual position are long but has been short         *
023500200610      *           i.e. : long 400 sales 1000 purchases 800            *
023600200610      *           same for short positions. Complete E34849.          *
023700200610      *  162056 - Nominal amount truncated in Customer Portfolio      *
023800200610      *           Valuation Enquiry.  Fix is to increase field size of*
023900200610      *           SNOML from 12 to 14.                                *
024000200610      *  127566 - Recompiled over changed ZSDESCZ3                    *
024100200610     F*  140272 - Recompile over changed ZYLDZ2                       *
024200200610      *  CGL011 - Collateral Processing for Midas DBA                 *
024300200610     F*  130862 - Recompiled over ZLCDZ1 & ZDAYSZ2 changes.           *
024400200610     F*  151945 - Recompiled Over changed ZDYYRZ3 .                   *
024500200610     F*  111490 - Incorporation of 49112 and 56317 because 090500     *
024600200610     F*           wrong. Used *IN85 instead of *IN83 already booked   *
024700200610     F*           S01496.                                             *
024800200610     F*  CEU017 - Securities Redenomination Euro Changes              *
024900200610     F*  CSE007 - Corporate Actions                                   *
025000200610     F*  CSE005 - Effect of holidays on FRN Coupon Dates              *
025100200610     F*           (recompilation due to change to ZNCD/ZLCD/ZACCR).   *
025200200610     F*  099435 - At roll-up, nominal of the first record at the      *
025300200610     F*           first page of the subfile is changed to 0.  This is *
025400200610     F*           caused by fix 088303.  Move 'N' to field TROLL      *
025500200610     F*           before accumulating details for screen display.     *
025600200610     F*  103446 - S01496 Not incorporated in the correct place in     *
025700200610     F*           subroutine FIRST                                    *
025800200610     F*  084704 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
025900200610     F*  083039 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
026000200610     F*  059110 - Recompiled over changed ZYLDZ2 sub.                 *
026100200610     F*  089937 - Make options 1 and 2 work even when customer is     *
026200200610     F*           entered as long as customer is not changed          *
026300200610     F*  088047 - RECOMPILE over change SR/ZYLDZ2.                    *
026400200610     F*  100228 - RECOMPILE OVER CHANGED ZDYYRZ3, ZLCDZ1 & ZNCDZ3.    *
026500200610     F*  067645 - Future valued trade not shown if this is the only   *
026600200610     F*           trade for this customer.                            *
026700200610     F*  099886 - Rounding problem for partly paid securities.        *
026800200610     F*           Recompile over amended standard subroutine ZACCZ.   *
026900200610     F*  100017 - Position settlement unable to pick up day adj. on   *
027000200610     F*           SECTYD. Change subroutine to use DADJN to stop      *
027100200610     F*           interest day adjustment being used for amortisation.*
027200200610     F*           Recompile over amended subroutine ZDAYS.            *
027300200610     F*  092199 - The last security and the totals were not displayed *
027400200610     F*           in some cases; remove 2 lines from fix 088303.      *
027500200610     F*  090500 - Wrong Market Price shown on screen.  Program is     *
027600200610     F*           retrieving the earliest price rather than the       *
027700200610     F*           latest price change.                                *
027800200610     F*  090314 - Branch should be defaulted to the branch of the     *
027900200610     F*           customer and not of the user.                       *
028000200610     F*  073603 - Security positions of 0 should not appear on        *
028100200610     F*           valuation enquiry.                                  *
028200200610     F*  088776 - Always show customer and branch entered/defaulted   *
028300200610     F*           rather than having to re-enter them when this enq.  *
028400200610     F*           is accessed via EM.                                 *
028500200610     F*  092961 - Recompile over ZDAYSZ2 which was amended by 086491  *
028600200610     F*           (Wrong number of days calculated for day basis 1    *
028700200610     F*           when start or end day is last day of February)      *
028800200610     F*  091254 - RECOMPILE OVER CHANGED ZLCDZ1 & ZNCDZ3              *
028900200610     F*  088303 - Nominal position shown as double the amount as it   *
029000200610     F*           should be.  Wrong subfile management.  Do not       *
029100200610     F*           read the last record twice.                         *
029200200610     F*  086491 - Wrong nbr of days calculated for day basis 1        *
029300200610     F*           when start or end day is last day of February       *
029400200610     F*           Recompiled for ZSRSRC/ZDAYSZ2 changes.              *
029500200610     F*  S01496 - Incorporation of JYSKE Enhancements (S10978)        *
029600200610     F*  064575 - Recompiled over amended ZYLDZ2 subroutine.          *
029700200610     F*  S01408 - Core hook SE0215CPSR added                          *
029800200610     F*  065301 - Recompiled over changed copy source ZACCR subr.     *
029900200610     F*           with ZAMT increased to 15,0.                        *
030000200610     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
030100200610     F*           to 10,9                                             *
030200200610     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
030300200610     F*           - Recompiled due to changes to files.               *
030400200610     F*  E39495 - New /COPY subroutine ZCALCD added (called from      *
030500200610     F*           sr. ZYLD)                                           *
030600200610     F*         - /COPY subroutines ZACCZZ1 and ZCNSDZ1 added (called *
030700200610     F*           from sr. ZYLD and ZCALCD)                           *
030800200610     F*         - Recompiled over changed ZYLDZ2                      *
030900200610     F*  E47922 - Recompiled over changed SR/ZYLDZ2                   *
031000200610     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
031100200610     F*           - Recompiled due to changes to files and SR/ZYLD.   *
031200200610     F*  E38091 - Accrued interest line should appear for             *
031300200610     F*           Schuldscheins                                       *
031400200610     F*  E38110 - Accrued interest line should not appear for         *
031500200610     F*           discounted securities                               *
031600200610     F*  E38908 - Key fields from SNDEVD should be renamed to same    *
031700200610     F*           names as SEDEVD so that the correct date and event  *
031800200610     F*           types are used to decide if security event is       *
031900200610     F*           between the from and to dates                       *
032000200610     F*  E38094 - Accrued interest line should not appear for records *
032100200610     F*           with 0% coupon rate                                 *
032200200610     F*  E37290 - Rollup not working correctly when a record has been *
032300200610     F*           read and the details for the previous record output.*
032400200610     F*  E36865 - Accrued interest should use ex-coupon nominal from  *
032500200610     F*           CPOSN instead from CDEPP else it is incorrect when  *
032600200610     F*           a coupon date is passed.                            *
032700200610     F*  E35920 - E15694 not complete in renaming CDEPD fields        *
032800200610     F*  E34849 - Average price was not worked out properly           *
032900200610     F*  E31795 - If a rollup is required on a particular enquiry to  *
033000200610     F*           view all the details the the next complete set of   *
033100200610     F*           details will be zero as the information has not     *
033200200610     F*           been placed in the relevant fields.                 *
033300200610     F*  E31789 - For trades with no market price whose security's    *
033400200610     F*           trade basis is yield,a market value of 100 was      *
033500200610     F*           output instead of zero.                             *
033600200610     F*  E31776 - Interest accrued for Mortgage Backed is 2 d.p. out  *
033700200610     F*  E27934 - Recompiled over the changed version of ZACCRZ1      *
033800200610     F*  E26473 - When a customer is selected who is not defined as a *
033900200610     F*           Securities customer, there is a DB error.           *
034000200610     F*  E27092 - Recompiled over changed SR/ZLCD                     *
034100200610     F*  S01117 - Multibranching : Screen function changes            *
034200200610     F*                            Access Programs                    *
034300200610     F*  S01195 - Holiday Processing                                  *
034400200610     F*  S01220 - Recompiled for Strategic Risk Management            *
034500200610     F*  S01269 - Trade Authorisation - ignore unauthorised trades    *
034600200610     F*  S01271 - Recompiled for Pay/Receive in Input Cycle changes   *
034700200610     F*           to TRADSD and/or DPTMVD                             *
034800200610     F*  E21668 - Recompiled over changed SR/ZYLDZ2                   *
034900200610     F*  E21616 - Recompiled over changed SR/ZLCD.                    *
035000200610     F*  E20651 - DB Error Numbers used in more than one place.       *
035100200610     F*           New Error Numbers as follows:                       *
035200200610     F*           DB ERROR 07 -> 13.                                  *
035300200610     F*           DB ERROR 07 -> 14.                                  *
035400200610     F*           DB ERROR 07 -> 15.                                  *
035500200610     F*           DB ERROR 07 -> 16.                                  *
035600200610     F*  S01232 - Australian yield modifications.                     *
035700200610     F*  E20380 - Recompile for changed ZYLDZ1/2 and include ZLCDZ1.  *
035800200610     F*  E20158 - SFLEND not being conditioned properly, resulting    *
035900200610     F*           in '+' indicator when there are no more records.    *
036000200610     F*  E19838 - Rounding Error producing an incorrect Book Price    *
036100200610     F*           and Book Valuation.                                 *
036200200610     F*  S01199 - ABS Help System.                                    *
036300200610     F*  E16894 - Book Price should be in P/D/Y Format on screen.     *
036400200610     F*  E16772 - Recompiled for the Dividend Payment Amount field    *
036500200610     F*           changes.                                            *
036600200610     F*  E15851 - INCORRECT EDITING FOR ACCRUED INTEREST.             *
036700200610     F*           ALSO CHANGED REF F/1 TO F/3 ON SCREEN ERROR MSG.    *
036800200610     F*  E15850 - ERROR WITH NEW SECN (ZCUMCP NOT RESET TO ZERO).     *
036900200610     F*  E15694 - ERRORS IN THE BUILDING OF THE SUBFILE FOR           *
037000200610     F*           SCHULDSHEINS BECAUSE SOME FIELDS FROM FILE          *
037100200610     F*           CDEPP ARE OVERRIDDEN WITH SOME FROM FILE CDEPD.     *
037200200610     F*  E17130 - ERROR MESSAGE CHANGED FOR LINKED ENQUIRY OPTIONS.   *
037300200610     F*  S01179   ****** AS400 CONVERSION ******                      *
037400200610     F*    The keyword RTGAID is no longer supported on the AS400     *
037500200610     F*    and command keys and indicators have been used to replace  *
037600200610     F*    this in the display file. To disrupt the structure of the  *
037700200610     F*    program as little as possible a new subroutine - ASCHGS -  *
037800200610     F*    has been coded. This moves the values which would have     *
037900200610     F*    been passed to the program (via RTGAID) into the AID       *
038000200610     F*    field depending on which function key has been pressed.    *
038100200610     F*  S01176 - 3.1 (AUSTRALIA)                                     *
038200200610     F*  S01186 - ST 3.1 -  BOOK PRICE, BOOK VALUATION, MARKET        *
038300200610     F*           PRICE and MARKET VALUATION are being formatted/     *
038400200610     F*           calculated incorrectly (no need to used ZPRCO).     *
038500200610     F*  E13571 - AMENDED ERROR MESSAGE, AS NO HELP TEXT.             *
038600200610     F*  E14057 - USE PRICR NOT PRICS FILE.                           *
038700200610     F*  S01158 - POST INCORPORATION DEVELOPMENT FIXES.               *
038800200610     F*  S01155 - SE INCORPORATION ERROR FIX.                         *
038900200610     F*                                                               *
039000200610     F*****************************************************************
039100200610      *
039200200610     FSE0215DFCF  E                    WORKSTN      KINFDS SCRDS
039300200610     F                                        SFLRECKSFILE SE0215S0
039400200610      *                                                                                       233736
039500200610      ** Use new LF, which includes the portfolio reference                                   233736
039600200610      *                                                                                       233736
039700200610     F***CDEPP** IF  E           K        DISK                                                233736
039800200610     FCDEPF   IF  E           K        DISK                                                   233736
039900200610     FSECED   IF  E           K        DISK
040000200610     FSECEO   IF  E           K        DISK                               E39495
040100200610     F            SEDEVDF                           KRENAMESEDEVDO        E39495
040200200610     F            SNDEVDF                           KRENAMESNDEVDO        E39495
040300200610     FSECTY   IF  E           K        DISK
040400200610     FINVTP   IF  E           K        DISK
040500200610     F*CDEPD***IF**E***********K********DISK                              S01496
040600200610     FCDEPD   IF  E           K        DISK                           UC  S01496
040700200610     F            CDEPPDF                           KRENAMECDEPDDF
040800200610     F*********CDEPD1  IF  E           K        DISK                  UC  S01496
040900200610     FSECDEPL1IF  E           K        DISK                           UC  S01496
041000200610     F            CDEPPDF                           KRENAMECDEPDDF1       S01496
041100200610     FSEBLKPL6IF  E           K        DISK                               CGL011
041200200610      ** Manually Blocked Positions File                                  CGL011
041300200610      *                                                                   CGL011
041400200610     FSEBLKPL7IF  E           K        DISK                                                   CGL014
041500200610     F            SEBLKPD0                          KRENAMESEBLKPDF                           CGL014
041600200610     F***CLINT***IF  E           K        DISK                            S01117
041700200610     F*********** CLINTCAF                          KIGNORE               S01117
041800200610     F*********** CLINTCCF                          KIGNORE               S01117
041900200610     F*********** CLINTC1F                          KIGNORE               S01117
042000200610     F***SNAME***IF  E           K        DISK                            S01117
042100200610     F*********** CLINTCBF                          KRENAMESNAMECBF       S01117
042200200610     FCPOSN   IF  E           K        DISK
042300200610     F*RICS***IF**E           K        DISK                               E14057
042400200610     FPRICR   IF  E           K        DISK                               E14057
042500200610     FPRICT   IF  E           K        DISK
042600200610     F            PRICEDF                           KRENAMEPRICETDF
042700200610     FCPPRIC  IF  E           K        DISK                               S01176
042800200610     FTRDBV   IF  E           K        DISK
042900200610     F***NEXTC   IF  E           K        DISK
043000200610     F***TABSE***IF  E           K        DISK                            S01117
043100200610     F*********** TABLETAF                          KIGNORE               S01117
043200200610     F*           TABTB10F                          KIGNORE
043300200610     F*           TABTB11F                          KIGNORE
043400200610     F*           TABTB36F                          KIGNORE
043500200610     F*********** TABTB40F                          KIGNORE               S01117
043600200610     F*********** TABTE10F                          KIGNORE               S01117
043700200610     F*********** TABTE20F                          KIGNORE               S01117
043800200610     F*           TABTG10F                          KIGNORE
043900200610     F*********** TABTG20F                          KIGNORE               S01117
044000200610     F*********** TABLETHF                          KIGNORE               S01117
044100200610     F********    TABLETJF                          KIGNORE               S01232
044200200610     F*********** TABLETKF                          KIGNORE               S01117
044300200610     F*********** TABLETLF                          KIGNORE               S01117
044400200610     F*********** TABLETNF                          KIGNORE               S01117
044500200610     F*********** TABLETPF                          KIGNORE               S01117
044600200610     F*           TABLETRF                          KIGNORE
044700200610     F*********** TABLETXF                          KIGNORE               S01117
044800200610     F*********** TABLET2F                          KIGNORE               S01117
044900200610     F*********** TABLET3F                          KIGNORE               S01117
045000200610     F*********** TABLET5F                          KIGNORE               S01117
045100200610     FSECOND  IF  E           K        DISK
045200200610     F/COPY WNCPYSRC,SE0215F001
045300200610      /EJECT
045400200610     F*****************************************************************
045500200610     F*                                                               *
045600200610     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
045700200610     F*                                                               *
045800200610     F*  01       RETURN TO PREVIOUS PROGRAM                          *
045900200610     F*           OR ERROR ON SECTY READ                              *
046000200610     F*  02       CLEAR SUBFILE                                       *
046100200610     F*  03       NO DETAILS INDICATOR                                *
046200200610     F*  04       DISPLAY MESSAGE - NO DETAILS TO DISPLAY             *
046300200610     F*  05       DETAILS COMPLETE FOR THIS CUSTOMER                  *
046400200610     F*  06       ROLLUP PAST END OF FILE - DISPLAY MESSAGE           *
046500200610     F*  07       ON IN MULTI-BRANCH ENVIRONMENT                      *
046600200610     F*  08       CONTROL DISPLAY OF SELECT FIELD IN SFL              *
046700200610     F*                                                               *
046800200610     F*  10       VLDCMDKY INDICATOR FOR DISPLAY FILE                 *
046900200610     F*                                                               *
047000200610     F*  20       ROLLUP                                              *   S01179
047100200610     F*  21       HELP                                                *   S01179
047200200610     F*                                                               *   S01179
047300200610     F*  25       GENERAL FILE CHAIN USAGE                            *   S01117
047400200610     F*                                                               *   S01117
047500200610     F***29*******CUST*SHORTNAME*ENTERED*******************************   S01117
047600200610     F***30*******CUST*NO.*ENTERED*************************************   S01117
047700200610     F*                                                               *   S01117
047800200610     F***35*******CDEPP**RECORD*READ***********************************                       233736
047900200610     F*  35       CDEPF RECORD READ                                   *                       233736
048000200610     F*  40       END OF FILE ON SUBFILE READ                         *
048100200610     F*  41       REVERSE IMAGE CUST NO./SHORTNAME FIELD              *
048200200610     F*  42       DISPLAY ERROR MESSAGE                               *
048300200610     F*  44       REVERSE IMAGE BRANCH FIELD                          *   S01117
048400200610     F*  50       ON IF DETAILS ACCUMULATED FOR PREVIOUS SEC          *
048500200610     F*  51       MORE DETAILS TO OUTPUT FOR SECURITY                 *
048600200610     F*  52       SECURITY IS TRADED ON AN AUSTRALIAN YIELD BASIS     *   S01232
048700200610     F*  55       NOMINAL CURRENCY DEC. PLACES 0                      *
048800200610     F*  56       NOMINAL CURRENCY DEC. PLACES 1                      *
048900200610     F*  57       NOMINAL CURRENCY DEC. PLACES 2                      *
049000200610     F*  58       NOMINAL CURRENCY DEC. PLACES 3                      *
049100200610     F*  59       MORE TOTALS TO OUTPUT FOR CUSTOMER                  *
049200200610     F*  60       MORE TOTALS TO OUTPUT FOR CUSTOMER                  *
049300200610     F*  61       DISPLAY FIELDS FOR S01496                           *   S01496
049400200610     F*  62       Display fields for CSE007                           *   CSE007
049500200610      *  63       End of File on LF/SEBLKPL6                          *   CGL011
049600200610 ******  66       END OF FILE ON NEXTC                                *
049700200610     F***70*******BYPASS*RECORD*FROM*CDEPP*IF*OFF**********************                073603 233736
049800200610     F*  70       BYPASS RECORD FROM CDEPF IF OFF                     *                       233736
049900200610     F***81*******END*OF*FILE*ON*CDEPP*********************************                       233736
050000200610     F*  81       END OF FILE ON CDEPF                                *                       233736
050100200610     F*  82       NEXT PAGE REQUIRED (CONTROL SFLEND)                 *
050200200610     F***83*******END*OF*FILE*ON*CDEPP*********************************                S01496 233736
050300200610     F*  83       END OF FILE ON CDEPF                                *                       233736
050400200610     F*  88       SUBFILE READ FAIL                                   *
050500200610     F***89*******END*OF*FILE*ON*CDEPP*OR*END*OF*SUBFILE*PAGE**********                       233736
050600200610     F*  89       END OF FILE ON CDEPF OR END OF SUBFILE PAGE         *                       233736
050700200610     F*                                                               *
050800200610     F*  90       WORK INDICATOR - STD SUBROUTINES                    *
050900200610     F*  98       DATE FORMAT INDICATOR FOR ZSYSTM                    *
051000200610     F***99*******ERROR*ON*ICDR*1*READ*-*ZSYSTM*                      *   S01117
051100200610     F*                                                               *
051200200610     F*  U7       WITH U8 FOR DATABASE ERROR                          *
051300200610     F*  U8       WITH U7 FOR DATABASE ERROR                          *
051400200610     F*                                                               *
051500200610     F*****************************************************************
051600200610      /EJECT
051700200610     F*****************************************************************
051800200610     F*                                                               *
051900200610     F*  S U B R O U T I N E   I N D E X                              *
052000200610     F*                                                               *
052100200610     F*  P001    -  CHANGE SCREEN HEADINGS                            *   S01496
052200200610     F*  P002    -  CHANGE SCREEN DETAILS                             *   S01496
052300200610     F*  ASCHGS  -  MOVES VALUES INTO AID - AS400 CONVERSION          *   S01179
052400200610     F*  CHKSEL  -  CHECK FOR "?" SELECTION (KEY INPUT)               *   S01117
052500200610     F*  COMMD   -  PROCESS COMMAND KEYS, HELP AND ROLLUP/DOWN        *
052600200610     F*  OPTION  -  CHECK VALIDITY OF ENTERED OPTION COMBINATIONS     *
052700200610     F*  CUSTIN  -  PROCESS ENTERED CUSTOMER NO./SHORTNAME            *
052800200610     F*  SETUP   -  PREPARE OUTPUT SCREEN FOR DISPLAY                 *
052900200610     F*  CLEAR   -  CLEAR FIELDS AND INDICATORS ON DISPLAY SCREEN     *
053000200610     F*  ROLLUP  -  HANDLE ROLLUP WHEN END OF SUBFILE REACHED         *
053100200610     F*  DISP    -  ACCUMULATE SECURITY DETAILS FOR DISPLAY           *
053200200610     F*  PROCES  -  PROCESS A SECURITY                                *
053300200610     F*  SUBFIL  -  WRITE ACCUMULATED DETAILS TO SUBFILE              *
053400200610     F*  TOTAL   -  PROCESS CUSTOMER TOTALS                           *
053500200610     F*  TOTFIL  -  WRITE TOTAL DETAILS TO SUBFILE                    *
053600200610     F*  ADJUST  -  ADJUST FIELD TO REMOVE DEC PLACES                 *
053700200610     F*  CSPRC   -  CALCULATE BOOK PRICE                              *
053800200610     F*  OLCAP   -  CALCULATE AVERAGE PRICE                           *
053900200610     F*  ZACRCI  -  CALCULATE INTEREST ON A CUSTOMER POSITION IN I/C  *
054000200610     F*  LINK    -  PROCESS REQUEST FOR LOWER LEVEL ENQUIRY           *
054100200610     F*  RETSR   -  END OF PROGRAM PROCESSING                         *
054200200610     F*  FIRST   -  FIRST CYCLE PROCESSING                            *
054300200610     F*  *PSSR   -  ERROR HANDLING                                    *   S01117
054400200610     F*                                                               *
054500200610     F***XDATE***-**CALCULATE*WORKING*DAYS*BACKWARDS.*             *S01232S01195
054600200610     F*                                                               *   S01195
054700200610     F*  ZACCR   -  CALCULATE INTEREST ACCRUED BETWEEN TWO DATES      *
054800200610     F*  ZACCZ   -  Calculate accrued interest between two dates      *   E39495
054900200610     F*  ZALIGN  -  VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS           *
055000200610     F*  ZCALCD  -  Calculate long term CD price from input yield     *   E39495
055100200610     F*  ZCNSD   -  Calculate consideration                           *   E39495
055200200610     F*  ZCONV   -  CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER       *
055300200610     F*  ZDAYS   -  CALCULATE NO OF DAYS BETWEEN 2 DATES FOR          *
055400200610     F*               INTEREST CALCULATIONS                           *
055500200610     F*  ZDATE1  -  FORMAT DATE                                       *
055600200610     F*  ZDATE2  -  FORMAT DATE                                       *
055700200610     F*  ZDYYR   -  CALCULATE NO OF DAYS IN INTEREST YEAR             *
055800200610     F*  ZEVCD   -  CALCULATE EVENT CONTROL DATE                      *
055900200610     F*                                                               *   S01117
056000200610     F***ZICD2***-**ACCESS*ICDR2*-*TABTB11*                           *   S01117
056100200610     F***ZICDSE**-**ACCESS*ICDSE*-*TABTB36*                           *   S01117
056200200610     F*                                                               *   S01117
056300200610     F*  ZLCD    -  GET PREVIOUS COUPON DATE.                         *   E20380
056400200610     F*  ZNCD    -  DETERMINE NEXT COUPON DATE                        *
056500200610     F*  ZPRCI   -  OUTPUT PRICE AS % PRICE                           *   S01176
056600200610     F*  ZPRCO   -  OUTPUT YIELD AS PRICE                             *
056700200610     F*  ZRATE   -  CALCULATE EFFECTIVE RATE                          *
056800200610     F*  ZRSTOR  -  RESTORES INDICATORS 90 - 97                       *
056900200610     F*  ZSAVE   -  REMEMBER SETTING AND THEN SETOF INDICATORS 90 - 97*   S01158
057000200610     F*  ZSDESC  -  FORMAT SECURITY DESCRIPTION                       *
057100200610     F*  ZSEDIT  -  EDIT NUMERIC FIELDS FOR OUTPUT                    *
057200200610     F*                                                               *   S01117
057300200610     F***ZSYSTM**-**ACCESS*ICDR1*-*TABTB10*                           *   S01117
057400200610     F*                                                               *   S01117
057500200610     F*  ZXRATE  -  CALCULATE CROSS-EXCHANGE RATE                     *
057600200610     F*  ZYCE    -  SET CUM/EX PARAMETER FOR AUSTRALIAN YIELD CALCS.  *   S01232
057700200610     F*  ZYLDI   -  OUTPUT YIELD AS PERCENTAGE                        *   S01176
057800200610     F*  ZYLDO   -  OUTPUT PERCENTAGE PRICE AS YIELD                  *
057900200610     F*  ZYMTX   -  CALCULATE YIELD BASED ON DAYS TO MATURITY         *   S01176
058000200610     F*                                                               *
058100200610     F*****************************************************************
058200200610      /EJECT
058300200610     E/COPY ZSRSRC,ZDATE2Z1
058400200610     E/COPY ZSRSRC,ZNCDZ1
058500200610     E                    CPY@    1   1 80
058600200610     E***********         MSG     1   9 79               Error Messages   S01117
058700200610     E***********         MSG     1  10 79               Error MessaS01117E26473
058800200610     E                    MSG     1  11 79               Error Messages   E26473
058900200610     E/COPY ZSRSRC,ZPOWERZ1
059000200610     E/COPY ZSRSRC,ZDAYSZ1
059100200610     E/COPY ZSRSRC,ZPOWER8Z1
059200200610     E/COPY ZSRSRC,ZSDESCZ1
059300200610     E/COPY ZSRSRC,ZSEDITZ1
059400200610     E                    ZAD        21  1
059500200610     E/COPY ZSRSRC,ZALIGNZ1
059600200610     E/COPY ZSRSRC,ZYMTXZ1                                                S01176
059700200610     E***/COPY*ZSRSRC,ZDATE6Z1                                      S01232S01195
059800200610     E/COPY ZSRSRC,ZHOLE                                                  S01195
059900200610      /EJECT
060000200610     IHSTTRDF                                                             S01155
060100200610     I              RECI                            TRRECI                S01155
060200200610     ITRADSDF                                                             S01155
060300200610     I              RECI                            TRRECI                S01155
060400200610     ICDEPDDF                                                             E15694
060500200610     I              CDSN                            CDSN2                 E15694
060600200610     I***********   CDBR                            CDBR2           E15694S01117
060700200610     I              CDPA                            CDPA2                 S01117
060800200610     I              CDCN                            CDCN2                 E15694
060900200610     I              DDTE                            DDTE2                 E15694
061000200610     I              CDMK                            CDMK2                 E15694
061100200610     I              CDPT                            CDPT2                 E37290
061200200610     I              CDNV                            CDNV2                 E15694
061300200610     I              CNPV                            CNPV2                 E15694
061400200610     I              CNSV                            CNSV2                 E15694
061500200610     I              CECN                            CECN2                 E15694
061600200610     I              SPSV                            SPSV2                 E35920
061700200610     I              SAPV                            SAPV2                 E35920
061800200610     ICDEPDDF1                                                            S01496
061900200610     I              CDSN                            CDSN2                 S01496
062000200610     I              CDPA                            CDPA2                 S01496
062100200610     I              CDCN                            CDCN2                 S01496
062200200610     I              DDTE                            DDTE2                 S01496
062300200610     I              CDMK                            CDMK2                 S01496
062400200610     I              CDPT                            CDPT2                 S01496
062500200610     I              CDNV                            CDNV2                 S01496
062600200610     I              CNPV                            CNPV2                 S01496
062700200610     I              CNSV                            CNSV2                 S01496
062800200610     I              CECN                            CECN2                 S01496
062900200610     I              SPSV                            SPSV2                 S01496
063000200610     I              SAPV                            SAPV2                 S01496
063100200610     I              PTFR                            PTFR2                 S01496
063200200610     ISNDEVDF                                                             E38908
063300200610     I              SNSN                            SDSN                  E38908
063400200610     I              SNDT                            SDED                  E38908
063500200610     I              SNET                            SDET                  E38908
063600200610      *                                                                                       233736
063700200610      ** Rename fields                                                                        233736
063800200610      *                                                                                       233736
063900200610     IPRICEDF                                                                                 233736
064000200610     I              PTFR                            PPTFR1                                    233736
064100200610      *                                                                                       233736
064200200610     IPRICETDF                                                                                233736
064300200610     I              PTFR                            PPTFR2                                    233736
064400200610      *                                                                                       233736
064500200610     IETCPOS    E DSETCPOSND                                                                  233736
064600200610     I              RECI                            ETRECI                                    233736
064700200610     I              CSBA                            ETCSBA                                    233736
064800200610     I              CSSC                            ETCSSC                                    233736
064900200610     I              CSCN                            ETCSCN                                    233736
065000200610     I              PTFR                            ETPTFR                                    233736
065100200610     I              SAPD                            ETSAPD                                    233736
065200200610     I              APDT                            ETAPDT                                    233736
065300200610      *                                                                                       233736
065400200610      ** Data structure to hold the current key                                               233736
065500200610      *                                                                                       233736
065600200610     I            DS                                                                          233736
065700200610     I                                        1  23 KCPOS                                     233736
065800200610     I                                        1   3 SAVBR                                     233736
065900200610     I**********                              4   90PCUST2                            233736 CSD027A
066000200610     I                                        4   9 PCUST2                                   CSD027A
066100200610     I                                       10  19 CDSN                                      233736
066200200610     I                                       20  23 PTFR                                      233736
066300200610      *                                                                                       233736
066400200610      ** Data structure to hold previous values                                               233736
066500200610      *                                                                                       233736
066600200610     I            DS                                                                          233736
066700200610     I                                        1  23 PCPOS                                     233736
066800200610     I                                        1   3 WBRCH                                     233736
066900200610     I**********                              4   90WCUST                             233736 CSD027A
067000200610     I                                        4   9 WCUST                                    CSD027A
067100200610     I                                       10  19 WSECT                                     233736
067200200610     I                                       20  23 WPTFR                                     233736
067300200610     ICPYR@#      DS
067400200610     I*                                                                   E15694
067500200610     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
067600200610     I*                                                                   E15694
067700200610     I                                        1  80 CPY@
067800200610     I                                        1  20 CPY@##
067900200610      *
068000200610     I/COPY ZSRSRC,ZNCDZ2
068100200610     I/COPY ZSRSRC,ZSDESCZ2
068200200610     I*
068300200610     I***LDA*****   UDS                            256                    S01117
068400200610     I***********                                                         S01117
068500200610     I*******Local data area.                                             S01117
068600200610     I***********                                                         S01117
068700200610     I***********                           134 138 DBFILE                S01117
068800200610     I***********                           139 167 DBKEY                 S01117
068900200610     I***********                           168 175 DBPGM                 S01117
069000200610     I***********                           176 1770DBASE                 S01117
069100200610      *                                                                   S01117
069200200610     ILDA         DS                            256                       S01117
069300200610      *                                                                   S01117
069400200610      ** Local data area for database error details                       S01117
069500200610      ** *LOCK IN LDA immediately before and OUT LDA immediately          S01117
069600200610      ** after each database error handling.                              S01117
069700200610      *                                                                   S01117
069800200610     I                                      134 183 DBLOT                 S01117
069900200610     I                                      134 141 DBFILE                S01117
070000200610     I                                      142 170 DBKEY                 S01117
070100200610     I                                      171 180 DBPGM                 S01117
070200200610     I                                      181 1830DBASE                 S01117
070300200610     IJNSTAT     UDS                            200
070400200610     I*
070500200610     I*   JNSTAT DATA AREA
070600200610     I                                    P 103 1050PRUN
070700200610     I*
070800200610     I            DS
070900200610     I*
071000200610     I*   DATA STRUCTURES FOR SETTING UP SFL LINES
071100200610     I*
071200200610     I                                        1  74 POSL1
071300200610     I                                        1  41 SDESC
071400200610     I                                       44  46 SNMCY
071500200610     I                                       48  60 SBVAL
071600200610     I                                       48  59 SBVALA
071700200610     I                                       62  74 SMVAL
071800200610     I                                       62  73 SMVALA
071900200610     I                                       37  41 #BLOC1                S01496
072000200610     I                                       37  38 GBLOC1                S01496
072100200610     I                                       39  39 #BLANC                S01496
072200200610     I                                       40  41 SBLOC1                S01496
072300200610     I            DS
072400200610     I                                        1  74 POSL2
072500200610     I**********                              1  12 SNOML                 162056
072600200610     I                                        1  14 SNOML                 162056
072700200610     I                                       15  27 SBKPR
072800200610     I                                       28  28 P1
072900200610     I                                       30  30 SBVI
073000200610     I                                       32  44 SMKPR
073100200610     I                                       45  45 P2
073200200610     I                                       48  60 SBVPF
073300200610     I                                       48  59 SBVPFA
073400200610     I                                       62  74 SMVPF
073500200610     I                                       62  73 SMVPFA
073600200610      *                                                                                       233736
073700200610      ** Added average fiscal price details                                                   233736
073800200610      *                                                                                       233736
073900200610     I            DS
074000200610     I                                        1  74 POSL3
074100200610     I                                        2   9 ACIN1
074200200610     I                                       10  10 ACIN1A
074300200610     I                                       13  16 SINTD
074400200610     I                                       17  20 ACIN2
074500200610     I                                       23  39 SINTT
074600200610     I                                       44  74 DAVFP                                     233736
074700200610     I                                       44  50 NAFP1                                     233736
074800200610     I                                       51  55 NAFP2                                     233736
074900200610     I                                       57  74 SAVFP                                     233736
075000200610     I            DS
075100200610     I                                        1  74 FUTL1
075200200610     I                                        2   9 FL1
075300200610     I                                       10  17 FL2
075400200610     I                                       18  22 FL3
075500200610     I            DS
075600200610     I                                        1  74 FUTL2
075700200610     I                                        2   2 AST
075800200610     I                                        4   5 STDTP
075900200610     I                                        7  19 SNOMT
076000200610     I                                       21  22 AT
076100200610     I                                       24  37 SPRIC
076200200610     I                                       38  38 P3
076300200610     I                                       40  47 VAL
076400200610     I                                       49  55 STDVD
076500200610     I            DS
076600200610     I                                        1  74 TOTL2
076700200610     I                                       48  50 TL4
076800200610     I                                       52  57 TL5
076900200610     I                                       62  74 STTOT
077000200610     I                                       62  73 STTOTA
077100200610     I            DS
077200200610     I                                        1  74 TOTL1
077300200610     I                                       22  29 TL1
077400200610     I                                       30  37 TL2
077500200610     I                                       38  42 TL3
077600200610     I                                       44  46 SNMCYA
077700200610     I                                       48  60 STBVP
077800200610     I                                       48  59 STBVPA
077900200610     I                                       62  74 STMVP
078000200610     I                                       62  73 STMVPA
078100200610     I            DS
078200200610     I**  DS to drop last 3 dps of prices
078300200610     I                                        1  21 ZOUT21
078400200610     I                                        1  17 Z21L3
078500200610     I            DS                                                                          227267
078600200610     I                                        1   6 WORK1                                     227267
078700200610     I**********                              1   60##CDC1                             227267 CSD027
078800200610     I                                        1   6 ##CDC1                                    CSD027
078900200610     I**  LINK ENQUIRY DATA AREA
079000200610     ISESDS     E DS
079100200610     IPSDS       SDS
079200200610     I                                        1  10 PROGRM
079300200610     I                                      244 246 WSID
079400200610     ISCRDS       DS
079500200610     I                                      287 288 AID
079600200610     I/COPY WNCPYSRC,SE0215I002
0797002006100256 I*
0798002006100257 I            DS
0799002006100256 I**   DATA STRUCTURE FOR IKEY
0800002006100258 I                                        1   6 IKEY
0801002006100259 I                                        1   3 NMCY
0802002006100260 I                                        4   6 SITP
0803002006100272 I*
0804002006100273 I*********** DS                                                      S01117
0805002006100272 I*****DATA*STRUCTURE*FOR*CUSTMR(INPUT*NUMBER*OR*S/NAME)*             S01117
0806002006100274 I***********                             1  10 CUSTMR                S01117
0807002006100275 I***********                             1   6 SCSNMA                S01117
0808002006100276 I***********                             7  10 SCSNMB                S01117
080900200610     I**     DATA STRUCTURE FOR ZSEDIT SUBROUTINE
081000200610     I/COPY ZSRSRC,ZSEDITZ2
081100200610     I            DS
081200200610     I                                        1  21 WORKAD
081300200610     I                                        1  21 ZAD
081400200610     I/COPY ZSRSRC,ZYLDZ1
081500200610     I**
081600200610AB   I************DS                                                      E39495
081700200610AB   I****************************************1  117ZCPNR                 E39495
081800200610AB   I***************************************12  12 ZPROT                 E39495
081900200610AB   I***************************************13  270ZPPCP                 E39495
082000200610AB   I***************************************28  368ZCFCT                 E39495
082100200610AB   I***************************************37  510ZSFPP                 E39495
082200200610AB   I***************************************52  660ZSINP                 E39495
082300200610AB   I***************************************67  67 ZPPDI                 E39495
082400200610AB   I****************************************1  117CPNR                  E39495
082500200610AB   I***************************************12  12 PROT                  E39495
082600200610AB   I***************************************13  270CPDP                  E39495
082700200610AB   I***************************************28  368CFCT                  E39495
082800200610AB   I***************************************37  510SFPP                  E39495
082900200610AB   I***************************************52  660SINP                  E39495
083000200610AB   I***************************************67  67 PPDI                  E39495
083100200610     I            DS                                                      S01117
083200200610      *                                                                   S01195
083300200610      ** Data structures for redefining customer number as character      S01195
083400200610      *                                                                   S01195
083500200610     I**********                              1   60CDCN                               S01117 CSD027
083600200610     I                                        1   6 CDCN                                      CSD027
083700200610     I                                        1   6 @CDCN                 S01117
083800200610     I            DS                                                      S01117
083900200610     I**********                              1   60PCUST                              S01117 CSD027
084000200610     I                                        1   6 PCUST                                     CSD027
084100200610     I                                        1   6 @PCUST                S01117
084200200610      *                                                                   S01195
084300200610      ** Data structure for holiday processing.                           S01195
084400200610      *                                                                   S01195
084500200610     I/COPY ZSRSRC,ZHOLI                                                  S01195
084600200610      *                                                                   S01117
084700200610     IRUNDT       DS                                                      S01117
084800200610      *                                                                   S01117
084900200610      ** RUNDAT data area                                                 S01117
085000200610      *                                                                   S01117
085100200610     I                                        1   7 RUNA                  S01117
085200200610     I                                    P   8  100RUND                  S01117
085300200610     I                                       11  11 SSF                   S01117
085400200610     I                                       12  12 DATF                  S01117
085500200610     I                                       13  13 MBIN                  S01117
085600200610      *                                                                   S01117
085700200610     I*ZMUSER*****DS                             17                S01117 090314
085800200610      ************                                                 S01117 090314
085900200610      ***Menu*user data area                                       S01117 090314
086000200610      ************                                                 S01117 090314
086100200610     I************                           11  13 DFTBRC         S01117 090314
086200200610     I************                           17  17 BANKAU         S01117 090314
086300200610      *                                                                   S01117
086400200610     ISDBANK    E DSSDBANKPD                                              S01117
086500200610      *                                                                   S01117
086600200610      ** Bank Details                                                     S01117
086700200610      *                                                                   S01117
086800200610     ISDBOOK    E DSSDBOOKPD                                              S01117
086900200610      *                                                                   S01117
087000200610      ** Book Details                                                     S01117
087100200610      *                                                                   S01117
087200200610     ISDBRCH    E DSSDBRCHPD                                              S01117
087300200610      *                                                                   S01117
087400200610      ** Branch Details                                                   S01117
087500200610      *                                                                   S01117
087600200610     ISDCURR    E DSSDCURRPD                                              S01117
087700200610      *                                                                   S01117
087800200610      ** Currency Details                                                 S01117
087900200610      *                                                                   S01117
088000200610     ISDCUST    E DSSDCUSTPD                                              S01117
088100200610     I              QQDFAC                          #DFAC1                                    CGL029
088200200610      *                                                                   S01117
088300200610      ** Customer Details                                                 S01117
088400200610      *                                                                   S01117
088500200610     ISDGELR    E DSSDGELRPD                                              S01117
088600200610      *                                                                   S01117
088700200610      ** General Ledger Details                                           S01117
088800200610      *                                                                   S01117
088900200610     ISDSECS    E DSSDSECSPD                                              S01117
089000200610     I              QQACCD                          QQACD1                                    CGL029
089100200610      *                                                                   S01117
089200200610      ** Securities Customers                                             S01117
089300200610      *                                                                   S01117
089400200610     ISDSTRD    E DSSDSTRDPD                                              S01117
089500200610      *                                                                   S01117
089600200610      ** Securities Trading Data                                          S01117
089700200610      *                                                                   S01117
089800200610     ISCSARD    E DSSCSARDPD                                              CGL011
089900200610      *                                                                   CGL011
090000200610      ** External Data Structure for Switchable Features file             CGL011
090100200610      *                                                                   CGL011
090200200610     IDSFDY     E DSDSFDY                                                 S01117
090300200610      *                                                                   S01117
090400200610      ** Short data structure for access programs (200 long)              S01117
090500200610      *                                                                   S01117
090600200610     IDSSDY     E DSDSSDY                                                 S01117
090700200610      *                                                                   S01117
090800200610      ** Long data structure for access programs (800 long)               S01117
090900200610      *                                                                   S01117
091000200610     I              'Collateral'          C         COLLA                 CGL011
091100200610      *                                                                   CGL011
091200200610      ** Constant field for collateral text narrative                     CGL011
091300200610      *                                                                   CGL011
091400200610     I/COPY WNCPYSRC,SE0215I001
091500200610     C/EJECT
091600200610      *================================================================
091700200610      *  P R O G R A M   S T A R T                                    *
091800200610      *================================================================
091900200610      *
092000200610     C           *NAMVAR   DEFN           SESDS
092100200610     C           *NAMVAR   DEFN           LDA
092200200610     C           *NAMVAR   DEFN           JNSTAT
092300200610     C************LIKE     DEFN APDA      CACD                            S01117
092400200610     C           *LIKE     DEFN BKAPDT    CACD                            S01117
092500200610     C           *LIKE     DEFN PMKT      SAVM
092600200610     C********** *LIKE     DEFN CDMK      NXTMK                    E37290 159599
092700200610     C********** *LIKE     DEFN CDPT      NXTDP                    E37290 159599
092800200610     C********** *LIKE     DEFN CDSN      NXTSN                    E37290 159599
092900200610     C           *LIKE     DEFN PBOK      SAVB
093000200610     C           *LIKE     DEFN CDNT      ZZPUR
093100200610     C           *LIKE     DEFN CDNT      ZZSAL
093200200610     C           *LIKE     DEFN CDNT      ZZAPS
093300200610     C           *LIKE     DEFN CDNT      ZZAPP
093400200610     C           *LIKE     DEFN CDNT      ZZAPC
093500200610     C           *LIKE     DEFN PPRC      ZZAPW
093600200610     C           *LIKE     DEFN CDNT      ZNOMP
093700200610     C           *LIKE     DEFN CDNT      ZNNOMP
093800200610     C           *LIKE     DEFN CDNT      ZZNOML
093900200610     C           *LIKE     DEFN CDNT      ZZNOMU
094000200610     C           *LIKE     DEFN CDNT      TOTBVP
094100200610     C           *LIKE     DEFN CDNT      TOTMVP
094200200610     C************LIKE     DEFN ERLC      ZRATE1                          S01117
094300200610     C************LIKE     DEFN ERLC      ZRATE2                          S01117
094400200610     C************LIKE     DEFN MDIN      ZMDI1                           S01117
094500200610     C************LIKE     DEFN MDIN      ZMDI2                           S01117
094600200610     C           *LIKE     DEFN A6MDIN    ZMDI1                           S01117
094700200610     C           *LIKE     DEFN A6MDIN    ZMDI2                           S01117
094800200610     C           *LIKE     DEFN A6ERLC    ZRATE1                          S01117
094900200610     C           *LIKE     DEFN A6ERLC    ZRATE2                          S01117
095000200610      *
095100200610      ** Module use to retrieve the latest position in ETCPOSND                               233736
095200200610      *                                                                                       233736
095300200610     C                     MOVEL'SEETCPRT'WPGM    9                                           233736
095400200610     C                     MOVE 'V'       WPGM                                                233736
095500200610      *                                                                                       233736
095600200610     C           KEYI      KLIST
095700200610     C                     KFLD           NMCY
095800200610     C                     KFLD           SITP
095900200610      *
096000200610     C           KYPR      KLIST                                          S01176
096100200610     C                     KFLD           SITP                            S01176
096200200610     C                     KFLD           NMCY                            S01176
096300200610      *
096400200610     C           KEYC      KLIST
096500200610     C                     KFLD           SAVBR
096600200610     C                     KFLD           PCUST
096700200610      *
096800200610     C           KEYPT     KLIST
096900200610     C                     KFLD           PTYP    2
097000200610     C                     KFLD           SAVSEC
097100200610     C                     KFLD           PDAT    50
097200200610     C**********           KFLD           PCST    60                                          CSD027
097300200610     C                     KFLD           PCST    6                                           CSD027
097400200610      *
097500200610     C           KEYPTP    KLIST
097600200610     C                     KFLD           PTYP
097700200610     C                     KFLD           SAVSEC
097800200610      *
097900200610     C           KEYP      KLIST
098000200610     C                     KFLD           SAVSEC
098100200610     C                     KFLD           SAVBR
098200200610     C                     KFLD           SAVM
098300200610     C                     KFLD           SAVB
098400200610     C                     KFLD           PCUST
098500200610     C                     KFLD           PPRT
098600200610      *
098700200610     C           KEYPD     KLIST
098800200610     C                     KFLD           SAVSEC
098900200610     C                     KFLD           SAVBR
099000200610     C                     KFLD           SAVM
099100200610     C                     KFLD           SAVB
099200200610     C                     KFLD           PCUST
099300200610     C                     KFLD           PPRT
099400200610     C                     KFLD           RUND
099500200610      *
099600200610     C           KEYPP     KLIST
099700200610     C                     KFLD           SAVSEC
099800200610     C                     KFLD           SAVBR
099900200610     C                     KFLD           SAVM
100000200610     C                     KFLD           SAVB
100100200610     C                     KFLD           PCUST
100200200610     C                     KFLD           PPRT
100300200610     C                     KFLD           PRUN
100400200610      *
100500200610     C           KEYCP     KLIST
100600200610     C                     KFLD           SAVBR
100700200610     C                     KFLD           SAVSEC
100800200610     C                     KFLD           PCUST
100900200610      *
101000200610     C           KEYT      KLIST
101100200610     C                     KFLD           SAVBR
101200200610     C                     KFLD           PCUST
101300200610     C                     KFLD           SAVSEC
101400200610     C                     KFLD           RUND
101500200610      *
101600200610     C           KEYTE     KLIST
101700200610     C                     KFLD           SAVBR
101800200610     C                     KFLD           PCUST
101900200610     C                     KFLD           SAVSEC
102000200610     C*                                                                   E37290
102100200610     C********** KEYUP     KLIST                                   E37290 159599
102200200610     C**********           KFLD           SAVBR                    E37290 159599
102300200610     C**********           KFLD           PCUST                    E37290 159599
102400200610     C**********           KFLD           NXTSN                    E37290 159599
102500200610     C**********           KFLD           NXTDP                    E37290 159599
102600200610     C**********           KFLD           NXTMK                    E37290 159599
102700200610     C*                                                                   S01496
102800200610     C           KEY1      KLIST                                          S01496
102900200610     C                     KFLD           W1CDBR                          S01496
103000200610     C                     KFLD           W1CDCN                          S01496
103100200610     C                     KFLD           W1CDSN                          S01496
103200200610     C                     KFLD           W1PTFR                                              233736
103300200610     C                     KFLD           W1CDPT                          S01496
103400200610     C                     KFLD           W1CDMK                          S01496
103500200610     C*                                                                   S01496
103600200610     C           KEY2      KLIST                                          S01496
103700200610     C                     KFLD           SAVBR                           S01496
103800200610     C                     KFLD           PCUST                           S01496
103900200610     C                     KFLD           ZSECT                           S01496
104000200610      *                                                                   CGL011
104100200610     C           KEYVD     KLIST                                          CGL011
104200200610     C                     KFLD           SAVBR                           CGL011
104300200610     C                     KFLD           SSESN                           CGL011
104400200610     C**
104500200610     C**  DO FIRST CYCLE PROCESSING
104600200610     C**
104700200610     C                     MOVEL*BLANKS   HBLOCK                          S01496
104800200610     C                     MOVEL*BLANKS   GBLOCK  2                       S01496
104900200610     C                     MOVEL*BLANKS   SBLOCK  2                       S01496
105000200610     C                     EXSR FIRST
105100200610     C**
105200200610     C**  MAIN PROCESSING    -    Do until end of job requested
105300200610     C**
105400200610     C           *IN01     DOWEQ'0'
105500200610     C/COPY WNCPYSRC,SE0215C016
105600200610     C**
105700200610     C**    Display the screen
105800200610     C**
105900200610     C                     WRITESE0215F0
106000200610     C                     EXFMTSE0215C0
106100200610     C/COPY WNCPYSRC,SE0215C017
106200200610      *                                                                   S01117
106300200610      ** Check for Book '?' prompt and skip processing if found           S01117
106400200610      *                                                                   S01117
106500200610     C                     EXSR CHKSEL                                    S01117
106600200610     C           @SEL      IFEQ 0                                         S01117
106700200610     C**
106800200610     C** Call S/R to move values into AID                                 S01179
106900200610     C*                                                                   S01179
107000200610     C                     EXSR ASCHGS                                    S01179
107100200610     C*                                                                   S01179
107200200610     C**    Clear the error messages unless HELP pressed
107300200610     C**
107400200610     C           AID       IFNE 'HP'
107500200610     C                     MOVE *BLANKS   ERMSG  79
107600200610     C                     MOVE '0'       *IN41
107700200610     C                     MOVE '0'       *IN42
107800200610     C                     MOVE '0'       *IN44
107900200610     C                     END
108000200610     C**
108100200610     C******Check*Command*Keys*-*including*HELP                           S01199
108200200610     C**    Check Command Keys                                            S01199
108300200610     C**
108400200610     C                     EXSR COMMD
108500200610     C**
108600200610     C**    If Enter has been pressed check validity of options
108700200610     C**
108800200610     C           AID       IFEQ 'RA'
108900200610     C**
109000200610     C**    Check Validity of Option Combinations
109100200610     C**                   Either Cust OR Select must be entered
109200200610     C**                   Only one select must be entered
109300200610     C**
109400200610     C                     EXSR OPTION
109500200610     C**
109600200610     C           *IN42     IFEQ '0'
109700200610     C**
109800200610     C**    Check if a new cust number or shortname entered
109900200610     C**
110000200610     C***********CUSTMR    IFNE *BLANKS                                   089937
110100200610     C           CUSTMR    IFNE WSVCUS                                    089937
110200200610     C           BRANCH    ORNE WSVBRC                                    089937
110300200610     C                     EXSR CUSTIN
110400200610     C                     END
110500200610     C**
110600200610     C**    Lower Level Enquiry Selected - only possible if details
110700200610     C**
110800200610     C           OPTN      IFNE *BLANK
110900200610     C                     EXSR LINK
111000200610     C                     END
111100200610     C**
111200200610     C                     END
111300200610     C                     END
111400200610     C                     END                                            S01117
111500200610     C                     END
111600200610      *
111700200610      *================================================================
111800200610      *  Return to calling program                                    *
111900200610      *                                                               *
112000200610     C                     EXSR RETSR
112100200610      *                                                               *
112200200610     ******************************************************************   S01496
112300200610     C/EJECT                                                              S01496
112400200610     ******************************************************************   S01496
112500200610     C* P001   : CHANGE SCREEN HEADINGS                               *   S01496
112600200610     C*                                                               *   S01496
112700200610     C* Called  By   CUSTIN                                           *   S01496
112800200610     ******************************************************************   S01496
112900200610     C*                                                                   S01496
113000200610     C           P001      BEGSR                                          S01496
113100200610     C*                                                                   S01496
113200200610     C** PARAMETERS - DEFINITION AND INITIALIZATION                       S01496
113300200610     C                     MOVEL*BLANKS   ##CDBR  3                       S01496
113400200610     C                     MOVEL*BLANKS   ##CDSN 10                       S01496
113500200610     C                     MOVEL*BLANKS   ##CDCN  6                       S01496
113600200610     C                     MOVEL*BLANKS   ##PTFR  4                       S01496
113700200610     C                     MOVEL*BLANKS   ##CPBI  1                       S01496
113800200610     C                     MOVEL*BLANKS   ##CSBI  1                       S01496
113900200610     C                     MOVEL*BLANKS   HBLOCK                          S01496
114000200610     C*                                                                   S01496
114100200610     C** AFTER THE CUSTOMER INFORMATIONS WAS RECEIVED FROM BASIC FILE     S01496
114200200610     C** LF/CLINT                                                         S01496
114300200610      *                                                                   CSE007
114400200610      ***  If Corporate Actions feature is installed.                     CSE007
114500200610      ***  or Securities Redenomination is installed.                     CEU017
114600200610      *                                                                   CSE007
114700200610     C           CSE007    IFEQ 'Y'                                       CSE007
114800200610     C           CEU017    OREQ 'Y'                                       CEU017
114900200610      *                                                                   CSE007
115000200610      ***  Search if there is a Corporate Actions General Block           CSE007
115100200610      ***  Purchased and/or Sales for Customer by calling RPG/SE7574 with CSE007
115200200610      ***  parameters:                                                    CSE007
115300200610      ***  - Branch Code (3A): current                       ##CDBR       CSE007
115400200610      ***  - Customer    (6A): current                       ##CDCN       CSE007
115500200610      ***  - Portfolio   (4A): blank                         ##PTFR       CSE007
115600200610      ***  - Customer Purch.Gen.Block Ind. (1A): blank       ##CPBI       CSE007
115700200610      ***  - Customer Sales Gen.Block Ind. (1A): blank       ##CSBI       CSE007
115800200610      *                                                                   CSE007
115900200610     C                     MOVE 'Y'       SE6714                          CSE007
116000200610     C                     MOVE SAVBR     ##CDBR                          CSE007
116100200610     C                     MOVE SCUST     ##CDCN                          CSE007
116200200610     C                     CALL 'SE7574'                                  CSE007
116300200610     C                     PARM           ##CDBR                          CSE007
116400200610     C                     PARM           ##CDCN                          CSE007
116500200610     C                     PARM           ##PTFR                          CSE007
116600200610     C                     PARM           ##CPBI                          CSE007
116700200610     C                     PARM           ##CSBI                          CSE007
116800200610      *                                                                   CSE007
116900200610      ***  If 'Customer Purchased General Block Indicator' = 'Y' or       CSE007
117000200610      ***  'Customer Sales General Block Indicator' = 'Y', add the new    CSE007
117100200610      ***  Block Information either of 'GB', 'GP', 'GS', depending        CSE007
117200200610      ***  contens of received indicators.                                CSE007
117300200610      *                                                                   CSE007
117400200610     C                     SELEC                                          CSE007
117500200610     C           ##CPBI    WHEQ 'Y'                                       CSE007
117600200610     C           ##CSBI    ANDEQ'Y'                                       CSE007
117700200610     C                     MOVEL'GB'      HBLOCK                          CSE007
117800200610     C           ##CPBI    WHEQ 'Y'                                       CSE007
117900200610     C                     MOVEL'GP'      HBLOCK                          CSE007
118000200610     C           ##CSBI    WHEQ 'Y'                                       CSE007
118100200610     C                     MOVEL'GS'      HBLOCK                          CSE007
118200200610     C                     ENDSL                                          CSE007
118300200610      *                                                                   CSE007
118400200610      ***  If there is a Corporate Actions General Block Purchased        CSE007
118500200610      ***  and/or Sales for Customer, setup work field to not call        CSE007
118600200610      ***  RPG/SE6714.                                                    CSE007
118700200610      *                                                                   CSE007
118800200610     C           HBLOCK    IFNE *BLANKS                                   CSE007
118900200610     C                     MOVE 'N'       SE6714                          CSE007
119000200610     C                     ELSE                                           CSE007
119100200610      *                                                                   CSE007
119200200610      ***  Else initialization parameters to call RPG/SE6714.             CSE007
119300200610      *                                                                   CSE007
119400200610     C                     MOVEL*BLANKS   ##CDBR  3                       CSE007
119500200610     C                     MOVEL*BLANKS   ##CDSN 10                       CSE007
119600200610     C                     MOVEL*BLANKS   ##CDCN  6                       CSE007
119700200610     C                     MOVEL*BLANKS   ##PTFR  4                       CSE007
119800200610     C                     MOVEL*BLANKS   ##CPBI  1                       CSE007
119900200610     C                     MOVEL*BLANKS   ##CSBI  1                       CSE007
120000200610     C                     MOVEL*BLANKS   HBLOCK                          CSE007
120100200610     C                     ENDIF                                          CSE007
120200200610      *                                                                   CSE007
120300200610     C                     ENDIF                                          CSE007
120400200610      *                                                                   CSE007
120500200610      ***  If there is no Corporate Actions General Block Purchased       CSE007
120600200610      ***  and Sales for Customer or if Corporate Actions feature is      CSE007
120700200610      ***  switched OFF.                                                  CSE007
120800200610      *                                                                   CSE007
120900200610     C           SE6714    IFEQ 'Y'                                       CSE007
121000200610     C*                                                                   S01496
121100200610     C** 1. SEARCH IF THERE IS A GENERAL BLOCK PURCHASED AND/OR SALES FOR S01496
121200200610     C**    CUSTOMER BY CALLING RPG/SE6714 WITH PARAMETERS:               S01496
121300200610     C**     - BRANCH CODE (3A)  CURRENT                       ##CDBR     S01496
121400200610     C**     - CUSTOMER    (6A)  CURRENT                       ##CDCN     S01496
121500200610     C**     - PORTFOLIO   (4A)  BLANK                         ##PTFR     S01496
121600200610     C**     - CUSTOMER PURCH.GEN.BLOCK IND. (1A)  BLANK       ##CPBI     S01496
121700200610     C**     - CUSTOMER SALES GEN.BLOCK IND. (1A)  BLANK       ##CSBI     S01496
121800200610     C                     MOVE SAVBR     ##CDBR                          S01496
121900200610     C                     MOVE SCUST     ##CDCN                          S01496
122000200610     C                     CALL 'SE6714'                                  S01496
122100200610     C                     PARM           ##CDBR                          S01496
122200200610     C                     PARM           ##CDCN                          S01496
122300200610     C                     PARM           ##PTFR                          S01496
122400200610     C                     PARM           ##CPBI                          S01496
122500200610     C                     PARM           ##CSBI                          S01496
122600200610     C*                                                                   S01496
122700200610     C** 2. IF 'CUSTOMER PURCH.GEN.BLOCK IND.' = 'Y' OR                   S01496
122800200610     C**       'CUSTOMER SALES GEN.BLOCK IND.' = 'Y'                      S01496
122900200610     C*                                                                   S01496
123000200610     C** 2.1 ADD ON THE HEADER RECORD, AFTER TOWN AND UNDER 'RUN DATE'    S01496
123100200610     C**     THE NEW BLOCK INFORMATION EITHER OF 'GB', 'GP', 'GS',        S01496
123200200610     C**     DEPENDING CONTENS OF RECEIVED INDICATORS.                    S01496
123300200610     C                     SELEC                                          S01496
123400200610     C           ##CPBI    WHEQ 'Y'                                       S01496
123500200610     C           ##CSBI    ANDEQ'Y'                                       S01496
123600200610     C                     MOVEL'GB'      HBLOCK                          S01496
123700200610     C           ##CPBI    WHEQ 'Y'                                       S01496
123800200610     C                     MOVEL'GP'      HBLOCK                          S01496
123900200610     C           ##CSBI    WHEQ 'Y'                                       S01496
124000200610     C                     MOVEL'GS'      HBLOCK                          S01496
124100200610     C                     ENDSL                                          S01496
124200200610      *                                                                   CSE007
124300200610     C                     ENDIF                                          CSE007
124400200610     C*                                                                   S01496
124500200610     C                     ENDSR                                          S01496
124600200610     ******************************************************************   S01496
124700200610     C/EJECT                                                              S01496
124800200610     ******************************************************************   S01496
124900200610     C* P002   : CHANGE SCREEN DETAILS                                *   S01496
125000200610     C*                                                               *   S01496
125100200610     C* Called  By   PROCES                                           *   S01496
125200200610     ******************************************************************   S01496
125300200610     C*                                                                   S01496
125400200610     C           P002      BEGSR                                          S01496
125500200610     C*                                                                   S01496
125600200610     C** PARAMETERS - INITIALIZATION                                      S01496
125700200610     C                     MOVEL*BLANKS   ##CPBI                          S01496
125800200610     C                     MOVEL*BLANKS   ##CSBI                          S01496
125900200610     C                     MOVEL*BLANKS   GBLOCK                          S01496
126000200610     C**********           Z-ADD0         ##CDC1                                       227267 CSD027
126100200610     C                     MOVE *BLANKS   ##CDC1                                              CSD027
126200200610     C*                                                                   S01496
126300200610     C** AFTER THE SECURITY INFORMATIONS WAS RECEIVED FROM BASIC FILE     S01496
126400200610     C** LF/SECTY                                                         S01496
126500200610      *                                                                   CSE007
126600200610      ***  If Corporate Actions feature is installed.                     CSE007
126700200610      ***  or Securities Redenomination is installed.                     CEU017
126800200610      *                                                                   CSE007
126900200610     C           CSE007    IFEQ 'Y'                                       CSE007
127000200610     C           CEU017    OREQ 'Y'                                       CEU017
127100200610      *                                                                   CSE007
127200200610      ***  Search if there is a Corporate Actions General Block Purchased CSE007
127300200610      ***  and/or Sales for Security by calling RPG/7572 with parameters: CSE007
127400200610      ***  - Branch Code (3A):  current                      ##CDBR       CSE007
127500200610      ***  - Security    (10A): current                      ##CDSN       CSE007
127600200610      ***  - Security Purch.Gen.Block Ind. (1A): blank       ##CPBI       CSE007
127700200610      ***  - Security Sales Gen.Block Ind. (1A): blank       ##CSBI       CSE007
127800200610      *                                                                   CSE007
127900200610     C                     MOVE 'Y'       SE6712                          CSE007
128000200610     C                     MOVE SAVBR     ##CDBR                          CSE007
128100200610     C                     MOVELSAVSEC    ##CDSN                          CSE007
128200200610     C                     MOVELSCUST     WORK1                           227267
128300200610     C                     CALL 'SE7572'                                  CSE007
128400200610     C                     PARM           ##CDBR                          CSE007
128500200610     C                     PARM           ##CDSN                          CSE007
128600200610     C                     PARM           ##CDC1                          227267
128700200610     C                     PARM           ##CPBI                          CSE007
128800200610     C                     PARM           ##CSBI                          CSE007
128900200610      *                                                                   CSE007
129000200610      ***  If 'Security Purchased General Block Indicator' = 'Y' or       CSE007
129100200610      ***  'Security Sales General Block Indicator' = 'Y', add the        CSE007
129200200610      ***  Block Information either of 'GB', 'GP', 'GS', depending        CSE007
129300200610      ***  contens of received indicators.                                CSE007
129400200610      *                                                                   CSE007
129500200610     C                     SELEC                                          CSE007
129600200610     C           ##CPBI    WHEQ 'Y'                                       CSE007
129700200610     C           ##CSBI    ANDEQ'Y'                                       CSE007
129800200610     C                     MOVEL'GB'      GBLOCK                          CSE007
129900200610     C           ##CPBI    WHEQ 'Y'                                       CSE007
130000200610     C                     MOVEL'GP'      GBLOCK                          CSE007
130100200610     C           ##CSBI    WHEQ 'Y'                                       CSE007
130200200610     C                     MOVEL'GS'      GBLOCK                          CSE007
130300200610     C                     ENDSL                                          CSE007
130400200610      *                                                                   CSE007
130500200610      ***  If there is a Corporate Actions General Block Purchased        CSE007
130600200610      ***  and/or Sales for Security, setup work field to not call        CSE007
130700200610      ***  RPG/SE6712.                                                    CSE007
130800200610      *                                                                   CSE007
130900200610     C           GBLOCK    IFNE *BLANKS                                   CSE007
131000200610     C                     MOVE 'N'       SE6712                          CSE007
131100200610     C                     ELSE                                           CSE007
131200200610      *                                                                   CSE007
131300200610      ***  Else initialization parameters to call RPG/SE6712.             CSE007
131400200610      *                                                                   CSE007
131500200610     C                     MOVEL*BLANKS   ##CPBI                          CSE007
131600200610     C                     MOVEL*BLANKS   ##CSBI                          CSE007
131700200610     C                     MOVEL*BLANKS   GBLOCK                          CSE007
131800200610     C                     ENDIF                                          CSE007
131900200610      *                                                                   CSE007
132000200610     C                     ENDIF                                          CSE007
132100200610      *                                                                   CSE007
132200200610      ***  If there is no Corporate Actions General Block Purchased       CSE007
132300200610      ***  and Sales for Security or if Corporate Actions feature is      CSE007
132400200610      ***  switched OFF.                                                  CSE007
132500200610      *                                                                   CSE007
132600200610     C           SE6712    IFEQ 'Y'                                       CSE007
132700200610     C*                                                                   S01496
132800200610     C** 1. SEARCH IF THERE IS A GENERAL BLOCK PURCHASED AND/OR SALES FOR S01496
132900200610     C**    SECURITY BY CALLING RPG/SE6712 WITH PARAMETERS:               S01496
133000200610     C**     - BRANCH CODE (3A)  CURRENT                       ##CDBR     S01496
133100200610     C**     - SECURITY    (10A) CURRENT                       ##CDSN     S01496
133200200610     C**     - SECURITY PURCH.GEN.BLOCK IND. (1A)  BLANK       ##CPBI     S01496
133300200610     C**     - SECURITY SALES GEN.BLOCK IND. (1A)  BLANK       ##CSBI     S01496
133400200610     C                     MOVE SAVBR     ##CDBR                          S01496
133500200610     C                     MOVELSAVSEC    ##CDSN                          S01496
133600200610     C                     CALL 'SE6712'                                  S01496
133700200610     C                     PARM           ##CDBR                          S01496
133800200610     C                     PARM           ##CDSN                          S01496
133900200610     C                     PARM           ##CPBI                          S01496
134000200610     C                     PARM           ##CSBI                          S01496
134100200610     C*                                                                   S01496
134200200610     C** 2. IF 'SECURITY PURCH.GEN.BLOCK IND.' = 'Y' OR                   S01496
134300200610     C**       'SECURITY SALES GEN.BLOCK IND.' = 'Y'                      S01496
134400200610     C*                                                                   S01496
134500200610     C** 2.1 ADD ON THE HEADER RECORD, AFTER SECURITY DESCRIPTION (*)     S01496
134600200610     C**     BLOCK INFORMATION EITHER OF 'GB', 'GP', 'GS', DEPENDING      S01496
134700200610     C**     CONTENS OF RECEIVED INDICATORS.                              S01496
134800200610     C                     SELEC                                          S01496
134900200610     C           ##CPBI    WHEQ 'Y'                                       S01496
135000200610     C           ##CSBI    ANDEQ'Y'                                       S01496
135100200610     C                     MOVEL'GB'      GBLOCK                          S01496
135200200610     C           ##CPBI    WHEQ 'Y'                                       S01496
135300200610     C                     MOVEL'GP'      GBLOCK                          S01496
135400200610     C           ##CSBI    WHEQ 'Y'                                       S01496
135500200610     C                     MOVEL'GS'      GBLOCK                          S01496
135600200610     C                     ENDSL                                          S01496
135700200610      *                                                                   CSE007
135800200610     C                     ENDIF                                          CSE007
135900200610     C*                                                                   S01496
136000200610     C** PARAMETERS - INITIALIZATION                                      S01496
136100200610     C                     MOVEL*BLANKS   ##PTFR                          S01496
136200200610     C                     MOVEL*BLANKS   ##CPBI                          S01496
136300200610     C                     MOVEL*BLANKS   ##CSBI                          S01496
136400200610     C                     MOVEL*BLANKS   SBLOCK                          S01496
136500200610      *                                                                   CSE007
136600200610      ***  If Corporate Actions feature is installed.                     CSE007
136700200610      ***  or Securities Redenomination is installed.                     CEU017
136800200610      *                                                                   CSE007
136900200610     C           CSE007    IFEQ 'Y'                                       CSE007
137000200610     C           CEU017    OREQ 'Y'                                       CEU017
137100200610      *                                                                   CSE007
137200200610      ***  Search if there is a Corporate Actions Specific Block          CSE007
137300200610      ***  Purchased And/or Sales for Customer/Security by calling        CSE007
137400200610      ***  RPG/SE7576 with parameters:                                    CSE007
137500200610      ***  - Branch Code (3A):  current                      ##CDBR       CSE007
137600200610      ***  - Customer    (6A):  current                      ##CDCN       CSE007
137700200610      ***  - Security    (10A): current                      ##CDSN       CSE007
137800200610      ***  - Portfolio   (4A):  blank                        ##PTFR       CSE007
137900200610      ***  - Purch.Spec.Block Ind. (1A): blank               ##CPBI       CSE007
138000200610      ***  - Sales Spec.Block Ind. (1A): blank               ##CSBI       CSE007
138100200610      *                                                                   CSE007
138200200610     C                     MOVE 'Y'       SE6716                          CSE007
138300200610     C                     MOVE SAVBR     ##CDBR                          CSE007
138400200610     C                     MOVE SCUST     ##CDCN                          CSE007
138500200610     C                     MOVELSAVSEC    ##CDSN                          CSE007
138600200610     C                     CALL 'SE7576'                                  CSE007
138700200610     C                     PARM           ##CDBR                          CSE007
138800200610     C                     PARM           ##CDCN                          CSE007
138900200610     C                     PARM           ##CDSN                          CSE007
139000200610     C                     PARM           ##PTFR                          CSE007
139100200610     C                     PARM           ##CPBI                          CSE007
139200200610     C                     PARM           ##CSBI                          CSE007
139300200610      *                                                                   CSE007
139400200610      ***  If 'Purchased Specific Block Indicator' = 'Y' or               CSE007
139500200610      ***  'Sales Specific Block Indicator' = 'Y', add the Block          CSE007
139600200610      ***  Information either of 'SB', 'SP', 'SS', depending contens of   CSE007
139700200610      ***  received indicators.                                           CSE007
139800200610      *                                                                   CSE007
139900200610     C                     SELEC                                          CSE007
140000200610     C           ##CPBI    WHEQ 'Y'                                       CSE007
140100200610     C           ##CSBI    ANDEQ'Y'                                       CSE007
140200200610     C                     MOVEL'SB'      SBLOCK                          CSE007
140300200610     C           ##CPBI    WHEQ 'Y'                                       CSE007
140400200610     C                     MOVEL'SP'      SBLOCK                          CSE007
140500200610     C           ##CSBI    WHEQ 'Y'                                       CSE007
140600200610     C                     MOVEL'SS'      SBLOCK                          CSE007
140700200610     C                     ENDSL                                          CSE007
140800200610      *                                                                   CSE007
140900200610      ***  If there is a Corporate Actions Specific Block Purchased       CSE007
141000200610      ***  and/or Sales for Customer/Security, setup work field to not    CSE007
141100200610      ***  call RPG/SE6716.                                               CSE007
141200200610      *                                                                   CSE007
141300200610     C           SBLOCK    IFNE *BLANKS                                   CSE007
141400200610     C                     MOVE 'N'       SE6716                          CSE007
141500200610     C                     ELSE                                           CSE007
141600200610      *                                                                   CSE007
141700200610      ***  Else initialization parameters to call RPG/SE6716.             CSE007
141800200610      *                                                                   CSE007
141900200610     C                     MOVEL*BLANKS   ##PTFR                          CSE007
142000200610     C                     MOVEL*BLANKS   ##CPBI                          CSE007
142100200610     C                     MOVEL*BLANKS   ##CSBI                          CSE007
142200200610     C                     MOVEL*BLANKS   SBLOCK                          CSE007
142300200610     C                     ENDIF                                          CSE007
142400200610      *                                                                   CSE007
142500200610     C                     ENDIF                                          CSE007
142600200610      *                                                                   CSE007
142700200610      ***  If there is no Corporate Actions Specific Block Purchased      CSE007
142800200610      ***  and Sales for Customer/Security or if Corporate Actions        CSE007
142900200610      ***  feature is switched OFF.                                       CSE007
143000200610      *                                                                   CSE007
143100200610     C           SE6716    IFEQ 'Y'                                       CSE007
143200200610     C*                                                                   S01496
143300200610     C** 3. SEARCH IF THERE IS A SPECIFIC BLOCK PURCHASED AND/OR SALES    S01496
143400200610     C**    FOR CUSTOMER/SECURITY BY CALLING RPG/SE6716 WITH PARAMETERS:  S01496
143500200610     C**     - BRANCH CODE (3A)  CURRENT                       ##CDBR     S01496
143600200610     C**     - CUSTOMER    (6A)  CURRENT                       ##CDCN     S01496
143700200610     C**     - SECURITY    (10A) CURRENT                       ##CDSN     S01496
143800200610     C**     - PORTFOLIO   (4A)  BLANK                         ##PTFR     S01496
143900200610     C**     - PURCH.SPEC.BLOCK IND. (1A)  BLANK               ##CPBI     S01496
144000200610     C**     - SALES SPEC.BLOCK IND. (1A)  BLANK               ##CSBI     S01496
144100200610     C                     MOVE SAVBR     ##CDBR                          S01496
144200200610     C                     MOVE SCUST     ##CDCN                          S01496
144300200610     C                     MOVELSAVSEC    ##CDSN                          S01496
144400200610     C                     CALL 'SE6716'                                  S01496
144500200610     C                     PARM           ##CDBR                          S01496
144600200610     C                     PARM           ##CDCN                          S01496
144700200610     C                     PARM           ##CDSN                          S01496
144800200610     C                     PARM           ##PTFR                          S01496
144900200610     C                     PARM           ##CPBI                          S01496
145000200610     C                     PARM           ##CSBI                          S01496
145100200610     C*                                                                   S01496
145200200610     C** 4. IF 'PURCH.SPECIFIC BLOCK IND.' = 'Y' OR                       S01496
145300200610     C**       'SALES SPECIFIC BLOCK IND.' = 'Y'                          S01496
145400200610     C*                                                                   S01496
145500200610     C** 4.1 ADD ON THE HEADER RECORD, AFTER SECURITY DESCRIPTION (*)     S01496
145600200610     C**     BLOCK INFORMATION EITHER OF 'SB', 'SP', 'SS', DEPENDING      S01496
145700200610     C**     CONTENS OF RECEIVED INDICATORS.                              S01496
145800200610     C                     SELEC                                          S01496
145900200610     C           ##CPBI    WHEQ 'Y'                                       S01496
146000200610     C           ##CSBI    ANDEQ'Y'                                       S01496
146100200610     C                     MOVEL'SB'      SBLOCK                          S01496
146200200610     C           ##CPBI    WHEQ 'Y'                                       S01496
146300200610     C                     MOVEL'SP'      SBLOCK                          S01496
146400200610     C           ##CSBI    WHEQ 'Y'                                       S01496
146500200610     C                     MOVEL'SS'      SBLOCK                          S01496
146600200610     C                     ENDSL                                          S01496
146700200610      *                                                                   CSE007
146800200610     C                     ENDIF                                          CSE007
146900200610     C*                                                                   S01496
147000200610     C                     ENDSR                                          S01496
147100200610      *================================================================
147200200610      /EJECT
147300200610     C*****************************************************************
147400200610     C**                                                              *
147500200610     C**    COMMD   SR   To process Command Keys                      *
147600200610     C*******************and*HELP,*ROLLUP*and*ROLLDOWN***             *
147700200610     C**                 ROLLUP and ROLLDOWN                          *
147800200610     C**                                                              *
147900200610     C**    Called  By   MAIN                                         *
148000200610     C**    Calls   SR   ROLLUP, CLEAR, CUSTIN                        *
148100200610     C******Calls**PGM***MHELP,*SE0270***                             *
148200200610     C**    Calls  PGM   SE0270                                       *
148300200610     C**                                                              *
148400200610     C*****************************************************************
148500200610     C**
148600200610     C           COMMD     BEGSR                           ** COMMD **
148700200610     C**
148800200610     C*****If*HELP*pressed*call*help*screen
148900200610     C***********
149000200610     C***********AID       IFEQ 'HP'                                      S01199
149100200610     C***********          CALL 'MHELP'                                   S01199
149200200610     C***********          PARM           PGMNO                           S01199
149300200610     C***********          PARM           HERCD 160                       S01199
149400200610     C***********          END                                            S01199
149500200610     C**
149600200610     C**    If Rollup key pressed
149700200610     C**
149800200610     C           AID       IFEQ 'UP'
149900200610     C                     EXSR ROLLUP
150000200610     C                     END
150100200610     C**
150200200610     C**    If F3 then exit to menu - return code 1 and end
150300200610     C**
150400200610     C           AID       IFEQ '01'
150500200610     C                     MOVE '1'       RTNC
150600200610     C                     MOVE '1'       *IN01
150700200610     C                     END
150800200610     C**
150900200610     C**    If F12 then return to previous enquiry - return code 2
151000200610     C**                  unless there is no previous enquiry
151100200610     C**
151200200610     C           AID       IFEQ '02'
151300200610     C           ORIG      IFNE PGMNO
151400200610     C                     MOVE '2'       RTNC
151500200610     C                     MOVE '1'       *IN01
151600200610     C                     ELSE
151700200610     C                     MOVE '1'       *IN42
151800200610     C                     MOVE MSG,6     ERMSG
151900200610     C                     END
152000200610     C                     END
152100200610     C**
152200200610     C**    If F5 then refresh enquiry screen
152300200610     C**
152400200610     C           AID       IFEQ '05'
152500200610     C                     MOVE *BLANKS   SCUST                           089937
152600200610     C                     MOVE *BLANKS   CUSTMR                          089937
152700200610     C                     MOVE *BLANKS   BRANCH                          089937
152800200610     C                     MOVE *BLANKS   WSVCUS                          089937
152900200610     C                     MOVE *BLANKS   WSVBRC                          089937
153000200610     C                     EXSR CLEAR
153100200610     C                     END
153200200610     C**
153300200610     C**    If F6 then call Customer Shortname Enquiry
153400200610     C**             on return check return code
153500200610     C**             if 0 then Database Error and exit required
153600200610     C**             if 1 then F3 and exit to menu required
153700200610     C**
153800200610     C           AID       IFEQ '06'
153900200610     C                     MOVE ' '       RTNC
154000200610     C                     OUT  SESDS
154100200610     C                     OUT  LDA
154200200610     C                     CALL 'SE0270'
154300200610     C           *LOCK     IN   LDA
154400200610     C           *LOCK     IN   SESDS
154500200610     C           RTNC      IFEQ '0'
154600200610     C           RTNC      OREQ '1'
154700200610     C                     MOVE '1'       *IN01
154800200610     C                     ELSE
154900200610     C                     MOVELRQCUST    CUSTMR
155000200610     C                     MOVE *BLANKS   RQCUST
155100200610     C           *IN07     IFEQ '0'
155200200610     C                     EXSR CUSTIN
155300200610     C                     END
155400200610     C                     END
155500200610     C                     END
155600200610     C**
155700200610     C**     If F9 then return to initial enquiry - return code 7
155800200610     C**                   unless this is the initial program
155900200610     C**
156000200610     C           AID       IFEQ '07'
156100200610     C           ORIG      IFNE PGMNO
156200200610     C                     MOVE '7'       RTNC
156300200610     C                     MOVE '1'       *IN01
156400200610     C                     ELSE
156500200610     C                     MOVE '1'       *IN42
156600200610     C                     MOVE MSG,6     ERMSG
156700200610     C                     END
156800200610     C                     END
156900200610     C**
157000200610     C                     ENDSR
157100200610     C**
157200200610     C*****************************************************************
157300200610      /EJECT
157400200610     C*****************************************************************
157500200610     C**           ****** AS400 CONVERSION ******                     *   S01179
157600200610     C**                                                              *   S01179
157700200610     C** ASCHGS S/R TO MOVE THE APPROPRIATE VALUES INTO FIELD AID,    *   S01179
157800200610     C** DEPENDING ON WHICH FUNCTION KEY HAS BEEN PRESSED.            *   S01179
157900200610     C** CALLED FROM UPDATE                                           *   S01179
158000200610     C**                                                              *   S01179
158100200610     C*****************************************************************
158200200610     C*                                                                   S01179
158300200610     C           ASCHGS    BEGSR                                          S01179
158400200610     C*                                                                   S01179
158500200610     C* If ENTER pressed, the VLDCMDKEY indicator will be off             S01179
158600200610     C*                                                                   S01179
158700200610     C           *IN10     IFEQ '0'                                       S01179
158800200610     C                     MOVE 'RA'      AID                             S01179
158900200610     C                     END                                            S01179
159000200610     C*                                                                   S01179
159100200610     C* If F3                                                             S01179
159200200610     C*                                                                   S01179
159300200610     C           *INKC     IFEQ '1'                                       S01179
159400200610     C                     MOVE '01'      AID                             S01179
159500200610     C                     MOVE '0'       *INKC                           S01179
159600200610     C                     END                                            S01179
159700200610     C*                                                                   S01179
159800200610     C* If F5                                                             S01179
159900200610     C*                                                                   S01179
160000200610     C           *INKE     IFEQ '1'                                       S01179
160100200610     C                     MOVE '05'      AID                             S01179
160200200610     C                     MOVE '0'       *INKE                           S01179
160300200610     C                     END                                            S01179
160400200610     C*                                                                   S01179
160500200610     C* If F6                                                             S01179
160600200610     C*                                                                   S01179
160700200610     C           *INKF     IFEQ '1'                                       S01179
160800200610     C                     MOVE '06'      AID                             S01179
160900200610     C                     MOVE '0'       *INKF                           S01179
161000200610     C                     END                                            S01179
161100200610     C*                                                                   S01179
161200200610     C* If F9                                                             S01179
161300200610     C*                                                                   S01179
161400200610     C           *INKI     IFEQ '1'                                       S01179
161500200610     C                     MOVE '07'      AID                             S01179
161600200610     C                     MOVE '0'       *INKI                           S01179
161700200610     C                     END                                            S01179
161800200610     C*                                                                   S01179
161900200610     C* If F12                                                            S01179
162000200610     C*                                                                   S01179
162100200610     C           *INKL     IFEQ '1'                                       S01179
162200200610     C                     MOVE '02'      AID                             S01179
162300200610     C                     MOVE '0'       *INKL                           S01179
162400200610     C                     END                                            S01179
162500200610     C*                                                                   S01179
162600200610     C* If ROLLUP pressed                                                 S01179
162700200610     C*                                                                   S01179
162800200610     C           *IN20     IFEQ '1'                                       S01179
162900200610     C                     MOVE 'UP'      AID                             S01179
163000200610     C                     MOVE '0'       *IN20                           S01179
163100200610     C                     END                                            S01179
163200200610     C*                                                                   S01179
163300200610     C**If*HELP*key*pressed                                        S01179 S01199
163400200610     C*                                                                   S01179
163500200610     C************IN21     IFEQ '1'                                S01179 S01199
163600200610     C***********          MOVE 'HP'      AID                      S01179 S01199
163700200610     C***********          MOVE '0'       *IN21                    S01179 S01199
163800200610     C***********          END                                     S01179 S01199
163900200610     C*                                                                   S01179
164000200610     C                     ENDSR                                          S01179
164100200610     C*                                                                   S01179
164200200610     C*****************************************************************
164300200610      /EJECT
164400200610     C*****************************************************************
164500200610     C**                                                              *
164600200610     C**   ROLLUP SR  When Rollup key is pressed load next page unless*
164700200610     C**              last page already displayed when error message  *
164800200610     C**                                                              *
164900200610     C**   Called by  COMMD                                           *
165000200610     C**   Calls  SR  DISP                                            *
165100200610     C**                                                              *
165200200610     C*****************************************************************
165300200610     C**
165400200610     C           ROLLUP    BEGSR                           ** ROLLUP **
165500200610     C**
165600200610     C**   If details Complete then Rollup is beyond last record
165700200610     C**
165800200610     C           *IN05     IFEQ '1'
165900200610     C                     MOVE '1'       *IN06
166000200610     C**
166100200610     C                     ELSE
166200200610     C**
166300200610     C**   Load next page of subfile
166400200610     C**
166500200610     C                     Z-ADDTOP       SFLREC
166600200610     C*                                                                   E37290
166700200610     C** Need to reset file so the last record is read again              E37290
166800200610     C*                                                                   E37290
166900200610     C********** KEYUP     SETLLCDEPP                              E37290 159599
167000200610     C**********           MOVE 'Y'       TROLL   1                088303 159599
167100200610     C                     EXSR DISP
167200200610     C**
167300200610     C                     END
167400200610     C**
167500200610     C                     ENDSR
167600200610     C**
167700200610     C*****************************************************************
167800200610      /EJECT
167900200610     C*****************************************************************
168000200610     C**                                                              *
168100200610     C**   OPTION SR  To check validity of option combinations        *
168200200610     C**                                                              *
168300200610     C**   Called by  MAIN                                            *
168400200610     C**   Calls  SR  none                                            *
168500200610     C**                                                              *
168600200610     C*****************************************************************
168700200610     C**
168800200610     C           OPTION    BEGSR                            ** OPTION *
168900200610     C**
169000200610     C                     MOVE *BLANKS   OPTN
169100200610     C**
169200200610     C**     If no subfile records the only possible entry is cust
169300200610     C**
169400200610     C           *IN03     IFEQ '1'
169500200610     C**
169600200610     C           CUSTMR    IFEQ *BLANKS
169700200610     C                     MOVE '1'       *IN42
169800200610     C                     MOVE MSG,1     ERMSG
169900200610     C                     END
170000200610     C**
170100200610     C                     ELSE
170200200610     C**
170300200610     C                     READCSE0215S0                 40
170400200610     C**
170500200610     C**     Check if any entry made
170600200610     C**
170700200610     C           *IN40     IFEQ '1'
170800200610     C           CUSTMR    ANDEQ*BLANKS
170900200610     C                     MOVE '1'       *IN42
171000200610     C                     MOVE MSG,7     ERMSG
171100200610     C                     END
171200200610     C**
171300200610     C**     Check if both Cust No./Shortname and option entered
171400200610     C**
171500200610     C           *IN40     IFEQ '0'
171600200610     C           CUSTMR    ANDNE*BLANKS
171700200610     C           CUSTMR    ANDNEWSVCUS                                    089937
171800200610     C                     MOVE '1'       *IN42
171900200610     C                     MOVE '1'       *IN41
172000200610     C                     MOVE MSG,2     ERMSG
172100200610     C                     END
172200200610     C**
172300200610     C**    Check if more than one option entered
172400200610     C**
172500200610     C           *IN40     IFEQ '0'
172600200610     C                     MOVE SELECT    OPTN
172700200610     C                     MOVELSSESN     RQSESN
172800200610     C                     MOVE *BLANK    SELECT
172900200610     C                     SETOF                     08
173000200610     C***********          MOVE SBRCH     RQBRCH                          S01117
173100200610     C                     MOVE SBRCH     RQBRCA                          S01117
173200200610     C                     MOVE PCUST     RQCUST
173300200610     C/COPY WNCPYSRC,SE0215C018
173400200610     C                     UPDATSE0215S0
173500200610     C**
173600200610     C           *IN40     DOUEQ'1'
173700200610     C                     READCSE0215S0                 40
173800200610     C           *IN40     IFEQ '0'
173900200610     C           SELECT    ANDNE*BLANK                                    089937
174000200610     C                     MOVE *BLANK    SELECT
174100200610     C/COPY WNCPYSRC,SE0215C019
174200200610     C                     UPDATSE0215S0
174300200610     C           *IN42     IFEQ '0'                                       089937
174400200610     C                     MOVE '1'       *IN42
174500200610     C                     MOVE MSG,3     ERMSG
174600200610     C                     END                                            089937
174700200610     C                     END
174800200610     C**
174900200610     C                     END
175000200610     C                     END
175100200610     C                     END
175200200610     C**
175300200610     C                     ENDSR
175400200610     C**
175500200610     C*****************************************************************
175600200610      /EJECT
175700200610     C*****************************************************************
175800200610     C**                                                              *
175900200610     C**   CUSTIN SR  To process entered CUSTOMER./Shortname          *
176000200610     C**                                                              *
176100200610     C**   Called by  MAIN, FIRST                                     *
176200200610     C**   Calls  SR  SETUP                                           *
176300200610     C**              P001                                            *   S01496
176400200610     C**                                                              *
176500200610     C*****************************************************************
176600200610     C**
176700200610     C           CUSTIN    BEGSR                            ** CUSTIN *
176800200610      ***********
1769002006100384 C***********                                                         S01117
1770002006100385 C***TO*EVALUATE*WHETHER*NUMBER/SHORTNAME*ENTERED*                    S01117
1771002006100386 C***29*ON*IF*SHORTNAME,*30*ON*IF*CUSTNUM*                            S01117
1772002006100387 C***********                                                         S01117
177300200610     C***********          SETOF                     2930                 S01117
1774002006100388 C***********                                                         S01117
1775002006100389 C***CHECK*TO*SEE*IF*MORE*THAN*6*CHARS*ENTERED*                       S01117
177600200610     C***********                                                         S01117
1777002006100390 C***********SCSNMB    IFNE *BLANK                                    S01117
177800200610     C***********          MOVE '1'       *IN29                           S01117
177900200610     C***********          END                                            S01117
1780002006100391 C***********                                                         S01117
1781002006100392 C***IF*NOT*MORE*THAN*6*CHARS,*CHECK*FIRST*6*CHARS*NUMERIC*           S01117
178200200610     C***********                                                         S01117
1783002006100390 C************IN29     IFEQ '0'                                       S01117
178400200610     C***********          MOVE *BLANKS   ZFIELD                          S01117
178500200610     C***********          MOVELSCSNMA    ZFIELD                          S01117
178600200610     C***********          Z-ADD*ZEROS    ZADEC                           S01117
178700200610     C***********          Z-ADD6         ZADIG                           S01117
178800200610     C***********          EXSR ZALIGN                                    S01117
178900200610     C************IN99     IFEQ '1'                                       S01117
179000200610     C***********          SETON                     29                   S01117
179100200610     C***********          ELSE                                           S01117
179200200610     C***********          SETON                     30                   S01117
179300200610     C***********          END                                            S01117
1794002006100390 C***********          END                                            S01117
1795002006100396 C***********                                                         S01117
1796002006100397 C*****IF*S/NAME*GET*CLINT*REC.*                                      S01117
1797002006100398 C***********                                                         S01117
1798002006100390 C************IN29     IFEQ '1'                                       S01117
1799002006100399 C***********CUSTMR    CHAINSNAME                42                   S01117
180000200610     C***********          END                                            S01117
1801002006100409 C***********                                                         S01117
1802002006100410 C*****IF*CUST*NO.*-*CHECK*IT*EXISTS*ON*CLINT*                        S01117
1803002006100411 C***********                                                         S01117
180400200610     C***********                                                         S01117
1805002006100390 C************IN30     IFEQ '1'                                       S01117
1806002006100413 C***********          MOVE SCSNMA    CNUM                            S01117
1807002006100414 C***********CNUM      CHAINCLINTCBF             42                   S01117
180800200610     C***********          END                                            S01117
1809002006100415 C***********                                                         S01117
181000200610     C*****If*an*error*reverse*image*the*input*field*and*error*message*   S01117
181100200610     C*****but*if*ok*prepare*to*display*the*screen*                       S01117
181200200610     C***********                                                         S01117
181300200610     C************IN42     IFEQ '1'                                       S01117
181400200610      *                                                                   S01117
181500200610      ** Access Customer Details file                                     S01117
181600200610      *                                                                   S01117
181700200610     C                     CALL 'AOCUSTR0'                                S01117
181800200610     C                     PARM *BLANKS   @RTCD   7                       S01117
181900200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
182000200610     C                     PARM CUSTMR    @KEY1  10                       S01117
182100200610     C                     PARM           @KYST   7                       S01117
182200200610     C           SDCUST    PARM SDCUST    DSSDY                           S01117
182300200610      *
182400200610     C           @RTCD     IFNE *BLANKS                                   S01117
1825002006100422 C                     MOVELMSG,5     ERMSG
182600200610     C                     MOVE '1'       *IN41
182700200610     C                     MOVE '1'       *IN42                           S01117
182800200610     C                     END
182900200610AW   C*
183000200610AW   C**If*no*Branch*entered,*use*default*from*TABICD*file*               S01117
183100200610     C**If*no*Branch*entered,*use*default*for*user*from*ZMUSER*****S01117 090314
183200200610     C* If no Branch entered, use default for customer                    090314
183300200610AW   C*
183400200610AW   C           BRANCH    IFEQ '   '
183500200610AW   C           BRANCH    OREQ '000'
183600200610AW   C***********          MOVELDSTB      BRANCH                          S01117
183700200610     C***********          MOVELDFTBRC    BRANCH                   S01117 090314
183800200610     C                     MOVELBBBRCD    BRANCH                          090314
183900200610AW   C                     END
184000200610     C**
1841002006100410 C*****IF*MULTI-BRANCH*-*CHECK*BRANCH*VALID*IF*ENTERED*               S01117
1842002006100411 C***********                                                         S01117
1843002006100390 C************IN07     IFEQ '1'                                       S01117
184400200610JGW* C***********                                                         S01117
1845002006100413 C***********          MOVE *BLANKS   KEY    12                       S01117
1846002006100413 C***********          MOVEL'10'      KEY                             S01117
1847002006100413 C***********          MOVE BRANCH    KEY                             S01117
184800200610     C***********KEY       CHAINTABLETRF             44                   S01117
184900200610     C************IN44     IFEQ '0'                                       S01117
1850002006100422 C***********RECI      ANDEQ'*'                                       S01117
185100200610     C***********          MOVE '1'       *IN44                           S01117
185200200610     C***********          END                                            S01117
185300200610     C***********          END                                            S01117
1854002006100415 C***********                                                         S01117
185500200610     C*****If*an*error*reverse*image*the*input*field*and*error*message*   S01117
185600200610     C*****but*if*ok*prepare*to*display*the*screen*                       S01117
185700200610     C***********                                                         S01117
185800200610     C************IN44     IFEQ '1'                                       S01117
185900200610      *                                                                   S01117
186000200610      ** If multibranching environment, check branch code is valid        S01117
186100200610      *                                                                   S01117
186200200610     C           *IN07     IFEQ '1'                                       S01117
186300200610      *                                                                   S01117
186400200610      ** Access branch codes file SDBRCHPD via access object program      S01117
186500200610      *                                                                   S01117
186600200610     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
186700200610     C                     CALL 'AOBRCHR1'                                                    CGL029
186800200610     C                     PARM *BLANKS   @RTCD   7                       S01117
186900200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
187000200610     C                     PARM BRANCH    @DSNB   3                       S01117
187100200610     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
187200200610     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
187300200610     C           @RTCD     IFNE *BLANKS                                   S01117
187400200610      *                                                                   S01117
187500200610      ** If an error reverse image the input field and error message      S01117
187600200610      *                                                                   S01117
1877002006100422 C                     MOVELMSG,8     ERMSG
187800200610     C                     MOVE '1'       *IN42
187900200610     C                     MOVE '1'       *IN44                           S01117
188000200610     C                     ELSE                                           S01117
188100200610      *                                                                   S01117
188200200610      ** Check user is authorised to valid branch                         S01117
188300200610      *                                                                   S01117
188400200610     C                     CALL 'ZVBBU'                                   S01117
188500200610     C                     PARM BRANCH    @ZBR    3                       S01117
188600200610     C                     PARM           @ERR    10                      S01117
188700200610     C           @ERR      IFNE 0                                         S01117
188800200610     C                     MOVEA'11'      *IN,42                          S01117
188900200610     C                     MOVE MSG,10    ERMSG                           S01117
189000200610     C                     END                                            S01117
189100200610      *                                                                   S01117
189200200610     C                     END
189300200610      *                                                                   S01117
189400200610     C                     END                                            S01117
189500200610     C**
189600200610     C**   If customer is on file - check it is a portfolio customer
189700200610     C**   (ie has discretionary indicator of D or S)
189800200610     C**
189900200610     C           *IN42     IFEQ '0'
190000200610     C**
190100200610     C*****ACCESS*CLINTSE*FOR*PORTFOLIO*CUSTOMER*                         S01117
190200200610     C***********                                                         S01117
190300200610     C***********          MOVE CNUM      PCUST   60                      S01117
190400200610     C***********PCUST     CHAINCLINTSEF             25                   S01117
190500200610     C**N25******RECI      COMP 'D'                  2525                 S01117
190600200610     C***********                                                         S01117
190700200610     C*******If*no*record*found*or*deleted*record*                        S01117
190800200610     C**********then*it*is*a*database*error*so*return*to*calling*         S01117
190900200610     C**********program with a return code of '0'                         S01117
191000200610     C***********                                                         S01117
191100200610     C************IN25     IFEQ '1'                                       S01117
191200200610      *                                                                   S01117
191300200610     C                     MOVE BBCUST    @PCUST  6                       S01117
191400200610      *                                                                   S01117
191500200610      ** Access securities clients details                                S01117
191600200610      *                                                                   S01117
191700200610     C                     CALL 'AOSECSR0'                                S01117
191800200610     C***********          PARM '*DBERR'  @RTCD   7                 S01117E26473
191900200610     C                     PARM *BLANKS   @RTCD   7                       E26473
192000200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
192100200610     C                     PARM @PCUST    @AENB   6                       S01117
192200200610     C           SDSECS    PARM SDSECS    DSSDY                           S01117
192300200610      ***********                                                         S01117
192400200610      ***********                                                         S01117
192500200610      ***If*no*record found then it is a database error so return to      S01117
192600200610      ***calling*program with a return code of '0'                        S01117
192700200610      ***********                                                         S01117
192800200610     C***********          MOVELPROGRM    DBPGM                           S01117
192900200610     C***********          MOVELPCUST     DBKEY            ***************S01117
193000200610     C***********          MOVE 'CLINT'   DBFILE           * DB ERROR 05 *S01117
193100200610     C***********          Z-ADD05        DBASE            ***************S01117
193200200610     C***********          SETON                       U7U8               S01117
193300200610     C***********          MOVE '0'       RTNC                            S01117
193400200610     C***********          EXSR RETSR                                     S01117
193500200610     C***********          END                                            S01117
193600200610     C***********C1DI      IFNE 'D'                                       S01117
193700200610     C***********C1DI      ANDNE'S'                                       S01117
193800200610      *                                                                   E26473
193900200610     C           @RTCD     IFNE *BLANKS                                   E26473
194000200610      *                                                                   E26473
194100200610     C                     MOVELMSG,11    ERMSG                           E26473
194200200610     C                     SETON                     4142                 E26473
194300200610     C                     ELSE                                           E26473
194400200610     C           BFCLAS    IFNE 'D'                                       S01117
194500200610     C           BFCLAS    ANDNE'S'                                       S01117
194600200610     C                     MOVELMSG,9     ERMSG
194700200610     C                     SETON                     4142
194800200610     C                     END
194900200610     C                     END                                            E26473
195000200610     C                     END
195100200610     C**
195200200610     C**   If all OK prepare to display the screen
195300200610     C**
195400200610     C           *IN42     IFEQ '0'
195500200610     C                     EXSR SETUP
195600200610     C                     MOVELCUSTMR    WSVCUS 10                       089937
195700200610     C                     MOVELBRANCH    WSVBRC  3                       089937
195800200610     C*                                                                   S01496
195900200610     C           S01496    IFEQ 'Y'                                       S01496
196000200610     C           CSE007    OREQ 'Y'                                       CSE007
196100200610     C           CEU017    OREQ 'Y'                                       CEU017
196200200610     C                     EXSR P001                                      S01496
196300200610     C                     END                                            S01496
196400200610     C*                                                                   S01496
196500200610     C                     END
196600200610     C**
196700200610     C***SINCE*ZPRCOZ1*S/R*HAS*BEEN*COMMENTED*OUT*FOR*A*S01186*ERROR***   E16894
196800200610     C***FIX,*THE*PROGRAM*HAS*LOST*ITS*DEFINITION*OF*ZPRICE*SO*IT*IS***   E16894
196900200610     C***NOW*DEFINED*WITHIN*THE*PROGRAM*HERE***************************   E16894
197000200610     C*                                                                   E16894
197100200610     C***********          Z-ADD0         ZPRICE 158                      E16894
197200200610     C*                                                            S01186 E16894
197300200610     C                     ENDSR
197400200610     C**
197500200610     C*****************************************************************
197600200610      /EJECT
197700200610     C*****************************************************************
197800200610     C**                                                              *
197900200610     C**   SETUP  SR  To prepare for Screen Display                   *
198000200610     C**                                                              *
198100200610     C**   Called by  CUSTIN                                          *
198200200610     C**   Calls  SR  CLEAR, DISP                                     *
198300200610     C**                                                              *
198400200610     C*****************************************************************
198500200610     C**
198600200610     C           SETUP     BEGSR                           ** SETUP **
198700200610     C**
198800200610     C***********          MOVE *BLANKS   CUSTMR                          088776
198900200610     C***********          MOVE CNUM      PCUST   60                      S01117
199000200610     C***********          MOVE CNUM      SCUST                           S01117
199100200610     C***********          MOVE BRANCH    SAVBR   30                      S01117
199200200610     C                     MOVE BBCUST    @PCUST                          S01117
199300200610     C                     MOVE BBCUST    SCUST                           S01117
199400200610     C                     MOVE BRANCH    SAVBR   3                       S01117
199500200610     C**
199600200610     C**   Clear the Screen
199700200610     C**
199800200610     C                     EXSR CLEAR
199900200610     C**
200000200610     C**   Move CUST  Details to output fields
200100200610     C**
200200200610     C***********          MOVE CRNM      SCRNM  20                       S01117
200300200610     C***********          MOVE CTWN      SCTWN  10                       S01117
200400200610     C                     MOVE BBCRNM    SCRNM  20                       S01117
200500200610     C                     MOVE BBCRTN    SCRTN  10                       S01117
200600200610     C**
200700200610     C*****ACCESS*TABTG10*FOR*PORTFOLIO*CURRENCY*                         S01117
200800200610     C***********                                                         S01117
200900200610     C***********          MOVEL'20      'TKEY   12                       S01117
201000200610     C***********          MOVELC1PC      ZWK4    4                       S01117
201100200610     C***********          MOVE 1         ZWK4                            S01117
201200200610     C***********          MOVE ZWK4      TKEY                            S01117
201300200610     C***********TKEY      CHAINTABTG10F             25                   S01117
201400200610     C**N25******RECI      COMP 'D'                  2525                 S01117
201500200610     C***********                                                         S01117
201600200610     C*******If*no record found  or deleted record                        S01117
201700200610     C**********then it is a database error so return to calling          S01117
201800200610     C**********program with a return code of '0'                         S01117
201900200610     C***********                                                         S01117
202000200610     C************IN25     IFEQ '1'                                       S01117
202100200610      *                                                                   S01117
202200200610      ** Access currency file SDCURRPD                                    S01117
202300200610      *                                                                   S01117
202400200610     C                     CALL 'AOCURRR0'                                S01117
202500200610     C                     PARM '*DBERR'  @RTCD   7                       S01117
202600200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
202700200610     C                     PARM BFPCYC    @AJCD   3                       S01117
202800200610     C           SDCURR    PARM SDCURR    DSSDY                           S01117
202900200610      ***********                                                         S01117
203000200610      ***If*no*record*found*then*it*is*a*database*error*so*return*to*     S01117
203100200610      ***calling*program*with*a*return*code*of*'0'*******************     S01117
203200200610      ***********                                                         S01117
203300200610     C***********          MOVELPROGRM    DBPGM                           S01117
203400200610     C***********          MOVELTKEY      DBKEY            ***************S01117
203500200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 09 *S01117
203600200610     C***********          Z-ADD09        DBASE            ***************S01117
203700200610     C***********          SETON                       U7U8               S01117
203800200610     C***********          MOVE '0'       RTNC                            S01117
203900200610     C***********          EXSR RETSR                                     S01117
204000200610     C***********          END                                            S01117
204100200610     C***********                                                         S01117
204200200610     C***********          MOVE C1PC      SNMCYA                          S01117
204300200610     C***********          MOVE CCNM      SC1PC                           S01117
204400200610     C***********          Z-ADDCDP       PCCDP   10                      S01117
204500200610     C                     MOVE BFPCYC    SNMCYA                          S01117
204600200610     C                     MOVE A6CYNM    SPCYC                           S01117
204700200610     C                     Z-ADDA6NBDP    PCCDP   10                      S01117
204800200610     C**
204900200610     C**   Position CEPPP file at start of required customer/branch
205000200610     C**
205100200610     C***********SAVBR     IFEQ 0                                         S01117
205200200610     C***********          MOVE DSTB      SAVBR                           S01117
205300200610     C           SAVBR     IFEQ *BLANKS                                   S01117
205400200610     C***********          MOVE DFTBRC    SAVBR                    S01117 090314
205500200610     C                     MOVE BBBRCD    SAVBR                           090314
205600200610     C                     END
205700200610     C********** KEYC      SETLLCDEPP                                                         233736
205800200610     C           KEYC      SETLLCDEPF                                                         233736
205900200610     C                     MOVE SAVBR     SBRCH
206000200610     C**
206100200610     C**   Reset Accumulators for Screen Details
206200200610     C**
206300200610     C                     MOVE *BLANKS   SAVSEC 10
206400200610     C                     Z-ADD*ZEROS    ZZNOML
206500200610     C                     Z-ADD*ZEROS    ZNOMP
206600200610     C                     Z-ADD*ZEROS    ZZNOMU
206700200610     C                     Z-ADD*ZEROS    ZZPUR
206800200610     C                     Z-ADD*ZEROS    ZZSAL
206900200610     C                     Z-ADD*ZEROS    ZZAPP
207000200610     C                     Z-ADD*ZEROS    ZZAPS
207100200610     C                     Z-ADD*ZEROS    ZCUMCP
207200200610     C                     Z-ADD*ZEROS    TOTMVP
207300200610     C                     Z-ADD*ZEROS    TOTBVP
207400200610     C**********           MOVE 'N'       TROLL                    099435 159599
207500200610     C**
207600200610     C**   Get details for display
207700200610     C**
207800200610     C                     EXSR DISP
207900200610     C**
208000200610     C                     ENDSR
208100200610     C**
208200200610     C*****************************************************************
208300200610      /EJECT
208400200610     C*****************************************************************
208500200610     C**                                                              *
208600200610     C**   CLEAR  SR  Clear the screen display fields and indicators  *
208700200610     C**                                                              *
208800200610     C**   Called by  COMMD, SETUP                                    *
208900200610     C**   Calls  SR  none                                            *
209000200610     C**                                                              *
209100200610     C*****************************************************************
209200200610     C**
209300200610     C           CLEAR     BEGSR
209400200610     C**
209500200610     C** Set up fields and indicators to clear subfile
209600200610     C**
209700200610     C                     MOVE *BLANKS   SCRNM
209800200610     C***********          MOVE *BLANKS   SCTWN                           S01117
209900200610     C                     MOVE *BLANKS   SCRTN                           S01117
210000200610     C***********          MOVE *BLANKS   CUSTMR                          088776
210100200610     C***********          MOVE *BLANKS   BRANCH                          088776
210200200610     C***********          MOVE *BLANKS   SC1PC                           S01117
210300200610     C                     MOVE *BLANKS   SPCYC                           S01117
210400200610     C                     MOVE *BLANKS   SBRCH
210500200610     C**
210600200610     C                     Z-ADD0         SFLREC  40
210700200610     C                     Z-ADD0         TOP     40
210800200610     C**
210900200610     C                     SETON                       03
211000200610     C                     SETOF                       040550
211100200610     C                     SETOF                       518189
211200200610     C                     SETOF                       5960
211300200610     C**  CLEAR SUBFILE
211400200610     C                     SETON                       02
211500200610     C                     WRITESE0215C0
211600200610     C                     SETOF                       02
211700200610     C**
211800200610     C                     ENDSR
211900200610     C**
212000200610     C*****************************************************************
212100200610      /EJECT
212200200610     C*****************************************************************
212300200610     C**                                                              *
212400200610     C**   DISP   SR  Accumulate details for screen display           *
212500200610     C**                                                              *
212600200610     C**   Called by  SETUP, ROLLUP                                   *
212700200610     C**   Calls  SR  PROCES                                          *
212800200610     C**                                                              *
212900200610     C*****************************************************************
213000200610     C**
213100200610     C           DISP      BEGSR                           *** DISP ***
213200200610     C**
213300200610     C                     Z-ADD0         OUTREC  20
213400200610     C                     MOVE '0'       *IN89
213500200610     C                     MOVE *BLANKS   PCPOS                                               233736
213600200610     C**
213700200610     C**  IF STILL PROCESSING SFL RECS - GOTO S/R
213800200610     C**
213900200610     C           *IN51     IFEQ '1'
214000200610     C                     EXSR PROCES
214100200610     C           OUTREC    IFEQ 14
214200200610     C                     SETON                     89
214300200610     C                     END
214400200610     C                     EXSR R0455                                     159599
214500200610     C**                                                                  E31795
214600200610     C**   Accumulate details for a Security                              E31795
214700200610     C**                                                                  E31795
214800200610     C**********           ADD  CDNV      ZCUMCP                   E31795 159599
214900200610     C**********           ADD  CNPV      ZCUMCP                   E31795 159599
215000200610     C**********           ADD  CNSV      ZCUMCP                   E31795 159599
215100200610     C***********          SUB  CECN      ZCUMCP                    E31795E36865
215200200610     C********** BVTVDV    IFEQ 'T'                                E31795 159599
215300200610     C**********           ADD  CDNT      ZNOMP                    E31795 159599
215400200610     C**********           ADD  CDNT      ZZNOML                   E31795 159599
215500200610     C**********           ADD  SNPT      ZZNOML                   E31795 159599
215600200610     C**********           ADD  CDST      ZZNOML                   E31795 159599
215700200610     C**********           ADD  CDNV      ZZNOMU                   E31795 159599
215800200610     C**********           ADD  CNPV      ZZNOMU                   E31795 159599
215900200610     C**********           ADD  CNSV      ZZNOMU                   E31795 159599
216000200610     C**********           ADD  SNPT      ZZPUR                    E31795 159599
216100200610     C**********           ADD  CDST      ZZSAL                    E31795 159599
216200200610     C**********           ADD  SAPP      ZZAPP                    E31795 159599
216300200610     C**********           ADD  SAPS      ZZAPS                    E31795 159599
216400200610     C**********           ELSE                                    E31795 159599
216500200610     C**********           ADD  CDNV      ZNOMP                    E31795 159599
216600200610     C**********           ADD  CDNV      ZZNOML                   E31795 159599
216700200610     C**********           ADD  CNPV      ZZNOML                   E31795 159599
216800200610     C**********           ADD  CNSV      ZZNOML                   E31795 159599
216900200610     C**********           ADD  CDNT      ZZNOMU                   E31795 159599
217000200610     C**********           ADD  SNPT      ZZNOMU                   E31795 159599
217100200610     C**********           ADD  CDST      ZZNOMU                   E31795 159599
217200200610     C**********           ADD  CNPV      ZZPUR                    E31795 159599
217300200610     C**********           ADD  CNSV      ZZSAL                    E31795 159599
217400200610     C**********           ADD  SAPV      ZZAPP                    E31795 159599
217500200610     C**********           ADD  SPSV      ZZAPS                    E31795 159599
217600200610     C**********           END                                     E31795 159599
217700200610     C                     END
217800200610     C**
217900200610     C**  IF STILL PROCESSING SFL TOTAL RECS - GOTO S/R
218000200610     C**
218100200610     C           *IN59     IFEQ '1'
218200200610     C                     EXSR TOTAL
218300200610     C           OUTREC    IFEQ 14
218400200610     C                     SETON                     89
218500200610     C                     END
218600200610     C                     END
218700200610     C**
218800200610     C           *IN89     DOWEQ'0'
218900200610     C           *IN51     ANDEQ'0'
219000200610     C           *IN59     ANDEQ'0'
219100200610     C**
219200200610     C           *IN81     IFEQ '0'
219300200610     C                     SETOF                     3536
219400200610     C**********           READ CDEPP                    81                                   233736
219500200610     C                     READ CDEPF                    81                                   233736
219600200610     C**********           MOVE CDMK      NXTMK                    E37290 159599
219700200610     C**********           MOVE CDSN      NXTSN                    E37290 159599
219800200610     C**********           Z-ADDCDPT      NXTDP                    E37290 159599
219900200610     C                     END
220000200610     C**
220100200610     C**  End of File - If some records accumulated then write last one
220200200610     C**
220300200610     C           *IN81     IFEQ '1'
220400200610     C                     SETON                       89
220500200610     C           *IN50     IFEQ '1'
220600200610     C                     EXSR PROCES
220700200610     C           OUTREC    IFEQ 14
220800200610     C                     SETON                     89
220900200610     C                     GOTO EDLOOP
221000200610     C                     END
221100200610     C                     END
221200200610     C           *IN60     IFEQ '1'
221300200610     C                     EXSR TOTAL
221400200610     C           OUTREC    IFEQ 14
221500200610     C                     SETON                     89
221600200610     C                     GOTO EDLOOP
221700200610     C                     END
221800200610     C           *IN59     IFEQ '0'
221900200610     C                     MOVE '1'       *IN05
222000200610     C                     END
222100200610     C                     END
222200200610     C                     END
222300200610     C**
222400200610     C**  Successful file read of an active record
222500200610     C**
222600200610     C           *IN81     IFEQ '0'
222700200610     C           RECI      IFEQ 'D'
222800200610     C*                                                                   073603
222900200610     C**  If trade/value date basis = T AND nomin trade dt basis   = 0    073603
223000200610     C**                                AND sum nom purch trade dt = 0    073603
223100200610     C**                                AND sum nom sale  trade dt = 0    073603
223200200610     C**  or trade/value date basis = V AND nomin value dt basis   = 0    073603
223300200610     C**                                AND sum nom purch value dt = 0    073603
223400200610     C**                                AND sum nom sale  value dt = 0    073603
223500200610     C**    By-pass the record                                            073603
223600200610     C*                                                                   073603
223700200610     C                     MOVE '0'       *IN70                           073603
223800200610     C*                                                                   073603
223900200610     C           BVTVDV    IFEQ 'T'                                       073603
224000200610     C           CDNT      IFNE *ZEROS                                    073603
224100200610     C           SNPT      ORNE *ZEROS                                    073603
224200200610     C           CDST      ORNE *ZEROS                                    073603
224300200610     C                     MOVE '1'       *IN70                           073603
224400200610     C                     END                                            073603
224500200610     C                     ELSE                                           073603
224600200610     C           CDNV      IFNE *ZEROS                                    073603
224700200610     C           CNPV      ORNE *ZEROS                                    073603
224800200610     C           CNSV      ORNE *ZEROS                                    073603
224900200610     C                     MOVE '1'       *IN70                           073603
225000200610     C                     END                                            073603
225100200610     C                     END                                            073603
225200200610     C**                                                                  073603
225300200610     C           *IN70     IFEQ '1'                                       073603
225400200610     C**
225500200610     C**  Store market if first record
225600200610     C**
225700200610     C           SAVM      IFEQ *BLANKS
225800200610     C                     MOVE CDMK      SAVM
225900200610     C                     END
226000200610     C**
226100200610     C**  If not correct branch/cust & there have been recs for the
226200200610     C**  required branch/cust then output the last one
226300200610     C**
226400200610     C***********SAVBR     IFNE CDBR                                      S01117
226500200610     C***********PCUST     ORNE CDCN                                      S01117
226600200610     C           SAVBR     IFNE CDPA                                      S01117
226700200610     C           @PCUST    ORNE @CDCN                                     S01117
226800200610     C                     SETON                     8189
226900200610     C**
227000200610     C           *IN50     IFEQ '1'
227100200610     C***********          ADD  1         OUTREC                   088303 092199
227200200610     C***********          ADD  1         SFLREC                   088303 092199
227300200610     C                     EXSR PROCES
227400200610     C           OUTREC    IFEQ 14
227500200610     C                     SETON                     89
227600200610     C                     GOTO EDLOOP
227700200610     C                     END
227800200610     C                     END
227900200610     C           *IN60     IFEQ '1'
228000200610     C                     EXSR TOTAL
228100200610     C           OUTREC    IFEQ 14
228200200610     C                     SETON                     89
228300200610     C                     GOTO EDLOOP
228400200610     C                     END
228500200610     C           *IN59     IFEQ '0'
228600200610     C                     MOVE '1'       *IN05
228700200610     C                     END
228800200610     C                     END
228900200610     C**
229000200610     C                     ELSE
229100200610     C**
229200200610     C**   If the required Branch/cust and a new Security
229300200610     C**   and if not the first Security for this Depot
229400200610     C**   then output the previous Security Details
229500200610     C**
229600200610     C           SAVSEC    IFNE CDSN
229700200610     C           SAVSEC    IFNE *BLANKS
229800200610     C                     EXSR PROCES
229900200610     C           OUTREC    IFEQ 14
230000200610     C                     SETON                     89
230100200610     C                     GOTO EDLOOP
230200200610     C                     END
230300200610     C                     END
230400200610     C                     END
230500200610     C                     EXSR R0455                                     159599
230600200610     C**
230700200610     C**   Accumulate details for a Security
230800200610     C**
230900200610     C********** TROLL     IFNE 'Y'                                088303 159599
231000200610     C**********           ADD  CDNV      ZCUMCP                          159599
231100200610     C**********           ADD  CNPV      ZCUMCP                          159599
231200200610     C**********           ADD  CNSV      ZCUMCP                          159599
231300200610     C***********          SUB  CECN      ZCUMCP                          E36865
231400200610     C***********TVVL      IFEQ 'T'                                       S01117
231500200610     C********** BVTVDV    IFEQ 'T'                                S01117 159599
231600200610     C**********           ADD  CDNT      ZNOMP                           159599
231700200610     C**********           ADD  CDNT      ZZNOML                          159599
231800200610     C**********           ADD  SNPT      ZZNOML                          159599
231900200610     C**********           ADD  CDST      ZZNOML                          159599
232000200610     C**********           ADD  CDNV      ZZNOMU                          159599
232100200610     C**********           ADD  CNPV      ZZNOMU                          159599
232200200610     C**********           ADD  CNSV      ZZNOMU                          159599
232300200610     C**********           ADD  SNPT      ZZPUR                           159599
232400200610     C**********           ADD  CDST      ZZSAL                           159599
232500200610     C**********           ADD  SAPP      ZZAPP                           159599
232600200610     C**********           ADD  SAPS      ZZAPS                           159599
232700200610     C**********           ELSE                                           159599
232800200610     C**********           ADD  CDNV      ZNOMP                           159599
232900200610     C**********           ADD  CDNV      ZZNOML                          159599
233000200610     C**********           ADD  CNPV      ZZNOML                          159599
233100200610     C**********           ADD  CNSV      ZZNOML                          159599
233200200610     C**********           ADD  CDNT      ZZNOMU                          159599
233300200610     C**********           ADD  SNPT      ZZNOMU                          159599
233400200610     C**********           ADD  CDST      ZZNOMU                          159599
233500200610     C**********           ADD  CNPV      ZZPUR                           159599
233600200610     C**********           ADD  CNSV      ZZSAL                           159599
233700200610     C**********           ADD  SAPV      ZZAPP                           159599
233800200610     C**********           ADD  SPSV      ZZAPS                           159599
233900200610     C**********           END                                            159599
234000200610     C**********           END                                     088303 159599
234100200610     C**********           MOVE 'N'       TROLL   1                088303 159599
234200200610     C                     MOVE '1'       *IN50
234300200610     C           SAVSEC    IFEQ *BLANKS
234400200610     C                     MOVE CDSN      SAVSEC
234500200610     C                     END
234600200610     C**
234700200610     C                     END                                            073603
234800200610     C**                                                                  073603
234900200610     C                     END
235000200610     C**
235100200610     C                     END
235200200610     C                     END
235300200610     C                     END
235400200610     C**
235500200610     C**    Condition Display of message if no details for branch/cust
235600200610     C**
235700200610     C           EDLOOP    TAG                             ** EDLOOP    **
235800200610      *                                                                   E20158
235900200610     C           *IN51     IFEQ '0'                                       E20158
236000200610     C           *IN60     ANDEQ'0'                                       E20158
236100200610     C                     SETON                     05                   E20158
236200200610     C                     END                                            E20158
236300200610      *                                                                   E20158
236400200610     C           SFLREC    IFEQ 0
236500200610     C                     MOVE '1'       *IN04
236600200610     C                     ELSE
236700200610     C                     MOVE '0'       *IN03
236800200610     C                     END
236900200610     C                     Z-ADDSFLREC    TOP
237000200610     C**
237100200610     C                     ENDSR
237200200610     C**
237300200610     C*****************************************************************
237400200610      /EJECT
2375002006100738 C*****************************************************************
237600200610     C**                                                              *
237700200610     C**   PROCES SR  Process the details for a security              *
237800200610     C**                                                              *
237900200610     C**   Called by  DISP                                            *
238000200610     C**   Calls  SR  RETSR,SUBFIL                                    *
238100200610     C**              P002                                            *   S01496
238200200610     C**                                                              *
238300200610     C*****************************************************************
238400200610     C**
238500200610     C           PROCES    BEGSR                           ** PROCES **
238600200610     C*                                                                   073603
238700200610     C**  If position is 0, do not display the security                   073603
238800200610     C*                                                                   073603
238900200610     C           ZZNOML    IFEQ 0                                         073603
239000200610     C           ZZNOMU    ANDEQ0                                         067645
239100200610     C                     MOVE CDSN      SAVSEC                          073603
239200200610     C                     MOVE CDPA      SAVBR                           073603
239300200610     C                     MOVE CDMK      SAVM                            073603
239400200610     C                     Z-ADD*ZEROS    ZZNOML                          073603
239500200610     C                     Z-ADD*ZEROS    ZZNOMU                          073603
239600200610     C                     Z-ADD*ZEROS    ZZPUR                           073603
239700200610     C                     Z-ADD*ZEROS    ZZSAL                           073603
239800200610     C                     Z-ADD*ZEROS    ZZAPP                           073603
239900200610     C                     Z-ADD*ZEROS    ZZAPS                           073603
240000200610     C                     Z-ADD*ZEROS    ZNOMP                           073603
240100200610     C                     Z-ADD*ZEROS    ZCUMCP                          073603
240200200610     C                     GOTO ENDPRO                                    073603
240300200610     C                     END                                            073603
240400200610     C**
240500200610     C**  Determine next type of SFL line required
240600200610     C**
240700200610     C           *IN51     IFEQ '0'
240800200610     C                     Z-ADD1         SFLT    20
240900200610     C                     MOVE '0'       *IN50
241000200610     C                     MOVE '1'       *IN51
241100200610     C                     MOVE '1'       *IN60
241200200610     C                     END
241300200610     C*                                                                   S01155
241400200610     C                     MOVE *BLANKS   TRRECI                          S01155
241500200610     C**
241600200610     C**  Process required line
241700200610     C**
241800200610     C           PRTOP     TAG                             *** PRTOP   **
241900200610     C**
242000200610     C** First line -
242100200610     C** Ouput blank line unless 1st for screen
242200200610     C**
242300200610     C           SFLT      IFEQ 1
242400200610     C           OUTREC    ANDEQ0
242500200610     C/COPY WNCPYSRC,SE0215C020
242600200610     C                     ADD  1         SFLT
242700200610     C                     END
242800200610     C**
242900200610     C** First security line -
243000200610     C** Access security & investment type records
243100200610     C**
243200200610     C           SFLT      IFEQ 2
243300200610     C           SAVSEC    CHAINSECTY                25
243400200610     C  N25      RECI      COMP '*'                      25
243500200610     C**
243600200610     C**  If no record found  or deleted record
243700200610     C**  then it is a database error so return to calling
243800200610     C**  program with a return code of '0'
243900200610     C**
244000200610     C           *IN25     IFEQ '1'
244100200610     C                     MOVELPROGRM    DBPGM
244200200610     C                     MOVELSAVSEC    DBKEY            ***************
244300200610     C                     MOVE 'SECTY'   DBFILE           * DB ERROR 06 *
244400200610     C                     Z-ADD06        DBASE            ***************
244500200610     C                     SETON                       U7U8
244600200610     C                     EXSR *PSSR                                     S01117
244700200610     C                     MOVE '0'       RTNC
244800200610     C                     EXSR RETSR
244900200610     C                     ELSE                                           S01496
245000200610     C*                                                                   S01496
245100200610     C           S01496    IFEQ 'Y'                                       S01496
245200200610     C           CSE007    OREQ 'Y'                                       CSE007
245300200610     C           CEU017    OREQ 'Y'                                       CEU017
245400200610     C                     EXSR P002                                      S01496
245500200610     C                     END                                            S01496
245600200610     C*                                                                   S01496
245700200610     C                     END
245800200610     C**
245900200610     C** If security is traded on an Australian yield basis,              S01232
246000200610     C** set indicator                                                    S01232
246100200610     C**                                                                  S01232
246200200610     C           STBS      IFEQ 'Y'                                       S01232
246300200610     C           SYBS      ANDEQ'AU'                                      S01232
246400200610     C                     SETON                     52                   S01232
246500200610     C                     ELSE                                           S01232
246600200610     C                     SETOF                     52                   S01232
246700200610     C                     END                                            S01232
246800200610     C**
246900200610     C           KEYI      CHAININVTP                25
247000200610     C  N25      RECI      COMP 'D'                  2525
247100200610     C**
247200200610     C**  If no record found  or deleted record
247300200610     C**  then it is a database error so return to calling
247400200610     C**  program with a return code of '0'
247500200610     C**
247600200610     C           *IN25     IFEQ '1'
247700200610     C                     MOVELPROGRM    DBPGM
247800200610     C                     MOVELIKEY      DBKEY            ***************
247900200610     C                     MOVE 'INVTY'   DBFILE           * DB ERROR 12 *
248000200610     C                     Z-ADD12        DBASE            ***************
248100200610     C                     SETON                       U7U8
248200200610     C                     EXSR *PSSR                                     S01117
248300200610     C                     MOVE '0'       RTNC
248400200610     C                     EXSR RETSR
248500200610     C                     END
248600200610     C                     END
248700200610     C*                                                                   E39495
248800200610     C** Set up input parameters to sr. ZRATE                             E39495
248900200610     C*                                                                   E39495
249000200610     C                     MOVE PPDI      ZPPDI                           E39495
249100200610     C                     Z-ADDSFPP      ZSFPP                           E39495
249200200610     C                     Z-ADDCPNR      ZCPNR                           E39495
249300200610     C                     Z-ADDCFCT      ZCFCT                           E39495
249400200610     C                     Z-ADD*ZEROS    ZPPCP                           E39495
249500200610     C                     MOVE CPDP      ZPPCP                           E39495
249600200610     C                     MOVE PROT      ZPROT                           E39495
249700200610     C**
249800200610     C**  Third security line -
249900200610     C**  See if this line is required-
250000200610     C**
250100200610     C           SFLT      IFEQ 4
250200200610      *                                                                                       233736
250300200610      ** Compute for the average fiscal price of all portfolios:                              233736
250400200610      ** total average fiscal price numerator / total nominal position                        233736
250500200610      *                                                                                       233736
250600200610     C                     Z-ADD0         WAVFP  158                                          233736
250700200610     C           WCSNV     IFNE *ZERO                                                         233736
250800200610     C           WCSAV     DIV  WCSNV     WAVFP     H                                         233736
250900200610     C           SPBS      IFEQ 'P'                                                           233736
251000200610     C                     MULT 100       WAVFP                                               233736
251100200610     C                     ENDIF                                                              233736
251200200610      *                                                                                       233736
251300200610     C                     CALL 'AOCURRR0'                                                    233736
251400200610     C                     PARM '*DBERR'  @RTCD                                               233736
251500200610     C                     PARM '*KEY   ' @OPTN                                               233736
251600200610     C                     PARM NMCY      @AJCD                                               233736
251700200610     C           SDCURR    PARM SDCURR    DSSDY                                               233736
251800200610      *                                                                                       233736
251900200610      ** Format calculated average fiscal price                                               233736
252000200610      *                                                                                       233736
252100200610     C           5         ADD  A6NBDP    DC                                                  233736
252200200610     C                     SUB  NMDP      DC                                                  233736
252300200610     C           WAVFP     DIV  POWER8,DC WAVFP                                               233736
252400200610     C                     ENDIF                                                              233736
252500200610      *                                                                                       233736
252600200610     C           PROT      IFEQ '1'
252700200610     C           PROT      OREQ '5'
252800200610     C           PROT      OREQ '6'
252900200610     C           PROT      OREQ '8'
253000200610     C           PROT      OREQ '9'                                       S01176
253100200610     C           SETX      OREQ 'Y'                                                           233736
253200200610      *                                                                                       233736
253300200610      ** Display only if there is an accrued interest or                                      233736
253400200610      ** average fiscal price is not zero for securities                                      233736
253500200610      ** which are subject to EU tax                                                          233736
253600200610      *                                                                                       233736
253700200610     C           DYBS      IFNE '4'
253800200610     C           STBS      ANDNE'D'                                       E38110
253900200610     C           CPNR      ANDNE0                                         E38094
254000200610     C           WAVFP     ORNE 0                                                             233736
254100200610     C                     ELSE
254200200610     C                     ADD  1         SFLT
254300200610     C                     END
254400200610     C                     ELSE
254500200610     C           PROT      IFEQ '3'
254600200610     C           DYBS      ANDNE'4'
254700200610     C           STBS      ANDNE'D'                                       E38110
254800200610     C           CPNR      ANDNE0
254900200610     C           WAVFP     ORNE 0                                                             233736
255000200610     C                     ELSE
255100200610     C                     ADD  1         SFLT
255200200610     C                     END
255300200610     C                     END
255400200610     C                     END
255500200610     C**
255600200610     C** If all security lines processed see if future value trades req'd
255700200610     C**
255800200610     C           SFLT      IFGE 5
255900200610     C***********TVVL      IFEQ 'V'                                       S01117
256000200610     C           BVTVDV    IFEQ 'V'                                       S01117
256100200610     C           ZZNOML    ANDNEZZNOMU
256200200610     C                     ELSE
256300200610     C                     SETOF                     51
256400200610     C                     GOTO PEND
256500200610     C                     END
256600200610     C                     END
256700200610     C**
256800200610     C** SETGT on trades file
256900200610     C**
257000200610     C           SFLT      IFEQ 5
257100200610     C           KEYT      SETGTTRADSDF              25
257200200610     C           *IN25     IFEQ '1'
257300200610     C                     SETOF                     51
257400200610     C                     GOTO PEND
257500200610     C                     ELSE
257600200610     C           KEYTE     READETRADSDF                  25
257700200610     C           *IN25     IFEQ '1'
257800200610     C                     SETOF                     51
257900200610     C                     GOTO PEND
258000200610     C                     END
258100200610     C                     END
258200200610     C                     END
258300200610     C**
258400200610     C** If trade line req'd  - get next trade record
258500200610     C**
258600200610     C           SFLT      IFGT 6
258700200610     C           KEYTE     READETRADSDF                  25
258800200610     C           *IN25     IFEQ '1'
258900200610     C                     SETOF                     51
259000200610     C                     GOTO PEND
259100200610     C                     END
259200200610     C                     END
259300200610      *                                                                   159599
259400200610     C           ZZNOML    IFEQ 0                                         159599
259500200610     C           ZZNOMU    ANDEQ0                                         159599
259600200610     C                     MOVE '0'       *IN51                           159599
259700200610     C                     GOTO PEND                                      159599
259800200610     C                     ENDIF                                          159599
259900200610     C**
260000200610     C** Data accessed - fill SFL line & output to SFL
260100200610     C**
260200200610     C***********RECI      IFNE '*'                                       S01155
260300200610     C***********RECI      ANDNE'C'                                       S01155
260400200610     C           SFLT      IFLE 4                                         S01158
260500200610     C                     EXSR SUBFIL                                    S01158
260600200610     C                     ELSE                                           S01158
260700200610     C           TRRECI    IFNE '*'                                       S01155
260800200610     C           TRRECI    ANDNE'C'                                       S01155
260900200610     C           TRRECI    ANDNE'R'                                       S01269
261000200610     C                     EXSR SUBFIL
261100200610     C                     END                                            S01158
261200200610     C                     END                                            S01158
261300200610     C                     ADD  1         SFLT
261400200610     C***********          END                                            S01158
261500200610     C**
261600200610     C           OUTREC    IFLT 14
261700200610     C                     GOTO PRTOP
261800200610     C                     END
261900200610     C**
262000200610     C**  If all lines processed - reset indicators & save new field
262100200610     C**
262200200610     C           PEND      TAG                             ***  PEND  ***
262300200610     C/COPY WNCPYSRC,SE0215C006
262400200610     C**
262500200610     C           *IN51     IFEQ '0'
262600200610     C                     MOVE CDSN      SAVSEC
262700200610     C***********          MOVE CDBR      SAVBR                           S01117
262800200610     C                     MOVE CDPA      SAVBR                           S01117
262900200610     C                     MOVE CDMK      SAVM
263000200610     C                     Z-ADD*ZEROS    ZZNOML
263100200610     C***********          Z-ADD*ZEROS    ZNOMP                           E15850
263200200610     C                     Z-ADD*ZEROS    ZZNOMU
263300200610     C                     Z-ADD*ZEROS    ZZPUR
263400200610     C                     Z-ADD*ZEROS    ZZSAL
263500200610     C                     Z-ADD*ZEROS    ZZAPP
263600200610     C                     Z-ADD*ZEROS    ZZAPS
263700200610     C                     Z-ADD*ZEROS    ZNOMP
263800200610     C                     Z-ADD*ZEROS    ZCUMCP                          E15850
263900200610     C                     END
264000200610     C*                                                                   073603
264100200610     C** Tag for non display security                                     073603
264200200610     C*                                                                   073603
264300200610     C           ENDPRO    TAG                                            073603
264400200610     C**
264500200610     C                     ENDSR
264600200610     C**
264700200610     C*****************************************************************
264800200610      /EJECT
2649002006100738 C*****************************************************************
265000200610     C**                                                              *
265100200610     C**   TOTAL  SR  Process the totals for a customer               *
265200200610     C**                                                              *
265300200610     C**   Called by  DISP                                            *
265400200610     C**   Calls  SR  RETSR,SUBFIL                                    *
265500200610     C**                                                              *
265600200610     C*****************************************************************
265700200610     C**
265800200610     C           TOTAL     BEGSR                           ** TOTAL  **
265900200610     C**
266000200610     C**  Determine next type of SFL line required
266100200610     C**
266200200610     C           *IN59     IFEQ '0'
266300200610     C           *IN60     OREQ '1'                                       159599
266400200610     C           *IN81     ANDEQ'1'                                       159599
266500200610     C                     Z-ADD1         SFLT    20
266600200610     C                     MOVE '0'       *IN50
266700200610     C                     MOVE '1'       *IN59
266800200610     C                     MOVE '0'       *IN60
266900200610     C                     END
267000200610     C**
267100200610     C**  Process required line
267200200610     C**
267300200610     C           TTTOP     TAG                             *** TTTOP   **
267400200610     C**
267500200610     C** First line -
267600200610     C** Ouput blank line unless 1st for screen
267700200610     C**
267800200610     C/COPY WNCPYSRC,SE0215C021
267900200610     C           SFLT      IFEQ 1
268000200610     C           OUTREC    ANDEQ0
268100200610     C                     ADD  1         SFLT
268200200610     C                     END
268300200610     C/COPY WNCPYSRC,SE0215C022
268400200610     C**
268500200610     C** Data accessed - fill SFL line & output to SFL
268600200610     C**
268700200610     C                     EXSR TOTFIL
268800200610     C                     ADD  1         SFLT
268900200610     C           OUTREC    IFLT 14
269000200610     C           SFLT      ANDLT4
269100200610     C                     GOTO TTTOP
269200200610     C                     END
269300200610     C**********           SETOF                     59                   159599
269400200610     C           OUTREC    IFEQ 14                                        159599
269500200610     C           SFLT      ANDLT4                                         159599
269600200610     C                     MOVE '1'       *IN60                           159599
269700200610     C                     ELSE                                           159599
269800200610     C                     MOVE '0'       *IN59                           159599
269900200610     C                     MOVE '0'       *IN60                           159599
270000200610     C                     ENDIF                                          159599
270100200610     C**
270200200610     C**  If all lines processed - reset ACCUMULATORS                  s
270300200610     C**
270400200610     C           *IN59     IFEQ '0'
270500200610     C                     Z-ADD*ZEROS    TOTBVP
270600200610     C                     Z-ADD*ZEROS    TOTMVP
270700200610     C                     END
270800200610     C**
270900200610     C                     ENDSR
271000200610     C**
2711002006100738 C*****************************************************************
271200200610      /EJECT
2713002006100738 C*****************************************************************
271400200610     C**                                                              *
271500200610     C**   TOTFIL SR  Write details to Subfile                        *
271600200610     C**                                                              *
271700200610     C**   Called by  TOTAL                                           *
271800200610     C**   Calls  SR  RETSR,ZSEDIT                                    *
271900200610     C**                                                              *
272000200610     C*****************************************************************
272100200610     C**
272200200610     C           TOTFIL    BEGSR                           ** TOTFIL **
272300200610     C**
272400200610     C**  TOTFIL - fills one line of the SFL depending on the setting
272500200610     C**           of SFLT
272600200610     C**
272700200610     C**  SFLT=1 Blank line required
272800200610     C**
272900200610     C           SFLT      IFEQ 1
273000200610     C                     MOVE *BLANKS   SLINE
273100200610      *                                                                   CGL011
273200200610      ** If CGL011 is installed, check if client holding is blocked.      CGL011
273300200610      *                                                                   CGL011
273400200610     C           CGL011    IFEQ 'Y'                                       CGL011
273500200610     C                     MOVE 'N'       WBLKI   1                       CGL011
273600200610     C                     MOVE *OFF      *IN63                           CGL011
273700200610      *                                                                                       CGL014
273800200610      ** If CGL014 is on, display 'Collateral' narrative to actual blocked                    CGL014
273900200610      ** security positions with sequence 00001 or 00002 (SEBLKPL7).                          CGL014
274000200610      *                                                                                       CGL014
274100200610     C           CGL014    IFEQ 'Y'                                                           CGL014
274200200610     C           KEYVD     SETLLSEBLKPL7                                                      CGL014
274300200610     C                     ELSE                                                               CGL014
274400200610     C           KEYVD     SETLLSEBLKPL6                                  CGL011
274500200610     C                     ENDIF                                                              CGL014
274600200610      *                                                                                       CGL014
274700200610     C           WBLKI     DOWEQ'N'                                       CGL011
274800200610     C           *IN63     ANDEQ*OFF                                      CGL011
274900200610      *                                                                                       CGL014
275000200610     C           CGL014    IFEQ 'Y'                                                           CGL014
275100200610     C           KEYVD     READESEBLKPL7                 63                                   CGL014
275200200610     C                     ELSE                                                               CGL014
275300200610     C           KEYVD     READESEBLKPL6                 63               CGL011
275400200610     C                     ENDIF                                                              CGL014
275500200610      *                                                                   CGL011
275600200610      ** Display Collateral text if block exists, whether General         CGL011
275700200610      ** Block on the Security or Specific Block on the Customer.         CGL011
275800200610      *                                                                   CGL011
275900200610     C           *IN63     IFEQ *OFF                                      CGL011
276000200610     C           VDCNUM    ANDEQPCUST                                     CGL011
276100200610     C           *IN63     OREQ *OFF                                      CGL011
276200200610     C********** VDCNUM    ANDEQ*ZERO                                                  CGL011 CSD027
276300200610     C           VDCNUM    ANDEQ*BLANKS                                                       CSD027
276400200610     C                     MOVE 'Y'       WBLKI                           CGL011
276500200610     C                     MOVELCOLLA     SLINE                           CGL011
276600200610     C                     ELSE                                           CGL011
276700200610     C                     MOVE *BLANKS   SLINE                           CGL011
276800200610     C                     ENDIF                                          CGL011
276900200610     C                     ENDDO                                          CGL011
277000200610     C                     ENDIF                                          CGL011
277100200610      *                                                                   CGL011
277200200610      *                                                                                       CGL014
277300200610      ** If CGL014 is installed, check if client holding is blocked.                          CGL014
277400200610      *                                                                                       CGL014
277500200610     C           CGL014    IFEQ 'Y'                                                           CGL014
277600200610     C                     MOVE 'N'       WBLKI   1                                           CGL014
277700200610     C                     MOVE *OFF      *IN64                                               CGL014
277800200610     C           KEYVD     SETLLSEBLKPL7                                                      CGL014
277900200610     C           WBLKI     DOWEQ'N'                                                           CGL014
278000200610     C           *IN64     ANDEQ*OFF                                                          CGL014
278100200610     C           KEYVD     READESEBLKPL7                 64                                   CGL014
278200200610      *                                                                                       CGL014
278300200610      ** Display Collateral text if block exists, whether General                             CGL014
278400200610      ** Block on the Security or Specific Block on the Customer.                             CGL014
278500200610      *                                                                                       CGL014
278600200610     C           *IN64     IFEQ *OFF                                                          CGL014
278700200610     C           VDCNUM    ANDEQPCUST                                                         CGL014
278800200610     C           *IN64     OREQ *OFF                                                          CGL014
278900200610     C********** VDCNUM    ANDEQ*ZERO                                                  CGL014 CSD027
279000200610     C           VDCNUM    ANDEQ*BLANKS                                                       CSD027
279100200610     C                     MOVE 'Y'       WBLKI                                               CGL014
279200200610     C                     MOVELCOLLA     SLINE                                               CGL014
279300200610     C                     ELSE                                                               CGL014
279400200610     C                     MOVE *BLANKS   SLINE                                               CGL014
279500200610     C                     ENDIF                                                              CGL014
279600200610     C                     ENDDO                                                              CGL014
279700200610     C                     ENDIF                                                              CGL014
279800200610      *                                                                                       CGL014
279900200610     C                     SETON                     08
280000200610     C                     END
280100200610     C**
280200200610     C**  SFLT=2 FIRST TOTAL LINE
280300200610     C**
280400200610     C           SFLT      IFEQ 2
280500200610     C                     SETON                     08
280600200610     C**
280700200610     C**   Format book valuation - portfolio
280800200610     C**
280900200610     C                     Z-ADDPCCDP     ZDECS   10
281000200610     C                     MOVE 'L'       ZECODE
281100200610     C                     MOVE TOTBVP    ZFLD15
281200200610     C                     EXSR ZSEDIT
281300200610     C                     MOVE ZOUT21    STBVP
281400200610     C***********          EXSR ADJUST                                    S01176
281500200610     C***********          MOVE WORKAD    STBVPA                          S01176
281600200610     C***********STBVPA    IFEQ *BLANKS                                   S01176
281700200610     C***********          MOVE *BLANKS   STBVP                           S01176
281800200610     C***********          END                                            S01176
281900200610     C**
282000200610     C**   Format market valuation - portfolio
282100200610     C**
282200200610     C                     Z-ADDPCCDP     ZDECS   10
282300200610     C                     MOVE 'L'       ZECODE
282400200610     C                     MOVE TOTMVP    ZFLD15
282500200610     C                     EXSR ZSEDIT
282600200610     C                     MOVE ZOUT21    STMVP
282700200610     C***********          EXSR ADJUST                                    E16894
282800200610     C***********          MOVE WORKAD    STMVPA                          E16894
282900200610     C***********STMVPA    IFEQ *BLANKS                                   E16894
283000200610     C***********          MOVE *BLANKS   STMVP                           E16894
283100200610     C***********          END                                            E16894
283200200610     C**
283300200610     C                     MOVE TOTL1     SLINE
283400200610     C                     END
283500200610     C**
283600200610     C**  SFLT=3 2ND TOTAL LINE
283700200610     C**
283800200610     C           SFLT      IFEQ 3
283900200610     C                     SETON                     08
284000200610     C**
284100200610     C**   Format TOTAL
284200200610     C**
284300200610     C                     Z-ADDPCCDP     ZDECS   10
284400200610     C                     MOVE 'L'       ZECODE
284500200610     C           TOTMVP    SUB  TOTBVP    TOTMVP
284600200610     C                     MOVE TOTMVP    ZFLD15
284700200610     C                     EXSR ZSEDIT
284800200610     C                     MOVE ZOUT21    STTOT
284900200610     C***********          EXSR ADJUST                                    S01176
285000200610     C***********          MOVE WORKAD    STTOTA                          S01176
285100200610     C***********STTOTA    IFEQ *BLANKS                                   S01176
285200200610     C***********          MOVE *BLANKS   STTOT                           S01176
285300200610     C***********          END                                            S01176
285400200610     C**
285500200610     C**  DETERMINE IF PROFIT OR LOSS
285600200610     C**
285700200610     C           TOTMVP    IFGE 0
285800200610     C                     MOVE 'PROFIT'  TL5
285900200610     C                     ELSE
286000200610     C                     MOVE 'LOSS  '  TL5
286100200610     C                     END
286200200610     C**
286300200610     C                     MOVE TOTL2     SLINE
286400200610     C                     END
286500200610     C**
286600200610     C**   And output details to subfile
286700200610     C**
286800200610     C                     ADD  1         SFLREC
286900200610     C/COPY WNCPYSRC,SE0215C023
287000200610     C                     ADD  1         OUTREC
287100200610     C/COPY WNCPYSRC,SE0215C024
287200200610     C                     WRITESE0215S0
287300200610     C/COPY WNCPYSRC,SE0215C025
287400200610     C**
287500200610     C                     ENDSR
287600200610     C**
287700200610     C*****************************************************************
287800200610      /EJECT
2879002006100738 C*****************************************************************
288000200610     C**                                                              *
288100200610     C**   CSPRC  SR  Calculate book price                            *
288200200610     C**                                                              *
288300200610     C**   Called by  SUBFIL                                          *
288400200610     C**   Calls  SR  OLCAP                                           *
288500200610     C**                                                              *
288600200610     C*****************************************************************
288700200610     C**
288800200610     C           CSPRC     BEGSR                           ** CSPRC  **
288900200610     C**
289000200610     C**  B/V ind is set to BLANK by default
289100200610     C**
289200200610     C                     MOVE ' '       SBVI
289300200610     C                     Z-ADD0         BKPR   158
289400200610     C                     Z-ADD0         ZZAPW
289500200610     C**
289600200610     C** Access 1st price for sec,br,mkt,book,price type
289700200610     C**
289800200610     C***********TVVL      IFEQ 'T'                                       S01117
289900200610     C           BVTVDV    IFEQ 'T'                                       S01117
290000200610     C                     MOVE 'CT'      PPRT
290100200610     C                     ELSE
290200200610     C                     MOVE 'CV'      PPRT
290300200610     C                     END
290400200610     C***********KEYP      SETLLPRICS                    25               E14057
290500200610     C           KEYP      SETLLPRICR                    25               E14057
290600200610     C           *IN25     IFEQ '1'
290700200610     C***********KEYP      READEPRICS                    25               E14057
290800200610     C           KEYP      READEPRICR                    25               E14057
290900200610     C           *IN25     IFEQ '0'
291000200610     C**
291100200610     C** If price found & value date is less than prev. run date
291200200610     C**  B/V ind is set to Y
291300200610     C**
291400200610     C           PVDT      IFLT PRUN
291500200610     C                     MOVE 'Y'       SBVI
291600200610     C**
291700200610     C**  If price found & value date equals prev. run date
291800200610     C**    Price will be used to override AP num COB field
291900200610     C**
292000200610     C                     ELSE
292100200610     C           PVDT      IFEQ PRUN
292200200610     C                     Z-ADDPPRC      ZZAPW
292300200610     C                     END
292400200610     C                     END
292500200610     C**
292600200610     C** If price found & value date = run date
292700200610     C**   price becomes the average price
292800200610     C**
292900200610     C           PVDT      IFEQ RUND
293000200610     C                     Z-ADDPPRC      BKPR
293100200610     C                     ELSE
293200200610     C**
293300200610     C**  If price found with value date less than prev run date
293400200610     C**  Access price file with date = run date
293500200610     C**  If found price becomes the average price
293600200610     C**
293700200610     C           PVDT      IFLT PRUN
293800200610     C***********KEYPD     CHAINPRICS                25                   E14057
293900200610     C           KEYPD     CHAINPRICR                25                   E14057
294000200610     C           *IN25     IFEQ '0'
294100200610     C                     Z-ADDPPRC      BKPR
294200200610     C                     ELSE
294300200610     C**
294400200610     C**  Otherwise -
294500200610     C**  Access price file with date = previous run date
294600200610     C**  If found price will be used to override AP num COB field
294700200610     C**
294800200610     C***********KEYPP     CHAINPRICS                25                   E14057
294900200610     C           KEYPP     CHAINPRICR                25                   E14057
295000200610     C           *IN25     IFEQ '0'
295100200610     C                     Z-ADDPPRC      ZZAPW
295200200610     C                     END
295300200610     C                     END
295400200610     C                     END
295500200610     C                     END
295600200610     C                     END
295700200610     C                     END
295800200610     C**
295900200610     C**  Calculate average price -
296000200610     C**    If price found with value date = run date, this is price
296100200610     C**
296200200610     C           BKPR      IFEQ 0
296300200610     C**
296400200610     C** Access CPOSND for cust/branch/sec -
296500200610     C**   If found & BV ind is Y, screen BV ind is set to Y
296600200610     C**
296700200610     C           KEYCP     CHAINCPOSN                25
296800200610     C           *IN25     IFEQ '0'
296900200610     C***********TVVL      IFEQ 'T'                                       S01117
297000200610     C           BVTVDV    IFEQ 'T'                                       S01117
297100200610     C           CSBT      ANDEQ'Y'
297200200610     C                     MOVE 'Y'       SBVI
297300200610     C                     ELSE
297400200610     C***********TVVL      IFEQ 'V'                                       S01117
297500200610     C           BVTVDV    IFEQ 'V'                                       S01117
297600200610     C           CSBV      ANDEQ'Y'
297700200610     C                     MOVE 'Y'       SBVI
297800200610     C                     END
297900200610     C                     END
298000200610     C**
298100200610     C**  If price found , value date = prev run date
298200200610     C**    Calculate override for sum of AP num COB +
298300200610     C**      price x nom posn COB on CPOSND
298400200610     C**
298500200610     C           ZZAPW     IFNE 0
298600200610     C***********TVVL      IFEQ 'T'                                       S01117
298700200610     C           BVTVDV    IFEQ 'T'                                       S01117
298800200610     C           CSNT      MULT ZZAPW     ZZAPC
298900200610     C                     ELSE
299000200610     C           CSNV      MULT ZZAPW     ZZAPC
299100200610     C                     END
299200200610     C                     ELSE
299300200610     C***********TVVL      IFEQ 'T'                                       S01117
299400200610     C           BVTVDV    IFEQ 'T'                                       S01117
299500200610     C                     Z-ADDCSPT      ZZAPC
299600200610     C                     ELSE
299700200610     C                     Z-ADDCSPV      ZZAPC
299800200610     C                     END
299900200610     C                     END
300000200610     C                     END
300100200610     C**
300200200610     C**  Calculate average price from OLCAP
300300200610     C**
300400200610     C                     EXSR OLCAP
300500200610     C                     END
300600200610     C**
300700200610     C                     ENDSR
300800200610     C**
300900200610     C*****************************************************************
301000200610      /EJECT
3011002006100738 C*****************************************************************
301200200610     C**                                                              *
301300200610     C**   OLCAP  SR  Calculate average price                         *
301400200610     C**                                                              *
301500200610     C**   Called by  CSPRC                                           *
301600200610     C**   Calls  SR  none                                            *
301700200610     C**                                                              *
301800200610     C*****************************************************************
301900200610     C**
302000200610     C           OLCAP     BEGSR
302100200610     C*
302200200610     C**  Calculate new NP = NP + sum nom purch - sum nom sales
302300200610     C*
302400200610     C           ZZPUR     ADD  ZZSAL     ZNNOMP
302500200610     C                     ADD  ZNOMP     ZNNOMP
302600200610     C**
302700200610     C** If NP & new NP both long -
302800200610     C**  AP = (AP num COB + AP num purch) / new NP
302900200610     C**
303000200610     C           ZNOMP     IFGT 0
303100200610     C           ZNNOMP    ANDGT0
303200200610     C           ZNNOMP    IFEQ 0
303300200610     C**********           Z-ADD0         BKPR                                                261507
303400200610     C                     Z-ADD0         BKPRR  238H                                         261507
303500200610     C                     ELSE
303600200610     C***********ZZAPC     ADD  ZZAPP     WBKPR  150                      E34849
303700200610     C***********WBKPR     DIV  ZNNOMP    BKPR      H                     E34849
303800200610     C           ZNOMP     ADD  ZZSAL     NBKPR  150                      E34849
303900200610     C           NBKPR     IFLT 0                                         177982
304000200610     C                     Z-ADDZZPUR     NBKPR                           177982
304100200610     C                     Z-ADDZZAPP     WBKPR                           177982
304200200610     C                     ELSE                                           177982
304300200610     C           ZZAPC     ADD  ZZAPS     WBKPR  150                      E34849
304400200610     C                     END                                            177982
304500200610     C********** WBKPR     DIV  NBKPR     BKPR      H                                  E34849 261507
304600200610     C           WBKPR     DIV  NBKPR     BKPRR     H                                         261507
304700200610     C                     END
304800200610     C                     END
304900200610     C**
305000200610     C** If NP & new NP both short -
305100200610     C**  AP = (AP num COB + AP num sales) / new NP
305200200610     C**  (ensure price field is positive)
305300200610     C**
305400200610     C           ZNOMP     IFLT 0
305500200610     C           ZNNOMP    ANDLT0
305600200610     C           ZNNOMP    IFEQ 0
305700200610     C**********           Z-ADD0         BKPR                                                261507
305800200610     C                     Z-ADD0         BKPRR                                               261507
305900200610     C                     ELSE
306000200610     C***********ZZAPC     ADD  ZZAPS     WBKPR                           E34849
306100200610     C***********WBKPR     DIV  ZNNOMP    BKPR      H                     E34849
306200200610     C           ZNOMP     ADD  ZZPUR     NBKPR                           E34849
306300200610     C           NBKPR     IFGT 0                                         177982
306400200610     C                     Z-ADDZZSAL     NBKPR                           177982
306500200610     C                     Z-ADDZZAPS     WBKPR                           177982
306600200610     C                     ELSE                                           177982
306700200610     C           ZZAPC     ADD  ZZAPP     WBKPR                           E34849
306800200610     C                     END                                            177982
306900200610     C********** WBKPR     DIV  NBKPR     BKPR      H                                  E34849 261507
307000200610     C********** BKPR      IFLT 0                                                             261507
307100200610     C********** BKPR      MULT -1        BKPR                                                261507
307200200610     C           WBKPR     DIV  NBKPR     BKPRR     H                                         261507
307300200610     C           BKPRR     IFLT 0                                                             261507
307400200610     C           BKPRR     MULT -1        BKPRR                                               261507
307500200610     C                     END
307600200610     C                     END
307700200610     C                     END
307800200610     C**
307900200610     C** If NP long or flat , new NP short -
308000200610     C**  AP = AP num sales / sum nom sales
308100200610     C**
308200200610     C           ZNOMP     IFGE 0
308300200610     C           ZNNOMP    ANDLT0
308400200610     C           ZZPUR     IFEQ 0
308500200610     C**********           Z-ADD0         BKPR                                                261507
308600200610     C                     Z-ADD0         BKPRR                                               261507
308700200610     C                     ELSE
308800200610     C********** ZZAPP     DIV  ZZPUR     BKPR      H                                         261507
308900200610     C           ZZAPP     DIV  ZZPUR     BKPRR     H                                         261507
309000200610     C                     END
309100200610     C                     END
309200200610     C**
309300200610     C** If NP short or flat , new NP long -
309400200610     C**  AP = AP num purch / sum nom purch
309500200610     C**
309600200610     C           ZNOMP     IFLE 0
309700200610     C           ZNNOMP    ANDGT0
309800200610     C           ZZSAL     IFEQ 0
309900200610     C**********           Z-ADD0         BKPR                                                261507
310000200610     C                     Z-ADD0         BKPRR                                               261507
310100200610     C                     ELSE
310200200610     C********** ZZAPS     DIV  ZZSAL     BKPR      H                                         261507
310300200610     C           ZZAPS     DIV  ZZSAL     BKPRR     H                                         261507
310400200610     C                     END
310500200610     C                     END
310600200610     C**
310700200610     C** If new NP flat -
310800200610     C**  AP = 0
310900200610     C**
311000200610     C           ZNNOMP    IFEQ 0
311100200610     C**********           Z-ADD0         BKPR                                                261507
311200200610     C                     Z-ADD0         BKPRR                                               261507
311300200610     C                     END
311400200610     C*                                                                   E19838
311500200610     C* If price basis 'P', multiply by 100 to fetch true price           E19838
311600200610     C*                                                                   E19838
311700200610     C           SPBS      IFEQ 'P'                                       E19838
311800200610     C**********           MULT 100       BKPR                                         E19838 261507
311900200610     C                     MULT 100       BKPRR                                               261507
312000200610     C                     END                                            E19838
312100200610     C*
312200200610     C* REFORMAT BOOK PRICE FROM NOMINAL CURRENCY DECIMAL PLACES (AS IT
312300200610     C*  WAS CALCULATED FROM SUM AP NUMERATOR) TO A STRAIGHT 15/8 PRICE
312400200610     C*
312500200610     C***********5         ADD  CDP       XY      10                      S01117
312600200610     C           5         ADD  A6NBDP    XY      10                      S01117
312700200610     C                     SUB  NMDP      XY
312800200610     C********** BKPR      DIV  POWER8,XY BKPR                                                261507
312900200610     C           BKPRR     DIV  POWER8,XY BKPR                                                261507
313000200610     C*
313100200610     C**If*price*basis*'P',*multiply*by*100*to*fetch*true*price********   E19838
313200200610     C***********                                                         E19838
313300200610     C********** SPBS      IFEQ 'P'                                       E19838
313400200610     C**********           MULT 100       BKPR                            E19838
313500200610     C**********           END                                            E19838
313600200610     C**
313700200610     C                     ENDSR
313800200610     C**
313900200610     C*****************************************************************
314000200610      /EJECT
314100200610     C*****************************************************************
314200200610     C*                                                               *
314300200610     C*    ZACRCI - STANDARD ROUTINE TO CALCULATE INTEREST            *
314400200610     C*             ON A CUSTOMER POSITION DURING INPUT CYCLE         *
314500200610     C*                                                               *
314600200610     C*  INPUT  - ZFDAT  (5,0)     FROM DATE (MIDAS DAY NO.)          *
314700200610     C*           ZTDAT  (5,0)     TO DATE   (MIDAS DAY NO.)          *
314800200610     C*********** ZBRCH  (3,0)     BRANCH                             *   S01117
314900200610     C*           ZBRCH  (3)       BRANCH                             *   S01117
315000200610     C*           ZCUST  (6,0)     CUSTOMER                           *
315100200610     C*           ZSECT  (10)      SECURITY                           *
315200200610     C*           ZPTFR  (4)       PORTFOLIO REFERENCE                *   S01496
315300200610     C*           ZDEPT  (6,0)     DEPOT CUSTOMER                     *   S01496
315400200610     C*                                                               *
315500200610     C************SAVCDP*(1,0)*****NOMINAL*CURRENCY*DEC.*PLS*(TABTG10)*   S01117
315600200610     C*           SAVCDP (1,0)     NOMINAL CURRENCY DEC. PLS(SDCURRPD)*   S01117
315700200610     C************NMDP***(1,0)*****NOMINAL*DEC.*PLS.*(SECTY*)**********   E31776
315800200610     C*           DATA FROM SECTY  FOR ZRATE ZACCR                    *
315900200610     C*           PROT   (1)       PROCESSING TYPE (INVTPD)           *
316000200610     C*           ZCUMCP (15,0)    CUM COUP HOLDING(FOR PROT N=6 ONLY)*
316100200610     C*                                                               *
316200200610     C*  OUTPUT - ZIAMT  (15,0-4)  INTEREST AMOUNT (NOM CCY DEC PLS)  *
316300200610     C*           ZACDY  (5,0)     INTEREST DAYS                      *
316400200610     C*                                                               *
316500200610     C*  REQUIRES CDEPD TO BE INCLUDED IN CALLING PROGRAM             *
316600200610     C*  REQUIRES CDEPD1 TO BE INCLUDED IN CALLING PROGRAM            *   S01496
316700200610     C*  REQUIRES SECED TO BE INCLUDED IN CALLING PROGRAM             *
316800200610     C*  (THUS IF EITHER FILE IS USED IN CALLING PGM -                *
316900200610     C*   THE CALLING PGM MUST RESET POSITION AFTER ZACRCI CALLED)    *
317000200610     C*                                                               *
317100200610     C*  USES INDICATORS 90 & 91                                      *
317200200610     C*                                                               *
317300200610     C*****************************************************************
317400200610     C*
317500200610     C           ZACRCI    BEGSR                           **ZACRCI BEGSR*
317600200610     C                     GOTO TZACST
317700200610     C*
317800200610     C*  Define Input fields
317900200610     C*
318000200610     C                     Z-ADDZFDAT     ZFDAT   50
318100200610     C                     Z-ADDZTDAT     ZTDAT   50
318200200610     C***********          MOVE ZBRCH     ZBRCH   30                      S01117
318300200610     C                     MOVE ZBRCH     ZBRCH   3                       S01117
318400200610     C**********           Z-ADDZCUST     ZCUST   60                                          CSD027
318500200610     C                     MOVE ZCUST     ZCUST   6                                           CSD027
318600200610     C                     MOVE ZSECT     ZSECT  10
318700200610     C                     Z-ADDZCUMCP    ZCUMCP 150
318800200610     C                     MOVE ZPTFR     ZPTFR   4                       S01496
318900200610     C**********           Z-ADDZDEPT     ZDEPT   60                                   S01496 CSD027
319000200610     C                     MOVE ZDEPT     ZDEPT   6                                           CSD027
319100200610     C*
319200200610     C*  Clear Output field
319300200610     C*
319400200610     C           TZACST    TAG                             *** TZACST  ***
319500200610     C                     Z-ADD0         ZIAMT  150
319600200610     C                     Z-ADD0         ZACDY   50
319700200610     C*
319800200610     C*  Define Work fields (based on similar fields where possible)
319900200610     C*
320000200610     C           *LIKE     DEFN DDTE      ZWDDTE
320100200610     C           *LIKE     DEFN DDTE      ZSAVDT
320200200610     C*
320300200610     C           *LIKE     DEFN SDET      ZWSDET
320400200610     C                     MOVE 'CP'      ZWSDET
320500200610     C*
320600200610     C                     Z-ADD0         ZI      10
320700200610     C*
320800200610     C*  Set up Key Lists for CDEPD and SECED access
320900200610     C*
321000200610     C           ZCDEPD    KLIST
321100200610     C                     KFLD           ZCUST
321200200610     C                     KFLD           ZSECT
321300200610     C                     KFLD           ZBRCH
321400200610     C                     KFLD           ZWDDTE
321500200610     C*
321600200610     C           ZCDEPP    KLIST
321700200610     C                     KFLD           ZCUST
321800200610     C                     KFLD           ZSECT
321900200610     C                     KFLD           ZBRCH
322000200610     C*
322100200610     C           ZSECED    KLIST
322200200610     C                     KFLD           ZSECT
322300200610     C                     KFLD           ZZSDAT
322400200610     C                     KFLD           ZWSDET
322500200610     C*
322600200610     C           ZSECDP    KLIST
322700200610     C                     KFLD           ZSECT
322800200610     C*                                                                   S01496
322900200610     C*  Set up Key Lists for CDEPD1                                      S01496
323000200610     C*                                                                   S01496
323100200610     C           YCDEPD    KLIST                                          S01496
323200200610     C                     KFLD           ZCUST                           S01496
323300200610     C                     KFLD           ZSECT                           S01496
323400200610     C                     KFLD           ZPTFR                           S01496
323500200610     C                     KFLD           ZBRCH                           S01496
323600200610     C                     KFLD           ZDEPT                           S01496
323700200610     C                     KFLD           ZWDDTE                          S01496
323800200610     C*                                                                   S01496
323900200610     C           YCDEPP    KLIST                                          S01496
324000200610     C                     KFLD           ZCUST                           S01496
324100200610     C                     KFLD           ZSECT                           S01496
324200200610     C                     KFLD           ZPTFR                           S01496
324300200610     C                     KFLD           ZBRCH                           S01496
324400200610     C                     KFLD           ZDEPT                           S01496
324500200610     C*
324600200610     C*  Differentiate between Schuldshein and others
324700200610     C*
324800200610     C           PROT      IFNE '6'
324900200610     C*
325000200610     C*  Non-Schuldshein processing
325100200610     C*
325200200610     C*  Calculate no. interest days
325300200610     C*
325400200610     C                     Z-ADDZFDAT     ZSDATE
325500200610     C                     Z-ADDZTDAT     ZEDATE
325600200610     C                     EXSR ZDAYS
325700200610     C                     Z-ADDZDDAYS    ZACDY
325800200610     C***********                                                         E31776
325900200610     C***Convert*the*amount*on*which*interest*is*to*be*calculated*********E31776
326000200610     C*****from*Nominal*Dec*Pls*to*Nominal*Ccy*Dec*Pls*-*unless*zero******E31776
326100200610     C***********                                                         E31776
326200200610     C                     Z-ADDZCUMCP    ZAMT                            S01158
326300200610     C***********ZAMT      IFNE 0                                         E31776
326400200610     C***********SAVCDP    SUB  NMDP      ZI                              E31776
326500200610     C***********ZI        ADD  5         ZI                              E31776
326600200610     C***********ZAMT      MULT POWER8,ZI ZAMT      H                     E31776
326700200610     C***********          END                                            E31776
326800200610     C                     Z-ADD1         ZZRET   10
326900200610     C*
327000200610     C*  Calculate interest for the period
327100200610     C*
327200200610     C                     GOTO ZZINT0
327300200610     C*
327400200610     C*
327500200610     C                     ELSE
327600200610     C*
327700200610     C*  Schuldshein processing
327800200610     C*
327900200610     C*  Access the latest position for Branch/Security/Customer
328000200610     C*    which is earlier than or on From Date
328100200610     C*    If none is found then treat this as a zero position
328200200610     C*
328300200610     C                     MOVE ZFDAT     ZWDDTE
328400200610     C                     Z-ADD0         ZSAVDT
328500200610     C*                                                                   S01496
328600200610     C           S01496    IFNE 'Y'                        *B1            S01496
328700200610     C           CSE007    ANDNE'Y'                                       CSE007
328800200610     C           CEU017    ANDNE'Y'                                       CEU017
328900200610     C           ZCDEPD    SETGTCDEPD
329000200610     C                     READPCDEPD                  9191
329100200610     C*
329200200610     C           *IN91     IFEQ '1'
329300200610     C***********CDBR      ORNE ZBRCH                                     E15694
329400200610     C***********CDSN      ORNE ZSECT                                     E15694
329500200610     C***********CDCN      ORNE ZCUST                                     E15694
329600200610     C***********DDTE      ORGT ZFDAT                                     E15694
329700200610     C***********CDBR2     ORNE ZBRCH                               E15694S01117
329800200610     C           CDPA2     ORNE ZBRCH                                     S01117
329900200610     C           CDSN2     ORNE ZSECT                                     E15694
330000200610     C           CDCN2     ORNE ZCUST                                     E15694
330100200610     C           DDTE2     ORGT ZFDAT                                     E15694
330200200610     C                     Z-ADD0         ZAMT
330300200610     C*
330400200610     C                     ELSE
330500200610     C*
330600200610     C*  Convert the amount on which interest is to be calculated
330700200610     C*    from Nominal Dec Pls to Nominal Ccy Dec Pls - unless zero
330800200610     C*
330900200610     C***********CDNV      ADD  CNPV      ZAMT                            E15694
331000200610     C***********ZAMT      ADD  CNSV      ZAMT                            E15694
331100200610     C***********ZAMT      SUB  CECN      ZAMT                            E15694
331200200610     C***********DDTE      IFGE ZFDAT                                     E15694
331300200610     C***********          Z-ADDDDTE      ZSAVDT                          E15694
331400200610     C***********          ELSE                                           E15694
331500200610     C***********          Z-ADDZFDAT     ZSAVDT                          E15694
331600200610     C***********          END                                            E15694
331700200610     C           CDNV2     ADD  CNPV2     ZAMT                            E15694
331800200610     C           ZAMT      ADD  CNSV2     ZAMT                            E15694
331900200610     C***********ZAMT      SUB  CECN2     ZAMT                      E15694E36865
332000200610     C***********DDTE      IFGE ZFDAT                               E15694E38091
332100200610     C           DDTE2     IFGE ZFDAT                                     E38091
332200200610     C                     Z-ADDDDTE2     ZSAVDT                          E15694
332300200610     C                     ELSE                                           E15694
332400200610     C                     Z-ADDZFDAT     ZSAVDT                          E15694
332500200610     C                     END                                            E15694
332600200610     C                     END
332700200610     C*                                                                   S01496
332800200610     C                     ELSE                            *X1            S01496
332900200610     C           YCDEPD    SETGTSECDEPL1                                  S01496
333000200610     C                     READPSECDEPL1               9191               S01496
333100200610     C*                                                                   S01496
333200200610     C           *IN91     IFEQ '1'                                       S01496
333300200610     C           CDPA2     ORNE ZBRCH                                     S01496
333400200610     C           CDSN2     ORNE ZSECT                                     S01496
333500200610     C           CDCN2     ORNE ZCUST                                     S01496
333600200610     C           PTFR2     ORNE ZPTFR                                     S01496
333700200610     C           CDPT2     ORNE ZDEPT                                     S01496
333800200610     C           DDTE2     ORGT ZFDAT                                     S01496
333900200610     C                     Z-ADD0         ZAMT                            S01496
334000200610     C*                                                                   S01496
334100200610     C                     ELSE                                           S01496
334200200610     C*                                                                   S01496
334300200610     C*  Convert the amount on which interest is to be calculated         S01496
334400200610     C*    from Nominal Dec Pls to Nominal Ccy Dec Pls - unless zero      S01496
334500200610     C*                                                                   S01496
334600200610     C           CDNV2     ADD  CNPV2     ZAMT                            S01496
334700200610     C           ZAMT      ADD  CNSV2     ZAMT                            S01496
334800200610     C*                                                                   S01496
334900200610     C           DDTE2     IFGE ZFDAT                                     S01496
335000200610     C                     Z-ADDDDTE2     ZSAVDT                          S01496
335100200610     C                     ELSE                                           S01496
335200200610     C                     Z-ADDZFDAT     ZSAVDT                          S01496
335300200610     C                     END                                            S01496
335400200610     C                     END                                            S01496
335500200610     C*                                                                   S01496
335600200610     C                     END                             *E1            S01496
335700200610     C*
335800200610     C           DDTE2     IFGE ZFDAT                                     E38091
335900200610     C                     Z-ADDDDTE2     ZSDATE                          E38091
336000200610     C                     ELSE                                           E38091
336100200610     C                     Z-ADDZFDAT     ZSDATE                          E38091
336200200610     C                     END                                            E38091
336300200610     C                     EXSR ZDAYS                                     E38091
336400200610     C                     Z-ADDZDDAYS    ZACDY                           E38091
336500200610     C*                                                                   E38091
336600200610     C                     Z-ADDZFDAT     ZSDATE
336700200610     C*
336800200610     C           S01496    IFNE 'Y'                                       S01496
336900200610     C           CSE007    ANDNE'Y'                                       CSE007
337000200610     C           CEU017    ANDNE'Y'                                       CEU017
337100200610     C           ZCDEPD    SETGTCDEPD
337200200610     C                     ELSE                                           S01496
337300200610     C           YCDEPD    SETGTSECDEPL1                                  S01496
337400200610     C                     END                                            S01496
337500200610     C*
337600200610     C           ZREAD     TAG                             ** ZREAD **
337700200610     C*
337800200610     C*  Read next Position  for this Branch/Security/Customer
337900200610     C*  or read next Pos.for this Customer/Security/Prtf/Branch/Depot    S01496
338000200610     C*    between From and To Dates
338100200610     C*
338200200610     C           S01496    IFNE 'Y'                                       S01496
338300200610     C           CSE007    ANDNE'Y'                                       CSE007
338400200610     C           CEU017    ANDNE'Y'                                       CEU017
338500200610     C           ZCDEPP    READECDEPD                  9191
338600200610     C                     ELSE                                           S01496
338700200610     C           YCDEPP    READESECDEPL1               9191               S01496
338800200610     C                     END                                            S01496
338900200610     C*
339000200610     C*  If End of Events
339100200610     C*    then calculate interest for remaining period
339200200610     C*    (which may be the whole period)
339300200610     C*
339400200610     C           *IN91     IFEQ '1'
339500200610     C***********DDTE      ORGT ZTDAT                                     E15694
339600200610     C           DDTE2     ORGT ZTDAT                                     E15694
339700200610     C*
339800200610     C                     Z-ADDZTDAT     ZEDATE
339900200610     C                     ADD  ZCUMCP    ZAMT
340000200610     C***********ZAMT      IFNE 0                                         E31776
340100200610     C***********SAVCDP    SUB  NMDP      ZI                              E31776
340200200610     C***********ZI        ADD  5         ZI                              E31776
340300200610     C***********ZAMT      MULT POWER8,ZI ZAMT      H                     E31776
340400200610     C***********          END                                            E31776
340500200610     C                     Z-ADD1         ZZRET
340600200610     C           ZAMT      IFNE 0
340700200610     C                     GOTO ZZINT0
340800200610     C                     END
340900200610     C*
341000200610     C                     GOTO ZENDAC
341100200610     C*
341200200610     C                     END
341300200610     C*
341400200610     C*  New date
341500200610     C*
341600200610     C***********DDTE      IFNE ZSAVDT                                    E15694
341700200610     C***********DDTE      ANDGTZSAVDT                                    E15694
341800200610     C           DDTE2     IFGT ZSAVDT                                    E15694
341900200610     C*
342000200610     C*    so calculate the interest up to the Event Date
342100200610     C*
342200200610     C***********          Z-ADDDDTE      ZEDATE                          E38091
342300200610     C                     Z-ADDDDTE2     ZEDATE                          E38091
342400200610     C           ZAMT      IFNE 0
342500200610     C***********SAVCDP    SUB  NMDP      ZI                              E31776
342600200610     C***********ZI        ADD  5         ZI                              E31776
342700200610     C***********ZAMT      MULT POWER8,ZI ZAMT      H                     E31776
342800200610     C                     Z-ADD2         ZZRET
342900200610     C                     GOTO ZZINT0
343000200610     C           ZZRET2    TAG                             *** ZZRET2  ***
343100200610     C                     END
343200200610     C*
343300200610     C*  Set Start of Next Interest Period = End of this Period
343400200610     C*    and save values from Event before reading next one
343500200610     C*
343600200610     C***********          Z-ADDDDTE      ZSDATE                          E15694
343700200610     C                     Z-ADDDDTE2     ZSDATE                          E15694
343800200610     C***********          Z-ADDSDNC      CPNR                            E38091
343900200610     C***********          Z-ADDSDCP      CFCT                            E38091
344000200610     C***********          MOVE SDTP      CPDP                            E38091
344100200610     C*
344200200610     C*  Convert the amount on which interest is to be calculated
344300200610     C*    from Nominal Dec Pls to Nominal Ccy Dec Pls - unless zero
344400200610     C*
344500200610     C***********CDNV      ADD  CNPV      ZAMT                            E15694
344600200610     C***********ZAMT      ADD  CNSV      ZAMT                            E15694
344700200610     C***********ZAMT      SUB  CECN      ZAMT                            E15694
344800200610     C***********CDNV      ADD  CNPV2     ZAMT                      E15694E38091
344900200610     C           CDNV2     ADD  CNPV2     ZAMT                            E38091
345000200610     C           ZAMT      ADD  CNSV2     ZAMT                            E15694
345100200610     C***********ZAMT      SUB  CECN2     ZAMT                      E15694E36865
345200200610     C*
345300200610     C*
345400200610     C***********          MOVE DDTE      ZSAVDT                          E15694
345500200610     C                     MOVE DDTE2     ZSAVDT                          E15694
345600200610     C                     ELSE
345700200610     C*
345800200610     C*    NOT NEW date
345900200610     C*
346000200610     C***********          MOVE DDTE      ZSAVDT                          E15694
346100200610     C                     MOVE DDTE2     ZSAVDT                          E15694
346200200610     C*
346300200610     C*    Accumulate amount
346400200610     C*
346500200610     C***********          ADD  CNPV      ZAMT                            E15694
346600200610     C***********          ADD  CDNV      ZAMT                            E15694
346700200610     C***********ZAMT      ADD  CNSV      ZAMT                            E15694
346800200610     C***********ZAMT      SUB  CECN      ZAMT                            E15694
346900200610     C                     ADD  CNPV2     ZAMT                            E15694
347000200610     C                     ADD  CDNV2     ZAMT                            E15694
347100200610     C           ZAMT      ADD  CNSV2     ZAMT                            E15694
347200200610     C***********ZAMT      SUB  CECN2     ZAMT                      E15694E36865
347300200610     C*
347400200610     C                     END
347500200610     C*
347600200610     C                     GOTO ZREAD
347700200610     C                     END
347800200610     C*
347900200610     C*****************************************************************
348000200610     C*
348100200610     C           ZZINT0    TAG                             *** ZINT0   ***
348200200610     C*
348300200610     C*  This is a s/r within ZACRCI
348400200610     C*    From/To dates input - ZSDATE/ZEDATE
348500200610     C*    These are stores & restored at end
348600200610     C*
348700200610     C                     Z-ADDZSDATE    ZZSDAT  50
348800200610     C                     Z-ADDZEDATE    ZZEDAT  50
348900200610     C*
349000200610     C*  Access the Coupon Rate Event for From Date
349100200610     C*    It should always be found (From Date should be Coupon Date)
349200200610     C*    but if not use values from SECTY  record for call to ZRATE
349300200610     C*
349400200610     C           ZSECED    CHAINSECED                90
349500200610     C*
349600200610     C*  If no Coupon Rate Event read or End of File
349700200610     C*    reset file pointer ready for read of rest of Events
349800200610     C*
349900200610     C           *IN90     IFEQ '1'
350000200610     C           ZSECED    SETLLSECED
350100200610     C*
350200200610     C                     MOVE '0'       *IN90
350300200610     C                     ELSE
350400200610     C*
350500200610     C*  If Coupon Rate Event read successfully
350600200610     C*    then save fields to be used by ZRATE before next Event read
350700200610     C*
350800200610     C                     Z-ADDSNCR      CPNR
350900200610     C                     Z-ADDSNCF      CFCT
351000200610     C                     MOVE SNCP      CPDP
351100200610     C                     END
351200200610     C*
351300200610     C                     Z-ADDZZSDAT    ZSDATE
351400200610     C*                                                                   E36865
351500200610     C** Access CPOSND for ex-coupon                                      E36865
351600200610     C*                                                                   E36865
351700200610     C           KEYCP     CHAINCPOSN                25                   E36865
351800200610     C           *IN25     IFEQ '1'                                       E36865
351900200610     C           DDTE      ANDLTZSDATE                                    E36865
352000200610     C                     Z-ADDCSEX      CECN                            E36865
352100200610     C                     ELSE                                           E36865
352200200610     C                     Z-ADD0         CECN                            E36865
352300200610     C                     END                                            E36865
352400200610     C                     SUB  CECN      ZAMT                            E36865
352500200610     C*
352600200610     C*  Read all Security Events between From and To Dates
352700200610     C*
352800200610     C           *IN90     DOUEQ'1'
352900200610     C*
353000200610     C           ZSECDP    READESECED                    90
353100200610     C*
353200200610     C           *IN90     IFEQ '0'
353300200610     C           SDED      ANDGEZZEDAT
353400200610     C                     MOVE '1'       *IN90
353500200610     C                     END
353600200610     C*
353700200610     C*  If End of File or of Events between From and To Dates
353800200610     C*    then calculate interest for remaining period
353900200610     C*    (which may be the whole period if no required events read)
354000200610     C*
354100200610     C           *IN90     IFEQ '1'
354200200610     C                     Z-ADDZZEDAT    ZEDATE
354300200610     C                     EXSR ZRATE
354400200610     C                     EXSR ZSAVE                                     S01158
354500200610     C                     Z-ADDSAVCDP    ZCDP                            S01117
354600200610     C                     EXSR ZACCR
354700200610     C/COPY WNCPYSRC,SE0215C011
354800200610     C                     EXSR ZRSTOR                                    S01158
354900200610     C                     ADD  ZACCRD    ZIAMT
355000200610     C*
355100200610     C                     ELSE
355200200610     C*
355300200610     C*  If Event read is within required dates
355400200610     C*    check if it is a required event
355500200610     C*
355600200610     C           SDET      IFEQ 'PP'
355700200610     C           SDET      OREQ 'MP'
355800200610     C           SDET      OREQ 'IR'
355900200610     C*
356000200610     C*  A required Event marks the End of This Interest Period
356100200610     C*    so calculate the interest up to the Event Date
356200200610     C*
356300200610     C                     Z-ADDSDED      ZEDATE
356400200610     C                     EXSR ZRATE
356500200610     C                     EXSR ZSAVE                                     S01158
356600200610     C                     Z-ADDSAVCDP    ZCDP                            S01117
356700200610     C                     EXSR ZACCR
356800200610     C/COPY WNCPYSRC,SE0215C012
356900200610     C                     EXSR ZRSTOR                                    S01158
357000200610     C                     ADD  ZACCRD    ZIAMT
357100200610     C*
357200200610     C*  Set Start of Next Interest Period = End of this Period
357300200610     C*    and save values from Event before reading next one
357400200610     C*
357500200610     C                     Z-ADDSDED      ZSDATE
357600200610     C                     Z-ADDSDNC      CPNR
357700200610     C                     Z-ADDSDCP      CFCT
357800200610     C                     MOVE SDTP      CPDP
357900200610     C*
358000200610     C                     END
358100200610     C                     END
358200200610     C                     END
358300200610     C*
358400200610     C                     Z-ADDZZSDAT    ZSDATE
358500200610     C                     Z-ADDZZEDAT    ZEDATE
358600200610     C           ZZRET     CABEQ2         ZZRET2
358700200610     C*
358800200610     C           ZENDAC    TAG                             *** ZENDAC ***
358900200610     C*
359000200610     C                     ENDSR
359100200610     C*
3592002006100738 C*****************************************************************
359300200610      /EJECT
3594002006100738 C*****************************************************************
359500200610     C**                                                              *
359600200610     C**   SUBFIL SR  Write details to Subfile                        *
359700200610     C**                                                              *
359800200610     C**   Called by  PROCES                                          *
359900200610     C**   Calls  SR  RETSR,ZSEDIT,ZSDESC,CSPRC,ZPRCO,ZCONV,ZDAYS,    *
360000200610     C**              ZACRCI,YPRICE                                   *
360100200610     C**                                                              *
360200200610     C*****************************************************************
360300200610     C**
360400200610     C           SUBFIL    BEGSR                           ** SUBFIL **
360500200610     C**
360600200610     C**  SUBFIL - fills one line of the SFL depending on the setting
360700200610     C**           of SFLT
360800200610     C/COPY WNCPYSRC,SE0215C001
360900200610     C**
361000200610     C**  SFLT=1 Blank line required
361100200610     C**
361200200610     C           SFLT      IFEQ 1
361300200610     C                     MOVE *BLANKS   SLINE
361400200610      *                                                                   CGL011
361500200610      ** If CGL011 is installed, check if client holding is blocked.      CGL011
361600200610      *                                                                   CGL011
361700200610     C           CGL011    IFEQ 'Y'                                       CGL011
361800200610     C                     MOVE 'N'       WBLKI   1                       CGL011
361900200610     C                     MOVE *OFF      *IN63                           CGL011
362000200610     C           KEYVD     SETLLSEBLKPL6                                  CGL011
362100200610     C           WBLKI     DOWEQ'N'                                       CGL011
362200200610     C           *IN63     ANDEQ*OFF                                      CGL011
362300200610     C           KEYVD     READESEBLKPL6                 63               CGL011
362400200610      *                                                                   CGL011
362500200610      ** Display Collateral text if block exists, whether General         CGL011
362600200610      ** Block on the Security or Specific Block on the Customer.         CGL011
362700200610      *                                                                   CGL011
362800200610     C           *IN63     IFEQ *OFF                                      CGL011
362900200610     C           VDCNUM    ANDEQPCUST                                     CGL011
363000200610     C           *IN63     OREQ *OFF                                      CGL011
363100200610     C********** VDCNUM    ANDEQ*ZERO                                                  CGL011 CSD027
363200200610     C           VDCNUM    ANDEQ*BLANKS                                                       CSD027
363300200610     C                     MOVE 'Y'       WBLKI                           CGL011
363400200610     C                     MOVELCOLLA     SLINE                           CGL011
363500200610     C                     ELSE                                           CGL011
363600200610     C                     MOVE *BLANKS   SLINE                           CGL011
363700200610     C                     ENDIF                                          CGL011
363800200610     C                     ENDDO                                          CGL011
363900200610     C                     ENDIF                                          CGL011
364000200610      *                                                                   CGL011
364100200610     C                     SETON                     08
364200200610     C                     END
364300200610     C**
364400200610     C**  SFLT=2 FIRST SECURITY/POSITION DETAILS LINE
364500200610     C**
364600200610     C           SFLT      IFEQ 2
364700200610     C                     SETOF                     08
364800200610     C**
364900200610     C**   Format security short description
365000200610     C**
365100200610     C                     MOVE SESN      SSESN
365200200610     C                     MOVE NMCY      SNMCY
365300200610     C                     MOVE SRPN      ZSRPN
365400200610     C                     MOVE BVRIDF    ZRSFD                           S01117
365500200610     C                     EXSR ZSDESC
365600200610     C                     MOVELZRNME     SDESC
365700200610     C**
365800200610     C*****ACCESS*TABTG10*FOR*nominal*CURRENCY*                           S01117
365900200610     C***********                                                         S01117
366000200610     C***********          MOVEL'20      'TKEY   12                       S01117
366100200610     C***********          MOVELNMCY      ZWK4    4                       S01117
366200200610     C***********          MOVE 1         ZWK4                            S01117
366300200610     C***********          MOVE ZWK4      TKEY                            S01117
366400200610     C***********TKEY      CHAINTABTG10F             25                   S01117
366500200610     C**N25******RECI      COMP 'D'                  2525                 S01117
366600200610     C***********                                                         S01117
366700200610     C*******If*no*record*found**or*deleted*record*                       S01117
366800200610     C**********then*it*is*a*database*error*so*return*to*calling*         S01117
366900200610     C**********program*with*a*return*code*of*'0'*                        S01117
367000200610     C***********                                                         S01117
367100200610     C************IN25     IFEQ '1'                                       S01117
367200200610      *                                                                   S01117
367300200610      ** Access currency file SDCURRPD                                    S01117
367400200610      *                                                                   S01117
367500200610     C                     CALL 'AOCURRR0'                                S01117
367600200610     C                     PARM '*DBERR'  @RTCD   7                       S01117
367700200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
367800200610     C                     PARM NMCY      @AJCD   3                       S01117
367900200610     C           SDCURR    PARM SDCURR    DSSDY                           S01117
368000200610      ***********                                                         S01117
368100200610      ***If*no*record*found*then*it*is*a*database*error*so*return*to***   S01117
368200200610      ***calling*program*with*a*return*code*of*'0'*********************   S01117
368300200610      ***********                                                         S01117
368400200610     C***********          MOVELPROGRM    DBPGM                           S01117
368500200610     C***********          MOVELTKEY      DBKEY            ***************S01117
368600200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 10 *S01117
368700200610     C***********          Z-ADD10        DBASE            ***************S01117
368800200610     C***********          SETON                       U7U8               S01117
368900200610     C***********          MOVE '0'       RTNC                            S01117
369000200610     C***********          EXSR RETSR                                     S01117
369100200610     C***********          END                                            S01117
369200200610     C***********          Z-ADDCDP       SAVCDP  10                      S01117
369300200610     C***********          Z-ADDCDP       NCDP    10                S01232S01117
369400200610     C                     Z-ADDA6NBDP    SAVCDP  10                      S01117
369500200610     C                     Z-ADDA6NBDP    NCDP    10                      S01117
369600200610     C**
369700200610     C**   Format book valuation - sec
369800200610     C**
369900200610     C                     EXSR CSPRC
370000200610     C           BKPR      IFLT *ZEROS
370100200610     C                     Z-SUBBKPR      BKPR
370200200610     C                     END
370300200610     C                     Z-ADD*ZEROS    WBVAL  150
370400200610     C                     Z-ADD*ZEROS    WBVAL0 150
370500200610     C                     Z-ADD*ZEROS    WBVAL1 151
370600200610     C                     Z-ADD*ZEROS    WBVAL2 152
370700200610     C                     Z-ADD*ZEROS    WBVAL3 153
370800200610     C                     MOVEA'0000'    *IN,55
370900200610     C***********55        ADD  CDP       J       20                      S01117
371000200610     C           55        ADD  A6NBDP    J       20                      S01117
371100200610     C                     MOVEA'1'       *IN,J
371200200610     C*
371300200610     C*  Book price used in calculation of Book value should be a         S01186
371400200610     C*  price (not a yield or discount)                                  S01186
371500200610     C*                                                                   S01186
371600200610     C***********          Z-ADDRUND      ZFDATE                   S01186 E16894
371700200610     C***********          Z-ADDBKPR      ZPRCIN                   S01186 E16894
371800200610     C***********          EXSR ZPRCI                              S01186 E16894
371900200610     C***********          Z-ADDZPRCOT    WBPRIC 158               S01186 E16894
372000200610     C*
372100200610     C*  Calculate consideration/reallowance/charges/commission
372200200610     C*
372300200610     C   55      ZZNOML    MULT BKPR      WBVAL0    H
372400200610     C   56      ZZNOML    MULT BKPR      WBVAL1    H
372500200610     C   57      ZZNOML    MULT BKPR      WBVAL2    H
372600200610     C   58      ZZNOML    MULT BKPR      WBVAL3    H
372700200610     C*
372800200610     C* Price basis - divide by 100
372900200610     C*
373000200610     C           SPBS      IFEQ 'P'
373100200610     C   55                DIV  100       WBVAL0
373200200610     C   56                DIV  100       WBVAL1
373300200610     C   57                DIV  100       WBVAL2
373400200610     C   58                DIV  100       WBVAL3
373500200610     C                     END
373600200610     C*
373700200610     C   55                MOVE WBVAL0    WBVAL
373800200610     C   56                MOVE WBVAL1    WBVAL
373900200610     C   57                MOVE WBVAL2    WBVAL
374000200610     C   58                MOVE WBVAL3    WBVAL
374100200610     C*
374200200610     C*   Allow for nominal decimal places
374300200610     C*
374400200610     C           5         SUB  NMDP      DC      10
374500200610     C           WBVAL     MULT POWER8,DC BVAL   150
374600200610     C***********          Z-ADDCDP       ZDECS   10                      S01117
374700200610     C                     Z-ADDA6NBDP    ZDECS   10                      S01117
374800200610     C                     MOVE 'L'       ZECODE
374900200610     C                     MOVE BVAL      ZFLD15
375000200610     C                     EXSR ZSEDIT
375100200610     C                     MOVE ZOUT21    SBVAL
375200200610     C***********          EXSR ADJUST                                    S01176
375300200610     C***********          MOVE WORKAD    SBVALA                          S01176
375400200610     C***********SBVALA    IFEQ *BLANKS                                   S01176
375500200610     C***********          MOVE *BLANKS   SBVAL                           S01176
375600200610     C***********          END                                            S01176
375700200610     C*                                                                   S01176
375800200610     C* If processing type 9 & trade basis is 'Yield' use yield as        S01176
375900200610     C* Market price                                                      S01176
376000200610     C*                                                                   S01176
376100200610     C           KYPR      CHAINCPPRIC               25                   S01176
376200200610     C*                                                                   S01176
376300200610     C           PROT      IFEQ '9'                                       S01176
376400200610     C           STBS      ANDEQ'Y'                                       S01176
376500200610     C           *IN25     ANDEQ'0'                                       S01176
376600200610     C           RECI      ANDEQ'D'                                       S01176
376700200610     C*                                                                   S01176
376800200610     C                     EXSR YPRICE                                    S01176
376900200610     C*                                                                   S01176
377000200610     C***********          Z-ADD8         ZDECS   10               S01176 S01186
377100200610     C***********          MOVE 'L'       ZECODE                   S01176 S01186
377200200610     C*                                                                   S01186
377300200610     C* Set up ZFLD15 (for screen editing) and ZPRICIN (for conversion    S01186
377400200610     C* to a price which is used in market value calculation)             S01186
377500200610     C*                                                                   S01186
377600200610     C                     MOVE ZY1       ZFLD15                          S01176
377700200610     C*                                                                   S01176
377800200610     C***********          EXSR ZSEDIT                             S01176 S01186
377900200610     C***********          MOVE Z21L3     SMKPR                    S01176 S01186
378000200610     C***********          Z-ADDRUND      ZFDATE                   S01176 S01186
378100200610     C*                                                                   S01176
378200200610     C                     Z-ADDZY1       ZPRCIN                          S01176
378300200610     C*                                                                   S01176
378400200610     C***********          EXSR ZPRCI                              S01177 S01186
378500200610     C***********          Z-ADDZPRCOT    WMPRIC                   S01176 S01186
378600200610     C*                                                                   S01176
378700200610     C                     ELSE                                           S01176
378800200610     C*
378900200610     C* Access Prices file for Security and Type 'V' for Price
379000200610     C*    - obtain latest price from Prices file                         090500
379100200610     C*    - if not found use Market Price from Security
379200200610     C*
379300200610     C                     MOVE 'V '      PTYP
379400200610     C**********           MOVE *ZEROS    PCST                                                CSD027
379500200610     C                     MOVE *BLANKS   PCST                                                CSD027
379600200610     C                     Z-ADD0         PDAT
379700200610     C                     SETOF                         85               111490
379800200610     C***********KEYPT     SETLLPRICT                                     090500
379900200610     C***********KEYPTP    READEPRICT                    99               090500
380000200610     C***********KEYPT     SETGTPRICT                              090500 111490
380100200610     C***********KEYPTP    REDPEPRICT                    99        090500 111490
380200200610     C           KEYPT     SETLLPRICT                    99               111490
380300200610     C           *IN99     IFEQ '0'                                       111490
380400200610     C           KEYPTP    READEPRICT                    99               111490
380500200610     C           *IN99     IFEQ '0'                                       111490
380600200610     C           RECI      ANDEQ'D'                                       111490
380700200610     C                     SETON                     85                   111490
380800200610     C                     ELSE                                           111490
380900200610     C           RECI      DOWEQ'*'                                       111490
381000200610     C           *IN99     ANDNE'1'                                       111490
381100200610     C           KEYPTP    READEPRICT                    99               111490
381200200610     C           RECI      IFNE '*'                                       111490
381300200610     C           *IN99     IFEQ '0'                                       111490
381400200610     C                     SETON                     85                   111490
381500200610     C                     END                                            111490
381600200610     C                     END                                            111490
381700200610     C                     END                                            111490
381800200610     C                     END                                            111490
381900200610     C                     END                                            111490
382000200610     C************IN99     IFEQ '1'                                       111490
382100200610     C           *IN85     IFEQ '0'                                       111490
382200200610     C*                                                                   S01186
382300200610     C* Set up ZFLD15 (for screen editing) and ZPRICIN (for conversion    S01186
382400200610     C* to a price which is used in market value calculation)             S01186
382500200610     C*                                                                   S01186
382600200610     C***********          MOVE MKPR      ZPRICE                          S01186
382700200610     C                     MOVE MKPR      ZPRCIN                          S01186
382800200610     C                     ELSE
382900200610     C***********          MOVE PPRC      ZPRICE                          S01186
383000200610     C                     MOVE PPRC      ZPRCIN                          S01186
383100200610     C                     END
383200200610     C                     MOVE ZPRCIN    ZFLD15                          S01186
383300200610     C*
383400200610     C***********          Z-ADDZPRICE    WMPRIC 158                      S01186
383500200610     C***********          Z-ADDRUND      ZFDATE                          S01186
383600200610     C                     EXSR ZNCD
383700200610     C***********          EXSR ZPRCO                                     S01186
383800200610     C***********          Z-ADD8         ZDECS   10                      S01186
383900200610     C***********          MOVE 'L'       ZECODE                          S01186
384000200610     C***********          MOVE ZPRCOT    ZFLD15                          S01186
384100200610     C***********          EXSR ZSEDIT                                    S01186
384200200610     C***********          MOVE Z21L3     SMKPR                           S01186
384300200610     C*
384400200610     C                     END                                            S01176
384500200610     C*                                                                   S01186
384600200610     C* Price/Yield/Discount should be output to screen as a Price/       S01186
384700200610     C* Yield/Discount after editing.                                     S01186
384800200610     C*                                                                   S01186
384900200610     C                     Z-ADD8         ZDECS   10
385000200610     C                     MOVE 'L'       ZECODE
385100200610     C***********          MOVE ZPRCOT    ZFLD15                          E16894
385200200610     C                     EXSR ZSEDIT
385300200610     C                     MOVE Z21L3     SMKPR
385400200610     C*                                                                   S01186
385500200610     C* Price/Yield/Discount should be converted into price before        S01186
385600200610     C* use in Market Value calculation.                                  S01186
385700200610     C*                                                                   S01186
385800200610     C                     Z-ADDRUND      ZFDATE                          S01186
385900200610     C*                                                                   S01232
386000200610     C*    If this is a security traded on an Australian yield basis      S01232
386100200610     C*    then set up fields required for ZPRCI. (Purch Int =            S01232
386200200610     C*    accrued to date/nominal).                                      S01232
386300200610     C*                                                                   S01232
386400200610     C           *IN52     IFEQ '1'                                       S01232
386500200610     C           ZZNOML    ANDNE0                                         S01232
386600200610     C                     Z-ADDLCPN      ZSDATE                          S01232
386700200610     C                     Z-ADDRUND      ZEDATE                          S01232
386800200610     C                     EXSR ZRATE                                     S01232
386900200610     C                     Z-ADDZZNOML    ZAMT                            S01232
387000200610     C                     Z-ADDNCDP      ZCDP                            S01117
387100200610     C                     EXSR ZACCR                                     S01232
387200200610     C/COPY WNCPYSRC,SE0215C013
387300200610     C           ZACCRD    DIV  ZZNOML    WRKPI                           S01232
387400200610     C                     Z-ADDRUND      WRKD    50                      S01232
387500200610     C                     EXSR ZYCE                                      S01232
387600200610     C*                                                                   S01232
387700200610     C*          IF EX-COUPON THEN PI PASSED IS THE REMAINING INTEREST    S01232
387800200610     C*          TILL NCD AND IS NEGATIVE                                 S01232
387900200610     C*                                                                   S01232
388000200610     C           SCUMEX    IFEQ 'X'                                       S01232
388100200610     C                     Z-ADDLCPN      ZSDATE                          S01232
388200200610     C                     Z-ADDNCD       ZEDATE                          S01232
388300200610     C                     Z-ADDNCDP      ZCDP                            S01117
388400200610     C                     EXSR ZACCR                                     S01232
388500200610     C/COPY WNCPYSRC,SE0215C014
388600200610     C           ZACCRD    DIV  ZZNOML    WKWPI  159                      S01232
388700200610     C           WRKPI     SUB  WKWPI     WRKPI                           S01232
388800200610     C                     END                                            S01232
388900200610     C                     ELSE                                           S01232
389000200610     C                     Z-ADD0         WRKPI                           S01232
389100200610     C                     MOVE 'C'       SCUMEX                          S01232
389200200610     C                     END                                            S01232
389300200610     C*                                                                   E39495
389400200610     C           ZZNOML    IFLT *ZERO                                     E39495
389500200610     C                     Z-SUBZZNOML    ZNOML                           E39495
389600200610     C                     ELSE                                           E39495
389700200610     C                     Z-ADDZZNOML    ZNOML                           E39495
389800200610     C                     END                                            E39495
389900200610     C*                                                                   S01232
390000200610     C           ZPRCIN    IFNE 0                                         E31789
390100200610     C                     EXSR ZPRCI                                     S01186
390200200610     C/COPY WNCPYSRC,SE0215C009
390300200610      *                                                                                       CSE035
390400200610      ** ADJUST NUMBER OF DECIMAL PLACES FOR PRICE                                            CSE035
390500200610      *                                                                                       CSE035
390600200610     C           CSE035    IFEQ 'Y'                                                           CSE035
390700200610      *                                                                                       CSE035
390800200610      ** ADJUST PRICE : PRICE + PUR INT BEFORE ROUNDING                                       CSE035
390900200610      *                                                                                       CSE035
391000200610     C           NCD       IFGE MATY                                                          CSE035
391100200610     C           SYBS      ANDEQ'AU'                                                          CSE035
391200200610     C                     Z-ADDZPRCOT    ZPRCOT                                              CSE035
391300200610     C                     ELSE                                                               CSE035
391400200610     C           SYBS      IFNE 'AU'                                                          CSE035
391500200610     C           SYBS      ANDNE'DA'                                                          CSE035
391600200610     C           STBS      ANDEQ'Y'                                                           CSE035
391700200610     C           ZPRCOT    ADD  ZWAMT     ZPRCOT                                              CSE035
391800200610     C                     END                                                                CSE035
391900200610     C                     END                                                                CSE035
392000200610      *                                                                                       CSE035
392100200610     C                     END                                                                CSE035
392200200610      *                                                                                       CSE035
392300200610     C           CSE035    IFEQ 'Y'                                                           CSE035
392400200610     C           NCD       IFGE MATY                                                          CSE035
392500200610     C           SYBS      ANDEQ'AU'                                                          CSE035
392600200610     C                     ELSE                                                               CSE035
392700200610      *                                                                                       CSE035
392800200610     C           SYBS      IFNE 'AU'                                                          CSE035
392900200610     C           SYBS      ANDNE'DA'                                                          CSE035
393000200610     C           STBS      ANDEQ'Y'                                                           CSE035
393100200610     C           ZPRCOT    SUB  PURINT    ZPRCOT                                              CSE035
393200200610     C                     END                                                                CSE035
393300200610     C                     END                                                                CSE035
393400200610      *                                                                                       CSE035
393500200610     C                     END                                                                CSE035
393600200610      *                                                                                       CSE035
393700200610     C                     Z-ADDZPRCOT    WMPRIC 158                      S01186
393800200610     C                     ELSE                                           E31789
393900200610     C                     Z-ADD0         WMPRIC                          E31789
394000200610     C                     END                                            E31789
394100200610     C*                                                                   E31789
394200200610     C           SPBS      IFEQ 'P'
394300200610     C                     MOVE '%'       P2
394400200610     C                     ELSE
394500200610     C                     MOVE ' '       P2
394600200610     C                     END
394700200610     C**
394800200610     C**   Format market valuation - sec
394900200610     C**
395000200610     C                     Z-ADD*ZEROS    WMVAL  150
395100200610     C                     Z-ADD*ZEROS    WMVAL0 150
395200200610     C                     Z-ADD*ZEROS    WMVAL1 151
395300200610     C                     Z-ADD*ZEROS    WMVAL2 152
395400200610     C                     Z-ADD*ZEROS    WMVAL3 153
395500200610     C                     MOVEA'0000'    *IN,55
395600200610     C***********55        ADD  CDP       J       20                      S01117
395700200610     C           55        ADD  A6NBDP    J       20                      S01117
395800200610     C                     MOVEA'1'       *IN,J
395900200610     C*
396000200610     C*  Calculate consideration/reallowance/charges/commission
396100200610     C*
396200200610     C   55      ZZNOML    MULT WMPRIC    WMVAL0    H
396300200610     C   56      ZZNOML    MULT WMPRIC    WMVAL1    H
396400200610     C   57      ZZNOML    MULT WMPRIC    WMVAL2    H
396500200610     C   58      ZZNOML    MULT WMPRIC    WMVAL3    H
396600200610     C*
396700200610     C* Price basis - divide by 100
396800200610     C*
396900200610     C           SPBS      IFEQ 'P'
397000200610     C   55                DIV  100       WMVAL0
397100200610     C   56                DIV  100       WMVAL1
397200200610     C   57                DIV  100       WMVAL2
397300200610     C   58                DIV  100       WMVAL3
397400200610     C                     END
397500200610     C*
397600200610     C   55                MOVE WMVAL0    WMVAL
397700200610     C   56                MOVE WMVAL1    WMVAL
397800200610     C   57                MOVE WMVAL2    WMVAL
397900200610     C   58                MOVE WMVAL3    WMVAL
398000200610     C*
398100200610     C*   Allow for nominal decimal places
398200200610     C*
398300200610     C           5         SUB  NMDP      DC      10
398400200610     C           WMVAL     MULT POWER8,DC MVAL   150
398500200610     C*
398600200610     C                     Z-ADDMVAL      ZFLD15
398700200610     C***********          Z-ADDCDP       ZDECS                     S01176S01117
398800200610     C                     Z-ADDA6NBDP    ZDECS                           S01117
398900200610     C                     EXSR ZSEDIT
399000200610     C                     MOVE ZOUT21    SMVAL
399100200610     C***********          EXSR ADJUST                                    S01176
399200200610     C***********          MOVE WORKAD    SMVALA                          S01176
399300200610     C***********SMVALA    IFEQ *BLANKS                                   S01176
399400200610     C***********          MOVE *BLANKS   SMVAL                           S01176
399500200610     C***********          END                                            S01176
399600200610     C*                                                                   S01496
399700200610     C           S01496    IFEQ 'Y'                        *B1            S01496
399800200610     C           CSE007    OREQ 'Y'                                       CSE007
399900200610     C           CEU017    OREQ 'Y'                                       CEU017
400000200610     C*                                                                   S01496
400100200610     C           GBLOCK    IFNE *BLANKS                    *B2            S01496
400200200610     C           SBLOCK    ORNE *BLANKS                                   S01496
400300200610     C           #BLOC1    IFEQ *BLANKS                    *B3            S01496
400400200610     C                     MOVELGBLOCK    GBLOC1                          S01496
400500200610     C                     MOVELSBLOCK    SBLOC1                          S01496
400600200610     C                     ELSE                            *X3            S01496
400700200610     C           GBLOCK    IFNE *BLANKS                    *B4            S01496
400800200610     C           SBLOCK    ANDNE*BLANKS                                   S01496
400900200610     C                     MOVELGBLOCK    GBLOC1                          S01496
401000200610     C                     MOVEL*BLANKS   #BLANC                          S01496
401100200610     C                     MOVELSBLOCK    SBLOC1                          S01496
401200200610     C                     ELSE                            *X4            S01496
401300200610     C                     MOVEL*BLANKS   #BLANC                          S01496
401400200610     C           GBLOCK    IFNE *BLANKS                    *B5            S01496
401500200610     C                     MOVELGBLOCK    SBLOC1                          S01496
401600200610     C                     ELSE                            *X5            S01496
401700200610     C                     MOVELSBLOCK    SBLOC1                          S01496
401800200610     C                     END                             *E5            S01496
401900200610     C                     END                             *E4            S01496
402000200610     C                     END                             *E3            S01496
402100200610     C                     END                             *E2            S01496
402200200610     C                     END                             *E1            S01496
402300200610     C*                                                                   S01496
402400200610     C                     MOVE POSL1     SLINE
402500200610     C                     END
402600200610     C**
402700200610     C**  SFLT=3 SECOND SECURITY/POSITION DETAILS LINE
402800200610     C**
402900200610     C           SFLT      IFEQ 3
403000200610     C                     SETON                     08
403100200610     C**
403200200610     C**   Edit nominal
403300200610     C                     Z-ADDNMDP      ZDECS   10
403400200610     C                     MOVE 'L'       ZECODE
403500200610     C                     Z-ADDZZNOML    ZFLD15
403600200610     C                     EXSR ZSEDIT
403700200610     C                     MOVE ZOUT21    SNOML
403800200610     C**
403900200610     C**   Format book price
404000200610     C**
404100200610     C***********          MOVE BKPR      ZPRICE                          S01186
404200200610     C***********          Z-ADDRUND      ZFDATE                          S01186
404300200610     C                     MOVE BKPR      ZPRICE                          E16894
404400200610     C                     Z-ADDRUND      ZFDATE                          E16894
404500200610     C                     EXSR ZNCD
404600200610     C***********          EXSR ZPRCO                                     S01186
404700200610     C*                                                                   E39495
404800200610     C           ZZNOML    IFLT *ZERO                                     E39495
404900200610     C                     Z-SUBZZNOML    ZNOML                           E39495
405000200610     C                     ELSE                                           E39495
405100200610     C                     Z-ADDZZNOML    ZNOML                           E39495
405200200610     C                     END                                            E39495
405300200610     C*                                                                   E39495
405400200610     C                     EXSR ZPRCO                                     E16894
405500200610     C/COPY WNCPYSRC,SE0215C010
405600200610     C                     Z-ADD8         ZDECS   10
405700200610     C                     MOVE 'L'       ZECODE
405800200610     C                     MOVE ZPRCOT    ZFLD15
405900200610     C                     EXSR ZSEDIT
406000200610     C                     MOVE Z21L3     SBKPR
406100200610     C           SPBS      IFEQ 'P'
406200200610     C                     MOVE '%'       P1
406300200610     C                     ELSE
406400200610     C                     MOVE ' '       P1
406500200610     C                     END
406600200610     C**
406700200610     C**   Format book valuation - portfolio
406800200610     C**
406900200610     C*****ACCESS*TABTG10*FOR*NOMINAL*CURRENCY*                           S01117
407000200610     C***********                                                         S01117
407100200610     C***********          MOVEL'20      'TKEY   12                       S01117
407200200610     C***********          MOVELNMCY      ZWK4    4                       S01117
407300200610     C***********          MOVE 1         ZWK4                            S01117
407400200610     C***********          MOVE ZWK4      TKEY                            S01117
407500200610     C***********TKEY      CHAINTABTG10F             25                   S01117
407600200610     C**N25******RECI      COMP 'D'                  2525                 S01117
407700200610     C***********                                                         S01117
407800200610     C*******If*no record found  or deleted record                        S01117
407900200610     C**********then it is a database error so return to calling          S01117
408000200610     C**********program with a return code of '0'                         S01117
408100200610     C***********                                                         S01117
408200200610     C************IN25     IFEQ '1'                                       S01117
408300200610      *                                                                   S01117
408400200610      ** Access currency file SDCURRPD for nominal currency               S01117
408500200610      *                                                                   S01117
408600200610     C                     CALL 'AOCURRR0'                                S01117
408700200610     C                     PARM '*DBERR'  @RTCD   7                       S01117
408800200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
408900200610     C                     PARM NMCY      @AJCD   3                       S01117
409000200610     C           SDCURR    PARM SDCURR    DSSDY                           S01117
409100200610      ***********                                                         S01117
409200200610      ***If*no*record*found*then*it*is*a*database*error*so*return*to      S01117
409300200610      ***calling*program*with*a*return*code*of*'0'******************      S01117
409400200610      ***********                                                         S01117
409500200610     C***********          MOVELPROGRM    DBPGM                           S01117
409600200610     C***********          MOVELTKEY      DBKEY            ***************S01117
409700200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 13 *E20651
409800200610     C***********          Z-ADD07        DBASE            ***************E20651
409900200610     C***********          MOVE 'TABLE'   DBFILE                    E20651S01117
410000200610     C***********          Z-ADD13        DBASE                           E20651
410100200610     C***********          SETON                       U7U8               S01117
410200200610     C***********          MOVE '0'       RTNC                            S01117
410300200610     C***********          EXSR RETSR                                     S01117
410400200610     C***********          END                                            S01117
410500200610      *                                                                   S01117
410600200610      ** Get decimal places of ccy being converted from, for ZCONV        S01117
410700200610      *                                                                   S01117
410800200610     C                     MOVE A6NBDP    ZCDPI                           S01117
410900200610      *                                                                   S01117
411000200610     C***********          MOVE ERLC      ZRATE1                          S01117
411100200610     C***********          MOVE MDIN      ZMDI1                           S01117
411200200610     C                     MOVE A6ERLC    ZRATE1                          S01117
411300200610     C                     MOVE A6MDIN    ZMDI1                           S01117
411400200610     C**
411500200610     C*****ACCESS*TABTG10*FOR*PORTFOLIO*CURRENCY*                         S01117
411600200610     C***********                                                         S01117
411700200610     C***********          MOVEL'20      'TKEY   12                       S01117
411800200610     C***********          MOVELC1PC      ZWK4    4                       S01117
411900200610     C***********          MOVE 1         ZWK4                            S01117
412000200610     C***********          MOVE ZWK4      TKEY                            S01117
412100200610     C***********TKEY      CHAINTABTG10F             25                   S01117
412200200610     C**N25******RECI      COMP 'D'                  2525                 S01117
412300200610     C***********                                                         S01117
412400200610     C*******If*no record found  or deleted record                        S01117
412500200610     C**********then it is a database error so return to calling          S01117
412600200610     C**********program with a return code of '0'                         S01117
412700200610     C***********                                                         S01117
412800200610     C************IN25     IFEQ '1'                                       S01117
412900200610      *                                                                   S01117
413000200610      ** Access currency file SDCURRPD for portfolio currency             S01117
413100200610      *                                                                   S01117
413200200610     C                     CALL 'AOCURRR0'                                S01117
413300200610     C                     PARM '*DBERR'  @RTCD   7                       S01117
413400200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
413500200610     C                     PARM BFPCYC    @AJCD   3                       S01117
413600200610     C           SDCURR    PARM SDCURR    DSSDY                           S01117
413700200610      ***********                                                         S01117
413800200610      ***If*no*record*found*then*it*is*a*database*error*so*return*to      S01117
413900200610      ***calling*program*with*a*return*code*of*'0'******************      S01117
414000200610      ***********                                                         S01117
414100200610     C***********          MOVELPROGRM    DBPGM                           S01117
414200200610     C***********          MOVELTKEY      DBKEY            ***************S01117
414300200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 14 *E20651
414400200610     C***********          Z-ADD07        DBASE            ***************E20651
414500200610     C***********          MOVE 'TABLE'   DBFILE                    E20651S01117
414600200610     C***********          Z-ADD14        DBASE                           E20651
414700200610     C***********          SETON                       U7U8               S01117
414800200610     C***********          MOVE '0'       RTNC                            S01117
414900200610     C***********          EXSR RETSR                                     S01117
415000200610     C***********          END                                            S01117
415100200610      *                                                                   S01117
415200200610      ** Get decimal places of ccy being converted to, for ZCONV          S01117
415300200610      *                                                                   S01117
415400200610     C                     MOVE A6NBDP    ZCDPO                           S01117
415500200610      *                                                                   S01117
415600200610     C***********          MOVE ERLC      ZRATE2                          S01117
415700200610     C***********          MOVE MDIN      ZMDI2                           S01117
415800200610     C                     MOVE A6ERLC    ZRATE2                          S01117
415900200610     C                     MOVE A6MDIN    ZMDI2                           S01117
416000200610     C**
416100200610     C**  CALL XRATE TO GET EXCH. RATE & MDIN
416200200610     C**
416300200610     C                     EXSR ZXRATE
416400200610     C                     MOVE ZMDIX     ZMDIXC  1
416500200610     C           ZMDIX     IFEQ '0'
416600200610     C                     MOVE 'D'       ZMDIXC
416700200610     C                     ELSE
416800200610     C           ZMDIX     IFEQ '1'
416900200610     C                     MOVE 'M'       ZMDIXC
417000200610     C                     END
417100200610     C                     END
417200200610     C**
417300200610     C**  Convert currency
417400200610     C**
417500200610     C                     MOVE BVAL      ZAMTCI
417600200610     C                     Z-ADDZRATEX    ZEXCH
417700200610     C                     MOVE ZMDIXC    ZMD
417800200610     C                     MOVE NMCY      ZCCYI
417900200610     C***********          MOVE C1PC      ZCCYO                           S01117
418000200610     C                     MOVE BFPCYC    ZCCYO                           S01117
418100200610     C                     EXSR ZCONV
418200200610     C**
418300200610     C****If*no*record*found*or*deleted*record*                           S01117
418400200610     C****then*it*is*a*database*error*so*return*to*calling*               S01117
418500200610     C****program*with*a*return*code*of*'0'*                              S01117
418600200610     C***********                                                         S01117
418700200610     C************INU7     IFEQ '1'                                       S01117
418800200610     C***********          MOVELPROGRM    DBPGM            ************   S01117
418900200610     C***********          MOVELTKEY      DBKEY            * DATABASE *   S01117
419000200610     C***********          MOVE 'TABLE'   DBFILE           **ERROR*07**   E20651
419100200610     C***********          Z-ADD07        DBASE            ************   E20651
419200200610     C***********          MOVE 'TABLE'   DBFILE           **ERROR 15**   E20651
419300200610     C***********          Z-ADD15        DBASE            ************   E20651
419400200610     C***********          SETON                       U7U8               S01117
419500200610     C***********          MOVE '0'       RTNC                            S01117
419600200610     C***********          EXSR RETSR                                     S01117
419700200610     C***********          END                                            S01117
419800200610     C*
419900200610     C                     Z-ADDPCCDP     ZDECS   10
420000200610     C                     MOVE 'L'       ZECODE
420100200610     C                     MOVE ZAMTCO    ZFLD15
420200200610     C                     EXSR ZSEDIT
420300200610     C                     MOVE ZOUT21    SBVPF
420400200610     C***********          EXSR ADJUST                                    S01176
420500200610     C***********          MOVE WORKAD    SBVPFA                          S01176
420600200610     C***********SBVPFA    IFEQ *BLANKS                                   S01176
420700200610     C***********          MOVE *BLANKS   SBVPF                           S01176
420800200610     C***********          END                                            S01176
420900200610     C**
421000200610     C**   Accumulate total book valuation - portfolio
421100200610     C**
421200200610     C                     ADD  ZAMTCO    TOTBVP
421300200610     C**
421400200610     C**   Format market valuation - portfolio
421500200610     C**
421600200610     C                     MOVE MVAL      ZAMTCI
421700200610     C                     Z-ADDZRATEX    ZEXCH
421800200610     C                     MOVE ZMDIXC    ZMD
421900200610     C                     MOVE NMCY      ZCCYI
422000200610     C***********          MOVE C1PC      ZCCYO                           S01117
422100200610     C                     MOVE BFPCYC    ZCCYO                           S01117
422200200610     C                     EXSR ZCONV
422300200610     C**
422400200610     C****If*no*record*found*or*deleted*record*                           S01117
422500200610     C****then*it*is*a*database*error*so*return*to*calling*               S01117
422600200610     C****program*with*a*return*code*of*'0'*                              S01117
422700200610     C***********                                                         S01117
422800200610     C************INU7     IFEQ '1'                                       S01117
422900200610     C***********          MOVELPROGRM    DBPGM            ************   S01117
423000200610     C***********          MOVELTKEY      DBKEY            * DATABASE *   S01117
423100200610     C***********          MOVE 'TABLE'   DBFILE           **ERROR*07*E206511117
423200200610     C***********          Z-ADD07        DBASE            ***********E206511117
423300200610     C***********          MOVE 'TABLE'   DBFILE           * ERROR 16 E206511117
423400200610     C***********          Z-ADD16        DBASE            ***********E206511117
423500200610     C***********          SETON                       U7U8               S01117
423600200610     C***********          MOVE '0'       RTNC                            S01117
423700200610     C***********          EXSR RETSR                                     S01117
423800200610     C***********          END                                            S01117
423900200610     C**
424000200610     C                     Z-ADDPCCDP     ZDECS   10
424100200610     C                     MOVE 'L'       ZECODE
424200200610     C                     MOVE ZAMTCO    ZFLD15
424300200610     C                     EXSR ZSEDIT
424400200610     C                     MOVE ZOUT21    SMVPF
424500200610     C***********          EXSR ADJUST                                    S01176
424600200610     C***********          MOVE WORKAD    SMVPFA                          S01176
424700200610     C***********SMVPFA    IFEQ *BLANKS                                   S01176
424800200610     C***********          MOVE *BLANKS   SMVPF                           S01176
424900200610     C***********          END                                            S01176
425000200610     C**
425100200610     C**   Accumulate total market valuation - portfolio
425200200610     C**
425300200610     C                     ADD  ZAMTCO    TOTMVP
425400200610     C**
425500200610     C                     MOVE POSL2     SLINE
425600200610     C                     END
425700200610     C**
425800200610     C**  SFLT=4 THIRD SECURITY/POSITION DETAILS LINE
425900200610     C**
426000200610     C           SFLT      IFEQ 4
426100200610     C                     SETON                     08
426200200610     C/COPY WNCPYSRC,SE0215C002
426300200610     C**
426400200610     C**   Format accrued interest AMOUNT AND DAYS
426500200610     C**
426600200610     C                     Z-ADDLCPN      ZFDAT
426700200610     C           ZFDAT     IFEQ 0
426800200610     C                     Z-ADDISSD      ZFDAT
426900200610     C                     END
427000200610     C                     Z-ADDECD       ZTDAT
427100200610     C*                                                                   S01408
427200200610     C** Core hook for externalisation.                                   S01408
427300200610     C/COPY WNCPYSRC,SE0215CPSR                                           S01408
427400200610     C*                                                                   S01408
427500200610     C                     MOVE SESN      ZSECT
427600200610     C                     MOVE SAVBR     ZBRCH
427700200610     C***********          MOVE PCUST     ZCUST                           S01117
427800200610     C                     MOVE @PCUST    ZCUST                           S01117
427900200610     C*
428000200610     C***********PROT      IFEQ '6'                                       E38091
428100200610     C***********          Z-ADD0         ZCUMCP                          E38091
428200200610     C***********          END                                            E38091
428300200610     C*                                                                   S01496
428400200610     C           S01496    IFNE 'Y'                        *B1            S01496
428500200610     C           CSE007    ANDNE'Y'                                       CSE007
428600200610     C           CEU017    ANDNE'Y'                                       CEU017
428700200610     C                     EXSR ZACRCI
428800200610     C*                                                                   S01496
428900200610     C                     ELSE                            *X1            S01496
429000200610     C                     MOVE CDPA      W1CDBR  3                       S01496
429100200610     C**********           Z-ADDCDCN      W1CDCN  60                                   S01496 CSD027
429200200610     C                     MOVE CDCN      W1CDCN  6                                           CSD027
429300200610     C                     MOVE CDSN      W1CDSN 10                       S01496
429400200610     C                     MOVE PTFR      W1PTFR  4                                           233736
429500200610     C**********           Z-ADDCDPT      W1CDPT  60                                   S01496 CSD027
429600200610     C                     MOVE CDPT      W1CDPT  6                                           CSD027
429700200610     C                     MOVE CDMK      W1CDMK  1                       S01496
429800200610     C*                                                                   S01496
429900200610     C**  SETLL ON CDEPP WITH BRANCH, CUSTOMER AND SECURITY SHORTNAME     S01496
430000200610     C*                                                                   S01496
430100200610     C********** KEY2      SETLLCDEPP                                                  S01496 233736
430200200610     C**********           READ CDEPP                    83                            S01496 233736
430300200610     C           KEY2      SETLLCDEPF                                                         233736
430400200610     C                     READ CDEPF                    83                                   233736
430500200610     C*                                                                   S01496
430600200610     C**  SET TOTAL ACCRUED INTEREST TO ZERO                              S01496
430700200610     C*                                                                   S01496
430800200610     C                     Z-ADD*ZEROS    WIAMT                           S01496
430900200610     C*                                                                   S01496
431000200610     C**  DO WHILE NOT END OF FILE AND SAME BRANCH, CUSTOMER AND SECURITY S01496
431100200610     C*                                                                   S01496
431200200610     C           *IN83     DOWEQ*ZEROS                                    S01496
431300200610     C           CDPA      ANDEQSAVBR                                     S01496
431400200610     C           CDCN      ANDEQPCUST                                     S01496
431500200610     C           CDSN      ANDEQSAVSEC                                    S01496
431600200610     C*                                                                   S01496
431700200610     C                     Z-ADD0         ZCUMCP                          S01496
431800200610     C*                                                                   S01496
431900200610     C                     ADD  CDNV      ZCUMCP                          S01496
432000200610     C                     ADD  CNPV      ZCUMCP                          S01496
432100200610     C                     ADD  CNSV      ZCUMCP                          S01496
432200200610     C                     SUB  CECN      ZCUMCP                          S01496
432300200610     C*                                                                   S01496
432400200610     C           PROT      IFEQ '6'                                       S01496
432500200610     C                     Z-ADD0         ZCUMCP                          S01496
432600200610     C                     END                                            S01496
432700200610     C*                                                                   S01496
432800200610     C**********           Z-ADDCDPT      ZDEPT                                        S01496 CSD027
432900200610     C                     MOVE CDPT      ZDEPT                                               CSD027
433000200610     C                     MOVE PTFR      ZPTFR                           S01496
433100200610     C*                                                                   S01496
433200200610     C                     EXSR ZACRCI                                    S01496
433300200610     C*                                                                   S01496
433400200610     C**  ACCUMULATE ACCRUED INTEREST AND IN WORK FIELD                   S01496
433500200610     C*                                                                   S01496
433600200610     C                     ADD  ZIAMT     WIAMT  150                      S01496
433700200610     C*                                                                   S01496
433800200610     C**  READ NEXT RECORD                                                S01496
433900200610     C*                                                                   S01496
434000200610     C**********           READ CDEPP                    83                            S01496 233736
434100200610     C                     READ CDEPF                    83                                   233736
434200200610     C                     END                                            S01496
434300200610     C*                                                                   S01496
434400200610     C                     Z-ADDWIAMT     ZIAMT                           S01496
434500200610     C*                                                                   S01496
434600200610     C********** KEY1      SETLLCDEPP                                                  S01496 233736
434700200610     C**********           READ CDEPP                    81                            S01496 233736
434800200610     C           KEY1      SETLLCDEPF                                                         233736
434900200610     C                     READ CDEPF                    81                                   233736
435000200610     C*                                                                   S01496
435100200610     C                     END                             *E1            S01496
435200200610     C*                                                                   S01496
435300200610     C***********SPBS      IFEQ 'P'                                 E15851E31776
435400200610     C***********          DIV  100       ZIAMT     H               E15851E31776
435500200610     C***********          END                                      E15851E31776
435600200610     C                     Z-ADDSAVCDP    ZDECS   10
435700200610     C                     MOVE 'L'       ZECODE
435800200610     C                     MOVE ZIAMT     ZFLD15
435900200610     C                     EXSR ZSEDIT
436000200610     C                     MOVE ZOUT21    SINTT
436100200610      **
436200200610     C***********PROT      IFEQ '6'                                       E38091
436300200610     C***********          MOVE *BLANKS   SINTD                           E38091
436400200610     C***********          MOVE *BLANKS   ACIN2                           E38091
436500200610     C***********          ELSE                                           E38091
436600200610     C                     MOVE 'DAYS'    ACIN2
436700200610     C                     Z-ADD0         ZDECS   10
436800200610     C                     MOVE 'L'       ZECODE
436900200610     C                     Z-ADDZACDY     ZFLD15
437000200610     C                     EXSR ZSEDIT
437100200610     C                     MOVE ZOUT21    SINTD
437200200610     C***********          END                                            E38091
437300200610     C**
437400200610      *                                                                                       233736
437500200610      ** Display accrued interest line only if there are values                               233736
437600200610      *                                                                                       233736
437700200610     C           CPNR      IFEQ *ZERO                                                         233736
437800200610     C                     MOVE *BLANKS   ACIN1                                               233736
437900200610     C                     MOVE *BLANKS   ACIN1A                                              233736
438000200610     C                     MOVE *BLANKS   SINTD                                               233736
438100200610     C                     MOVE *BLANKS   ACIN2                                               233736
438200200610     C                     MOVE *BLANKS   SINTT                                               233736
438300200610     C                     ELSE                                                               233736
438400200610     C                     MOVE '+ACC. IN'ACIN1                                               233736
438500200610     C                     MOVE 'T'       ACIN1A                                              233736
438600200610     C                     ENDIF                                                              233736
438700200610      *                                                                                       233736
438800200610      ** Display average fiscal price details if not zero                                     233736
438900200610      *                                                                                       233736
439000200610     C                     MOVE *BLANKS   DAVFP                                               233736
439100200610     C           WAVFP     IFNE *ZERO                                                         233736
439200200610     C                     MOVE 'FISCAL ' NAFP1                                               233736
439300200610     C                     MOVE 'PRICE'   NAFP2                                               233736
439400200610     C                     MOVE '0'       *IN15                                               233736
439500200610     C                     Z-ADD8         ZDECS                                               233736
439600200610     C                     MOVE 'L'       ZECODE                                              233736
439700200610     C                     MOVE *BLANKS   ZFLD15                                              233736
439800200610     C                     MOVE WAVFP     ZFLD15                                              233736
439900200610     C                     EXSR ZSEDIT                                                        233736
440000200610     C                     MOVE ZOUT21    SAVFP                                               233736
440100200610     C                     Z-ADD0         WCSNV  150                                          233736
440200200610     C                     Z-ADD0         WCSAV  150                                          233736
440300200610     C                     ENDIF                                                              233736
440400200610      *                                                                                       233736
440500200610     C                     MOVE POSL3     SLINE
440600200610     C                     END
440700200610     C**
440800200610     C**  SFLT=5 FUTURE VALUE TRADES HEADER LINE
440900200610     C**
441000200610     C           SFLT      IFEQ 5
441100200610     C                     MOVE FUTL1     SLINE
441200200610     C                     SETON                     08
441300200610     C                     END
441400200610     C**
441500200610     C**  SFLT>=6 FUTURE VALUE TRADES DETAIL LINE
441600200610     C**
441700200610     C           SFLT      IFGE 6
441800200610     C                     SETON                     08
441900200610     C**
442000200610     C**   Format trade type
442100200610     C**
442200200610     C                     MOVE TDTP      STDTP
442300200610     C**
442400200610     C**   Format nominal
442500200610     C**
442600200610     C                     Z-ADDNMDP      ZDECS   10
442700200610     C                     MOVE 'L'       ZECODE
442800200610     C                     Z-ADDNOML      ZFLD15
442900200610     C                     EXSR ZSEDIT
443000200610     C                     MOVE ZOUT21    SNOMT
443100200610     C**
443200200610     C**   Format price
443300200610     C**
443400200610     C                     Z-ADD8         ZDECS   10
443500200610     C                     MOVE 'L'       ZECODE
443600200610     C                     MOVE PRIC      ZFLD15
443700200610     C                     EXSR ZSEDIT
443800200610     C                     MOVE Z21L3     SPRIC
443900200610     C           SPBS      IFEQ 'P'
444000200610     C                     MOVE '%'       P3
444100200610     C                     ELSE
444200200610     C                     MOVE ' '       P3
444300200610     C                     END
444400200610     C**
444500200610     C**   Format value date
444600200610     C**
444700200610     C                     Z-ADDTDVD      ZDAYNO
444800200610     C                     EXSR ZDATE2
444900200610     C                     MOVE ZADATE    STDVD
445000200610     C                     MOVE FUTL2     SLINE
445100200610     C                     END
445200200610     C**
445300200610     C**   And output details to subfile
445400200610     C**
445500200610     C/COPY WNCPYSRC,SE0215C003
445600200610     C                     ADD  1         SFLREC
445700200610     C/COPY WNCPYSRC,SE0215C026
445800200610     C                     ADD  1         OUTREC
445900200610     C/COPY WNCPYSRC,SE0215C027
446000200610     C                     WRITESE0215S0
446100200610     C/COPY WNCPYSRC,SE0215C004
446200200610     C**
446300200610     C                     ENDSR
446400200610     C**
446500200610     C*****************************************************************
446600200610      /EJECT
446700200610     C*****************************************************************   S01176
446800200610     C**                                                              *   S01176
446900200610     C**  YPRICE - S/R to set up arrays which are used to calculate   *   S01176
447000200610     C**           yield based on days to maturity                    *   S01176
447100200610     C**                                                              *   S01176
447200200610     C**   Called by  SUBFIL                                          *   S01176
447300200610     C**                                                              *   S01176
447400200610     C**   Calls  SR  ZYMTX                                           *   S01176
447500200610     C**                                                              *   S01176
447600200610     C**   Calls PGM  NONE                                            *   S01176
447700200610     C**                                                              *   S01176
447800200610     C*****************************************************************   S01176
447900200610     C**                                                                  S01176
448000200610     C           YPRICE    BEGSR                                          S01176
448100200610     C*                                                                   S01176
448200200610     C** LOAD ARRAY OF NO. OF DAYS TO MATURITY USING VALUES ON            S01176
448300200610     C** RECORD READ FROM LF/CPPRIC                                       S01176
448400200610     C*                                                                   S01176
448500200610     C                     MOVE ND01      ZND,1                           S01176
448600200610     C                     MOVE ND02      ZND,2                           S01176
448700200610     C                     MOVE ND03      ZND,3                           S01176
448800200610     C                     MOVE ND04      ZND,4                           S01176
448900200610     C                     MOVE ND05      ZND,5                           S01176
449000200610     C                     MOVE ND06      ZND,6                           S01176
449100200610     C                     MOVE ND07      ZND,7                           S01176
449200200610     C                     MOVE ND08      ZND,8                           S01176
449300200610     C                     MOVE ND09      ZND,9                           S01176
449400200610     C                     MOVE ND10      ZND,10                          S01176
449500200610     C                     MOVE ND11      ZND,11                          S01176
449600200610     C                     MOVE ND12      ZND,12                          S01176
449700200610     C                     MOVE ND13      ZND,13                          S01176
449800200610     C                     MOVE ND14      ZND,14                          S01176
449900200610     C                     MOVE ND15      ZND,15                          S01176
450000200610     C                     MOVE ND16      ZND,16                          S01176
450100200610     C                     MOVE ND17      ZND,17                          S01176
450200200610     C                     MOVE ND18      ZND,18                          S01176
450300200610     C                     MOVE ND19      ZND,19                          S01176
450400200610     C                     MOVE ND20      ZND,20                          S01176
450500200610     C                     MOVE ND21      ZND,21                          S01176
450600200610     C                     MOVE ND22      ZND,22                          S01176
450700200610     C                     MOVE ND23      ZND,23                          S01176
450800200610     C                     MOVE ND24      ZND,24                          S01176
450900200610     C                     MOVE ND25      ZND,25                          S01176
451000200610     C*                                                                   S01176
451100200610     C** LOAD ARRAY OF CORRESPONDING YIELD RATES AS DEFINED ON THE        S01176
451200200610     C** RECORD READ FROM LF/CPPRIC                                       S01176
451300200610     C*                                                                   S01176
451400200610     C                     MOVE YR01      ZRT,1                           S01176
451500200610     C                     MOVE YR02      ZRT,2                           S01176
451600200610     C                     MOVE YR03      ZRT,3                           S01176
451700200610     C                     MOVE YR04      ZRT,4                           S01176
451800200610     C                     MOVE YR05      ZRT,5                           S01176
451900200610     C                     MOVE YR06      ZRT,6                           S01176
452000200610     C                     MOVE YR07      ZRT,7                           S01176
452100200610     C                     MOVE YR08      ZRT,8                           S01176
452200200610     C                     MOVE YR09      ZRT,9                           S01176
452300200610     C                     MOVE YR10      ZRT,10                          S01176
452400200610     C                     MOVE YR11      ZRT,11                          S01176
452500200610     C                     MOVE YR12      ZRT,12                          S01176
452600200610     C                     MOVE YR13      ZRT,13                          S01176
452700200610     C                     MOVE YR14      ZRT,14                          S01176
452800200610     C                     MOVE YR15      ZRT,15                          S01176
452900200610     C                     MOVE YR16      ZRT,16                          S01176
453000200610     C                     MOVE YR17      ZRT,17                          S01176
453100200610     C                     MOVE YR18      ZRT,18                          S01176
453200200610     C                     MOVE YR19      ZRT,19                          S01176
453300200610     C                     MOVE YR20      ZRT,20                          S01176
453400200610     C                     MOVE YR21      ZRT,21                          S01176
453500200610     C                     MOVE YR22      ZRT,22                          S01176
453600200610     C                     MOVE YR23      ZRT,23                          S01176
453700200610     C                     MOVE YR24      ZRT,24                          S01176
453800200610     C                     MOVE YR25      ZRT,25                          S01176
453900200610     C/COPY WNCPYSRC,SE0215C015
454000200610     C*                                                                   S01176
454100200610     C                     Z-ADDRUND      ZBASD                           S01176
454200200610     C                     Z-ADDMATY      ZMDAT                           S01176
454300200610     C                     EXSR ZYMTX                                     S01176
454400200610     C*                                                                   S01176
454500200610     C                     ENDSR                                          S01176
454600200610     C*                                                                   S01176
454700200610     C*****************************************************************
454800200610      /EJECT
454900200610     C*****************************************************************
455000200610     C**                                                              *
455100200610     C**   ADJUST SR  REMOVE DECIMAL PLACES FROM A FIELD              *
455200200610     C**                                                              *
455300200610     C**   Called by  SUBFIL TOTFIL                                   *
455400200610     C**   Calls  SR  none                                            *
455500200610     C**   Calls PGM  NONE                                            *
455600200610     C**                                                              *
455700200610     C*****************************************************************
455800200610     C**
455900200610     C           ADJUST    BEGSR                           ** ADJUST *****
456000200610     C**
456100200610     C** FIRST LOOK BACKWARDS FOR DECIMAL POINT
456200200610     C**
456300200610     C                     MOVE *BLANKS   WORKAD
456400200610     C                     MOVEAZOUT21    ZS2
456500200610     C                     Z-ADD21        X
456600200610     C                     DO   21
456700200610     C           ZS2,X     IFEQ '.'
456800200610     C                     GOTO ADDPFD
456900200610     C                     END
457000200610     C                     SUB  1         X
457100200610     C                     END
457200200610     C**
457300200610     C** MOVE SIGNIFICANT DIGITS TO  OUTPUT FIELD
457400200610     C**
457500200610     C           ADDPFD    TAG                             ** ADDPFD TAG**
457600200610     C           X         IFGT 1
457700200610     C                     SUB  1         X
457800200610     C                     ELSE
457900200610     C                     ADD  20        X
458000200610     C                     END
458100200610     C                     Z-ADD21        J       20
458200200610     C                     Z-ADDX         K       20
458300200610     C                     DO   X
458400200610     C                     MOVE ZS2,K     ZAD,J
458500200610     C                     SUB  1         J
458600200610     C                     SUB  1         K
458700200610     C                     END
458800200610     C**
458900200610     C                     ENDSR
459000200610     C**
459100200610     C*****************************************************************
459200200610      /EJECT
459300200610     C*****************************************************************
459400200610     C**                                                              *
459500200610     C**   LINK   SR  Lower level Enquiry requested                   *
459600200610     C**                                                              *
459700200610     C**   Called by  MAIN                                            *
459800200610     C**   Calls  SR  none                                            *
459900200610     C**   Calls PGM  lower level enquiry obtained from SECOND        *
460000200610     C**                                                              *
460100200610     C*****************************************************************
460200200610     C**
4603002006100740 C           LINK      BEGSR                           ***  LINK  ***
4604002006100741 C**
460500200610     C**   Access Linked Enquiry Control File for program and option
460600200610     C**
460700200610     C           LKEY      KLIST
460800200610     C                     KFLD           PGMNO
460900200610     C                     KFLD           OPTN
461000200610     C**
461100200610     C           LKEY      CHAINSECONDF              42
461200200610     C**
461300200610     C**   If record not found then entered option is invalid
461400200610     C**
461500200610     C           *IN42     IFEQ '1'
461600200610     C                     MOVE MSG,4     ERMSG
461700200610     C**
461800200610     C                     ELSE
461900200610     C**
462000200610     C**   For valid option write out LDA and linked enquiry data area
462100200610     C**   and call the program name obtained from SECOND
462200200610     C**
462300200610     C                     OUT  SESDS
462400200610     C                     OUT  LDA
462500200610     C                     CALL TPGM
462600200610     C           *LOCK     IN   LDA
462700200610     C           *LOCK     IN   SESDS
462800200610     C**
462900200610     C**   On return from lower level check return code
463000200610     C**
463100200610     C**   If 0 (Database Error) or 1 (F9 to return to menu)
463200200610     C**      then exit to calling program
463300200610     C**
463400200610     C           RTNC      IFEQ '0'
463500200610     C           RTNC      OREQ '1'
463600200610     C                     MOVE '1'       *IN01
463700200610     C                     END
463800200610     C**
463900200610     C**   If Return code is 7 (F9 to return to initial enquiry)
464000200610     C**      then check if this is the initial enquiry
464100200610     C**      and if not return to calling program
464200200610     C**
464300200610     C           RTNC      IFEQ '7'
464400200610     C           ORIG      ANDNEPGMNO
464500200610     C                     MOVE '1'       *IN01
464600200610     C                     END
464700200610     C**
464800200610     C                     END
464900200610     C/COPY WNCPYSRC,SE0215C028
465000200610     C**
465100200610     C                     ENDSR
465200200610     C**
465300200610     C*****************************************************************
465400200610      /EJECT
4655002006100738 C*****************************************************************
465600200610     C**                                                              *
465700200610     C**   RETSR  SR  End of Program Processing                       *
465800200610     C**              Write out LDA and linked enquiry data area      *
465900200610     C**              and return to the calling program               *
466000200610     C**                                                              *
466100200610     C**   Called by  MAIN, FIRST, DISP                               *
466200200610     C**   Calls  SR  none                                            *
466300200610     C**                                                              *
466400200610     C*****************************************************************
466500200610     C**
4666002006100740 C           RETSR     BEGSR                           *** RETSR   ***
4667002006100741 C**
466800200610     C           S01496    IFEQ 'Y'                                       S01496
466900200610     C                     CLOSESECDEPL1                                  S01496
467000200610     C                     ELSE                                           S01496
467100200610     C                     CLOSECDEPD                                     S01496
467200200610     C                     END                                            S01496
467300200610      *                                                                   S01496
467400200610     C/COPY WNCPYSRC,SE0215C007
467500200610     C                     OUT  SESDS
467600200610     C                     OUT  LDA
467700200610     C**
4678002006100742 C                     SETON                     LR
4679002006100391 C**
4680002006100743 C                     RETRN
4681002006100744 C*
4682002006100745 C                     ENDSR
4683002006100744 C*
468400200610     C*****************************************************************
468500200610      /EJECT
468600200610     C*****************************************************************
468700200610     C**                                                              *
468800200610     C**   FIRST  SR  First Cycle Processing                          *
468900200610     C**                                                              *
469000200610     C**   Called by  MAIN                                            *
469100200610     C**   Calls  SR  RETSR, CUSTIN, ZSYSTM, ZICD2, ZICDSE,ZEVCD      *
469200200610     C**                                                              *
469300200610     C*****************************************************************
469400200610     C**
469500200610     C           FIRST     BEGSR                           ** FIRST **
469600200610     C**
469700200610     C**     Access the LDA  and  Linked Enquiry Data Area
469800200610     C**
469900200610     C           *LOCK     IN   LDA
470000200610     C           *LOCK     IN   SESDS
470100200610     C                     IN   JNSTAT
470200200610     C                     UNLCKJNSTAT
470300200610     C***********                                                         S01117
470400200610     C****READ*INSTALLATION*CONTROL*RECORD*1*FOR*RUNDATE*                 S01117
470500200610     C***********                                                         S01117
470600200610     C*******Access*File*and*check*if*record*deleted*                     S01117
470700200610     C***********                                                         S01117
470800200610     C***********          EXSR ZSYSTM                                    S01117
470900200610     C***********                                                         S01117
471000200610     C*******If*no*record*found**or*deleted*record*                       S01117
471100200610     C**********then*it*is*a*database*error*so*return*to*calling*         S01117
471200200610     C**********program*with*a*return*code*of*'0'*                        S01117
471300200610     C***********                                                         S01117
471400200610     C************IN99     IFEQ '1'                                       S01117
471500200610     C***********          MOVELPROGRM    DBPGM                           S01117
471600200610     C***********          MOVEL'ICDR1'   DBKEY            ***************S01117
471700200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 01 *S01117
471800200610     C***********          Z-ADD01        DBASE            ***************S01117
471900200610     C***********          SETON                       U7U8               S01117
472000200610     C***********          MOVE '0'       RTNC                            S01117
472100200610     C***********          EXSR RETSR                                     S01117
472200200610     C***********          END                                            S01117
472300200610     C***********                                                         S01117
472400200610     C****READ*INSTALLATION*CONTROL*RECORD*2*FOR*mbin*                    S01117
472500200610     C***********                                                         S01117
472600200610     C*******Access*File*and*check*if*record*deleted*                     S01117
472700200610     C***********                                                         S01117
472800200610     C***********          EXSR ZICD2                                     S01117
472900200610     C***********                                                         S01117
473000200610     C*******If*no*record*found**or*deleted*record*                       S01117
473100200610     C**********then*it*is*a*database*error*so*return*to*calling*         S01117
473200200610     C**********program*with*a*return*code*of*'0'*                        S01117
473300200610     C***********                                                         S01117
473400200610     C************IN99     IFEQ '1'                                       S01117
473500200610     C***********          MOVELPROGRM    DBPGM                           S01117
473600200610     C***********          MOVEL'ICDR2'   DBKEY            ***************S01117
473700200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 02 *S01117
473800200610     C***********          Z-ADD02        DBASE            ***************S01117
473900200610     C***********          SETON                       U7U8               S01117
474000200610     C***********          MOVE '0'       RTNC                            S01117
474100200610     C***********          EXSR RETSR                                     S01117
474200200610     C***********          END                                            S01117
474300200610     C**
474400200610      ** Read in RUNDAT data area                                         S01117
474500200610      *                                                                   S01117
474600200610     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
474700200610     C                     IN   RUNDT                                     S01117
474800200610      *                                                                   S01117
474900200610      ** Check system date format, DDMMYY or MMDDYY.                      S01117
475000200610      *                                                                   S01117
475100200610     C           DATF      COMP 'M'                      98               S01117
475200200610      *                                                                   S01117
475300200610      ***Read*in*ZMUSER*data*area**********************************S01117 090314
475400200610      ***********                                                  S01117 090314
475500200610     C************NAMVAR   DEFN           ZMUSER                   S01117 090314
475600200610     C***********          IN   ZMUSER                             S01117 090314
475700200610      *                                                                   S01117
475800200610      ** Set on indicator 07 for DSPF if multibranching environment       S01117
475900200610      *                                                                   S01117
476000200610     C           MBIN      IFEQ 'Y'
476100200610     C                     MOVE '1'       *IN07
476200200610     C                     END
476300200610     C                     Z-ADDBJDNWD    ZZDNWD                          S01117
476400200610     C                     Z-ADDBKAPDT    ZZAPDT                          S01117
476500200610     C                     EXSR ZEVCD
476600200610      *                                                                   S01117
476700200610      ** Access bank details                                              S01117
476800200610      *                                                                   S01117
476900200610     C                     CALL 'AOBANKR0'                                S01117
477000200610     C                     PARM '*DBERR ' @RTCD   7                       S01117
477100200610     C                     PARM '*FIRST ' @OPTN   7                       S01117
477200200610     C           SDBANK    PARM SDBANK    DSFDY                           S01117
477300200610      *                                                                   S01117
477400200610      ** Access Securities Trading details                                S01117
477500200610      *                                                                   S01117
477600200610     C                     CALL 'AOSTRDR0'                                S01117
477700200610     C                     PARM '*DBERR ' @RTCD   7                       S01117
477800200610     C                     PARM '*FIRST ' @OPTN   7                       S01117
477900200610     C           SDSTRD    PARM SDSTRD    DSSDY                           S01117
478000200610      *                                                                   S01117
478100200610      ** Access General Ledger details                                    S01117
478200200610      *                                                                   S01117
478300200610     C**********           CALL 'AOGELRR0'                                S01117              CGL029
478400200610     C                     CALL 'AOGELRR1'                                                    CGL029
478500200610     C                     PARM '*DBERR ' @RTCD   7                       S01117
478600200610     C                     PARM '*FIRST ' @OPTN   7                       S01117
478700200610     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
478800200610     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
478900200610     C***********                                                         S01117
479000200610     C****READ*INSTALLATION*CONTROL*RECORD*SE*                            S01117
479100200610     C***********                                                         S01117
479200200610     C*******Access*File*and*check*if*record*deleted*                     S01117
479300200610     C***********                                                         S01117
479400200610     C***********          EXSR ZICDSE                                    S01117
479500200610     C***********                                                         S01117
479600200610     C*******If*no*record*found**or*deleted*record*                       S01117
479700200610     C**********then*it*is*a*database*error*so*return*to*calling*         S01117
479800200610     C**********program*with*a*return*code*of*'0'*                        S01117
479900200610     C***********                                                         S01117
480000200610     C************IN99     IFEQ '1'                                       S01117
480100200610     C***********          MOVELPROGRM    DBPGM                           S01117
480200200610     C***********          MOVEL'ICDSE'   DBKEY            ***************S01117
480300200610     C***********          MOVE 'TABLE'   DBFILE           * DB ERROR 03 *S01117
480400200610     C***********          Z-ADD03        DBASE            ***************S01117
480500200610     C***********          SETON                       U7U8               S01117
480600200610     C***********          MOVE '0'       RTNC                            S01117
480700200610     C***********          EXSR RETSR                                     S01117
480800200610     C***********          END                                            S01117
480900200610     C**
481000200610     C**     Calculate Accrual Control date
481100200610     C**
481200200610     C***********APDA      IFLT DNWD                                      S01117
481300200610     C***********ACLD      IFEQ 'Y'                                       S01117
481400200610     C***********          Z-ADDAPDA      ECD     50                      S01117
481500200610     C           BKAPDT    IFLT BJDNWD                                    S01117
481600200610     C           BKALDI    IFEQ 'Y'                                       S01117
481700200610     C                     Z-ADDBKAPDT    ECD     50                      S01117
481800200610     C                     ELSE
481900200610     C***********1         ADD  APDA      ECD                             S01117
482000200610     C           1         ADD  BKAPDT    ECD                             S01117
482100200610     C                     END
482200200610     C                     ELSE
482300200610     C***********ACLD      IFEQ 'Y'                                       S01117
482400200610     C***********APDA      SUB  1         ECD                             S01117
482500200610     C           BKALDI    IFEQ 'Y'                                       S01117
482600200610     C           BKAPDT    SUB  1         ECD                             S01117
482700200610     C                     ELSE
482800200610     C***********          Z-ADDDNWD      ECD                             S01117
482900200610     C                     Z-ADDBJDNWD    ECD                             S01117
483000200610     C                     END
483100200610     C                     END
483200200610     C/COPY WNCPYSRC,SE0215C008
483300200610      *                                                                   CSE007
483400200610      ***  Access Switchable features file for Corporate Actions.         CSE007
483500200610      *                                                                   CSE007
483600200610     C                     MOVE 'N'       CSE007  1                       CSE007
483700200610     C                     MOVE *OFF      *IN62                           CSE007
483800200610     C                     CALL 'AOSARDR0'                                CSE007
483900200610     C                     PARM '       ' @RTCD                           CSE007
484000200610     C                     PARM '*VERIFY' @OPTN                           CSE007
484100200610     C                     PARM 'CSE007'  WSARD                           CSE007
484200200610      *                                                                   CSE007
484300200610     C           @RTCD     IFEQ *BLANKS                                   CSE007
484400200610      *                                                                   CSE007
484500200610      ***  If Corporate Actions feature is installed.                     CSE007
484600200610      *                                                                   CSE007
484700200610     C                     MOVE 'Y'       CSE007                          CSE007
484800200610     C                     MOVE *ON       *IN62                           CSE007
484900200610     C                     ELSE                                           CSE007
485000200610      *                                                                   CSE007
485100200610      ***  Setup work field to call SE6710, SE6712, SE6714 and SE6716.    CSE007
485200200610      *                                                                   CSE007
485300200610     C                     MOVE 'Y'       SE6710  1                       CSE007
485400200610     C                     MOVE 'Y'       SE6712  1                       CSE007
485500200610     C                     MOVE 'Y'       SE6714  1                       CSE007
485600200610     C                     MOVE 'Y'       SE6716  1                       CSE007
485700200610     C                     ENDIF                                          CSE007
485800200610      *                                                                   CEU017
485900200610      ***  Access Switchable features file for Securities Redenomination  CEU017
486000200610      *                                                                   CEU017
486100200610     C                     MOVE 'N'       CEU017  1                       CEU017
486200200610     C                     CALL 'AOSARDR0'                                CEU017
486300200610     C                     PARM '       ' @RTCD                           CEU017
486400200610     C                     PARM '*VERIFY' @OPTN                           CEU017
486500200610     C                     PARM 'CEU017'  WSARD                           CEU017
486600200610      *                                                                   CEU017
486700200610     C           @RTCD     IFEQ *BLANKS                                   CEU017
486800200610      *                                                                   CEU017
486900200610      ***  If Securities Redenomination is installed.                     CEU017
487000200610      *                                                                   CEU017
487100200610     C                     MOVE 'Y'       CEU017                          CEU017
487200200610     C                     MOVE *ON       *IN62                           CEU017
487300200610     C                     ELSE                                           CEU017
487400200610      *                                                                   CEU017
487500200610      ***  Setup work field to call SE6710, SE6712, SE6714 and SE6716.    CEU017
487600200610      *                                                                   CEU017
487700200610     C                     MOVE 'Y'       SE6710  1                       CEU017
487800200610     C                     MOVE 'Y'       SE6712  1                       CEU017
487900200610     C                     MOVE 'Y'       SE6714  1                       CEU017
488000200610     C                     MOVE 'Y'       SE6716  1                       CEU017
488100200610     C                     ENDIF                                          CEU017
488200200610      *                                                                   103446
488300200610      **  Access SAR details file to see if JYSKE Enhcmts is installed.   103446
488400200610      *                                                                   103446
488500200610     C                     CALL 'AOSARDR0'                                103446
488600200610     C                     PARM '       ' @RTCD                           103446
488700200610     C                     PARM '*VERIFY' @OPTN                           103446
488800200610     C                     PARM 'S01496'  WSARD   6                       103446
488900200610      *                                                                   103446
489000200610     C           @RTCD     IFEQ *BLANK                                    103446
489100200610     C                     MOVE 'Y'       S01496  1                       103446
489200200610     C                     MOVE *ON       *IN61                           103446
489300200610     C                     END                                            103446
489400200610      *                                                                   CGL011
489500200610      ** Access Switchable Features file and check if CGL011              CGL011
489600200610      ** is switched on or not.                                           CGL011
489700200610      *                                                                   CGL011
489800200610     C                     CALL 'AOSARDR0'                                CGL011
489900200610     C                     PARM *BLANKS   PRTCD   7                       CGL011
490000200610     C                     PARM '*VERIFY' POTPN   7                       CGL011
490100200610     C                     PARM 'CGL011'  PSARD   6                       CGL011
490200200610     C           SCSARD    PARM SCSARD    DSFDY                           CGL011
490300200610      *                                                                   CGL011
490400200610     C           PRTCD     IFEQ *BLANKS                                   CGL011
490500200610     C                     MOVE 'Y'       CGL011  1                       CGL011
490600200610      *                                                                   CGL011
490700200610     C                     ELSE                                           CGL011
490800200610     C                     MOVE 'N'       CGL011                          CGL011
490900200610     C           PRTCD     IFNE '*NRF   '                                 CGL011
491000200610     C                     MOVELPROGRM    DBPGM            ***************CGL011
491100200610     C                     Z-ADD004       DBASE            * DB ERROR 004*CGL011
491200200610     C                     MOVEL'SCSARDPD'DBFILE           ***************CGL011
491300200610     C                     MOVEL'CGL011  'DBKEY                           CGL011
491400200610     C                     MOVE *ON       *INU7                           CGL011
491500200610     C                     MOVE *ON       *INU8                           CGL011
491600200610     C                     EXSR *PSSR                                     CGL011
491700200610     C                     MOVE '0'       RTNC                            CGL011
491800200610     C                     EXSR RETSR                                     CGL011
491900200610     C                     ENDIF                                          CGL011
492000200610     C                     ENDIF                                          CGL011
492100200610      *                                                                                       233736
492200200610      ** Check if Switchable feature for EU Savings is on                                     233736
492300200610      *                                                                                       233736
492400200610     C                     MOVE 'N'       CGL031  1                                           233736
492500200610     C                     CALL 'AOSARDR0'                                                    233736
492600200610     C                     PARM '       ' @RTCD                                               233736
492700200610     C                     PARM '*VERIFY' @OPTN                                               233736
492800200610     C                     PARM 'CGL031'  WSARD                                               233736
492900200610      *                                                                                       233736
493000200610     C           @RTCD     IFEQ *BLANKS                                                       233736
493100200610     C                     MOVE 'Y'       CGL031                                              233736
493200200610     C                     ENDIF                                                              233736
493300200610      *                                                                                       CGL014
493400200610      ** Access Switchable Features file and check if CGL014                                  CGL014
493500200610      ** is switched on or not.                                                               CGL014
493600200610      *                                                                                       CGL014
493700200610     C                     CALL 'AOSARDR0'                                                    CGL014
493800200610     C                     PARM *BLANKS   PRTCD                                               CGL014
493900200610     C                     PARM '*VERIFY' POTPN                                               CGL014
494000200610     C                     PARM 'CGL014'  PSARD                                               CGL014
494100200610     C           SCSARD    PARM SCSARD    DSFDY                                               CGL014
494200200610      *                                                                                       CGL014
494300200610     C           PRTCD     IFEQ *BLANKS                                                       CGL014
494400200610     C                     MOVE 'Y'       CGL014  1                                           CGL014
494500200610      *                                                                                       CGL014
494600200610     C                     ELSE                                                               CGL014
494700200610     C                     MOVE 'N'       CGL014                                              CGL014
494800200610     C           PRTCD     IFNE '*NRF   '                                                     CGL014
494900200610     C                     MOVELPROGRM    DBPGM                                               CGL014
495000200610     C                     Z-ADD005       DBASE                                               CGL014
495100200610     C                     MOVEL'SCSARDPD'DBFILE                                              CGL014
495200200610     C                     MOVEL'CGL014  'DBKEY                                               CGL014
495300200610     C                     MOVE *ON       *INU7                                               CGL014
495400200610     C                     MOVE *ON       *INU8                                               CGL014
495500200610     C                     EXSR *PSSR                                                         CGL014
495600200610     C                     MOVE '0'       RTNC                                                CGL014
495700200610     C                     EXSR RETSR                                                         CGL014
495800200610     C                     ENDIF                                                              CGL014
495900200610     C                     ENDIF                                                              CGL014
496000200610      *                                                                   103446
496100200610     C           S01496    IFEQ 'Y'                                       103446
496200200610     C           CSE007    OREQ 'Y'                                       CSE007
496300200610     C           CEU017    OREQ 'Y'                                       CEU017
496400200610     C                     OPEN SECDEPL1                                  103446
496500200610     C                     ELSE                                           103446
496600200610     C                     OPEN CDEPD                                     103446
496700200610     C                     END                                            103446
496800200610     C**
496900200610     C**     If no cust. number found in request data
497000200610     C**        setup a blank screen for display
497100200610     C**     else access details for display
497200200610     C**
497300200610     C                     MOVE '1'       *IN03
497400200610     C**
497500200610     C********** RQCUST    IFNE *ZEROS                                                        CSD027
497600200610     C           RQCUST    IFNE *BLANKS                                                       CSD027
497700200610     C           RQCUST    ANDNE*ZEROS                                                      BUG11745
497800200610     C                     MOVELRQCUST    CUSTMR 10
497900200610     C                     MOVE *BLANKS   RQCUST
498000200610     C***********          MOVELRQBRCH    BRANCH                          S01117
498100200610     C***********          MOVE *BLANKS   RQBRCH                          S01117
498200200610     C                     MOVELRQBRCA    BRANCH                          S01117
498300200610     C                     MOVE *BLANKS   RQBRCA                          S01117
498400200610     C                     EXSR CUSTIN
498500200610     C                     END
498600200610     C/COPY WNCPYSRC,SE0215C029
498700200610     C**
498800200610     C**      Access program name - for help and linked enquiries
498900200610     C**
499000200610     C                     MOVELPROGRM    PGMNO   8
499100200610     C**
499200200610     C**     SET UP STANDARD FIELDS FOR SFL LINES
499300200610     C                     MOVE '+ACC. IN'ACIN1
499400200610     C                     MOVE 'T'       ACIN1A
499500200610     C                     MOVE '*'       AST
499600200610     C                     MOVE 'AT'      AT
499700200610     C                     MOVE 'VALUE ON'VAL
499800200610     C                     MOVE '* FUTURE'FL1
499900200610     C                     MOVE ' VALUE T'FL2
500000200610     C                     MOVE 'RADES'   FL3
500100200610     C                     MOVE 'TOTAL PO'TL1
500200200610     C                     MOVE 'RTFOLIO 'TL2
500300200610     C                     MOVE 'VALUE'   TL3
500400200610     C                     MOVE 'NET'     TL4
500500200610      ***********                                                  S01496 103446
500600200610      ****Access*SAR details f*le to see if JYSKE Enhcmts is instalS01496 103446
500700200610      ***********                                                  S01496 103446
500800200610     C***********          CALL 'AOSARDR0'                         S01496 103446
500900200610     C***********          PARM '       ' @RTCD                    S01496 103446
501000200610     C***********          PARM '*VERIFY' @OPTN                    S01496 103446
501100200610     C***********          PARM 'S01496'  WSARD   6                S01496 103446
501200200610      ***********                                                  S01496 103446
501300200610     C***********@RTCD     IFEQ *BLANK                             S01496 103446
501400200610     C***********          MOVE 'Y'       S01496  1                S01496 103446
501500200610     C***********          MOVE *ON       *IN61                    S01496 103446
501600200610     C***********          END                                     S01496 103446
501700200610      ***********                                                  S01496 103446
501800200610     C***********S01496    IFEQ 'Y'                                S01496 103446
501900200610     C***********          OPEN SECDEPL1                           S01496 103446
502000200610     C***********          ELSE                                    S01496 103446
502100200610     C***********          OPEN CDEPD                              S01496 103446
502200200610     C***********          END                                     S01496 103446
502300200610     C**
502400200610      *                                                                                       CSE035
502500200610      ** Access SAR details file to see if CSE035 is installed                                CSE035
502600200610      *                                                                                       CSE035
502700200610     C                     CALL 'AOSARDR0'                                                    CSE035
502800200610     C                     PARM *BLANKS   @RTCD                                               CSE035
502900200610     C                     PARM '*VERIFY' @OPTN                                               CSE035
503000200610     C                     PARM 'CSE035'  WSARD                                               CSE035
503100200610      *                                                                                       CSE035
503200200610     C           @RTCD     IFEQ *BLANK                                                        CSE035
503300200610     C                     MOVE 'Y'       CSE035  1                                           CSE035
503400200610     C                     ELSE                                                               CSE035
503500200610     C                     MOVE 'N'       CSE035                                              CSE035
503600200610     C                     END                                                                CSE035
503700200610      *                                                                                       207543
503800200610      ** Access SAR details file to see if CEU018 is installed                                207543
503900200610      *                                                                                       207543
504000200610     C                     CALL 'AOSARDR0'                                                    207543
504100200610     C                     PARM *BLANKS   @RTCD                                               207543
504200200610     C                     PARM '*VERIFY' @OPTN                                               207543
504300200610     C                     PARM 'CEU018'  WSARD                                               207543
504400200610      *                                                                                       207543
504500200610     C           @RTCD     IFEQ *BLANK                                                        207543
504600200610     C                     MOVE 'Y'       CEU018  1                                           207543
504700200610     C                     ELSE                                                               207543
504800200610     C                     MOVE 'N'       CEU018                                              207543
504900200610     C                     END                                                                207543
505000200610      *                                                                                       CSE035
505100200610     C/COPY WNCPYSRC,SE0215C005
505200200610     C                     ENDSR
505300200610     C**
505400200610     C*****************************************************************
505500200610      /EJECT                                                              S01117
505600200610      *****************************************************************   S01117
505700200610      *                                                               *   S01117
505800200610      * CHKSEL - Subroutine to check for question marks.              *   S01117
505900200610      *                                                               *   S01117
506000200610      * Called by: MAIN                                               *   S01117
506100200610      *                                                               *   S01117
506200200610      * Calls: None                                                   *   S01117
506300200610      *                                                               *   S01117
506400200610      *****************************************************************   S01117
506500200610      *                                                                   S01117
506600200610     C           CHKSEL    BEGSR                                          S01117
506700200610      *                                                                   S01117
506800200610     C                     Z-ADD0         @SEL    10                      S01117
506900200610      *                                                                   S01117
507000200610     C                     MOVELCUSTMR    @QMK    1                       S01117
507100200610     C           @QMK      IFEQ '?'                                       S01117
507200200610     C                     Z-ADD1         @SEL                            S01117
507300200610      *                                                                   S01117
507400200610      ** Access Securities Clients Details file                           S01117
507500200610      *                                                                   S01117
507600200610     C                     CALL 'AOSECSR0'                                S01117
507700200610     C                     PARM *BLANKS   @RTCD   7                       S01117
507800200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
507900200610     C                     PARM '?     '  @AENB   6                       S01117
508000200610     C           SDSECS    PARM SDSECS    DSSDY                           S01117
508100200610     C           @RTCD     IFEQ '*NOSEL'                                  S01117
508200200610     C                     MOVE *BLANK    CUSTMR                          S01117
508300200610     C                     ELSE                                           S01117
508400200610     C                     MOVE *BLANK    CUSTMR                          S01117
508500200610     C                     MOVELBFCUST    CUSTMR                          S01117
508600200610     C                     END                                            S01117
508700200610     C                     END                                            S01117
508800200610      *                                                                   S01117
508900200610     C                     MOVELBRANCH    @QMK    1                       S01117
509000200610     C           @QMK      IFEQ '?'                                       S01117
509100200610     C                     Z-ADD1         @SEL                            S01117
509200200610      *                                                                   S01117
509300200610      ** Access branch details file SDBRCHPD via access object program    S01117
509400200610      *                                                                   S01117
509500200610     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
509600200610     C                     CALL 'AOBRCHR1'                                                    CGL029
509700200610     C                     PARM *BLANKS   @RTCD   7                       S01117
509800200610     C                     PARM '*KEY   ' @OPTN   7                       S01117
509900200610     C                     PARM '?  '     @BRCD   3                       S01117
510000200610     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
510100200610     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
510200200610     C           @RTCD     IFEQ '*NOSEL'                                  S01117
510300200610     C                     MOVE *BLANK    BRANCH                          S01117
510400200610     C                     ELSE                                           S01117
510500200610     C                     MOVE A8BRCD    BRANCH                          S01117
510600200610     C                     END                                            S01117
510700200610     C                     END                                            S01117
510800200610      *                                                                   S01117
510900200610     C                     ENDSR                                          S01117
511000200610      *****************************************************************   S01117
511100200610      /EJECT                                                              S01117
511200200610      *****************************************************************   S01117
511300200610      *                                                               *   S01117
511400200610      *  *PSSR  - Error control subroutine                            *   S01117
511500200610      *                                                               *   S01117
511600200610      *****************************************************************   S01117
511700200610      *                                                                   S01117
511800200610     C           *PSSR     BEGSR                           ** *PSSR **    S01117
511900200610     C**                                                                  S01117
512000200610     C           @RUN      IFEQ *BLANKS                                   S01117
512100200610     C                     MOVE 'Y'       @RUN    1                       S01117
512200200610     C                     DUMP                                           S01117
512300200610     C                     END                                            S01117
512400200610     C**                                                                  S01117
512500200610     C                     ENDSR                                          S01117
512600200610      *                                                                   S01117
512700200610     C/EJECT                                                              159599
512800200610     C*****************************************************************   159599
512900200610     C*                                                               *   159599
513000200610     C*  R0455  :  Accumulate details for a Security                  *   159599
513100200610     C*                                                               *   159599
513200200610     C*  Called by :  DISP                                            *   159599
513300200610     C*                                                               *   159599
513400200610     C*  Calls     :  None                                            *   159599
513500200610     C*                                                               *   159599
513600200610     C*****************************************************************   159599
513700200610     C*                                                                   159599
513800200610     C           R0455     BEGSR                                          159599
513900200610     C*                                                                   159599
514000200610     C** Accumulate details for a Security                                159599
514100200610     C*                                                                   159599
514200200610     C           SAVBR     IFEQ CDPA                                      159599
514300200610     C           PCUST     ANDEQCDCN                                      159599
514400200610     C*                                                                   159599
514500200610     C                     ADD  CDNV      ZCUMCP                          159599
514600200610     C                     ADD  CNPV      ZCUMCP                          159599
514700200610     C                     ADD  CNSV      ZCUMCP                          159599
514800200610     C                     SUB  CECN      ZCUMCP                          159599
514900200610     C           BVTVDV    IFEQ 'T'                                       159599
515000200610     C                     ADD  CDNT      ZNOMP                           159599
515100200610     C                     ADD  CDNT      ZZNOML                          159599
515200200610     C                     ADD  SNPT      ZZNOML                          159599
515300200610     C                     ADD  CDST      ZZNOML                          159599
515400200610     C                     ADD  CDNV      ZZNOMU                          159599
515500200610     C                     ADD  CNPV      ZZNOMU                          159599
515600200610     C                     ADD  CNSV      ZZNOMU                          159599
515700200610     C*                                                                   159599
515800200610     C** REMEMBER: For customer, TP is a sale, TS is a purchase           159599
515900200610     C*                                                                   159599
516000200610     C                     ADD  SNPT      ZZSAL                           159599
516100200610     C                     ADD  CDST      ZZPUR                           159599
516200200610     C                     ADD  SAPP      ZZAPS                           159599
516300200610     C                     ADD  SAPS      ZZAPP                           159599
516400200610     C                     ELSE                                           159599
516500200610     C                     ADD  CDNV      ZNOMP                           159599
516600200610     C                     ADD  CDNV      ZZNOML                          159599
516700200610     C                     ADD  CNPV      ZZNOML                          159599
516800200610     C                     ADD  CNSV      ZZNOML                          159599
516900200610     C                     ADD  CDNT      ZZNOMU                          159599
517000200610     C                     ADD  SNPT      ZZNOMU                          159599
517100200610     C                     ADD  CDST      ZZNOMU                          159599
517200200610     C*                                                                   159599
517300200610     C** REMEMBER: For customer, TP is a sale, TS is a purchase           159599
517400200610     C*                                                                   159599
517500200610     C                     ADD  CNPV      ZZSAL                           159599
517600200610     C                     ADD  CNSV      ZZPUR                           159599
517700200610     C                     ADD  SAPV      ZZAPS                           159599
517800200610     C                     ADD  SPSV      ZZAPP                           159599
517900200610     C                     ENDIF                                          159599
518000200610     C                     MOVE '1'       *IN50                           159599
518100200610      *                                                                                       233736
518200200610      ** Check for security if subject to EU tax -                                            233736
518300200610      ** If so, get the latest position and details of the                                    233736
518400200610      ** average fiscal price of all portfolios for averaging                                 233736
518500200610      *                                                                                       233736
518600200610     C           CDSN      CHAINSECTY                15                                       233736
518700200610     C           *IN15     IFEQ '0'                                                           233736
518800200610     C                     MOVE MKTI      SVMKT   1                                           233736
518900200610     C                     ENDIF                                                              233736
519000200610     C           CGL031    IFEQ 'Y'                                                           233736
519100200610     C           SETX      ANDEQ'Y'                                                           233736
519200200610      *                                                                                       233736
519300200610     C                     MOVE PCUST     PCUST2                                              233736
519400200610     C           KCPOS     IFNE PCPOS                                                         233736
519500200610     C                     CALL WPGM                                                          233736
519600200610     C                     PARM           WRTCD  10                                           233736
519700200610     C                     PARM           SAVBR                                               233736
519800200610     C                     PARM           PCUST                                               233736
519900200610     C                     PARM           CDSN                                                233736
520000200610     C                     PARM           PTFR                                                233736
520100200610     C                     PARM           SVMKT                                               233736
520200200610     C                     PARM           RUND                                                233736
520300200610     C                     PARM           ETCPOS                                              233736
520400200610     C                     MOVE KCPOS     PCPOS                                               233736
520500200610     C                     ADD  CSNV      WCSNV                                               233736
520600200610     C                     ADD  CSAV      WCSAV                                               233736
520700200610     C                     ENDIF                                                              233736
520800200610      *                                                                                       233736
520900200610     C                     ENDIF                                                              233736
521000200610     C*                                                                   159599
521100200610     C                     ENDIF                                          159599
521200200610     C*                                                                   159599
521300200610     C                     ENDSR                                          159599
521400200610     C*****************************************************************   159599
521500200610      ********************************************************************S01117
521600200610      ***/EJECT**                                                   S01232S01195
521700200610     C***/COPY*ZSRSRC,XDATE3Z1                                      S01232S01195
521800200610      /EJECT                                                              S01195
521900200610     C/COPY ZSRSRC,ZACCH                                                  S01195
522000200610      /EJECT
522100200610     C/COPY ZSRSRC,ZACCRZ1
522200200610     C/EJECT                                                              E39495
522300200610     C/COPY ZSRSRC,ZACCZZ1                                                E39495
522400200610      /EJECT
522500200610     C/COPY ZSRSRC,ZALIGNZ2
522600200610      /EJECT                                                              S01195
522700200610     C/COPY ZSRSRC,ZBKDT                                                  S01195
522800200610     C/EJECT                                                              E39495
522900200610     C/COPY ZSRSRC,ZCALCD                                                 E39495
523000200610     C/EJECT                                                              E39495
523100200610     C/COPY ZSRSRC,ZCNSDZ1                                                E39495
523200200610      /EJECT
523300200610     C/COPY ZSRSRC,ZCONVZ1
523400200610      /EJECT
523500200610     C/COPY ZSRSRC,ZDATE1Z2
523600200610      /EJECT
523700200610     C/COPY ZSRSRC,ZDATE2Z4
523800200610      /EJECT
523900200610     C/COPY ZSRSRC,ZDAYSZ2
524000200610      /EJECT
524100200610     C/COPY ZSRSRC,ZDYYRZ3
524200200610      /EJECT
524300200610     C/COPY ZSRSRC,ZEVCDZ1
524400200610      ***/EJECT**                                                         S01117
524500200610     C***/COPY*ZSRSRC,ZICD2Z1                                             S01117
524600200610      ***/EJECT**                                                         S01117
524700200610     C***/COPY*ZSRSRC,ZICDSEZ1                                            S01117
524800200610      /EJECT                                                              E20380
524900200610     C/COPY ZSRSRC,ZLCDZ1                                                 E20380
525000200610      /EJECT
525100200610     C/COPY ZSRSRC,ZNCDZ3
525200200610      /EJECT                                                              S01176
525300200610     C/COPY ZSRSRC,ZPRCIZ1                                                S01176
525400200610      /EJECT
525500200610     C***** /COPY ZSRSRC,ZPRCOZ1                                          S01186
525600200610     C/COPY ZSRSRC,ZPRCOZ1                                                E16894
525700200610      /EJECT
525800200610     C/COPY ZSRSRC,ZRATEZ1
525900200610      /EJECT                                                              S01232
526000200610     C/COPY ZSRSRC,ZRSTORZ1                                               S01232
526100200610      /EJECT                                                              S01232
526200200610     C/COPY ZSRSRC,ZSAVEZ1                                                S01232
526300200610      /EJECT
526400200610     C/COPY ZSRSRC,ZSDESCZ3
526500200610      /EJECT
526600200610     C/COPY ZSRSRC,ZSEDITZ3
526700200610      /EJECT
526800200610     C***/COPY ZSRSRC,ZSYSTMZ1                                            S01117
526900200610      ***/EJECT                                                           S01117
527000200610     C/COPY ZSRSRC,ZXRATEZ1
527100200610      /EJECT                                                              S01232
527200200610     C/COPY ZSRSRC,ZYCEZ1                                                 S01232
527300200610      /EJECT                                                              S01176
527400200610     C/COPY ZSRSRC,ZYLDIZ1                                                S01176
527500200610      /EJECT
527600200610     C/COPY ZSRSRC,ZYLDOZ1
527700200610      /EJECT
527800200610     C/COPY ZSRSRC,ZYLDZ2
527900200610      /EJECT                                                              S01176
528000200610     C/COPY ZSRSRC,ZYMTXZ2                                                S01176
528100200610      /EJECT
528200200610      ***
528300200610**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
5284002006100366073110961461
528500200610**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
528600200610000031059090120151181212243273304334365
528700200610**   ZMNM - MONTHS SHORT NAMES
528800200610JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
528900200610**  CPY@
529000200610(c) Finastra International Limited 2001
529100200610**   MSG  - ERROR MESSAGES
529200200610ENTER A CUSTOMER NO./SHORTNAME, OR TAKE F/6 FOR SHORTNAME ENQUIRY
529300200610INVALID ENTRY - BOTH CUSTOMER NO./SHORTNAME AND OPTION ENTERED
529400200610INVALID ENTRY - ONLY ONE OPTION MAY BE SELECTED
529500200610INVALID OPTION - ENTER 1(SEC. DETS) 2(PORTFOLIO MOVEMNTS) OR 3(CLIENT HOLDINGS)
529600200610INVALID CUSTOMER NO./SHORTNAME - PLEASE RE-ENTER OR TAKE F/6
529700200610THIS IS THE INITIAL ENQUIRY - F/3 WILL EXIT TO MENU
529800200610ENTER A CUSTOMER NUMBER OR SHORTNAME, OR SELECT AN OPTION
529900200610INVALID BRANCH - PLEASE RE-ENTER
530000200610CUSTOMER IS NOT A PORTFOLIO CUSTOMER - PLEASE RE-ENTER OR TAKE F/6
530100200610USER NOT AUTHORISED TO BRANCH - PLEASE RE-ENTER
530200200610CUSTOMER NOT A SECURITIES CUSTOMER - PLEASE RE-ENTER OR TAKE F/6
530300200610**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
5304002006100000001
5305002006100000010
5306002006100000100
5307002006100001000
5308002006100010000
5309002006100100000
5310002006101000000
531100200610**   ZF29 DAY NOS OF FEB 29 TO 2096 (INCLUDING 2000)
5312002006100006001521029820444305904073650882610287117481320914670161311759219053
5313002006102051421975234362489726358278192928030741322023366335124365853804639507
53140020061040968424294389045351
531500200610**  POWER8 - ARRAY OF POWERS FOR NOMINAL DP TO CURRENCY DP CONVERSION
53160020061000000001
53170020061000000010
53180020061000000100
53190020061000001000
53200020061000010000
53210020061000100000
53220020061001000000
53230020061010000000
