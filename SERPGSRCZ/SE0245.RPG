     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Security details enquiry')                    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Securities Trading Module
     F*                                                               *
     F*  SE0245 - SECURITY DETAILS ENQUIRY                            *
     F*                                                               *
     F*  Function:  This program displays full details of a selected  *
     F*   (I/C)     security.  The screen displayed is a replica of   *
     F*             the input screen.                                 *
     F*             Each option available from this enquiry is held   *
     F*             as a record on PF/SECOND - Linked Enquiry Control *
     F*             file with fields: Calling Program, Option         *
     F*             Selected, Called Program.                         *
     F*                                                               *
     F*  Calls:     F6 may be taken to call SE0240 - Security Report  *
     F*             Name Enquiry.                                     *
     F*             1 may be entered as an option on the first screen *
     F*             to call SE0260 - Forward Diary Enquiry.           *
     F*                                                               *
     F*  Called By: SEC04 - CL Component to Control SE Enquiries      *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD037972           Date 25May16               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG11930           Date 18Aug06               *
      *                 BUG11858           Date 07Aug06               *
      *                 BUG11848           Date 07Aug06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSE075             Date 06Mar06               *
      *                 CSD027             Date 09Dec05               *
      *                 232543             Date 04Apr05               *
      *                 CGL032             Date 05Jul04               *
      *                 CSE075             Date 17Nov05               *
      *                 CER001             Date 25Apr05               *
      *                 CSE065             Date 08Nov04               *
      *                 CSE071             Date 19Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 208241             Date 21Aug02               *
      *                 CSE037             Date 29Apr02               *
      *                 CAS006             Date 21Jan03               *
      *                 CGL018             Date 25Sep02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSE031             Date 09Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 192054             Date 26Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CPB002             Date 14Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CSE010             Date 21Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPL002             Date 01Mar99               *
      *                 CEU017             Date 01Apr98               *
      *                 CEU018             Date 29Apr96               *
     F*                 CSE005             DATE 11DEC96               *
     F*                 S01408             DATE 30SEP96               *
     F*                 065536             DATE 22JUL96               *
     F*                 072101             DATE 25APR96               *
     F*                 S01408             DATE 11SEP95               *
     F*                 052254             DATE 10JAN94               *
     F*                 S01401             DATE 16JUN93               *
     F*                 S01397             DATE 10SEP92               *
     F*                 E40966             DATE 09JUL92               *
     F*                 E28631             DATE 17SEP91               *
     F*                 S01220             DATE 07MAR91               *
     F*                 S01117             DATE 29OCT90               *
     F*                 S01269             DATE 18OCT90               *
     F*                 E23120             DATE 14AUG90               *
     F*                 E23272             DATE 13AUG90               *
     F*                 E23116             DATE 09AUG90               *
     F*                 E23119             DATE 07AUG90               *
     F*                 E20370             DATE 14SEP89               *
     F*                 S01199             DATE 14SEP89               *
     F*                 E18222             DATE 19JUN89               *
     F*                 E17424             DATE 11/04/89              *
     F*                 S01179             DATE 21/10/88              *
     F*                 E15611             DATE 11/10/88              *
     F*                 S01176             DATE 17/08/88              *
     F*                 E13571             DATE 31/07/88              *
     F*                 E14241             DATE 26/07/88              *
     F*                 S01158             DATE 06/05/88              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  MD037972 - Industry code is still using SIDY instead of LOIC *
      *             for Industry Code.                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  BUG11930 - Previous page was not displayed                   *
      *  BUG11858 - Unexpected display when user exits from 3rd screen*
      *  BUG11848 - DB Error when enquiring a record                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSE075 - CSE075 Change Control. Display Coupon Delay period  *
      *           for all interest-bearing securities.                *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  232543 - Fix for CGL032                                      *
      *  CGL032 - Automatic Exchange of Information                   *
      *  CSE075 - US Enhanced Treasury Upgrade to MidasPlus           *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSE065 - Const. Yield Amort. on Mortgage backed assets       *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
      *  CSE037 - Countervalue rounding                               *
      *  CAS006 - Hedge Accounting Phase B                            *
     F*  CGL018 - Risk Weighted Assets                                *
      *  CSE031 - Coupon Fixing for Floating Rate Notes.              *
      *  192054 - If private banking module is on, the ISIN number    *
      *           must be displayed. SE0245DF changes.                *
     F*  CPB002 - 'Private Banking' Module                            *
      *  CSE023 - Treaty Withholding Tax                              *
      *  CSE010 - SE Transaction Enhancement                          *
     F*  CPL002 - Addition of Midas-Plato Interface fields            *
     F*  CEU017 - Securities Redenomination Euro Changes              *
     F*  CEU018 - SE decimals on nominal amounts                      *
     F*  CSE005 - Effect on holidays on FRN Coupon Dates              *
     F*  S01408 - Addition core hook SE0245CP15.                      *
     F*           Addition core hook SE0245GDTA.                      *
     F*  065536 - Do not allow Security Report name Enquiry if that   *
     F*           was the original enquiry. (Recursive call)          *
     F*  072101 - Display current factor on screen                    *
     F*  S01408 - Addition core hook SE0245IIP1.                      *
     F*           Addition core hook SE0245IIP2.                      *
     F*           Addition core hook SE0245EEP1.                      *
     F*           Addition core hook SE0245EEP2.                      *
     F*           Addition core hook SE0245EEP3.                      *
     F*           Addition core hook SE0245CCP1.                      *
     F*           Addition core hook SE0245CCP2.                      *
     F*           Addition core hook SE0245CCP3.                      *
     F*           Addition core hook SE0245CCP4.                      *
     F*           Addition core hook SE0245CCP5.                      *
     F*           Addition core hook SE0245CCP6.                      *
     F*           Addition core hook SE0245CCP7.                      *
     F*           Addition core hook SE0245CCP8.                      *
     F*           Addition core hook SE0245CCP9.                      *
     F*           Addition core hook SE0245CP10.                      *
     F*           Addition core hook SE0245CP11.                      *
     F*           Addition core hook SE0245CP12.                      *
     F*           Addition core hook SE0245CP13.                      *
     F*           Addition core hook SE0245CP14.                      *
     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
     F*           to 10,9                                             *
     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
     F*          - New fields ISIN and SWTP added to PF/SECTYD, so    *
     F*            added to Screen for display.                       *
     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
     F*          - New fields on files to be displayed on screen.     *
     F*  E40966 - Remove 'Option' from first screen as only security  *
     F*           shortname is required                               *
     F*  E28631 - AOCURRR0 should use a 3A field for the currency else*
     F*           database errors occur.                              *
     F*  S01220 - When called as a restricted linked enquiry the      *
     F*           Security shortname and Option inputs are supressed  *
     F*           together with F5, F6 and F9. Original functionality *
     F*           has been fully maintained for SE Enquiries.         *
     F*           Amended so that roll forward dividend indicator is  *
     F*           only displayed if processing type = 4.              *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01269 - TRADE AUTHORISATION: RECOMPILED OVER CHANGED FILE   *
     F*           TABSE                                               *
     F*  E23120 - Base Rate Code + Spread, Spread Indicator, Rate     *
     F*           Change Frequency and Next Change Date should be     *
     F*           displayed only for FRN's (Processing Type 3)        *
     F*  E23272 - Trade denominations should have zeros supressed.    *
     F*  E23116 - Settlement depots should appear as blank, not zeros *
     F*           if no depots entered.                               *
     F*  E23119 - Option wrongly left on screen after linked enquiry. *
     F*  E20370 - RECOMPILE OVER DISPLAY FILE.                        *   E20370
     F*  S01199 -  HELP SYSTEM.                                    *   S01199
     F*  E18222 - WHEN MATURITY DATE EQUAL TO 99999 DO NOT CONVERT    *   E18222
     F*           IT IN CURRENT DATE.                                 *   E18222
     F*  E17424 - Make rolldown work                                  *   E17424
     F*  S01179 - ****** AS400 CONVERSION ******                      *   S01179
     F*  The keyword RTGAID is no longer supported on the AS400       *   S01179
     F*  and command keys and indicators have been used to replace    *   S01179
     F*  this in the display file. To disrupt the structure of the    *   S01179
     F*  program as little as possible a new subroutine - ASCHGS -    *   S01179
     F*  has been coded. This moves the values which would have       *   S01179
     F*  been passed to the program (via RTGAID) into the AID         *   S01179
     F*  field depending on which function key has been pressed.      *   S01179
     F*  E15611 - Security report name not displayed, S01158 (S01176) *   E15611
     F*           in error.                                           *   E15611
     F*  S01176 - SECURITIES TRADING 3.1 (AUSTRALIA)                  *   S01176
     F*  E13571 - AMENDED ERROR MESSAGE, AS NO HELP TEXT              *   E13571
     F*  E14241 - IF PGM IS CALLED FROM SE0240 THEN SETON *IN01       *   E14241
     F*           TO RETURN TO SE0240 RATHER THAN CALL IT.            *   E14241
     F*  S01158 - POST INCORPORATION DEVELOPMENT FIX INCLUDING:       *   S01158
     F*           EDIT INITIAL & FULLY PAID PRICES CORRECTLY          *   S01158
     F*           FETCH CORRECT INVESTMENT TYPE RECORD                *   S01158
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
     FSE0245DFCF  E                    WORKSTN      KINFDS SCRDS
     FSECTY   IF  E           K        DISK
     F*TABSE***IF  E           K        DISK                              S01117
     F**********  TABLETAF                          KIGNORE               S01117
     F************TABTB10F                          KIGNORE
     F**********  TABTB10F                          KIGNORE               S01117
     F**********  TABTB11F                          KIGNORE               S01117
     F************TABTB36F                          KIGNORE               S01158
     F**********  TABTB40F                          KIGNORE               S01117
     F**********  TABTE10F                          KIGNORE               S01117
     F**********  TABTE20F                          KIGNORE               S01117
     F************TABTG10F                          KIGNORE
     F**********  TABTG20F                          KIGNORE               S01117
     F**********  TABLETHF                          KIGNORE               S01117
     F*********** TABLETJF                          KIGNORE               S01117
     F**********  TABLETKF                          KIGNORE               S01117
     F**********  TABLETLF                          KIGNORE               S01117
     F**********  TABLETNF                          KIGNORE               S01117
     F**********  TABLETPF                          KIGNORE               S01117
     F**********  TABLETRF                          KIGNORE               S01117
     F**********  TABLETXF                          KIGNORE               S01117
     F**********  TABLET2F                          KIGNORE               S01117
     F**********  TABLET3F                          KIGNORE               S01117
     F**********  TABLET5F                          KIGNORE               S01117
     F*ABTG10 IF  E           K        DISK
     F*CLINT***IF  E           K        DISK                              S01117
     F**********  CLINTCAF                          KIGNORE               S01117
     F**********  CLINTCCF                          KIGNORE               S01117
     F**********  CLINTC1F                          KIGNORE               S01117
     F**********  CLINTSEF                          KIGNORE               S01117
     F*NVTO***IF  E           K        DISK                               S01158
     FINVTP   IF  E           K        DISK                               S01158
     F***MARKT   IF  E           K        DISK
     FSEMKC   IF  E           K        DISK
     FSECOND  IF  E           K        DISK
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   01         RETURN TO PREVIOUS PROGRAM                       *
     F*****************OR*ERROR*ON*TABTB10*READ************************   S01117
     F*   02         ROLLUP ENABLED                                   *
     F*   03         ROLLDOWN ENABLED                                 *
     F*   04         F/12 ENABLED                                     *
     F*   05         F/6  ENABLED                                     *
     F*   06         F/7  ENABLED                                     *
     F*   07         Allows 'Replacement Security' to be displayed    *   CEU017
     F*              - on when CEU017 is present.                     *   CEU017
     F*   08  - CSE005 Feature present: Business Day Convention BCNV  *   CSE005
     F*   09  - MT5xx Feature present. Controls display of SISIN/SSWTP*   S01401
     F*   10         TRADE BASIS P OR Y : PROCESSING TYPE NOT 2,4,7   *
     F*   11         COUPON RATES & DATES REQUIRED                    *
     F*   12         PROCESSING TYPE IS 4 OR 7                        *
     F*   13         PARTLY PAID INDICATOR Y                          *
     F*   14         PROCESSING TYPE IS 3                             *   E23120
     F*   15         TRADE BASIS IS D                                 *
     F*   25         CHAIN FAIL ON SECTY                              *
     F*   26         CHAIN FAIL ON OTHER FILES                        *
     F*   31         CANCELLED SECURITY                               *   S01158
     F*   32         MATURED SECURITY                                 *   S01158
     F*   33         Australian Yield Security                        *   S01397
     F*   35         PROCESSING TYPE IS 4                             *   S01220
     F*   40         REVERSE IMAGE OPTION FIELD                       *
     F*   41         REVERSE IMAGE SECURITY SHORTNAME FIELD           *
     F*   42         DISPLAY ERROR MESSAGE                            *
     F*                                                               *
     F*   50         ROLLUP                                           *   S01179
     F*   51         ROLLDOWN                                         *   S01179
     F****52*********HELP*******************************************S01179S01199
     F*                                                               *
     F*   55         VLDCMDKY INDICATOR FOR DISPLAY FILE              *   S01179
     F*   61         CSE031 - Coupon Fixing for FRN's is installed    *   CSE031
      *   60         US Withholding tax treaty is installed.          *   CSE023
      *   62         Taxation on Savings Income                       *                       CGL032
     F*   68         CGL018 IS ON                                     *   CGL018
     F*   69         SECURITY REPORT NAME ENQUIRY AVAILABLE           *065536
     F*                                                               *
     F*   79         DO NOT DISPLAY OPTION FIELD                      *
     F*   80         Rertricted functionality indicator used when     *   S01220
     F*              program is called as a restricted linked enquiry *   S01220
     F*                                                               *   S01220
     F*   84         Allows 'Nominal decimal places' to be displayed  *   CEU018
     F*              - on when CEU018 is present.                     *   CEU018
     F*   90 - 99    WORK INDICATOR - STD SUBROUTINES                 *
     F*   U7         WITH U8 FOR DATABASE ERROR                       *
     F*   U8         WITH U7 FOR DATABASE ERROR                       *
     F*   LR         TERMINATE PROGRAM                                *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  I N D E X   T O   S U B R O U T I N E S                      *
     F*                                                               *
     F*  ASCHGS  -  MOVES VALUES INTO AID - AS400 CONVERSION          *
     F*  COMMD   -  PROCESS COMMAND KEYS, HELP AND ROLLUP/DOWN        *
     F*  OPTION  -  CHECK VALIDITY OF ENTERED OPTION COMBINATIONS     *
     F*  SECIN   -  PROCESS ENTERED SECURITY NAME                     *
     F*  CLEAR   -  CLEAR FIELDS AND INDICATORS ON DISPLAY SCREEN     *
     F*  DISP    -  ACCUMULATE SECURITY DETAILS FOR DISPLAY           *
     F*  FILL1   -  FILL FIRST SCREEN OF DETAILS                      *
     F*  FILL2   -  FILL SECOND SCREEN OF DETAILS                     *
     F*  FILL3   -  FILL THIRD SCREEN OF DETAILS                      *
     F*  FILL4   -  FILL FOURTH SCREEN OF DETAILS                     *   CSE031
     F*  LINK    -  PROCESS REQUEST FOR LOWER LEVEL ENQUIRY           *
     F*  RETSR   -  END OF PROGRAM PROCESSING                         *
     F*  FIRST   -  FIRST CYCLE PROCESSING                            *
     F*  *PSSR   -  ERROR HANDLING                                    *   S01117
     F*  ZDATE2  -  DATE FORMATTER                                    *
     F*  ZSDESC  -  FORMAT SECURITY DESCRIPTION                       *   S01158
     F*  ZSEDIT  -  EDIT AMOUNTS                                      *
     F*  ZEDIT   -  ZERO SUPPRESSION                                  *   E23272
     F***ZSYSTM**-**ACCESS*ICDR1***************************************   S01117
     F*                                                               *
     F*****************************************************************
      /EJECT
     E                    CPY@    1   1 80
     E*                                                                   S01408
     E/COPY WNCPYSRC,SE0245EEP2                                           S01408
     E*                                                                   S01408
     E                    MSG     1   6 79               Error Messages
     E*                                                                   S01408
     E/COPY WNCPYSRC,SE0245EEP3                                           S01408
     E*                                                                   S01408
     E*                                                                   S01408
     E/COPY WNCPYSRC,SE0245EEP1                                           S01408
     E*                                                                   S01408
     E**********          ASS        20  1               SEC SHRT NAME ARRS01158
     E**********          AON        50  1               OUTPUT FORMAT ARRS01158
     E**********          ACR        11  1               COUPON RATE ARRAYS01158
     E**********          APR        15  1               REDEMPTION PR ARRS01158
     E**********          ADT         7  1               MATURITY DATE ARRS01158
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZEDITZ1                                                E23272
     E/COPY ZSRSRC,ZSDESCZ1                                               S01158
     E*                                                                   CSE005
     E****************    CD         12  4                                CSE005
     E* CD array must be numeric for call to ZNCD                         CSE005
     E                    CD         12  4 0                              CSE005
     E                    CR         12  1
     E                    SCD        12  4
     E                    SCR        12  1
     E/COPY ZSRSRC,ZSEDITZ1
      /EJECT
     E/COPY WNCPYSRC,SE0245E001
     I/COPY ZSRSRC,ZSEDITZ2                                               S01158
     I/COPY ZSRSRC,ZSDESCZ2                                               S01158
     I*
     ICPYR@#      DS
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*ONDS*****  DS                                                      S01158
     I**********                              1  50 AON                   S01158
     I**********                              1  50 AONM                  S01158
     I*COPY*ZSRSRC,ZSEDITZ2***                                            S01158
     I*TABKEY****  DS                                                     S01117
     I**********                              1  12 KEY                   S01117
     I**********                              1   2 TYPE                  S01117
     I**********                              9  11 KCCY                  S01117
     I*                                                                   S01117
     I*LDA*******UDS                            256                       S01117
     ILDA         DS                            256                       S01117
     I*
     I*      Local data area.
     I** *LOCK IN LDA immediately before and OUT LDA immediately          S01117
     I** after each database error handling.                              S01117
     I*
     I                                        1   1 OPTFLG
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     I*                                                                   S01408
     I/COPY QWINDSRC,SE0245GDTA                                           S01408
     I*                                                                   S01408
     IRUNDT       DS                                                      S01117
     I*                                                                   S01117
     I** DATA AREA RUNDAT                                                 S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDCURR    E DSSDCURRPD                                              S01117
     I** Currency Details                                                 S01117
     I**                                                                  S01117
     ISDCUST    E DSSDCUSTPD                                              S01117
     I** Customer Details                                                 S01117
     I**                                                                  S01117
     ISDMMOD    E DSSDMMODPD                                              CPL002
     I** EXTERNAL DS FOR MMOD ACCESS OBJECT                               CPL002
      *                                                                                       CSE065
     ISDBANK    E DSSDBANKPD                                                                  CSE065
      * External DS for Bank Details                                                          CSE065
      *                                                                                       CSE065
     ISCSARD    E DSSCSARDPD                                                                  CSE065
      * External DS for Switchable feature details                                            CSE065
      *                                                                                       CSE065
     IDSSDY     E DSDSSDY                                                 S01117
     I** SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE               S01117
     I*                                                                   S01408
     IDSFDY     E DSDSFDY                                                 CPL002
     I** DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                     CPL002
     I*                                                                   CPL002
     I/COPY WNCPYSRC,SE0245IIP2                                           S01408
     I*                                                                   S01408
     I**                                                                  S01117
     I**  LINK ENQUIRY DATA AREA
     ISESDS     E DS
     IPSDS       SDS
     I                                        1  10 PROGRM
     I                                      244 246 WSID
     ISCRDS       DS
     I                                      287 288 AID
     I*
     ISCRFM1      DS
     I*
     I* DATA STRUCTURES OVER SCREEN FIELDS FOR CLEARING
     I*
     I                                        1   1 SACTN
     I                                        2  11 SSESN
     I                                       12  12 SINCS
     I                                       13  15 SNMCY
     I                                       16  18 SSITP
     I                                       19  21 SSIDY
     I                                       22  24 SVLCY
     I                                       25  25 SMLTI
     I                                       26  27 SSSEC
     I                                       28  30 SQLTY
     I                                       31  31 SMKTI
     I                                       32  33 SSCOR
     I                                       34  38 SSRET
     I                                       39  45 SSREF
     I**                                                                  S01176
     I** DATA STRUCTURE ALTERED BECAUSE FIELD SIZES HAVE CHANGED          S01176
     I**                                                                  S01176
     I***********                            46  51 STVRF                 S01176
     I***********                            52  52 SPPDI                 S01176
     I***********                            53  62 SS1SN                 S01176
     I***********                            63  69 SSDNM                 S01176
     I***********                            70  70 SERPY                 S01176
     I***********                            71  73 SVDFT                 S01176
     I***********                            74  76 SEDFT                 S01176
     I***********                            77 106 SSFN1                 S01176
     I***********                           107 136 SSFN2                 S01176
     I***********                           137 156 SSRPN                 S01158
     I***********                           157 165 SCSPN                 S01158
     I***********                           137 177 SRNME          S01158 S01176
     I***********                           178 186 SCSPN          S01158 S01176
     I                                       46  57 ST2RF                 S01176
     I                                       58  58 SPPDI                 S01176
     I                                       59  68 SS1SN                 S01176
     I                                       69  75 SSDNM                 S01176
     I                                       76  76 SERPY                 S01176
     I                                       77  79 SVDFT                 S01176
     I                                       80  82 SEDFT                 S01176
     I                                       83 112 SSFN1                 S01176
     I                                      113 142 SSFN2                 S01176
     I************                          143 183 SRNME          S01176 E15611
     I************                          184 192 SCSPN          S01176 E15611
     I                                      143 162 SSRPN                 E15611
     I                                      163 171 SCSPN                 E15611
     I                                      172 183 SISIN                 S01401
     I                                      184 186 SSWTP                 S01401
     I                                      187 196 SSRRB                 CEU017
     I                                      197 212 SPLICC                CPL002
     I                                      213 222 SPLDIN                CPL002
     I                                      223 230 SPLRGC                CPL002
     I                                      231 238 SPLPGC                CPL002
     I                                      239 239 SSETX                                     CGL032
     ISCRFM2      DS
     I                                        1  13 SCPNR
     I                                       14  15 SBASC
     I                                       16  22 SIDIV
     I                                       23  35 SBASS
     I                                       36  36 SSPRI
     I                                       37  51 SNEXD
     I                                       52  64 SMCPN
     I                                       65  71 SMATY1
     I**                                                                  S01176
     I** DATA STRUCTURE ALTERED FOR 3.1 MODIFICATIONS                     S01176
     I**                                                                  S01176
     I***********                            72  72 SLTMI                 S01176
     I***********                            73  73 SDYBS1                S01176
     I***********                            74  74 SDVBS1                S01176
     I***********                            75  81 SMATY2                S01176
     I***********                            82  88 SITLD                 S01176
     I***********                            89  95 SFCPN                 S01176
     I***********                            96 112 SSINP                 S01176
     I***********                           113 129 SSFPP                 S01176
     I***********                           130 130 SRCFQ                 S01176
     I***********                           131 137 SNCHD                 S01176
     I***********                           138 151 SCSN1                 S01176
     I***********                           152 165 SCSN2                 S01176
     I***********                           166 179 SCSN3                 S01176
     I***********                           180 181 SSMCC                 S01176
     I***********                           182 201 SMKTN                 S01176
     I***********                           202 202 SSCVI                 S01176
     I***********                           203 203 SSPBS                 S01176
     I***********                           204 204 SSRBS                 S01176
     I***********                           205 205 SDYBS2                S01176
     I***********                           206 206 SDVBS2                S01176
     I***********                           207 210 SIADJ                 S01176
     I***********                           211 219 SD1SR                 S01176
     I***********                           220 228 SD2SR                 S01176
     I***********                           229 237 SD3SR                 S01176
     I                                       72  72 SMDTI1                S01176
     I                                       73  73 SLTMI                 S01176
     I                                       74  74 SDYBS1                S01176
     I                                       75  75 SDVBS1                S01176
     I                                       76  82 SMATY2                S01176
     I                                       83  83 SMDTI2                S01176
     I                                       84  90 SITLD                 S01176
     I                                       91  97 SFCPN                 S01176
     I                                       98 114 SSINP                 S01176
     I                                      115 131 SSFPP                 S01176
     I                                      132 132 SCLIN                 S01176
     I                                      133 142 SRSKC                 S01176
     I                                      143 152 SDRWR                 S01176
     I                                      153 153 SRCFQ                 S01176
     I                                      154 160 SNCHD                 S01176
     I                                      161 174 SCSN1                 S01176
     I                                      175 188 SCSN2                 S01176
     I                                      189 202 SCSN3                 S01176
     I                                      203 204 SSMCC                 S01176
     I                                      205 224 SMKTN                 S01176
     I                                      225 225 SSCVI                 S01176
     I                                      226 226 SSPBS                 S01176
     I                                      227 227 SSRBS                 S01176
     I                                      228 228 SDYBS2                S01176
     I                                      229 229 SDVBS2                S01176
     I                                      230 233 SIADJ                 S01176
     I                                      234 245 SDASR                 S01176
     I                                      246 257 SDCSR                 S01176
     I                                      258 269 SDDSR                 S01176
     I                                      270 285 #2CCRK                                    CAS006
     I                                      286 301 #2CLQP                                    CAS006
     ISCRFM3      DS
     I                                        1   7 SISSD
     I                                        8  24 SISSP
     I                                       25  37 SISSA
     I                                       38  47 SLMGR
     I                                       48  60 STOTU
     I                                       61  73 SALRQ
     I                                       74  86 SALRC
     I                                       87  99 SMGFD
     I                                      100 102 SFECY
     I***********                           103 115 SMGRC                                     CSE065
     I***********                           116 128 SUNFR                                     CSE065
     I***********                           129 141 SUNFD                                     CSE065
     I                                      103 111 SSDAL                                     CSE065
     I                                      112 124 SMGRC                                     CSE065
     I                                      125 137 SUNFR                                     CSE065
     I                                      138 150 SUNFD                                     CSE065
     I            DS
     I                                        1   1 SCR01
     I                                        2   2 SCR02
     I                                        3   3 SCR03
     I                                        4   4 SCR04
     I                                        5   5 SCR05
     I                                        6   6 SCR06
     I                                        7   7 SCR07
     I                                        8   8 SCR08
     I                                        9   9 SCR09
     I                                       10  10 SCR10
     I                                       11  11 SCR11
     I                                       12  12 SCR12
     I                                        1  12 SCR
     I            DS
     I                                        1   4 SCD01
     I                                        5   8 SCD02
     I                                        9  12 SCD03
     I                                       13  16 SCD04
     I                                       17  20 SCD05
     I                                       21  24 SCD06
     I                                       25  28 SCD07
     I                                       29  32 SCD08
     I                                       33  36 SCD09
     I                                       37  40 SCD10
     I                                       41  44 SCD11
     I                                       45  48 SCD12
     I                                        1  48 SCD
     I*                                                                   CSE005
     I************DS                                                      CSE005
     I* ZNCD requires coupon rate indicators DS to be named CRDS          CSE005
     ICRDS        DS                                                      CSE005
     I                                        1   1 CR01
     I                                        2   2 CR02
     I                                        3   3 CR03
     I                                        4   4 CR04
     I                                        5   5 CR05
     I                                        6   6 CR06
     I                                        7   7 CR07
     I                                        8   8 CR08
     I                                        9   9 CR09
     I                                       10  10 CR10
     I                                       11  11 CR11
     I                                       12  12 CR12
     I                                        1  12 CR
     I            DS
     I                                        1   40CD01
     I                                        5   80CD02
     I                                        9  120CD03
     I                                       13  160CD04
     I                                       17  200CD05
     I                                       21  240CD06
     I                                       25  280CD07
     I                                       29  320CD08
     I                                       33  360CD09
     I                                       37  400CD10
     I                                       41  440CD11
     I                                       45  480CD12
     I                                        1  48 CD
     IDATALX      DS                           1024                                           CER001
     I                                        1  10 #1SESN                                    CER001
     I                                       11  13 #1CCYI                                    CER001
     I                                       14  16 #1INVT                                    CER001
     I                                       17  26 #1ISSR                                    CER001
     I                                       27  29 #1LICD                                    CER001
     I                                      117 117 #1SCVI                                    CER001
     I                                      124 129 #1ITDT                                    CER001
     I                                      130 135 #1MATY                                    CER001
     I                                      136 147 #1ISNO                                    CER001
     I                                      201 202 #LCRTT                                    CER001
     I                                      203 204 #LINCT                                    CER001
     I                                      205 206 #LEXCD                                    CER001
     I                                      207 207 #LOIDI                                    CER001
     I                                      208 208 #LAPIE                                    CER001
     I                                      209 209 #LPROT                                    CER001
      *                                                                                       CSE065
      ** Work data structures for ZA0140                                                      CSE065
     IZ@DATA      DS                                                                          CSE065
     I                                        1   5 Z@DADM                                    CSE065
     I                                        6   7 Z@DAYR                                    CSE065
     IZ@DAT8      DS                                                                          CSE065
     I                                        1   4 Z@D8YR                                    CSE065
     I                                        1   6 Z@D8MO                                    CSE065
     I                                        7   8 Z@D8DY                                    CSE065
     ID@DATE      DS                                                                          CSE065
     I                                        1   5 D@DYMO                                    CSE065
     I                                        6   9 D@DDYR                                    CSE065
     I*
     I              'SEC001300'           C         KOL                   CGL018
     I*                                                                   S01408
     I/COPY WNCPYSRC,SE0245IIP1                                           S01408
     I*                                                                   S01408
     C/EJECT
     C           *NAMVAR   DEFN           SESDS
     C           *NAMVAR   DEFN           LDA
     C**
     C**  DEFINE LIKE WORK FIELDS
     C**
     C           *LIKE     DEFN SSESN     LSSESN
     C           *LIKE     DEFN SSESN     ZSSESN
     C           *LIKE     DEFN SSESN     KSESN                                               CSE075
     C**
     C**  DO FIRST CYCLE PROCESSING
     C**
     C                     EXSR FIRST
     C**
     C**  MAIN PROCESSING    -    Do until end of job requested
     C**
     C           *IN01     DOWEQ'0'
     C**
     C**    Display the screen
     C**     - enable F12,6,9 only on initial & first screens
     C**
     C                     SETOF                     040506
     C                     SETOF                     68                   CGL018
     C                     WRITESE0245F0
     C           SCNNO     IFEQ 0
     C                     SETON                     040506
     C                     SETON                     79                   E40966
     C                     WRITESE0245FT
     C                     EXFMTSE0245FI
     C                     ELSE
     C           SCNNO     IFEQ 1
     C                     SETOF                     79                   E40966
      *                                                                   CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C                     SETON                     68                   CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     SETON                     040506
     C                     WRITESE0245F1
     C                     EXFMTSE0245FI
     C                     ELSE
     C           SCNNO     IFEQ 2
     C                     EXFMTSE0245F2
     C                     ELSE
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP3                                           S01408
     C*                                                                   S01408
     C           SCNNO     IFEQ 3                                         CSE031
     C                     EXFMTSE0245F3
     C                     ELSE                                           CSE031
      *                                                                   CSE031
     C           SCNNO     IFEQ 4                                         CSE031
     C                     EXFMTSE0245F4                                  CSE031
     C                     ENDIF                                          CSE031
     C                     ENDIF                                          CSE031
      *                                                                                       CER001
     C                     MOVELSESN      #1SESN                                              CER001
     C                     MOVE CRTT      #LCRTT                                              CER001
     C                     MOVE INCT      #LINCT                                              CER001
     C                     MOVE EXCD      #LEXCD                                              CER001
     C                     MOVE OIDI      #LOIDI                                              CER001
     C                     MOVE APIE      #LAPIE                                              CER001
     C                     MOVE PROT      #LPROT                                              CER001
     C                     MOVEL*BLANKS   RTNCDE 10                                           CER001
     C                     MOVEL*BLANKS   W0RTN   7                                           CER001
     C                     MOVE *BLANK    ACTCDE  1                                           CER001
     C                     MOVE *BLANK    ULXRTN  1                                           CER001
     C                     MOVE *BLANK    RETIND  1                                           CER001
      *                                                                                       CER001
     C           *INKC     IFEQ *OFF                                                        BUG11858
      *                                                                                     BUG11930
      ** Display Lux screen on SE0245F3 after ENTER key was pressed                         BUG11930
      *                                                                                     BUG11930
     C           *IN51     ANDEQ*OFF                                                        BUG11930
     C           *INKG     ANDEQ*OFF                                                        BUG11930
     C           ULXRTN    DOUEQ'N'                                                           CER001
      *                                                                                       CER001
      ** For switchable ULX004                                                                CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C           RETIND    IFNE 'Y'                                                           CER001
     C                     CALL 'SE0246'                                                      CER001
     C                     PARM           RTNCDE                                              CER001
     C                     PARM 'E'       ACTCDE                                              CER001
     C                     PARM           DATALX                                              CER001
     C                     PARM *BLANKS   W0RTN                                               CER001
      *                                                                                       CER001
      ** If F12 is pressed                                                                    CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                                                     CER001
     C           W0RTN     OREQ 'Y2U0004'                                                   BUG11848
     C                     LEAVE                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     CALL 'SE0247'                                                      CER001
     C                     PARM           RTNCDE                                              CER001
     C                     PARM 'E'       ACTCDE                                              CER001
     C                     PARM           DATALX                                              CER001
     C                     PARM *BLANKS   W0RTN                                               CER001
      *                                                                                       CER001
      ** If F12 is pressed                                                                    CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                                                     CER001
     C                     MOVE 'N'       RETIND                                              CER001
     C                     ITER                                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If ULX004 is not ON                                                                  CER001
      *                                                                                       CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULXRTN                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** For switchable ULX043                                                                CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVE 'Y'       ULXRTN                                              CER001
     C                     CALL 'SE0248'                                                      CER001
     C                     PARM           RTNCDE                                              CER001
     C                     PARM 'E'       ACTCDE                                              CER001
     C                     PARM           DATALX                                              CER001
     C                     PARM *BLANKS   W0RTN                                               CER001
      *                                                                                       CER001
      ** If F12 is pressed                                                                    CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                                                     CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C                     MOVE 'Y'       RETIND                                              CER001
     C                     ITER                                                               CER001
     C                     ELSE                                                               CER001
     C                     LEAVE                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If Enter is pressed                                                                  CER001
      *                                                                                       CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULXRTN                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If ULX043 is not ON                                                                  CER001
      *                                                                                       CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULXRTN                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDDO                                                              CER001
     C                     ENDIF                                                            BUG11858
      *                                                                                       CER001
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP4                                           S01408
     C*                                                                   S01408
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0245C003
     C**
     C** Call S/R to move values into AID                                 S01179
     C**                                                                  S01179
     C                     EXSR ASCHGS                                    S01179
     C**                                                                  S01179
     C/COPY WNCPYSRC,SE0245C004
     C**    Clear the error messages unless HELP pressed
     C**
     C           AID       IFNE 'HP'
     C                     MOVE *BLANKS   ERMSG  79
     C                     SETOF                     404142
     C                     END
     C**
     C******Check*Command*Keys*-*including*HELP****
     C**    Check Command Keys
     C**
     C                     EXSR COMMD
     C/COPY WNCPYSRC,SE0245C010
     C**
     C**    If Enter has been pressed check validity of options
     C**
     C           AID       IFEQ 'RA'
     C**
     C**    Check Validity of Option Combinations
     C**
     C                     EXSR OPTION
     C**
     C           *IN42     IFEQ '0'
     C**
     C**    Check if no lower level option selected
     C**
     C           SACTN     IFEQ *BLANKS
     C                     EXSR SECIN
     C/COPY WNCPYSRC,SE0245C009
     C                     ELSE
     C**
     C**    Lower Level Enquiry Selected
     C**
     C                     EXSR LINK
     C**
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0245C015
     C                     END
     C**
     C**   Return to calling program
     C**
     C                     EXSR RETSR
     C**
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**    COMMD   SR   To process Command Keys                      *
     C*******************and*HELP,*ROLLUP*and*ROLLDOWN****            *
     C**                 ROLLUP and ROLLDOWN                          *
     C**                                                              *
     C**    Called  By   MAIN                                         *
     C**                                                              *
     C**    Calls   SR   CLEAR, SECIN, DISP                           *
     C**                                                              *
     C******Calls**PGM***MHELP,*SE0240*********************************   S01199
     C**    Calls  PGM   SE0240                                       *
     C**                                                              *
     C*****************************************************************
     C**
     C           COMMD     BEGSR                           ** COMMD **
     C**
     C*****If*HELP*pressed*call*help*screen                               S01199
     C**
     C***********AID       IFEQ 'HP'                                      S01199
     C*********************CALL 'MHELP'                                   S01199
     C*********************PARM           PGMNO                           S01199
     C*********************PARM           HERCD 160                       S01199
     C*********************END                                            S01199
     C**
     C**    If Rollup key pressed
     C**       Use DISP to fill screen if not done already
     C**
     C           AID       IFEQ 'UP'
     C                     MOVE *BLANKS   SACTN
     C                     MOVE LSSESN    SSESN
     C           SCNNO     IFLT TOPNO
     C                     ADD  1         SCNNO
     C**
     C**    If Rollup no longer available - disenable
     C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP1                                           S01408
     C*                                                                   S01408
     C           SCNNO     IFEQ 3
     C           *IN61     ANDEQ*OFF                                      CSE031
     C           SCNNO     OREQ 4                                         CSE031
     C           *IN61     ANDEQ*ON                                       CSE031
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP5                                           S01408
     C*                                                                   S01408
     C                     SETOF                     02
     C                     ELSE
     C**
     C**    If Rolldown now available - enable
     C**
     C           SCNNO     IFEQ 2
     C                     SETON                     03
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0245C011
     C                     ELSE
     C                     EXSR DISP
     C                     END
     C                     END
     C**
     C**    If Rolldown key pressed
     C**
     C           AID       IFEQ 'DN'
     C                     MOVE *BLANKS   SACTN
     C                     MOVE LSSESN    SSESN
     C                     SUB  1         SCNNO
     C**
     C**    If Rolldown no longer available - disenable
     C**
     C           SCNNO     IFEQ 1
     C                     SETOF                     03
     C                     ELSE
     C**
     C**    If Rollup now available - enable
     C**
     C           SCNNO     IFEQ 2
     C           SCNNO     OREQ 3                                         CSE031
     C                     SETON                     02
     C                     END
     C                     END
     C                     END
     C**
     C**    If F3 then exit to menu - return code 1 and end
     C**
     C           AID       IFEQ '01'
     C                     MOVE '1'       RTNC
     C                     MOVE '1'       *IN01
     C                     END
     C**
     C**    If F12 then return to previous enquiry - return code 2
     C**                  unless there is no previous enquiry
     C**
     C           AID       IFEQ '02'
     C           ORIG      IFNE PGMNO
     C                     MOVE '2'       RTNC
     C                     MOVE '1'       *IN01
     C                     ELSE
     C                     MOVE '1'       *IN42
     C                     MOVE MSG,4     ERMSG
     C                     END
     C                     END
     C**
     C**    If F5 then refresh enquiry screen
     C**
     C           AID       IFEQ '05'
     C                     MOVEA'00'      *IN,31                          S01158
     C                     EXSR CLEAR
     C                     END
     C**
     C**    If F6 then call Customer Shortname Enquiry
     C**                       in sideways mode
     C**             on return check return code
     C**             if 0 then Database Error and exit required
     C**             if 1 then F3 and exit to menu required
     C**
     C           AID       IFEQ '06'
     C                     MOVE *BLANKS   ERMSG  79
     C                     SETOF                     404142
     C*                                                                   E14241
     C*  IF PGM IS CALLED FROM SE0240 SETON *IN01 TO RETURN TO SE0240.    E14241
     C*                                                                   E14241
     C                     MOVELSESDS     TEST    6                       E14241
     C           TEST      IFEQ 'SE0240'                                  E14241
     C                     MOVE 1         *IN01                           E14241
     C                     ELSE                                           E14241
     C                     MOVE '6'       RTNC
     C                     OUT  SESDS
     C***********          OUT  LDA                                       S01117
     C                     CALL 'SE0240'
     C************LOCK     IN   LDA                                       S01117
     C           *LOCK     IN   SESDS
     C           RTNC      IFEQ '0'
     C           RTNC      OREQ '1'
     C                     MOVE '1'       *IN01
     C                     ELSE
     C                     MOVELRQSESN    SSESN
     C/COPY WNCPYSRC,SE0245C005
     C                     MOVE *BLANKS   RQSESN
     C                     EXSR SECIN
     C                     END
     C                     END
     C                     END                                            E14241
     C**
     C**     If F9 then return to initial enquiry - return code 7
     C**                   unless this is the initial program
     C**
     C           AID       IFEQ '07'
     C           ORIG      IFNE PGMNO
     C                     MOVE '7'       RTNC
     C                     MOVE '1'       *IN01
     C                     ELSE
     C                     MOVE '1'       *IN42
     C                     MOVE MSG,4     ERMSG
     C                     END
     C                     END
      *                                                                   CSE023
      ** If F7 is pressed, call window SE0047                             CSE023
      *                                                                   CSE023
     C           AID       IFEQ '09'                                      CSE023
     C/COPY WNCPYSRC,SE0245C017
      *                                                                   CSE023
     C                     MOVE CRTT      #1CRTT                          CSE023
     C                     MOVE INCT      #1INCT                          CSE023
     C                     MOVE EXCD      #1EXCD                          CSE023
     C                     MOVE OIDI      #1OIDI                          CSE023
     C                     MOVE APIE      #1APIE                          CSE023
     C                     MOVE PROT      #1PROT                          CSE023
     C/COPY WNCPYSRC,SE0245C016
      *                                                                   CSE023
     C                     CALL 'WN0010'                                  CSE023
     C                     PARM 'SE0040  'PPGM   10                       CSE023
     C                     PARM *BLANKS   PFKEY   2                       CSE023
     C                     PARM 'E'       PACTN   1                       CSE023
     C                     PARM           DATA                            CSE023
     C                     PARM *BLANKS   PRTCD   7                       CSE023
     C                     PARM *BLANKS   SPARE 256                       CSE023
      *                                                                   CSE023
      ** If F3 is pressed from the window, end pgm                        CSE023
      *                                                                   CSE023
     C           PRTCD     IFEQ 'Y2U9999'                                 CSE023
     C                     MOVE *ON       *IN01                           CSE023
     C                     ENDIF                                          CSE023
     C/COPY WNCPYSRC,SE0245C018
      *                                                                   CSE023
      ** If ENTER is pressed from window, display 1st screen              CSE023
      *                                                                   CSE023
     C           PRTCD     IFEQ *BLANKS                                   CSE023
     C                     MOVE 'RA'      AID                             CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C                     ENDIF                                          CSE023
     C**
     C**                                                                  CGL018
     C**    If F17 then refresh enquiry screen                            CGL018
     C**                                                                  CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C           AID       ANDEQ'17'                                      CGL018
     C                     MOVELKOL       PGMC   10                       CGL018
      *                                                                   CGL018
     C                     CALL PGMC                                      CGL018
     C                     PARM *BLANKS   @RTRN   7                       CGL018
     C                     PARM SSESN     @SECTY 10                       CGL018
     C                     PARM 'E'       @ACTN   1                       CGL018
     C                     END                                            CGL018
      *                                                                   CGL018
     C**                                                                  CGL018
     C                     ENDSR
     C**
     C*****************************************************************
     C/EJECT
     C*****************************************************************
      **           ****** AS400 CONVERSION ******                     *   S01179
      **                                                              *   S01179
      ** ASCHGS S/R TO MOVE THE APPROPRIATE VALUES INTO FIELD AID,    *   S01179
      ** DEPENDING ON WHICH FUNCTION KEY HAS BEEN PRESSED.            *   S01179
      ** CALLED FROM UPDATE                                           *   S01179
      **                                                              *   S01179
     C*****************************************************************   S01179
     C*                                                                   S01179
     C           ASCHGS    BEGSR                                          S01179
     C*                                                                   S01179
     C* If ENTER pressed, the VLDCMDKEY indicator will be off             S01179
     C*                                                                   S01179
     C           *IN55     IFEQ '0'                                       S01179
     C                     MOVE 'RA'      AID                             S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F3                                                             S01179
     C*                                                                   S01179
     C           *INKC     IFEQ '1'                                       S01179
     C                     MOVE '01'      AID                             S01179
     C                     MOVE '0'       *INKC                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F5                                                             S01179
     C*                                                                   S01179
     C           *INKE     IFEQ '1'                                       S01179
     C                     MOVE '05'      AID                             S01179
     C                     MOVE '0'       *INKE                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F6                                                             S01179
     C*                                                                   S01179
     C           *INKF     IFEQ '1'                                       S01179
     C                     MOVE '06'      AID                             S01179
     C                     MOVE '0'       *INKF                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F9                                                             S01179
     C*                                                                   S01179
     C           *INKI     IFEQ '1'                                       S01179
     C                     MOVE '07'      AID                             S01179
     C                     MOVE '0'       *INKI                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F12                                                            S01179
     C*                                                                   S01179
     C           *INKL     IFEQ '1'                                       S01179
     C                     MOVE '02'      AID                             S01179
     C                     MOVE '0'       *INKL                           S01179
     C                     END                                            S01179
     C*                                                                   CGL018
     C* If F17                                                            CGL018
     C*                                                                   CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C           *INKR     ANDEQ'1'                                       CGL018
     C                     MOVE '17'      AID                             CGL018
     C                     MOVE '0'       *INKR                           CGL018
     C                     END                                            CGL018
      *                                                                   CGL018
     C/COPY WNCPYSRC,SE0245C012
     C*                                                                   S01179
     C* If ROLLUP pressed                                                 S01179
     C*                                                                   S01179
     C           *IN50     IFEQ '1'                                       S01179
     C                     MOVE 'UP'      AID                             S01179
     C                     MOVE '0'       *IN50                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If ROLLDOWN pressed                                               S01179
     C*                                                                   S01179
     C           *IN51     IFEQ '1'                                       S01179
     C*********            MOVE 'UP'      AID                     S01179  E17424
     C                     MOVE 'DN'      AID                             E17424
     C                     MOVE '0'       *IN51                           S01179
     C                     END                                            S01179
      *                                                                   CSE023
      ** If F7 is pressed, call window program                            CSE023
      *                                                                   CSE023
     C           *INKG     IFEQ *ON                                       CSE023
     C                     MOVE '09'      AID                             CSE023
     C                     MOVE *OFF      *INKG                           CSE023
     C                     ENDIF                                          CSE023
     C*                                                                   S01179
     C**If*HELP*key*pressed                                       S01179  S01199
     C*                                                                   S01179
     C********** *IN52     IFEQ '1'                               S01179  S01199
     C*********************MOVE 'HP'      AID                     S01179  S01199
     C*********************MOVE '0'       *IN52                   S01179  S01199
     C*********************END                                    S01179  S01199
     C*                                                                   S01179
     C                     ENDSR                                          S01179
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C**                                                              *
     C**   OPTION SR  To check validity of option combinations        *
     C**                                                              *
     C**   Called by  MAIN                                            *
     C**                                                              *
     C**   Calls  SR  none                                            *
     C**                                                              *
     C*****************************************************************
     C**
     C           OPTION    BEGSR                            ** OPTION *
     C**
     C**     If no details on screen - error if option entered
     C**                             - error if no security entered
     C**                             - error if both entered
     C**
     C           LSSESN    IFEQ *BLANKS
     C           SACTN     IFNE *BLANKS
     C                     SETON                     404142
     C                     MOVE MSG,6     ERMSG
     C                     ELSE
     C           SSESN     IFEQ *BLANKS
     C                     SETON                     404142
     C                     MOVE MSG,6     ERMSG
     C                     END
     C                     END
     C                     ELSE
     C**
     C**     If details on screen - error if neither or both entered
     C**
     C           SACTN     IFEQ *BLANKS
     C           SSESN     ANDEQ*BLANKS
     C                     SETON                     404142
     C                     MOVE MSG,2     ERMSG
     C                     ELSE
     C           SACTN     IFNE *BLANKS
     C           SSESN     ANDNE*BLANKS
     C           SSESN     ANDNELSSESN
     C                     SETON                     404142
     C                     MOVE MSG,1     ERMSG
     C                     END
     C                     END
     C                     END
     C**
     C                     ENDSR
     C**
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   SECIN  SR  To process entered Security name                *
     C**                                                              *
     C**   Called by  MAIN, FIRST, COMMD                              *
     C**                                                              *
     C**   Calls  SR  CLEAR DISP                                      *
     C**                                                              *
     C*****************************************************************
     C**
     C           SECIN     BEGSR                            ** SECIN  *
     C/COPY WNCPYSRC,SE0245C001
      *                                                                   CSE010
      ** If CSE010 is installed, and a '?' is found anywhere in the       CSE010
      ** Security Shortname field                                         CSE010
      *                                                                   CSE010
     C           CSE010    IFEQ 'Y'                                       CSE010
     C                     MOVELSSESN     WQMK    1                       CSE010
     C           WQMK      IFEQ '?'                                       CSE010
     C                     MOVE SSESN     @SESN                           CSE010
     C                     CALL 'SE0043'                                  CSE010
     C                     PARM           @ACTN   1                       CSE010
     C                     PARM           @SESN  10                       CSE010
      *                                                                   CSE010
     C           @SESN     IFNE *BLANKS                                   CSE010
     C                     MOVE @SESN     SSESN                           CSE010
     C                     ELSE                                           CSE010
     C                     MOVE *BLANKS   SSESN                           CSE010
     C                     ENDIF                                          CSE010
     C                     ENDIF                                          CSE010
     C                     ENDIF                                          CSE010
     C**
     C** Check if valid shortname entered
     C**     Error if no active record
     C**     Otherwise prepare to display the details
     C**
     C                     MOVEA'00'      *IN,31                          S01158
     C           SSESN     CHAINSECTY                25
     C           *IN25     IFEQ '0'
     C           RECI      IFEQ '*'
     C                     SETON                     25
     C                     END
     C                     END
     C**
     C           *IN25     IFEQ '1'
     C                     MOVE '1'       *IN42
     C                     MOVE MSG,5     ERMSG
     C**
     C                     ELSE
     C           RECI      IFEQ 'C'                                       S01158
     C                     SETON                     31                   S01158
     C                     ELSE                                           S01158
     C           RECI      IFEQ 'M'                                       S01158
     C                     SETON                     32                   S01158
     C                     END                                            S01158
     C                     END                                            S01158
     C                     MOVE SSESN     ZSSESN
     C                     EXSR CLEAR
     C                     MOVE ZSSESN    SSESN
     C                     MOVE SSESN     LSSESN
     C                     EXSR DISP
     C                     END
     C**
     C                     ENDSR
     C**
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   CLEAR  SR  Clear the screen display fields and indicators  *
     C**                                                              *
     C**   Called by  COMMD, SECIN                                    *
     C**                                                              *
     C**   Calls  SR  none                                            *
     C**                                                              *
     C*****************************************************************
     C**
     C           CLEAR     BEGSR
     C**
     C                     MOVE *BLANKS   SCRFM1
     C                     MOVE *BLANKS   SCRFM2
     C                     MOVE *BLANKS   SCRFM3
     C                     MOVE *BLANKS   LSSESN
     C                     MOVE *BLANKS   SCD
     C                     MOVE *BLANKS   SCR
     C                     SETOF                     101112
     C                     SETOF                     131415               E23120
     C*********************SETOF*********************1315                 E23120
     C                     SETON                     02
     C                     SETOF                     03
     C                     SETOF                     70                   E18222
     C                     SETOF                     61                   CSE031
     C                     Z-ADD0         SCNNO   10
     C                     Z-ADD0         TOPNO   10
     C                     Z-ADD0         SCFCT                           072101
     C**
     C                     ENDSR
     C*****************************************************************
     C/EJECT
0738 C*****************************************************************
     C**                                                              *
     C**   DISP   SR  Format details for output                       *
     C**                                                              *
     C**   Called by  COMMD, SECIN                                    *
     C**                                                              *
     C**   Calls  SR  FILL1, FILL2, FILL3                             *
     C**                                                              *
     C*****************************************************************
     C**
     C           DISP      BEGSR                           ** DISP   **
     C**
     C**   Format details for correct screen
     C**
     C           SCNNO     CASEQ0         FILL1
     C           SCNNO     CASEQ1         FILL2
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP7                                           S01408
     C*                                                                   S01408
     C***********          CAS            FILL3                           CSE031
     C           SCNNO     CASEQ2         FILL3                           CSE031
     C                     CAS            FILL4                           CSE031
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP8                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP6                                           S01408
     C*                                                                   S01408
     C                     END
     **
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CP15                                           S01408
     C*                                                                   S01408
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   FILL1  SR  Fill first screen fields                        *
     C**                                                              *
     C**   Called by  DISP                                            *
     C**                                                              *
     C**   Calls  SR  none                                            *
     C**                                                              *
     C**   Calls PGM  none                                            *
     C**                                                              *
     C*****************************************************************
     C**
     C           FILL1     BEGSR                           *** FILL1 *****
     C**
     C**   Show first screen is filled
     C**
     C                     Z-ADD1         TOPNO
     C                     Z-ADD1         SCNNO
     C**
     C**   Enable ROLLUP but not ROLLDOWN
     C**
     C                     SETOF                     03
     C                     SETON                     02
     C**
     C                     MOVE INCS      SINCS
     C                     MOVE NMCY      SNMCY
     C                     MOVE SITP      SSITP
     C**********           MOVE SIDY      SSIDY                                             MD037972
     C           LOIC      IFNE *BLANKS                                                     MD037972
     C                     MOVE LOIC      SSIDY                                             MD037972
     C                     ELSE                                                             MD037972
     C                     MOVE ' '       SSIDY                                             MD037972
     C                     ENDIF                                                            MD037972
     C                     MOVE VLCY      SVLCY
     C                     MOVE MLTI      SMLTI
     C                     MOVE SSEC      SSSEC
     C                     MOVE QLTY      SQLTY
     C                     MOVE MKTI      SMKTI
     C                     MOVE SCOR      SSCOR
     C                     MOVE SRET      SSRET
     C                     MOVE SREF      SSREF
     C**********           MOVE TVRF      STVRF                           S01176
     C                     MOVE T2RF      ST2RF                           S01176
     C                     MOVE PPDI      SPPDI
     C***********          MOVE SDNM      SSDNM                           E23272
     C                     MOVE ISIN      SISIN                           S01401
     C                     MOVE SWTP      SSWTP                           S01401
     C                     MOVE NMDP      SNMDP                           CEU018
     C                     MOVE NDEC      SNDEC                                               CSE037
     C                     MOVE SRRB      SSRRB                           CEU017
     C                     MOVE PLICCD    SPLICC                          CPL002
     C                     MOVE PLDINM    SPLDIN                          CPL002
     C                     MOVE PLRGCD    SPLRGC                          CPL002
     C                     MOVE PLPGCD    SPLPGC                          CPL002
     C           CGL032    IFEQ 'Y'                                                           CGL032
     C                     MOVE SETX      SSETX                                               CGL032
     C                     ENDIF                                                              CGL032
     C*                                                                   E23272
     C*  SUPPRESS LEADING ZEROS ON TRADE DENOMINATIONS                    E23272
     C*                                                                   E23272
     C                     MOVE SDNM      ZFIELD                          E23272
     C                     MOVE 0         ZADEC                           E23272
     C                     EXSR ZEDIT                                     E23272
     C                     MOVE ZFIELD    SSDNM                           E23272
     C*                                                                   E23272
     C                     MOVE ERPY      SERPY
     C                     MOVE VDFT      SVDFT
     C                     MOVE EDFT      SEDFT
     C                     MOVE SFN1      SSFN1
     C                     MOVE SFN2      SSFN2
     C**********           MOVE SRPN      SSRPN                           S01158
     C                     MOVE SRPN      SSRPN                     S01158E15611
     C                     MOVE CSPN      SCSPN
     C**
     C***FORMAT*SECURITY*DESCRIPTION*VIA*ZSDESC                     S01158E15611
     C*********************MOVE SRPN      ZSRPN                     S01158E15611
     C*********************EXSR ZSDESC                              S01158E15611
     C*********************MOVE ZRNME     SRNME                     S01158E15611
     C**                                                                  S01158
     C********** ISSR      CHAINCLINTCBF             26                   S01117
     C                     MOVELISSR      @CKEY  10                       S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM           @CKEY                           S01117
     C                     PARM *BLANKS   @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      ANDNE'*'                                       S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C**********           MOVELCSNM      SS1SN                           S01117
     C                     MOVELBBCSSN    SS1SN                           S01117
     C                     ELSE
     C                     MOVELISSR      SS1SN
     C                     END
     C**
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   FILL2  SR  Fill second screen fields                       *
     C**                                                              *
     C**   Called by  DISP                                            *
     C**                                                              *
     C**   Calls  SR  ZDATE2, ZSEDIT                                  *
     C**                                                              *
     C**   Calls PGM  none                                            *
     C**                                                              *
     C*****************************************************************
     C**
     C           FILL2     BEGSR                           *** FILL2 *****
     C**
     C**   Enable ROLLUP and ROLLDOWN
     C**
     C                     SETON                     0203
     C**
     C**   Show second screen is filled
     C**
     C                     Z-ADD2         TOPNO
     C                     Z-ADD2         SCNNO
     C**
     C** Access investment type record for settlement depots
     C**
     C****       SITP      CHAININVTO                26                   S01158
     C           INVKA     KLIST                                          S01158
     C                     KFLD           NMCY                            S01158
     C                     KFLD           SITP                            S01158
     C           INVKA     CHAININVTPDF              26                   S01158
     C           *IN26     IFEQ '0'
     C           RECI      IFEQ '*'
     C                     SETON                     26
     C                     END
     C                     END
     C           *IN26     IFEQ '1'
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE *BLANKS   DBLOT                           S01117
     C                     MOVELPROGRM    DBPGM
     C                     MOVE *BLANKS   DBKEY            ************
     C                     MOVELSITP      DBKEY            * DATABASE *
     C                     MOVE 'INVTP'   DBFILE           * ERROR 04 *
     C                     Z-ADD04        DBASE            ************
     C                     OUT  LDA                                       S01117
     C                     SETON                       U7U8
     C                     EXSR *PSSR
     C                     MOVE '0'       RTNC
     C                     EXSR RETSR
     C                     END
     C**
     C** Access settlement depot short names
     C**
     C********** SDC1      CHAINCLINTCBF             26                   S01117
     C                     MOVELSDC1      @CKEY                           S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           @CKEY                           S01117
     C                     PARM *BLANKS   @KYST                           S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      ANDNE'*'                                       S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C**********           MOVELCSNM      SCSN1                           S01117
     C                     MOVELBBCSSN    SCSN1                           S01117
     C                     ELSE
     C** Write blanks (not zeros)  to screen if no depot cust. entered    E23116
     C********** SDC1      IFEQ *ZEROS                                                 E23116 CSD027
     C           SDC1      IFEQ *BLANKS                                                       CSD027
     C                     MOVE *BLANKS   SCSN1                           E23116
     C                     ELSE                                           E23116
     C                     MOVELSDC1      SCSN1
     C                     END                                            E23116
     C                     END
     C********** SDC2      CHAINCLINTCBF             26                   S01117
     C                     MOVELSDC2      @CKEY                           S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           @CKEY                           S01117
     C                     PARM *BLANKS   @KYST                           S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      ANDNE'*'                                       S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C**********           MOVELCSNM      SCSN2                           S01117
     C                     MOVELBBCSSN    SCSN2                           S01117
     C                     ELSE
     C********** SDC2      IFEQ *ZEROS                                                 E23116 CSD027
     C           SDC2      IFEQ *BLANKS                                                       CSD027
     C                     MOVE *BLANKS   SCSN2                           E23116
     C                     ELSE                                           E23116
     C                     MOVELSDC2      SCSN2
     C                     END                                            E23116
     C                     END
     C********** SDC3      CHAINCLINTCBF             26                   S01117
     C                     MOVELSDC3      @CKEY                           S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           @CKEY                           S01117
     C                     PARM *BLANKS   @KYST                           S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      ANDNE'*'                                       S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C**********           MOVELCSNM      SCSN3                           S01117
     C                     MOVELBBCSSN    SCSN3                           S01117
     C                     ELSE
     C********** SDC3      IFEQ *ZEROS                                                 E23116 CSD027
     C           SDC3      IFEQ *BLANKS                                                       CSD027
     C                     MOVE *BLANKS   SCSN3                           E23116
     C                     ELSE                                           E23116
     C                     MOVELSDC3      SCSN3
     C                     END                                            E23116
     C                     END
     C**
     C** Format security references
     C**
     C**********           MOVE D1SR      SD1SR                           S01176
     C**********           MOVE D2SR      SD2SR                           S01176
     C**********           MOVE D3SR      SD3SR                           S01176
     C                     MOVE DASR      SDASR                           S01176
     C                     MOVE DCSR      SDCSR                           S01176
     C                     MOVE DDSR      SDDSR                           S01176
     C**
     C** Format market centre
     C**
     C                     MOVE SMCC      SSMCC
     C********** SMCC      CHAINMARKT                26
     C           SMCC      CHAINSEMKC                26
     C           *IN26     IFEQ '0'
     C           RECI      ANDNE'*'
     C                     MOVELMKTN      SMKTN
     C                     ELSE
     C                     MOVE *BLANKS   SMKTN
     C                     END
     C**
     C** Format other simple fields
     C**
     C                     MOVE SCVI      SSCVI
     C                     MOVE SPBS      SSPBS
     C                     MOVE STBS      SSTBS
     C                     MOVE SYBS      SSYBS
      *                                                                   S01397
      ***  Australian Yield fields.                                       S01397
      *                                                                   S01397
     C           SSYBS     IFEQ 'AU'                                      S01397
     C                     MOVE CMFQ      SCMFQ                           S01397
     C                     MOVE DSCB      SDSCB                           S01397
     C                     MOVE DSLC      SDSLC                           S01397
     C                     SETON                     33                   S01397
     C                     ELSE                                           S01397
     C                     SETOF                     33                   S01397
     C                     END                                            S01397
     C**
     C** SHARES OR UNIT TRUSTS/MUTUAL FUNDS
     C**
     C                     SETOF                     35                   S01220
     C           PROT      IFEQ '4'                                       S01220
     C                     SETON                     35                   S01220
     C                     END                                            S01220
     C*                                                                   S01220
     C           PROT      IFEQ '4'
     C           PROT      OREQ '7'
     C**
     C** Format initial dividend date
     C**
     C                     SETON                     12
     C                     Z-ADDIDIV      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SIDIV
     C**
     C** Format dividend payment dates
     C**
     C**********           MOVEACD        SCD                             CSE005
     C                     MOVE CD        SCD                             CSE005
     C**
     C** Format next expected dividend
     C** Access currency table record for value/nominal currency
     C**
     C           VLCY      IFNE *BLANKS
     C**********           MOVE VLCY      KCCY                            S01117
     C***********          MOVE VLCY      @KEYC   7                 S01117E28631
     C                     MOVE VLCY      @KEYC   3                       E28631
     C                     ELSE
     C**********           MOVE NMCY      KCCY                            S01117
     C                     MOVE NMCY      @KEYC                           S01117
     C                     END
     C**********           MOVEL'20      'TKEY   12                       S01117
     C**********           MOVELKCCY      ZWK4    4                       S01117
     C**********           MOVE 1         ZWK4                            S01117
     C**********           MOVE ZWK4      TKEY                            S01117
     C********** TKEY      CHAINTABTG10F             26                   S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*DBERR ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           @KEYC                           S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      IFEQ '*'                                       S01117
     C**********           SETON                     26                   S01117
     C**********           END                                            S01117
     C**********           END                                            S01117
     C********** *IN26     IFEQ '1'                                       S01117
     C**********           MOVELPROGRM    DBPGM                           S01117
     C**********           MOVE *BLANKS   DBKEY            ************   S01117
     C**********           MOVELKCCY      DBKEY            * DATABASE *   S01117
     C**********           MOVE 'TABLE'   DBFILE           * ERROR 05 *   S01117
     C**********           Z-ADD05        DBASE            ************   S01117
     C**********           SETON                       U7U8               S01117
     C**********           MOVE '0'       RTNC                            S01117
     C**********           EXSR RETSR                                     S01117
     C**********           END                                            S01117
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE NEXD      ZFLD15
     C**********           Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SNEXD
     C**
     C                     END
     C**
     C** SET UP NEW FIELDS (S01176) AND INDICATORS FOR PROT = 9           S01176
     C** AND PROT NE 2, 4, OR 7 (REGARDLESS OF TRADE BASIS)               S01176
     C**                                                                  S01176
     C                     MOVE MDTI      SMDTI1                          S01176
     C                     MOVE MDTI      SMDTI2                          S01176
     C                     MOVE CNLI      SCLIN                           S01176
     C                     MOVELRSKC      SRSKC                           S01176
     C                     MOVE DRWR      SDRWR                           S01176
     C**                                                                  S01176
     C           PROT      IFEQ '9'                                       S01176
     C                     SETON                     16                   S01176
     C                     END                                            S01176
     C**                                                                  S01176
     C           PROT      IFEQ '2'                                       S01176
     C           PROT      OREQ '4'                                       S01176
     C           PROT      OREQ '7'                                       S01176
     C                     ELSE                                           S01176
     C                     SETON                     17                   S01176
     C                     END                                            S01176
     C**                                                                  S01176
     C** TRADE BASIS IS D
     C**                                                                  S01176
     C           STBS      IFEQ 'D'
     C           STBS      OREQ 'Y'                                       S01176
     C           PROT      ANDEQ'9'                                       S01176
     C**
     C                     SETON                     15
     C**
     C** Format maturity date
     C**
     C           MATY      IFNE 99999                                     E18222
     C                     SETOF                     70                   E18222
     C                     Z-ADDMATY      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SMATY1
     C                     MOVE ZADATE    SMATY2
     C                     ELSE                                           E18222
     C                     SETON                     70                   E18222
     C                     Z-ADDMATY      MATY1   50                      E18222
     C                     Z-ADDMATY      MATY2   50                      E18222
     C                     END                                            E18222
     C**
     C** Set up other fields
     C**
     C                     MOVE DYBS      SDYBS1
     C                     MOVE DYBS      SDYBS2
     C                     MOVE DVBS      SDVBS1
     C                     MOVE DVBS      SDVBS2
     C**
     C                     END
     C**
     C** TRADE BASIS IS P OR Y & PROCESSING TYPE IS NOT 2,4 OR 7
     C**
     C           STBS      IFEQ 'P'
     C           STBS      OREQ 'Y'
     C           PROT      IFEQ '2'
     C           PROT      OREQ '4'
     C           PROT      OREQ '7'
     C           PROT      OREQ '9'                                       S01176
     C           STBS      ANDEQ'Y'                                       S01176
     C                     ELSE
     C**
     C                     SETON                     10
     C**
     C** Format maturity date
     C**
     C           MATY      IFNE 99999                                     E18222
     C                     SETOF                     70                   E18222
     C                     Z-ADDMATY      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SMATY1
     C                     MOVE ZADATE    SMATY2
     C                     ELSE                                           E18222
     C                     SETON                     70                   E18222
     C                     Z-ADDMATY      MATY1   50                      E18222
     C                     Z-ADDMATY      MATY2   50                      E18222
     C                     END                                            E18222
     C**
     C** Set up other fields
     C**
     C                     MOVE DYBS      SDYBS1
     C                     MOVE DYBS      SDYBS2
     C                     MOVE DVBS      SDVBS1
     C                     MOVE DVBS      SDVBS2
     C**
     C***Format*next*change*date****                                      E23120
     C*********************Z-ADDNCHD      ZDAYNO                          E23120
     C*********************EXSR*ZDATE2                                    E23120
     C*********************MOVE*ZADATE    SNCHD                           E23120
     C**
     C** Format coupon rate
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE CPNR      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SCPNR
     C** Get current factor                                               072101
     C/COPY WNCPYSRC,SE0245C006
     C                     MOVE CFCT      SCFCT                           072101
     C/COPY WNCPYSRC,SE0245C007
     C**
     C** Base Rate/Spread information required only for FRN's             E23120
     C** OR Mortgage Backed Securities if CSE031 is on.                   CSE031
     C           PROT      IFEQ '3'                                       E23120
     C           PROT      OREQ '8'                                       CSE031
     C           CSE031    ANDEQ'Y'                                       CSE031
     C                     SETON                     14                   E23120
     C*                                                                   CSE031
     C** Enable CSE031 fields                                             CSE031
     C           CSE031    IFEQ 'Y'                                       CSE031
     C           *IN14     ANDEQ*ON                                       CSE031
     C                     SETON                     61                   CSE031
     C                     ENDIF                                          CSE031
     C*                                                                   CSE031
     C** Format base rate spread
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE BASS      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SBASS
     C*
     C** Format next change date                                          E23120
     C*
     C                     Z-ADDNCHD      ZDAYNO                          E23120
     C                     EXSR ZDATE2                                    E23120
     C                     MOVE ZADATE    SNCHD                           E23120
     C                     END                                            E23120
     C*
     C** Format minimum coupon
     C*
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MCPN      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SMCPN
     C**
     C** Format initial date
     C**
     C                     Z-ADDITLD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SITLD
     C**
     C** Format first coupon date
     C**
     C                     Z-ADDFCPN      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SFCPN
     C**
     C** Set up other fields
     C**
     C                     MOVE BASC      SBASC
     C                     MOVE SPRI      SSPRI
     C                     MOVE LTMI      SLTMI
     C                     MOVE IADJ      SIADJ
     C                     MOVE CD        SCD
     C                     MOVE CR        SCR
     C                     SETON                     11
     C                     MOVE RCFQ      SRCFQ
     C**
     C                     END
     C                     END
     C**
     C** PARTLY PAID INDICATOR IS Y
     C**
     C           PPDI      IFEQ 'Y'
     C**
     C                     SETON                     13
     C**
     C** Format initial price and fully paid price
     C***If*processing*type*is*not*4*access*table*for*nominal*currency**  S01158
     C** If processing type is  4 access table for nominal currency       S01158
     C**
     C********** PROT      IFEQ '4'                                       S01158
     C           PROT      IFNE '4'                                       S01158
     C                     Z-ADD3         ZDECS
     C                     ELSE
     C**********           MOVEL'20      'TKEY   12                       S01117
     C**********           MOVELNMCY      ZWK4    4                       S01117
     C**********           MOVE 1         ZWK4                            S01117
     C**********           MOVE ZWK4      TKEY                            S01117
     C********** TKEY      CHAINTABTG10F             26                   S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*DBERR ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM NMCY      @KEYC                           S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      IFEQ '*'                                       S01117
     C**********           SETON                     26                   S01117
     C**********           END                                            S01117
     C**********           END                                            S01117
     C********** *IN26     IFEQ '1'                                       S01117
     C**********           MOVELPROGRM    DBPGM                           S01117
     C**********           MOVE *BLANKS   DBKEY            ************   S01117
     C**********           MOVELNMCY      DBKEY            * DATABASE *   S01117
     C**********           MOVE 'TABLE'   DBFILE           * ERROR 06 *   S01117
     C**********           Z-ADD06        DBASE            ************   S01117
     C**********           SETON                       U7U8               S01117
     C**********           MOVE '0'       RTNC                            S01117
     C**********           EXSR RETSR                                     S01117
     C**********           END                                            S01117
     C**********           Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     END
     C**
     C                     MOVE 'L'       ZECODE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE SINP      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SSINP
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE SFPP      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SSFPP
     C**
     C                     END
     C*                                                                   CSE005
     C***  If Processing Type is 3 and CSE005 is on then...               CSE005
     C*                                                                   CSE005
     C           *IN08     IFEQ *ON                                       CSE005
     C           *IN14     ANDEQ*ON                                       CSE005
     C*                                                                   CSE005
     C***  Set SLCPN to be the Last Coupon Date                           CSE005
     C*                                                                   CSE005
     C           LCPN      IFNE *ZEROS                                    CSE005
     C                     MOVE LCPN      ZDAYNO                          CSE005
     C                     EXSR ZDATE2                                    CSE005
     C                     MOVE ZADATE    SLCPN                           CSE005
     C                     ELSE                                           CSE005
     C                     MOVE *BLANKS   SLCPN                           CSE005
     C                     ENDIF                                          CSE005
     C*                                                                   CSE005
     C*** Calculate Next Coupon Date to be displayed (SNCD)               CSE005
     C*** using ZNCD with ECD=RUND and numeric CD array                   CSE005
     C*                                                                   CSE005
     C                     Z-ADDRUND      ECD     50                      CSE005
     C                     EXSR ZNCD                                      CSE005
     C           NCD       IFNE *ZEROS                                    CSE005
     C                     MOVE NCD       ZDAYNO                          CSE005
     C                     EXSR ZDATE2                                    CSE005
     C                     MOVE ZADATE    SNCD                            CSE005
     C                     ELSE                                           CSE005
     C                     MOVE *BLANKS   SNCD                            CSE005
     C                     ENDIF                                          CSE005
     C*                                                                   CSE005
     C                     ENDIF                                          CSE005
     C*                                                                   CSE031
     C***  If Processing Type is 3 or 8 and CSE031 is on then             CSE031
     C***  set up Fixing Days and Auto Fix.                               CSE031
     C*                                                                   CSE031
     C           CSE031    IFEQ 'Y'                                       CSE031
     C           *IN14     ANDEQ*ON                                       CSE031
     C                     MOVE FIXD      SFIXD                           CSE031
     C                     MOVE AUFX      SAUFX                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                                       CAS006
      ** If CAS006 is on, turn indicator on to display Credit Risk                            CAS006
      ** Spread and Liquidity Premium Fields                                                  CAS006
      *                                                                                       CAS006
     C           CAS006    IFEQ 'Y'                                                           CAS006
     C           *IN10     IFEQ '1'                                                           CAS006
     C                     MOVE '1'       *IN18                                               CAS006
      *                                                                                       CAS006
     C                     Z-ADD7         ZDECS                                               CAS006
     C                     MOVE CCRK      WZCCRK 117                                          CAS006
     C                     MOVE *BLANKS   ZFLD15                                              CAS006
     C                     MOVE WZCCRK    ZFLD15                                              CAS006
     C                     EXSR ZSEDIT                                                        CAS006
     C                     MOVE ZOUT21    #2CCRK                                              CAS006
      *                                                                                       CAS006
     C                     Z-ADD7         ZDECS                                               CAS006
     C                     MOVE CLQP      WZCLQP 117                                          CAS006
     C                     MOVE *BLANKS   ZFLD15                                              CAS006
     C                     MOVE WZCLQP    ZFLD15                                              CAS006
     C                     EXSR ZSEDIT                                                        CAS006
     C                     MOVE ZOUT21    #2CLQP                                              CAS006
      *                                                                                       CAS006
     C                     ELSE                                                               CAS006
     C                     MOVE '0'       *IN18                                               CAS006
     C                     ENDIF                                                              CAS006
      *                                                                                       CAS006
     C                     ENDIF                                                              CAS006
     C**
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   FILL3  SR  Fill third screen fields                        *
     C**                                                              *
     C**   Called by  DISP                                            *
     C**                                                              *
     C**   Calls  SR  ZDATE2, ZSEDIT                                  *
     C**                                                              *
     C**   Calls PGM  none                                            *
     C**                                                              *
     C*****************************************************************
     C**
     C           FILL3     BEGSR                           *** FILL3 *****
     C**
     C**   Show third screen is filled
     C**
     C                     Z-ADD3         TOPNO
     C                     Z-ADD3         SCNNO
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CP11                                           S01408
     C*                                                                   S01408
     C**
     C**   Enable ROLLDOWN but not ROLLUP
     C**
     C           *IN61     IFEQ *ON                                       CSE031
     C                     SETON                     02                   CSE031
     C                     ELSE                                           CSE031
     C                     SETOF                     02
     C                     ENDIF                                          CSE031
     C                     SETON                     03
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CP10                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CCP9                                           S01408
     C*                                                                   S01408
     C**
     C** Format issue date
     C**
     C                     Z-ADDISSD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SISSD
     C**
     C** Format lead manager
     C**
     C********** LMGR      CHAINCLINTCBF             26                   S01117
     C                     MOVELLMGR      @CKEY                           S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           @CKEY                           S01117
     C                     PARM *BLANKS   @KYST                           S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      ANDNE'*'                                       S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C**********           MOVELCSNM      SLMGR                           S01117
     C                     MOVELBBCSSN    SLMGR                           S01117
     C                     ELSE
     C                     MOVELLMGR      SLMGR
     C                     END
     C**
     C** Format issue price
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE ISSP      ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SISSP
     C**
     C** Format issue amount
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE ISSA      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SISSA
     C**
     C** Format total underwritten
     C**
     C/COPY WNCPYSRC,SE0245C013
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE TOTU      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    STOTU
     C/COPY WNCPYSRC,SE0245C014
     C**
     C** Format allocation requested
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE ALRQ      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SALRQ
     C**
     C** Format allocation received
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE ALRC      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SALRC
     C**
     C** Access currency table record for fee currency
     C**
     C                     MOVE FECY      SFECY
     C**********           MOVEL'20      'TKEY   12                       S01117
     C**********           MOVELFECY      ZWK4    4                       S01117
     C**********           MOVE 1         ZWK4                            S01117
     C**********           MOVE ZWK4      TKEY                            S01117
     C********** TKEY      CHAINTABTG10F             26                   S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*DBERR ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM FECY      @KEYC                           S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C********** *IN26     IFEQ '0'                                       S01117
     C********** RECI      IFEQ '*'                                       S01117
     C**********           SETON                     26                   S01117
     C**********           END                                            S01117
     C**********           END                                            S01117
     C********** *IN26     IFEQ '1'                                       S01117
     C**********           MOVELPROGRM    DBPGM                           S01117
     C**********           MOVE *BLANKS   DBKEY            ************   S01117
     C**********           MOVELFECY      DBKEY            * DATABASE *   S01117
     C**********           MOVE 'TABLE'   DBFILE           * ERROR 03 *   S01117
     C**********           Z-ADD03        DBASE            ************   S01117
     C**********           SETON                       U7U8               S01117
     C**********           MOVE '0'       RTNC                            S01117
     C**********           EXSR RETSR                                     S01117
     C**********           END                                            S01117
     C**
     C** Format management fees due
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MGFD      ZFLD15
     C**********           Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SMGFD
     C**
     C** Format management fees received
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MGRC      ZFLD15
     C**********           Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SMGRC
     C**
     C** Format underwriting fees due
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE UNFD      ZFLD15
     C**********           Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SUNFD
     C**
     C** Format underwriting fees received
     C**
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE UNFR      ZFLD15
     C**********           Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    SUNFR
      *                                                                   CPB002
     C           BGN4ST    IFEQ 'Y'                                       CPB002
     C********** PPAG      IFNE *ZEROS                                                 CPB002 CSD027
     C           PPAG      IFNE *BLANKS                                                       CSD027
     C                     MOVELPPAG      SPPAG                           CPB002
     C                     ELSE                                           CPB002
     C                     MOVE *BLANKS   SPPAG                           CPB002
     C                     ENDIF                                          CPB002
     C********** GUAR      IFNE *ZEROS                                                 CPB002 CSD027
     C           GUAR      IFNE *BLANKS                                                       CSD027
     C                     MOVELGUAR      SGUAR                           CPB002
     C                     ELSE                                           CPB002
     C                     MOVE *BLANKS   SGUAR                           CPB002
     C                     ENDIF                                          CPB002
     C           WEIC      IFNE *ZEROS                                    CPB002
     C                     MOVELWEIC      SWEIC                           CPB002
     C                     ELSE                                           CPB002
     C                     MOVE *BLANKS   SWEIC                           CPB002
     C                     ENDIF                                          CPB002
     C                     MOVELNATU      SNATU                           CPB002
     C                     MOVELPBIT      SPBIT                           CPB002
     C                     ENDIF                                          CPB002
     C**
      ** Format Average Life Date is CSE065 is on.                                            CSE065
      *                                                                                       CSE065
     C           CSE065    IFEQ 'Y'                                                           CSE065
     C                     CALL 'ZA0140'                                                      CSE065
     C                     PARM ALDT      P@DAYN  50                                          CSE065
     C                     PARM BJDFIN    P@DFMT  1                                           CSE065
     C                     PARM *ZEROS    P@DATE  60                                          CSE065
     C                     PARM *BLANKS   P@DATA  7                                           CSE065
     C                     PARM *BLANK    P@RTN   1                                           CSE065
     C                     PARM *ZEROS    P@DAT8  80                                          CSE065
      *                                                                                       CSE065
     C                     MOVE P@DATA    Z@DATA                                              CSE065
     C                     MOVE P@DAT8    Z@DAT8                                              CSE065
      *                                                                                       CSE065
     C                     MOVE Z@DADM    D@DYMO                                              CSE065
     C                     MOVE Z@D8YR    D@DDYR                                              CSE065
      *                                                                                       CSE065
     C                     MOVE D@DATE    SSDAL                                               CSE065
      *                                                                                       CSE065
     C                     ENDIF                                                              CSE065
      *                                                                                       CSE065
      ** Format Enhanced Treasury fields if CSE075 is on                                      CSE075
      *                                                                                       CSE075
     C           CSE075    IFEQ 'Y'                                                           CSE075
     C                     MOVE SSESN     KSESN                                               CSE075
     C           KSESN     CHAINSECTY                81                                       CSE075
     C           *IN81     IFEQ *OFF                                                          CSE075
      *                                                                                       CSE075
      ** Format 'Expected Repayment Rate'                                                     CSE075
      *                                                                                       CSE075
     C                     MOVE *BLANKS   ZFIELD                                              CSE075
     C                     MOVE RPRT      ZFIELD                                              CSE075
     C                     Z-ADD4         ZADEC                                               CSE075
     C                     EXSR ZEDIT                                                         CSE075
     C                     MOVE ZFIELD    SRPRT                                               CSE075
      *                                                                                       CSE075
      ** Format 'Coupon Delay'                                                                CSE075
      *                                                                                       CSE075
     C                     MOVE *BLANKS   ZFIELD                                              CSE075
     C                     MOVE CPDY      ZFIELD                                              CSE075
     C                     Z-ADD*ZERO     ZADEC                                               CSE075
     C                     EXSR ZEDIT                                                         CSE075
     C                     MOVE ZFIELD    SCPDY                                               CSE075
      *                                                                                       CSE075
      ** Format 'Weighted Average Coupon'                                                     CSE075
      *                                                                                       CSE075
     C                     MOVE *BLANKS   ZFIELD                                              CSE075
     C                     MOVE WACP      ZFIELD                                              CSE075
     C                     Z-ADD4         ZADEC                                               CSE075
     C                     EXSR ZEDIT                                                         CSE075
     C                     MOVE ZFIELD    SWACP                                               CSE075
      *                                                                                       CSE075
      ** Format 'Weighted Average Maturity'                                                   CSE075
      *                                                                                       CSE075
     C                     MOVE *BLANKS   ZFIELD                                              CSE075
     C                     MOVE WAMY      ZFIELD                                              CSE075
     C                     Z-ADD4         ZADEC                                               CSE075
     C                     EXSR ZEDIT                                                         CSE075
     C                     MOVE ZFIELD    SWAMY                                               CSE075
      *                                                                                       CSE075
      ** If processing type is 8 enable display of the fields                                 CSE075
      *                                                                                       CSE075
     C           PROT      IFEQ '8'                                                           CSE075
     C                     MOVE '1'       *IN75                                               CSE075
     C                     ENDIF                                                              CSE075
     C           STBS      IFEQ 'P'                                                           CSE075
     C           PROT      ANDNE'2'                                                           CSE075
     C           PROT      ANDNE'4'                                                           CSE075
     C           PROT      ANDNE'7'                                                           CSE075
     C           STBS      OREQ 'Y'                                                           CSE075
     C           PROT      ANDNE'2'                                                           CSE075
     C           PROT      ANDNE'4'                                                           CSE075
     C           PROT      ANDNE'7'                                                           CSE075
     C           PROT      ANDNE'9'                                                           CSE075
     C                     MOVE '1'       *IN76                                               CSE075
     C                     ELSE                                                               CSE075
     C                     MOVE '0'       *IN76                                               CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
     C                     ENDSR
     C*****************************************************************
      /EJECT                                                              CSE031
      *****************************************************************   CSE031
      **                                                              *   CSE031
      **   FILL4  SR  Fill fourth screen fields                       *   CSE031
      **                                                              *   CSE031
      **   Called by  DISP                                            *   CSE031
      **                                                              *   CSE031
      **   Calls  SR  ZDATE2, ZSEDIT                                  *   CSE031
      **                                                              *   CSE031
      **   Calls PGM  none                                            *   CSE031
      **                                                              *   CSE031
      *****************************************************************   CSE031
      **                                                                  CSE031
     C           FILL4     BEGSR                           *** FILL4 *****CSE031
      *                                                                   CSE031
     C           *IN61     IFEQ *ON                                       CSE031
      *                                                                   CSE031
      **   Show fourth screen is filled                                   CSE031
      *                                                                   CSE031
     C                     Z-ADD4         TOPNO                           CSE031
     C                     Z-ADD4         SCNNO                           CSE031
      *                                                                   CSE031
      **   Enable ROLLDOWN but not ROLLUP                                 CSE031
      *                                                                   CSE031
     C                     SETOF                     02                   CSE031
     C                     SETON                     03                   CSE031
      *                                                                   CSE031
      ** Applicable Date 1                                                CSE031
     C           AD01      IFNE *ZERO                                     CSE031
     C                     MOVE AD01      SAD01                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 1                                                 CSE031
     C           BR01      IFNE *ZERO                                     CSE031
     C                     MOVE BR01      SBR01                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 1                                                    CSE031
     C           BS01      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS01      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS01                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 1                                               CSE031
     C                     MOVE SI01      SSI01                           CSE031
      *                                                                   CSE031
      ** Applicable Date 2                                                CSE031
     C           AD02      IFNE *ZERO                                     CSE031
     C                     MOVE AD02      SAD02                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 2                                                 CSE031
     C           BR02      IFNE *ZERO                                     CSE031
     C                     MOVE BR02      SBR02                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 2                                                    CSE031
     C           BS02      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS02      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS02                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 2                                               CSE031
     C                     MOVE SI02      SSI02                           CSE031
      *                                                                   CSE031
      ** Applicable Date 3                                                CSE031
     C           AD03      IFNE *ZERO                                     CSE031
     C                     MOVE AD03      SAD03                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 3                                                 CSE031
     C           BR03      IFNE *ZERO                                     CSE031
     C                     MOVE BR03      SBR03                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 3                                                    CSE031
     C           BS03      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS03      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS03                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 3                                               CSE031
     C                     MOVE SI03      SSI03                           CSE031
      *                                                                   CSE031
      ** Applicable Date 4                                                CSE031
     C           AD04      IFNE *ZERO                                     CSE031
     C                     MOVE AD04      SAD04                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 4                                                 CSE031
     C           BR04      IFNE *ZERO                                     CSE031
     C                     MOVE BR04      SBR04                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 4                                                    CSE031
     C           BS04      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS04      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS04                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 4                                               CSE031
     C                     MOVE SI04      SSI04                           CSE031
      *                                                                   CSE031
      ** Applicable Date 5                                                CSE031
     C           AD05      IFNE *ZERO                                     CSE031
     C                     MOVE AD05      SAD05                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 5                                                 CSE031
     C           BR05      IFNE *ZERO                                     CSE031
     C                     MOVE BR05      SBR05                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 5                                                    CSE031
     C           BS05      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS05      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS05                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 5                                               CSE031
     C                     MOVE SI05      SSI05                           CSE031
      *                                                                   CSE031
      ** Applicable Date 6                                                CSE031
     C           AD06      IFNE *ZERO                                     CSE031
     C                     MOVE AD06      SAD06                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 6                                                 CSE031
     C           BR06      IFNE *ZERO                                     CSE031
     C                     MOVE BR06      SBR06                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 6                                                    CSE031
     C           BS06      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS06      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS06                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 6                                               CSE031
     C                     MOVE SI06      SSI06                           CSE031
      *                                                                   CSE031
      ** Applicable Date 7                                                CSE031
     C           AD07      IFNE *ZERO                                     CSE031
     C                     MOVE AD07      SAD07                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 7                                                 CSE031
     C           BR07      IFNE *ZERO                                     CSE031
     C                     MOVE BR07      SBR07                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 7                                                    CSE031
     C           BS07      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS07      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS07                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 1                                               CSE031
     C                     MOVE SI07      SSI07                           CSE031
      *                                                                   CSE031
      ** Applicable Date 8                                                CSE031
     C           AD08      IFNE *ZERO                                     CSE031
     C                     MOVE AD08      SAD08                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 8                                                 CSE031
     C           BR08      IFNE *ZERO                                     CSE031
     C                     MOVE BR08      SBR08                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 8                                                    CSE031
     C           BS08      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS08      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS08                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 8                                               CSE031
     C                     MOVE SI08      SSI08                           CSE031
      *                                                                   CSE031
      ** Applicable Date 9                                                CSE031
     C           AD09      IFNE *ZERO                                     CSE031
     C                     MOVE AD09      SAD09                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 9                                                 CSE031
     C           BR09      IFNE *ZERO                                     CSE031
     C                     MOVE BR09      SBR09                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 9                                                    CSE031
     C           BS09      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS09      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS09                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 9                                               CSE031
     C                     MOVE SI09      SSI09                           CSE031
      *                                                                   CSE031
      ** Applicable Date 10                                               CSE031
     C           AD10      IFNE *ZERO                                     CSE031
     C                     MOVE AD10      SAD10                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Base Rate Code 10                                                CSE031
     C           BR10      IFNE *ZERO                                     CSE031
     C                     MOVE BR10      SBR10                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Rate 10                                                   CSE031
     C           BS10      IFNE *ZERO                                     CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS10      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    SBS10                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
      ** Spread Indicator 10                                              CSE031
     C                     MOVE SI10      SSI10                           CSE031
      *                                                                   CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
     C                     ENDSR                                          CSE031
     C*****************************************************************   CSE031
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CP12                                           S01408
     C*                                                                   S01408
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   LINK   SR  Lower level Enquiry requested                   *
     C**                                                              *
     C**   Called by  MAIN                                            *
     C**                                                              *
     C**   Calls  SR  none                                            *
     C**                                                              *
     C**   Calls PGM  lower level enquiry obtained from SECOND        *
     C**                                                              *
     C*****************************************************************
     C**
0740 C           LINK      BEGSR                           *** LINK ******
0741 C**
     C**   Access Linked Enquiry Control File for program and option
     C**
     C           LKEY      KLIST
     C                     KFLD           PGMNO
     C                     KFLD           OPTN
     C**
     C                     MOVE *BLANKS   OPTN
     C                     MOVE SACTN     OPTN
     C           LKEY      CHAINSECONDF              42
     C**
     C**   If record not found then entered option is invalid
     C**
     C           *IN42     IFEQ '1'
     C                     SETON                     4042
     C                     MOVE MSG,3     ERMSG
     C**
     C                     ELSE
     C**
     C**   For valid option write out LDA and linked enquiry data area
     C**   and call the program name obtained from SECOND
     C**
     C                     MOVE LSSESN    RQSESN
     C                     OUT  SESDS
     C***********          OUT  LDA                                       S01117
     C                     CALL TPGM
     C************LOCK     IN   LDA                                       S01117
     C           *LOCK     IN   SESDS
     C**
     C**   On return from lower level check return code
     C**
     C**   If 0 (Database Error) or 1 (F3 to return to menu)
     C**      then exit to calling program
     C**
     C           RTNC      IFEQ '0'
     C           RTNC      OREQ '1'
     C                     MOVE '1'       *IN01
     C                     END
     C**
     C**   If Return code is 7 (F9 to return to inital enquiry)
     C**      then check if this is the inital enquiry
     C**      and if not return to calling program
     C**
     C           RTNC      IFEQ '7'
     C           ORIG      ANDNEPGMNO
     C                     MOVE '1'       *IN01
     C                     END
     C**
     C                     END
     C**
     C**
     C                     ENDSR
     C*****************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CP13                                           S01408
     C*                                                                   S01408
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   RETSR  SR  End of Program Processing                       *
     C**              Write out LDA and linked enquiry data area      *
     C**              and return to the calling program               *
     C**                                                              *
     C**   Called by  MAIN, FIRST                                     *
     C**                                                              *
     C**   Calls  SR  none                                            *
     C**                                                              *
     C*****************************************************************
     C**
     C           RETSR     BEGSR                           *** RETSR   ***
     C**
     C                     OUT  SESDS
     C           *INU7     IFEQ '1'                                       S01117
     C**********           OUT  LDA                                       S01117
     C**
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**
     C                     SETON                     LR
     C**
     C                     RETRN
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**                                                              *
     C**   FIRST  SR  First Cycle Processing                          *
     C**                                                              *
     C**   Called by  MAIN                                            *
     C**                                                              *
     C**   Calls  SR  RETSR, SECIN, ZSYSTM                            *
     C**                                                              *
     C*****************************************************************
     C**
     C**
     C           FIRST     BEGSR                           ** FIRST **
     C**
     C**     Access the LDA  and  Linked Enquiry Data Area
     C**
     C************LOCK     IN   LDA
     C           *LOCK     IN   SESDS
      *                                                                                       232543
      ** Check if CGL032 is installed                                                         232543
      *                                                                                       232543
     C                     CALL 'AOSARDR0'                                                    232543
     C                     PARM *BLANKS   PRTCD                                               232543
     C                     PARM '*VERIFY' POPTN                                               232543
     C                     PARM 'CGL032'  PSARD                                               232543
      *                                                                                       232543
      ** DB Error Management.                                                                 232543
      *                                                                                       232543
     C           PRTCD     IFNE *BLANK                                                        232543
     C           PRTCD     ANDNE'*NRF   '                                                     232543
     C           *LOCK     IN   LDA                                                           232543
     C                     Z-ADD8         DBASE                                               232543
     C                     MOVEL'SCSARDPD'DBFILE                                              232543
     C                     MOVEL'CGL032'  DBKEY                                               232543
     C                     OUT  LDA                                                           232543
     C                     MOVE *ON       *INU7                                               232543
     C                     MOVE *ON       *INU8                                               232543
     C                     MOVE *ON       *INLR                                               232543
     C                     EXSR *PSSR                                                         232543
     C                     ENDIF                                                              232543
      *                                                                                       232543
     C           PRTCD     IFEQ *BLANK                                                        232543
     C                     MOVE 'Y'       CGL032  1                                           232543
     C                     MOVE *ON       *IN62                                               232543
     C                     ELSE                                                               232543
     C                     MOVE 'N'       CGL032                                              232543
     C                     MOVE *OFF      *IN62                                               232543
     C                     ENDIF                                                              232543
     C*
     C* If called from menu, do not output Option field on screen
     C* If called as a restricted linked enquiry supress Option field     S01220
     C* and set on indicator 80 for conditioned screen display.           S01220
     C*
     C           OPTFLG    COMP 'N'                      79
     C*                                                                   S01220
     C           ENQFLG    IFEQ 'Y'                                       S01220
     C                     SETON                     7980                 S01220
     C                     END                                            S01220
      *                                                                   065536
      ** Enable F6 option for Security Report name Enquiry if             065536
      ** this was not the original linked enquiry program.                065536
      *                                                                   065536
     C           ORIG      IFNE 'SE0240'                                  065536
     C                     MOVE '1'       *IN69                           065536
     C                     ELSE                                           065536
     C                     MOVE '0'       *IN69                           065536
     C                     END                                            065536
     C**
     C*******Access*the*ICD*record*1*for*run*date*&*date*format******     S01117
     C***********                                                         S01117
     C***********          EXSR ZSYSTM                                    S01117
     C***********                                                         S01117
     C**Error*in*ZSYSTM************************************************** S01117
     C***********                                                         S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********          MOVELPROGRM    DBPGM                           S01117
     C***********          MOVE *BLANKS   DBKEY            ************   S01117
     C***********          MOVEL'ICDR1'   DBKEY            * DATABASE *   S01117
     C***********          MOVE 'TABLE'   DBFILE           * ERROR 01 *   S01117
     C***********          Z-ADD01        DBASE            ************   S01117
     C***********          SETON                       U7U8               S01117
     C***********          MOVE '0'       RTNC                            S01117
     C***********          EXSR RETSR                                     S01117
     C***********          END                                            S01117
     C*                                                                   S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01117
     C*                                                                   S01117
     C           DATF      COMP 'M'                      98               S01117
     C**
     C**     If no security shortname found in request data
     C**        ensure first screen fields will be blank
     C**     else process via SECIN
     C**
     C**
     C           RQSESN    IFEQ *BLANKS
     C                     MOVE *BLANKS   SACTN
     C                     MOVE *BLANKS   SSESN
     C                     ELSE
     C                     MOVELRQSESN    SSESN
     C                     MOVE *BLANKS   RQSESN
     C                     EXSR SECIN
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0245CP14                                           S01408
     C*                                                                   S01408
     C**
     C**      Access program name - for help and linked enquiries
     C**
     C                     MOVELPROGRM    PGMNO   8
     C**
      ** Access Bank details                                                                  CSE065
     C                     CALL 'AOBANKR0'                                                    CSE065
     C                     PARM *BLANKS   PRTCD                                               CSE065
     C                     PARM '*FIRST ' POPTN                                               CSE065
     C           SDBANK    PARM SDBANK    DSSDY                                               CSE065
      *                                                                                       CSE065
     C           PRTCD     IFNE *BLANK                                                        CSE065
     C           *LOCK     IN   LDA                                                           CSE065
     C                     MOVEL'SDBANKPD'DBFILE                                              CSE065
     C                     MOVELPOPTN     DBKEY                                               CSE065
     C                     Z-ADD20        DBASE                                               CSE065
     C                     OUT  LDA                                                           CSE065
     C                     MOVE *ON       *INU7                                               CSE065
     C                     MOVE *ON       *INU8                                               CSE065
     C                     MOVE *ON       *INLR                                               CSE065
     C                     EXSR *PSSR                                                         CSE065
     C                     ENDIF                                                              CSE065
      *                                                                   S01401
      **  Access SAR details file to see if MT5xx Feature is installed.   S01401
      *                                                                   S01401
     C                     CALL 'AOSARDR0'                                S01401
     C                     PARM '       ' @RTCD                           S01401
     C                     PARM '*VERIFY' @OPTN                           S01401
     C                     PARM 'S01401'  WSARD   6                       S01401
      *                                                                   S01401
     C           @RTCD     IFEQ *BLANKS                                   S01401
     C                     SETON                     09                   S01401
     C                     END                                            S01401
      *                                                                   CSE005
      ** Access SAR details file to see if CSE005 Feature is installed.   CSE005
      *                                                                   CSE005
     C                     CALL 'AOSARDR0'                                CSE005
     C                     PARM '       ' @RTCD                           CSE005
     C                     PARM '*VERIFY' @OPTN                           CSE005
     C                     PARM 'CSE005'  WSARD   6                       CSE005
      *                                                                   CSE005
     C           @RTCD     IFEQ *BLANKS                                   CSE005
     C                     MOVE *ON       *IN08                           CSE005
     C                     ENDIF                                          CSE005
      *                                                                   CSE005
      **  Access SAR details file to see if CEU018 is installed.          CEU018
      *                                                                   CEU018
     C                     CALL 'AOSARDR0'                                CEU018
     C                     PARM '       ' @RTCD                           CEU018
     C                     PARM '*VERIFY' @OPTN                           CEU018
     C                     PARM 'CEU018'  WSARD   6                       CEU018
      *                                                                   CEU018
     C           @RTCD     IFEQ *BLANK                                    CEU018
     C                     MOVE 'Y'       CEU018  1                       CEU018
     C                     MOVE *ON       *IN84                           CEU018
     C                     ELSE                                           CEU018
     C                     MOVE 'N'       CEU018                          CEU018
     C                     ENDIF                                          CEU018
      *                                                                   CEU018
      **  Access SAR details file to see if MT5xx Feature is installed.   CEU017
      *                                                                   CEU017
     C                     CALL 'AOSARDR0'                                CEU017
     C                     PARM '       ' @RTCD                           CEU017
     C                     PARM '*VERIFY' @OPTN                           CEU017
     C                     PARM 'CEU017'  WSARD   6                       CEU017
      *                                                                   CEU017
     C                     SETOF                     07                   CEU017
     C           @RTCD     IFEQ *BLANKS                                   CEU017
     C                     SETON                     07                   CEU017
     C                     END                                            CEU017
      *                                                                   CPL002
      * Call access program to see if Midas Plato module is switched      CPL002
      * on                                                                CPL002
      *                                                                   CPL002
     C                     CALL 'AOMMODR0'                                CPL002
     C                     PARM '*DBERR'  #RTCD   7                       CPL002
     C                     PARM '*FIRST'  #OPTN   7                       CPL002
     C           SDMMOD    PARM SDMMOD    DSFDY                           CPL002
      *                                                                   CPL002
      * If Midas Plato module is present, switch on indicator 43.         CPL002
      *                                                                   CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C                     MOVE *ON       *IN43                           CPL002
     C                     ELSE                                           CPL002
     C                     MOVE *OFF      *IN43                           CPL002
     C                     ENDIF                                          CPL002
      *                                                                   CPB002
      * If Private Banking module is present, switch on indicator 45.     CPB002
      *                                                                   CPB002
     C           BGN4ST    IFEQ 'Y'                                       CPB002
     C                     MOVE *ON       *IN45                           CPB002
     C                     ELSE                                           CPB002
     C                     MOVE *OFF      *IN45                           CPB002
     C                     ENDIF                                          CPB002
      *                                                                   CSE031
      ** Check is CSE031 is installed                                     CSE031
      *                                                                   CSE031
     C                     CALL 'AOSARDR0'                                CSE031
     C                     PARM *BLANKS   PRTCD                           CSE031
     C                     PARM '*VERIFY' POPTN                           CSE031
     C                     PARM 'CSE031'  PSARD                           CSE031
      *                                                                   CSE031
     C           PRTCD     IFEQ *BLANK                                    CSE031
     C                     MOVE 'Y'       CSE031  1                       CSE031
     C                     ELSE                                           CSE031
     C                     MOVE 'N'       CSE031                          CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CEU017
     C/COPY WNCPYSRC,SE0245C002
      *                                                                   CSE010
      ** Check is CSE010 is installed                                     CSE010
      *                                                                   CSE010
     C                     MOVE 'N'       CSE010  1                       CSE010
     C                     CALL 'AOSARDR0'                                CSE010
     C                     PARM *BLANKS   PRTCD   7                       CSE010
     C                     PARM '*VERIFY' POPTN   7                       CSE010
     C                     PARM 'CSE010'  PSARD   6                       CSE010
      *                                                                   CSE010
     C           PRTCD     IFEQ *BLANK                                    CSE010
     C                     MOVE 'Y'       CSE010                          CSE010
     C                     ELSE                                           CSE010
      *                                                                   CSE010
      ** Database Error (return code other than *NRF)                     CSE010
      *                                                                   CSE010
     C           PRTCD     IFNE '*NRF   '                                 CSE010
     C           *LOCK     IN   LDA                                       CSE010
     C                     MOVEL'SCSARDPD'DBFILE           ************   CSE010
     C                     MOVEL'*VERIFY' DBKEY            * DBERR  7 *   CSE010
     C                     Z-ADD7         DBASE            ************   CSE010
     C                     OUT  LDA                                       CSE010
     C                     MOVE *ON       *INU7                           CSE010
     C                     MOVE *ON       *INU8                           CSE010
     C                     MOVE *ON       *INLR                           CSE010
     C                     EXSR *PSSR                                     CSE010
     C                     ENDIF                                          CSE010
     C                     ENDIF                                          CSE010
      *                                                                   CSE023
      ** Check is CSE023 is installed                                     CSE023
      *                                                                   CSE023
     C                     CALL 'AOSARDR0'                                CSE023
     C                     PARM *BLANKS   PRTCD                           CSE023
     C                     PARM '*VERIFY' POPTN                           CSE023
     C                     PARM 'CSE023'  PSARD                           CSE023
      *                                                                   CSE023
     C           PRTCD     IFEQ *BLANK                                    CSE023
     C                     MOVE *ON       *IN60                           CSE023
     C                     ELSE                                           CSE023
     C                     MOVE *OFF      *IN60                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                                       CSE037
      ** Check is CSE037 is installed                                                         CSE037
      *                                                                                       CSE037
     C                     CALL 'AOSARDR0'                                                    CSE037
     C                     PARM *BLANKS   PRTCD                                               CSE037
     C                     PARM '*VERIFY' POPTN                                               CSE037
     C                     PARM 'CSE037'  PSARD                                               CSE037
      *                                                                                       CSE037
     C           PRTCD     IFEQ *BLANK                                                        CSE037
     C                     MOVEL'Y'       CSE037  1                                           CSE037
     C                     MOVE *ON       *IN85                                               CSE037
     C                     ELSE                                                               CSE037
     C                     MOVEL'N'       CSE037                                              CSE037
     C                     MOVE *OFF      *IN85                                               CSE037
     C                     ENDIF                                                              CSE037
      *                                                                   S01401
      *                                                                   CGL018
      ** Access SAR Details File To Determine If CGL018 Is On.            CGL018
      *                                                                   CGL018
     C                     CALL 'AOSARDR0'                                CGL018
     C                     PARM *BLANKS   PRTCD                           CGL018
     C                     PARM '*VERIFY' POPTN                           CGL018
     C                     PARM 'CGL018'  PSARD                           CGL018
      *                                                                   CGL018
      ** Database Error                                                   CGL018
      *                                                                   CGL018
     C           PRTCD     IFNE *BLANKS                                   CGL018
     C           PRTCD     ANDNE'*NRF   '                                 CGL018
     C                     MOVEL'SCSARDPD'DBFILE                          CGL018
     C                     Z-ADD8         DBASE                           CGL018
     C                     MOVEL'CGL018'  DBKEY                           CGL018
     C                     EXSR *PSSR                                     CGL018
     C                     END                                            CGL018
      *                                                                   CGL018
     C           PRTCD     IFEQ *BLANK                                    CGL018
     C                     MOVE 'Y'       CGL018  1                       CGL018
     C                     ELSE                                           CGL018
     C                     MOVE 'N'       CGL018                          CGL018
     C                     ENDIF                                          CGL018
      *                                                                                       CER001
      ** ULX004 - API Luxembourg                                                              CER001
      *                                                                                       CER001
     C                     MOVEL'N'       ULX004  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX004'  PSARD                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFNE '*NRF   '                                                     CER001
     C           PRTCD     ANDNE*BLANKS                                                       CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVELPSARD     DBKEY                                               CER001
     C                     Z-ADD9         DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     MOVE *ON       *INU7                                               CER001
     C                     MOVE *ON       *INU8                                               CER001
     C                     MOVE *ON       *INLR                                               CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX004                                              CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX004                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** ULX043 - API Luxembourg                                                              CER001
      *                                                                                       CER001
     C                     MOVEL'N'       ULX043  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX043'  PSARD                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFNE '*NRF   '                                                     CER001
     C           PRTCD     ANDNE*BLANKS                                                       CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVELPSARD     DBKEY                                               CER001
     C                     Z-ADD10        DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     MOVE *ON       *INU7                                               CER001
     C                     MOVE *ON       *INU8                                               CER001
     C                     MOVE *ON       *INLR                                               CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CAS006
      ** Check is CAS006 is installed                                                         CAS006
      *                                                                                       CAS006
     C                     MOVE 'N'       CAS006  1                                           CAS006
     C                     CALL 'AOSARDR0'                                                    CAS006
     C                     PARM *BLANKS   PRTCD                                               CAS006
     C                     PARM '*VERIFY' POPTN                                               CAS006
     C                     PARM 'CAS006'  PSARD                                               CAS006
      *                                                                                       CAS006
     C           PRTCD     IFEQ *BLANK                                                        CAS006
     C                     MOVE 'Y'       CAS006                                              CAS006
     C                     ELSE                                                               CAS006
      *                                                                                       CAS006
      ** Database Error (return code other than *NRF)                                         CAS006
      *                                                                                       CAS006
     C           PRTCD     IFNE '*NRF   '                                                     CAS006
     C           *LOCK     IN   LDA                                                           CAS006
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS006
     C                     MOVEL'*VERIFY' DBKEY                                               CAS006
     C                     Z-ADD8         DBASE                                               CAS006
     C                     OUT  LDA                                                           CAS006
     C                     MOVE *ON       *INU7                                               CAS006
     C                     MOVE *ON       *INU8                                               CAS006
     C                     MOVE *ON       *INLR                                               CAS006
     C                     EXSR *PSSR                                                         CAS006
     C                     ENDIF                                                              CAS006
     C                     ENDIF                                                              CAS006
      **********                                                                       CGL032 232543
      ***Check*is CGL032 is installed                                                  CGL032 232543
      **********                                                                       CGL032 232543
     C**********           CALL 'AOSARDR0'                                             CGL032 232543
     C**********           PARM *BLANKS   PRTCD                                        CGL032 232543
     C**********           PARM '*VERIFY' POPTN                                        CGL032 232543
     C**********           PARM 'CGL032'  PSARD                                        CGL032 232543
      **********                                                                       CGL032 232543
      ***DB*Error Management.                                                          CGL032 232543
      **********                                                                       CGL032 232543
     C********** PRTCD     IFNE *BLANK                                                 CGL032 232543
     C********** PRTCD     ANDNE'*NRF   '                                              CGL032 232543
     C********** *LOCK     IN   LDA                                                    CGL032 232543
     C**********           Z-ADD9         DBASE            ************                CGL032 232543
     C**********           MOVEL'SCSARDPD'DBFILE           * DBERR  9 *                CGL032 232543
     C**********           MOVEL'CGL032'  DBKEY            ************                CGL032 232543
     C**********           OUT  LDA                                                    CGL032 232543
     C**********           MOVE *ON       *INU7                                        CGL032 232543
     C**********           MOVE *ON       *INU8                                        CGL032 232543
     C**********           MOVE *ON       *INLR                                        CGL032 232543
     C**********           EXSR *PSSR                                                  CGL032 232543
     C**********           ENDIF                                                       CGL032 232543
      **********                                                                       CGL032 232543
     C********** PRTCD     IFEQ *BLANK                                                 CGL032 232543
     C**********           MOVE 'Y'       CGL032  1                                    CGL032 232543
     C**********           MOVE *ON       *IN62                                        CGL032 232543
     C**********           ELSE                                                        CGL032 232543
     C**********           MOVE 'N'       CGL032                                       CGL032 232543
     C**********           MOVE *OFF      *IN62                                        CGL032 232543
     C**********           ENDIF                                                       CGL032 232543
      *                                                                                       CSE065
      ** Access SAR details file to see if CSE065 is installed.                               CSE065
      *                                                                                       CSE065
     C                     MOVE 'N'       CSE065  1                                           CSE065
     C                     MOVE *OFF      *IN65                                               CSE065
     C                     CALL 'AOSARDR0'                                                    CSE065
     C                     PARM *BLANKS   PRTCD                                               CSE065
     C                     PARM '*VERIFY' POPTN                                               CSE065
     C                     PARM 'CSE065'  PSARD                                               CSE065
     C           SCSARD    PARM SCSARD    DSFDY                                               CSE065
      *                                                                                       CSE065
     C           PRTCD     IFEQ *BLANK                                                        CSE065
     C                     MOVE 'Y'       CSE065                                              CSE065
     C                     MOVE *ON       *IN65                                               CSE065
     C                     ELSE                                                               CSE065
      *                                                                                       CSE065
      ** Database Error (return code other than *NRF)                                         CSE065
      *                                                                                       CSE065
     C           PRTCD     IFNE '*NRF   '                                                     CSE065
     C           *LOCK     IN   LDA                                                           CSE065
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE065
     C                     MOVEL'*VERIFY' DBKEY                                               CSE065
     C                     Z-ADD10        DBASE                                               CSE065
     C                     OUT  LDA                                                           CSE065
     C                     MOVE *ON       *INU7                                               CSE065
     C                     MOVE *ON       *INU8                                               CSE065
     C                     MOVE *ON       *INLR                                               CSE065
     C                     EXSR *PSSR                                                         CSE065
     C                     ENDIF                                                              CSE065
     C                     ENDIF                                                              CSE065
      *                                                                   CGL018
     C                     MOVE 'N'       CSE075  1                                           CSE075
     C                     MOVE '0'       *IN75                                               CSE075
     C                     MOVE '0'       *IN76                                               CSE075
     C                     CALL 'AOSARDR0'                                                    CSE075
     C                     PARM *BLANKS   PRTCD                                               CSE075
     C                     PARM '*VERIFY' POPTN                                               CSE075
     C                     PARM 'CSE075'  PSARD                                               CSE075
     C           SCSARD    PARM SCSARD    DSFDY                                               CSE075
      *                                                                                       CSE075
     C           PRTCD     IFEQ *BLANK                                                        CSE075
     C                     MOVE 'Y'       CSE075                                              CSE075
     C                     ELSE                                                               CSE075
      *                                                                                       CSE075
      ** Database Error (return code other than *NRF)                                         CSE075
      *                                                                                       CSE075
     C           PRTCD     IFNE '*NRF   '                                                     CSE075
     C           *LOCK     IN   LDA                                                           CSE075
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE075
     C                     MOVEL'*VERIFY' DBKEY                                               CSE075
     C                     Z-ADD21        DBASE                                               CSE075
     C                     OUT  LDA                                                           CSE075
     C                     MOVE *ON       *INU7                                               CSE075
     C                     MOVE *ON       *INU8                                               CSE075
     C                     MOVE *ON       *INLR                                               CSE075
     C                     EXSR *PSSR                                                         CSE075
     C                     ENDIF                                                              CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
     C                     ENDSR
     C**
      *****************************************************************   S01117
      /EJECT                                                              S01117
      *****************************************************************   S01117
      *                                                               *   S01117
      *  *PSSR  - Error control subroutine                            *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
      *                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C**                                                                  S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
     C*****************************************************************
     C/COPY WNCPYSRC,SE0245C008
      /EJECT                                                              CSE005
     C/COPY ZSRSRC,ZNCDZ3                                                 CSE005
      /EJECT                                                              CSE005
     C/COPY ZSRSRC,ZDATE1Z2                                               CSE005
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
     C/COPY ZSRSRC,ZEDITZ2                                                E23272
      /EJECT
     C***/COPY*ZSRSRC,ZSDESCZ3***                                  S01158 E15611
     C/COPY ZSRSRC,ZSEDITZ3
     C*/EJECT******************                                           S01117
     C*/COPY*ZSRSRC,ZSYSTMZ1***                                           S01117
      ***
      /EJECT
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   MSG  - ERROR MESSAGES
INVALID ENTRY - BOTH SECURITY SHORTNAME AND OPTION ENTERED
ENTER A SECURITY SHORTNAME OR AN OPTION
INVALID OPTION - SELECT OPTION 1 FOR FORWARD DIARY ENQUIRY
THIS IS THE INITIAL ENQUIRY - F/3 WILL EXIT TO MENU
INVALID SECURITY SHORTNAME - PLEASE REENTER OR TAKE F/6
ENTER A SECURITY SHORTNAME OR TAKE F/6 FOR SECURITY SHORTNAME ENQUIRY
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                       #DATE
0366073110961461                                                           #DATE
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                         #DATE
000031059090120151181212243273304334365                                    #DATE
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
