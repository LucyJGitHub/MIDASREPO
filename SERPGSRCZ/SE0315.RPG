     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Securities audit list')                       *
      *****************************************************************
      *                                                               *
      *  Midas - Securities Trading Module
      *                                                               *
      *  SE0315 - SECURITIES AUDIT LIST                               *
      *                                                               *
      *  Function:  This program produces a report, for audit         *
      *   (I/C)     purposes, of all securities defined to the        *
      *   (COB)     system.  The sequence of the report is security   *
      *             shortname.                                        *
      *                                                               *
      *  Called By: 1) SEC0301 - Audit Reports - Input Cycle          *
      *             2) SEC0601 - Audit Reports - Close of Business    *
      *             3) SEC0302 - Full Lists - On Request              *
      *                                                               *
      *             Frequency:                                        *
      *             The report is available in 3 modes (I,A,L):       *
      *             1) On request during I/C; an interim report       *
      *                showing the latest status of securities        *
      *                inserted, amended or deleted during the day.   *
      *             2) During COB; a report of all securities         *
      *                inserted, amended or deleted during the day.   *
      *             3) On request; a report of all live securities    *
      *                in the system (ie. deleted items are not       *
      *                included).                                     *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CRE073             Date 06Dec10               *
      *  Prev Amend No. 262535             Date 05Nov09               *
      *                 CER059             Date 19Jul10               *
      *                 BUG22324           Date 20Jan09               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSE075             Date 06Mar06               *
      *                 BUG9427            Date 12Dec05               *
      *                 CGL032             Date 05Jul04               *
      *                 CER001             Date 25Apr05               *
      *                 CSE075             Date 17Nov05               *
      *                 CSE065             Date 08Nov04               *
      *                 CSE071             Date 19Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL014             Date 20Oct03               *
      *                 CLE025             Date 20Oct03               *
      *                 208241             Date 21Aug02               *
      *                 CSE037             Date 29Apr02               *
      *                 CAS006             Date 21Jan03               *
      *                 CGL018             Date 30Sep02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSE031             Date 09Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 192054             Date 26Jun01               *
      *                 127566             Date 09May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 14May01               *
      *                 CAP060             Date 14May01               *
      *                 176444             Date 28Feb01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP137             Date 07Feb00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 10Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPL002             Date 02Mar99               *
      *                 CEU017             DATE 29APR98               *
      *                 CEU018             DATE 14APR98               *
      *                 CSE005             DATE 10DEC96               *
      *                 104938             DATE 26FEB97               *
      *                 S01408             DATE 12SEP96               *
      *                 S01408             DATE 23AUG96               *
      *                 S01408             DATE 27JUN96               *
      *                 076245             DATE 03MAY96               *
      *                 S01408             DATE 11DEC95               *
      *                 084256             DATE 06SEP95               *
      *                 S01408             DATE 11SEP95               *
      *                 S01496             DATE 13JUL94               *
      *                 S01447             DATE 25OCT93               *
      *                 052254             DATE 10JAN94               *
      *                 054500             DATE 14SEP93               *
      *                 S01401             DATE 16JUN93               *
      *                 045915             DATE 15OCT92               *
      *                 S01397             DATE 10SEP92               *
      *                 E36201             DATE 20FEB92               *
      *                 E29170             DATE 08NOV91               *
      *                 E28705             DATE 24SEP91               *
      *                 S01220             DATE 12NOV90               *
      *                 S01117             DATE 30OCT90               *
      *                 S01269             DATE 18OCT90               *
      *                 E21070             DATE 13FEB90               *
      *                 E17822             DATE 10/04/89              *
      *                 E17202             DATE 10/04/89              *
      *                 S01176             DATE 11/11/88              *
      *                 E15237             DATE 17/09/88              *
      *                 E13622             DATE 07/06/88              *
      *                 S01158             DATE 27/05/88              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CRE073 - Interest Rate Rounding                              *
      *  262535 - Overlapping of Replacement Sec. and Nominal Currency*
      *           Add SPACEA(1) either *IN85 or *IN88 is ON or both.  *
      *           Recompile due to changes in SE0315P1.               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *BUG22324 - Alphanumeric Local Industry code not included in    *
      *           the report                                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSE075 - CSE075 Change Control. Display Coupon Delay period  *
      *           for all interest-bearing securities.                *
      *  BUG9427- Credit Risk and Liquity Premium field introduced by *
      *           IAS not included in the report.                     *
      *  CGL032 - Automatic Exchange of Information                   *
      *  CER001 - Lux Upgrade to MidasPlus                            *
      *  CSE075 - US Enhanced Treasury Upgrade to MidasPlus           *
      *  CSE065 - Cost Yield Amort. on Mortgage Backed Assets         *
      *  CSE071 - Multiple Holidays Re Securities                     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL014 - Collaterals Processing                              *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
      *  CSE037 - Countervalue rounding                               *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CGL018 - Risk Weighted Assets                                *
      *  CSE031 - Coupon Fixing for Floating Rate Notes.              *
      *  192054 - If private banking module is on, the ISIN number    *
      *           must be printed. SE0315P1 Changes                   *
      *  127566 - Recompiled over changed ZSDESCZ3                    *
      *  CSD006 - Market Data Feed                                    *
      *  CAP060 - Midas APIs. Security Prices Full API                *
      *  176444 - Printer Overflow - Recompiled over changed in       *
      *           Printer File.                                       *
      *  CSE023 - Treaty Withholding Tax                              *
      *  CAP137 - Conversion of SE Security inputs into modular       *
      *           structure to use as APIs.                           *
      *  CPB001 - 'Private Banking' Module                            *
      *  CPL002 - Midas - Plato Interface                             *
      *  CEU017 - Securities Redenomination Euro Changes              *
      *  CEU018 - Securities - Decimals on Nominal Amount             *
      *  CSE005 - Effect of holidays on FRN Coupon Dates.             *
      *  104938 - Fields Underwritten, Allocation requested, and      *
      *           Allocation received should be non-decimal numbers   *
      *  S01408 - Addition core hook SE0315OOP2.                      *
      *  S01408 - Addition core hook SE0315CP13.                      *
      *         - Addition core hook SE0315CP12.                      *
      *         - Addition core hook SE0315CP11.                      *
      *         - Addition core hook SE0315CP10.                      *
      *         - Addition core hook SE0315CCP9.                      *
      *  S01408 - Addition core hook SE0315CCP8.                      *
      *           Addition core hook SE0315EEP1.                      *
      *           Addition core hook SE0315OOP1.                      *
      *  076245 - When longterm Maturity Ind. is 'Y', calculation of  *
      *           the Maturity Date wrong.                            *
      *  S01408 - Addition core hook SE0315CCP6.                      *
      *           Addition core hook SE0315CCP7.                      *
      *  084256 - Tax rate change should be switchable                *
      *  S01408 - Addition core hook SE0315CCP1.                      *
      *           Addition core hook SE0315CCP2.                      *
      *           Addition core hook SE0315CCP3.                      *
      *           Addition core hook SE0315CCP4.                      *
      *           Addition core hook SE0315CCP5.                      *
      *           Addition core hook SE0315FFP1.                      *
      *           Addition core hook SE0315IIP1.                      *
      *  S01496 - Field Rate of Tax deducted at source will pass      *
      *           from 6 to 7.                                        *
      *  S01447 - WITTHOLDING TAX (SE).                               *
      *           Amended to print the Withholding Tax details about  *
      *           a security if it has them, and the Withholding Tax  *
      *           feature is switched on.                             *
      *  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
      *           to 10,9                                             *
      *  054500 - Issue amount should not be edited with decimal      *
      *           places.                                             *
      *  S01401 - Produce SWIFT Messages MT5xxs, if option available. *
      *           Show new fields in report.                          *
      *  045915 - Recompiled over changed Print File. (Fix to S01397  *
      *           for Overflow Error).                                *
      *  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
      *          - New fields on files to be reported.                *
      *  E36201 - Trying to write to closed printer file              *
      *  E29170 - Recompiled over changed PRTF for RCF changes        *
      *  E28705 - Recompiled over changed PRTF                        *
      *  S01220 - Amended for Strategic Risk Management Release 2     *
      *           to show Roll Forward Dividend Indicator on report   *
      *           when the processing type is 4.                      *
      *  S01117 - MULTIBRANCHING                                      *   S01117
      *  S01269 - Trade authorisation: recompiled for change to       *
      *           file TABSE                                          *
      *  E21070 - Add Legend for Day Basis 5.                         *   E21070
      *           Also rename field ZLCD to WLCD as ZLCD is now the   *   E21070
      *           name of a Standard Subroutine.                      *   E21070
      *  E17822 - TRADE DENOMINATION SHOULD NOT BE EDITED WITH        *   E17822
      *           DECIMAL PLACES.                                     *   E17822
      *  E17202 - DETAILS NOT PRINTED FOR DAY BASIS = 6               *   E17202
      *  S01176 - SEC. TRAD. 3.1                                      *   S01176
      *  E15237 - TRADE DENOMINATION, NEXT DIVIDEND, ISSUE AMOUNT,    *   E15237
      *           TOTAL UNDERWRITTEN, ALLOCATION REQUESTED AND        *   E15237
      *           ALLOCATION RECEIVED ARE BEING OUTPUT TO REPORT      *   E15237
      *           SE0315P1 WITH NO DECIMAL PLACES.                    *   E15237
      *  E13622 - EXCLUDE 'C' RECORDS FROM LIVE RECORD COUNT & REDUCE *   E13622
      *           NUMBER OF RECORDS FIELDS ON AUDIT FILE BY NUMBER OF *   E13622
      *           SECURITIES CANCELLED TODAY                          *   E13622
      *  S01158 - POST INCORPORATION DEVELOPMENT FIX                  *   S01158
      *                                                               *
      *****************************************************************
      *
     FSECTYLCDIF  E           K        DISK                           UC
     FSECTY   IF  E           K        DISK                           UC
     F            SECTYDF                           KRENAMESECTYDFX
     F*                                                                   S01408
     F/COPY WNCPYSRC,SE0315FFP1                                           S01408
     F*                                                                   S01408
     FSESDX3L0IF  E           K        DISK                                                   CER001
     FSESDX2L0IF  E           K        DISK                                                   CER001
     FSESDX1L0IF  E           K        DISK                           UC                      CER001
      *Issuer Type Index file          Retrieval index        Prefix VV                       CER001
      *                                                                                       CER001
     FILICDRPDIF  E                    DISK                           UC                      CER001
      *IBLC installation control       Retrieval index        Prefix IC                       CER001
      *                                                                                       CER001
     FSESWHTL0IF  E           K        DISK                               S01447
     F*TABSE***IF**E***        K        DISK                              S01117
     F*********** TABLETAF                          KIGNORE               S01117
     F*********** TABTB10F                          KIGNORE               S01117
     F*********** TABTB11F                          KIGNORE               S01117
     F*********** TABTB40F                          KIGNORE               S01117
     F*********** TABTE10F                          KIGNORE               S01117
     F*********** TABTE20F                          KIGNORE               S01117
     F*********** TABTG20F                          KIGNORE               S01117
     F*********** TABLETHF                          KIGNORE               S01117
     F*********** TABLETJF                          KIGNORE               S01117
     F*********** TABLETKF                          KIGNORE               S01117
     F*********** TABLETLF                          KIGNORE               S01117
     F*********** TABLETPF                          KIGNORE               S01117
     F*********** TABLETRF                          KIGNORE               S01117
     F*********** TABLETXF                          KIGNORE               S01117
     F*********** TABLET2F                          KIGNORE               S01117
     F*********** TABLET3F                          KIGNORE               S01117
     F*********** TABLET5F                          KIGNORE               S01117
     F*CLINT***IF**E***        K        DISK                              S01117
     F*********** CLINTCAF                          KIGNORE               S01117
     F*********** CLINTCCF                          KIGNORE               S01117
     F*********** CLINTC1F                          KIGNORE               S01117
     F*********** CLINTSEF                          KIGNORE               S01117
     FINVTP   IF  E           K        DISK
     FSECTYA  UF  E           K        DISK
     F*                                                                   CGL018
     FSESRWAL0IF  E           K        DISK                               CGL018
      * RTW: Securities Risk Weigted Assets Code/Set                      CGL018
      *                                                                   CGL018
     FSE0315P1O   E                    PRINTER                        UC
     F                                              KINFDS SPOOL          S01117
     FSE0315AUO   E                    PRINTER
     F                                              KINFDS SPOOLU         S01117
     F*
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   36       'NO DETAILS TO REPORT'                             *   S01117
     F*   40       INPUT PARAMETER IS I (INPUT CYCLE MODE)            *
     F*   41       INPUT PARAMETER IS A (AUDIT MODE)                  *
     F*   42       INPUT PARAMETER IS L (FULL LIST MODE)              *
     F*   43       CGL018 IS ON                                       *   CGL018
     F*   50       END OF INPUT FILE / FILE READ ERROR                *
     F*   51-53    PRINT AMD/INS/DEL LEGEND                           *
     F*   54       PRINT 'DIFFERENCE' LEGEND                          *
     F*   55       DETAIL REPORT OPEN                                 *
     F*   56       CLINTCB RECORD MISSING                             *
     F*   57       TABLETN RECORD MISSING                             *
     F*   58       INVTPD RECORD MISSING                              *
     F****60-64****DAY BASIS LEGEND                                   *   E21070
     F*   59-64    DAY BASIS LEGEND                                   *   E21070
     F*   65-68    DIVISOR BASIS LEGEND                               *
     F*   69       TABTG10 DATABASE ERROR                             *
     F*   70       AUSTRALIAN YIELD METHOD                            *   S01397
     F*   71       READ ERROR FOR SESWHTL0                            *   S01447
      *   72       ULX046 enhancement                                 *                       CER001
      *   73       On if ULX004 is ON                                 *                       CER001
     F*   75       PROCESSING TYPE = 4                                *   S01220
     F*   76       MT5xx SWITCHABLE FEATURES PRESENT - S01401         *   S01401
     F*   77       SWITCHABLE FEATURE PRESENT - S01447                *   S01447
     F*   78       Private Banking Securities Trading Enhancements on *   084256
     F*   79       CSE005 Switchable feature present                  *   CSE005
     F*   80       Processing type (PROT) = 3.                        *   CSE005
     F*   81       Switchable feature present - CSE031                *   CSE031
     F*   82       Switchable feature present - CSD006                *   CSD006
     F*   83       Switchable feature present - CAP060                *   CAP060
     F*   84       Switchable feature present - CEU018                *   CEU018
     F*   85       Switchable feature present - CEU017                *   CEU017
     F*   86       Switchable feature present - CSE023                *   CSD006
     F*   87       Third line of full name present                    *   CSD006
     F*   88       Switchable feature present - CSE065                *                       CSE065
      *   88       Switchable feature present - CGL032                *                       CGL032
     F*   89       Plato Interface Module turned on                   *   CPL002
     F*   90-99    USED IN STANDARD SUB-ROUTINES                      *
     F*   U7       DATABASE ERROR                                     *
     F*   U8       DATABASE / CONTROL ERROR                           *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F*****************************************************************
     F*                                                               *
     F* SUBROUTINE INDEX :-                                           *
     F*                                                               *
     F*   DBERR  - DATABASE ERROR CONTROL                             *   S01117
     F*   RCFAU  - RCF PROCESSING FOR AUDIT REPORT                    *   S01117
     F*   RCFP1  - RCF PROCESSING FOR P1 REPORT                       *   S01117
     F*   *PSSR  - ERROR HANDLING                                     *   S01117
     F****ZSYSTM*-*ACCESS*ICD*RECORD**************************************S01117
     F****ZICDSE*-*ACCESS*ICD*RECORD*FROM*TABTB36**********************   S01117
     F*   ZDATE2 - DAYNO - DATE CONVERSION                            *
     F*   ZSDESC - FORMAT SECURITY DESCRIPTIONS                       *
     F*   ZSEDIT - EDIT NUMERIC FLDS                                  *
     F*   PRTADT - PROCESS_TAX_DETAILS                                *   S01447
     F*                                                               *
     F*****************************************************************
     F/EJECT
     E*                                                                   S01408
     E/COPY WNCPYSRC,SE0315EEP1                                           S01408
     E                    @WNFLD  1   5 19                                                    CSE075
     E*                                                                   S01408
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZSDESCZ1
     E/COPY ZSRSRC,ZSEDITZ1
     E**********          SDC         3  6 0             SDC1-3 ARRAY FOR INPUT               CSD027
     E                    SDC         3  6               SDC1-3 ARRAY FOR INPUT               CSD027
     E                    ZCSN        3 10               CSNM ARRAY FOR OUTPUT
     E                    CD         12  4 0             DIV/COUP DATE DDMM/MMDD
     E                    Z5CD       12  5               DIV/COUP DATE OUT DDMMM
     E*                                                                   CSE005
     E* Include Coupon Rate Indicators array for ZNCD subroutine          CSE005
     E*                                                                   CSE005
     E                    CR         12  1                                CSE005
     E                    XRWA       90  5               Work Array       CGL018
     E*                                                                   CSE005
      /EJECT
     E/COPY WNCPYSRC,SE0315E001
      *                                                                                       CSE037
      ** Data structure for INVTP to rename NDEC                                              CSE037
     IINVTPDF                                                                                 CSE037
     I              NDEC                            INDEC                                     CSE037
      *                                                                                       CSE037
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*DA********UDS                            256                       S01117
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 177 DBASE                 S01117
     ILDA         DS                            256                       S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01496
     I** Data structure to format ZSEDIT output                           S01496
     IWW21FM      DS                                                      S01496
     I                                        1  21 WWFL21                S01496
     I                                        1  20 WW20CH                S01496
     I                                        1  18 WW18CH                084256
     I                                       21  21 WWSIGN                S01496
     I*                                                                   S01117
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I              BJURPT                          TITL                  S01117
     I*                                                                   CPL002
      *  Data structure for SDMMOD access object                          CPL002
     ISDMMOD    E DSSDMMODPD                                              CPL002
      *                                                                   CPL002
     I*                                                                   S01117
     I**  EXTERNAL DS FOR SECURITIES TRADING DETAILS                      S01117
     ISDSTRD    E DSSDSTRDPD                                              S01117
     I*                                                                   S01117
     I**  EXTERNAL DS FOR SD CUSTOMER DETAILS                             S01117
     ISDCUST    E DSSDCUSTPD                                              S01117
     I*                                                                   S01117
     I**  EXTERNAL DS FOR SD CURRENCY DETAILS                             S01117
     ISDCURR    E DSSDCURRPD                                              S01117
     I*                                                                   S01117
     I** LOCAL INDUSTRY CODES                                             S01117
     I*                                                                   S01117
     ISDINDS    E DSSDINDSPD                                              S01117
     I*                                                                   084256
     ISCSARD    E DSSCSARDPD                                              084256
     I** EXTERNAL DS FOR SWITCHABLE FEATURES                              084256
     I*                                                                   S01117
      * Datastructure to output RWA details                               CGL018
      *                                                                   CGL018
     IRWSECO      DS                          1   5                       CGL018
     I                                        1   2 #RCODE                CGL018
     I I            ' '                       3   3 #BLANK                CGL018
     I                                        4   4 #RSET                 CGL018
     I I            ','                       5   5 #COMMA                CGL018
      *                                                                   CGL018
     I**  DATA STRUCTURE FOR RUN DATE DETAILS                             S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*  DS FOR LINE NO. TO HANDLE OVERFLOW                               S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA STRUCTURE FOR ACCESS OBJECTS, SHORT DATA STRUCTURE          S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I**                                                                  S01117
     I** LONG STRUCTURE FOR ACCESS OBJECTS, LONG DATA STRUCTURE           S01117
     IDSSDY     E DSDSSDY                                                 S01117
     I**                                                                  S01117
     I*
     I           SDS
     I                                      244 246 WSID
     I                                      254 263 USID
     I*
     I* Include ZNCDZ2 for call to ZNCD                                   CSE005
     I*                                                                   CSE005
     I/COPY ZSRSRC,ZNCDZ2                                                 CSE005
     I*                                                                   CSE005
     I/COPY ZSRSRC,ZSDESCZ2
     I/COPY ZSRSRC,ZSEDITZ2
     ISDCDS       DS
     I**********                              1   60SDC1                                      CSD027
     I**********                              7  120SDC2                                      CSD027
     I**********                             13  180SDC3                                      CSD027
     I**********                              1  180SDC                                       CSD027
     I                                        1   6 SDC1                                      CSD027
     I                                        7  12 SDC2                                      CSD027
     I                                       13  18 SDC3                                      CSD027
     I                                        1  18 SDC                                       CSD027
     I*
     IZCSNDS      DS
     I                                        1  10 ZCSN1
     I                                       11  20 ZCSN2
     I                                       21  30 ZCSN3
     I                                        1  30 ZCSN
     I*
     I*CDDS********DS                                                     CSE005
     I*********                               1   40CD01                  CSE005
     I*********                               5   80CD02                  CSE005
     I*********                               9  120CD03                  CSE005
     I*********                              13  160CD04                  CSE005
     I*********                              17  200CD05                  CSE005
     I*********                              21  240CD06                  CSE005
     I*********                              25  280CD07                  CSE005
     I*********                              29  320CD08                  CSE005
     I*********                              33  360CD09                  CSE005
     I*********                              37  400CD10                  CSE005
     I*********                              41  440CD11                  CSE005
     I*********                              45  480CD12                  CSE005
     I*********                               1  480CD                    CSE005
     IZ5CDDS      DS
     I                                        1   5 Z5CD01
     I                                        6  10 Z5CD02
     I                                       11  15 Z5CD03
     I                                       16  20 Z5CD04
     I                                       21  25 Z5CD05
     I                                       26  30 Z5CD06
     I                                       31  35 Z5CD07
     I                                       36  40 Z5CD08
     I                                       41  45 Z5CD09
     I                                       46  50 Z5CD10
     I                                       51  55 Z5CD11
     I                                       56  60 Z5CD12
     I                                        1  60 Z5CD
     I*
     I            DS
     I                                        1  12 TNKEY
     I                                        1   2 TNRECT
     I                                        3   9 TNZZ7
     I                                       10  12 TNSIDY
     I*
     I*********** DS                                                      S01117
     I***********                             1  12 TKEY                  S01117
     I***********                             1   2 TRECT                 S01117
     I***********                             3   8 TZZ6                  S01117
     I***********                             9  11 TFECY                 S01117
     I***********                            12  12 TSREC                 S01117
     I*                                                                   S01408
     I/COPY WNCPYSRC,SE0315IIP1                                           S01408
     I*                                                                   S01408
      *                                                                                       CSE075
      ** First Extra Detail Line                                                              CSE075
      *                                                                                       CSE075
     IXRWNFF      DS                                                                          CSE075
     I                                        1  13 XR@WN1                                    CSE075
     I                                       14  17 FILL1                                     CSE075
     I                                       18  24 ZESALD                                    CSE075
     I                                       25  31 FILL2                                     CSE075
     I                                       32  50 XR@WN2                                    CSE075
     I                                       51  53 FILL3                                     CSE075
     I                                       54  62 ZESRPR                                    CSE075
     I                                       63  66 FILL4                                     CSE075
     I                                       67  71 XR@WN3                                    CSE075
     I                                       72  73 FILL5                                     CSE075
     I                                       74  77 ZESDLY                                    CSE075
     I                                       78 131 FILL6                                     CSE075
      *                                                                                       CSE075
      ** Second Extra Detail Line                                                             CSE075
      *                                                                                       CSE075
     IXRWNF1      DS                                                                          CSE075
     I                                        1  14 XR@WN4                                    CSE075
     I                                       15  16 FILL7                                     CSE075
     I                                       17  25 ZESWAC                                    CSE075
     I                                       26  31 FILL8                                     CSE075
     I                                       32  47 XR@WN5                                    CSE075
     I                                       48  53 FILL9                                     CSE075
     I                                       54  62 ZESWAM                                    CSE075
     I                                       63 131 FILL10                                    CSE075
      *                                                                                       CSE075
     IZ@DATA      DS                                                                          CSE065
     I                                        1   5 Z@DADM                                    CSE065
     I                                        6   7 Z@DAYR                                    CSE065
     IZ@DAT8      DS                                                                          CSE065
     I                                        1   4 Z@D8YR                                    CSE065
     I                                        1   6 Z@D8MO                                    CSE065
     I                                        7   8 Z@D8DY                                    CSE065
     ID@DATE      DS                                                                          CSE065
     I                                        1   5 D@DYMO                                    CSE065
     I                                        6   9 D@DDYR                                    CSE065
      *                                                                                       CSE065
      /EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
     C* DEFINE KEYLIST FOR CHAINING TO TABSE FILE-TABLETN
     C*
     C           TABTNK    KLIST
     C                     KFLD           TNKEY
      *
      * DEFINE KEYLIST FOR CHAINING TO INVTPD FILE
      *
     C           INVTPK    KLIST
     C                     KFLD           NMCY
     C                     KFLD           SITP
     C*****************************************************************   S01117
     C**DEFINE*KEYLIST*FOR*CHAINING*TO*CLINT*FILE**********************   S01117
     C***********                                                         S01117
     C***********CLINTK    KLIST                                          S01117
     C***********          KFLD           CBNUM   60                      S01117
     C***********          KFLD           CBRCDT  1                       S01117
     C***********                                                         S01117
     C**DEFINE*KEYLIST*FOR*CHAINING*TO*TABSE*FILE-TABTG10**************   S01117
     C***********                                                         S01117
     C***********TABTK     KLIST                                          S01117
     C***********          KFLD           TKEY                            S01117
      *
      * PREPARE LDA
      *
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'SE0315'  DBPGM
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C** REGISTER SPOOL ENTRY FOR AU                                      S01117
     C                     EXSR RCFAU                                     S01117
     C**                                                                  S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C** CHECK SYSTEM FORMAT DATE, DDMMYY OR MMDDYY(98 ON)                S01117
     C           DATF      IFEQ 'M'                                       S01117
     C                     SETON                     98                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     98                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
      *
      * INPUT PARAMETER :
      *
     C           *ENTRY    PLIST
     C                     PARM           MODE    1
     C                     PARM           SEQ     5                       S01117
      *
      * DEFINE WORK FIELDS
      *
     C************LIKE*****DEFN LCD       ZLCD                            E21070
     C           *LIKE     DEFN LCD       WLCD                            E21070
     C           *LIKE     DEFN CHTP      ZCHTP
     C           *LIKE     DEFN TNLU      ZTNLU
     C           *LIKE     DEFN SINS      ZINS
     C           *LIKE     DEFN SAMD      ZAMD
     C           *LIKE     DEFN SDEL      ZDEL
      *                                                                   S01401
      **  Access SAR details file to see if MT5xx SAR is installed.       S01401
      *                                                                   S01401
     C                     CALL 'AOSARDR0'                                S01401
     C                     PARM '       ' @RTCD                           S01401
     C                     PARM '*VERIFY' @OPTN                           S01401
     C                     PARM 'S01401'  WSARD   6                       S01401
     C           SCSARD    PARM SCSARD    DSFDY                           084256
      *                                                                   S01401
     C           @RTCD     IFEQ *BLANK                                    S01401
     C                     SETON                     76                   S01401
     C                     END                                            S01401
      *                                                                   S01401
      **  Access SAR details file to see if CSE005 SAR is installed.      CSE005
      *                                                                   CSE005
     C                     CALL 'AOSARDR0'                                CSE005
     C                     PARM '       ' @RTCD                           CSE005
     C                     PARM '*VERIFY' @OPTN                           CSE005
     C                     PARM 'CSE005'  WSARD   6                       CSE005
     C           SCSARD    PARM SCSARD    DSFDY                           CSE005
      *                                                                   CSE005
     C           @RTCD     IFEQ *BLANK                                    CSE005
     C                     MOVE *ON       *IN79                           CSE005
     C                     ENDIF                                          CSE005
      *                                                                   CSE005
      **  Access SAR details file to see if CEU018 is installed.          CEU018
      *                                                                   CEU018
     C                     CALL 'AOSARDR0'                                CEU018
     C                     PARM '       ' @RTCD                           CEU018
     C                     PARM '*VERIFY' @OPTN                           CEU018
     C                     PARM 'CEU018'  WSARD   6                       CEU018
      *                                                                   CEU018
     C           @RTCD     IFEQ *BLANK                                    CEU018
     C                     MOVE 'Y'       CEU018  1                       CEU018
     C                     MOVE *ON       *IN84                           CEU018
     C                     ELSE                                           CEU018
     C                     MOVE 'N'       CEU018                          CEU018
     C                     ENDIF                                          CEU018
      *                                                                   CEU018
      **  Access SAR details file to see if CEU017 is installed.          CEU017
      *                                                                   CEU017
     C                     CALL 'AOSARDR0'                                CEU017
     C                     PARM '       ' @RTCD                           CEU017
     C                     PARM '*VERIFY' @OPTN                           CEU017
     C                     PARM 'CEU017'  WSARD   6                       CEU017
      *                                                                   CEU017
     C           @RTCD     IFEQ *BLANK                                    CEU017
     C                     MOVE 'Y'       CEU017  1                       CEU017
     C                     MOVE *ON       *IN85                           CEU017
     C                     ELSE                                           CEU017
     C                     MOVE 'N'       CEU017                          CEU017
     C                     ENDIF                                          CEU017
      *                                                                   CSE023
      **  Access SAR details file to determine if CSE023 is switched ON.  CSE023
      *                                                                   CSE023
     C                     CALL 'AOSARDR0'                                CSE023
     C                     PARM '*BLANKS' @RTCD                           CSE023
     C                     PARM '*VERIFY' @OPTN                           CSE023
     C                     PARM 'CSE023'  WSARD                           CSE023
     C           SCSARD    PARM SCSARD    DSFDY                           CSE023
      *                                                                   CSE023
      ** Database error if return code is not blank and not *NRF.         CSE023
      *                                                                   CSE023
     C           @RTCD     IFNE *BLANKS                                   CSE023
     C           @RTCD     ANDNE'*NRF   '                                 CSE023
     C           *LOCK     IN   LDA                                       CSE023
     C                     MOVEL'SCSARDPD'DBFILE                          CSE023
     C                     MOVEL'CSE023'  DBKEY                           CSE023
     C                     MOVEL@OPTN     DBOPTN                          CSE023
     C                     Z-ADD27        DBASE                           CSE023
     C                     OUT  LDA                                       CSE023
     C                     EXSR DBERR                                     CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If core feature is switched ON, set a variable field to          CSE023
      ** condition the rest of the processing.                            CSE023
      *                                                                   CSE023
     C           @RTCD     IFEQ *BLANKS                                   CSE023
     C                     MOVE 'Y'       CSE023  1                       CSE023
     C                     MOVE *ON       *IN86                           CSE023
     C                     ELSE                                           CSE023
     C                     MOVE 'N'       CSE023                          CSE023
     C                     MOVE *OFF      *IN86                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE031
      **  Access SAR details file to see if CSE031 is installed.          CSE031
      *                                                                   CSE031
     C                     CALL 'AOSARDR0'                                CSE031
     C                     PARM '       ' @RTCD                           CSE031
     C                     PARM '*VERIFY' @OPTN                           CSE031
     C                     PARM 'CSE031'  WSARD   6                       CSE031
      *                                                                   CSE031
     C           @RTCD     IFEQ *BLANK                                    CSE031
     C                     MOVE 'Y'       CSE031  1                       CSE031
     C                     MOVE *ON       *IN81                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE 'N'       CSE031                          CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CEU017
      *  Access Modules File and check if Plato Interface is installed.   CPL002
     C                     CALL 'AOMMODR0'                                CPL002
     C                     PARM '*DBERR ' @RTCD   7                       CPL002
     C                     PARM '*FIRST ' @OPTN   7                       CPL002
     C           SDMMOD    PARM SDMMOD    DSFDY                           CPL002
      *                                                                   CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C                     SETON                     89                   CPL002
      *                                                                   CPL002
     C                     END                                            CPL002
     C*                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVE *ON       *IN25                           CPB001
     C                     ELSE                                           CPB001
     C                     MOVE *OFF      *IN25                           CPB001
     C                     ENDIF                                          CPB001
      *                                                                                       CGL014
      ** Access SAR details file to see if CGL014 is installed                                CGL014
      *                                                                                       CGL014
     C                     CALL 'AOSARDR0'                                                    CGL014
     C                     PARM *BLANKS   PRTCD   7                                           CGL014
     C                     PARM '*VERIFY' POPTN   7                                           CGL014
     C                     PARM 'CGL014'  PSARD   6                                           CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ *BLANK                                                        CGL014
     C                     MOVE 'Y'       CGL014  1                                           CGL014
     C                     ELSE                                                               CGL014
     C                     MOVE 'N'       CGL014                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
      **  Access SAR details file to see if CSD006 is installed.          CSD006
      *                                                                   CSD006
     C                     CALL 'AOSARDR0'                                CSD006
     C                     PARM '       ' @RTCD                           CSD006
     C                     PARM '*VERIFY' @OPTN                           CSD006
     C                     PARM 'CSD006'  WSARD   6                       CSD006
      *                                                                   CSD006
     C           @RTCD     IFEQ *BLANK                                    CSD006
     C                     MOVE 'Y'       CSD006  1                       CSD006
     C                     MOVE *ON       *IN82                           CSD006
     C                     ELSE                                           CSD006
     C                     MOVE 'N'       CSD006                          CSD006
     C                     ENDIF                                          CSD006
      *                                                                   CSD006
      **  Access SAR details file to see if CAP060 is installed.          CAP060
      *                                                                   CAP060
     C                     CALL 'AOSARDR0'                                CAP060
     C                     PARM '       ' @RTCD                           CAP060
     C                     PARM '*VERIFY' @OPTN                           CAP060
     C                     PARM 'CAP060'  WSARD   6                       CAP060
      *                                                                   CAP060
     C           @RTCD     IFEQ *BLANK                                    CAP060
     C                     MOVE 'Y'       CAP060  1                       CAP060
     C                     MOVE *ON       *IN83                           CAP060
     C                     ELSE                                           CAP060
     C                     MOVE 'N'       CAP060                          CAP060
     C                     ENDIF                                          CAP060
      *                                                                   CAP060
      * Check if CSE071 (Holiday CCYs) is active                          CSE071
      *                                                                   CSE071
     C                     CALL 'AOSARDR0'                                CSE071
     C                     PARM *BLANKS   @RTCD                           CSE071
     C                     PARM '*VERIFY' @OPTN                           CSE071
     C                     PARM 'CSE071'  WSARD   6                       CSE071
     C           SCSARD    PARM SCSARD    DSFDY                           CSE071
      *                                                                   CSE071
     C                     SETOF                     45                   CSE071
     C           @RTCD     IFEQ *BLANK                                    CSE071
     C                     SETON                     45                   CSE071
     C                     ENDIF                                          CSE071
      *                                                                   CSE071
      **  Access SAR details file to see if CGL032 is installed.                              CGL032
      *                                                                                       CGL032
     C                     MOVE '0'       *IN88                                               CGL032
     C                     MOVE 'N'       CGL032  1                                           CGL032
     C                     CALL 'AOSARDR0'                                                    CGL032
     C                     PARM '       ' PRTCD   7                                           CGL032
     C                     PARM '*VERIFY' POPTN   7                                           CGL032
     C                     PARM 'CGL032'  WSARD   6                                           CGL032
      *                                                                                       CGL032
     C           PRTCD     IFEQ *BLANK                                                        CGL032
     C                     MOVE '1'       *IN88                                               CGL032
     C                     MOVE 'Y'       CGL032                                              CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
      ** Database Error                                                                       CGL032
      *                                                                                       CGL032
     C           PRTCD     IFNE *BLANKS                                                       CGL032
     C           PRTCD     ANDNE'*NRF   '                                                     CGL032
     C           *LOCK     IN   LDA                                                           CGL032
     C                     MOVEL'CGL032 ' DBKEY                                               CGL032
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL032
     C                     Z-ADD28        DBASE                                               CGL032
     C                     OUT  LDA                                                           CGL032
     C                     EXSR DBERR                                                         CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CRE073
      **  Access SAR details file to see if CRE073 is installed.                              CRE073
      *                                                                                       CRE073
     C                     MOVE *OFF      *IN35                                               CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM '       ' PRTCD                                               CRE073
     C                     PARM '*VERIFY' POPTN                                               CRE073
     C                     PARM 'CRE073'  WSARD                                               CRE073
      *                                                                                       CRE073
     C           PRTCD     IFEQ *BLANK                                                        CRE073
     C                     MOVE *ON       *IN35                                               CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
      ** Database Error                                                                       CRE073
      *                                                                                       CRE073
     C           PRTCD     IFNE *BLANKS                                                       CRE073
     C           PRTCD     ANDNE'*NRF   '                                                     CRE073
     C           *LOCK     IN   LDA                                                           CRE073
     C                     MOVEL'CRE073 ' DBKEY                                               CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     Z-ADD30        DBASE                                               CRE073
     C                     OUT  LDA                                                           CRE073
     C                     EXSR DBERR                                                         CRE073
     C                     ENDIF                                                              CRE073
     C/EJECT
      *================================================================
      *  FIRST TIME PROCESSING
      *================================================================
      *
      * SET INDICATORS FOR REPORT HEADING & OPEN INPUT FILE
     C           MODE      IFEQ 'I'
     C                     SETON                     40
     C                     ELSE
     C           MODE      IFEQ 'A'
     C                     SETON                     41
     C                     ELSE
     C                     SETON                     42
     C                     END
     C                     END
     C*                                                                   S01117
     C**   ACCESS BANK DETAILS, FOR TITLE                                 S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBANKPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DB ERROR 01 *S01117
     C                     Z-ADD1         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,SE0315C001
      *
      *                                                                   S01447
      **  Access SAR details file to see if S01447 is installed.          S01447
      *                    MOVE *OFF      *IN77                           S01447
     C                     MOVE 'N'       S01447  1                       S01447
     C                     CALL 'AOSARDR0'                                S01447
     C                     PARM '       ' @RTCD                           S01447
     C                     PARM '*VERIFY' @OPTN                           S01447
     C                     PARM 'S01447'  WSARD   6                       S01447
     C           SCSARD    PARM SCSARD    DSFDY                           084256
      *                                                                   S01447
     C           @RTCD     IFEQ *BLANK                                    S01447
     C                     MOVE 'Y'       S01447                          S01447
     C                     ENDIF                                          S01447
     C*                                                                   084256
     C**  Access SAR details file to see if Private Banking Securities    084256
     C**  Trading Enhancements switchable feature is installed.           084256
     C*                                                                   084256
     C                     CALL 'AOSARDR0'                                084256
     C                     PARM *BLANKS   @RTCD                           084256
     C                     PARM '*VERIFY' @OPTN                           084256
     C                     PARM 'S01496'  WSARD                           084256
     C           SCSARD    PARM SCSARD    DSFDY                           084256
     C*                                                                   084256
     C           @RTCD     IFEQ *BLANK                                    084256
     C                     MOVE 'Y'       S01496  1                       084256
     C                     SETON                     31                   084256
     C                     END                                            084256
      *                                                                                       CSE065
      ** Access SAR details file to see CSE065 is installed                                   CSE065
      *                                                                                       CSE065
     C                     CALL 'AOSARDR0'                                                    CSE065
     C                     PARM *BLANKS   @RTCD                                               CSE065
     C                     PARM '*VERIFY' @OPTN                                               CSE065
     C                     PARM 'CSE065'  WSARD                                               CSE065
     C           SCSARD    PARM SCSARD    DSFDY                                               CSE065
      *                                                                                       CSE065
     C           @RTCD     IFEQ *BLANK                                                        CSE065
     C                     MOVE 'Y'       CSE065  1                                           CSE065
     C                     MOVE *ON       *IN88                                               CSE065
     C                     ELSE                                                               CSE065
      *                                                                                       CSE065
      ** Database error (return code other than *NRF or *BLANK)                               CSE065
      *                                                                                       CSE065
     C           @RTCD     IFNE '*NRF   '                                                     CSE065
     C           *LOCK     IN   LDA                                                           CSE065
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE065
     C                     MOVEL'CSE065'  DBKEY                                               CSE065
     C                     Z-ADD8         DBASE                                               CSE065
     C                     OUT  LDA                                                           CSE065
     C                     MOVE *ON       *INU7                                               CSE065
     C                     MOVE *ON       *INU8                                               CSE065
     C                     MOVE *ON       *INLR                                               CSE065
     C                     EXSR *PSSR                                                         CSE065
     C                     ELSE                                                               CSE065
     C                     MOVE 'N'       CSE065                                              CSE065
     C                     MOVE *OFF      *IN88                                               CSE065
     C                     ENDIF                                                              CSE065
     C                     ENDIF                                                              CSE065
      *                                                                                       CSE037
      **  Access SAR details for switchable feature Countervalue Rounding                     CSE037
      *                                                                                       CSE037
     C                     CALL 'AOSARDR0'                                                    CSE037
     C                     PARM '       ' @RTCD                                               CSE037
     C                     PARM '*VERIFY' @OPTN                                               CSE037
     C                     PARM 'CSE037'  WSARD                                               CSE037
      *                                                                                       CSE037
     C           @RTCD     IFEQ *BLANK                                                        CSE037
     C                     MOVE 'Y'       CSE037  1                                           CSE037
     C                     MOVE *ON       *IN44                                               CSE037
     C                     ENDIF                                                              CSE037
      *                                                                   CGL018
      ***  Determine if switchable feature CGL018 is activated            CGL018
      *                                                                   CGL018
     C                     CALL 'AOSARDR0'                                CGL018
     C                     PARM *BLANKS   PRTCD   7                       CGL018
     C                     PARM '*VERIFY' POPTN   7                       CGL018
     C                     PARM 'CGL018'  PSARD   6                       CGL018
     C           SCSARD    PARM SCSARD    DSFDY                           CGL018
      *                                                                   CGL018
     C           PRTCD     IFEQ *BLANK                                    CGL018
     C                     MOVE 'Y'       CGL018  1                       CGL018
     C                     SETON                     43                   CGL018
     C                     ELSE                                           CGL018
     C                     MOVE 'N'       CGL018                          CGL018
     C                     SETOF                     43                   CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP6                                           S01408
     C*                                                                   S01408
      *                                                                                       CSE075
      ** Access SAR details file to see if Enhanced Treasury                                  CSE075
      ** switchable feature is installed.                                                     CSE075
      *                                                                                       CSE075
     C                     MOVE 'N'       CSE075                                              CSE075
     C                     MOVE *OFF      *IN49                                               CSE075
     C                     CALL 'AOSARDR0'                                                    CSE075
     C                     PARM *BLANKS   PRTCD                                               CSE075
     C                     PARM '*VERIFY' POPTN                                               CSE075
     C                     PARM 'CSE075'  PSARD                                               CSE075
     C           SCSARD    PARM SCSARD    DSFDY                                               CSE075
      *                                                                                       CSE075
     C           PRTCD     IFEQ *BLANK                                                        CSE075
     C                     MOVE 'Y'       CSE075  1                                           CSE075
     C                     MOVE *ON       *IN49                                               CSE075
     C                     ELSE                                                               CSE075
      *                                                                                       CSE075
      ** Database error (return code other than *NRF or *BLANK)                               CSE075
      *                                                                                       CSE075
     C           PRTCD     IFNE '*NRF   '                                                     CSE075
     C           *LOCK     IN   LDA                                                           CSE075
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE075
     C                     MOVEL'CSE075'  DBKEY                                               CSE075
     C                     Z-ADD9         DBASE                                               CSE075
     C                     OUT  LDA                                                           CSE075
     C                     MOVE *ON       *INU7                                               CSE075
     C                     MOVE *ON       *INU8                                               CSE075
     C                     MOVE *ON       *INLR                                               CSE075
     C                     EXSR *PSSR                                                         CSE075
     C                     ENDIF                                                              CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
      *                                                                                       CER001
      **  Access SAR details file to see if ULX004 SAR is installed.                          CER001
      *                                                                                       CER001
     C                     MOVEL'N'       ULX004  1                                           CER001
     C                     MOVE *OFF      *IN73                                               CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX004'  WSARD                                               CER001
     C           SCSARD    PARM SCSARD    DSFDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE *ON       *IN73                                               CER001
     C                     MOVE 'Y'       ULX004                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** else, database error (return code other than *NRF)                                   CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX004'  DBKEY                                               CER001
     C                     MOVEL@OPTN     DBOPTN                                              CER001
     C                     Z-ADD27        DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR DBERR                                                         CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      **  Access SAR details file to see if ULX008 SAR is installed.                          CER001
      *                                                                                       CER001
     C                     MOVEL'N'       ULX008  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX008'  WSARD                                               CER001
     C           SCSARD    PARM SCSARD    DSFDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE *ON       *IN81                                               CER001
     C                     MOVE 'Y'       ULX008                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** else, database error (return code other than *NRF)                                   CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX008'  DBKEY                                               CER001
     C                     MOVEL@OPTN     DBOPTN                                              CER001
     C                     Z-ADD28        DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR DBERR                                                         CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      **  Check ULX046 status                                                                 CER001
      *                                                                                       CER001
     C                     MOVEL'N'       ULX046  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX046'  WSARD                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE *ON       *IN72                                               CER001
     C                     MOVE 'Y'       ULX046                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** else, database error (return code other than *NRF)                                   CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX046'  DBKEY                                               CER001
     C                     MOVEL@OPTN     DBOPTN                                              CER001
     C                     Z-ADD29        DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR DBERR                                                         CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *
      **GET*INSTALLATION*CONTROL*DATA*RECORD*1****************************S01117
      *
     C***********          EXSR ZSYSTM                                    S01117
      *
      **ERROR*IN*ZSYSTM***************************************************S01117
      *
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C***********          END                                            S01117
      *
     C*****************************************************************   S01117
     C**GET*INSTALLATION*CONTROL*DATA*RECORD*TABTB36*******************   S01117
     C*****************************************************************   S01117
     C***********          EXSR ZICDSE                                    S01117
     C***********                                                         S01117
     C**ERROR*IN*ZICDSE************************************************   S01117
     C***********                                                         S01117
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'05'      DBASE            **DB ERROR 05**S01117
     C************LOCK     IN   LDA                        ************** S01117
     C***********          Z-ADD5         DBASE            **DBERROR 05** S01117
     C***********          MOVEL'TABLE'   DBFILE           ************** S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          OUT  LDA                                       S01117
     C***********          EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C*                                                                   S01117
     C**   ACCESS SECURITIES TRADING DETAIL                               S01117
     C                     CALL 'AOSTRDR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDSTRD    PARM SDSTRD    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDSTRDPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DB ERROR 05 *S01117
     C                     Z-ADD5         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END
      *                                                                                      BUG9427
      ** Access SAR details file to see CAS006 is installed                                  BUG9427
      *                                                                                      BUG9427
     C                     CALL 'AOSARDR0'                                                   BUG9427
     C                     PARM *BLANKS   @RTCD                                              BUG9427
     C                     PARM '*VERIFY' @OPTN                                              BUG9427
     C                     PARM 'CAS006'  WSARD                                              BUG9427
     C           SCSARD    PARM SCSARD    DSFDY                                              BUG9427
      *                                                                                      BUG9427
     C                     MOVE 'N'       CAS006                                             BUG9427
     C                     MOVE '0'       *IN15                                              BUG9427
     C           @RTCD     IFEQ *BLANK                                                       BUG9427
     C                     MOVE 'Y'       CAS006  1                                          BUG9427
     C                     MOVE '1'       *IN15                                              BUG9427
     C                     ELSE                                                              BUG9427
      *                                                                                      BUG9427
      ** Database error (return code other than *NRF or *BLANK)                              BUG9427
      *                                                                                      BUG9427
     C           @RTCD     IFNE '*NRF   '                                                    BUG9427
     C           *LOCK     IN   LDA                                                          BUG9427
     C                     MOVEL'SCSARDPD'DBFILE                                             BUG9427
     C                     MOVEL'CAS006'  DBKEY                                              BUG9427
     C                     Z-ADD9         DBASE                                              BUG9427
     C                     OUT  LDA                                                          BUG9427
     C                     MOVE *ON       *INU7                                              BUG9427
     C                     MOVE *ON       *INU8                                              BUG9427
     C                     MOVE *ON       *INLR                                              BUG9427
     C                     EXSR *PSSR                                                        BUG9427
     C                     ENDIF                                                             BUG9427
     C                     ENDIF                                                             BUG9427
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP2                                           S01408
     C*                                                                   S01408
      ** Access SAR Details to determine if ULX043 is switched ON                             CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  WSARD   6                                           CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** else, database error (return code other than *NRF)                                   CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX043'  DBKEY                                               CER001
     C                     MOVEL@OPTN     DBOPTN                                              CER001
     C                     Z-ADD27        DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR DBERR                                                         CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      *** If IBLC 2002 is installed                                                           CER001
      *                                                                                       CER001
     C                     MOVE 'N'       WKDMIS  1                                           CER001
     C                     MOVE *OFF      *IN44            IBLC 2002 REP                      CER001
     C           BGNWST    IFEQ 'Y'                                                           CER001
     C           ULX043    ANDEQ'Y'                                                           CER001
      *                                                                                       CER001
     C                     OPEN ILICDRPD                                                      CER001
     C           1         SETLLILICDRPD                                                      CER001
     C                     READ ILICDRPD                 99                                   CER001
     C           *IN99     IFEQ *ON                                                           CER001
     C                     SETON                     U7U8                                     CER001
     C                     MOVEL'09'      DBASE                                               CER001
     C                     MOVEL'ILICDRPD'DBFILE    P                                         CER001
     C                     MOVEL'*FIRST'  DBKEY     P                                         CER001
     C                     WRITEHEADAU                                                        CER001
     C                     WRITEERROR                                                         CER001
     C                     GOTO ENDPGM                                                        CER001
     C                     ENDIF                                                              CER001
     C                     CLOSEILICDRPD                                                      CER001
      *                                                                                       CER001
      *** IF ICDR Flag 'USE Dummy Issuer' = 'Y', open SESDX1L0                                CER001
      *                                                                                       CER001
     C           ICDMIS    IFEQ 'Y'                                                           CER001
     C                     MOVE ICDMIS    WKDMIS                                              CER001
     C                     OPEN SESDX1L0                                                      CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *
     C   40                OPEN SECTYLCD
     C  N40                OPEN SECTY
      *                                                                   CSE023
      ** If CSE023 is on, print one security per page to avoid            CSE023
      ** overlapping.                                                     CSE023
      *                                                                   CSE023
     C           CSE023    IFEQ 'Y'                                       CSE023
     C           CGL018    OREQ 'Y'                                       CGL018
     C           CSE031    OREQ 'Y'                                       CSE031
     C                     Z-ADD1         MAXCNT                          CSE023
     C                     ELSE                                           CSE023
     C                     Z-ADD2         MAXCNT  20
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C/SPACE 3
      *================================================================
      *  M A I N   P R O C E S S I N G
      *================================================================
      *
      *
     C   40                READ SECTYLCD                 50
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP9                                           S01408
     C*                                                                   S01408
     C  N40                READ SECTY                    50
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP1                                           S01408
     C*                                                                   S01408
      *                                                                                       CSE075
      ** If Enhanced Treasury is switched on:                                                 CSE075
      *                                                                                       CSE075
     C           CSE075    IFEQ 'Y'                                                           CSE075
      *                                                                                       CSE075
      ** To add new fields (lines) to the report for Enhanced Treasury,                       CSE075
      ** change maximum records printed to one per page.                                      CSE075
      *                                                                                       CSE075
     C                     Z-ADD1         MAXCNT  20                                          CSE075
      *                                                                                       CSE075
      ** If record not found, clear values.                                                   CSE075
      *                                                                                       CSE075
     C           *IN50     IFEQ *ON                                                           CSE075
     C                     Z-ADD*ZEROS    ALDT                                                CSE075
     C                     Z-ADD*ZEROS    RPRT                                                CSE075
     C                     Z-ADD*ZEROS    CPDY                                                CSE075
     C                     Z-ADD*ZEROS    WACP                                                CSE075
     C                     Z-ADD*ZEROS    WAMY                                                CSE075
     C                     ENDIF                                                              CSE075
     C                     ENDIF                                                              CSE075
     C           ULX004    IFEQ 'Y'                                                           CER001
     C           SESN      SETLLSESDX3L0                                                      CER001
     C                     READ SESDX3L0                 30                                   CER001
     C           SESN      SETLLSESDX2L0                                                      CER001
     C                     READ SESDX2L0                 30                                   CER001
     C                     ENDIF                                                              CER001
      *
     C           *IN50     DOWNE'1'
      *
      * A RECORD HAS BEEN READ :-
      *
      * MOVE DATA INTO UNIQUE FIELDS
      *
     C*********************Z-ADDLCD       ZLCD                            E21070
     C                     Z-ADDLCD       WLCD                            E21070
     C                     MOVE CHTP      ZCHTP
     C                     Z-ADDTNLU      ZTNLU
     C                     MOVE *OFF      *IN77                           S01447
      *
      * IF PARM=I & LAST CHANGE DATE NOT = RUN DATE - PRINT TOTALS ETC
     C           MODE      IFEQ 'I'
     C***********ZLCD      IFNE RUND                                      E21070
     C           WLCD      IFNE RUND                                      E21070
     C                     GOTO TOTALS
     C                     END
     C                     END
      *
      * MAINTAIN COUNTS AS NECESSARY
     C           MODE      IFEQ 'I'
     C           MODE      OREQ 'A'
      *
      **  IF RUN DATE IS THE SAME AS LAST CHANGE DATE
      *
     C***********ZLCD      IFEQ RUND                                      E21070
     C           WLCD      IFEQ RUND                                      E21070
      *
      * I OR A MODES - INCLUDE DELETED RECORDS
      *
     C           ZCHTP     IFEQ 'I'
     C                     ADD  1         ZINS
     C                     ELSE
     C           ZCHTP     IFEQ 'A'
     C                     ADD  1         ZAMD
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     ADD  1         ZDEL
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      *
      * I MODE - COUNT OF RECORDS CHANGED TODAY
     C           MODE      IFEQ 'I'
     C***********ZLCD      IFEQ RUND                                      E21070
     C           WLCD      IFEQ RUND                                      E21070
     C                     ADD  1         ZCHG
     C                     END
     C                     ELSE
      * A MODE -
     C           MODE      IFEQ 'A'
      * A MODE - COUNT OF RECORDS READ + LIVE RECORDS
     C           RECI      IFNE '*'
     C           RECI      ANDNE'C'                                       S01158
     C                     ADD  1         ZLIVE
     C                     END
     C***********ZLCD      IFEQ RUND                                      E21070
     C           WLCD      IFEQ RUND                                      E21070
     C                     ADD  1         ZCOUNT
     C                     ELSE
      * - IGNORE IF LCD NOT EQUAL RUN DATE
     C                     GOTO NEXT
     C                     END
      *
     C                     ELSE
      * L MODE - COUNT OF LIVE RECORDS
     C           RECI      IFNE '*'
     C           RECI      ANDNE'C'                                       S01158
     C                     ADD  1         ZLIVE
     C                     ELSE
      * L MODE - IGNORE IF DELETED RECORD
     C                     GOTO NEXT
     C                     END
     C                     END
     C                     END
      *
      * RECORD TO BE PRINTED -
      *     OPEN OUTPUT FILE IF REQUIRED
     C           *IN55     IFEQ '0'
     C                     SETON                     55
     C                     Z-ADD3         LINCNT  20
     C                     OPEN SE0315P1
     C                     EXSR RCFP1                                     S01117
     C                     END
      *
      * PRINT PAGE HEADINGS
     C           LINCNT    IFGE MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
      *
      * FORMAT OUTPUT & PRINT FOR PRINTER FILE
      *
      * FIRST COLUMN ***
      * FORMAT MATURITY DATE INCLUDING CENTURY
     C           MATY      IFEQ 0
     C           MATY      OREQ 99999
     C                     MOVE *BLANKS   ZDMCY
     C                     ELSE
     C                     Z-ADDMATY      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    WORK2N  20
     C*                                                                   076245
     C** CALCULATION ON THE CENTURY                                       076245
     C*  (BASE IS 19 FROM 1972)                                           076245
     C*                                                                   076245
     C***********LTMI      IFEQ 'N'                                       076245
     C***********WORK2N    ANDGT69                                        076245
     C***********          MOVE '19'      CC      2                       076245
     C***********          ELSE                                           076245
     C***********          MOVE '20'      CC                              076245
     C***********          END                                            076245
     C           ZWRK3     DIV  100       CCR     20                      076245
     C           CCR       ADD  19        CCR                             076245
     C                     MOVE CCR       CC      2                       076245
     C*                                                                   076245
     C                     MOVELZADATE    ZDM     5
     C                     MOVE ZADATE    ZYY     2
     C                     MOVELZDM       ZDMC    7
     C                     MOVE CC        ZDMC
     C                     MOVELZDMC      ZDMCY   9
     C                     MOVE ZYY       ZDMCY
     C                     END
      *                                                                                       CSE065
      ** Format Average Life Date                                                             CSE065
      *                                                                                       CSE065
     C           CSE065    IFEQ 'Y'                                                           CSE065
     C           ALDT      IFEQ 0                                                             CSE065
     C           ALDT      OREQ 99999                                                         CSE065
     C                     MOVE *BLANKS   SALDT                                               CSE065
     C                     ELSE                                                               CSE065
     C                     CALL 'ZA0140'                                                      CSE065
     C                     PARM ALDT      P@DAYN  50                                          CSE065
     C                     PARM BJDFIN    P@DFMT  1                                           CSE065
     C                     PARM *ZEROS    P@DATE  60                                          CSE065
     C                     PARM *BLANKS   P@DATA  7                                           CSE065
     C                     PARM *BLANK    P@RTN   1                                           CSE065
     C                     PARM *ZEROS    P@DAT8  80                                          CSE065
      *                                                                                       CSE065
     C                     MOVE P@DATA    Z@DATA                                              CSE065
     C                     MOVE P@DAT8    Z@DAT8                                              CSE065
      *                                                                                       CSE065
     C                     MOVE Z@DADM    D@DYMO                                              CSE065
     C                     MOVE Z@D8YR    D@DDYR                                              CSE065
      *                                                                                       CSE065
     C                     MOVE D@DATE    SALDT                                               CSE065
      *                                                                                       CSE065
     C                     ENDIF                                                              CSE065
     C                     ENDIF                                                              CSE065
      *
      * FORMAT COUPON RATE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE CPNR      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZECPNR 13
      *                                                                                      BUG9427
     C           CAS006    IFEQ 'Y'                                                          BUG9427
      * FORMAT CREDIT RISK                                                                   BUG9427
     C                     MOVE *BLANKS   ZFLD15                                             BUG9427
     C                     MOVE CCRK      ZFLD15                                             BUG9427
     C                     Z-ADD7         ZDECS                                              BUG9427
     C                     MOVE 'L'       ZECODE                                             BUG9427
     C                     EXSR ZSEDIT                                                       BUG9427
     C                     MOVE ZOUT21    RCCRK  13                                          BUG9427
      *                                                                                      BUG9427
      * FORMAT LIQUIDITY PREMIUM                                                             BUG9427
     C                     MOVE *BLANKS   ZFLD15                                             BUG9427
     C                     MOVE CLQP      ZFLD15                                             BUG9427
     C                     Z-ADD7         ZDECS                                              BUG9427
     C                     MOVE 'L'       ZECODE                                             BUG9427
     C                     EXSR ZSEDIT                                                       BUG9427
     C                     MOVE ZOUT21    RCLQP  13                                          BUG9427
     C                     ENDIF                                                             BUG9427
      *
      * FORMAT INITIAL DATE
     C           ITLD      IFEQ 0
     C                     MOVE *BLANK    ZAITLD
     C                     ELSE
     C                     Z-ADDITLD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZAITLD
     C                     END
      *
      * FORMAT EITHER FIRST COUPON OR INITIAL DIV DATE
     C                     Z-ADD0         ZDAYNO
     C           FCPN      IFNE 0
     C                     Z-ADDFCPN      ZDAYNO
     C                     ELSE
     C           IDIV      IFNE 0
     C                     Z-ADDIDIV      ZDAYNO
     C                     END
     C                     END
      *
     C           ZDAYNO    IFNE 0
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZACPDV
     C                     ELSE
     C                     MOVE *BLANK    ZACPDV
     C                     END
      *
      *FORMAT COUPON/DIV RATE DATES DDMMM
     C                     Z-ADD0         Z       20
     C                     DO   12        Z
     C           CD,Z      IFEQ 0
     C                     MOVE *BLANK    Z5CD,Z
     C                     ELSE
      *
      * SEPARATE DDMM/MMDD  USING ICD & ZDATE2 INDICATOR 98=MMDD
     C   98                MOVE CD,Z      CDDD    2
     C  N98                MOVELCD,Z      CDDD
     C   98                MOVELCD,Z      CDMM    20
     C  N98                MOVE CD,Z      CDMM
      *
      * FORMAT PARTIAL ALPHA DATE DDMMM USING ZDATE2 INDICATOR
     C           CDDD      COMP '10'                   95
     C                     MOVELCDDD      ZWRK5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,CDMM ZWRK5
     C                     MOVELZWRK5     Z5CD,Z
     C                     END
     C                     END
      *
      * FORMAT NEXT CHANGE DATE
     C                     Z-ADDNCHD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZANCHD
      *
      * Display Nominal Decimal Places if CEU018 is present               CEU018
     C           CEU018    IFEQ 'Y'                                       CEU018
     C                     MOVE NMDP      RNMDP                           CEU018
     C                     ENDIF                                          CEU018
      *                                                                                       CGL014
      ** Display Weighting Code even if private banking is                                    CGL014
      ** not installed                                                                        CGL014
      *                                                                                       CGL014
     C           CGL014    IFEQ 'Y'                                                           CGL014
     C                     MOVE *ON       *IN26                                               CGL014
     C                     MOVELWEIC      RWEIC                                               CGL014
     C                     ENDIF                                                              CGL014
      *                                                                   CEU018
      * Display Replacement Security if CEU017 is present                 CEU017
     C           CEU017    IFEQ 'Y'                                       CEU017
     C                     MOVE SRRB      RSRRB                           CEU017
     C                     ENDIF                                          CEU017
      *                                                                   CEU017
      * Display Principal Paying agent if PB is present                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVE PPAG      RPPAG                           CPB001
     C                     MOVE GUAR      RGUAR                           CPB001
     C           WEIC      IFEQ *ZERO                                     CPB001
     C                     MOVEL*BLANK    RWEIC                           CPB001
     C                     ELSE                                           CPB001
     C                     MOVELWEIC      RWEIC                           CPB001
     C                     ENDIF                                          CPB001
     C                     MOVE NATU      RNATU                           CPB001
      *                                                                   CAP137
      ** PB Instrument Type                                               CAP137
     C                     MOVE PBIT      RPBIT                           CAP137
      *                                                                   CAP137
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
      * Display Replacement Security if CSD006 is present                 CSD006
     C           CSD006    IFEQ 'Y'                                       CSD006
     C                     MOVE SPDS      RSPDS  32                       CSD006
     C                     ENDIF                                          CSD006
      *                                                                   CSD006
     C           CAP060    IFEQ 'Y'                                       CAP060
     C                     MOVE SPID      RSPID  20                       CAP060
     C                     ENDIF                                          CAP060
      *                                                                   CAP060
     C                     MOVE *BLANKS   DDEUTX  3                                           CGL032
     C           CGL032    IFEQ 'Y'                                                           CGL032
     C           SETX      IFEQ 'Y'                                                           CGL032
     C                     MOVEL'YES'     DDEUTX                                              CGL032
     C                     ELSE                                                               CGL032
     C                     MOVEL'NO'      DDEUTX                                              CGL032
     C                     ENDIF                                                              CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
      * SECOND COLUMN ***
      * FORMAT OUTPUT PRINT REPORT NAME & FULL NAMES
      *
      *  PREPARE FIELDS FOR REPORT NAME
     C                     MOVE SRPN      ZSRPN
     C                     MOVE *BLANK    ZSFN1
     C                     MOVE *BLANK    ZSFN2
      *  ONCE FOR REPORT NAME
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     RNME
      *  PREPARE FIELDS FOR FULL NAMES
     C                     MOVE *BLANK    ZSRPN
     C                     MOVE SFN1      ZSFN1
     C                     MOVE SFN2      ZSFN2
      *  ONCE FOR FULL NAMES
     C                     EXSR ZSDESC
     C                     MOVE ZFNM1     FNM1
     C                     MOVE ZFNM2     FNM2
     C                     MOVE ZFNM3     FNM3
     C*****************************************************************   S01117
     C**FORMAT*INDUSTRY*NAME*-*TABLETN*FILE*USING*KEY******************   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C**  ACCESS INDUSTRY NAME
      *    IF NO RECORD/RECORD DELETED - PRINT BLANK
      *
     C***********          MOVEL'61      'TNKEY                           S01117
     C**********           MOVE SIDY      TNSIDY                                            BUG22324
     C                     MOVE LOIC      TNSIDY                                            BUG22324
     C***********TABTNK    CHAINTABLETNF             57                   S01117
     C************IN57     IFEQ '1'                                       S01117
     C*                                                                   S01117
     C                     CALL 'AOINDSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM TNSIDY    @CDNB   3                       S01117
     C           SDINDS    PARM SDINDS    DSFDY                           S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE *BLANK    ZLIDN                           S01117
     C                     ELSE
     C***********RECI      IFNE '*'                                       S01117
     C***********RECI      ANDNE'C'                                S01158 S01117
     C***********          MOVE LIDN      ZLIDN                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZLIDN                           S01117
     C***********          END                                            S01117
     C                     MOVE AOLINA    ZLIDN                           S01117
     C                     END
      *
      * FORMAT DETAILS - FIRSTLY INVESTMENT NAME
      *    READ INVTPD FILE USING KEY
     C           INVTPK    CHAININVTPDF              58
     C           *IN58     IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'03'      DBASE            **DB ERROR 03**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD3         DBASE            **DB ERROR 03**S01117
     C                     MOVEL'INVTPD'  DBFILE
     C                     MOVELNMCY      DBKEY6  6
     C                     MOVE SITP      DBKEY6
     C                     MOVELDBKEY6    DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *                                                                   S01220
     C                     SETOF                     75                   S01220
      *                                                                   S01220
      *
      *  IF RECORD DELETED PRINT BLANK
     C           RECI      IFNE '*'
     C           RECI      ANDNE'C'                                       S01158
     C                     MOVE INAM      ZINAM
      *                                                                   S01220
      ** Test for processing type 4                                       S01220
      *                                                                   S01220
     C           PROT      IFEQ '4'                                       S01220
     C                     SETON                     75                   S01220
     C                     END                                            S01220
     C                     ELSE
     C                     MOVE *BLANK    ZINAM
     C                     END
      *                                                                   CSE005
      ** Test for processing type 3                                       CSE005
      *                                                                   CSE005
     C           PROT      IFEQ '3'                                       CSE005
     C           PROT      OREQ '8'                                       CSE031
     C           CSE031    ANDEQ'Y'                                       CSE031
     C                     MOVE *ON       *IN80                           CSE005
     C                     ELSE                                           CSE005
     C                     MOVE *OFF      *IN80                           CSE005
     C                     ENDIF                                          CSE005
      *
      * FORMAT CUST.SHORT NAME USING SDC 1 TO 3 FROM ABOVE INVTPD
      *    AS KEYS TO CLINTCB FILE
      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C                     Z-ADD0         Z
     C                     DO   3         Z
     C***********          Z-ADDSDC,Z     CBNUM                           S01117
     C**********           Z-ADDSDC,Z     CBNUM   60                                   S01117 CSD027
     C                     MOVE SDC,Z     CBNUM   6                                           CSD027
     C***********          MOVE 'A'       CBRCDT                          S01117
     C***********CLINTK    CHAINCLINTCBF             56
     C                     MOVE CBNUM     CLINTK  6                       S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM CLINTK    @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C*                                                                   S01117
     C************IN56     IFEQ '1'                                       S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE *BLANK    ZCSN,Z
     C                     ELSE
     C                     MOVE BBCSSN    ZCSN,Z                          S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********RECI      ANDNE'C'                                S01158 S01117
     C***********          MOVE CSNM      ZCSN,Z                          S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZCSN,Z                          S01117
     C***********          END                                            S01117
     C                     END
     C                     END
      *
      * FORMAT  ISSUER NAME/TOWN
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C**********           Z-ADDISSR      CBNUM                                        S01117 CSD027
     C                     MOVE ISSR      CBNUM                                               CSD027
     C                     MOVE CBNUM     CLINTK                          S01117
     C***********          MOVE 'A'       CBRCDT                          S01117
     C***********CLINTK    CHAINCLINTCBF             56                   S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM CLINTK    @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C************IN56     IFEQ '1'                                       S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE *BLANK    ZCRNM
     C                     MOVE *BLANK    ZCTWN
     C                     ELSE
     C                     MOVE BBCRNM    ZCRNM                           S01117
     C                     MOVE BBCRTN    ZCTWN                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********RECI      ANDNE'C'                                S01158 S01117
     C***********          MOVE CRNM      ZCRNM                           S01117
     C***********          MOVE CTWN      ZCTWN                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZCRNM                           S01117
     C***********          MOVE *BLANK    ZCTWN                           S01117
     C***********          END                                            S01117
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP3                                           S01408
     C*                                                                   S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
      ***  Acess Dummy issuer details, if FLag WKDMIS is 'Y'                                  CER001
      *                                                                                       CER001
     C           WKDMIS    IFEQ 'Y'                                                           CER001
     C           SESN      CHAINSESDX1L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not found                          CER001
     C                     MOVE *OFF      *IN44            NO PRINT                           CER001
     C                     MOVE *BLANKS   PISTP2                                              CER001
     C                     MOVE *BLANKS   PISTP3                                              CER001
     C                     ELSE                                                               CER001
     C                     MOVE *ON       *IN44            Print                              CER001
     C                     MOVE VVISTP    PISTP2           Found                              CER001
     C                     MOVE VVISTP    PISTP3                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      *
      * FORMAT CUSTOMER SHORT NAME - LEAD MANAGER
      *    READ CLINTCB FILE USING KEY
      * IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C**********           Z-ADDLMGR      CBNUM                                               CSD027
     C                     MOVE LMGR      CBNUM                                               CSD027
     C                     MOVE CBNUM     CLINTK                          S01117
     C***********          MOVE 'A'       CBRCDT                          S01117
     C***********CLINTK    CHAINCLINTCBF             56                   S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM CLINTK    @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C*                                                                   S01117
     C************IN56     IFEQ '1'                                       S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE *BLANK    ZLMCSN
     C                     ELSE
     C                     MOVE BBCSSN    ZLMCSN                          S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE CSNM      ZLMCSN                          S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZLMCSN                          S01117
     C***********          END                                            S01117
     C                     END
      *
      * FORMAT MARKET INDICATOR LEGEND
     C                     MOVE *BLANK    LMKTI   9
     C           MKTI      IFEQ 'G'
     C                     MOVEL'GREY'    LMKTI
     C                     ELSE
     C           MKTI      IFEQ 'P'
     C                     MOVEL'PRIMARY' LMKTI
     C                     ELSE
     C           MKTI      IFEQ 'S'
     C                     MOVEL'SECOND'  LMKTI
     C                     MOVE 'ARY'     LMKTI
     C                     END
     C                     END
     C                     END
      *
      * FORMAT TRADE LEGEND
     C                     MOVE *BLANK    LSTBS   8
     C           STBS      IFEQ 'P'
     C                     MOVEL'PRICE'   LSTBS
     C                     ELSE
     C           STBS      IFEQ 'D'
     C                     MOVEL'DISCOUNT'LSTBS
     C                     ELSE
     C           STBS      IFEQ 'Y'
     C                     MOVEL'YIELD'   LSTBS
     C                     END
     C                     END
     C                     END
      *                                                                   S01397
      ***  Set Indicator for Australian Yield method.                     S01397
      *                                                                   S01397
     C           SYBS      IFEQ 'AU'                                      S01397
     C                     SETON                     70                   S01397
     C                     ELSE                                           S01397
     C                     SETOF                     70                   S01397
     C                     END                                            S01397
      *
      * FORMAT PRICE LEGEND
     C                     MOVE *BLANK    LSPBS  10
     C           SPBS      IFEQ 'P'
     C                     MOVEL'PERCENT' LSPBS
     C                     MOVE 'AGE'     LSPBS
     C                     ELSE
     C           SPBS      IFEQ 'U'
     C                     MOVEL'UNIT'    LSPBS
     C                     END
     C                     END
      *
      * FORMAT DAY BASIS LEGEND
     C                     SETOF                     59                   E21070
     C                     SETOF                     606162
     C                     SETOF                     6364
     C           DYBS      IFEQ '1'
     C                     SETON                     60
     C                     ELSE
     C           DYBS      IFEQ '2'
     C                     SETON                     61
     C                     ELSE
     C           DYBS      IFEQ '3'
     C                     SETON                     62
     C                     ELSE
     C           DYBS      IFEQ '4'
     C                     SETON                     63
     C                     ELSE
     C           DYBS      IFEQ '5'                                       E21070
     C                     SETON                     59                   E21070
     C                     ELSE                                           E21070
     C***********DYBS      IFEQ '5'                                       E17202
     C           DYBS      IFEQ '6'                                       E17202
     C                     SETON                     64
     C                     END                                            E21070
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      *
      * FORMAT DIVISOR BASIS LEGEND
     C                     SETOF                     656667
     C                     SETOF                     68
     C           DVBS      IFEQ '1'
     C                     SETON                     65
     C                     ELSE
     C           DVBS      IFEQ '2'
     C                     SETON                     66
     C                     ELSE
     C           DVBS      IFEQ '3'
     C                     SETON                     67
     C                     ELSE
     C           DVBS      IFEQ '5'
     C                     SETON                     68
     C                     END
     C                     END
     C                     END
     C                     END
      *
      * FORMAT INTEREST ADJUSTMENT
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE IADJ      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEIADJ  4
      *
      * FORMAT SPREAD
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE BASS      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEBASS 13
      *
      * FORMAT MINIMUM COUPON
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MCPN      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEMCPN 13
      *                                                                                       CRE073
      ** Format Contractual Spread Rate                                                       CRE073
      *                                                                                       CRE073
     C           *IN35     IFEQ *ON                                                           CRE073
     C                     MOVE *BLANKS   ZFLD15                                              CRE073
     C                     MOVE CNSP      ZFLD15                                              CRE073
     C                     Z-ADD7         ZDECS                                               CRE073
     C                     MOVE 'L'       ZECODE                                              CRE073
     C                     EXSR ZSEDIT                                                        CRE073
     C                     MOVE ZOUT21    ZECNSP 13                                           CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
      * THIRD COLUMN ***
      * FORMAT CONVERTIBLE INDICATOR LEGEND
     C                     MOVE *BLANK    LSCVI   3
     C           SCVI      IFEQ 'C'
     C                     MOVE 'YES'     LSCVI
     C                     ELSE
     C           SCVI      IFEQ 'N'
     C                     MOVEL'NO'      LSCVI
     C                     END
     C                     END
      *
      * FORMAT PRINT PARTLY PAID LEGEND
     C                     MOVE *BLANK    LPPDI   3
     C           PPDI      IFEQ 'Y'
     C                     MOVE 'YES'     LPPDI
     C                     ELSE
     C           PPDI      IFEQ 'N'
     C                     MOVEL'NO'      LPPDI
     C                     END
     C                     END
      *
      * FORMAT INITIAL PRICE
     C           PPDI      IFEQ 'N'
     C                     MOVE *BLANK    ZESINP
     C                     ELSE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE SINP      ZFLD15
     C*****                Z-ADD8         ZDECS                           S01158
     C                     MOVE 'L'       ZECODE
     C           PROT      IFNE '4'                                       S01158
     C                     Z-ADD3         ZDECS                           S01158
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZESINP 17
     C                     ELSE                                           S01158
     C*                                                                   S01158
     C* Fetch nominal decimal places                                      S01158
     C***********          MOVEL'20      'TKEY                     S01158 S01117
     C***********          MOVE NMCY      TFECY                    S01158 S01117
     C***********          MOVE '1'       TKEY                     S01158 S01117
     C***********TABTK     CHAINTABTG10F             69            S01158 S01117
     C************IN69     IFEQ '0'                                S01158 S01117
     C***********RECI      IFEQ '*'                                S01158 S01117
     C***********RECI      ANDNE'C'                                S01158 S01117
     C***********          SETON                     69            S01158 S01117
     C***********          END                                     S01158 S01117
     C***********          END                                     S01158 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM NMCY      @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C** INVALID CURRENCY                                                 S01117
     C*                                                                   S01117
     C************IN69     IFEQ '1'                                S01158 S01117
     C***********          MOVEL'1'       *INU8                     S01158S01117
     C***********          MOVEL'1'       *INU7                     S01158S01117
     C***********          MOVEL'06'      DBASE            **DB ERROS01158S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C           *LOCK     IN   LDA                        ************** S01117
     C                     Z-ADD6         DBASE            **DBERROR 06** S01117
     C***********          MOVEL'TABLE'   DBFILE           ******* S01158 S01117
     C***********          MOVELTKEY      DBKEY                    S01158 S01117
     C                     MOVEL'SDCURRPD'DBFILE                          S01117
     C                     MOVE @AJCD     DBKEY                           S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                             S01158S01117
     C                     GOTO ENDPGM                                    S01158
     C                     END                                            S01158
     C***********          Z-ADDCDP       ZDECS                    S01158 S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT                                    S01158
     C                     MOVE ZOUT21    ZESINP                          S01158
     C                     END                                            S01158
     C                     END
      *
      * FORMAT FULLY PAID PRICE
     C           PPDI      IFEQ 'N'
     C                     MOVE *BLANK    ZESFPP
     C                     ELSE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE SFPP      ZFLD15
     C****                 Z-ADD8         ZDECS                           S01158
     C                     MOVE 'L'       ZECODE
     C           PROT      IFNE '4'                                       S01158
     C                     Z-ADD3         ZDECS                           S01158
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZESFPP 17
     C                     ELSE                                           S01158
     C*                                                                   S01158
     C* Fetch nominal decimal places                                      S01158
     C*                                                                   S01158
     C***********          MOVEL'20      'TKEY                     S01158 S01117
     C***********          MOVE NMCY      TFECY                    S01158 S01117
     C***********          MOVE '1'       TKEY                     S01158 S01117
     C***********TABTK     CHAINTABTG10F             69            S01158 S01117
     C************IN69     IFEQ '0'                                S01158 S01117
     C***********RECI      IFEQ '*'                                S01158 S01117
     C***********RECI      ANDNE'C'                                S01158 S01117
     C***********          SETON                     69            S01158 S01117
     C***********          END                                     S01158 S01117
     C***********          END                                     S01158 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM NMCY      @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C************IN69     IFEQ '1'                                       S01158
     C           @RTCD     IFNE *BLANKS                            S01158 S01117
     C***********          MOVEL'1'       *INU8                     S01158S01117
     C***********          MOVEL'1'       *INU7                     S01158S01117
     C***********          MOVEL'07'      DBASE            **DB ERROS01158S01117
     C           *LOCK     IN   LDA                        ************** S01117
     C                     Z-ADD7         DBASE            **DBERROR 07** S01117
     C***********          MOVEL'TABLE'   DBFILE           ******* S01158 S01117
     C***********          MOVELTKEY      DBKEY                    S01158 S01117
     C                     MOVEL'SDCURRPD'DBFILE                          S01117
     C                     MOVE @AJCD     DBKEY                           S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                              S01158S01117
     C***********          WRITEERROR                               S01158S01117
     C***********          WRITETRAILAU                             S01158S01117
     C***********          GOTO ENDPGM                              S01158S01117
     C                     END                                            S01158
     C***********          Z-ADDCDP       ZDECS                    S01158 S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
     C                     EXSR ZSEDIT                                    S01158
     C                     MOVE ZOUT21    ZESFPP                          S01158
     C                     END                                            S01158
     C                     END
      *
      * FORMAT VARIOUS FEES IN FEE CURRENCY
      *****READING*TABTG10*FILE*USING*KEY******************************** S01117
     C***********          MOVEL'20      'TKEY                            S01117
     C***********          MOVE FECY      TFECY                           S01117
     C***********          MOVE '1'       TKEY                            S01117
     C***********TABTK     CHAINTABTG10F             69                   S01117
     C************IN69     IFEQ '0'                                       S01117
     C***********RECI      IFEQ '*'                                       S01117
     C***********RECI      ANDNE'C'                                S01158 S01117
     C***********          SETON                     69                   S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM FECY      @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C************IN69     IFEQ '1'                                       S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'04'      DBASE            **DB ERROR 04**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD4         DBASE            **DB ERROR 04**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELTKEY      DBKEY                           S01117
     C                     MOVEL'SDCURRPD'DBFILE                          S01117
     C                     MOVE @AJCD     DBKEY                           S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *
      **  USE FEE CURR DEC PLACES FROM TABTG10 FOR ZDECS
      **  AS INPUT TO ZSEDIT
     C***********          Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDA6NBDP    ZDECS                           S01117
      *
      * FORMAT MANAGEMENT FEES DUE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MGFD      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEMGFD 15
      *
      * FORMAT MANAGEMENT FEES RCD
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE MGRC      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEMGRC 15
      *
      * FORMAT UNDERWRITING FEES DUE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE UNFD      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEUNFD 15
      *
      * FORMAT UNDERWRITING FEES RCD
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE UNFR      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEUNFR 15
      *                                                                   E15237
      * FORMAT TRADE DENOMINATION                                         E15237
     C***********          MOVE *BLANKS   ZFLD15                    E15237E17822
     C***********          MOVE SDNM      ZFLD15                    E15237E17822
     C***********          MOVE 'J'       ZECODE                    E15237E17822
     C***********          EXSR ZSEDIT                              E15237E17822
     C***********          MOVE ZOUT21    ZESDNM                    E15237E17822
      *                                                                   E15237
      * FORMAT NEXT DIVIDEND                                              E15237
     C                     MOVE *BLANKS   ZFLD15                          E15237
     C                     MOVE NEXD      ZFLD15                          E15237
     C                     MOVE 'J'       ZECODE                          E15237
     C                     EXSR ZSEDIT                                    E15237
     C                     MOVE ZOUT21    ZENEXD                          E15237
      *                                                                   E15237
      * FORMAT ISSUE AMOUNT                                               E15237
     C***********          MOVE *BLANKS   ZFLD15                   E15237 054500
     C***********          MOVE ISSA      ZFLD15                   E15237 054500
     C***********          MOVE 'J'       ZECODE                   E15237 054500
     C***********          EXSR ZSEDIT                             E15237 054500
     C***********          MOVE ZOUT21    ZEISSA                   E15237 054500
      *                                                                   E15237
      * FORMAT TOTAL UNDERWRITTEN                                         E15237
     C/COPY WNCPYSRC,SE0315C003
     C***********          MOVE *BLANKS   ZFLD15                   E15237 104938
     C***********          MOVE TOTU      ZFLD15                   E15237 104938
     C***********          MOVE 'J'       ZECODE                   E15237 104938
     C***********          EXSR ZSEDIT                             E15237 104938
     C***********          MOVE ZOUT21    ZETOTU                   E15237 104938
      *                                                                   E15237
      * FORMAT ALLOCATION REQUESTED                                       E15237
     C***********          MOVE *BLANKS   ZFLD15                   E15237 104938
     C***********          MOVE ALRQ      ZFLD15                   E15237 104938
     C***********          MOVE 'J'       ZECODE                   E15237 104938
     C***********          EXSR ZSEDIT                             E15237 104938
     C***********          MOVE ZOUT21    ZEALRQ                   E15237 104938
      *                                                                   E15237
      * FORMAT ALLOCATION RECEIVED                                        E15237
     C***********          MOVE *BLANKS   ZFLD15                   E15237 104938
     C***********          MOVE ALRC      ZFLD15                   E15237 104938
     C***********          MOVE 'J'       ZECODE                   E15237 104938
     C***********          EXSR ZSEDIT                             E15237 104938
     C***********          MOVE ZOUT21    ZEALRC                   E15237 104938
      * FOURTH COLUMN ***
      * FORMAT INCOMPLETE INDICATOR LEGEND
     C                     MOVE *BLANK    LINCS  10
     C           INCS      IFEQ 'I'
     C                     MOVEL'INCOMP'  LINCS
     C                     MOVE 'LETE'    LINCS
     C                     ELSE
     C           INCS      IFEQ 'C'
     C                     MOVE 'COMPLETE'LINCS
     C                     END
     C                     END
      *
      * FORMAT DATE MADE COMPLETE
     C           DCOM      IFEQ 0
     C                     MOVE *BLANK    ZADCOM
     C                     ELSE
     C                     Z-ADDDCOM      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZADCOM
     C                     END
      *
      * FORMAT LAST CHANGE DATE
     C*********************Z-ADDZLCD      ZDAYNO                          E21070
     C                     Z-ADDWLCD      ZDAYNO                          E21070
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZALCD
      *
      * FORMAT CHANGE TYPE LEGEND
     C                     SETOF                     515253
     C           ZCHTP     IFEQ 'A'
     C                     SETON                     51
     C                     ELSE
     C           ZCHTP     IFEQ 'I'
     C                     SETON                     52
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     SETON                     53
     C                     END
     C                     END
     C                     END
      *
      * FORMAT RISK CUSTOMER SHORT NAME                                   S01176
      * READ CLINTCB FILE - IF NO SNAME FOUND OUTPUT NUMBER               S01176
     C                     MOVE *BLANKS   ZRNAM  10                       S01176
     C********** RSKC      IFNE *ZERO                                                  S01176 CSD027
     C**********           Z-ADDRSKC      CBNUM                                        S01176 CSD027
     C           RSKC      IFNE *BLANKS                                                       CSD027
     C                     MOVE RSKC      CBNUM                                               CSD027
     C                     MOVE CBNUM     CLINTK                          S01117
     C***********          MOVE 'A'       CBRCDT                   S01176 S01117
     C***********CLINTK    CHAINCLINTCBF             56            S01176 S01117
     C                     CALL 'AOCUSTR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM CLINTK    @KEY1  10                       S01117
     C                     PARM           @KYST   7                       S01117
     C           SDCUST    PARM SDCUST    DSSDY                           S01117
     C*                                                                   S01117
     C************IN56     IFEQ '1'                                S01176 S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVELRSKC      ZRNAM                           S01176
     C                     ELSE                                           S01176
     C                     MOVE BBCSSN    ZRNAM                           S01117
     C***********RECI      IFNE '*'                                S01176 S01117
     C***********          MOVE CSNM      ZRNAM                    S01176 S01117
     C***********          ELSE                                    S01176 S01117
     C***********          MOVELRSKC      ZRNAM                    S01176 S01117
     C***********          END                                     S01176 S01117
     C                     END                                            S01176
     C                     END                                            S01176
      *                                                                   S01176
      *
      * FORMAT ISSUE DATE
     C           ISSD      IFEQ 0
     C                     MOVE *BLANK    ZAISSD
     C                     ELSE
     C                     Z-ADDISSD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZAISSD
     C                     END
      * FORMAT ISSUE PRICE
     C           ISSP      IFEQ 0
     C                     MOVE *BLANK    ZEISSP
     C                     ELSE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE ISSP      ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEISSP 17
     C                     END
      *                                                                   S01447
      *** Check to see if S01447 is switched on, if so do sub-routine.    S01447
      *                                                                   S01447
     C           S01447    IFEQ 'Y'                                       S01447
     C                     EXSR PRTADT                                    S01447
     C                     ENDIF                                          S01447
      *                                                                   CSE023
     C           CSE023    IFEQ 'Y'                                       CSE023
     C                     MOVELCRTT      P1CRTT                          CSE023
     C                     MOVELINCT      P1INCT                          CSE023
     C                     MOVELEXCD      P1EXCD                          CSE023
     C                     MOVELOIDI      P1OIDI                          CSE023
     C                     MOVELAPIE      P1APIE                          CSE023
     C                     ENDIF                                          CSE023
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP8                                           S01408
     C*                                                                   S01408
      ** Always initialize output arrays for window fields.                                   CSE075
      *                                                                                       CSE075
     C                     MOVE *BLANKS   XRWNFF                                              CSE075
     C                     MOVE *BLANKS   XRWNF1                                              CSE075
     C                     MOVE *BLANKS   XRWNF2                                              CSE075
      *                                                                                       CSE075
      ** If Enhanced Treasury is switched on.                                                 CSE075
      *                                                                                       CSE075
     C           CSE075    IFEQ 'Y'                                                           CSE075
      *                                                                                       CSE075
      ** Note: MBS data now held on separate fields on extension file.                        CSE075
      *                                                                                       CSE075
     C           PROT      IFEQ '8'                                                           CSE075
      *                                                                                       CSE075
      ** Average Life Date                                                                    CSE075
      *                                                                                       CSE075
     C                     MOVEA@WNFLD,1  XR@WN1                                              CSE075
     C                     Z-ADDALDT      ZDAYNO                                              CSE075
     C                     EXSR ZDATE2                                                        CSE075
     C                     MOVE ZADATE    ZESALD                                              CSE075
      *                                                                                       CSE075
      ** Repayment Rate (anticipated)                                                         CSE075
      *                                                                                       CSE075
     C                     MOVEA@WNFLD,2  XR@WN2                                              CSE075
     C                     MOVE *BLANKS   ZFLD15                                              CSE075
     C                     MOVE RPRT      ZFLD15                                              CSE075
     C                     Z-ADD4         ZDECS                                               CSE075
     C                     EXSR ZSEDIT                                                        CSE075
     C                     MOVE ZOUT21    ZESRPR                                              CSE075
      *****************************************************************                       CSE075
      ***Coupon*Delay*(in*days)****************************************                       CSE075
      *****************************************************************                       CSE075
     C**********           MOVEA@WNFLD,3  XR@WN3                                              CSE075
     C**********           MOVE *BLANKS   ZFLD15                                              CSE075
     C**********           MOVE CPDY      ZFLD15                                              CSE075
     C**********           Z-ADD0         ZDECS                                               CSE075
     C**********           EXSR ZSEDIT                                                        CSE075
     C**********           MOVE ZOUT21    ZESDLY                                              CSE075
      *                                                                                       CSE075
      ** Weighted Average Coupon                                                              CSE075
      *                                                                                       CSE075
     C                     MOVEA@WNFLD,4  XR@WN4                                              CSE075
     C                     MOVE *BLANKS   ZFLD15                                              CSE075
     C                     MOVE WACP      ZFLD15                                              CSE075
     C                     Z-ADD4         ZDECS                                               CSE075
     C                     EXSR ZSEDIT                                                        CSE075
     C                     MOVE ZOUT21    ZESWAC                                              CSE075
      *                                                                                       CSE075
      ** Weighted Average Maturity/Life                                                       CSE075
      *                                                                                       CSE075
     C                     MOVEA@WNFLD,5  XR@WN5                                              CSE075
     C                     MOVE *BLANKS   ZFLD15                                              CSE075
     C                     MOVE WAMY      ZFLD15                                              CSE075
     C                     Z-ADD4         ZDECS                                               CSE075
     C                     EXSR ZSEDIT                                                        CSE075
     C                     MOVE ZOUT21    ZESWAM                                              CSE075
     C                     ELSE                                                               CSE075
     C                     MOVE *BLANKS   ZESALD                                              CSE075
     C                     MOVE *BLANKS   ZESRPR                                              CSE075
     C**********           MOVE *BLANKS   ZESDLY                                       CSE075 CSE075
     C                     MOVE *BLANKS   ZESWAC                                              CSE075
     C                     MOVE *BLANKS   ZESWAM                                              CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
      ** Coupon Delay (in days)                                                               CSE075
      *                                                                                       CSE075
     C           STBS      IFEQ 'P'                                                           CSE075
     C           PROT      ANDNE'2'                                                           CSE075
     C           PROT      ANDNE'4'                                                           CSE075
     C           PROT      ANDNE'7'                                                           CSE075
     C           STBS      OREQ 'Y'                                                           CSE075
     C           PROT      ANDNE'2'                                                           CSE075
     C           PROT      ANDNE'4'                                                           CSE075
     C           PROT      ANDNE'7'                                                           CSE075
     C           PROT      ANDNE'9'                                                           CSE075
     C                     MOVEA@WNFLD,3  XR@WN3                                              CSE075
     C                     MOVE *BLANKS   ZFLD15                                              CSE075
     C                     MOVE CPDY      ZFLD15                                              CSE075
     C                     Z-ADD0         ZDECS                                               CSE075
     C                     EXSR ZSEDIT                                                        CSE075
     C                     MOVE ZOUT21    ZESDLY                                              CSE075
     C                     ELSE                                                               CSE075
     C                     MOVE *BLANKS   ZESDLY                                              CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
     C                     ENDIF                                                              CSE075
      *                                                                                       CSE075
     C***  If PROT=3 and CSE005 is on then format SLCPN and SNCD          CSE005
     C*                                                                   CSE005
     C           *IN79     IFEQ *ON                                       CSE005
     C           *IN80     ANDEQ*ON                                       CSE005
     C*                                                                   CSE005
      * FORMAT LAST COUPON DATE SLCPN                                     CSE005
      *                                                                   CSE005
     C           LCPN      IFNE *ZEROS                                    CSE005
     C                     MOVE LCPN      ZDAYNO                          CSE005
     C                     EXSR ZDATE2                                    CSE005
     C                     MOVE ZADATE    SLCPN                           CSE005
     C                     ELSE                                           CSE005
     C                     MOVE *BLANKS   SLCPN                           CSE005
     C                     ENDIF                                          CSE005
      *                                                                   CSE005
      * FORMAT NEXT COUPON DATE SNCD USING ZNCD with ECD=RUND             CSE005
      *                                                                   CSE005
     C                     Z-ADDRUND      ECD     50                      CSE005
     C                     EXSR ZNCD                                      CSE005
     C           NCD       IFNE *ZEROS                                    CSE005
     C                     MOVE NCD       ZDAYNO                          CSE005
     C                     EXSR ZDATE2                                    CSE005
     C                     MOVE ZADATE    SNCD                            CSE005
     C                     ELSE                                           CSE005
     C                     MOVE *BLANKS   SNCD                            CSE005
     C                     ENDIF                                          CSE005
      *                                                                   CSE005
     C                     ENDIF                                          CSE005
      *                                                                   CSE031
      * If PROT=3 or PROT=8 and CSE031 is on then format                  CSE031
      * Additional Coupon Information.                                    CSE031
      *                                                                   CSE031
     C           CSE031    IFEQ 'Y'                                       CSE031
     C           *IN80     ANDEQ*ON                                       CSE031
      * Applicable Date 1                                                 CSE031
     C           AD01      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD01                           CSE031
     C                     MOVE *BLANKS   PBR01                           CSE031
     C                     MOVE *BLANKS   PBS01                           CSE031
     C                     MOVE *BLANKS   PSI01                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD01      PAD01                           CSE031
     C                     MOVE BR01      PBR01                           CSE031
     C                     MOVE SI01      PSI01                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS01      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS01                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 2                                                 CSE031
     C           AD02      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD02                           CSE031
     C                     MOVE *BLANKS   PBR02                           CSE031
     C                     MOVE *BLANKS   PBS02                           CSE031
     C                     MOVE *BLANKS   PSI02                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD02      PAD02                           CSE031
     C                     MOVE BR02      PBR02                           CSE031
     C                     MOVE SI02      PSI02                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS02      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS02                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 3                                                 CSE031
     C           AD03      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD03                           CSE031
     C                     MOVE *BLANKS   PBR03                           CSE031
     C                     MOVE *BLANKS   PBS03                           CSE031
     C                     MOVE *BLANKS   PSI03                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD03      PAD03                           CSE031
     C                     MOVE BR03      PBR03                           CSE031
     C                     MOVE SI03      PSI03                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS03      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS03                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 4                                                 CSE031
     C           AD04      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD04                           CSE031
     C                     MOVE *BLANKS   PBR04                           CSE031
     C                     MOVE *BLANKS   PBS04                           CSE031
     C                     MOVE *BLANKS   PSI04                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD04      PAD04                           CSE031
     C                     MOVE BR04      PBR04                           CSE031
     C                     MOVE SI04      PSI04                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS04      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS04                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 5                                                 CSE031
     C           AD05      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD05                           CSE031
     C                     MOVE *BLANKS   PBR05                           CSE031
     C                     MOVE *BLANKS   PBS05                           CSE031
     C                     MOVE *BLANKS   PSI05                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD05      PAD05                           CSE031
     C                     MOVE BR05      PBR05                           CSE031
     C                     MOVE SI05      PSI05                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS05      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS05                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 6                                                 CSE031
     C           AD06      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD06                           CSE031
     C                     MOVE *BLANKS   PBR06                           CSE031
     C                     MOVE *BLANKS   PBS06                           CSE031
     C                     MOVE *BLANKS   PSI06                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD06      PAD06                           CSE031
     C                     MOVE BR06      PBR06                           CSE031
     C                     MOVE SI06      PSI06                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS06      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS06                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 7                                                 CSE031
     C           AD07      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD07                           CSE031
     C                     MOVE *BLANKS   PBR07                           CSE031
     C                     MOVE *BLANKS   PBS07                           CSE031
     C                     MOVE *BLANKS   PSI07                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD07      PAD07                           CSE031
     C                     MOVE BR07      PBR07                           CSE031
     C                     MOVE SI07      PSI07                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS07      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS07                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 8                                                 CSE031
     C           AD08      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD08                           CSE031
     C                     MOVE *BLANKS   PBR08                           CSE031
     C                     MOVE *BLANKS   PBS08                           CSE031
     C                     MOVE *BLANKS   PSI08                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD08      PAD08                           CSE031
     C                     MOVE BR08      PBR08                           CSE031
     C                     MOVE SI08      PSI08                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS08      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS08                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 9                                                 CSE031
     C           AD09      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD09                           CSE031
     C                     MOVE *BLANKS   PBR09                           CSE031
     C                     MOVE *BLANKS   PBS09                           CSE031
     C                     MOVE *BLANKS   PSI09                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD09      PAD09                           CSE031
     C                     MOVE BR09      PBR09                           CSE031
     C                     MOVE SI09      PSI09                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS09      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS09                           CSE031
     C                     ENDIF                                          CSE031
      * Applicable Date 10                                                CSE031
     C           AD10      IFEQ *ZERO                                     CSE031
     C                     MOVE *BLANKS   PAD10                           CSE031
     C                     MOVE *BLANKS   PBR10                           CSE031
     C                     MOVE *BLANKS   PBS10                           CSE031
     C                     MOVE *BLANKS   PSI10                           CSE031
     C                     ELSE                                           CSE031
     C                     MOVE AD10      PAD10                           CSE031
     C                     MOVE BR10      PBR10                           CSE031
     C                     MOVE SI10      PSI10                           CSE031
      *                                                                   CSE031
     C                     MOVE *BLANKS   ZFLD15                          CSE031
     C                     MOVE BS10      ZFLD15                          CSE031
     C                     Z-ADD7         ZDECS                           CSE031
     C                     MOVE 'L'       ZECODE                          CSE031
     C                     EXSR ZSEDIT                                    CSE031
     C                     MOVE ZOUT21    PBS10                           CSE031
     C                     ENDIF                                          CSE031
      *                                                                   CSE031
     C                     ENDIF                                          CSE031
      *
      *                                                                   CSD006
      ** Make room for Price Data Source in printer file                  CSD006
      *                                                                   CSD006
     C           FNM3      IFNE *BLANK                                    CSD006
     C                     MOVE *ON       *IN87                           CSD006
     C                     ELSE                                           CSD006
     C                     MOVE *OFF      *IN87                           CSD006
     C                     ENDIF                                          CSD006
      *                                                                   CGL018
      * Output RWA details for each security                              CGL018
      *                                                                   CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C                     EXSR RWADTL                                    CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
      *                                                                   CSD006
      * OUTPUT DETAIL FORMAT TO PRINTER FILE
      *
     C                     ADD  1         LINCNT
     C/COPY WNCPYSRC,SE0315C002
     C                     WRITEDETAIL
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP7                                           S01408
     C*                                                                   S01408
      *
     C*
     C* NEXT
     C           NEXT      TAG                             ** NEXT TAG  **
     C   40                READ SECTYLCD                 50
     C  N40                READ SECTY                    50
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP5                                           S01408
     C*                                                                   S01408
      *                                                                                       CSE075
      ** If Enhanced Treasury is switched on:                                                 CSE075
      *                                                                                       CSE075
     C           CSE075    IFEQ 'Y'                                                           CSE075
      *                                                                                       CSE075
      ** If record not found, clear values.                                                   CSE075
      *                                                                                       CSE075
     C           *IN50     IFEQ *ON                                                           CSE075
     C                     Z-ADD*ZEROS    ALDT                                                CSE075
     C                     Z-ADD*ZEROS    RPRT                                                CSE075
     C                     Z-ADD*ZEROS    CPDY                                                CSE075
     C                     Z-ADD*ZEROS    WACP                                                CSE075
     C                     Z-ADD*ZEROS    WAMY                                                CSE075
     C                     ENDIF                                                              CSE075
     C                     ENDIF                                                              CSE075
     C           ULX004    IFEQ 'Y'                                                           CER001
     C           SESN      SETLLSESDX3L0                                                      CER001
     C                     READ SESDX3L0                 30                                   CER001
     C           SESN      SETLLSESDX2L0                                                      CER001
     C                     READ SESDX2L0                 30                                   CER001
     C                     ENDIF                                                              CER001
     C                     END
     C/SPACE 3
      *
      * END OF FILE - IF DETAIL RECORDS WRITTEN - WRITE TOTAL LINE
      *
     C           TOTALS    TAG                             ** TOTALS TAG**
      *
     C           *IN55     IFEQ '1'
     C                     ADD  1         LINCNT
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
     C                     WRITETOTAL
     C***********          WRITETRAILP1                                   S01117
     C                     END
     C*                                                                   S01117
     C** WRITE '*** NO DETAILS TO REPORT ***' LINE                        S01117
     C*                                                                   S01117
     C           *IN55     IFEQ '0'                                       S01117
     C***********          MOVE '1'       *IN55                     S01117E29170
     C                     MOVE '1'       *IN36                           S01117
     C***********          OPEN SE0315P1                                  E29170
     C***********          EXSR RCFP1                               S01117E29170
     C***********          WRITEHEADP1                              S01117E29170
     C***********          WRITENONEP1                              S01117E29170
     C                     END                                            S01117
      *
     C/SPACE 3
      *================================================================
      *  RUN CONTROL PROCESS
      *================================================================
      *
      *
      **WRITE*CONTROL*REPORT*HEADINGS*************************************S01117
     C***********          WRITEHEADAU                                    S01117
      *
      * READ AUDIT RECORD
     C                     READ SECTYA                   50
     C           *IN,50    IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'02'      DBASE            **DB ERROR 02**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD2         DBASE            **DB ERROR 02**S01117
     C                     MOVEL'SECTYA'  DBFILE           ***************
     C                     MOVE 'AUDIT'   DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *
      * 'I' MODE - PRINT REPORT
     C           MODE      IFEQ 'I'
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLI
      *
      *
      * 'A'/'L' MODE -
     C                     ELSE
      *
      * 'A' MODE - DO RUN CONTROLS
     C           MODE      IFEQ 'A'
     C           SLRB      ADD  SINS      ZWORK
     C                     SUB  SDEL      ZWORK
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CP10                                           S01408
     C*                                                                   S01408
     C           ZWORK     IFNE ZLIVE
     C                     SETON                     U854
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CP11                                           S01408
     C*                                                                   S01408
      *
      **  - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLA
      *
      **  - UPDATE AUDIT RECORD
     C           *INU8     IFEQ '0'
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CP12                                           S01408
     C*                                                                   S01408
     C                     Z-ADDZLIVE     NORE                            E13622
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CP13                                           S01408
     C*                                                                   S01408
     C                     Z-ADD0         SINS
     C                     Z-ADD0         SAMD
     C                     Z-ADD0         SDEL
     C***********          Z-ADDNORE      SLRB                            S01158
     C                     Z-ADDZWORK     SLRB                            S01158
     C                     UPDATSECTYAF
     C                     END
      *
      * 'L' MODE - DO RUN CONTROLS
     C                     ELSE
     C           NORE      IFNE ZLIVE
     C                     SETON                     U854
     C                     END
      *
      *          - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLL
     C                     END
     C                     END
      *
      *  IF NO OUTPUT - WRITE MESSAGE TO THIS EFFECT
     C************IN55     IFEQ '0'                                       S01117
     C           *IN36     IFEQ '1'                                       S01117
     C                     WRITENONE
     C                     ELSE                                           E36201
     C                     WRITETRAILP1                                   E36201
     C                     END
      *
     C***********          WRITETRAILP1                            S01117 E36201
     C***********          WRITETRAILAU                                   S01117
     C/SPACE 3
      *================================================================
      *  END OF PROGRAM
      *================================================================
      *
     C           ENDPGM    TAG                             ** ENDPGM TAG**
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0315CCP4                                           S01408
     C*                                                                   S01408
     C                     SETON                     LR
     C                     RETRN
     C*
     C*****************************************************************
      /EJECT
     C********************************************************************
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*   DBERR SR.- DATABASE ERROR SUBROUTINE                            S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           DBERR     BEGSR                           ** DBERR SR ** S01117
     C*                                                                   S01117
     C**  DATABASE ERROR HANDLING , REPORT ETC.                           S01117
     C*                                                                   S01117
     C** WRITE DB ERROR DETAILS TO P1                                     S01117
     C*                                                                   S01117
     C           *IN55     IFNE '1'                                       S01117
     C                     ELSE                            *P1 NOT OPENED*S01117
     C                     ADD  1         LINCNT                          S01117
     C           LINCNT    IFGT MAXCNT                                    S01117
     C                     WRITEHEADP1                                    S01117
     C                     END                                            S01117
     C                     WRITEERRORP1                                   S01117
     C                     WRITETRAILP1                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** OUTPUT RUN CONTROL DETAILS FOR AU                                S01117
     C*                                                                   S01117
     C                     WRITEHEADAU                                    S01117
     C           MODE      IFEQ 'I'                                       S01117
     C                     WRITECONTROLI                                  S01117
     C                     ELSE                                           S01117
     C           MODE      IFEQ 'A'                                       S01117
     C                     WRITECONTROLA                                  S01117
     C                     ELSE                                           S01117
     C                     WRITECONTROLL                                  S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** OUTPUT DB ERROR DETAILS FOR AU                                   S01117
     C*                                                                   S01117
     C                     WRITEERROR                                     S01117
     C**                                                                  S01117
     C                     SETON                     U7U8LR               S01117
     C                     EXSR *PSSR                                     S01117
     C**                                                                  S01117
     C                     RETRN                                          S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*   RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF         S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFP1     BEGSR                            ** RCFP1 **   S01117
     C*                                                                   S01117
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*   RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF         S01117
     C* *                                                                 S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFAU     BEGSR                            ** RCFAU **   S01117
     C*                                                                   S01117
     C**  ENSURE AUDIT SPOOL FILE RECORDED BY RCF                         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           ZSNUMU                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
      *****************************************************************   S01117
      /EJECT                                                              S01117
      *****************************************************************   S01117
      *                                                                   S01447
      *  PRTADT - This sub-routine processes the Tax Details.             S01447
      *           (PROCESS_TAX_DETAILS)                                   S01447
      *                                                                   S01447
      *****************************************************************   S01447
      *                                                                   S01447
     C           PRTADT    BEGSR                            ** PRTADT **  S01447
      *                                                                   S01447
     C                     MOVE *BLANKS   Z1CTTA                          S01447
     C                     MOVE *ZEROS    Z1TABD                          S01447
     C                     MOVE *ZEROS    Z1TABU                          S01447
     C***********          MOVE *ZEROS    Z1RASO                    S01447084256
     C                     MOVE *ZEROS    Z1RAS4                          084256
     C                     MOVE *ZEROS    Z1RAS2                          084256
      *                                                                   S01447
     C           SESN      CHAINSESWHTL0             71                   S01447
     C           *IN71     IFEQ '0'                                       S01447
     C                     MOVE *ON       *IN77                           S01447
     C                     MOVE S1CTTA    Z1CTTA                          S01447
     C                     MOVE S1TABD    Z1TABD                          S01447
     C                     MOVE S1TABU    Z1TABU                          S01447
     C*                                                                   S01447
     C                     MOVE *BLANKS   ZFLD15                          S01447
     C                     MOVE S1RASO    ZFLD15                          S01447
     C*****************    Z-ADD2         ZDECS                    S01447 S01496
     C                     Z-ADD4         ZDECS                    S01447 S01496
     C                     MOVE 'L'       ZECODE                          S01447
     C                     EXSR ZSEDIT                                    S01447
     C*****************    MOVE ZOUT21    Z1RASO  6                S01447 S01496
     C                     MOVE ZOUT21    WWFL21                          S01496
     C***********          MOVE WW20CH    Z1RASO  8                 S01496084256
     C           S01496    IFEQ 'Y'                                       084256
     C                     MOVE WW20CH    Z1RAS4                          084256
     C                     ELSE                                           084256
     C                     MOVE WW18CH    Z1RAS2                          084256
     C                     END                                            084256
     C                     ENDIF                                          S01447
      *                                                                   S01447
     C                     ENDSR                                          S01447
      *                                                                   S01447
      *****************************************************************   S01447
      /EJECT                                                              S01447
      *****************************************************************   S01447
      *                                                               *   S01117
      *  *PSSR  - Error control subroutine                            *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
      *                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C**                                                                  S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
     C********************************************************************S01117
      * RWA       : Output RWA information from GLORWAPD                * CGL018
      * ---                                                             * CGL018
      * Called By : CAPRDT                                              * CGL018
      * Calls     : None                                                * CGL018
      ******************************************************************* CGL018
     C           RWADTL    BEGSR                                          CGL018
      *                                                                   CGL018
     C           SESN      SETLLSESRWAP0                                  CGL018
     C           SESN      READESESRWAP0                 97               CGL018
     C                     MOVE *BLANKS   XRWA                            CGL018
     C                     MOVEL*BLANKS   RWASE                           CGL018
     C                     MOVEL*BLANKS   RWASEC                          CGL018
     C                     MOVEL*BLANKS   #CONTI                          CGL018
     C                     Z-ADD0         U       20                      CGL018
     C           *IN97     DOWEQ'0'                                       CGL018
      *                                                                   CGL018
     C                     ADD  1         U                               CGL018
     C                     MOVE RWCODE    #RCODE                          CGL018
     C                     MOVE RWSETN    #RSET                           CGL018
      *                                                                   CGL018
     C           U         IFGT 18                                        CGL018
     C           #CONTI    ANDNE'C'                                       CGL018
     C                     Z-ADD1         U                               CGL018
     C                     MOVEL'C'       #CONTI  1                       CGL018
     C                     MOVEL*BLANKS   RWASE                           CGL018
     C                     MOVEAXRWA      RWASE                           CGL018
     C                     MOVE *BLANKS   XRWA                            CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     MOVEARWSECO    XRWA,U                          CGL018
      *                                                                   CGL018
     C           SESN      READESESRWAP0                 97               CGL018
     C                     ENDDO                                          CGL018
      *                                                                   CGL018
     C           U         IFEQ 0                                         CGL018
     C                     MOVEL'None'    RWASE                           CGL018
     C                     ELSE                                           CGL018
      *                                                                   CGL018
      * Last one must be without comma, so clear and output again         CGL018
      *                                                                   CGL018
     C                     MOVEL*BLANKS   #COMMA                          CGL018
     C                     MOVEARWSECO    XRWA,U                          CGL018
      *                                                                   CGL018
     C           #CONTI    IFEQ 'C'                                       CGL018
     C                     MOVEAXRWA      RWASEC                          CGL018
     C                     ELSE                                           CGL018
     C                     MOVEAXRWA      RWASE                           CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     MOVEL','       #COMMA                          CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     ENDSR                                          CGL018
     C********************************************************************S01117
      /EJECT                                                              CSE005
     C/COPY ZSRSRC,ZNCDZ3                                                 CSE005
      /EJECT                                                              CSE005
     C/COPY ZSRSRC,ZDATE1Z2                                               CSE005
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
     C*COPY*ZSRSRC,ZICDSEZ1************                                   S01117
     C*EJECT***************************                                   S01117
     C/COPY ZSRSRC,ZSDESCZ3
      /EJECT
     C/COPY ZSRSRC,ZSEDITZ3
      /EJECT
     C*COPY*ZSRSRC,ZSYSTMZ1**                                             S01117
      /EJECT
     O*                                                                   S01408
     O/COPY WNCPYSRC,SE0315OOP1                                           S01408
     O*                                                                   S01408
      ***
     O*                                                                   S01408
     O/COPY WNCPYSRC,SE0315OOP2                                           S01408
**   @WNFLD - ARRAY ENTRIES FOR WINDOW FIELDS  - ENHANCED TREASURY                            CSE075
AVG.LIFE DATE
EXPECTED REPAY.RATE
DELAY
WGT.AVG.COUPON
WGT.AVG.MATURITY
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
