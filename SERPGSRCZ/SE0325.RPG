     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Trade Transaction Audit List')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Securities Trading Module                            *
     F*                                                               *
     F*  SE0325 - TRADE TRANSACTION AUDIT LIST                        *
     F*                                                               *
     F*  Function:  This program produces a report, for audit         *
     F*   (I/C)     purposes, of all Trade transactions defined to    *
     F*   (COB)     the system. The sequence of the report is Branch/ *
     F*             Trade Reference.                                  *
     F*                                                               *
     F*  Called By: 1) SEC0301 - Audit Reports - Input Cycle          *
     F*             2) SEC0601 - Audit Reports - Close of Business    *
     F*             3) SEC0302 - Full Lists - On Request              *
     F*                                                               *
     F*             Frequency:                                        *
     F*             The report is available in 3 modes (I,A,L):       *
     F*             1) On request during I/C; an interim report       *
     F*                showing the latest status of trade             *
     F*                transactions inserted, amended or deleted      *
     F*                during the day.                                *
     F*             2) During COB; a report of all trade transactions *
     F*                inserted, amended or deleted during the day.   *
     F*             3) On request; a report of all live trade         *
     F*                transactions in the system (ie. deleted items  *
     F*                are not included).                             *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. 226449             Date 24Jun15               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *  Prev Amend No. BUG21197           Date 29Sep08               *
      *                 CSW208             Date 15Apr08               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12791           Date 04Dec06               *
      *                 154670             Date 26May06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9429            Date 12Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 BG9048             Date 26Oct05               *
      *                 235575             Date 18Aug05               *
      *                 234675             Date 05Jul05               *
      *                 234000             Date 08Jun05               *
      *                 233776             Date 29May05               *
      *                 CGL031             Date 05Jul04               *
      *                 CSE071             Date 19Jul05               *
      *                 BUG3122            Date 17Jul04               *
      *                 CGL029             Date 01Sep03               *
      *                 194370             Date 12Jul01               *
      *                 211407             Date 07Jan03               *
      *                 208241             Date 21Aug02               *
      *                 180056             Date 18Oct00               *
      *                 CSE035             Date 22Apr02               *
      *                 206316             Date 19Jul02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSE031             Date 09Nov01               *
      *                 180707             Date 25Jul00               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      *                 173639             Date 14Jun01               *
      *                 127566             Date 09May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 188773             Date 15Jan01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 18Jun99               *
      *                 CGL011             Date 20Sep99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAC005             Date 23Nov98               *
      *                 130862             Date 18Oct98               *
      *                 151945             DATE 06Jan99               *
      *                 CSW098             Date 02Jul98               *
      *                 CEU017             Date 03Mar98               *
     F*                 CSE007             Date 05Jan98               *
     F*                 CEU005             Date 03Feb98               *
     F*                 CSE005             DATE 04FEB97               *
     F*                 CAC002             Date 15Sep96               *
     F*                 084704             Date 12Aug96               *
     F*                 083039             Date 12Aug96               *
     F*                 059110             Date 12Aug96               *
     F*                 088047             DATE 26JUN96               *
     F*                 CSW003             DATE 11MAR96               *
     F*                 100228             DATE 30MAY96               *
     F*                 100017             DATE 18APR96               *
     F*                 S01408             DATE 06FEB96               *
     F*                 092961             DATE 04OCT95               *
     F*                 091254             DATE 20OCT95               *
     F*                 086491             DATE 15JUN95               *
     F*                 S01408             DATE 17JAN95               *
     F*                 S01486  RS         DATE 26OCT94               *
     F*                 S01496             DATE 13JUL94               *
     F*                 055420             DATE 24NOV93               *
     F*                 052254             DATE 24NOV93               *
     F*                 S01446             DATE 04NOV93               *
     F*                 S01401             DATE 16JUN93               *
     F*                 S01397             DATE 10SEP92               *
     F*                 E43208             DATE 10SEP92               *
     F*                 E33879             DATE 24DEC91               *
     F*                 E29170             DATE 08NOV91               *
     F*                 E28705             DATE 24SEP91               *
     F*                 S01220             DATE 12NOV90               *
     F*                 S01117             DATE 31OCT90               *
     F*                 S01269             DATE 18OCT90               *
     F*                 S01271             DATE 18OCT90               *
     F*                 E20909             DATE 25JAN90               *
     F*                 E20651             DATE 01JAN90               *
     F*                 E20086             DATE 08NOV89               *
     F*                 E20013             DATE 01NOV89               *
     F*                 E20012             DATE 01NOV89               *
     F*                 E19412             DATE 24OCT89               *
     F*                 E17204             DATE 24/04/89              *
     F*                 E17303             DATE 21/04/89              *
     F*                 E14497             DATE 27/09/88              *
     F*                 S01176             DATE 16/08/88              *
     F*                 S01169             DATE 18/07/88              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  226449 - Recompiled over changes made in /COPY ZDYYRZ3.      *
      *         - Applied for MD034387.                               *
      *  BUG21197 - COB - Program SEC0601 failed (Recompile)          *
      *  CSW208 - SWIFT 2008 Changes                                  *
      *  BUG12791 - Some pay code values from SE0325 Audit List       *
      *             report should not be doubled digits (Recompile).  *
     F*  154670 - Report not being distributed by RCF.                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9429- Credit Risk and Liquity Premium field introduced by *
      *           IAS not included in the report.                     *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  BG9048 - CCY rate not being printed out fully.               *
      *  235575 - Correct conditions under which EU Tax is printed.   *
      *  234675 - Change control for processing type 4 and Dividend   *
      *           EU tax calculation.                                 *
      *  234000 - Display EU Tax Amount and Fiscal Price              *
      *  233776 - Wrong fiscal price shown on enquiry screen and      *
      *           report                                              *
      *  CGL031 - Taxation of Savings Income                          *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  194370 - Recompile after change on copy sources ZYLDZ2,      *
      *           For securities with divisor basis = '5' and first   *
      *           coupon date > valuation date (rundate + 1), set     *
      *           event control date to first coupon date before      *
      *           processing SR/ZDYYR. This is to ensure that the     *
      *           correct hypothetical last and next coupon dates are *
      *           used in deriving the price/yield rate.              *
      *  211407 - Recompile after change on copy sources ZYLDZ2,      *
      *           ZACCRZ1 and ZYCEZ1 for NX/NNX processing.           *
      *           The change was to call subroutine ZLCD1 instead     *
      *           of ZLCD in retrieving the PERIOD for NNX processing *
      *           and ZNCD1 is called instead of ZNCD in retrieving   *
      *           the WBENCD for NNX processing. Also rewrite tests   *
      *           for identifying if position is NX,NNX or CUM.       *
      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
      *  180056 - Recompiled over changed in ZDYYRZ3.                 *
      *  CSE035 - NX/NNX Coupon Payment Processing.                   *
      *           Recompile over changed ZYLDZ2
      *  206316 - Recompiled over changed ZLCDZ1.                     *
      *  CSE031 - Coupon Fixing for Floating Rate Notes.              *
      *           (recompilation due to change to ZNCD/ZLCD)          *
      *  180707 - No Position Settlements generated. Recompile over   *
      *           changes in /COPY ZNCDZ3.                            *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  173639 - Recompiled due to SE0325P1 changes.                 *
      *  127566 - Recompiled over changed ZSDESCZ3                    *
      *  188773 - Printer overflow line detected for SE0325P1         *
      *  CSE023 - Treaty Withholding tax                              *
     F*  CPB001 - 'Private Banking' Module                            *
      *  CGL011 - Collateral Processing for Midas                     *
      *  CAC005 - Profit Centre Accounting - SE Enhancement           *
     F*  130862 - Recompiled over ZLCDZ1 & ZDAYSZ2 changes.           *
     F*  151945 - Recompiled Over changed ZDYYRZ3 .                   *
     F*  CSW098 - SWIFT 98 changes.                                   *
     F*  CEU017 - Securities Redenomination Euro Changes              *
     F*  CSE007 - Corporate Actions                                   *
     F*  CEU005 - EMU SE Settlement Ccy Conversion, insertion         *
     F*           of 'In' Ccy in field 72.                            *
     F*  CSE005 - Effect of holidays on FRN Coupon Dates              *
     F*           (recompilation due to change to ZNCD/ZLCD)          *
     F*  CAC002 - Profit Centre Accounting Development - Phase 2      *
     F*           If Analytical Accounting is available, the profit   *
     F*           centre for each Charge/Commission Code would be     *
     F*           reported.  The trade's Book and Transaction Profit  *
     F*           Centres will also be reported.  If the settlement   *
     F*           currency is not the same as the nominal currency,   *
     F*           the FX Margin Points and Amount will also be        *
     F*           reported.                                           *
     F*  084704 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
     F*  083039 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
     F*  059110 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
     F*  088047 - RECOMPILE over change SR/ZYLDZ2.                    *
     F*  CSW003 - MT5XX Message Generation - Phase 2.                 *
     F*  100228 - ADD SR ZLCD AND CHANGE EXISTING FIELD ZLCD TO XLCD. *
     F*           RECOMPILE OVER CHANGED ZDYYRZ3, ZLCDZ1 & ZNCDZ3.    *
     F*  100017 - Position settlement unable to pick up day adj. on   *
     F*           SECTYD. Change subroutine to use DADJN to stop      *
     F*           interest day adjustment being used for amortisation.*
     F*           Recompile over amended subroutine ZDAYS.            *
     F*  S01408 - ADDITION OF CORE HOOK SE0325FFP1                    *
     F*           ADDITION OF CORE HOOK SE0325CP10                    *
     F*  092961 - Recompile over ZDAYSZ2 which was amended by 086491  *
     F*           (Wrong number of days calculated for day basis 1    *
     F*           when start or end day is last day of February)      *
     F*  091254 - RECOMPILE OVER CHANGED ZLCDZ1 & ZNCDZ3              *
     F*  086491 - Wrong nbr of days calculated for day basis 1        *
     F*           when start or end day is last day of February       *
     F*           Recompiled for ZSRSRC/ZDAYSZ2 changes.              *
     F*  S01408 - ADDITION OF CORE HOOK SE0325CCPG                    *
     F*           ADDITION OF CORE HOOK SE0325CCP1                    *
     F*           ADDITION OF CORE HOOK SE0325CCP2                    *
     F*           ADDITION OF CORE HOOK SE0325CCP3                    *
     F*           ADDITION OF CORE HOOK SE0325CCP4                    *
     F*           ADDITION OF CORE HOOK SE0325CCP5                    *
     F*           ADDITION OF CORE HOOK SE0325CCP6                    *
     F*           ADDITION OF CORE HOOK SE0325CCP7                    *
     F*           ADDITION OF CORE HOOK SE0325CCP8                    *
     F*           ADDITION OF CORE HOOK SE0325CCP9                    *
     F*  S01486 - PORTFOLIO MANAGEMENT ENHANCEMENT                    *
     F*  S01496 - Incorporation of Jyske Enhancements (S10978).       *
     F*  055420 - CONSIDERATION MUST BE HALF-ADJUSTED.                *
     F*  052254 - CURRENT FACTOR amended from 9,8 to 10,9             *
     F*  S01446 - CUSTOMER COMMISSIONS (COURTAGE) ENHANCEMENT.        *
     F*           Recompiled due to changes in PF/SECGTD.  Also       *
     F*           corrected an erroneous comment.                     *
     F*  S01401 - Produce SWIFT Messages MT5xxs, if option available. *
     F*           Show new fields in report.                          *
     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
     F*          - Recompiled due to changes to files.                *
     F*  E43208 - Recompilation needed due to changes in Printer      *
     F*           File SE0325P1. (AIBD changed to ISMA).              *
     F*  E33879 - If Pay From or Pay To are blanks then do not display*
     F*           separating hyphens or settlement branch             *
     F*  E29170 - Recompiled over changed PRTF for RCF changes        *
     F*  E28705 - Recompiled over changed PRTF                        *
     F*  S01220 - STRATEGIC RISK MANAGEMENT                           *
     F*           Recompiled over changed PF/SECTYD                   *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01269 - Trades Authorisation - Print Authorisation status   *
     F*  S01271 - Recompiled for Pay/Receive in Input Cycle changes   *
     F*           to TRADSD and/or DPTMVD                             *
     F*  E20909 - Countervalue should come from TRADSD                *
     F*  E20651 - DB Error Numbers used in more than one place.       *   E20651
     F*           New Error Numbers as follows:                       *   E20651
     F*               DB ERROR 03  ->  08                             *   E20651
     F*               DB ERROR 03  ->  09                             *   E20651
     F*  E20086 - Mortgage-Backs and Current Factor Processing Rewrite*   E20086
     F*          - Consideration is now held on TRADSD exclusive of   *   E20086
     F*            the Current Factor, so it needs to be included.    *   E20086
     F*          - Use current factor from TRADSD, not SECTYD.        *   E20086
     F*  E20013 - IF PAY FROM FIELD ON A TRADE SALE IS A COUNTERPARTY *   E20013
     F*           NOSTRO, THE COUNTERPARTY NOSTRO SHORTNAME (CPSH)    *   E20013
     F*           SHOULD BE PRINTED.                                  *   E20013
     F*  E20012 - FOR SETTLEMENT METHOD 15, PAY FROM ON A PURCHASE AND*   E20012
     F*           PAY TO ON A SALE SHOULD PRINT CNUM-ACOD-SEQ INSTEAD *   E20012
     F*           OF THE CUSTOMER SHORTNAME.                          *   E20012
     F*  E19412 - CUM/EX DIVIDEND INDICATOR IS NOT BEING PRINTED      *   E19412
     F*  E17204 - PROGRAM RECOMPILED TO PICK UP CORRECT VERSION OF    *   E17204
     F*           TRDIP.                                              *   E17204
     F*  E17303 - RECOMPILE PROGRAM OVER CHANGED ZDYYRZ3 ZYLDZ1 ZYLDZ2*   E17303
     F*  E14497 - ASSUMPTION THAT PYFM FOR A SALE, OR PAYT FOR A      *   E14497
     F*           PURCHASE, ARE 2-DIGIT NOSTROS CAUSES SPURIOUS       *   E14497
     F*           RESULTS IN FIELDS OUTPUT TO REPORT.                 *   E14497
     F*  S01176 - RELEASE 3.1 MODIFICATIONS                           *   S01176
     F*  S01169 - JULIUS BAER INCORPORATION CHANGES - JUNE 88         *   S01169
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
     FTRDIP   IF  E           K        DISK                           UC
     FTABSE   IF  E           K        DISK
     F            TABTB10F                          KIGNORE               S01117
     F            TABTB11F                          KIGNORE               S01117
     F            TABTB36F                          KIGNORE               S01117
     F            TABLETAF                          KIGNORE
     F            TABTE10F                          KIGNORE
     F            TABTE20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F*********** TABLETJF                          KIGNORE               S01117
     F            TABLETKF                          KIGNORE
     F            TABLETNF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETRF                          KIGNORE               S01117
     F            TABLETXF                          KIGNORE
     F            TABLET2F                          KIGNORE
     F            TABLET3F                          KIGNORE
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCCF                          KIGNORE
     F            CLINTC1F                          KIGNORE
     F            CLINTSEF                          KIGNORE
     FSECTY   IF  E           K        DISK
     FINVTP   IF  E           K        DISK
     FBOOKD   IF  E           K        DISK
     F*SECHG***IF**E           K        DISK                              S01169
     FSECGT   IF  E           K        DISK                               S01169
     FTRADSDY1IF  E           K        DISK                           UC  S01401
     FTRADSA  UF  E           K        DISK
     FSEERALL2IF  E           K        DISK                           UC  S01496
     F*SDSECSL1IF**E           K        DISK                              S01496
     FSE0325P1O   E                    PRINTER                        UC
     F                                              KINFDS SPOOL          S01117
     FSE0325AUO   E                    PRINTER
     F                                              KINFDS SPOOLU         S01117
     F*
     F/COPY WNCPYSRC,SE0325FFP1
     FSETRX1L0IF  E           K        DISK                                                   CER001
     F*
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   10       PRINT AUTHORISATION STATUS                         *   S01269
     F*   19       Analytical accounting is installed                 *   CAC002
     F*   20       Nominal currency not = settlement currency         *   CAC002
     F*   21       Portfolio customer                                 *   CAC002
     F*   24       Switchable feature CSW098 is on or date is greater *   CSW098
     F*            than 16 October 1998. Can also be error on call to *   CSW098
     F*            SWIFT98.                                           *   CSW098
     F*   25       NOMINAL CURRENCY DEC. PLACES 0                     *
     F*   26       NOMINAL CURRENCY DEC. PLACES 1                     *
     F*   27       NOMINAL CURRENCY DEC. PLACES 2                     *
     F*   28       NOMINAL CURRENCY DEC. PLACES 3                     *
      *   29       Standing Instruction Override field non-display    *                       CSW201
      *            Also error indicator for SWIF2001.                 *                       CSW201
     F*   30       MT5xx SWITCHABLE FEATURES PRESENT - S01401         *   S01401
     F*   31       Destination: From Depot or To Depot                *   CSW003
     F*   32       IF PB PRESENT SETS ON                              *   CPB001
     F*   33       Display 'In' Ccy                                   *   CEU005
     F*   34       PAY FROM IS NOT BLANK                              *   E33879
     F*   35       MULTIBRANCHING                                     *   S01117
     F*   36       'NO DETAILS TO REPORT'                             *   S01117
     F*   37       PROFIT CENTRE USED IND.                            *   S01117
     F*   38       ORIGINATING BRANCH USED                            *   S01117
     F*   39       IF PM PRESENT SETS ON                              *   S01486
     F*   40       INPUT PARAMETER IS I (INPUT CYCLE MODE)            *
     F*   41       INPUT PARAMETER IS A (AUDIT MODE)                  *
     F*   42       INPUT PARAMETER IS L (FULL LIST MODE)              *
     F*   46       CSW208 is on and time of trade is not blanks       *                       CSW208
     F*   47       CSW208 is on and time of trade is not blanks       *                       CSW208
     F*   48-49    PRINT APP/AUT                                      *   S01269
     F*   50       END OF INPUT FILE / FILE READ ERROR                *
     F*   51-54    PRINT AMD/INS/DEL/CHG LEGEND                       *
     F*   55       PRINT ACCRUED IND/EX DIVIDEND                      *   E19412
     F*   56       NO BOOKD RECORD                                    *
     F****57*******NO*TABLETR*RECORD***                               *   S01117
     F*   58       CLINTCB RECORD MISSING                             *
     F*   59       SECTYD RECORD MISSING                              *
     F*   60       TABLET5 RECORD MISSING                             *
     F*   61       TABLETL RECORD MISSING                             *
     F****62*******SECHGD RECORD MISSING                              *   S01169
     F*   62       SECGTD RECORD MISSING                              *   S01169
     F*   63       TABTG10 RECORD MISSING                             *
     F*   64-69    CLEARANCE LEGEND                                   *
     F*   70-74,78 PAY CODE LEGEND                                    *
     F*   75-77    PRIORITY CODE LEGEND                               *
     F*   79       ERROR ON READ ON TRADES EXTENSION FILE (MT5xx)     *   S01401
     F*   80       OPEN/CLOSE PRINTER FILE SE0325P1                   *
     F*   81       PRINT 'DIFFERENCE' LEGEND                          *
     F*   82       DETAIL REPORT OPEN                                 *
     F*   83       AMEND 'S01496' TO PRINTER OUTPUT                   *   S01496
     F*   84       Corporate Actions is installed.                    *   CSE007
      *   85       US Withholding tax treaty is installed.            *   CSE023
     F*   87       EARLY REDEMPTIONS BLOCK ERROR                      *   S01496
     F*   88       AUTO-CHARGES INDICATOR  ON                         *   S01169
     F*   89       CURRENT TRANSACTION GENERATED BY EARLY REDEMP.     *   S01496
     F*   90-99    USED IN STANDARD SUB-ROUTINES                      *
     F*   U7       DATABASE ERROR                                     *
     F*   U8       DATABASE / CONTROL ERROR                           *
     F*                                                               *
     F*****************************************************************
     F/EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  P001   - CHANGE PROGRAMS FOR 'BLOCK ERROR'                   *   S01496
     F*  ZEVCD  - EVENT CONTROL DATE                                  *
     F***ZSYSTM*-*ACCESS*ICD*RECORD************************************   S01117
     F***ZICD2**-*ACCESS*ICD*RECORD*2**********************************   S01117
     F*  ZDATE1 - DATE - DAYNO CONVERSION                             *
     F*  ZDATE2 - DAYNO - DATE CONVERSION                             *
     F*  ZDAYS  - NO. DAYS BETWEEN TWO DATES                          *
     F*  ZDYYR  - NO. DAYS IN INTEREST YEAR                           *
     F*  ZNCD   - NEXT COUPON DATE                                    *
     F*  ZSEDIT - EDIT NUMERIC FIELDS                                 *
     F*  ZSDESC - FORMAT SECURITY DESCRIPTIONS                        *
     F*  ZCONV  - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER         *
     F*  SRDTCV - Convert date and time                               *                       CSW208
     F*  *PSSR  - ERROR HANDLING                                      *   S01117
     F*                                                               *
     F*****************************************************************
     F/EJECT
     F/COPY WNCPYSRC,SE0325F001
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZDAYSZ1
     E/COPY ZSRSRC,ZPOWER8Z1
     E/COPY ZSRSRC,ZPOWERZ1
     E/COPY ZSRSRC,ZSEDITZ1
     E/COPY ZSRSRC,ZSDESCZ1
     E/COPY ZSRSRC,ZNCDZ1
      ** Array for Depot Destination                                      CSW003
     E                    DEST    1   2 20                                CSW003
      /EJECT
     E/COPY WNCPYSRC,SE0325E001
     I/COPY WNCPYSRC,SE0325I002
     I*                                                                   CAC002
     ISECGTDF                                                             CAC002
     I              PRFC                            PRFCGT                CAC002
     I*                                                                   CAC002
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*DA********UDS                            256                       S01117
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 177 DBASE                 S01117
     ILDA         DS                            256                       S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I              BJURPT                          TITL                  S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR SE ICD DETAILS                                  S01117
     ISDSTRD    E DSSDSTRDPD                                              S01117
     I**                                                                  S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I** EXTERNAL DS FOR PM ICD                                           S01486
     I**                                                                  S01486
     I**  EXTERNAL DS FOR MMOD acces object                               S01486
     ISDMMOD    E DSSDMMODPD                                              S01486
     I**                                                                  S01486
     I**  DATA STRUCTURE FOR RUN DATE DETAILS                             S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*  DS FOR LINE NO. TO HANDLE OVERFLOW                               S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
      ***  For Overflow.                                                  S01401
     I                                    B 188 1890OFLLN1                S01401
     I                                    B 367 3680PRTLN1                S01401
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA STRUCTURE FOR ACCESS OBJECTS, SHORT DATA STRUCTURE          S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I**                                                                  S01117
     I** DATA STRUCTURE FOR ACCESS OBJECTS, LONG DATA STRUCTURE           S01117
     IDSSDY     E DSDSSDY                                                 S01117
     I**                                                                  S01117
     I*
     I           SDS
     I                                      244 246 WSID
     I                                      254 263 USID
     I/COPY ZSRSRC,ZSDESCZ2
     I/COPY ZSRSRC,ZSEDITZ2
     I/COPY ZSRSRC,ZNCDZ2
     I* DATA STRUCTURE FOR FILE KEYS
     I*
     I*********** DS                                                      S01117
     I***********                             1  12 TRKEY                 S01117
     I***********                             1   2 TRRECT                S01117
     I***********                             3   9 TRZZ7                 S01117
     I***********                            10  12 TRTDBR                S01117
     I*
     I            DS
     I                                        1  12 T5KEY
     I                                        1   2 T5RECT
     I                                        3  10 T5ZZ8
     I                                       11  12 T5TSUB
     I*
     I            DS
     I                                        1  12 TLKEY
     I                                        1   2 TLRECT
     I                                        3   7 TLZZ5
     I                                        8  10 TLSETC
     I                                       11  12 TLPAY2
     I*
     I            DS
     I                                        1  12 TKEY
     I                                        1   2 TRECT
     I                                        3   8 TZZ6
     I                                        9  11 TTNMC
     I                                       12  12 TSREC
     I*
     I* DATA STRUCTURE FOR PAY FROM FIELD
     I*
     I            DS
     I**********                              1  12 PYFM                                      CGL029
     I                                        1  18 PYFM                                      CGL029
     I                                        1   6 PYFM06
     I**********                              3  12 PYFM10                             E14497 CGL029
     I**********                              7  10 PYFM04                                    CGL029
     I**********                             11  12 PYFM02                                    CGL029
     I                                        7  16 PYFM04                                    CGL029
     I                                       17  18 PYFM02                                    CGL029
     I                                        3  18 PYFM10                                    CGL029
     I*
     I* DATA STRUCTURE FOR PAY TO FIELD
     I*
     I            DS
     I**********                              1  12 PAYT                                      CGL029
     I                                        1  18 PAYT                                      CGL029
     I                                        1   6 PAYT06
     I**********                              3  12 PAYT10                             E14497 CGL029
     I**********                              7  10 PAYT04                                    CGL029
     I**********                             11  12 PAYT02                                    CGL029
     I                                        7  16 PAYT04                                    CGL029
     I                                       17  18 PAYT02                                    CGL029
     I                                        3  18 PAYT10                                    CGL029
     I            DS                                                                          CSW208
     I                                        1   60PFRTM                                     CSW208
     I                                       11  160PMKTM                                     CSW208
     I                                       21  240PMKTOF                                    CSW208
     I                                       31  360PLCTM                                     CSW208
     I                                       41  440PLCTOF                                    CSW208
     I                                       51  560PSYTM                                     CSW208
     I                                       61  640PSYTOF                                    CSW208
     I*                                                                   S01496
     I** External DS for PM Special customer details                      S01496
     I*                                                                   S01496
     ISDSECS    E DSSDSECSPD                                              S01496
     I              QQACCD                          ACCDQQ                                    CGL029
     I/COPY WNCPYSRC,SE0325I001
     I*                                                                   S01496
     C/EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
      **DEFINE*KEYLIST*FOR*CHAINING*TO*TABLETR*FILE***********************S01117
     C*
     C***********TABTRK    KLIST                                          S01117
     C***********          KFLD           TRKEY                           S01117
      *
      * DEFINE KEYLIST FOR CHAINING TO CLINTCB FILE
      *
     C           CLICBK    KLIST
     C**********           KFLD           CBNUM   60                                          CSD027
     C                     KFLD           CBNUM   6                                           CSD027
     C                     KFLD           CBRCDT  1
      *
      * DEFINE KEYLIST FOR CHAINING TO INVTP FILE
      *
     C           INVTPK    KLIST
     C                     KFLD           NMCY
     C                     KFLD           SITP
      *
      * DEFINE KEYLIST FOR CHAINING TO TABLET5 FILE
      *
     C           TABT5K    KLIST
     C                     KFLD           T5KEY
      *
      * DEFINE KEYLIST FOR CHAINING TO TABLETL FILE
      *
     C           TABTLK    KLIST
     C                     KFLD           TLKEY
      *
      **DEFINE*KEYLIST*FOR*CHAINING*TO*SECHGD*FILE                        S01169
      * DEFINE KEYLIST FOR CHAINING TO SECGTD FILE                        S01169
      *
     C***********SECHGK    KLIST                                          S01169
     C           SECGTK    KLIST                                          S01169
     C                     KFLD           SECCY   3
     C                     KFLD           SECCOM  2
      *
      * DEFINE KEYLIST FOR CHAINING TO TABSE FILE-TABTG10
      *
     C           TABTK     KLIST
     C                     KFLD           TKEY
      *                                                                   CSW003
      * Define keylist for second chain to TRADSDY1                       CSW003
     C           KEY002    KLIST                                          CSW003
     C                     KFLD           TDRF                            CSW003
     C                     KFLD           SWHEN   1                       CSW003
      *                                                                   CSW003
      * PREPARE LDA
      *
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'SE0325'  DBPGM
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C***REGISTER*SPOOL*ENTRY*FOR*AU**                              S01117154670
     C***********          EXSR RCFAU                               S01117154670
     C**                                                                  S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**  TEST FOR MULTIBRANCHING                                         S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     35                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** CHECK SYSTEM FORMAT DATE, DDMMYY OR MMDDYY(98 ON)                S01117
     C           DATF      IFEQ 'M'                                       S01117
     C                     SETON                     98                   S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,SE0325C011
     C*                                                                   S01169
      *                                                                   CSW098
      ** Check to see if switchable feature CSW098 is on or if date is    CSW098
      ** greater than 16 October 1998.                                    CSW098
     C                     CALL 'SWIFT98'              24                 CSW098
     C                     PARM           SWRTN   7                       CSW098
      *                                                                   CSW098
     C           *IN24     IFEQ *ON                        ***************CSW098
     C           *LOCK     IN   LDA                                       CSW098
     C                     Z-ADD15        DBASE            **DB ERROR 015*CSW098
     C                     MOVEL'SE0325'  DBPGM            ***************CSW098
     C                     MOVEL'ERR CALL'DBFILE                          CSW098
     C                     MOVEL'SWIFT98' DBKEY                           CSW098
     C                     OUT  LDA                                       CSW098
     C                     EXSR DBERR                                     CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVE *ON       *IN24                           CSW098
     C                     ELSE                                           CSW098
     C                     MOVE *OFF      *IN24                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
      ***  Access Switchable features file for MT5xx processing.          S01401
      *                                                                   S01401
     C                     MOVE 'N'       S01401                          S01401
     C                     CALL 'AOSARDR0'                                S01401
     C                     PARM *BLANKS   WRTCD   7                       S01401
     C                     PARM '*VERIFY' WOPTN   7                       S01401
     C                     PARM 'S01401'  WSARD   6                       S01401
      *                                                                   S01401
     C           WRTCD     IFEQ *BLANKS                                   S01401
     C                     MOVE 'Y'       S01401  1                       S01401
     C                     OPEN TRADSDY1                                  S01401
     C                     SETON                     30                   S01401
     C                     END                                            S01401
      *                                                                   S01496
      **  Access SAR details file to see if JYSKE Enhcmts is installed.   S01496
      *                                                                   S01496
     C                     CALL 'AOSARDR0'                                S01496
     C                     PARM '       ' @RTCD                           S01496
     C                     PARM '*VERIFY' @OPTN                           S01496
     C                     PARM 'S01496'  WSARD   6                       S01496
      *                                                                   S01496
     C           @RTCD     IFEQ *BLANK                                    S01496
     C                     MOVE 'Y'       S01496  1                       S01496
     C                     MOVE *ON       *IN83                           S01496
     C                     ENDIF                                          S01496
      *                                                                   CSE007
      ***  Access SAR details file to see if Corporate Action is          CSE007
      ***  installed.                                                     CSE007
      *                                                                   CSE007
     C                     MOVE 'N'       CSE007  1                       CSE007
     C                     MOVE *OFF      *IN84                           CSE007
     C                     CALL 'AOSARDR0'                                CSE007
     C                     PARM '       ' @RTCD                           CSE007
     C                     PARM '*VERIFY' @OPTN                           CSE007
     C                     PARM 'CSE007'  WSARD   6                       CSE007
      *                                                                   CSE007
     C           @RTCD     IFEQ *BLANK                                    CSE007
     C                     MOVE 'Y'       CSE007                          CSE007
     C                     MOVE *ON       *IN84                           CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
      *                                                                   CEU017
      ***  Access SAR details file to see if Securities Redenomination is CEU017
      ***  installed.                                                     CEU017
      *                                                                   CEU017
     C                     MOVE 'N'       CEU017  1                       CEU017
     C                     MOVE *OFF      *IN84                           CEU017
     C                     CALL 'AOSARDR0'                                CEU017
     C                     PARM '       ' @RTCD                           CEU017
     C                     PARM '*VERIFY' @OPTN                           CEU017
     C                     PARM 'CEU017'  WSARD   6                       CEU017
      *                                                                   CEU017
     C           @RTCD     IFEQ *BLANK                                    CEU017
     C                     MOVE 'Y'       CEU017                          CEU017
     C                     MOVE *ON       *IN84                           CEU017
     C                     ENDIF                                          CEU017
      *                                                                   CEU017
     C/COPY WNCPYSRC,SE0325C018
      *                                                                                       CER001
      ** Check If feature ULX004 is installed                                                 CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX004  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX004'  @SARD   6                                           CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX004                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Check If feature ULX008 is installed                                                 CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX008  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX008'  @SARD   6                                           CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX008                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CSE035
      **  Access SAR details file to see if CSE035 is switched on                             CSE035
      *                                                                                       CSE035
     C                     MOVE 'N'       CSE035  1                                           CSE035
     C                     CALL 'AOSARDR0'                                                    CSE035
     C                     PARM '       ' @RTCD                                               CSE035
     C                     PARM '*VERIFY' @OPTN                                               CSE035
     C                     PARM 'CSE035'  WSARD                                               CSE035
     C           @RTCD     IFEQ *BLANK                                                        CSE035
     C                     MOVE 'Y'       CSE035                                              CSE035
     C                     ENDIF                                                              CSE035
      *                                                                   CEU005
      **  Access SAR details file to see if EMU switchable feature        CEU005
      **  is installed.                                                   CEU005
      *                                                                   CEU005
     C                     CALL 'AOSARDR0'                                CEU005
     C                     PARM '       ' @RTCD                           CEU005
     C                     PARM '*VERIFY' @OPTN                           CEU005
     C                     PARM 'CEU005'  WSARD   6                       CEU005
      *                                                                   CEU005
     C           @RTCD     IFEQ *BLANK                                    CEU005
     C                     MOVE 'Y'       CEU005  1                       CEU005
     C                     ELSE                                           CEU005
     C                     MOVE 'N'       CEU005                          CEU005
     C                     ENDIF                                          CEU005
      *                                                                   CAC005
      ** Check if CAC005 is installed                                     CAC005
      *                                                                   CAC005
     C                     CALL 'AOSARDR0'                                CAC005
     C                     PARM *BLANKS   PRTCD   7                       CAC005
     C                     PARM '*VERIFY' POPTN   7                       CAC005
     C                     PARM 'CAC005'  PSARD   6                       CAC005
      *                                                                   CAC005
     C           PRTCD     IFEQ *BLANKS                                   CAC005
     C                     MOVE 'Y'       CAC005  1                       CAC005
     C                     ELSE                                           CAC005
     C                     MOVE 'N'       CAC005                          CAC005
     C                     ENDIF                                          CAC005
      *                                                                   CSE023
      ** Access Switchable features file                                  CSE023
      *                                                                   CSE023
     C                     CALL 'AOSARDR0'                                CSE023
     C                     PARM *BLANKS   PRTCD                           CSE023
     C                     PARM '*VERIFY' POPTN                           CSE023
     C                     PARM 'CSE023'  PSARD                           CSE023
      *                                                                   CSE023
     C           PRTCD     IFEQ *BLANKS                                   CSE023
     C                     MOVE 'Y'       CSE023  1                       CSE023
     C                     MOVE *ON       *IN85                           CSE023
     C                     ELSE                                           CSE023
     C                     MOVE 'N'       CSE023                          CSE023
     C                     MOVE *OFF      *IN85                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                                       CGL031
      **  Access SAR details file to see if CGL031 is installed.                              CGL031
      *                                                                                       CGL031
     C                     MOVE 'N'       CGL031  1                                           CGL031
     C                     CALL 'AOSARDR0'                                                    CGL031
     C                     PARM '       ' PRTCD                                               CGL031
     C                     PARM '*VERIFY' POPTN                                               CGL031
     C                     PARM 'CGL031'  PSARD                                               CGL031
      *                                                                                       CGL031
     C           PRTCD     IFEQ *BLANKS                                                       CGL031
     C                     MOVE 'Y'       CGL031                                              CGL031
     C                     ELSE                                                               CGL031
      *                                                                                       CGL031
      ** Database Error                                                                       CGL031
      *                                                                                       CGL031
     C           PRTCD     IFNE '*NRF   '                                                     CGL031
     C           *LOCK     IN   LDA                                                           CGL031
     C                     MOVEL'CGL031 ' DBKEY                                               CGL031
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL031
     C                     Z-ADD17        DBASE                                               CGL031
     C                     OUT  LDA                                                           CGL031
     C                     EXSR DBERR                                                         CGL031
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                      BUG9429
      ** Access SAR details file to see CAS006 is installed                                  BUG9429
      *                                                                                      BUG9429
     C                     CALL 'AOSARDR0'                                                   BUG9429
     C                     PARM *BLANKS   @RTCD                                              BUG9429
     C                     PARM '*VERIFY' @OPTN                                              BUG9429
     C                     PARM 'CAS006'  WSARD                                              BUG9429
      *                                                                                      BUG9429
     C                     MOVE 'N'       CAS006                                             BUG9429
     C                     MOVE '0'       *IN15                                              BUG9429
     C           @RTCD     IFEQ *BLANK                                                       BUG9429
     C                     MOVE 'Y'       CAS006  1                                          BUG9429
     C                     MOVE '1'       *IN15                                              BUG9429
     C                     ELSE                                                              BUG9429
      *                                                                                      BUG9429
      ** Database error (return code other than *NRF or *BLANK)                              BUG9429
      *                                                                                      BUG9429
     C           @RTCD     IFNE '*NRF   '                                                    BUG9429
     C           *LOCK     IN   LDA                                                          BUG9429
     C                     MOVEL'SCSARDPD'DBFILE                                             BUG9429
     C                     MOVEL'CAS006'  DBKEY                                              BUG9429
     C                     Z-ADD9         DBASE                                              BUG9429
     C                     OUT  LDA                                                          BUG9429
     C                     MOVE *ON       *INU7                                              BUG9429
     C                     MOVE *ON       *INU8                                              BUG9429
     C                     MOVE *ON       *INLR                                              BUG9429
     C                     EXSR *PSSR                                                        BUG9429
     C                     ENDIF                                                             BUG9429
     C                     ENDIF                                                             BUG9429
     C**                                                                  S01117
     C** INITIALISE VARIABLE                                              S01117
     C                     MOVE *BLANKS   ZBRNM                           S01117
     C**                                                                  S01117
      *
      * INPUT PARAMETER :
      *
     C           *ENTRY    PLIST
     C                     PARM           MODE    1
     C                     PARM           SEQ     5                       S01117
     C                     PARM           ENT     3                       S01117
      * DEFINE WORK FIELDS
      *
     C************LIKE     DEFN LCD       ZLCD                            100228
     C           *LIKE     DEFN LCD       XLCD                            100228
     C           *LIKE     DEFN CHTP      ZCHTP
     C           *LIKE     DEFN TNLU      ZTNLU
     C           *LIKE     DEFN SINS      ZINS
     C           *LIKE     DEFN SAMD      ZAMD
     C           *LIKE     DEFN SDEL      ZDEL
     C*                                                                   S01486
     C** IF PM PRESENT SET IN39 ON                                        S01486
     C                     CALL 'AOMMODR0'                                S01486
     C                     PARM *BLANKS   @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
     C*                                                                   S01486
     C           @RTCD     IFNE *BLANK                                    S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL'AOMMODR0'DBFILE                          S01486
     C                     MOVEL@OPTN     DBKEY            ***************S01486
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR  13 *S01486
     C                     Z-ADD13        DBASE            ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR DBERR                                     S01486
     C                     END                                            S01486
      *                                                                   CAC002
      **  Set up analytical accounting indicator                          CAC002
      *                                                                   CAC002
     C           BGN0ST    IFEQ 'Y'                                       CAC002
     C                     MOVE '1'       *IN19                           CAC002
     C                     ELSE                                           CAC002
     C                     MOVE '0'       *IN19                           CAC002
     C                     ENDIF                                          CAC002
     C*                                                                   S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C                     MOVE *ON       *IN39                           S01486
     C                     ELSE                                           S01486
     C                     MOVE *OFF      *IN39                           S01486
     C                     ENDIF                                          S01486
      *                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVE *ON       *IN32                           CPB001
     C                     ELSE                                           CPB001
     C                     MOVE *OFF      *IN32                           CPB001
     C                     ENDIF                                          CPB001
      *                                                                   S01486
      * OBTAIN PORTFOLIO MANAGEMENT ICD                                   S01486
      *                                                                   S01486
     C           *IN39     IFEQ *ON                                       S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM *BLANKS   @RTCD                           S01486
     C                     PARM '*FIRST'  @OPTN                           S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C*                                                                   S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C                     Z-ADD12        DBASE            **DB ERROR 12**S01486
     C                     MOVEL'AOPORT'  DBFILE                          S01486
     C                     MOVE *BLANKS   DBKEY                           S01486
     C                     WRITEHEADAU                                    S01486
     C                     WRITEERROR                                     S01486
     C                     GOTO ENDPGM                                    S01486
     C                     END                                            S01486
     C                     END                                            S01486
      *                                                                                       CSW201
      ** Check if enhancement CSW201 is on                                                    CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'             29                                     CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
      *                                                                                       CSW201
     C           *IN29     IFEQ '1'                                                           CSW201
     C           *LOCK     IN   LDA                                                           CSW201
     C                     Z-ADD16        DBASE                                               CSW201
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW201
     C                     MOVEL'SWIF2001'DBKEY                                               CSW201
     C                     OUT  LDA                                                           CSW201
     C                     EXSR DBERR                                                         CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     MOVE '1'       *IN29                                               CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     MOVE '0'       *IN29                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW208
      ** Check if enhancement CSW208 is on                                                    CSW208
      *                                                                                       CSW208
     C                     CALL 'SWIF2008'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
     C           @RTCD     IFEQ 'CSW2008'                                                     CSW208
     C                     MOVE 'Y'       CSW208  1                                           CSW208
     C                     ELSE                                                               CSW208
     C                     MOVE 'N'       CSW208                                              CSW208
     C                     ENDIF                                                              CSW208
     C/EJECT
      *================================================================
      *  FIRST TIME PROCESSING
      *================================================================
      *
      * SET INDICATORS FOR REPORT HEADING & OPEN INPUT FILE
     C           MODE      IFEQ 'I'
     C                     SETON                     40
     C                     ELSE
     C           MODE      IFEQ 'A'
     C                     SETON                     41
     C                     ELSE
     C                     SETON                     42
     C                     END
     C                     END
     C**                                                                  S01117
     C** INITIALISE OUTPUT ENTITY FIELDS BY INPUT PARAMETER               S01117
     C                     MOVE ENT       TDBA                            S01117
     C                     MOVE ENT       ZTDBA                           S01117
     C**                                                                  S01117
     C**   ACCESS BANK DETAILS, FOR TITLE                                 S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBANKPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01117
     C                     Z-ADD1         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,SE0325C001
     C**                                                                  S01117
     C**   ACCESS GENERAL LEDGER DETAILS FOR PROFIT CENTRE IND.           S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDGELRPD'DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN           * DBERROR 002 *S01117
     C                     Z-ADD2         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** CHECK IF PROFIT CENTRE USED                                      S01117
     C           BKPRCU    IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN37                           S01117
     C                     END                                            S01117
      *                                                                   S01117
     C** CHECK IF ORIGINATING BRANCH USED                                 S01117
     C           BKOBRU    IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN38                           S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,SE0325C002
      *
      *
      **GET*INSTALLATION*CONTROL*DATA*RECORD*1****************************S01117
      *
     C***********          EXSR ZSYSTM                                    S01117
      *
      **ERROR*IN*ZSYSTM***************************************************S01117
      *
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C***********          END                                            S01117
     C/COPY WNCPYSRC,SE0325C003
      *
      *
      **GET*INSTALLATION*CONTROL*DATA*RECORD*2****************************S01117
      *
     C***********          EXSR ZICD2                                     S01117
      *
      **ERROR*IN*ZICD2****************************************************S01117
      *
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'02'      DBASE            **DB ERROR 02**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C***********          END                                            S01117
     C*
      *                                                                   S01169
      ***Chain*to*TABTB36*************************************** **S01169 S01117
     C***********          EXSR ZICDSE                             S01169 S01117
     C************IN,99    IFEQ '1'                                S01169 S01117
     C***********          MOVEL'03'      DBASE      **DB*ERROR*03**S01169E20651
     C***********          MOVEL'08'      DBASE      **DB ERROR 08**E20651S01117
     C**   ACCESS SE ICD DETAILS                                          S01117
     C                     CALL 'AOSTRDR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDSTRD    PARM SDSTRD    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD8         DBASE            **DB ERROR 08**S01117
     C***********          MOVEL'TABLE'   DBFILE                  S01169  S01117
     C***********          MOVELZTABKY    DBKEY                   S01169  S01117
     C                     MOVEL'SDSTRDPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                             S01169 S01117
     C***********          WRITEERROR                              S01169 S01117
     C***********          WRITETRAILAU                            S01169 S01117
     C***********          GOTO ENDPGM                             S01169 S01117
     C                     END                                            S01169
     C*                                                                   S01169
      *  IF AUTO-CHARGES INDICATOR = 'Y'   SET ON *IN88                   S01169
      *                                                                   S01169
     C***********AUMO      IFEQ 'Y'                               S01169  S01117
     C           BVACOP    IFEQ 'Y'                               S01169  S01117
     C                     SETON                     88                   S01169
     C                     END                                            S01169
      *                                                                   S01169
      *                                                                   S01169
     C*  GET EVENT CONTROL DATE
     C*
     C                     Z-ADDBJDNWD    ZZDNWD                          S01117
     C                     Z-ADDBKAPDT    ZZAPDT                          S01117
     C                     EXSR ZEVCD
      *
     C                     OPEN TRDIP
     C                     Z-ADD1         MAXCNT  20
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCPG                                           S01408
     C*                                                                   S01408
     C/SPACE 3
      *================================================================
      *  M A I N   P R O C E S S I N G
      *================================================================
     C/COPY WNCPYSRC,SE0325C012
      *
      *
     C                     READ TRDIP                    50
     C                     MOVE RECI      TRECI   1                       S01269
     C** CHECK FOR REQUESTED BRANCH FOR MULTIBRANCHING                    S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ENT       IFNE 'ALL'                                     S01117
     C           ENT       ANDNETDBA                                      S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     MOVE '1'       *IN80                           S01117
     C                     GOTO ENDSEL                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *
     C           *IN50     DOWNE'1'
      *
      * A RECORD HAS BEEN READ :-
     C/COPY WNCPYSRC,SE0325C009
      *
      * MOVE DATA INTO UNIQUE FIELDS
      *
     C***********          Z-ADDLCD       ZLCD                            100228
     C                     Z-ADDLCD       XLCD                            100228
     C                     MOVE CHTP      ZCHTP
     C                     Z-ADDTNLU      ZTNLU
      *                                                                   CEU005
      * Display 'In' Ccy field if CEU005 active, trade is purchase and    CEU005
      * settlement ccy is in Euros                                        CEU005
     C           CEU005    IFEQ 'Y'                                       CEU005
     C           TDTP      ANDEQ'TP'                                      CEU005
     C           SETC      ANDEQBKEURO                                    CEU005
     C                     MOVE *ON       *IN33                           CEU005
     C                     ELSE                                           CEU005
     C                     MOVE *OFF      *IN33                           CEU005
     C                     ENDIF                                          CEU005
      *                                                                   CEU005
      *
      * IF PARM=I & LAST CHANGE DATE NOT = RUN DATE - IGNORE
     C           MODE      IFEQ 'I'
     C***********ZLCD      IFNE RUND                                      100228
     C           XLCD      IFNE RUND                                      100228
     C                     GOTO NEXT
     C                     END
     C                     END
      *
      * MAINTAIN COUNTS AS NECESSARY
     C           MODE      IFEQ 'I'
     C           MODE      OREQ 'A'
      *
      **  IF RUN DATE IS THE SAME AS LAST CHANGE DATE
      *
     C***********ZLCD      IFEQ RUND                                      100228
     C           XLCD      IFEQ RUND                                      100228
      *
      ** I OR A MODES - INCLUDE DELETED RECORDS
      **   - FOR RECORDS CHANGED TODAY
      *
     C           ZCHTP     IFEQ 'I'
     C                     ADD  1         ZINS
     C                     ELSE
     C           ZCHTP     IFEQ 'A'
     C                     ADD  1         ZAMD
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     ADD  1         ZDEL
     C                     ELSE
     C           ZCHTP     IFEQ 'C'
     C                     ADD  1         ZTRDA
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      * I MODE - COUNT OF RECORDS CHANGED TODAY
     C           MODE      IFEQ 'I'
     C***********ZLCD      IFEQ RUND                                      100228
     C           XLCD      IFEQ RUND                                      100228
     C                     ADD  1         ZCHG
     C                     ADD  1         ZCHGP1
     C                     END
     C                     ELSE
      * A MODE -
     C           MODE      IFEQ 'A'
      * A MODE - COUNT OF RECORDS READ + LIVE RECORDS
     C           RECI      IFNE '*'
     C                     ADD  1         ZLIVE
     C                     END
     C***********ZLCD      IFEQ RUND                                      100228
     C           XLCD      IFEQ RUND                                      100228
     C                     ADD  1         ZCOUNT
     C                     ELSE
      *        - IGNORE IF LCD NOT EQUAL RUN DATE
     C                     GOTO NEXT
     C                     END
      *
     C                     ELSE
      * L MODE - COUNT OF LIVE RECORDS
     C           RECI      IFNE '*'
     C                     ADD  1         ZLIVE
     C                     ADD  1         ZLIVP1
     C                     ELSE
      * L MODE - IGNORE IF DELETED RECORD
     C                     GOTO NEXT
     C                     END
     C                     END
     C                     END
      *
      * RECORD TO BE PRINTED -
      *     OPEN OUTPUT FILE IF REQUIRED FIRST TIME ONLY
     C           *IN82     IFEQ '0'
     C                     SETON                     82
     C                     Z-ADD2         LINCNT  20
     C                     OPEN SE0325P1
     C                     EXSR RCFP1                                     S01117
     C                     MOVE TDBA      ZTDBA                           S01117
      *
      ******FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY****************S01117
      ******IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK*********************S01117
     C***********          MOVEL'10      'TRKEY                           S01117
     C***********          MOVE TDBR      TRTDBR                          S01117
     C***********TABTRK    CHAINTABLETRF             57                   S01117
     C************IN57     IFEQ '1'                                       S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE BRNM      ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C**                                                                  S01117
     C                     SETOF                     80
     C**                                                                  S01117
     C** FOR MULTIBRANCHING, ACCESS BRANCH NAME WITH ACCESS OBJECT        S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE TDBA      PENT    3                       S01117
     C                     EXSR ACCBRH                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE
      ** OPEN OUTPUT FILE IF REQUIRED NEW BRANCH
     C           *IN80     IFEQ '1'
     C                     Z-ADD2         LINCNT
     C                     Z-ADD0         PAGE
     C                     OPEN SE0325P1
     C                     EXSR RCFP1                                     S01117
     C                     MOVE TDBA      ZTDBA                           S01117
      *
      ******FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY****************S01117
      ******IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK*********************S01117
     C***********          MOVEL'10      'TRKEY                           S01117
     C***********          MOVE TDBR      TRTDBR                          S01117
     C***********TABTRK    CHAINTABLETRF             57                   S01117
     C************IN57     IFEQ '1'                                       S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE BRNM      ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C**                                                                  S01117
     C                     SETOF                     80
     C**                                                                  S01117
     C** FOR MULTIBRANCHING, ACCESS BRANCH NAME WITH ACCESS OBJECT        S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE TDBA      PENT                            S01117
     C                     EXSR ACCBRH                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END
     C                     END
      *
      **  PRINT PAGE HEADINGS
     C           LINCNT    IFGE MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
      *                                                                   CAC005
      ** If CAC005 is installed, retrieve the user book                   CAC005
      ** TDBK in Trades file is being held as a pseudo book               CAC005
      *                                                                   CAC005
     C           CAC005    IFEQ 'Y'                                       CAC005
     C                     CALL 'AOBKPCR0'                                CAC005
     C                     PARM *BLANKS   PRTCD                           CAC005
     C                     PARM '*USER  ' POPTN                           CAC005
     C                     PARM           PBKCD   2                       CAC005
     C                     PARM           PPRFC   4                       CAC005
     C                     PARM TDBK      PPSBK   2                       CAC005
      *                                                                   CAC005
     C           PRTCD     IFEQ *BLANKS                                   CAC005
     C                     MOVE PBKCD     TDBK                            CAC005
     C                     ENDIF                                          CAC005
     C                     ENDIF                                          CAC005
      *
      * FORMAT OUTPUT & PRINT FOR PRINTER FILE
      *
      * TOP DATA     ***
      * FORMAT  CUSTOMER REPORT NAME/TOWN FOR COUNTERPARTY CUSTOMER NO.
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C**********           Z-ADDTCNR      CBNUM                                               CSD027
     C                     MOVE TCNR      CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '1'
     C                     MOVE *BLANK    CRNMC
     C                     MOVE *BLANK    CTWNC
     C                     ELSE
     C           RECI      IFNE '*'
     C                     MOVE CRNM      CRNMC
     C                     MOVE CTWN      CTWNC
     C                     ELSE
     C                     MOVE *BLANK    CRNMC
     C                     MOVE *BLANK    CTWNC
     C                     END
     C                     END
      *
      * FORMAT SECURITY SHORTNAME / DESCRIPTION
     C           TDSS      CHAINSECTYDF              59
     C           *IN59     IFEQ '0'
     C           RECI      IFEQ '*'
     C                     SETON                     59
     C                     END
     C                     END
     C           *IN59     IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C**********           MOVEL'03'      DBASE            **DB*ERROR*03**E20651
     C***********          MOVEL'09'      DBASE            **DB ER E20651 S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD9         DBASE            * DB ERROR 09 *S01117
     C                     MOVEL'SECTY'   DBFILE
     C                     MOVELTDSS      DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
     C/COPY WNCPYSRC,SE0325C016
      **  PREPARE FIELDS FOR REPORT NAME
     C                     MOVE SRPN      ZSRPN
     C                     MOVE *BLANK    ZSFN1
     C                     MOVE *BLANK    ZSFN2
     C                     MOVE BVRIDF    ZRSFD                           S01117
      **  ZSDESC REPORT NAME
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     RNME
      *
      * ACCESS INVESTMENT TYPE FOR PROCESSING TYPE
     C           INVTPK    CHAININVTPDF              59
     C           *IN59     IFEQ '0'
     C           RECI      ANDEQ'*'
     C                     SETON                     59
     C                     END
     C           *IN59     IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'04'      DBASE            **DB ERROR 04**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD4         DBASE            **DB ERROR 04**S01117
     C                     MOVEL'INVTP'   DBFILE
     C                     MOVELNMCY      KINVTP  6
     C                     MOVE SITP      KINVTP
     C                     MOVELKINVTP    DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *
      * FORMAT TRADE TYPE LEGEND
     C/COPY WNCPYSRC,SE0325C022
     C                     MOVE *BLANK    LTDTP   8
     C/COPY WNCPYSRC,SE0325C023
     C           TDTP      IFEQ 'TP'
     C                     MOVEL'PURCHASE'LTDTP
     C                     ELSE
     C           TDTP      IFEQ 'TS'
     C                     MOVEL'SALE'    LTDTP
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0325C028
      *
      * FORMAT BOOK NAMES-READ BOOKD FILE USING KEY -
      *    IF NO RECORD/RECORD DELETED - PRINT BLANK
     C           TDBK      CHAINBOOKDDF              56
     C           *IN56     IFEQ '1'
     C                     MOVE *BLANK    ZBOKD
     C                     ELSE
     C           RECI      IFNE '*'
     C                     MOVE BOKD      ZBOKD
     C                     ELSE
     C                     MOVE *BLANK    ZBOKD
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0325C024
      *
      * FORMAT TRADE SUB TYPE NAME - TABLET5 FILE USING KEY
      *    IF NO RECORD/RECORD DELETED - PRINT BLANK
      *
     C                     MOVE '42'      T5RECT
     C                     MOVE TSUB      T5TSUB
     C           TABT5K    CHAINTABLET5F             60
     C           *IN60     IFEQ '1'
     C                     MOVE *BLANK    ZDSNM
     C                     ELSE
     C           RECI      IFNE '*'
     C                     MOVE DSNM      ZDSNM
     C                     ELSE
     C                     MOVE *BLANK    ZDSNM
     C                     END
     C                     END
      *
      * FORMAT MARKET INDICATOR LEGEND
     C                     MOVE *BLANK    LTDMI   9
     C           TDMI      IFEQ 'G'
     C                     MOVEL'GREY'    LTDMI
     C                     ELSE
     C           TDMI      IFEQ 'P'
     C                     MOVEL'PRIMARY' LTDMI
     C                     ELSE
     C           TDMI      IFEQ 'S'
     C                     MOVEL'SECOND'  LTDMI
     C                     MOVE 'ARY'     LTDMI
     C                     END
     C                     END
     C                     END
      *                                                                   S01269
      * FORMAT AUTHORISATION STATUS                                       S01269
     C***********AUTT      IFNE '00'                              S01269  S01117
     C           BVAUTH    IFNE '00'                              S01269  S01117
     C                     SETON                     10                   S01269
     C           TRECI     IFEQ 'D'                                       S01269
     C           TRECI     OREQ 'A'                                       S01269
     C           TRECI     OREQ 'S'                                       S01269
     C                     MOVEL'AUTHORIS'AUT1   10                       S01269
     C                     MOVE 'ED'      AUT1                            S01269
     C                     MOVE *BLANK    AUTST                           S01269
     C                     MOVELAUT1      AUTST                           S01269
     C                     ELSE                                           S01269
     C           TRECI     IFEQ 'L'                                       S01269
     C           TRECI     OREQ 'P'                                       S01269
     C           TRECI     OREQ 'R'                                       S01269
     C                     MOVEL'AWAITING'AUT2   16                       S01269
     C                     MOVE ' AUTHORI'AUT2                            S01269
     C                     MOVELAUT2      AUT3   22                       S01269
     C                     MOVE 'SATION'  AUT3                            S01269
     C                     MOVE *BLANK    AUTST                           S01269
     C                     MOVELAUT3      AUTST                           S01269
     C                     ELSE                                           S01269
     C           TRECI     IFEQ 'C'                                       S01269
     C           TRECI     OREQ '*'                                       S01269
     C                     MOVEL'CANCELLE'AUT2   16                       S01269
     C                     MOVE 'D-AUTHOR'AUT2                            S01269
     C                     MOVELAUT2      AUT4   20                       S01269
     C                     MOVE 'ISED'    AUT4                            S01269
     C                     MOVE *BLANK    AUTST                           S01269
     C                     MOVELAUT4      AUTST                           S01269
     C                     ELSE                                           S01269
     C           TRECI     IFEQ 'D'                                       S01269
     C                     MOVEL'CANCELLE'AUT2   16                       S01269
     C                     MOVE 'D-AWAITI'AUT2                            S01269
     C                     MOVELAUT2      AUT5   24                       S01269
     C                     MOVE 'NG AUTHO'AUT5                            S01269
     C                     MOVELAUT5      AUT6   32                       S01269
     C                     MOVE 'RISATION'AUT6                            S01269
     C                     MOVE *BLANK    AUTST                           S01269
     C                     MOVELAUT6      AUTST                           S01269
     C                     END                                            S01269
     C                     END                                            S01269
     C                     END                                            S01269
     C                     END                                            S01269
     C                     END                                            S01269
      *
      * FORMAT NOMINAL
     C                     MOVE *BLANKS   ZFLD15
     C                     Z-ADDTNMD      ZDECS
     C                     MOVE NOML      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZENOML 16
      *
      * FORMAT TRADE DATE
     C                     Z-ADDTDDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZATDDT
      *
      * FORMAT VALUE DATE
     C                     Z-ADDTDVD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZATDVD
      *
      * FORMAT PRICE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE PRIC      ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEPRIC 17
      *                                                                                      BUG9429
     C           CAS006    IFEQ 'Y'                                                          BUG9429
      * FORMAT CREDIT RISK                                                                   BUG9429
     C                     MOVE *BLANKS   ZFLD15                                             BUG9429
     C                     MOVE CRSK      ZFLD15                                             BUG9429
     C                     Z-ADD8         ZDECS                                              BUG9429
     C                     MOVE 'L'       ZECODE                                             BUG9429
     C                     EXSR ZSEDIT                                                       BUG9429
     C                     MOVE ZOUT21    RCRSK  17                                          BUG9429
      *                                                                                      BUG9429
      * FORMAT LIQUIDITY PREMIUM                                                             BUG9429
     C                     MOVE *BLANKS   ZFLD15                                             BUG9429
     C                     MOVE LQPR      ZFLD15                                             BUG9429
     C                     Z-ADD8         ZDECS                                              BUG9429
     C                     MOVE 'L'       ZECODE                                             BUG9429
     C                     EXSR ZSEDIT                                                       BUG9429
     C                     MOVE ZOUT21    RLQPR  17                                          BUG9429
     C                     ENDIF                                                             BUG9429
      *                                                                                       CGL031
      ** Format Fiscal Price print input if CGL031 is switched on.                            CGL031
      *                                                                                       CGL031
     C                     MOVE *OFF      *IN18                                               CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
      *****************************************************************                CGL031 235575
      ***Display*prices*if*Funds*or*Bonds******************************                CGL031 235575
      *****************************************************************                CGL031 235575
     C********** PROT      IFEQ '7'                                                    CGL031 235575
     C********** PROT      ORNE '4'                                                    CGL031 235575
     C********** PROT      ANDNE'2'                                                    CGL031 235575
     C********** PROT      ANDNE'7'                                                    CGL031 234000
     C********** ISSP      ANDLT100                                                    CGL031 234000
      *                                                                                       235575
      ***Display*prices*if*EU*Taxes*apply.*****************************                235575 234675
      ** Display prices if Subject to EU Tax is 'Y'                                           234675
      *                                                                                       235575
     C********** PROT      IFNE '4'                                                    235575 234675
     C********** PROT      ANDNE'2'                                                    235575 234675
     C********** PROT      OREQ '4'                                                    235575 234675
     C********** SETX      ANDEQ'Y'                                                    235575 234675
     C           SETX      IFEQ 'Y'                                                           234675
     C                     MOVE *ON       *IN18                                               CGL031
      *                                                                                       CGL031
      ** Format Fiscal Price                                                                  CGL031
      *                                                                                       CGL031
     C**********           MOVE FSPP      ZFLD15                                       CGL031 233776
     C                     MOVE FSPR      ZFLD15                                              233776
     C                     Z-ADD8         ZDECS                                               CGL031
     C                     MOVE 'L'       ZECODE                                              CGL031
     C                     EXSR ZSEDIT                                                        CGL031
     C                     MOVE ZOUT21    RFSPP                                               CGL031
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
      *
      * FORMAT SETTLEMENT LEGEND
     C                     MOVEL*BLANK    LSMTH  14
      *
     C           SMTH      IFEQ 01
     C                     MOVEL'NOSTRO'  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 02
     C                     MOVEL'CHEQ.SEN'LSMTH
     C                     MOVE 'T     '  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 03
     C                     MOVEL'COMPENS.'LSMTH
     C                     MOVE 'SUSP. '  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 04
     C                     MOVEL'PRIME RE'LSMTH
     C                     MOVE 'T.A/C '  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 05
     C                     MOVEL'SPECIFIE'LSMTH
     C                     MOVE 'D A/C '  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 06
     C                     MOVEL'COMPUTER'LSMTH
     C                     MOVE ' SUSP.'  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 07
     C                     MOVEL'CHIPS'   LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 08
     C                     MOVEL'SWIFT'   LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 12
     C                     MOVEL'CHEQ.COL'LSMTH
     C                     MOVE 'LECTED'  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 14
     C                     MOVEL'RETAIL A'LSMTH
     C                     MOVE '/C    '  LSMTH
     C                     ELSE
      *
     C           SMTH      IFEQ 15
     C                     MOVEL'NOMINATE'LSMTH
     C                     MOVE 'D A/C '  LSMTH
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      *
      * FORMAT PAY FROM DEPENDING ON SETTLEMENT METHOD
     C**********           MOVE *BLANK    ZPYF14 14                                           CGL029
     C**********           MOVE *BLANK    ZPYF12 12                                           CGL029
     C                     MOVE *BLANK    ZPYF14 20                                           CGL029
     C                     MOVE *BLANK    ZPYF12 18                                           CGL029
      *
      *    FORMAT NNNNNN-NN-NNNN FOR SETTLEMENT CODE 05
      *    AND FOR SETTLEMENT CODE 15.                                    E20012
     C           SMTH      IFEQ 05
     C           SMTH      OREQ 15                                        E20012
     C*                                                                   E33879
     C** ONLY FORMAT IF NOT BLANKS                                        E33879
     C*                                                                   E33879
     C           PYFM      IFNE *BLANKS                                   E33879
     C                     SETON                     34                   E33879
     C                     MOVELPYFM06    ZPYF07  7
     C                     MOVE '-'       ZPYF07
      *
     C**********           MOVELPYFM04    ZPYF05  5                                           CGL029
     C                     MOVELPYFM04    ZPYF05 11                                           CGL029
     C                     MOVE '-'       ZPYF05
      *
     C                     MOVELZPYF07    ZPYF12
     C                     MOVE ZPYF05    ZPYF12
      *
     C                     MOVELZPYF12    ZPYF14
     C                     MOVE PYFM02    ZPYF14
     C                     ELSE                                           E33879
     C                     SETOF                     34                   E33879
     C                     END                                            E33879
     C*                                                                   E33879
     C                     ELSE
      *    FORMAT SETTLEMENT METHODS 01 02 07 08 12
     C           SMTH      IFEQ 01
      *
     C           SMTH      OREQ 02
      *
     C           SMTH      OREQ 07
      *
     C           SMTH      OREQ 08
      *
     C           SMTH      OREQ 12
      *
      *    IF A SALE, DON'T ASSUME PAY FROM IS A 2-DIGIT NOSTRO.          E14497
     C           TDTP      IFEQ 'TP'                                      E14497
     C           TDTP      OREQ 'TS'                                      E14497
     C           PYFM10    ANDEQ*BLANKS                                   E14497
      *
      *    TABLETL FILE USING KEY
      *    IF NO RECORD/RECORD DELETED - PRINT PYFM NOT SHORTNAME
      *
     C                     MOVE '70'      TLRECT
     C                     MOVE SETC      TLSETC
     C                     MOVELPYFM      TLPAY2
     C           TABTLK    CHAINTABLETLF             61
     C           *IN61     IFEQ '1'
     C                     MOVELPYFM      ZPYF14
     C                     ELSE
     C           RECI      IFEQ '*'
     C                     MOVELPYFM      ZPYF14
     C                     ELSE
      *
      * FORMAT CUSTOMER SHORT NAME
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT PYFM NOT SHORTNAME
     C**********           Z-ADDCNUM      CBNUM                                               CSD027
     C                     MOVE CNUM      CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '1'
     C                     MOVELPYFM      ZPYF14
     C                     ELSE
     C           RECI      IFEQ '*'
     C                     MOVELPYFM      ZPYF14
     C                     ELSE
     C                     MOVELTLPAY2    ZPYF12
     C                     MOVE CSNM      ZPYF12
     C                     MOVELZPYF12    ZPYF14
     C                     END
     C                     END
     C                     END
     C                     END
      *
      *    IF SALE AND PYFM LONGER THAN 2 CHARACTERS, HAVE A SHORTNAME    E14497
      *    OR A CUSTOMER NUMBER.                                          E14497
     C                     ELSE                                           E14497
     C**********           MOVE PYFM06    PYNUM   60                                   E14497 CSD027
     C**********           Z-ADDPYNUM     CBNUM                                        E14497 CSD027
     C                     MOVE PYFM06    PYNUM   6                                           CSD027
     C                     MOVE PYNUM     CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT                          E14497
     C           CLICBK    CHAINCLINTCBF             58                   E14497
     C************IN58     IFEQ '0'                                 E14497E20013
     C           *IN58     IFEQ '1'                                       E20013
     C                     MOVELPYFM      ZPYF14                          E14497
     C                     ELSE                                           E14497
     C                     MOVE CSNM      ZPYF12                          E14497
     C                     MOVELZPYF12    ZPYF14                          E14497
     C                     END                                            E14497
     C                     END                                            E14497
      *
      *    CATCH ALL - ANY OTHER SETTLEMENT CODES
     C                     ELSE
     C                     MOVELPYFM      CBNUM
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '0'
     C                     MOVELCSNM      ZPYF14
     C                     ELSE
     C                     MOVELPYFM      ZPYF14
     C                     END
      *
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0325C025
      *
      * FORMAT PAY TO DEPENDING ON SETTLEMENT METHOD
     C**********           MOVE *BLANK    ZPYT14 14                                           CGL029
     C**********           MOVE *BLANK    ZPYT12 12                                           CGL029
     C                     MOVE *BLANK    ZPYT14 20                                           CGL029
     C                     MOVE *BLANK    ZPYT12 18                                           CGL029
      *
      *    FORMAT NNNNNN-NN-NNNN FOR SETTLEMENT CODE 05
      *    AND FOR SETTLEMENT CODE 15.                                    E20012
     C           SMTH      IFEQ 05
     C           SMTH      OREQ 15                                        E20012
     C                     MOVELPAYT06    ZPYT07  7
     C                     MOVE '-'       ZPYT07
      *
     C**********           MOVELPAYT04    ZPYT05  5                                           CGL029
     C                     MOVELPAYT04    ZPYT05 11                                           CGL029
     C                     MOVE '-'       ZPYT05
      *
     C                     MOVELZPYT07    ZPYT12
     C                     MOVE ZPYT05    ZPYT12
      *
     C                     MOVELZPYT12    ZPYT14
     C                     MOVE PAYT02    ZPYT14
     C                     ELSE
      *
      **   FORMAT SETTLEMENT METHODS 01 02 07 08 12
     C           SMTH      IFEQ 01
     C           SMTH      OREQ 02
     C           SMTH      OREQ 07
     C           SMTH      OREQ 08
     C           SMTH      OREQ 12
      *
      *    IF A PURCHASE, DON'T ASSUME PAYT IS A 2-DIGIT NOSTRO.          E14497
      *                                                                   E14497
     C           TDTP      IFEQ 'TS'                                      E14497
     C           TDTP      OREQ 'TP'                                      E14497
     C           PAYT10    ANDEQ*BLANKS                                   E14497
      *
      *    TABLETL FILE USING KEY
      *    IF NO RECORD/RECORD DELETED - PRINT PYFM NOT SHORTNAME
      *
     C                     MOVE '70'      TLRECT
     C                     MOVE SETC      TLSETC
     C                     MOVELPAYT      TLPAY2
     C           TABTLK    CHAINTABLETLF             61
     C           *IN61     IFEQ '1'
     C                     MOVELPAYT      ZPYT14
     C                     ELSE
     C           RECI      IFEQ '*'
     C                     MOVELPAYT      ZPYT14
     C                     ELSE
      *
      * FORMAT CUSTOMER SHORT NAME
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT PYFM NOT SHORTNAME
     C**********           Z-ADDCNUM      CBNUM                                               CSD027
     C                     MOVE CNUM      CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '1'
     C                     MOVELPAYT      ZPYT14
     C                     ELSE
     C           RECI      IFEQ '*'
     C                     MOVELPAYT      ZPYT14
     C                     ELSE
     C                     MOVELTLPAY2    ZPYT12
     C                     MOVE CSNM      ZPYT12
     C                     MOVELZPYT12    ZPYT14
     C                     END
     C                     END
     C                     END
     C                     END
      *                                                                   E14497
      *    IF PURCHASE AND PAYT LONGER THAN 2 CHARACTERS, HAVE A          E14497
      *    SHORTNAME OR A CUSTOMER NUMBER.                                E14497
      *                                                                   E14497
     C                     ELSE                                           E14497
      *                                                                   E14497
     C**********           MOVE PAYT06    PTNUM   60                                   E14497 CSD027
     C**********           Z-ADDPTNUM     CBNUM                                        E14497 CSD027
     C                     MOVE PAYT06    PTNUM   6                                           CSD027
     C                     MOVE PTNUM     CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT                          E14497
     C           CLICBK    CHAINCLINTCBF             58                   E14497
     C           *IN58     IFEQ '1'                                       E14497
     C                     MOVELPAYT      ZPYT14                          E14497
     C                     ELSE                                           E14497
     C                     MOVE CSNM      ZPYT12                          E14497
     C                     MOVELZPYT12    ZPYT14                          E14497
     C                     END                                            E14497
      *                                                                   E14497
     C                     END                                            E14497
      *    CATCH ALL - ANY OTHER SETTLEMENT CODES
     C                     ELSE
     C                     MOVELPAYT      CBNUM
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '0'
     C                     MOVELCSNM      ZPYT14
     C                     ELSE
     C                     MOVELPAYT      ZPYT14
     C                     END
      *
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE0325C026
      *
      * FORMAT CLEARANCE TYPE LEGEND
     C                     SETOF                     646566
     C                     SETOF                     676869
     C           CLTY      IFEQ '0'
     C                     SETON                     64
     C                     ELSE
     C           CLTY      IFEQ '1'
     C                     SETON                     65
     C                     ELSE
     C           CLTY      IFEQ '2'
     C                     SETON                     66
     C                     ELSE
     C           CLTY      IFEQ '3'
     C                     SETON                     67
     C                     ELSE
     C           CLTY      IFEQ '4'
     C                     SETON                     68
     C                     ELSE
     C           CLTY      IFEQ '5'
     C                     SETON                     69
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      * FORMAT DELIVER TO SHORTNAME
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C**********           Z-ADDDELT      CBNUM                                               CSD027
     C                     MOVE DELT      CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '1'
     C                     MOVE *BLANK    CSNMDT
     C                     ELSE
     C           RECI      IFNE '*'
     C                     MOVE CSNM      CSNMDT
     C                     ELSE
     C                     MOVE *BLANK    CSNMDT
     C                     END
     C                     END
      * FORMAT DELIVER FROM SHORTNAME
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C**********           Z-ADDDELF      CBNUM                                               CSD027
     C                     MOVE DELF      CBNUM                                               CSD027
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '1'
     C                     MOVE *BLANK    CSNMDF
     C                     ELSE
     C           RECI      IFNE '*'
     C                     MOVE CSNM      CSNMDF
     C                     ELSE
     C                     MOVE *BLANK    CSNMDF
     C                     END
     C                     END
      *
      * FORMAT PAY CODE LEGEND
     C                     SETOF                     707172
     C                     SETOF                     737478
     C           PCOD      IFEQ '0'
     C                     SETON                     70
     C                     ELSE
     C           PCOD      IFEQ '1'
     C                     SETON                     71
     C                     ELSE
     C           PCOD      IFEQ '2'
     C                     SETON                     72
     C                     ELSE
     C           PCOD      IFEQ '3'
     C                     SETON                     73
     C                     ELSE
     C           PCOD      IFEQ '4'
     C                     SETON                     74
     C                     ELSE
     C           PCOD      IFEQ '5'
     C                     SETON                     78
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      * FORMAT PRIORITY CODE LEGEND
     C                     SETOF                     757677
     C           PRYC      IFEQ 'R'
     C                     SETON                     75
     C                     ELSE
     C           PRYC      IFEQ 'P'
     C                     SETON                     76
     C                     ELSE
     C           PRYC      IFEQ 'W'
     C                     SETON                     77
     C                     END
     C                     END
     C                     END
      *
      * FORMAT PRICE/DISCOUNT/YIELD
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE TPDY      ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETPDY 17
      *
      * FORMAT COUPON RATE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE TDCR      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETDCR 13
      *                                                                   E19412
      * FORMAT ACCRUED INDICATORS                                         E19412
     C           PROT      IFEQ '4'                                       E19412
     C           SETX      ANDEQ'Y'                                                           234675
     C           PROT      OREQ '7'                                       E19412
     C                     MOVE '1'       *IN55                           E19412
     C                     ELSE                                           E19412
     C                     MOVE '0'       *IN55                           E19412
     C                     END                                            E19412
      *
      * FORMAT DAYS ADJUSTMENT
     C                     Z-ADDDADJ      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEDADJ  4
      *
     C/COPY WNCPYSRC,SE0325C031
      * FORMAT INTEREST ADJUSTMENT
     C                     MOVEL'20      'TKEY
     C                     MOVE TNMC      TTNMC
     C                     MOVE '1'       TKEY
     C           TABTK     CHAINTABTG10F             63
     C           *IN63     IFEQ '0'
     C           RECI      IFEQ '*'
     C                     SETON                     63
     C                     END
     C                     END
     C           *IN63     IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'05'      DBASE            **DB ERROR 05**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD5         DBASE            **DB ERROR 05**S01117
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTKEY      DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *    USE DEC PLACES FROM TABTG10 FOR ZDECS
      *    AS INPUT TO ZSEDIT
     C                     Z-ADDCDP       ZDECS
     C/COPY WNCPYSRC,SE0325C004
      *
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE TINA      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETINA 18
      *
      * FORMAT REALLOWANCE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE RALL      ZFLD15
     C                     Z-ADD5         ZDECS
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZERALL 11
      *
      * FORMAT CURRENT FACTOR
     C                     MOVE *BLANKS   ZFLD15
     C*                                                                   E20086
     C/COPY WNCPYSRC,SE0325C020
     C**  Use factor from trade, not from security.                       E20086
     C***********          MOVE CFCT      ZFLD15                          E20086
     C                     MOVE TCFC      ZFLD15                          E20086
     C**********           Z-ADD8         ZDECS                           052254
     C                     Z-ADD9         ZDECS                           052254
     C                     MOVE 'L'       ZECODE
     C                     EXSR ZSEDIT
     C**********           MOVE ZOUT21    ZECFCT 11                       052254
     C                     MOVE ZOUT21    ZECFCT                          052254
     C/COPY WNCPYSRC,SE0325C021
      *
      * FORMAT CHARGE/COMMISSION DESCRIPTION
     C                     MOVE TNMC      SECCY
      *    BROKER COMMISSION
     C                     MOVE TBCC      SECCOM
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C           SECGTK    CHAINSECGTDF              62                   S01169
     C           *IN62     IFEQ '1'
     C                     MOVE *BLANK    CHNRBC
     C                     ELSE
     C                     MOVE CHNR      CHNRBC
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFCA                          CAC002
     C                     END
      *    CUSTOMER COMMISSION
     C                     MOVE TCCC      SECCOM
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C           SECGTK    CHAINSECGTDF              62                   S01169
     C           *IN62     IFEQ '1'
     C                     MOVE *BLANK    CHNRCC
     C                     ELSE
     C                     MOVE CHNR      CHNRCC
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFCB                          CAC002
     C                     END
      *    CUSTOMER CHARGES - 1
     C                     MOVE TCC1      SECCOM
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C           SECGTK    CHAINSECGTDF              62                   S01169
     C           *IN62     IFEQ '1'
     C                     MOVE *BLANK    CHNRC1
     C                     ELSE
     C                     MOVE CHNR      CHNRC1
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC1                          CAC002
     C                     END
      *    CUSTOMER CHARGES - 2
     C                     MOVE TCC2      SECCOM
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C           SECGTK    CHAINSECGTDF              62                   S01169
     C           *IN62     IFEQ '1'
     C                     MOVE *BLANK    CHNRC2
     C                     ELSE
     C                     MOVE CHNR      CHNRC2
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC2                          CAC002
     C                     END
      *    CUSTOMER CHARGES - 3
     C                     MOVE TCC3      SECCOM
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C           SECGTK    CHAINSECGTDF              62                   S01169
     C           *IN62     IFEQ '1'
     C                     MOVE *BLANK    CHNRC3
     C                     ELSE
     C                     MOVE CHNR      CHNRC3
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC3                          CAC002
     C                     END
     C**** LOCAL TAX                                                      S01176
     C***********          MOVE TLTC      SECCOM                          S01176
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C***********SECGTK    CHAINSECGTDF              62                   S01176
     C************IN62     IFEQ '1'                                       S01176
     C***********          MOVE *BLANK    CHNRLT                          S01176
     C***********          ELSE                                           S01176
     C***********          MOVE CHNR      CHNRLT                          S01176
     C***********          END                                            S01176
      *                                                                   S01169
      **   CARRY OUT LOCAL TRANSFER & PMT CHARGES ONLY IF AUTO-CHARGES    S01169
      **   IS PRESENT.                                                    S01169
      *                                                                   S01169
     C************IN88     IFEQ '1'                                       S01169
      ***                                                                 S01176
      ***  LOCAL TRANSFER                                                 S01176
     C***********          MOVE TTCC      SECCOM                          S01176
     C***********SECGTK    CHAINSECGT                62                   S01176
     C************IN62     IFEQ '1'                                       S01176
     C***********          MOVE *BLANK    CHNRTR                          S01176
     C***********          ELSE                                           S01176
     C***********          MOVE CHNR      CHNRTR                          S01176
     C***********          END                                            S01176
      **** PMT CHARGE                                                     S01176
     C***********          MOVE TPCC      SECCOM                          S01176
     C***********SECGTK    CHAINSECGT                62                   S01176
     C************IN62     IFEQ '1'                                       S01176
     C***********          MOVE *BLANK    CHNRPC                          S01176
     C***********          ELSE                                           S01176
     C***********          MOVE CHNR      CHNRPC                          S01176
     C***********          END                                            S01176
      *                                                                   S01169
     C***********          END                                            S01176
      *
      ***  OTHER CHARGES                                                  S01176
     C***********          MOVE TOCC      SECCOM                          S01176
     C***********SECHGK    CHAINSECHGDF              62                   S01169
     C***********SECGTK    CHAINSECGTDF              62                   S01176
     C************IN62     IFEQ '1'                                       S01176
     C***********          MOVE *BLANK    CHNROC                          S01176
     C***********          ELSE                                           S01176
     C***********          MOVE CHNR      CHNROC                          S01176
     C***********          END                                            S01176
      *
      *    CUSTOMER CHARGES - 4                                           S01176
     C                     MOVE TCC4      SECCOM                          S01176
     C***********SECHGK    CHAINSECHGDF              62                   S01176
     C           SECGTK    CHAINSECGTDF              62                   S01176
     C           *IN62     IFEQ '1'                                       S01176
     C                     MOVE *BLANK    CHNRC4                          S01176
     C                     ELSE                                           S01176
     C                     MOVE CHNR      CHNRC4                          S01176
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC4                          CAC002
     C                     END                                            S01176
      *    CUSTOMER CHARGES - 5                                           S01176
     C/COPY WNCPYSRC,SE0325C032
     C                     MOVE TCC5      SECCOM                          S01176
     C***********SECHGK    CHAINSECHGDF              62                   S01176
     C           SECGTK    CHAINSECGTDF              62                   S01176
     C           *IN62     IFEQ '1'                                       S01176
     C                     MOVE *BLANK    CHNRC5                          S01176
     C                     ELSE                                           S01176
     C                     MOVE CHNR      CHNRC5                          S01176
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC5                          CAC002
     C                     END                                            S01176
     C/COPY WNCPYSRC,SE0325C033
     C*                                                                   S01176
     C* CARRY OUT CHARGES-6 + 7 + TAX ONLY IF AUTO CHARGES PRESENT        S01176
     C*                                                                   S01176
     C           *IN88     IFEQ '1'                                       S01176
     C*                                                                   S01176
      *    CUSTOMER CHARGES - 6                                           S01176
     C/COPY WNCPYSRC,SE0325C034
     C                     MOVE TCC6      SECCOM                          S01176
     C***********SECHGK    CHAINSECHGDF              62                   S01176
     C           SECGTK    CHAINSECGTDF              62                   S01176
     C           *IN62     IFEQ '1'                                       S01176
     C                     MOVE *BLANK    CHNRC6                          S01176
     C                     ELSE                                           S01176
     C                     MOVE CHNR      CHNRC6                          S01176
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC6                          CAC002
     C                     END                                            S01176
     C/COPY WNCPYSRC,SE0325C035
     C*                                                                   S01176
      *    CUSTOMER CHARGES - 7                                           S01176
     C/COPY WNCPYSRC,SE0325C036
     C                     MOVE TCC7      SECCOM                          S01176
     C***********SECHGK    CHAINSECHGDF              62                   S01176
     C           SECGTK    CHAINSECGTDF              62                   S01176
     C           *IN62     IFEQ '1'                                       S01176
     C                     MOVE *BLANK    CHNRC7                          S01176
     C                     ELSE                                           S01176
     C                     MOVE CHNR      CHNRC7                          S01176
      *                                                                   CAC002
      **  Profit Centre                                                   CAC002
      *                                                                   CAC002
     C                     EXSR SRPRFC                                    CAC002
     C                     MOVE WPRFC     PPRFC7                          CAC002
     C                     END                                            S01176
     C/COPY WNCPYSRC,SE0325C037
     C*                                                                   S01176
     C                     END                                            S01176
     C*                                                                   S01176
      * FORMAT SETTLEMENT CURRENCY CODE                                   S01176
     C                     MOVE SETC      ZSETC                           S01176
      *
      * FORMAT EXCHANGE RATE
     C                     MOVE *BLANKS   ZFLD15
      *                                                                   CAC002
      **  Adjust exchange rate with margin rate if anal acctg is on       CAC002
      *                                                                   CAC002
     C           BGN0ST    IFEQ 'Y'                                       CAC002
      *                                                                   CAC002
     C           TDTP      IFEQ 'TP'                                      CAC002
     C           TMDI      ANDEQ'M'                                       CAC002
     C           TDTP      OREQ 'TS'                                      CAC002
     C           TMDI      ANDEQ'D'                                       CAC002
     C           TDER      ADD  FXMR      WTDER  138                      CAC002
     C                     ELSE                                           CAC002
     C           TDER      SUB  FXMR      WTDER                           CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     MOVE WTDER     ZFLD15                          CAC002
      *                                                                   CAC002
     C                     ELSE                                           CAC002
     C                     MOVE TDER      ZFLD15
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     Z-ADD8         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C**********           MOVE ZOUT21    ZETDER 15                                           BG9048
     C                     MOVE ZOUT21    ZETDER 16                                           BG9048
      *
      * FORMAT BASE CURRENCY RATE
     C                     MOVE *BLANKS   ZFLD15
     C                     MOVE TBCR      ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETBCR 16
      *
      * FORMAT CONSIDERATION IN NOMINAL CURRENCY DEC PLACES
      *    USE DEC PLACES FROM TABTG10 FOR ZDECS
      *    AS INPUT TO ZSEDIT
     C                     Z-ADDCDP       ZDECS
      *
     C                     MOVE *BLANKS   ZFLD15
      ***  If Asset-Backed Security, adjust for Current Factor.           E20086
      *                                                                   E20086
     C           *LIKE     DEFN TCSR      FTCSR                           E20086
     C           PROT      IFEQ '8'                                       E20086
     C/COPY WNCPYSRC,SE0325C030
     C***********TCSR      MULT TCFC      FTCSR                    E20086 055420
     C           TCSR      MULT TCFC      FTCSR     H                     055420
     C                     ELSE                                           E20086
     C                     Z-ADDTCSR      FTCSR                           E20086
     C                     END                                            E20086
      *                                                                   E20086
     C***********          MOVE TCSR      ZFLD15                          E20086
     C                     MOVE FTCSR     ZFLD15                          E20086
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETCSR 21
     C/COPY WNCPYSRC,SE0325C005
      *
      * FORMAT HEADING FOR TRADE TYPE
     C                     MOVE *BLANK    LITRA  10
     C           TDTP      IFEQ 'TP'
     C                     MOVEL'PURCH.'  LITRA
     C                     MOVE 'INT '    LITRA
     C                     ELSE
      *
     C           TDTP      IFEQ 'TS'
     C                     MOVEL'SOLD.INT'LITRA
     C                     END
     C                     END
      *
      * FORMAT INTEREST AMOUNT PURCHASED IN NOM CURRENCY DECIMAL PLACES
      *    USE DEC PLACES FROM TABTG10 FOR ZDECS AS INPUT TO ZSEDIT
     C                     Z-ADDCDP       ZDECS
      *
     C                     Z-ADDITRA      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZEITRA 18
      * FORMAT REALLOWANCE AMOUNT
     C                     Z-ADDRALL      WDRAL1
     C*     IF DISCOUNT ..
     C*
     C           STBS      IFEQ 'D'
     C           RALL      ANDNE0
     C                     Z-ADDTDVD      ZSDATE
     C                     Z-ADDMATY      ZEDATE
     C                     EXSR ZDAYS
     C                     Z-ADDZDDAYS    #DDAYS  50
     C                     EXSR ZDYYR
     C           ZINTDD    IFNE 0
     C           RALL      MULT #DDAYS    WPRICE 158
     C           WPRICE    DIV  ZINTDD    WDRALL 158H
     C*
     C           WDRALL    IFGE 0
     C           1         SUB  WDRALL    WDRAL1 158
     C                     ELSE
     C                     Z-SUBWDRALL    WDRALL
     C           1         SUB  WDRALL    WDRAL1
     C                     Z-SUBWDRAL1    WDRAL1
     C                     END
     C*
     C                     END
     C                     END
     C*
     C*          NOML      MULT WDRAL1    ZRALL  155
     C                     Z-ADD*ZEROS    ZRALL  150
     C                     Z-ADD*ZEROS    ZRALL0 150
     C                     Z-ADD*ZEROS    ZRALL1 151
     C                     Z-ADD*ZEROS    ZRALL2 152
     C                     Z-ADD*ZEROS    ZRALL3 153
     C                     MOVEA'0000'    *IN,25
     C           25        ADD  CDP       J       20
     C                     MOVEA'1'       *IN,J
     C*
     C*  Calculate consideration/reallowance/charges/commission
     C*
     C   25      NOML      MULT WDRAL1    ZRALL0    H
     C   26      NOML      MULT WDRAL1    ZRALL1    H
     C   27      NOML      MULT WDRAL1    ZRALL2    H
     C   28      NOML      MULT WDRAL1    ZRALL3    H
     C*
     C* Price basis - divide by 100
     C*
     C           SPBS      IFEQ 'P'
     C   25                DIV  100       ZRALL0
     C   26                DIV  100       ZRALL1
     C   27                DIV  100       ZRALL2
     C   28                DIV  100       ZRALL3
     C                     END
     C*
     C   25                MOVE ZRALL0    ZRALL
     C   26                MOVE ZRALL1    ZRALL
     C   27                MOVE ZRALL2    ZRALL
     C   28                MOVE ZRALL3    ZRALL
     C*
     C*   Allow for nominal decimal places
     C*
     C           5         SUB  NMDP      DC      10
     C           ZRALL     MULT POWER8,DC ZRALL
     C*          SPBS      IFEQ 'P'
     C*          ZRALL     DIV  100       ZRALL     H
     C*                    END
     C*                    Z-ADDZRALL     ZFLD15    H
     C                     MOVE ZRALL     ZFLD15
     C*          CDP       ADD  4         DC      10
     C*          ZFLD15    MULT POWER,DC  ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     Z-ADDCDP       ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZERAMT 21
      *
      * FORMAT COMMISSION/CHARGE AMOUNTS
      *   ALL COMMISSIONS/CHARGES
     C                     Z-ADDCDP       ZDECS
      * BROKER COMMISSION
     C/COPY WNCPYSRC,SE0325C006
     C                     Z-ADDTBCA      ZFLD15
     C                     Z-ADDZFLD15    ZTBCA  150
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETBCA 18
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP1                                           S01408
     C*                                                                   S01408
      * CUST.COMMISSION AMOUNT
     C                     Z-ADDTCCA      ZFLD15
     C                     Z-ADDZFLD15    ZTCCA  150
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETCCA 18
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP2                                           S01408
     C*                                                                   S01408
      * CHARGES - 1 AMOUNT
     C                     Z-ADDTCA1      ZFLD15
     C                     Z-ADDZFLD15    ZTCA1  150
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETCA1 18
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP3                                           S01408
     C*                                                                   S01408
      * CHARGES - 2 AMOUNT
     C                     Z-ADDTCA2      ZFLD15
     C                     Z-ADDZFLD15    ZTCA2  150
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETCA2 18
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP4                                           S01408
     C*                                                                   S01408
      * CHARGES - 3 AMOUNT
     C                     Z-ADDTCA3      ZFLD15
     C                     Z-ADDZFLD15    ZTCA3  150
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZETCA3 18
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP5                                           S01408
     C*                                                                   S01408
     C**LOCAL TAX AMOUNT****                                              S01176
     C***********          Z-ADDTLTA      ZFLD15                          S01176
     C***********          Z-ADDZFLD15    ZTLTA  150                      S01176
     C***********          MOVE 'J'       ZECODE                          S01176
     C***********          EXSR ZSEDIT                                    S01176
     C***********          MOVE ZOUT21    ZETLTA 18                       S01176
     C***********                                                         S01176
     C***********                                                         S01176
     C*****CARRY OUT LOCAL TRANSFER & PMT CHARGES AND VAT AMT             S01176
     C**** ONLY AUTO-CHARGES IS PRESENT.                                  S01176
     C***********                                                         S01176
     C************IN88     IFEQ '1'                                       S01176
     C***********                                                         S01176
     C**LOCAL TRANSFER AMOUNT                                             S01176
     C***********          Z-ADDLTCA      ZFLD15                          S01176
     C***********          Z-ADDZFLD15    ZTLRA  150                      S01176
     C***********          MOVE 'J'       ZECODE                          S01176
     C***********          EXSR ZSEDIT                                    S01176
     C***********          MOVE ZOUT21    ZETLRA 18                       S01176
     C**PMT CHARGE AMOUNT                                                 S01176
     C***********          Z-ADDTPCA      ZFLD15                          S01176
     C***********          Z-ADDZFLD15    ZTPCA  150                      S01176
     C***********          MOVE 'J'       ZECODE                          S01176
     C***********          EXSR ZSEDIT                                    S01176
     C***********          MOVE ZOUT21    ZETPCA 18                       S01176
     C***********                                                         S01176
     C***********                                                         S01176
     C**VAT AMOUNT                                                        S01176
     C***********          Z-ADDTVCA      ZFLD15                          S01176
     C***********          Z-ADDZFLD15    ZTVTA  150                      S01176
     C***********          MOVE 'J'       ZECODE                          S01176
     C***********          EXSR ZSEDIT                                    S01176
     C***********          MOVE ZOUT21    ZETVTA 18                       S01176
     C***********                                                         S01176
     C***********          END                                            S01176
     C***********                                                         S01176
     C**OTHER CHARGES AMOUNT                                              S01176
     C***********          Z-ADDTOCA      ZFLD15                          S01176
     C***********          Z-ADDZFLD15    ZTOCA  150                      S01176
     C***********          MOVE 'J'       ZECODE                          S01176
     C***********          EXSR ZSEDIT                                    S01176
     C***********          MOVE ZOUT21    ZETOCA 18                       S01176
     C*                                                                   S01176
      * CHARGES - 4 AMOUNT                                                S01176
     C                     Z-ADDTCA4      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTCA4  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETCA4 18                       S01176
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP6                                           S01408
     C*                                                                   S01408
      * CHARGES - 5 AMOUNT                                                S01176
     C                     Z-ADDTCA5      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTCA5  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETCA5 18                       S01176
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP7                                           S01408
     C*                                                                   S01408
     C*    CARRY OUT CHARGES 6 + 7, AND TAX, AND REBATES ONLY             S01176
     C*    WHEN AUTO-CHARGES  PRESENT.                                    S01176
     C*                                                                   S01176
     C           *IN88     IFEQ '1'                                       S01176
     C*                                                                   S01176
      * CHARGES - 6 AMOUNT                                                S01176
     C/COPY WNCPYSRC,SE0325C007
     C                     Z-ADDTCA6      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTCA6  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETCA6 18                       S01176
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP8                                           S01408
     C*                                                                   S01408
      * CHARGES - 7 AMOUNT                                                S01176
     C                     Z-ADDTCA7      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTCA7  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETCA7 18                       S01176
     C*                                                                   S01408
     C/COPY WNCPYSRC,SE0325CCP9                                           S01408
     C*                                                                   S01408
      * TAX AMOUNT                                                        S01176
     C                     Z-ADDTAXA      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTTAX  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETTAX 18                       S01176
      * BROKER COM REBATE                                                 S01176
     C                     Z-ADDBCMR      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTBRB  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETBRB 18                       S01176
      * CUST.  COM REBATE                                                 S01176
     C                     Z-ADDCCMR      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTCCR  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETCCR 18                       S01176
      * TAX REBATE                                                        S01176
     C                     Z-ADDTXRB      ZFLD15                          S01176
     C                     Z-ADDZFLD15    ZTTXR  150                      S01176
     C                     MOVE 'J'       ZECODE                          S01176
     C                     EXSR ZSEDIT                                    S01176
     C                     MOVE ZOUT21    ZETTXR 18                       S01176
     C*                                                                   S01176
     C                     END                                            S01176
      *                                                                   CSE023
      ** Print the Withholding Tax if CSE023 is installed                 CSE023
      *                                                                   CSE023
     C           CSE023    IFEQ 'Y'                                       CSE023
     C                     Z-ADDWHTX      ZFLD15                          CSE023
     C                     MOVE 'J'       ZECODE                          CSE023
     C                     EXSR ZSEDIT                                    CSE023
     C                     MOVE ZOUT21    RWTAX                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                                       CGL031
      ** Format EU Withholding Tax for print input if CGL031 is                               CGL031
      ** switched on. Format EU Tax in Nominal Currency.                                      CGL031
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
      *****************************************************************                CGL031 235575
      ***Display*prices*if*Funds*or*Bonds******************************                CGL031 235575
      *****************************************************************                CGL031 235575
     C********** PROT      IFEQ '7'                                                    CGL031 235575
     C********** PROT      ORNE '4'                                                    CGL031 235575
     C********** PROT      ANDNE'2'                                                    CGL031 235575
     C********** PROT      ANDNE'7'                                                    CGL031 234000
     C********** ISSP      ANDLT100                                                    CGL031 234000
      *                                                                                       235575
      ** Display tax amount if EU taxes apply.                                                235575
      *                                                                                       235575
     C           PROT      IFNE '4'                                                           235575
     C           PROT      ANDNE'2'                                                           235575
     C           PROT      OREQ '4'                                                           235575
     C           SETX      ANDEQ'Y'                                                           235575
     C                     MOVE EUTX      ZFLD15                                              CGL031
     C                     MOVE 'J'       ZECODE                                              CGL031
     C                     Z-ADDCDP       ZDECS                                               CGL031
     C                     EXSR ZSEDIT                                                        CGL031
     C                     MOVE ZOUT21    REUTX                                               CGL031
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
     C*                                                                   S01176
      **ACCUMULATE*TOTAL*COMMISSION/CHARGES*IN*NOM*CCY*(SECTYD)           S01176
      **  The following section was irrelevant as all this has been done  E20909
      **  by SE0050 to calculate the countervalue. So should use TCTR.    E20909
     C***********PROT      IFEQ '6'                                       E20909
     C***********          Z-ADDTCSR      TCHR                            E20909
     C***********          ELSE                                           E20909
     C***********ACIN      IFEQ 'X'                                       E20909
     C***********TCSR      SUB  ITRA      TCHR   150               E20086 E20909
     C***********FTCSR     SUB  ITRA      TCHR   150               E20086 E20909
     C***********          ELSE                                           E20909
     C***********TCSR      ADD  ITRA      TCHR                     E20086 E20909
     C***********FTCSR     ADD  ITRA      TCHR                     E20086 E20909
     C***********          END                                            E20909
     C***********          END                                            E20909
     C***********          ADD  ZRALL     TCHR                            E20909
     C***********          ADD  ZTBCA     TCHR                            E20909
     C***********          ADD  ZTCCA     TCHR                            E20909
     C***********          ADD  ZTCA1     TCHR                            E20909
     C***********          ADD  ZTCA2     TCHR                            E20909
     C***********          ADD  ZTCA3     TCHR                            E20909
     C***********          ADD  ZTLTA     TCHR                     S01176 E20909
     C***********          ADD  ZTOCA     TCHR                     S01176 E20909
     C***********          ADD  ZTLRA     TCHR                     S01176 E20909
     C***********          ADD  ZTPCA     TCHR                     S01176 E20909
     C***********          ADD  ZTVTA     TCHR                     S01176 E20909
     C***********          ADD  ZTCA4     TCHR                     S01176 E20909
     C***********          ADD  ZTCA5     TCHR                     S01176 E20909
     C***********          ADD  ZTCA6     TCHR                     S01176 E20909
     C***********          ADD  ZTCA7     TCHR                     S01176 E20909
     C***********          ADD  ZTTAX     TCHR                     S01176 E20909
     C*                                                                   S01117
     C**  Save nominal currency decimal places, and access file           S01117
     C**  TABTG10 to fetch settlement currency decimal places             S01117
     C                     MOVEL'20      'TKEY
     C                     MOVE TNMC      TTNMC
     C                     MOVE '1'       TKEY
     C           TABTK     CHAINTABTG10F             63
     C***********          Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDCDP       ZCDPI                           S01117
      *
     C***********          Z-ADDTCHR      ZFLD15                          E20909
     C                     Z-ADDTCTR      ZFLD15                          E20909
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZCNTOT 18
      *
     C                     MOVEL'20      'TKEY                            S01117
     C                     MOVE SETC      TTNMC                           S01117
     C                     MOVE '1'       TKEY                            S01117
     C           TABTK     CHAINTABTG10F             63                   S01117
     C           *IN63     IFEQ '1'                                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE'   DBFILE           ***************S01117
     C                     MOVELTKEY      DBKEY            ** DB ERROR 06 S01117
     C                     Z-ADD6         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                  ***S01117
     C                     END                                            S01117
     C                     Z-ADDCDP       ZCDPO                           S01117
     C** TOTAL COMMISSION/CHARGES-CONVERT TO SETTLE CURRENCY VIA ZCONV
     C                     MOVE TNMC      ZCCYI
     C                     MOVE SETC      ZCCYO
     C                     MOVE TMDI      ZMD
     C                     Z-ADDTDER      ZEXCH
     C***********          Z-ADDTCHR      ZAMTCI
     C                     Z-ADDTCTR      ZAMTCI                          E20909
     C                     EXSR ZCONV
     C************INU8     IFEQ '1'                                       S01117
     C***********          MOVE '1'       *INU7                           S01117
     C***********          MOVE 'TABLE'   DBFILE           ***************S01117
     C***********          MOVELTKEY      DBKEY            ** DB ERROR 06 S01117
     C***********          MOVEL'06'      DBASE            ***************S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C***********          ELSE                                           S01117
      * CDP NOW CONTAINS SETT CURRENCY D.P. AFTER ZCONV
     C***********          Z-ADDCDP       ZDECS                           S01117
     C                     Z-ADDZCDPO     ZDECS                           S01117
     C                     Z-ADDZAMTCO    ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZCSTOT 18
     C***********          END                                            S01117
     C*********************************************
     C/COPY WNCPYSRC,SE0325C013
      *                                                                   CAC002
      **  Assign FX margin points, settlement currency and amount if      CAC002
      **  anal acctg is installed and nominal ccy not = settle ccy        CAC002
      *                                                                   CAC002
     C           BGN0ST    IFEQ 'Y'                                       CAC002
     C           TNMC      ANDNESETC                                      CAC002
      *                                                                   CAC002
     C                     MOVE '1'       *IN20                           CAC002
      *                                                                   CAC002
      **  FX Margin Points                                                CAC002
      *                                                                   CAC002
     C                     MOVE *BLANKS   ZFLD15                          CAC002
     C                     MOVE FXMP      ZFLD15                          CAC002
     C                     Z-ADD2         ZDECS                           CAC002
     C                     MOVE 'L'       ZECODE                          CAC002
     C                     EXSR ZSEDIT                                    CAC002
     C                     MOVE ZOUT21    PFXMP                           CAC002
      *                                                                   CAC002
      **  Settlement Currency                                             CAC002
      *                                                                   CAC002
     C                     MOVE SETC      PSETC                           CAC002
      *                                                                   CAC002
      **  Margin Amount                                                   CAC002
      *                                                                   CAC002
     C                     MOVE *BLANKS   ZFLD15                          CAC002
     C                     MOVE MAMT      ZFLD15                          CAC002
     C                     Z-ADDZCDPO     ZDECS                           CAC002
     C                     MOVE 'J'       ZECODE                          CAC002
     C                     EXSR ZSEDIT                                    CAC002
     C                     MOVE ZOUT21    PMAMT                           CAC002
      *                                                                   CAC002
     C                     ELSE                                           CAC002
     C                     MOVE '0'       *IN20                           CAC002
     C                     ENDIF                                          CAC002
      *
      * FORMAT STATUS
     C                     MOVE *BLANK    LTINC  10
     C           TINC      IFEQ 'I'
     C                     MOVEL'IN'      LTINC
     C                     MOVE 'COMPLETE'LTINC
     C                     ELSE
      *
     C           TINC      IFEQ 'C'
     C                     MOVEL'COMPLETE'LTINC
     C                     END
     C                     END
      *                                                                   S01486
      * FORMAT PORTFOLIO REFERENCE FOR OUTPUT                             S01486
     C           PTFR      IFEQ '9997'                                    S01486
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C                     MOVE FCR997    PTFR                            S01486
     C                     END                                            S01486
      *                                                                   S01486
      * FORMAT PORTFOLIO FX EXCHANGE RATE                                 S01486
     C           SPXR      IFNE *ZEROS                                    S01486
     C                     MOVE *BLANKS   ZFLD15                          S01486
     C                     MOVE SPXR      ZFLD15                          S01486
     C                     Z-ADD8         ZDECS                           S01486
     C                     MOVE 'L'       ZECODE                          S01486
     C                     EXSR ZSEDIT                                    S01486
     C                     MOVE ZOUT21    ZESPXR 15                       S01486
     C                     ELSE                                           S01486
     C                     MOVE *BLANKS   ZESPXR                          S01486
     C                     END                                            S01486
      *
      * FORMAT DETAILS FOR PRINT OUTPUT
     C                     SETOF                     515253
     C                     SETOF                     54
     C                     SETOF                     4849                 S01269
     C           ZCHTP     IFEQ 'A'
     C                     SETON                     51
     C                     ELSE
     C           ZCHTP     IFEQ 'I'
     C                     SETON                     52
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     SETON                     53
     C                     ELSE
     C           ZCHTP     IFEQ 'C'
     C                     SETON                     54
     C                     ELSE                                           S01269
     C           ZCHTP     IFEQ 'P'                                       S01269
     C                     SETON                     48                   S01269
     C                     ELSE                                           S01269
     C           ZCHTP     IFEQ 'Y'                                       S01269
     C                     SETON                     49                   S01269
     C                     END                                            S01269
     C                     END                                            S01269
     C                     END
     C                     END
     C                     END
     C                     END
      *
      ***  If MT5xx Feature present, allow Fields on Trades Extension     S01401
      ***  File to be reported.                                           S01401
      *                                                                   S01401
     C           S01401    IFEQ 'Y'                                       S01401
      *                                                                   S01401
      *****Access*Depot*Movements*Extension*File.*******:          S01401 S01446
      ***  Access Trades Extension File.                                  S01446
      *                                                                   S01401
     C           TDRF      CHAINTRADSDY1             79                   S01401
      *                                                                   S01401
     C           *IN79     IFEQ '1'                                       S01401
     C                     Z-ADD11        DBASE                           CSW003
     C***********          MOVEL'11'      DBASE            ********S01401 CSW003
     C                     MOVEL'TRADSDY1'DBFILE           * DB ERROR 11 *S01401
     C                     MOVELTDRF      DBKEY            ***************S01401
     C                     SETON                     U7U8                 S01401
     C                     WRITEHEADAU                                    S01401
     C                     WRITEERROR                                     S01401
     C                     GOTO ENDPGM                                    S01401
     C                     END                                            S01401
      *                                                                   S01401
      ***  Move SWIFT Fields to Report Fields.                            S01401
      *                                                                   S01401
     C                     MOVE T1GMES    RRGMES                          S01401
     C                     MOVE T1INST    RRINST                          S01401
     C                     MOVE T1INSS    RRINSS                          S01401
     C                     MOVE T1EUCL    RREUCL                          S01401
     C                     MOVE T1SAFA    RRSAFA                          S01401
     C                     MOVE T1RPTY    RRRPTY                          S01401
     C                     MOVE T1GMEC    RRGMEC                          S01401
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     MOVE T1FID1    RRFID1                          S01401
     C                     ELSE                                           CSW098
     C           CSW201    IFEQ 'N'                                                           CSW201
     C                     MOVE T1SIOR    RRSIOR                          CSW098
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVE T1CCID    RRCCID                          S01401
     C                     MOVE T1TRTT    RRTRTT                          S01401
     C                     MOVE T1GDEL    RRGDEL                          S01401
     C                     MOVE T1FCOD    RRFCOD                          S01401
     C                     MOVE T1FTID    RRFTID                          S01401
     C                     MOVE T1SROL    RRSROL                          S01401
      *                                                                   S01401
     C                     ADD  5         LINCNT                          S01401
     C                     SETOF                     46                                       CSW208
     C           CSW208    IFEQ 'Y'                                                           CSW208
     C           T1TRTT    IFNE *BLANKS                                                       CSW208
     C                     SETON                     46                                       CSW208
     C                     Z-ADD*ZERO     PFRTM                                               CSW208
     C                     EXSR SRDTCV                                                        CSW208
     C                     MOVE *BLANKS   RRSYOF  5                                           CSW208
     C                     MOVE PSYTOF    RRSYOF                                              CSW208
     C                     MOVELPSYTOS    RRSYOF                                              CSW208
     C                     Z-ADDPLCDT     ZDAYNO                                              CSW208
     C                     EXSR ZDATE2                                                        CSW208
     C                     MOVE ZADATE    RRLCDT  7                                           CSW208
     C                     MOVELPLCTM     RRLCTM  4                                           CSW208
     C                     MOVE *BLANKS   RRLCOF  5                                           CSW208
     C                     MOVE PLCTOF    RRLCOF                                              CSW208
     C                     MOVELPLCTOS    RRLCOF                                              CSW208
     C                     Z-ADDPMKDT     ZDAYNO                                              CSW208
     C                     EXSR ZDATE2                                                        CSW208
     C                     MOVE ZADATE    RRMKDT  7                                           CSW208
     C                     MOVELPMKTM     RRMKTM  4                                           CSW208
     C                     MOVE *BLANKS   RRMKOF  5                                           CSW208
     C                     MOVE PMKTOF    RRMKOF                                              CSW208
     C                     MOVELPMKTOS    RRMKOF                                              CSW208
     C                     ADD  3         LINCNT                                              CSW208
     C                     ENDIF                                                              CSW208
     C                     ENDIF                                                              CSW208
     C                     END                                            S01401
      *                                                                   S01401
     C                     MOVE *OFF      *IN31                           CSW003
     C                     MOVE *BLANKS   RRDEST                          CSW003
     C                     MOVE *BLANKS   SRDEST                          CSW003
      *                                                                   CSW003
      ** Check for second record (T1WHEN if = 'A', CSW003 on).            CSW003
     C           T1WHEN    IFEQ 'A'                                       CSW003
      *                                                                   CSW003
     C** Determine classification of Counterparty.                        CSW003
     C                     MOVE TCNR      BFCUST                          CSW003
      *                                                                   CSW003
     C                     CALL 'AOSECSR0'                                CSW003
     C                     PARM *BLANKS   BFRTCD                          CSW003
     C                     PARM '*KEY'    BFOPTN                          CSW003
     C                     PARM BFCUST    BFCUST                          CSW003
     C           SDSECS    PARM SDSECS    DSFDY                           CSW003
     C*                                                                   CSW003
     C           BFRTCD    IFEQ *BLANKS                                   CSW003
      *                                                                   CSW003
     C           BFCLAS    IFEQ 'S'                                       CSW003
     C           DELT      ANDNEDELF                                      CSW003
     C           BFCLAS    OREQ 'D'                                       CSW003
     C           DELT      ANDNEDELF                                      CSW003
      ** Display Second Record information.                               CSW003
     C                     MOVE *ON       *IN31                           CSW003
     C                     MOVE 'B'       SWHEN                           CSW003
      *                                                                   CSW003
     C           KEY002    CHAINTRADSDY1             79                   CSW003
      *                                                                   CSW003
     C           *IN79     IFEQ '1'                                       CSW003
     C                     MOVEL'14'      DBASE            ***************CSW003
     C                     MOVEL'TRADSDY1'DBFILE           * DB ERROR 14 *CSW003
     C                     MOVELTDRF      DBKEY            ***************CSW003
     C                     SETON                     U7U8                 CSW003
     C                     WRITEHEADAU                                    CSW003
     C                     WRITEERROR                                     CSW003
     C                     GOTO ENDPGM                                    CSW003
     C                     ENDIF                                          CSW003
      *                                                                   CSW003
     C           *IN31     IFEQ *ON                                       CSW003
     C           TDTP      IFEQ 'TP'                                      CSW003
      ** Display Destination: To Depot then Destination: From Depot       CSW003
     C                     MOVELDEST,1    RRDEST                          CSW003
     C                     MOVELDEST,2    SRDEST                          CSW003
     C                     ELSE                                           CSW003
      ** Display Destination: From Depot then Destination: To Depot       CSW003
     C                     MOVELDEST,1    SRDEST                          CSW003
     C                     MOVELDEST,2    RRDEST                          CSW003
     C                     ENDIF                                          CSW003
     C                     ENDIF                                          CSW003
      *                                                                   CSW003
      ***  Move SWIFT Fields to Report Fields.                            CSW003
      *                                                                   CSW003
     C                     MOVE T1GMES    SRGMES                          CSW003
     C                     MOVE T1INST    SRINST                          CSW003
     C                     MOVE T1INSS    SRINSS                          CSW003
     C                     MOVE T1EUCL    SREUCL                          CSW003
     C                     MOVE T1SAFA    SRSAFA                          CSW003
     C                     MOVE T1RPTY    SRRPTY                          CSW003
     C                     MOVE T1GMEC    SRGMEC                          CSW003
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     MOVE T1FID1    SRFID1                          CSW003
     C                     ELSE                                           CSW098
     C           CSW201    IFEQ 'N'                                                           CSW201
     C                     MOVE T1SIOR    SRSIOR                          CSW098
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVE T1CCID    SRCCID                          CSW003
     C                     MOVE T1TRTT    SRTRTT                          CSW003
     C                     MOVE T1GDEL    SRGDEL                          CSW003
     C                     MOVE T1FCOD    SRFCOD                          CSW003
     C                     MOVE T1FTID    SRFTID                          CSW003
     C                     MOVE T1SROL    SRSROL                          CSW003
      *                                                                   CSW003
     C                     ADD  5         LINCNT                          CSW003
     C                     SETOF                     47                                       CSW208
     C           CSW208    IFEQ 'Y'                                                           CSW208
     C           T1TRTT    IFNE *BLANKS                                                       CSW208
     C                     SETON                     47                                       CSW208
     C                     Z-ADD*ZERO     PFRTM                                               CSW208
     C                     EXSR SRDTCV                                                        CSW208
     C                     MOVE *BLANKS   SRSYOF  5                                           CSW208
     C                     MOVE PSYTOF    SRSYOF                                              CSW208
     C                     MOVELPSYTOS    SRSYOF                                              CSW208
     C                     Z-ADDPLCDT     ZDAYNO                                              CSW208
     C                     EXSR ZDATE2                                                        CSW208
     C                     MOVE ZADATE    SRLCDT  7                                           CSW208
     C                     MOVELPLCTM     SRLCTM  4                                           CSW208
     C                     MOVE *BLANKS   SRLCOF  5                                           CSW208
     C                     MOVE PLCTOF    SRLCOF                                              CSW208
     C                     MOVELPLCTOS    SRLCOF                                              CSW208
     C                     Z-ADDPMKDT     ZDAYNO                                              CSW208
     C                     EXSR ZDATE2                                                        CSW208
     C                     MOVE ZADATE    SRMKDT  7                                           CSW208
     C                     MOVELPMKTM     SRMKTM  4                                           CSW208
     C                     MOVE *BLANKS   SRMKOF  5                                           CSW208
     C                     MOVE PMKTOF    SRMKOF                                              CSW208
     C                     MOVELPMKTOS    SRMKOF                                              CSW208
     C                     ADD  3         LINCNT                                              CSW208
     C                     ENDIF                                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                   CSW003
     C                     ENDIF                                          CSW003
     C                     ENDIF                                          CSW003
     C                     ENDIF                                          CSW003
      *                                                                   CSW003
      * FORMAT DATES FOR PRINT OUTPUT
      *
     C***********          Z-ADDZLCD      ZDAYNO                          100228
     C                     Z-ADDXLCD      ZDAYNO                          100228
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZALCD
     C*                                                                   S01496
     C***EARLY*REDEMPTION*FEATURE*IS*ON*************************** S01496 CSE007
      *                                                                   CSE007
      ***  If Early Redemption or Corporate Action feature is ON.         CSE007
      ***  or if Securities Redenomination feature is ON.                 CEU017
     C*                                                                   S01496
     C           S01496    IFEQ 'Y'                        *B1            S01496
     C           CSE007    OREQ 'Y'                                       CSE007
     C           CEU017    OREQ 'Y'                                       CEU017
     C                     MOVE '0'       *IN87            ER BLOCK ERROR S01496
     C                     MOVE '0'       *IN89            GNRTED BY ER   S01496
     C*                                                                   S01496
     C** FOR CUSTOMER CLASSIFICATION 'S' OR 'D' ONLY |                    S01496
     C*                                                                   S01496
     C**   ACCESS TO SDSECSL1                                             S01496
     C*                                                                   S01496
     C                     MOVE TCNR      BFCUST                          S01496
     C*                                                                   S01496
     C                     CALL 'AOSECSR0'                                S01496
     C                     PARM *BLANKS   BFRTCD  7                       S01496
     C                     PARM '*KEY'    BFOPTN  7                       S01496
     C                     PARM BFCUST    BFCUST  6                       S01496
     C           SDSECS    PARM SDSECS    DSFDY                           S01496
     C*                                                                   S01496
     C           BFRTCD    IFEQ *BLANKS                    *B2 Rec.found  S01496
     C*                                                                   S01496
     C           BFCLAS    IFEQ 'S'                        *B3            S01496
     C           BFCLAS    OREQ 'D'                                       S01496
     C                     EXSR P001                                      S01496
     C                     OPEN SEERALL2                                  S01496
     C           TDRF      SETLLSEERALL2                 89               S01496
     C                     CLOSESEERALL2                                  S01496
     C                     END                             *E3            S01496
     C*                                                                   S01496
     C                     END                             *E2            S01496
     C                     END                             *E1            S01496
      *                                                                   CAC002
      **  Print the following fields if anal acctg is installed           CAC002
      *                                                                   CAC002
     C           BGN0ST    IFEQ 'Y'                                       CAC002
      *                                                                   CAC002
      **  Book Profit Centre                                              CAC002
      *                                                                   CAC002
     C                     MOVE BPRC      PBPRC                           CAC002
      *                                                                   CAC002
      **  Transaction Profit Centre only for portfolio customers          CAC002
      *                                                                   CAC002
      **  Access SDSECSPD                                                 CAC002
      *                                                                   CAC002
     C                     MOVE TCNR      BFCUST                          CAC002
     C                     CALL 'AOSECSR0'                                CAC002
     C                     PARM *BLANKS   BFRTCD                          CAC002
     C                     PARM '*KEY'    BFOPTN                          CAC002
     C                     PARM           BFCUST                          CAC002
     C           SDSECS    PARM SDSECS    DSFDY                           CAC002
      *                                                                   CAC002
     C           BFRTCD    IFEQ *BLANKS                                   CAC002
     C           BFCLAS    ANDEQ'S'                                       CAC002
     C           BFRTCD    OREQ *BLANKS                                   CAC002
     C           BFCLAS    ANDEQ'D'                                       CAC002
     C                     MOVE TPRC      PTPRC                           CAC002
     C                     MOVE '1'       *IN21                           CAC002
     C                     ELSE                                           CAC002
     C                     MOVE '0'       *IN21                           CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     ENDIF                                          CAC002
      *
     C                     ADD  1         LINCNT
     C*
     C/COPY WNCPYSRC,SE0325CP10
      *                                                                                       CER001
      ** Read Extension file TRADSDX6 when feature ULX004 is installed                        CER001
      *                                                                                       CER001
     C                     MOVE '0'       *IN44                                               CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                        *B1                                CER001
     C           ULX008    OREQ 'Y'                                                           CER001
      *                                                                                       CER001
     C                     MOVE *BLANKS   ZAAGRE                                              CER001
      *                                                                                       CER001
     C           ULX008    IFEQ 'Y'                                                           CER001
     C                     MOVE *ON       *IN43                                               CER001
     C                     MOVE *ZEROS    ZTIME                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           TDRF      CHAINSETRX1L0             45                                       CER001
      *                                                                                       CER001
     C           *IN45     IFEQ '0'                        *B2                                CER001
      *                                                                                       CER001
     C                     MOVE '1'       *IN44                                               CER001
     C                     Z-ADDCCAGSD    ZDAYNO                                              CER001
     C                     EXSR ZDATE2                                                        CER001
     C                     MOVE ZADATE    ZAAGRE                                              CER001
      *                                                                                       CER001
     C           ULX008    IFEQ 'Y'                                                           CER001
     C                     MOVE *ON       *IN43                                               CER001
     C                     MOVE CCTIME    ZTIME                                               CER001
     C                     MOVE CCCABR    ZCABR                                               CER001
     C                     MOVE CCMTRD    ZMTRD                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                           *E2                                CER001
      *                                                                                       CER001
     C                     ENDIF                           *E1                                CER001
      *                                                                                       CER001
     C*
     C                     WRITEDETAIL
     C/COPY WNCPYSRC,SE0325C019
      *                                                                   CAC002
      **  Initialise analytical accounting fields                         CAC002
      *                                                                   CAC002
     C                     MOVE *BLANKS   PPRFCA                          CAC002
     C                     MOVE *BLANKS   PPRFCB                          CAC002
     C                     MOVE *BLANKS   PPRFC1                          CAC002
     C                     MOVE *BLANKS   PPRFC2                          CAC002
     C                     MOVE *BLANKS   PPRFC3                          CAC002
     C                     MOVE *BLANKS   PPRFC4                          CAC002
     C                     MOVE *BLANKS   PPRFC5                          CAC002
     C                     MOVE *BLANKS   PPRFC6                          CAC002
     C                     MOVE *BLANKS   PPRFC7                          CAC002
     C                     MOVE *BLANKS   PFXMP                           CAC002
     C                     MOVE *BLANKS   PSETC                           CAC002
     C                     MOVE *BLANKS   PMAMT                           CAC002
     C                     MOVE *BLANKS   PTPRC                           CAC002
     C                     MOVE *BLANKS   PBPRC                           CAC002
     C/COPY WNCPYSRC,SE0325C029
      * HOLD DATA UNTIL NEXT TRADSD READ
     C***********          Z-ADDTDBR      ZTDBR   30                      S01117
     C                     MOVELTDBA      ZTDBA   3                       S01117
     C/COPY WNCPYSRC,SE0325C010
      *
     C*
     C* NEXT
     C           NEXT      TAG                             ** NEXT TAG  **
     C                     READ TRDIP                    50
     C                     MOVE RECI      TRECI                           S01269
     C*
     C** CHECK FOR REQUESTED BRANCH FOR MULTIBRANCHING                    S01117
     C*
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ENT       IFNE 'ALL'                                     S01117
     C           ENT       ANDNETDBA                                      S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     MOVE '1'       *IN80                           S01117
     C                     GOTO ENDSEL                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *
      * DETERMINE NEED TO CLOSE PRINTER FILE
      *
      * EOF OR 'L' MODE - DELETED RECORD OR 'I' MODE LCD NOT EQUAL
     C           *IN50     IFNE '1'
     C           MODE      IFEQ 'L'
     C           RECI      ANDEQ'*'
     C                     ELSE
     C           MODE      IFEQ 'I'
     C           LCD       ANDNERUND
     C                     ELSE
      *
      * BRANCH CHANGE
     C***********ZTDBR     IFNE TDBR                                      S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ZTDBA     IFNE TDBA                                      S01117
     C                     SETON                     80
     C                     END
     C                     END                                            S01117
      *
      * TOTAL OUTPUT - CLOSE SE0325P1-IF DETAIL RECORDS WRITTEN
      *   BRANCH CHANGE
      *
     C           ENDSEL    TAG                             * ENDSEL *     S01117
     C**                                                                  S01117
     C           ZCOUNT    IFEQ 0
     C           ZLIVP1    ANDEQ0
     C           ZCHGP1    ANDEQ0
     C                     ELSE
      *
     C           *IN80     IFEQ '1'
      *                                                                   S01401
     C           S01401    IFEQ 'Y'                                       S01401
     C           OFLLN1    SUB  PRTLN1    DIFLN1  20                      S01401
     C           DIFLN1    IFLT 9                                         S01401
     C                     Z-ADD0         LINCNT                          S01401
     C                     WRITEHEADP1                                    S01401
     C                     END                                            S01401
     C                     END                                            S01401
      *                                                                   S01401
     C                     WRITETOTAL
     C                     WRITETRAILP1
     C                     Z-ADD0         ZCOUNT
     C                     Z-ADD0         ZLIVP1
     C                     Z-ADD0         ZCHGP1
     C                     CLOSESE0325P1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C/SPACE 3
      *
      * END OF FILE - IF DETAIL RECORDS WRITTEN - WRITE TOTAL LINE
      *
     C           TOTALS    TAG                             ** TOTALS TAG**
      *
     C           ZCOUNT    IFEQ 0
     C           ZLIVP1    ANDEQ0
     C           ZCHGP1    ANDEQ0
     C                     ELSE
      *
     C           *IN82     IFEQ '1'
      *                                                                   S01401
     C           S01401    IFEQ 'Y'                                       S01401
     C           OFLLN1    SUB  PRTLN1    DIFLN1                          S01401
     C           DIFLN1    IFLT 6                                         S01401
     C                     Z-ADD0         LINCNT                          S01401
     C                     WRITEHEADP1                                    S01401
     C                     END                                            S01401
     C                     END                                            S01401
      *                                                                   S01401
     C                     WRITETOTAL
     C***********          WRITETRAILP1                                   S01117
     C                     END
     C                     END
     C**                                                                  S01117
     C** WRITE '*** NO DETAILS TO REPORT ***' LINE                        S01117
     C           *IN82     IFEQ '0'                                       S01117
     C                     MOVE '1'       *IN36                           S01117
     C                     END
      *
     C/SPACE 3
      *================================================================
      *  RUN CONTROL PROCESS
      *================================================================
      *
      *
      **WRITE*CONTROL*REPORT*HEADINGS*************************************S01117
     C***********          WRITEHEADAU                                    S01117
      *
      * READ AUDIT RECORD
     C                     READ TRADSA                   50
     C           *IN,50    IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'07'      DBASE            **DB ERROR 07**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD7         DBASE            **DB ERROR 07**S01117
     C                     MOVEL'TRADSA'  DBFILE
     C                     MOVE 'AUDIT'   DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *
      * 'I' MODE - PRINT REPORT
     C           MODE      IFEQ 'I'
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLI
      *
      *
      * 'A'/'L' MODE -
     C                     ELSE
      *
      *
      * 'A' MODE - DO RUN CONTROLS
     C           MODE      IFEQ 'A'
     C           SLRB      ADD  SINS      ZWORK
     C/COPY WNCPYSRC,SE0325C014
     C           ZWORK     IFNE ZLIVE
     C           MBIN      IFEQ 'N'                                       S01117
     C                     SETON                     U881
     C                     ELSE                                           S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C                     SETON                     U881                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END
     C/COPY WNCPYSRC,SE0325C015
      *
      *  - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLA
      *
      *  - UPDATE AUDIT RECORD
     C           *INU8     IFEQ '0'
     C                     Z-ADD0         SINS
     C                     Z-ADD0         SAMD
     C                     Z-ADD0         SDEL
     C                     Z-ADD0         TRDA
     C                     Z-ADDNORE      SLRB
     C                     UPDATTRADSAF
     C                     END
      *
      * 'L' MODE - DO RUN CONTROLS
     C                     ELSE
     C           NORE      IFNE ZLIVE
     C           MBIN      IFEQ 'N'                                       S01117
     C                     SETON                     U881
     C                     ELSE                                           S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C                     SETON                     U881                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END
      *
      *  - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLL
     C                     END
     C                     END
      *
      *  IF NO OUTPUT - WRITE MESSAGE TO THIS EFFECT
     C************IN82     IFEQ '0'                                       S01117
     C           *IN36     IFEQ '1'                                       S01117
     C                     WRITENONE
     C                     ELSE                                           S01117
     C** WRITE P1 '*** END OF REPORT ***' LINE IF P1 OPENED               S01117
     C           *IN82     IFNE '1'                        ***************S01117
     C           *IN82     OREQ '1'                        * P1 NOT OPEN *S01117
     C           *IN80     ANDEQ'1'                        ***************S01117
     C                     ELSE                                           S01117
      *                                                                   S01401
     C           S01401    IFEQ 'Y'                                       S01401
     C           OFLLN1    SUB  PRTLN1    DIFLN1                          S01401
     C***********DIFLN1    IFLT 3                                  S01401 188773
     C           DIFLN1    IFLT 4                                         188773
     C                     Z-ADD0         LINCNT                          S01401
     C                     WRITEHEADP1                                    S01401
     C                     END                                            S01401
     C                     END                                            S01401
      *                                                                   S01401
     C                     WRITETRAILP1                                   S01117
     C                     END                                            S01117
     C                     END
      *
     C***********          WRITETRAILAU                                   S01117
     C/SPACE 3
      *================================================================
      *  END OF PROGRAM
      *================================================================
      *
     C           ENDPGM    TAG                             ** ENDPGM TAG**
     C*                                                                   154670
     C** RCF Processing for Audit File                                    154670
     C*                                                                   154670
     C                     EXSR RCFAU                                     154670
      *                                                                   S01401
     C           S01401    IFEQ 'Y'                                       S01401
     C                     CLOSETRADSDY1                                  S01401
     C                     ENDIF                                          S01401
      *                                                                   S01401
     C                     SETON                     LR
     C                     RETRN
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************   S01496
     C*                                                                   S01496
     C**   P001 SR - CHANGE PROGRAMS FOR 'BLOCK ERROR'                    S01496
     C*                                                                   S01496
     C*****************************************************************   S01496
     C           P001      BEGSR                                          S01496
     C*                                                                   S01496
     C** Search if there is a General Block for Customer                  S01496
     C** (Purchased or/and Sales)                                         S01496
     C*                                                                   S01496
     C                     MOVE TDBA      WWTDBA                          S01496
     C                     MOVE TCNR      WWTCNR                          S01496
     C                     MOVE ' '       WWCPGB                          S01496
     C                     MOVE ' '       WWCSGB                          S01496
     C                     CALL 'SE6714'                                  S01496
     C                     PARM           WWTDBA  3        Branch Code    S01496
     C                     PARM           WWTCNR  6        Customer       S01496
     C                     PARM           PTFR             Portfolio      S01496
     C                     PARM           WWCPGB  1        Cust.P GenBlockS01496
     C                     PARM           WWCSGB  1        Cust.S GenBlockS01496
     C*                                                                   S01496
     C           WWCPGB    IFEQ 'Y'                        *B1            S01496
     C           TDTP      ANDEQ'TP'                       *B1            S01496
     C           WWCSGB    OREQ 'Y'                        *B1            S01496
     C           TDTP      ANDEQ'TS'                       *B1            S01496
     C                     MOVE '1'       *IN87            Block error    S01496
     C*                                                                   S01496
     C                     ELSE                            *X1            S01496
     C** Search if there is a General Block for Security                  S01496
     C** (Purchased or/and Sales)                                         S01496
     C*                                                                   S01496
     C                     MOVE ' '       WWSPGB                          S01496
     C                     MOVE ' '       WWSSGB                          S01496
     C                     CALL 'SE6712'                                  S01496
     C                     PARM           WWTDBA  3        Branch Code    S01496
     C                     PARM           TDSS             Security       S01496
     C                     PARM           WWSPGB  1        Sec. P GenBlockS01496
     C                     PARM           WWSSGB  1        Sec. S GenBlockS01496
     C*                                                                   S01496
     C           WWSPGB    IFEQ 'Y'                        *B2            S01496
     C           TDTP      ANDEQ'TP'                       *B2            S01496
     C           WWSSGB    OREQ 'Y'                        *B2            S01496
     C           TDTP      ANDEQ'TS'                       *B2            S01496
     C                     MOVE '1'       *IN87            Block error    S01496
     C*                                                                   S01496
     C                     ELSE                            *X2            S01496
     C** Search if there is a Specific Block on all                       S01496
     C** the Customer/Security position                                   S01496
     C** (Purchased or/and Sales)                                         S01496
     C*                                                                   S01496
     C                     MOVE RUND      WWRUND                          S01496
     C                     MOVE 'N'       WWOBPO                          S01496
     C           TDTP      IFEQ 'TP'                       *B3            S01496
     C                     MOVE 'P'       WWBLTY                          S01496
     C                     ELSE                            *X3            S01496
     C                     MOVE 'S'       WWBLTY           for TS         S01496
     C                     END                             *E3            S01496
     C                     MOVE *BLANKS   WWNOBL                          S01496
     C                     MOVE *BLANKS   WWNOPO                          S01496
     C                     MOVE 'N'       WWCG11  1                       CGL011
     C                     MOVE *BLANKS   WWCOLA 15                       CGL011
     C                     CALL 'SE6710'                                  S01496
     C                     PARM           WWRUND  5        Run Date       S01496
     C                     PARM           WWOBPO  1        Obtain PositionS01496
     C                     PARM           WWTDBA  3        Branch Code    S01496
     C                     PARM           TDSS             Security       S01496
     C                     PARM           WWTCNR           Customer       S01496
     C                     PARM           PTFR             Portfolio      S01496
     C                     PARM           WWBLTY  1        Block Type     S01496
     C                     PARM           WWNOBL 13        Nom.AlreadyBlckS01496
     C                     PARM           WWNOPO 13        Nom.Position   S01496
     C                     PARM           WWCG11                          CGL011
     C                     PARM           WWCOLA                          CGL011
     C*                                                                   S01496
     C                     MOVE WWNOBL    W1NOBL 130                      S01496
     C                     MOVE WWCOLA    W1COLA 150                      CGL011
      *                                                                   CGL011
     C           W1NOBL    IFEQ *HIVAL                     *B3            S01496
     C                     MOVE '1'       *IN87            Block error    S01496
     C                     END                             *E3            S01496
     C*                                                                   S01496
     C                     END                             *E2            S01496
     C                     END                             *E1            S01496
     C*                                                                   S01496
     C                     ENDSR                                          S01496
      /EJECT                                                              S01496
     C*****************************************************************   S01117
     C*                                                                   S01117
     C*   ACCBRH SR. - SR. TO ACCESS BRANCH DETAILS                       S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C**                                                                  S01117
     C           ACCBRH    BEGSR                           * ACCBRH *     S01117
     C**                                                                  S01117
     C                     MOVE *BLANK    ZBRNM                           S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM PENT      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C**  CHECK FOR DATABASE ERROR                                        S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVELPENT      DBKEY                           S01117
     C                     MOVEL@OPTN     DBOPTN           ***************S01117
     C                     Z-ADD3         DBASE            * DB ERROR 03 *S01117
     C                     OUT  LDA                        ***************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C                     MOVE A8BRNM    ZBRNM                           S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
     C*****************************************************************   S01117
     C/EJECT                                                              S01117
      *****************************************************************   CAC002
      *                                                               *   CAC002
      *  Subroutine  :  SRPRFC                                        *   CAC002
      *  Function    :  Assign profit centre to print if analytical   *   CAC002
      *                 accounting is installed                       *   CAC002
      *                                                               *   CAC002
      *  Called by   :  Main Routine                                  *   CAC002
      *  Calls       :  -                                             *   CAC002
      *                                                               *   CAC002
      *****************************************************************   CAC002
      *                                                                   CAC002
     C           SRPRFC    BEGSR                           ** SRPRFC **   CAC002
      *                                                                   CAC002
     C                     MOVE *BLANKS   WPRFC   4                       CAC002
      *                                                                   CAC002
      **  Perform this subroutine only if anal acctg is installed         CAC002
      *                                                                   CAC002
     C           BGN0ST    IFEQ 'Y'                                       CAC002
      *                                                                   CAC002
     C                     SELEC                                          CAC002
      *                                                                   CAC002
      **  Transaction profit centre                                       CAC002
      *                                                                   CAC002
     C           BOTR      WHEQ 'T'                                       CAC002
     C                     MOVE TPRC      WPRFC                           CAC002
      *                                                                   CAC002
      **  Book profit centre                                              CAC002
      *                                                                   CAC002
     C           BOTR      WHEQ 'B'                                       CAC002
     C                     MOVE BPRC      WPRFC                           CAC002
      *                                                                   CAC002
      **  Profit centre from LF/SECGT                                     CAC002
      *                                                                   CAC002
     C           BOTR      WHEQ *BLANK                                    CAC002
     C                     MOVE PRFCGT    WPRFC                           CAC002
      *                                                                   CAC002
     C                     ENDSL                                          CAC002
      *                                                                   CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C           SRPRF9    ENDSR                           ** SRPRF9 **   CAC002
      *                                                                   CAC002
      *****************************************************************   CAC002
      /EJECT                                                              CAC002
     C*****************************************************************   S01117
     C*                                                                   S01117
     C*   DBERR SR.- DATABASE ERROR SUBROUTINE                            S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           DBERR     BEGSR                           ** DBERR SR ** S01117
     C*                                                                   S01117
     C**   DATABASE ERROR HANDLING , REPORT ETC.                          S01117
     C*                                                                   S01117
     C** WRITE DB ERROR DETAILS TO P1                                     S01117
     C*                                                                   S01117
     C           *IN82     IFNE '1'                        ***************S01117
     C           *IN82     OREQ '1'                        * P1 NOT OPEN *S01117
     C           *IN80     ANDEQ'1'                        ***************S01117
     C                     ELSE                            * P1 OPENED    S01117
     C                     ADD  1         LINCNT                          S01117
     C           LINCNT    IFGT MAXCNT                                    S01117
     C                     WRITEHEADP1                                    S01117
     C                     END                                            S01117
      *                                                                   S01401
     C           S01401    IFEQ 'Y'                                       S01401
     C           OFLLN1    SUB  PRTLN1    DIFLN1                          S01401
     C           DIFLN1    IFLT 4                                         S01401
     C                     Z-ADD0         LINCNT                          S01401
     C                     WRITEHEADP1                                    S01401
     C                     END                                            S01401
     C                     END                                            S01401
      *                                                                   S01401
     C                     WRITEERRORP1                                   S01117
     C                     WRITETRAILP1                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** OUTPUT RUN CONTROL DETAILS FOR AU                                S01117
     C*                                                                   S01117
     C                     WRITEHEADAU                                    S01117
     C           MODE      IFEQ 'I'                                       S01117
     C                     WRITECONTROLI                                  S01117
     C                     ELSE                                           S01117
     C           MODE      IFEQ 'A'                                       S01117
     C                     WRITECONTROLA                                  S01117
     C                     ELSE                                           S01117
     C                     WRITECONTROLL                                  S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** OUTPUT DB ERROR DETAILS FOR AU                                   S01117
     C*                                                                   S01117
     C                     WRITEERROR                                     S01117
     C                     EXSR *PSSR                                     S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*   *PSSR -- ERROR HANDLING SUBROUTINE                              S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C           *PSSR     BEGSR                                          S01117
     C**                                                                  S01117
     C                     SETON                     U7U8                 S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     SETON                     LR                   S01117
     C                     RETRN                                          S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
      **********************************************************************                  CSW208
      /EJECT                                                                                  CSW208
      **********************************************************************                  CSW208
      *                                                                    *                  CSW208
      *   SRDTCV - Convert date and time                                   *                  CSW208
      *                                                                    *                  CSW208
      **********************************************************************                  CSW208
      *                                                                                       CSW208
     C           SRDTCV    BEGSR                                                              CSW208
      *                                                                                       CSW208
     C                     MOVELT1TRTT    PFRTM                                               CSW208
     C                     CALL 'ZADTMCVT'                                                    CSW208
     C                     PARM *BLANK    RTCD2   7                                           CSW208
     C                     PARM 'S'       FRTZ    1                                           CSW208
     C                     PARM           PFRTM                                               CSW208
     C                     PARM TDDT      PFRDT   50                                          CSW208
     C                     PARM 'SE'      PMODL   2                                           CSW208
     C                     PARM TDBA      PBRCA   3                                           CSW208
     C                     PARM TMKC      PMRKT   2                                           CSW208
     C                     PARM *BLANK    PSESN  10                                           CSW208
     C                     PARM *BLANK    PMICC   4                                           CSW208
     C                     PARM *ZERO     PMKTM                                               CSW208
     C                     PARM *ZERO     PMKDT   50                                          CSW208
     C                     PARM *ZERO     PMKTOF                                              CSW208
     C                     PARM *BLANK    PMKTOS  1                                           CSW208
     C                     PARM *ZERO     PLCTM                                               CSW208
     C                     PARM *ZERO     PLCDT   50                                          CSW208
     C                     PARM *ZERO     PLCTOF                                              CSW208
     C                     PARM *BLANK    PLCTOS  1                                           CSW208
     C                     PARM *ZERO     PSYTM                                               CSW208
     C                     PARM *ZERO     PSYDT   50                                          CSW208
     C                     PARM *ZERO     PSYTOF                                              CSW208
     C                     PARM *BLANK    PSYTOS  1                                           CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*   RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF         S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFP1     BEGSR                            ** RCFP1 **   S01117
     C*                                                                   S01117
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   PTDBA   3                       S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C           *IN36     IFEQ '0'                                       S01117
     C                     MOVE TDBA      PTDBA                           S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C                     MOVE ENT       PTDBA                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM PTDBA     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/COPY WNCPYSRC,SE0325C008
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*   RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF         S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFAU     BEGSR                            ** RCFAU **   S01117
     C*                                                                   S01117
     C**  ENSURE AUDIT SPOOL FILE RECORDED BY RCF                         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           ZSNUMU                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/COPY WNCPYSRC,SE0325C017
     C/COPY ZSRSRC,ZCONVZ1
      /EJECT
     C/COPY ZSRSRC,ZDATE1Z2
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
     C/COPY ZSRSRC,ZDAYSZ2
      /EJECT
     C/COPY ZSRSRC,ZDYYRZ3
      /EJECT
     C/COPY ZSRSRC,ZEVCDZ1
      /EJECT
     C*COPY*ZSRSRC,ZICD2Z1**                                              S01117
      /EJECT                                                              S01169
     C*/COPY ZSRSRC,ZICDSEZ1**                                      S01169S01117
      /EJECT
     C/COPY ZSRSRC,ZNCDZ3
      /EJECT
     C/COPY ZSRSRC,ZLCDZ1                                                 100228
      /EJECT                                                              100228
     C/COPY ZSRSRC,ZSDESCZ3
      /EJECT
     C/COPY ZSRSRC,ZSEDITZ3
      /EJECT
     C*COPY*ZSRSRC,ZSYSTMZ1**                                             S01117
      /EJECT
      ***
     C/COPY WNCPYSRC,SE0325C027
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZF29 DAY NOS OF FEB 29 TO 2096 (INCLUDING 2000)
0006001521029820444305904073650882610287117481320914670161311759219053
2051421975234362489726358278192928030741322023366335124365853804639507
40968424294389045351
**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
00000001
00000010
00000100
00001000
00010000
00100000
01000000
10000000
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**  DEST - Destination for Depot Transfer
TO DEPOT                                                                  CSW003
FROM DEPOT                                                                CSW003
