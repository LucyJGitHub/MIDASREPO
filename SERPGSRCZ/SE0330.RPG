     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Trade settlements audit list')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Securities Trading Module
     F*                                                               *
     F*  SE0330 - TRADE SETTLEMENTS AUDIT LIST                        *
     F*                                                               *
     F*  Function:  This program produces a report, for audit         *
     F*   (I/C)     purposes, of all trade settlements defined to the *
     F*   (COB)     system.  The sequence of the report is branch,    *
     F*             trade reference, settlement sequence.             *
     F*                                                               *
     F*  Called By: 1) SEC0301 - Audit Reports - Input Cycle          *
     F*             2) SEC0601 - Audit Reports - Close of Business    *
     F*             3) SEC0302 - Full Lists - On Request              *
     F*                                                               *
     F*             Frequency:                                        *
     F*             The report is available in 3 modes (I,A,L):       *
     F*             1) On request during I/C; an interim report       *
     F*                showing the latest status of trade settlements *
     F*                inserted, amended or deleted during the day.   *
     F*             2) During COB; a report of all trade settlements  *
     F*                inserted, amended or deleted during the day.   *
     F*             3) On request; a report of all live trade         *
     F*                settlements in the system (ie. deleted items   *
     F*                are not included).                             *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *  Prev Amend No. 244855             Date 26Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *  Prev Amend No. BUG11114           Date 06Apr06               *
      *                 CSE071             Date 19Jul05               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 208241             Date 23Jun03               *
      *                 211183             Date 09Jan03               *
      *                 212124             Date 03Dec02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 180000             Date 16Oct00               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 193753             Date 07Jun01               *
      *                 127566             Date 09May01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 052254             Date 10JAN94               *
     F*                 S01401             DATE 16JUN93               *
     F*                 E33174             DATE 30OCT92               *
     F*                 S01397             DATE 10SEP92               *
     F*                 E35515             DATE 10FEB92               *
     F*                 E01672             DATE 29NOV91               *
     F*                 E29170             DATE 08NOV91               *
     F*                 E28705             DATE 04SEP91               *
     F*                 S01220             DATE 07AUG90               *
     F*                 S01117             DATE 31OCT90               *
     F*                 S01269             DATE 31JUL90               *
     F*                 E20695             DATE 12JAN90               *
     F*                 E14206             DATE 16FEB89               *
     F*                 S01158             DATE 06MAY88               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  244855 - Reverse core fix 211183 as it causes looping        *
      *           problems.                                           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      * BUG11114- This is Gems fix 214364 as mentioned in Gems fix   *
      *         - 234958. Fix is to reverse core fix 193753 so that   *
      *         - the field COUNTX will not be subtracted from the    *
      *         - workfield.                                          *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
      *  211183 - Fix will ensure that FOOB will not occur when       *
      *           a historic trade was changed and manually settled.  *
      *  212124 - FCOOB still occurs due to cancelled historic trades.*
      *           Partially applied fix 200774 to complete 180000.    *
     F*  180000 - Counting of cancelled historic records were         *
     F*           separated from no. of live records but not          *
     F*           subtracted, thus FOOB occured.                      *
     F*           - Completes fix 193753.                             *
      *  193753 - FCOOB occurred due to cancelled trades. Subtract    *
      *           no. of historic records deleted from no. of live    *
      *           records after input (File Control) to avoid FCOOB.  *
      *  127566 - Recompiled over changed ZSDESCZ3                    *
     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
     F*           to 10,9                                             *
     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
     F*          - Recompiled due to changes to files.                *
     F*  E33174 - Mode 'L' should report historic settlements         *
     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
     F*          - Recompiled due to changes to files.                *
     F*  E35515 - Recompiled over changed printer file                *
     F*  E01672 - In the case of a reversal with fully settled        *
     F*           amounts do not output warning messages.             *
     F*  E29170 - RCF changes                                         *
     F*  E28705 - Recompiled over changed PRTF                        *
     F*  S01220 - STRATEGIC RISK MANAGEMENT                           *
     F*           Recompiled over changed PF/SECTYD                   *
     F*  S01117 - MULTI-BRANCHING                                     *
     F*  S01269 - TRADE AUTHORISATION: RECOMPILED FOR CHANGE TO       *
     F*           FILE TABSE                                          *
     F*  E20695 - CHTP OF 'X' WAS NOT SETTING ON 'DELETED' INDICATOR  *
     F*  E14206 - EXCLUDE CANCELLED HISTORIC RECORDS FROM LIVE        *
     F*           RECORD COUNT.                                       *
     F*  S01158 - POST INCORPORATION DEVELOPMENT FIX                  *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
     FSETLE   IF  E           K        DISK                           UC
     FTABSE   IF  E           K        DISK
     F            TABTB10F                          KIGNORE               S01117
     F            TABLETAF                          KIGNORE
     F            TABTB11F                          KIGNORE
     F            TABTB36F                          KIGNORE               S01117
     F            TABTE10F                          KIGNORE
     F            TABTE20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F*********** TABLETJF                          KIGNORE               S01117
     F            TABLETKF                          KIGNORE
     F            TABLETLF                          KIGNORE
     F            TABLETNF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETRF                          KIGNORE               S01117
     F            TABLETXF                          KIGNORE
     F            TABLET2F                          KIGNORE
     F            TABLET3F                          KIGNORE
     F            TABLET5F                          KIGNORE
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCCF                          KIGNORE
     F            CLINTC1F                          KIGNORE
     FSECTY   IF  E           K        DISK
     FSETLEA  UF  E           K        DISK
     FSE0330P1O   E                    PRINTER                        UC
     F                                              KINFDS SPOOL          S01117
     FSE0330AUO   E                    PRINTER
     F                                              KINFDS SPOOLU         S01117
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   35       MULTIBRANCHING                                     *   S01117
     F*   36       'NO DETAILS TO REPORT'                             *   S01117
     F*   40       INPUT PARAMETER IS I (INPUT CYCLE MODE)            *
     F*   41       INPUT PARAMETER IS A (AUDIT MODE)                  *
     F*   42       INPUT PARAMETER IS L (FULL LIST MODE)              *
     F*   50       END OF INPUT FILE / FILE READ ERROR                *
     F*   51-53    PRINT AMD/INS/DEL                                  *
     F*   55-56    TABLE ENTRY MISSING                                *
     F****57*******NO*TABLETR*RECORD***********************************   S01117
     F*   58       CLINTCB RECORD MISSING                             *
     F*   59       SECTYD RECORD MISSING                              *
     F*   63       TABTG10 RECORD MISSING                             *
     F*   80       OPEN/CLOSE PRINTER FILE SE0325P1                   *
     F*   81       PRINT 'DIFFERENCE' LEGEND                          *
     F*   82       DETAIL REPORT OPEN                                 *
     F*   90-99    USED IN STANDARD SUB-ROUTINES                      *
     F*   U7       DATABASE ERROR                                     *
     F*   U8       DATABASE / CONTROL ERROR                           *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F*****************************************************************
     F*                                                               *
     F* S U B R O U T I N E   I N D E X                               *
     F*                                                               *
     F*   ACCBR  - ACCESS BRANCH DETAILS                              *   S01117
     F*   DBERR  - DATABASE ERROR CONTROL                             *   S01117
     F*   RCFAU  - RCF PROCESSING FOR AUDIT REPORT                    *   S01117
     F*   RCFP1  - RCF PROCESSING FOR P1 REPORT                       *   S01117
     F*   *PSSR  - ERROR HANDLING                                     *   S01117
     F****ZSYSTM*-*ACCESS*ICD*RECORD***********************************   S01117
     F*   ZDATE2 - DAYNO - DATE CONVERSION                            *
     F*   ZSEDIT - EDIT NUMERIC FIELDS                                *
     F*   ZSDESC - FORMAT SECURITY DESCRIPTIONS                       *
     F*                                                               *
     F*****************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z1
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZSEDITZ1
      /COPY ZSRSRC,ZSDESCZ1
     E                    TABSET  1   4  2   TABLEG 67   *WARNING* LEGENDS
      /EJECT
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I***LDA        UDS                            256                    S01117
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 177 DBASE                 S01117
     ILDA         DS                            256                       S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I              BJURPT                          TITL                  S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**                                                                  S01117
     I**  EXTERNAL DS FOR SE ICD DETAILS                                  S01117
     ISDSTRD    E DSSDSTRDPD                                              S01117
     I**                                                                  S01117
     I**  DATA STRUCTURE FOR RUN DATE DETAILS                             S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*  DS FOR LINE NO. TO HANDLE OVERFLOW                               S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA STRUCTURE FOR ACCESS OBJECTS, SHORT DATA STRUCTURE          S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I**                                                                  S01117
     I*
     I           SDS
     I                                      244 246 WSID
     I                                      254 263 USID
     I/COPY ZSRSRC,ZSEDITZ2
      /COPY ZSRSRC,ZSDESCZ2
     I*
     I* DATA STRUCTURE FOR FILE KEYS
     I*
     I*********** DS                                                      S01117
     I***********                             1  12 TRKEY                 S01117
     I***********                             1   2 TRRECT                S01117
     I***********                             3   9 TRZZ7                 S01117
     I***********                            10  12 TRSBCD                S01117
     I*
     I            DS
     I                                        1  12 TKEY
     I                                        1   2 TRECT
     I                                        3   8 TZZ6
     I                                        9  11 TSSCY
     I                                       12  12 TSREC
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     I*
     C/EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
      **DEFINE*KEYLIST*FOR*CHAINING*TO*TABLETR*FILE***********************S01117
     C*
     C***********TABTRK    KLIST                                          S01117
     C***********          KFLD           TRKEY                           S01117
      *
      * DEFINE KEYLIST FOR CHAINING TO CLINTCB FILE
      *
     C           CLICBK    KLIST
     C**********           KFLD           CBNUM   60                                          CSD027
     C                     KFLD           CBNUM   6                                           CSD027
     C                     KFLD           CBRCDT  1
      *
      * DEFINE KEYLIST FOR CHAINING TO TABSE FILE-TABTG10
      *
     C           TABTK     KLIST
     C                     KFLD           TKEY
      *****************************************************************                211183 244855
      ***Define*keylist*for*chaining*to*LF/SETLE***********************                211183 244855
      *****************************************************************                211183 244855
     C********** TABSTT    KLIST                                                       211183 244855
     C**********           KFLD           WSBCA                                        211183 244855
     C**********           KFLD           WSTDR                                        211183 244855
     C**********           KFLD           WSSQN                                        211183 244855
     C*
     C* Set up copyright parameter
     C*
      * PREPARE LDA
      *
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'SE0330'  DBPGM
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C** REGISTER SPOOL ENTRY FOR AU                                      S01117
     C                     EXSR RCFAU                                     S01117
     C**                                                                  S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**  TEST FOR MULTIBRANCHING                                         S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     35                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** CHECK SYSTEM FORMAT DATE, DDMMYY OR MMDDYY(98 ON)                S01117
     C           DATF      IFEQ 'M'                                       S01117
     C                     SETON                     98                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** INITIALISE VARIABLE                                              S01117
     C                     MOVE *BLANKS   ZBRNM                           S01117
     C**                                                                  S01117
      *
      * INPUT PARAMETER :
      *
     C           *ENTRY    PLIST
     C                     PARM           MODE    1
     C                     PARM           SEQ     5                       S01117
     C                     PARM           ENT     3                       S01117
      * DEFINE WORK FIELDS
      *
     C           *LIKE     DEFN LCD       ZLCD
     C           *LIKE     DEFN CHTP      ZCHTP
     C           *LIKE     DEFN TNLU      ZTNLU
     C           *LIKE     DEFN SINS      ZINS
     C           *LIKE     DEFN SAMD      ZAMD
     C           *LIKE     DEFN SDEL      ZDEL
     C********** *LIKE     DEFN SBCA      WSBCA                                        211183 244855
     C********** *LIKE     DEFN STDR      WSTDR                                        211183 244855
     C********** *LIKE     DEFN SSQN      WSSQN                                        211183 244855
     C/EJECT
      *================================================================
      *  FIRST TIME PROCESSING
      *================================================================
      *
      * SET INDICATORS FOR REPORT HEADING & OPEN INPUT FILE
     C           MODE      IFEQ 'I'
     C                     SETON                     40
     C                     ELSE
     C           MODE      IFEQ 'A'
     C                     SETON                     41
     C                     ELSE
     C                     SETON                     42
     C                     END
     C                     END
     C**                                                                  S01117
     C** INITIALISE OUTPUT ENTITY FIELDS BY INPUT PARAMETER               S01117
     C                     MOVE ENT       SBCA                            S01117
     C                     MOVE ENT       ZSBCA                           S01117
     C**                                                                  S01117
     C**   ACCESS BANK DETAILS, FOR TITLE                                 S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBANKPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01117
     C                     Z-ADD1         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
      *
      *
      **GET*INSTALLATION*CONTROL*DATA*RECORD*1****************************S01117
      *
     C***********          EXSR ZSYSTM                                    S01117
      *
      **ERROR*IN*ZSYSTM***************************************************S01117
      *
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C***********          END                                            S01117
      *
      *
     C                     OPEN SETLE
     C                     Z-ADD40        MAXCNT  20
     C/SPACE 3
      *================================================================
      *  M A I N   P R O C E S S I N G
      *================================================================
      *
      *
     C                     READ SETLE                    50
     C**********           Z-ADD0         ZWORK2                                       211183 244855
     C** CHECK FOR REQUESTED BRANCH FOR MULTIBRANCHING                    S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ENT       IFNE 'ALL'                                     S01117
     C           ENT       ANDNESBCA                                      S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     MOVE '1'       *IN80                           S01117
     C                     GOTO ENDSEL                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *
     C           *IN50     DOWNE'1'
      *
      * A RECORD HAS BEEN READ :-
      *
      * MOVE DATA INTO UNIQUE FIELDS
      *
     C                     Z-ADDLCD       ZLCD
     C                     MOVE CHTP      ZCHTP
     C                     Z-ADDTNLU      ZTNLU
     C**********           MOVE SBCA      WSBCA                                        211183 244855
     C**********           MOVE STDR      WSTDR                                        211183 244855
     C**********           Z-ADDSSQN      WSSQN                                        211183 244855
     C**********           MOVE '0'       *IN30                                        211183 244855
     C**********           MOVE '0'       *IN31                                        211183 244855
      *
      * IF CANCELLATION OF HISTORIC RECORD, KEEP SEPARATE COUNT. DO NOT   E14206
      * INCLUDE IN CALCULATING NUMBER OF LIVE RECORDS.                    E14206
      *                                                                   E14206
     C           RECI      IFEQ 'C'                                       E14206
     C           CHTP      ANDEQ'X'                                       E14206
     C                     ADD  1         COUNTX  50                      E14206
     C********** *IN30     DOWEQ'0'                                                    211183 244855
     C********** TABSTT    READESETLE                    30                            211183 244855
     C********** *IN30     IFEQ '0'                                                    211183 244855
     C********** RECI      ANDEQ'D'                                                    211183 244855
     C**********           MOVE '1'       *IN31                                        211183 244855
     C**********           ENDIF                                                       211183 244855
     C**********           ENDDO                                                       211183 244855
     C********** TABSTT    SETLLSETLE                                                  211183 244855
     C**********           READ SETLE                    50                            211183 244855
     C********** *IN31     IFEQ '1'                                                    211183 244855
     C**********           ADD  1         ZWORK2  50                                   211183 244855
     C**********           MOVE '0'       *IN31                                        211183 244855
     C**********           ENDIF                                                       211183 244855
     C                     END                                            E14206
      *                                                                   E14206
      * IF PARM=I & LAST CHANGE DATE NOT = RUN DATE - IGNORE
     C           MODE      IFEQ 'I'
     C           ZLCD      IFNE RUND
     C                     GOTO NEXT
     C                     END
     C                     END
      *
      * MAINTAIN COUNTS AS NECESSARY
     C           MODE      IFEQ 'I'
     C           MODE      OREQ 'A'
      *
      * I OR A MODES - INCLUDE DELETED RECORDS
     C           ZCHTP     IFEQ 'I'
     C                     ADD  1         ZINS
     C                     ELSE
     C           ZCHTP     IFEQ 'A'
     C                     ADD  1         ZAMD
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     ADD  1         ZDEL
     C                     END
     C                     END
     C                     END
     C                     END
      * I MODE - COUNT OF RECORDS CHANGED TODAY
     C           MODE      IFEQ 'I'
     C                     ADD  1         ZCHG
     C                     ADD  1         ZCHGP1
     C                     ELSE
      * A MODE -
     C           MODE      IFEQ 'A'
      * A MODE - COUNT OF RECORDS READ + LIVE RECORDS
     C           RECI      IFNE '*'
     C           RECI      ANDNE'C'                                       S01158
     C           RECI      ANDNE'H'
     C                     ADD  1         ZLIVE
     C                     END
     C           ZLCD      IFEQ RUND
     C                     ADD  1         ZCOUNT
     C                     ELSE
      *  - IGNORE IF LCD NOT EQUAL RUN DATE
     C                     GOTO NEXT
     C                     END
      *
     C                     ELSE
      * L MODE - COUNT OF LIVE RECORDS
     C           RECI      IFNE '*'
     C           RECI      ANDNE'C'                                       S01158
     C***********RECI      ANDNE'H'                                       033174
     C*                                                                   033174
     C** Maintain counts of processed + live settlements                  033174
     C*                                                                   033174
     C           RECI      IFNE 'H'                                       033174
     C                     ADD  1         ZLIVE
     C                     END                                            033174
     C                     ADD  1         ZLIVP1
     C*                                                                   033174
     C                     ELSE
      * L MODE - IGNORE IF DELETED RECORD
     C                     GOTO NEXT
     C                     END
     C                     END
     C                     END
      *
      ** RECORD TO BE PRINTED -
      ** OPEN OUTPUT FILE IF REQUIRED FIRST TIME ONLY
     C           *IN82     IFEQ '0'
     C                     SETON                     82
     C                     Z-ADD70        LINCNT  20
     C                     OPEN SE0330P1
     C                     EXSR RCFP1                                     S01117
     C                     MOVE SBCA      ZSBCA                           S01117
      ******FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY****************S01117
      ******IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK*********************S01117
     C***********          MOVEL'10      'TRKEY                           S01117
     C***********          MOVE SBCD      TRSBCD                          S01117
     C***********TABTRK    CHAINTABLETRF             57                   S01117
     C************IN57     IFEQ '1'                                       S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE BRNM      ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C**                                                                  S01117
     C                     SETOF                     80
     C**                                                                  S01117
     C** FOR MULTIBRANCHING, ACCESS BRANCH NAME WITH ACCESS OBJECT        S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE SBCA      PENT    3                       S01117
     C                     EXSR ACCBRH                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE
      *
      **  OPEN OUTPUT FILE IF REQUIRED NEW BRANCH
     C           *IN80     IFEQ '1'
     C                     Z-ADD70        LINCNT
     C                     Z-ADD0         PAGE
     C                     OPEN SE0330P1
     C                     EXSR RCFP1                                     S01117
     C                     MOVE SBCA      ZSBCA                           S01117
      ******FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY****************S01117
      ******IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK*********************S01117
     C***********          MOVEL'10      'TRKEY                           S01117
     C***********          MOVE SBCD      TRSBCD                          S01117
     C***********TABTRK    CHAINTABLETRF             57                   S01117
     C************IN57     IFEQ '1'                                       S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE BRNM      ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C**                                                                  S01117
     C                     SETOF                     80
     C** FOR MULTIBRANCHING, ACCESS BRANCH NAME WITH ACCESS OBJECT        S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE SBCA      PENT    3                       S01117
     C                     EXSR ACCBRH                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END
     C                     END
      *
      *     PRINT PAGE HEADINGS
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
      *
      * FORMAT OUTPUT & PRINT FOR PRINTER FILE
      *
      * FIRST LINE   ***
      * FORMAT SECURITY SHORT DESCRIPTION
     C           SSSN      CHAINSECTYDF              59
     C           *IN59     IFEQ '0'
     C           RECI      IFEQ '*'
     C                     SETON                     59
     C                     END
     C                     END
     C           *IN59     IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'03'      DBASE            **DB ERROR 03**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD3         DBASE            **DB ERROR 03**S01117
     C                     MOVEL'SECTY'   DBFILE
     C                     MOVELSSSN      DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      **   PREPARE FIELDS FOR REPORT NAME
     C                     MOVE SRPN      ZSRPN
     C                     MOVE *BLANK    ZSFN1
     C                     MOVE *BLANK    ZSFN2
      **   ZSDESC REPORT NAME
     C                     MOVE BVRIDF    ZRSFD                           S01117
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     RNME
      *
      * FORMAT NOMINAL SETTLED - NMDP SECTYD TRADE SECURITY SHORTNAME
     C                     Z-ADDNMDP      ZDECS
      *
     C                     Z-ADDSNMS      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZESNMS 16
      *
      * FORMAT MOVEMENT DATE
     C                     Z-ADDSEDE      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZASEDE
      *
      * FORMAT TYPE
     C                     MOVE *BLANK    LTYPE   7
     C           SRIN      IFEQ 'Y'
     C                     MOVEL'REV'     LTYPE
     C                     ELSE
     C           SFSI      IFEQ 'Y'
     C                     MOVEL'FULL'    LTYPE
     C                     ELSE
     C           SOSI      IFEQ 'Y'
     C                     MOVEL'OVER'    LTYPE
     C                     ELSE
     C                     MOVEL'PARTIAL' LTYPE
     C                     END
     C                     END
     C                     END
      *
      * FORMAT DISCREPANCY INDICATOR
     C                     MOVE *BLANK    LSDSI   4
     C           SDSI      IFEQ 'Y'
     C                     MOVEL'YES'     LSDSI
     C                     ELSE
     C                     MOVEL'NO'      LSDSI
     C                     END
      *
      ** FORMAT DISCREPANCY AMOUNT
      **  DEC.PLACES CDP TABTG10 FOR ZDECS
     C                     MOVEL'20      'TKEY
     C                     MOVE SSCY      TSSCY
     C                     MOVE '1'       TKEY
     C           TABTK     CHAINTABTG10F             63
     C           *IN63     IFEQ '0'
     C           RECI      IFEQ '*'
     C                     SETON                     63
     C                     END
     C                     END
     C           *IN63     IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'04'      DBASE            **DB ERROR 04**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD4         DBASE            **DB ERROR 04**S01117
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTKEY      DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
     C                     Z-ADDCDP       ZDECS
      *
     C                     Z-ADDSDAM      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZESDAM 19
      *
      * SECOND LINE ****
      * FORMAT  CUSTOMER REPORT NAME/TOWN FOR COUNTERPARTY CUSTOMER NO.
      *    READ CLINTCB FILE USING KEY
      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
     C                     MOVE SCPN      CBNUM
     C                     MOVE 'A'       CBRCDT
     C           CLICBK    CHAINCLINTCBF             58
     C           *IN58     IFEQ '1'
     C                     MOVE *BLANK    CRNMC
     C                     MOVE *BLANK    CTWNC
     C                     ELSE
     C           RECI      IFNE '*'
     C                     MOVE CRNM      CRNMC
     C                     MOVE CTWN      CTWNC
     C                     ELSE
     C                     MOVE *BLANK    CRNMC
     C                     MOVE *BLANK    CTWNC
     C                     END
     C                     END
      * FORMAT COUNTERVALUE
      *    DEC.PLACES CDP TABTG10 FOR ZDECS
     C                     Z-ADDCDP       ZDECS
      *
     C                     Z-ADDSVLS      ZFLD15
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    ZESVLS 19
      *
      * FORMAT DETAILS FOR PRINT OUTPUT
     C                     SETOF                     515253
     C           ZCHTP     IFEQ 'A'
     C                     SETON                     51
     C                     ELSE
     C           ZCHTP     IFEQ 'I'
     C                     SETON                     52
     C                     ELSE
     C* DELETED HISTORIC TRADES HAVE CHTP OF 'X'                          E20695
     C           ZCHTP     IFEQ 'D'
     C           ZCHTP     OREQ 'X'                                       E20695
     C                     SETON                     53
     C                     END
     C                     END
     C                     END
      *
      * FORMAT DATES FOR PRINT OUTPUT
     C                     Z-ADDZLCD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZALCD
      *
      * FORMAT *WARNING* MESSAGE - VALUE FULLY SETTLED
     C                     MOVE *BLANK    FSLKEY  2
     C                     MOVE *BLANK    LSFSL  67
     C*                                                                   E01672
     C** If reversal for full amount put out no warning messages          E01672
     C*                                                                   E01672
     C           LTYPE     IFNE 'REV '                                    E01672
     C*                                                                   E01672
     C           SFSL      IFEQ 'O'
     C                     MOVE 'VO'      FSLKEY
     C                     ELSE
     C           SFSL      IFEQ 'P'
     C                     MOVE 'VP'      FSLKEY
     C                     END
     C                     END
      *
     C                     SETOF                     55
     C           FSLKEY    IFEQ '  '
     C                     ELSE
     C           FSLKEY    LOKUPTABSET    TABLEG         55
     C           *IN55     IFEQ '1'
     C                     MOVE TABLEG    LSFSL
     C                     ADD  1         LINCNT
     C                     END
     C                     END
     C                     END                                            E01672
      *
      * FORMAT *WARNING* MESSAGE - NOMINAL FULLY SETTLED
     C                     MOVE *BLANK    FSLKEY
     C                     MOVE *BLANK    LSNFS  67
     C*                                                                   E01672
     C** If reversal for full amount put out no warning messages          E01672
     C*                                                                   E01672
     C           LTYPE     IFNE 'REV '                                    E01672
     C*                                                                   E01672
     C           SNFS      IFEQ 'O'
     C                     MOVE 'NO'      FSLKEY
     C                     ELSE
     C           SNFS      IFEQ 'P'
     C                     MOVE 'NP'      FSLKEY
     C                     END
     C                     END
      *
     C                     SETOF                     56
     C           FSLKEY    IFEQ '  '
     C                     ELSE
     C           FSLKEY    LOKUPTABSET    TABLEG         56
     C           *IN56     IFEQ '1'
     C                     MOVE TABLEG    LSNFS
     C                     ADD  1         LINCNT
     C                     END
     C                     END
     C                     END                                            E01672
      *
     C                     ADD  4         LINCNT
     C                     WRITEDETAIL
      * HOLD DATA UNTIL NEXT SETLE READ
     C***********          Z-ADDSBCD      ZSBCD   30                      S01117
     C                     MOVE SBCA      ZSBCA                           S01117
      *
     C*
     C* NEXT
     C           NEXT      TAG                             ** NEXT TAG  **
     C                     READ SETLE                    50
     C** CHECK FOR REQUESTED BRANCH FOR MULTIBRANCHING                    S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ENT       IFNE 'ALL'                                     S01117
     C           ENT       ANDNESBCA                                      S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     MOVE '1'       *IN80                           S01117
     C                     GOTO ENDSEL                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *
      * DETERMINE NEED TO CLOSE PRINTER FILE
      *
      * EOF OR 'L' MODE - DELETED RECORD OR 'I' MODE LCD NOT EQUAL
     C           *IN50     IFNE '1'
     C           MODE      IFEQ 'L'
     C           RECI      ANDEQ'*'
     C                     ELSE
     C           MODE      IFEQ 'I'
     C           LCD       ANDNERUND
     C                     ELSE
      *
      * BRANCH CHANGE
     C***********ZSBCD     IFNE SBCD                                      S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ZSBCA     IFNE SBCA                                      S01117
     C                     SETON                     80
     C                     END
     C                     END                                            S01117
      *
      * TOTAL OUTPUT - CLOSE SE0330P1-IF DETAIL RECORDS WRITTEN
      *   BRANCH CHANGE
      *
     C           ENDSEL    TAG                             * E N D S E L *S01117
     C**                                                                  S01117
     C           ZCOUNT    IFEQ 0
     C           ZLIVP1    ANDEQ0
     C           ZCHGP1    ANDEQ0
     C                     ELSE
      *
     C           *IN80     IFEQ '1'
     C                     ADD  6         LINCNT
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
     C                     WRITETOTAL
     C                     WRITETRAILP1
     C                     Z-ADD0         ZCOUNT
     C                     Z-ADD0         ZLIVP1
     C                     Z-ADD0         ZCHGP1
     C                     CLOSESE0330P1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C/SPACE 3
      *
      * END OF FILE - IF DETAIL RECORDS WRITTEN - WRITE TOTAL LINE
      *
     C           TOTALS    TAG                             ** TOTALS TAG**
      *
     C           ZCOUNT    IFEQ 0
     C           ZLIVP1    ANDEQ0
     C           ZCHGP1    ANDEQ0
     C                     ELSE
      *
     C           *IN82     IFEQ '1'
     C                     ADD  6         LINCNT
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
     C                     WRITETOTAL
     C***********          WRITETRAILP1                                   S01117
     C                     END
     C                     END
     C**                                                                  S01117
     C** WRITE '*** NO DETAILS TO REPORT ***' LINE                        S01117
     C           *IN82     IFEQ '0'                                       S01117
     C***********          MOVE '1'       *IN82                     S01117E29170
     C***********          MOVE '0'       *IN80                     S01117E29170
     C                     MOVE '1'       *IN36                           S01117
     C***********          MOVE ENT       SBCA                      S01117E29170
     C***********          MOVE ENT       ZSBCA                     S01117E29170
     C***********          OPEN SE0330P1                            S01117E29170
     C***********          EXSR RCFP1                               S01117E29170
     C***********MBIN      IFEQ 'Y'                                 S01117E29170
     C***********ENT       ANDNE'ALL'                               S01117E29170
     C***********          MOVE ENT       PENT                      S01117E29170
     C***********          EXSR ACCBRH                              S01117E29170
     C***********          END                                      S01117E29170
     C***********          WRITEHEADP1                              S01117E29170
     C***********          WRITENONEP1                              S01117E29170
     C                     END                                            S01117
      *
     C/SPACE 3
      *================================================================
      *  RUN CONTROL PROCESS
      *================================================================
      *
      *
      **WRITE*CONTROL*REPORT*HEADINGS*************************************S01117
     C***********          WRITEHEADAU                                    S01117
      *
      * READ AUDIT RECORD
     C                     READ SETLEA                   50
     C           *IN,50    IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'02'      DBASE            **DB ERROR 02**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD2         DBASE            **DB ERROR 02**S01117
     C                     MOVEL'SETLEA'  DBFILE
     C                     MOVEL'AUDIT'   DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *                                                                   E14206
     C           SDEL      IFNE 0                                                             180000
     C                     SUB  COUNTX    SDEL                            E14206
     C                     ENDIF                                                              180000
      *
      * 'I' MODE - PRINT REPORT
     C           MODE      IFEQ 'I'
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLI
      *
      *
      * 'A'/'L' MODE -
     C                     ELSE
      *
      *
      * 'A' MODE - DO RUN CONTROLS
     C           MODE      IFEQ 'A'
     C           SLRB      IFEQ 0                                                             212124
     C           SINS      ANDEQ0                                                             212124
     C                     Z-ADD0         ZWORK                                               212124
     C                     ELSE                                                               212124
     C           SLRB      ADD  SINS      ZWORK
     C**********           ADD  ZWORK2    ZWORK                                        211183 244855
     C           ZWORK     SUB  SDEL      ZWORK
     C***********          SUB  COUNTX    ZWORK                           193753            BUG11114
     C           ZWORK     IFNE ZLIVE
     C           MBIN      IFEQ 'N'                                       S01117
     C                     SETON                     U881
     C                     ELSE                                           S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C                     SETON                     U881                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END
     C                     ENDIF                                                              212124
      *
      *  - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLA
      *
      *  - UPDATE AUDIT RECORD
     C           *INU8     IFEQ '0'
     C                     Z-ADD0         SINS
     C                     Z-ADD0         SAMD
     C                     Z-ADD0         SDEL
     C                     Z-ADDNORE      SLRB
     C                     UPDATSETLEAF
     C                     END
      *
      * 'L' MODE - DO RUN CONTROLS
     C                     ELSE
     C           NORE      IFNE ZLIVE
     C           MBIN      IFEQ 'N'                                       S01117
     C                     SETON                     U881
     C                     ELSE                                           S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C                     SETON                     U881                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END
      *
      *          - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLL
     C                     END
     C                     END
      *
      *  IF NO OUTPUT - WRITE MESSAGE TO THIS EFFECT
     C************IN82     IFEQ '0'                                       S01117
     C           *IN36     IFEQ '1'                                       S01117
     C                     WRITENONE
     C***********          WRITETRAILP1                             S01117E29170
     C                     ELSE                                           S01117
     C** WRITE P1 '*** END OF REPORT ***' LINE IF P1 OPENED               S01117
     C           *IN82     IFNE '1'                        ***************S01117
     C           *IN82     OREQ '1'                        * P1 NOT OPEN *S01117
     C           *IN80     ANDEQ'1'                        ***************S01117
     C                     ELSE                                           S01117
     C                     WRITETRAILP1                                   S01117
     C                     END                                            S01117
     C                     END
      *
     C***********          WRITETRAILAU                                   S01117
     C/SPACE 3
      *================================================================
      *  END OF PROGRAM
      *================================================================
      *
     C           ENDPGM    TAG                             ** ENDPGM TAG**
     C                     SETON                     LR
     C                     RETRN
     C*
     C*****************************************************************
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C**   ACCBRH SR. - SR. TO ACCESS BRANCH DETAILS                      S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C           ACCBRH    BEGSR                           * A C C B R H *S01117
     C**                                                                  S01117
     C                     MOVE *BLANK    ZBRNM                           S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM PENT      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C**                                                                  S01117
     C**  CHECK FOR DATABASE ERROR                                        S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVELPENT      DBKEY                           S01117
     C                     MOVEL@OPTN     DBOPTN           ***************S01117
     C                     Z-ADD5         DBASE            * DB ERROR 05 *S01117
     C                     OUT  LDA                        ***************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C                     MOVE A8BRNM    ZBRNM                           S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C**   DBERR SR.- DATABASE ERROR SUBROUTINE                           S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           DBERR     BEGSR                           ** DBERR SR ** S01117
     C**                                                                  S01117
     C**   DATABASE ERROR HANDLING , REPORT ETC.                          S01117
     C**                                                                  S01117
     C** WRITE DB ERROR DETAILS TO P1                                     S01117
     C           *IN82     IFNE '1'                        ***************S01117
     C           *IN82     OREQ '1'                        * P1 NOT OPEN *S01117
     C           *IN80     ANDEQ'1'                        ***************S01117
     C                     ELSE                            * P1 OPENED    S01117
     C                     ADD  9         LINCNT                          S01117
     C           LINCNT    IFGT MAXCNT                                    S01117
     C                     WRITEHEADP1                                    S01117
     C                     END                                            S01117
     C                     WRITEERRORP1                                   S01117
     C                     WRITETRAILP1                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** OUTPUT RUN CONTROL DETAILS FOR AU                                S01117
     C                     WRITEHEADAU                                    S01117
     C           MODE      IFEQ 'I'                                       S01117
     C                     WRITECONTROLI                                  S01117
     C                     ELSE                                           S01117
     C           MODE      IFEQ 'A'                                       S01117
     C                     WRITECONTROLA                                  S01117
     C                     ELSE                                           S01117
     C                     WRITECONTROLL                                  S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** OUTPUT DB ERROR DETAILS FOR AU                                   S01117
     C                     WRITEERROR                                     S01117
     C**                                                                  S01117
     C                     SETON                     U7U8                 S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     SETON                     LR                   S01117
     C                     RETRN                                          S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C** RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF          S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFP1     BEGSR                            ** RCFP1 **   S01117
     C*                                                                   S01117
     C**      ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   PSBCA   3                       S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C           *IN36     IFEQ '0'                                       S01117
     C                     MOVE SBCA      PSBCA                           S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C                     MOVE ENT       PSBCA                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM PSBCA     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C** RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF          S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFAU     BEGSR                            ** RCFAU **   S01117
     C*                                                                   S01117
     C**      ENSURE AUDIT SPOOL FILE RECORDED BY RCF                     S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           ZSNUMU                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
      *****************************************************************   S01117
      /EJECT                                                              S01117
      *****************************************************************   S01117
      *                                                               *   S01117
      *  *PSSR  - Error control subroutine                            *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
      *                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C**                                                                  S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
     C********************************************************************S01117
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
     C/COPY ZSRSRC,ZSDESCZ3
      /EJECT
     C/COPY ZSRSRC,ZSEDITZ3
      /EJECT
     C***COPY*ZSRSRC,ZSYSTMZ1                                             S01117
      ***
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@
(c) Finastra International Limited 2001
**  FULLY SETTLED WARNING LEGEND TABLE
NO*WARNING* NOMINAL AMOUNT ENTERED EXCEEDS AMOUNT OUTSTANDING          FIED A/C
NP*WARNING* NOMINAL AMOUNT ENTERED IS NOT FOR FULL AMOUNT OUTSTANDING  L A/C
VO*WARNING* VALUE AMOUNT ENTERED EXCEEDS AMOUNT OUTSTANDING
VP*WARNING* VALUE AMOUNT ENTERED IS NOT FOR FULL AMOUNT OUTSTANDING
