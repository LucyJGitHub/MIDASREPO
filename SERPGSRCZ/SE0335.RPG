000100200529     H        1
000200200529      *****************************************************************
000300200529/*STD *  RPGBASE                                                      *
000400200529/*EXI *  TEXT('Midas SE Position settlements audit list')
000500200529     F*****************************************************************
000600200529     F*                                                               *
000700200529     F*  Midas - Securities Trading Module                            *
000800200529     F*                                                               *
000900200529     F*  SE0335 - POSITION SETTLEMENTS AUDIT LIST                     *
001000200529     F*                                                               *
001100200529     F*  Function:  This program produces a report, for audit         *
001200200529     F*   (I/C)     purposes, of all position settlements defined     *
001300200529     F*   (COB)     to the system.  The sequence of the report is     *
001400200529     F*             branch, security, customer number, due date,      *
001500200529     F*             event type.                                       *
001600200529     F*                                                               *
001700200529     F*  Called By: 1) SEC0301 - Audit Reports - Input Cycle          *
001800200529     F*             2) SEC0601 - Audit Reports - Close of Business    *
001900200529     F*             3) SEC0302 - Full Lists - On Request              *
002000200529     F*                                                               *
002100200529     F*             Frequency:                                        *
002200200529     F*             The report is available in 3 modes (I,A,L):       *
002300200529     F*             1) On request during I/C; an interim report       *
002400200529     F*                showing the latest status of position          *
002500200529     F*                settlements inserted, amended or deleted       *
002600200529     F*                during the day.                                *
002700200529     F*             2) During COB; a report of all position           *
002800200529     F*                settlements inserted, amended or deleted       *
002900200529     F*                during the day.                                *
003000200529     F*             3) On request; a report of all live position      *
003100200529     F*                settlements in the system (ie. deleted items   *
003200200529     F*                are not included).                             *
003300200529     F*                                                               *
003400200529      *  (c) Finastra International Limited 2001                      *
003500200529     F*                                                               *
003600200604      *  Last Amend No. AR324888           Date 22May20               *
003700200529      *  Prev Amend No. MD046248           Date 27Oct17               *
003800200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
003900200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
004000200529      * Midas Plus 1.4 Base ------------------------------------------*
004100200529      * Midas Plus 1.3 ----------- Base ------------------------------*
004200200529      *                 CSD031             Date 10Apr06               *
004300200529      *                 CSD027             Date 09Dec05               *
004400200529      *                 CSE071             Date 19Jul05               *
004500200529      *                 CGL029             Date 01Sep03               *
004600200529      *                 208241             Date 17Jan03               *
004700200529      * Midas Release 4 --------------- Base -------------------------*
004800200529      *                 127566             Date 09May01               *
004900200529      * Midas DBA 3.04 -----------------------------------------------*
005000200529      *                 CSE023             Date 12Jul00               *
005100200529      * Midas DBA 3.03 -----------------------------------------------*
005200200529      *                 166145             Date 08Jun00               *
005300200529      *                 178530             Date 26May00               *
005400200529      * Midas DBA 3.02 -----------------------------------------------*
005500200529     F*                 CPB001             DATE 18Jun99               *
005600200529      * Midas DBA 3.00 ---------------- Base -------------------------*
005700200529     F*                 CEU017             Date 03Mar98               *
005800200529     F*                 CSE007             Date 03Feb97               *
005900200529     F*                 123673             Date 23Feb98               *
006000200529     F*                 CAC002             Date 15Sep96               *
006100200529     F*                 091886             Date 16Aug95               *
006200200529     F*                 S01408             Date 17Jan95               *
006300200529     F*                 S01486 MD          DATE 10NOV94               *
006400200529     F*                 S01496             DATE 14JUL94               *
006500200529     F*                 078011             DATE 27OCT94               *
006600200529     F*                 S01512             DATE 10AUG94               *
006700200529     F*                 052254             DATE 10JAN94               *
006800200529     F*                 S01446             DATE 04NOV93               *
006900200529     F*                 S01447             DATE 18OCT93               *
007000200529     F*                 S01401             DATE 16JUN93               *
007100200529     F*                 S01397             DATE 10SEP92               *
007200200529     F*                 E29170             DATE 08NOV91               *
007300200529     F*                 E28705             DATE 14SEP91               *
007400200529     F*                 S01117             DATE 31OCT90               *
007500200529     F*                 S01269             DATE 18OCT90               *
007600200529     F*                 E20651             DATE 04JAN90               *
007700200529     F*                 S01169             DATE 11NOV88               *
007800200529     F*                 E14881             DATE 21SEP88               *
007900200529     F*                 E14884             DATE 12SEP88               *
008000200529     F*                                                               *
008100200529     F*---------------------------------------------------------------*
008200200529     F*                                                               *
008300200529      *  AR324888 - Include user names on Position Settlement audit.  *
008400200529      *  MD046248 - Finastra Rebranding                               *
008500200529      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
008600200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
008700200529      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
008800200529      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
008900200529      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
009000200529      *  127566 - Recompiled over changed ZSDESCZ3                    *
009100200529      *  CSE023 - Treaty Withholding Tax                              *
009200200529     F*  166145 - Recompiled over changes of printer file SE0335P1     *
009300200529     F*  178530 - change input file from POSET to POSET1,             *
009400200529     F*           Single member (144854)                              *
009500200529     F*  CPB001 - 'Private Banking' Module                            *
009600200529     F*  CEU017 - Securities Redenomination Euro Changes              *
009700200529     F*  CSE007 - Corporate Actions                                   *
009800200529     F*  123673 - Recompiled over changes of printer file SE0335P1     *
009900200529     F*  CAC002 - Profit Centre Accounting Development - Phase 2      *
010000200529     F*           If Analytical Accounting is available, the profit   *
010100200529     F*           centre for each Charge/Commission Code would be     *
010200200529     F*           reported.  If the settlement currency is not the    *
010300200529     F*           same as the nominal currency, the FX Margin Points  *
010400200529     F*           and Amount will also be reported.                   *
010500200529     F*  091886 - Calculate file controls if S01496 not present       *
010600200529     F*  S01408 - ADDITION OF CORE HOOK SE0335CCPG                    *
010700200529     F*           ADDITION OF CORE HOOK SE0335CCP1                    *
010800200529     F*           ADDITION OF CORE HOOK SE0335CCP2                    *
010900200529     F*           ADDITION OF CORE HOOK SE0335CCP3                    *
011000200529     F*           ADDITION OF CORE HOOK SE0335CCP4                    *
011100200529     F*           ADDITION OF CORE HOOK SE0335CCP5                    *
011200200529     F*  S01486 - Report changed to output new line of Portfolio      *
011300200529     F*           Reference Details                                   *
011400200529     F*  S01496 - Incorporation of Jyske Enhancements (S10985 and     *
011500200529     F*           S10978).                                            *
011600200529     F*  078011 - Wrong branch code is printed on the last page for a *
011700200529     F*           branch containing only the total positions.         *
011800200529     F*           Recompiled due to change in printer file            *
011900200529     F*  S01512 - Add value date to Position Settlements              *
012000200529     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
012100200529     F*           to 10,9                                             *
012200200529     F*  S01446 - CUSTOMER COMMISSIONS (COURTAGE) ENHANCEMENT.        *
012300200529     F*           Recompiled due to changes in PF/SECGTD.             *
012400200529     F*  S01447 - SE WITHHOLDING TAX ENHANCEMENT                      *
012500200529     F*           Amended to print the Withholding Tax Details about  *
012600200529     F*           a Position Settlement if it has them and the        *
012700200529     F*           Withholding Tax feature is switched on.             *
012800200529     F*  S01401 - This has been amended to add SWIFT Further          *
012900200529     F*           Identification field (for MT554).                   *
013000200529     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
013100200529     F*          - Recompiled due to changes to files.                *
013200200529     F*  E29170 - Recompiled over changed PRTF for RCF changes        *
013300200529     F*  E28705 - Recompiled over changed PRTF                        *
013400200529     F*  S01117 - Multibranching                                      *
013500200529     F*  S01269 - Trade authorisation: recompiled over changed        *
013600200529     F*            file TABSE.                                        *
013700200529     F*  E20651 - DB ERRORS NUMBERS USED IN MORE THAN ONE PLACE.      *
013800200529     F*           NEW ERROR NUMBERS AS FOLLOWS:                       *
013900200529     F*              DB ERROR 04  ->  06                              *
014000200529     F*              DB ERROR 04  ->  07                              *
014100200529     F*  S01169 - SECURITIES TRADING 3.1 (BAER INCORPORATION)         *
014200200529     F*  E14881 - CALCULATION OF TOTAL AMOUNT AMENDED TO ALLOW FOR    *
014300200529     F*           PORTFOLIO CUSTOMERS AND DEPOTS                      *
014400200529     F*  E14884 - MATURED RECORDS (RECI 'M') NOT INCLUDED IN LIVE     *
014500200529     F*           RECORD COUNT                                        *
014600200529     F*                                                               *
014700200529     F*****************************************************************
014800200529     F*                                                               *
014900200529     F*  C R E A T I O N     P A R A M E T E R S                      *
015000200529     F*                                                               *
015100200529     F*                                                               *
015200200529     F*****************************************************************
015300200529      *
015400200529     F**POSET***IF  E           K        DISK                           UC178530
015500200529     FPOSET1  IF  E           K        DISK                           UC  178530
015600200529     FPSAUT   IF  E           K        DISK                                                 AR324888
015700200529      ** SE Position Settlement Authorisation detail                                        AR324888
015800200529      *                                                                                     AR324888
015900200529     FTABSE   IF  E           K        DISK
016000200529     F            TABTB10F                          KIGNORE               S01117
016100200529     F            TABLETAF                          KIGNORE
016200200529     F            TABTB11F                          KIGNORE
016300200529     F            TABTB36F                          KIGNORE               S01117
016400200529     F            TABTE10F                          KIGNORE
016500200529     F            TABTE20F                          KIGNORE
016600200529     F            TABTG20F                          KIGNORE
016700200529     F            TABLETHF                          KIGNORE
016800200529     F*********** TABLETJF                          KIGNORE               S01117
016900200529     F            TABLETKF                          KIGNORE
017000200529     F            TABLETNF                          KIGNORE
017100200529     F            TABLETPF                          KIGNORE
017200200529     F            TABLETRF                          KIGNORE               S01117
017300200529     F            TABLETXF                          KIGNORE
017400200529     F            TABLET2F                          KIGNORE
017500200529     F            TABLET3F                          KIGNORE
017600200529     F            TABLET5F                          KIGNORE
017700200529     FCLINT   IF  E           K        DISK
017800200529     F            CLINTCAF                          KIGNORE
017900200529     F            CLINTCCF                          KIGNORE
018000200529     F            CLINTC1F                          KIGNORE
018100200529     FSECTY   IF  E           K        DISK
018200200529     FSECOATL0IF  E           K        DISK                               CSE007
018300200529     F*SECHG***IF**E           K        DISK                              S01169
018400200529     FSECGT   IF  E           K        DISK                               S01169
018500200529     FPOSETA  UF  E           K        DISK
018600200529     FPOSETDY1IF  E           K        DISK                           UC  S01401
018700200529     FPMPORTPDIF  E           K        DISK                           UC  S01486
018800200529     FSE0335P1O   E                    PRINTER                        UC
018900200529     F                                              KINFDS SPOOL          S01117
019000200529     FSE0335AUO   E                    PRINTER
019100200529     F                                              KINFDS SPOOLU         S01117
019200200529     F/COPY WNCPYSRC,SE0335F001
019300200529      /EJECT
019400200529     F*****************************************************************
019500200529     F*                                                               *
019600200529     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
019700200529     F*                                                               *
019800200529     F*   19       Nominal currency not = settlement currency         *   CAC002
019900200529     F*   20       Analytical accounting is installed                 *   CAC002
020000200529     F*   33       POSITION SETTLEMENT IS A COUPON OR DIVIDEND.       *   S01447
020100200529     F*   34       PRESENCE OF FEATURE - S01447 - WITHHOLDING TAX.    *   S01447
020200200529     F*   35       MULTIBRANCHING                                     *   S01117
020300200529     F*   36       'NO DETAILS TO REPORT'                             *   S01117
020400200529     F*   37       PROFIT CENTRE USED IND.                            *   S01117
020500200529     F*   38       CORE FEATURE S01512 SWITCHED ON                    *   S01512
020600200529     F*   39       IF PM PRESENT SETS ON                              *   S01486
020700200529     F*   40       INPUT PARAMETER IS I (INPUT CYCLE MODE)            *
020800200529     F*   41       INPUT PARAMETER IS A (AUDIT MODE)                  *
020900200529     F*   42       INPUT PARAMETER IS L (FULL LIST MODE)              *
021000200529     F*   50       END OF INPUT FILE / FILE READ ERROR                *
021100200529     F*   51-54    PRINT AMD/INS/AUTH LEGEND                          *
021200200529     F*   55       CLINTSE RECORD MISSING                             *
021300200529     F*   56       PRINT PORTFOLIO REFERENCE DETAILS                  *   S01486
021400200529     F*   57       TABLETR RECORD MISSING                             *
021500200529     F*   58       CLINTCB RECORD MISSING                             *
021600200529     F*   59       SECTYD RECORD MISSING                              *
021700200529     F*   60       TABLE ENTRY MISSING                                *
021800200529     F*   61       TABLETL RECORD MISSING                             *
021900200529     F****62*******SECHGD RECORD MISSING                              *   S01169
022000200529     F*   62       SECGTD RECORD MISSING                              *   S01169
022100200529     F*   63       TABTG10 RECORD MISSING                             *
022200200529     F*   64       PAY TYPE                                           *
022300200529     F*   65       RECEIVE TYPE                                       *
022400200529     F*   66       PLUS LEGEND                                        *
022500200529     F*   67       LESS LEGEND                                        *
022600200529     F*   68       POSETDY1 RECORD MISSING                            *   S01401
022700200529     F*   69       PRINT REVERSE LEGEND                               *   S01496
022800200529     F*   70       AMEND S01496 IS SWITCH *ON                         *   S01496
022900200529     F*   71       FILE ERROR ON PMPORTPD                             *   S01486
023000200529     F*   80       OPEN/CLOSE PRINTER FILE SE0335P1                   *
023100200529     F*   81       PRINT 'DIFFERENCE' LEGEND                          *
023200200529     F*   82       DETAIL REPORT OPEN                                 *
023300200529     F*   83       PRINT EXTENDED SETTLEMENT DETAILS - S01401         *   S01401
023400200529     F*   90-99    USED IN STANDARD SUB-ROUTINES                      *
023500200529     F*   U7       DATABASE ERROR                                     *
023600200529     F*   U8       DATABASE / CONTROL ERROR                           *
023700200529     F*                                                               *
023800200529     F*****************************************************************
023900200529     F/SPACE 3
024000200529     F*****************************************************************
024100200529     F*                                                               *
024200200529     F*  S U B R O U T I N E   I N D E X                              *
024300200529     F*                                                               *
024400200529     F***ZSYSTM*-*ACCESS*ICD*RECORD************************************   S01117
024500200529     F*  ZDATE2 - DAYNO - DATE CONVERSION                             *
024600200529     F*  ZSEDIT - EDIT NUMERIC FIELDS                                 *
024700200529     F*  ZSDESC - FORMAT SECURITY DESCRIPTIONS                        *
024800200529     F*  *PSSR  - ERROR HANDLING                                      *   S01117
024900200529     F*  PRTADT - PROCESS TAX DETAILS                                 *   S01447
025000200529     F*                                                               *
025100200529     F*****************************************************************
025200200529      /EJECT
025300200529      /COPY ZSRSRC,ZDATE2Z1
025400200529     E/COPY ZSRSRC,ZSEDITZ1
025500200529      /COPY ZSRSRC,ZSDESCZ1
025600200529     E                    TABSET  5  11  2 0ATABLEG 14   SETTLEMENT METH. LEGEND
025700200529     E                    CPY@    1   1 80
025800200529      /EJECT
025900200529     ISECTYDF                                                             CSE023
026000200529     I              EXCD                            EXC1                  CSE023
026100200529     ICLINTCBF                                                            CSE023
026200200529     I              CTYP                            CTP1                  CSE023
026300200529     I*
026400200529     I*DA********UDS                            256                       S01117
026500200529     I***********                           134 177 DBLOT                 S01117
026600200529     I***********                           134 138 DBFILE                S01117
026700200529     I***********                           139 167 DBKEY                 S01117
026800200529     I***********                           168 175 DBPGM                 S01117
026900200529     I***********                           176 177 DBASE                 S01117
027000200529     ILDA         DS                            256                       S01117
027100200529     I                                      134 183 DBLOT                 S01117
027200200529     I                                      134 141 DBFILE                S01117
027300200529     I                                      142 170 DBKEY                 S01117
027400200529     I                                      171 180 DBPGM                 S01117
027500200529     I                                      181 1830DBASE                 S01117
027600200529     I**                                                                  S01117
027700200529     I**  EXTERNAL DS FOR BANK DETAILS                                    S01117
027800200529     ISDBANK    E DSSDBANKPD                                              S01117
027900200529     I              BJURPT                          TITL                  S01117
028000200529     I**                                                                  S01117
028100200529     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
028200200529     ISDBRCH    E DSSDBRCHPD                                              S01117
028300200529     I**                                                                  S01117
028400200529     I**  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01117
028500200529     ISDGELR    E DSSDGELRPD                                              S01117
028600200529     I**                                                                  S01117
028700200529     I**  EXTERNAL DS FOR SE ICD DETAILS                                  S01117
028800200529     ISDSTRD    E DSSDSTRDPD                                              S01117
028900200529     I** Portfolio Definition Via Access Program                          S01486
029000200529     I*                                                                   S01486
029100200529     ISDPORT    E DSSDPORTPD                                              S01486
029200200529     I*                                                                   S01486
029300200529     I**  EXTERNAL DS FOR MMOD acceSs object                              S01486
029400200529     I*                                                                   S01486
029500200529     ISDMMOD    E DSSDMMODPD                                              S01486
029600200529     I**                                                                  S01117
029700200529     I**  DATA STRUCTURE FOR RUN DATE DETAILS                             S01117
029800200529     IRUNDT       DS                                                      S01117
029900200529     I                                        1   7 RUNA                  S01117
030000200529     I                                    P   8  100RUND                  S01117
030100200529     I                                       11  11 SSF                   S01117
030200200529     I                                       12  12 DATF                  S01117
030300200529     I                                       13  13 MBIN                  S01117
030400200529     I*  DS FOR LINE NO. TO HANDLE OVERFLOW                               S01117
030500200529     ISPOOL       DS                                                      S01117
030600200529     I                                       83  92 SFILE                 S01117
030700200529     I                                    B 123 1240SFNUM                 S01117
030800200529     I/COPY WNCPYSRC,SE0335I001
030900200529     I**                                                                  S01117
031000200529     ISPOOLU      DS                                                      S01117
031100200529     I                                       83  92 SFILEU                S01117
031200200529     I                                    B 123 1240SFNUMU                S01117
031300200529     I**                                                                  S01117
031400200529     I** DATA STRUCTURE FOR ACCESS OBJECTS, SHORT DATA STRUCTURE          S01117
031500200529     IDSFDY     E DSDSFDY                                                 S01117
031600200529     I**                                                                  S01117
031700200529     I*
031800200529     I           SDS
031900200529     I                                      244 246 WSID
032000200529     I                                      254 263 USID
032100200529     I*                                                                   S01486
032200200529     I* DATA STRUCTURE FOR CHAIN FAILURE - PMPORTPP                       S01486
032300200529     I            DS                                                      S01486
032400200529     I                                        1  10 PMKEY                 S01486
032500200529     I**********                              1   60WPCPY                              S01486 CSD027
032600200529     I                                        1   6 WPCPY                                     CSD027
032700200529     I                                        7  10 PTFR                  S01486
032800200529     I*
032900200529      /COPY ZSRSRC,ZSDESCZ2
033000200529     I*
033100200529     I/COPY ZSRSRC,ZSEDITZ2
033200200529     I* DATA STRUCTURE FOR FILE KEYS
033300200529     I*
033400200529     I*********** DS                                                      S01117
033500200529     I***********                             1  12 TRKEY                 S01117
033600200529     I***********                             1   2 TRRECT                S01117
033700200529     I***********                             3   9 TRZZ7                 S01117
033800200529     I***********                            10  12 TRPBCH                S01117
033900200529     I*
034000200529     I            DS
034100200529     I                                        1  12 TLKEY
034200200529     I                                        1   2 TLRECT
034300200529     I                                        3   7 TLZZ5
034400200529     I                                        8  10 TLPSCU
034500200529     I                                       11  12 TLPSE2
034600200529     I*
034700200529     I            DS
034800200529     I                                        1  12 TKEY
034900200529     I                                        1   2 TRECT
035000200529     I                                        3   8 TZZ6
035100200529     I                                        9  11 TPNCY
035200200529     I                                       12  12 TSREC
035300200529     I*
035400200529     I* DATA STRUCTURE FOR SETTLEMENT ACCOUNT FIELD
035500200529     I*
035600200529     I            DS
035700200529     I**********                              1  12 PSEA                                      CGL029
035800200529     I                                        1  18 PSEA                                      CGL029
035900200529     I                                        1   6 PSEA06
036000200529     I**********                              7  10 PSEA04                                    CGL029
036100200529     I**********                             11  12 PSEA02                                    CGL029
036200200529     I                                        7  16 PSEA04                                    CGL029
036300200529     I                                       17  18 PSEA02                                    CGL029
036400200529      *                                                                   S01401
036500200529      ***  Data Structure for POSETDY1 Key.                               S01401
036600200529      *                                                                   S01401
036700200529     I            DS                                                      S01401
036800200529     I                                        1  24 POSKEY                S01401
036900200529     I                                        1   3 PBCA                  S01401
037000200529     I                                        4  13 PSSH                  S01401
037100200529     I**********                             14  190PCPY                               S01401 CSD027
037200200529     I                                       14  19 PCPY                                      CSD027
037300200529     I                                    P  20  220PDUD                  S01401
037400200529     I                                       23  24 PEVT                  S01401
037500200529      *                                                                   S01401
037600200529     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
037700200529     ICPYR@#      DS
037800200529     I                                        1  80 CPY@
037900200529     I                                        1  20 CPY@##
038000200529      *                                                                                       CGL029
038100200529     IDSSDY     E DSDSSDY                                                                     CGL029
038200200529      *                                                                                       CGL029
038300200529     IDSAUTH    E DSPSAUTD                                                                  AR324888
038400200529      ** PSAUTD Data Structure                                                              AR324888
038500200529      *                                                                                     AR324888
038600200529     I*
038700200529     C/EJECT
038800200529     C*================================================================
038900200529     C*  P R O G R A M     S T A R T
039000200529     C*================================================================
039100200529     C*
039200200529      **DEFINE*KEYLIST*FOR*CHAINING*TO*TABLETR*FILE***********************S01117
039300200529      *
039400200529     C***********TABTRK    KLIST                                          S01117
039500200529     C***********          KFLD           TRKEY                           S01117
039600200529      *
039700200529      * DEFINE KEYLIST FOR CHAINING TO CLINTCB FILE
039800200529      *
039900200529     C           CLICBK    KLIST
040000200529     C**********           KFLD           CBNUM   60                                          CSD027
040100200529     C                     KFLD           CBNUM   6                                           CSD027
040200200529     C                     KFLD           CBRCDT  1
040300200529      *
040400200529      * DEFINE KEYLIST FOR CHAINING TO TABLETL FILE
040500200529      *
040600200529     C           TABTLK    KLIST
040700200529     C                     KFLD           TLKEY
040800200529      *
040900200529      **DEFINE*KEYLIST*FOR*CHAINING*TO*SECHGD*FILE                        S01169
041000200529      * DEFINE KEYLIST FOR CHAINING TO SECGTD FILE                        S01169
041100200529      *
041200200529     C***********SECHGK    KLIST                                          S01169
041300200529     C           SECGTK    KLIST                                          S01169
041400200529     C                     KFLD           SECCY   3
041500200529     C                     KFLD           SECCOM  2
041600200529      *
041700200529      * DEFINE KEYLIST FOR CHAINING TO TABSE FILE-TABTG10
041800200529      *
041900200529     C           TABTK     KLIST
042000200529     C                     KFLD           TKEY
042100200529      *
042200200529      * DEFINE KEYLIST FOR CHAINING TO CLINTSE FILE
042300200529      *
042400200529     C           CLISEK    KLIST
042500200529     C**********           KFLD           SENUM   60                                          CSD027
042600200529     C                     KFLD           SENUM   6                                           CSD027
042700200529     C                     KFLD           SERCDT  1
042800200529      *                                                                   S01401
042900200529      ***  Define Keylist for Chaining to LF/POSETDY1.                    S01401
043000200529      *                                                                   S01401
043100200529     C           KPOSET    KLIST                                          S01401
043200200529     C                     KFLD           PBCA                            S01401
043300200529     C                     KFLD           PSSH                            S01401
043400200529     C                     KFLD           PCPY                            S01401
043500200529     C                     KFLD           PDUD                            S01401
043600200529     C                     KFLD           PEVT                            S01401
043700200529      *                                                                                     AR324888
043800200529     C           PSAUTH    KLIST                                                            AR324888
043900200529     C                     KFLD           PBCA                                              AR324888
044000200529     C                     KFLD           PSSH                                              AR324888
044100200529     C                     KFLD           PCPY                                              AR324888
044200200529     C                     KFLD           PDUD                                              AR324888
044300200529     C                     KFLD           PEVT                                              AR324888
044400200529     C                     KFLD           PTFR                                              AR324888
044500200529     C                     KFLD           TNLU                                              AR324888
044600200529     C                     KFLD           TXBS                                              AR324888
044700200529     C                     KFLD           BNFO                                              AR324888
044800200529     C                     KFLD           EXCD                                              AR324888
044900200529     C/COPY WNCPYSRC,SE0335C001
045000200529      *                                                                   S01486
045100200529      * DEFINE KEYLIST FOR CHAINING TO PMPORTPD FILE                      S01486
045200200529      *                                                                   S01486
045300200529     C           PMPORK    KLIST                                          S01486
045400200529     C                     KFLD           PCPY                            S01486
045500200529     C                     KFLD           PTFR                            S01486
045600200529      *                                                                   S01401
045700200529      * PREPARE LDA
045800200529      *
045900200529     C           *NAMVAR   DEFN           LDA                             S01117
046000200529     C           *LOCK     IN   LDA                        INITIALIZE     S01117
046100200529     C                     MOVEL*BLANK    DBLOT
046200200529     C                     MOVEL'SE0335'  DBPGM
046300200529     C                     OUT  LDA                                       S01117
046400200529     C**                                                                  S01117
046500200529     C** REGISTER SPOOL ENTRY FOR AU                                      S01117
046600200529     C                     EXSR RCFAU                                     S01117
046700200529     C**                                                                  S01117
046800200529     C** IN THE DATAAREA RUNDAT                                           S01117
046900200529     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
047000200529     C                     IN   RUNDT                                     S01117
047100200529     C**                                                                  S01117
047200200529     C**  TEST FOR MULTIBRANCHING                                         S01117
047300200529     C           MBIN      IFEQ 'Y'                                       S01117
047400200529     C                     SETON                     35                   S01117
047500200529     C                     END                                            S01117
047600200529     C**                                                                  S01117
047700200529     C** CHECK SYSTEM FORMAT DATE, DDMMYY OR MMDDYY(98 ON)                S01117
047800200529     C           DATF      IFEQ 'M'                                       S01117
047900200529     C                     SETON                     98                   S01117
048000200529     C                     ELSE                                           S01117
048100200529     C                     SETOF                     98                   S01117
048200200529     C                     END                                            S01117
048300200529     C**                                                                  S01117
048400200529     C** INITIALISE VARIABLE                                              S01117
048500200529     C                     MOVE *BLANKS   ZBRNM                           S01117
048600200529     C**                                                                  S01117
048700200529      *
048800200529      * INPUT PARAMETER :
048900200529      *
049000200529     C           *ENTRY    PLIST
049100200529     C                     PARM           MODE    1
049200200529     C                     PARM           SEQ     5                       S01117
049300200529     C                     PARM           ENT     3                       S01117
049400200529      *                                                                   S01401
049500200529      ***  Access SAR details file to see if MT5xx SAR is installed.      S01401
049600200529      *                                                                   S01401
049700200529     C                     CALL 'AOSARDR0'                                S01401
049800200529     C                     PARM '       ' @RTCD                           S01401
049900200529     C                     PARM '*VERIFY' @OPTN                           S01401
050000200529     C                     PARM 'S01401'  @SARD   6                       S01401
050100200529      *                                                                   S01401
050200200529     C           @RTCD     IFEQ *BLANK                                    S01401
050300200529     C                     MOVE 'Y'       S01401  1                       S01401
050400200529     C                     OPEN POSETDY1                                  S01401
050500200529     C                     END                                            S01401
050600200529      *                                                                   S01512
050700200529      **  Access SAR details file to see if core feature S01512   .       S01512
050800200529      **  is switched ON.                                                 S01512
050900200529      *                                                                   S01512
051000200529     C                     CALL 'AOSARDR0'                                S01512
051100200529     C                     PARM '       ' @RTCD                           S01512
051200200529     C                     PARM '*VERIFY' @OPTN                           S01512
051300200529     C                     PARM 'S01512'  @SARD   6                       S01512
051400200529      *                                                                   S01512
051500200529     C           @RTCD     IFEQ *BLANK                                    S01512
051600200529     C                     MOVE '1'       *IN38                           S01512
051700200529     C                     END                                            S01512
051800200529      *                                                                   S01496
051900200529      **  Access SAR details file to see if JYSKE Enhcmts is installed.   S01496
052000200529      *                                                                   S01496
052100200529     C                     CALL 'AOSARDR0'                                S01496
052200200529     C                     PARM '       ' @RTCD   7                       S01496
052300200529     C                     PARM '*VERIFY' @OPTN   7                       S01496
052400200529     C                     PARM 'S01496'  WSARD   6                       S01496
052500200529      *                                                                   S01496
052600200529     C           @RTCD     IFEQ *BLANK                                    S01496
052700200529     C                     MOVE 'Y'       S01496  1                       S01496
052800200529     C                     MOVE *ON       *IN70                           S01496
052900200529     C                     ENDIF                                          S01496
053000200529      *                                                                   CSE007
053100200529      **  Access SAR details file to see if Corporate Action installed.   CSE007
053200200529      *                                                                   CSE007
053300200529     C                     MOVE 'N'       CSE007  1                       CSE007
053400200529     C                     CALL 'AOSARDR0'                                CSE007
053500200529     C                     PARM '       ' @RTCD   7                       CSE007
053600200529     C                     PARM '*VERIFY' @OPTN   7                       CSE007
053700200529     C                     PARM 'CSE007'  WSARD   6                       CSE007
053800200529      *                                                                   CSE007
053900200529     C           @RTCD     IFEQ *BLANK                                    CSE007
054000200529     C                     MOVE 'Y'       CSE007  1                       CSE007
054100200529     C                     MOVE *ON       *IN70                           CSE007
054200200529     C                     ENDIF                                          CSE007
054300200529      *                                                                   CEU017
054400200529      **  Access SAR details file to see if Corporate Action installed.   CEU017
054500200529      *                                                                   CEU017
054600200529     C                     MOVE 'N'       CEU017  1                       CEU017
054700200529     C                     CALL 'AOSARDR0'                                CEU017
054800200529     C                     PARM '       ' @RTCD   7                       CEU017
054900200529     C                     PARM '*VERIFY' @OPTN   7                       CEU017
055000200529     C                     PARM 'CEU017'  WSARD   6                       CEU017
055100200529      *                                                                   CEU017
055200200529     C           @RTCD     IFEQ *BLANK                                    CEU017
055300200529     C                     MOVE 'Y'       CEU017  1                       CEU017
055400200529     C                     MOVE *ON       *IN70                           CEU017
055500200529     C                     ENDIF                                          CEU017
055600200529      *                                                                   CSE023
055700200529      ** Access Switchable features file                                  CSE023
055800200529      *                                                                   CSE023
055900200529     C                     CALL 'AOSARDR0'                                CSE023
056000200529     C                     PARM *BLANKS   PRTCD   7                       CSE023
056100200529     C                     PARM '*VERIFY' POPTN   7                       CSE023
056200200529     C                     PARM 'CSE023'  PSARD   6                       CSE023
056300200529      *                                                                   CSE023
056400200529     C           PRTCD     IFEQ *BLANKS                                   CSE023
056500200529     C                     MOVE 'Y'       CSE023  1                       CSE023
056600200529     C                     MOVE *ON       *IN85                           CSE023
056700200529     C                     ELSE                                           CSE023
056800200529     C                     MOVE 'N'       CSE023                          CSE023
056900200529     C                     MOVE *OFF      *IN85                           CSE023
057000200529     C                     ENDIF                                          CSE023
057100200529     C/COPY WNCPYSRC,SE0335C002
057200200529      *                                                                   S01512
057300200529      * DEFINE WORK FIELDS
057400200529      *
057500200529     C           *LIKE     DEFN LCD       ZLCD
057600200529     C           *LIKE     DEFN CHTP      ZCHTP
057700200529     C           *LIKE     DEFN TNLU      ZTNLU
057800200529     C           *LIKE     DEFN NOIN      ZINS
057900200529     C           *LIKE     DEFN NOAM      ZAMD
058000200529     C           *LIKE     DEFN NODE      ZDEL
058100200529     C/EJECT
058200200529      *================================================================
058300200529      *  FIRST TIME PROCESSING
058400200529      *================================================================
058500200529      *
058600200529      * SET INDICATORS FOR REPORT HEADING & OPEN INPUT FILE
058700200529     C           MODE      IFEQ 'I'
058800200529     C                     SETON                     40
058900200529     C                     ELSE
059000200529     C           MODE      IFEQ 'A'
059100200529     C                     SETON                     41
059200200529     C                     ELSE
059300200529     C                     SETON                     42
059400200529     C                     END
059500200529     C                     END
059600200529     C**                                                                  S01117
059700200529     C** INITIALISE OUTPUT ENTITY FIELDS BY INPUT PARAMETER               S01117
059800200529     C                     MOVE ENT       PBCA                            S01117
059900200529     C                     MOVE ENT       ZPBCA                           S01117
060000200529     C**                                                                  S01117
060100200529     C**   ACCESS BANK DETAILS, FOR TITLE                                 S01117
060200200529     C                     CALL 'AOBANKR0'                                S01117
060300200529     C                     PARM '*MSG   ' @RTCD   7                       S01117
060400200529     C                     PARM '*FIRST ' @OPTN   7                       S01117
060500200529     C           SDBANK    PARM SDBANK    DSFDY                           S01117
060600200529     C*                                                                   S01117
060700200529     C           @RTCD     IFNE *BLANK                                    S01117
060800200529     C           *LOCK     IN   LDA                                       S01117
060900200529     C                     MOVEL'SDBANKPD'DBFILE                          S01117
061000200529     C                     MOVEL@OPTN     DBKEY            ***************S01117
061100200529     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01117
061200200529     C                     Z-ADD1         DBASE            ***************S01117
061300200529     C                     OUT  LDA                                       S01117
061400200529     C                     EXSR DBERR                                     S01117
061500200529     C                     END                                            S01117
061600200529     C**                                                                  S01117
061700200529     C**   ACCESS GENERAL LEDGER DETAILS FOR PROFIT CENTRE IND.           S01117
061800200529     C**********           CALL 'AOGELRR0'                                S01117              CGL029
061900200529     C                     CALL 'AOGELRR1'                                                    CGL029
062000200529     C                     PARM '*MSG   ' @RTCD   7                       S01117
062100200529     C                     PARM '*FIRST ' @OPTN   7                       S01117
062200200529     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
062300200529     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
062400200529     C*                                                                   S01117
062500200529     C           @RTCD     IFNE *BLANK                                    S01117
062600200529     C           *LOCK     IN   LDA                                       S01117
062700200529     C                     MOVEL'SDGELRPD'DBFILE                          S01117
062800200529     C                     MOVE *BLANKS   DBKEY                           S01117
062900200529     C                     MOVEL@OPTN     DBKEY            ***************S01117
063000200529     C                     MOVEL@OPTN     DBOPTN           * DBERROR 004 *S01117
063100200529     C                     Z-ADD4         DBASE            ***************S01117
063200200529     C                     OUT  LDA                                       S01117
063300200529     C                     EXSR DBERR                                     S01117
063400200529     C                     END                                            S01117
063500200529     C*                                                                   S01447
063600200529      ***  Access Switchable features file to see if S01447 is on.        S01447
063700200529      *                                                                   S01447
063800200529     C                     MOVE *OFF      *IN34                           S01447
063900200529     C                     MOVE 'N'       S01447  1                       S01447
064000200529     C                     CALL 'AOSARDR0'                                S01447
064100200529     C                     PARM *BLANKS   @RTCD   7                       S01447
064200200529     C                     PARM '*VERIFY' @OPTN   7                       S01447
064300200529     C                     PARM 'S01447'  @SARD   6                       S01447
064400200529      *                                                                   S01447
064500200529     C           @RTCD     IFEQ *BLANK                                    S01447
064600200529     C                     MOVE 'Y'       S01447  1                       S01447
064700200529     C                     SETON                     34                   S01447
064800200529     C                     ENDIF                                          S01447
064900200529     C** IF PM PRESENT SET IN39 ON                                        S01486
065000200529     C*                                                                   S01486
065100200529     C                     CALL 'AOMMODR0'                                S01486
065200200529     C                     PARM *BLANKS   @RTCD   7                       S01486
065300200529     C                     PARM '*FIRST ' @OPTN   7                       S01486
065400200529     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
065500200529     C*                                                                   S01486
065600200529     C           @RTCD     IFNE *BLANK                                    S01486
065700200529     C           *LOCK     IN   LDA                                       S01486
065800200529     C                     MOVEL'SDMMODPD'DBFILE                          S01486
065900200529     C                     MOVE *BLANKS   DBKEY                           S01486
066000200529     C                     MOVEL@OPTN     DBKEY            ***************S01486
066100200529     C                     MOVEL@OPTN     DBOPTN           * DBERROR 009 *S01486
066200200529     C                     Z-ADD9         DBASE            ***************S01486
066300200529     C                     OUT  LDA                                       S01486
066400200529     C                     EXSR DBERR                                     S01486
066500200529     C                     ENDIF                                          S01486
066600200529      *                                                                   CAC002
066700200529      **  Set up analytical accounting indicator                          CAC002
066800200529      *                                                                   CAC002
066900200529     C           BGN0ST    IFEQ 'Y'                                       CAC002
067000200529     C                     MOVE '1'       *IN20                           CAC002
067100200529     C                     ELSE                                           CAC002
067200200529     C                     MOVE '0'       *IN20                           CAC002
067300200529     C                     ENDIF                                          CAC002
067400200529     C*                                                                   S01486
067500200529     C           BGPFMG    IFEQ 'Y'                                       S01486
067600200529     C           BGN4ST    OREQ 'Y'                                       CPB001
067700200529     C                     MOVE *ON       *IN39                           S01486
067800200529     C                     ELSE                                           S01486
067900200529     C                     MOVE *OFF      *IN39                           S01486
068000200529     C                     ENDIF                                          S01486
068100200529      *                                                                   S01486
068200200529      * OBTAIN PORTFOLIO MANAGEMENT ICD                                   S01486
068300200529      *                                                                   S01486
068400200529     C           *IN39     IFEQ '1'                                       S01486
068500200529     C           BGPFMG    ANDEQ'Y'                                       CPB001
068600200529     C                     CALL 'AOPORTR0'                                S01486
068700200529     C                     PARM *BLANKS   @RTCD   7                       S01486
068800200529     C                     PARM '*FIRST ' @OPTN   7                       S01486
068900200529     C           SDPORT    PARM SDPORT    DSFDY                           S01486
069000200529     C*                                                                   S01486
069100200529     C           @RTCD     IFNE *BLANKS                                   S01486
069200200529     C           *LOCK     IN   LDA                                       S01486
069300200529     C                     MOVEL'SDPORTPD'DBFILE                          S01486
069400200529     C                     MOVE *BLANKS   DBKEY                           S01486
069500200529     C                     MOVEL@OPTN     DBKEY            ***************S01486
069600200529     C                     MOVEL@OPTN     DBOPTN           * DBERROR 010 *S01486
069700200529     C                     Z-ADD10        DBASE            ***************S01486
069800200529     C                     OUT  LDA                                       S01486
069900200529     C                     EXSR DBERR                                     S01486
070000200529     C                     ENDIF                                          S01486
070100200529     C                     ENDIF                                          S01486
070200200529      *                                                                   S01447
070300200529     C**                                                                  S01117
070400200529     C** CHECK IF PROFIT CENTRE USED                                      S01117
070500200529     C           BKPRCU    IFEQ 'Y'                                       S01117
070600200529     C                     MOVE '1'       *IN37                           S01117
070700200529     C                     END                                            S01117
070800200529      *
070900200529      *
071000200529      **GET*INSTALLATION*CONTROL*DATA*RECORD*1****************************S01117
071100200529      *
071200200529     C***********          EXSR ZSYSTM                                    S01117
071300200529      *
071400200529      **ERROR*IN*ZSYSTM***************************************************S01117
071500200529      *
071600200529     C************IN,99    IFEQ '1'                                       S01117
071700200529     C***********          MOVEL'1'       *INU8                           S01117
071800200529     C***********          MOVEL'1'       *INU7                           S01117
071900200529     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
072000200529     C***********          MOVEL'TABLE'   DBFILE                          S01117
072100200529     C***********          MOVELZTABKY    DBKEY                           S01117
072200200529     C***********          WRITEHEADAU                                    S01117
072300200529     C***********          WRITEERROR                                     S01117
072400200529     C***********          WRITETRAILAU                                   S01117
072500200529     C***********          GOTO ENDPGM                                    S01117
072600200529     C***********          END                                            S01117
072700200529      *
072800200529      *
072900200529     C***********          OPEN POSET                                     178530
073000200529     C                     OPEN POSET1                                    178530
073100200529     C                     Z-ADD3         MAXCNT  20
073200200529     C*                                                                   S01408
073300200529     C/COPY WNCPYSRC,SE0335CCPG                                           S01408
073400200529     C*                                                                   S01408
073500200529     C/SPACE 3
073600200529      *================================================================
073700200529      *  M A I N   P R O C E S S I N G
073800200529      *================================================================
073900200529      *
074000200529      *
074100200529     C***********          READ POSET                    50               178530
074200200529     C                     READ POSET1                   50               178530
074300200529      *
074400200529     C** CHECK FOR REQUESTED BRANCH FOR MULTIBRANCHING                    S01117
074500200529     C           MBIN      IFEQ 'Y'                                       S01117
074600200529     C           ENT       IFNE 'ALL'                                     S01117
074700200529     C           ENT       ANDNEPBCA                                      S01117
074800200529     C                     MOVE '1'       *IN50                           S01117
074900200529     C                     MOVE '1'       *IN80                           S01117
075000200529     C                     GOTO ENDSEL                                    S01117
075100200529     C                     END                                            S01117
075200200529     C                     END                                            S01117
075300200529      *
075400200529     C           *IN50     DOWNE'1'
075500200529      *                                                                                     AR324888
075600200529     C                     MOVEA'00000000'*IN,72                                            AR324888
075700200529     C                     CLEARDSAUTH                                                      AR324888
075800200529     C                     Z-ADD*ZERO     ZLCD                                              AR324888
075900200529     C                     MOVE *BLANK    ZCHTP                                             AR324888
076000200529      *                                                                                     AR324888
076100200529     C           PSAUTH    CHAINPSAUT                88                                     AR324888
076200200529      *                                                                                     AR324888
076300200529     C           *IN88     IFEQ *OFF                                                        AR324888
076400200529      *                                                                                     AR324888
076500200529     C           PAUUSR    IFNE *BLANK                                                      AR324888
076600200529     C           PAPCTP    ANDNE'U'                                                         AR324888
076700200529     C           PALCTP    ANDNE'U'                                                         AR324888
076800200529     C                     MOVE *ON       *IN72                                             AR324888
076900200529     C                     Z-ADDPALUD     ZDAYNO                                            AR324888
077000200529     C                     EXSR ZDATE2                                                      AR324888
077100200529     C                     MOVE ZADATE    ZRLCD                                             AR324888
077200200529     C                     ENDIF                                                            AR324888
077300200529      *                                                                                     AR324888
077400200529     C           PAPUSR    IFNE *BLANK                                                      AR324888
077500200529     C                     MOVE *ON       *IN73                                             AR324888
077600200529     C                     Z-ADDPAPCD     ZDAYNO                                            AR324888
077700200529     C                     EXSR ZDATE2                                                      AR324888
077800200529     C                     MOVE ZADATE    ZPLCD                                             AR324888
077900200529      *                                                                                     AR324888
078000200529     C                     SELEC                                                            AR324888
078100200529     C           PAPCTP    WHEQ 'I'                                                         AR324888
078200200529     C                     MOVE *ON       *IN74                                             AR324888
078300200529     C           PAPCTP    WHEQ 'A'                                                         AR324888
078400200529     C                     MOVE *ON       *IN75                                             AR324888
078500200529     C           PAPCTP    WHEQ 'D'                                                         AR324888
078600200529     C                     MOVE *ON       *IN76                                             AR324888
078700200529     C           PAPCTP    WHEQ 'Y'                                                         AR324888
078800200529     C                     MOVE *ON       *IN77                                             AR324888
078900200529     C           PAPCTP    WHEQ 'U'                                                         AR324888
079000200529     C                     MOVE *ON       *IN78                                             AR324888
079100200529     C           PAPCTP    WHEQ 'R'                                                         AR324888
079200200529     C                     MOVE *ON       *IN79                                             AR324888
079300200529     C                     ENDSL                                                            AR324888
079400200529     C                     ENDIF                                                            AR324888
079500200529      *                                                                                     AR324888
079600200529     C                     Z-ADDPALCD     ZLCD                                              AR324888
079700200529     C                     MOVE PALCTP    ZCHTP                                             AR324888
079800200529     C                     ELSE                                                             AR324888
079900200529      *
080000200529      * A RECORD HAS BEEN READ :-
080100200529      *
080200200529      * MOVE DATA INTO UNIQUE FIELDS
080300200529      *
080400200529     C                     Z-ADDLCD       ZLCD
080500200529     C                     MOVE CHTP      ZCHTP
080600200529     C                     ENDIF                                                            AR324888
080700200529     C                     Z-ADDTNLU      ZTNLU
080800200529      *
080900200529      * IF PARM=I & LAST CHANGE DATE NOT = RUN DATE - IGNORE
081000200529     C           MODE      IFEQ 'I'
081100200529     C           ZLCD      IFNE RUND
081200200529     C                     GOTO NEXT
081300200529     C                     END
081400200529     C                     END
081500200529     C*                                                                   S01496
081600200529     C**  If Jyske Enhancements is not installed, ignore records          S01496
081700200529     C**  with RECI = 'R' and records with PEVT = 'RC'                    S01496
081800200529     C*                                                                   S01496
081900200529     C           S01496    IFNE 'Y'                                       S01496
082000200529     C           RECI      IFEQ 'R'                                       S01496
082100200529     C           CSE007    ANDNE'Y'                                       CSE007
082200200529     C           CEU017    ANDNE'Y'                                       CEU017
082300200529     C           PEVT      OREQ 'RC'                                      S01496
082400200529     C                     GOTO NEXT                                      S01496
082500200529     C                     END                                            S01496
082600200529     C                     END                                            S01496
082700200529      *
082800200529      * MAINTAIN COUNTS AS NECESSARY
082900200529     C           MODE      IFEQ 'I'
083000200529     C           MODE      OREQ 'A'
083100200529      *
083200200529      **  IF RUN DATE IS THE SAME AS LAST CHANGE DATE
083300200529      *
083400200529     C           ZLCD      IFEQ RUND
083500200529      * I OR A MODES - INCLUDE DELETED RECORDS
083600200529     C           ZCHTP     IFEQ 'I'
083700200529     C                     ADD  1         ZINS
083800200529     C                     ELSE
083900200529     C           ZCHTP     IFEQ 'A'
084000200529     C                     ADD  1         ZAMD
084100200529     C                     ELSE
084200200529     C           ZCHTP     IFEQ 'D'
084300200529     C                     ADD  1         ZDEL
084400200529     C                     ELSE
084500200529     C           ZCHTP     IFEQ 'Y'
084600200529     C           ZCHTP     OREQ 'R'                                       S01496
084700200529     C           S01496    ANDEQ'Y'                                       S01496
084800200529     C           ZCHTP     OREQ 'R'                                       CSE007
084900200529     C           CSE007    ANDEQ'Y'                                       CSE007
085000200529     C           CEU017    ANDEQ'Y'                                       CEU017
085100200529     C                     ADD  1         ZAUTH
085200200529     C                     END
085300200529     C                     END
085400200529     C                     END
085500200529     C                     END
085600200529     C                     END
085700200529     C                     END
085800200529      * I MODE - COUNT OF RECORDS CHANGED TODAY
085900200529     C           MODE      IFEQ 'I'
086000200529     C           ZLCD      IFEQ RUND
086100200529     C                     ADD  1         ZCHG
086200200529     C                     ADD  1         ZCHGP1
086300200529     C                     END
086400200529     C                     ELSE
086500200529      * A MODE -
086600200529     C           MODE      IFEQ 'A'
086700200529      * A MODE - COUNT OF RECORDS READ + LIVE RECORDS
086800200529     C           RECI      IFNE '*'
086900200529     C           RECI      ANDNE'M'                                       E14884
087000200529     C******************** ADD  1         ZLIVE                           S01496
087100200529     C           S01496    IFEQ 'Y'                                       S01496
087200200529     C           CSE007    OREQ 'Y'                                       CSE007
087300200529     C           CEU017    OREQ 'Y'                                       CEU017
087400200529     C           RECI      IFNE 'R'                                       S01496
087500200529     C                     ADD  1         ZLIVE                           S01496
087600200529     C                     ENDIF                                          S01496
087700200529     C                     ELSE                                           091886
087800200529     C                     ADD  1         ZLIVE                           091886
087900200529     C                     ENDIF                                          S01496
088000200529     C                     END
088100200529     C           ZLCD      IFEQ RUND
088200200529     C                     ADD  1         ZCOUNT
088300200529     C                     ELSE
088400200529      *        - IGNORE IF LCD NOT EQUAL RUN DATE
088500200529     C                     GOTO NEXT
088600200529     C                     END
088700200529      *
088800200529     C                     ELSE
088900200529      * L MODE - COUNT OF LIVE RECORDS
089000200529     C           RECI      IFNE '*'
089100200529     C           RECI      ANDNE'M'                                       E14884
089200200529     C*                                                                   S01496
089300200529     C           S01496    IFEQ 'Y'                                       S01496
089400200529     C           CSE007    OREQ 'Y'                                       CSE007
089500200529     C           CEU017    OREQ 'Y'                                       CEU017
089600200529     C           RECI      IFNE 'R'                                       S01496
089700200529     C                     ADD  1         ZLIVE
089800200529     C                     ADD  1         ZLIVP1
089900200529     C                     ENDIF                                          S01496
090000200529     C                     ELSE                                           S01496
090100200529     C                     ADD  1         ZLIVE
090200200529     C                     ADD  1         ZLIVP1
090300200529     C                     END                                            S01496
090400200529     C*                                                                   S01496
090500200529     C                     ELSE
090600200529      * L MODE - IGNORE IF DELETED RECORD
090700200529     C                     GOTO NEXT
090800200529     C                     END
090900200529     C                     END
091000200529     C                     END
091100200529      *
091200200529      * RECORD TO BE PRINTED -
091300200529      *     OPEN OUTPUT FILE IF REQUIRED FIRST TIME ONLY
091400200529     C           *IN82     IFEQ '0'
091500200529     C                     SETON                     82
091600200529     C                     Z-ADD4         LINCNT  20
091700200529     C                     OPEN SE0335P1
091800200529     C                     EXSR RCFP1                                     S01117
091900200529     C                     MOVE PBCA      ZPBCA                           S01117
092000200529      *
092100200529      ******FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY****************S01117
092200200529      ******IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK*********************S01117
092300200529     C***********          MOVEL'10      'TRKEY                           S01117
092400200529     C***********          MOVE PBCH      TRPBCH                          S01117
092500200529     C***********TABTRK    CHAINTABLETRF             57                   S01117
092600200529     C************IN57     IFEQ '1'                                       S01117
092700200529     C***********          MOVE *BLANK    ZBRNM                           S01117
092800200529     C***********          ELSE                                           S01117
092900200529     C***********RECI      IFNE '*'                                       S01117
093000200529     C***********          MOVE BRNM      ZBRNM                           S01117
093100200529     C***********          ELSE                                           S01117
093200200529     C***********          MOVE *BLANK    ZBRNM                           S01117
093300200529     C***********          END                                            S01117
093400200529     C***********          END                                            S01117
093500200529     C**                                                                  S01117
093600200529     C                     SETOF                     80
093700200529     C**                                                                  S01117
093800200529     C** FOR MULTIBRANCHING, ACCESS BRANCH NAME WITH ACCESS OBJECT        S01117
093900200529     C           MBIN      IFEQ 'Y'                                       S01117
094000200529     C                     MOVE PBCA      PENT    3                       S01117
094100200529     C                     EXSR ACCBRH                                    S01117
094200200529     C                     END                                            S01117
094300200529     C**                                                                  S01117
094400200529     C                     ELSE
094500200529      *     OPEN OUTPUT FILE IF REQUIRED NEW BRANCH
094600200529     C           *IN80     IFEQ '1'
094700200529     C                     Z-ADD4         LINCNT
094800200529     C                     Z-ADD0         PAGE
094900200529     C                     OPEN SE0335P1
095000200529     C                     EXSR RCFP1                                     S01117
095100200529     C                     MOVE PBCA      ZPBCA                           S01117
095200200529      ******FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY****************S01117
095300200529      ******IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK*********************S01117
095400200529     C***********          MOVEL'10      'TRKEY                           S01117
095500200529     C***********          MOVE PBCH      TRPBCH                          S01117
095600200529     C***********TABTRK    CHAINTABLETRF             57                   S01117
095700200529     C************IN57     IFEQ '1'                                       S01117
095800200529     C***********          MOVE *BLANK    ZBRNM                           S01117
095900200529     C***********          ELSE                                           S01117
096000200529     C***********RECI      IFNE '*'                                       S01117
096100200529     C***********          MOVE BRNM      ZBRNM                           S01117
096200200529     C***********          ELSE                                           S01117
096300200529     C***********          MOVE *BLANK    ZBRNM                           S01117
096400200529     C***********          END                                            S01117
096500200529     C***********          END                                            S01117
096600200529     C**                                                                  S01117
096700200529     C                     SETOF                     80
096800200529     C**                                                                  S01117
096900200529     C** FOR MULTIBRANCHING, ACCESS BRANCH NAME WITH ACCESS OBJECT        S01117
097000200529     C           MBIN      IFEQ 'Y'                                       S01117
097100200529     C                     MOVE PBCA      PENT    3                       S01117
097200200529     C                     EXSR ACCBRH                                    S01117
097300200529     C                     END                                            S01117
097400200529     C**                                                                  S01117
097500200529     C                     END
097600200529     C                     END
097700200529      *
097800200529      *     PRINT PAGE HEADINGS
097900200529     C           LINCNT    IFGE MAXCNT
098000200529     C                     Z-ADD0         LINCNT
098100200529     C                     WRITEHEADP1
098200200529     C                     END
098300200529      *
098400200529      * FORMAT OUTPUT & PRINT FOR PRINTER FILE
098500200529      *
098600200529      * FIRST COLUMN    ***
098700200529      * FORMAT SECURITY SHORTNAME / DESCRIPTION
098800200529     C           PSSH      CHAINSECTYDF              59
098900200529     C           *IN59     IFEQ '0'
099000200529     C           RECI      IFEQ '*'
099100200529     C                     SETON                     59
099200200529     C                     END
099300200529     C                     END
099400200529     C           *IN59     IFEQ '1'
099500200529     C***********          MOVEL'1'       *INU8                           S01117
099600200529     C***********          MOVEL'1'       *INU7                           S01117
099700200529     C***********          MOVEL'03'      DBASE            **DB ERROR 03**S01117
099800200529     C           *LOCK     IN   LDA                                       S01117
099900200529     C                     Z-ADD3         DBASE            **DB ERROR 03**S01117
100000200529     C                     MOVEL'SECTY'   DBFILE
100100200529     C                     MOVELPSSH      DBKEY
100200200529     C                     OUT  LDA                                       S01117
100300200529     C                     EXSR DBERR                                     S01117
100400200529     C***********          WRITEHEADAU                                    S01117
100500200529     C***********          WRITEERROR                                     S01117
100600200529     C***********          WRITETRAILAU                                   S01117
100700200529     C***********          GOTO ENDPGM                                    S01117
100800200529     C                     END
100900200529      *    PREPARE FIELDS FOR REPORT NAME
101000200529     C                     MOVE SRPN      ZSRPN
101100200529     C                     MOVE *BLANK    ZSFN1
101200200529     C                     MOVE *BLANK    ZSFN2
101300200529      *    ZSDESC REPORT NAME
101400200529     C                     EXSR ZSDESC
101500200529     C                     MOVE ZRNME     RNME
101600200529      * FORMAT  CUSTOMER REPORT NAME/TOWN FOR COUNTERPARTY CUSTOMER NO.
101700200529      *    READ CLINTCB FILE USING KEY
101800200529      *    IF NO RECORD/RECORD DELETED/ - PRINT BLANK
101900200529     C**********           Z-ADDPCPY      CBNUM                                               CSD027
102000200529     C                     MOVE PCPY      CBNUM                                               CSD027
102100200529     C                     MOVE 'A'       CBRCDT
102200200529     C           CLICBK    CHAINCLINTCBF             58
102300200529     C           *IN58     IFEQ '1'
102400200529     C                     MOVE *BLANK    CSNMC
102500200529     C                     MOVE *BLANK    CRNMC
102600200529     C                     MOVE *BLANK    CTWNC
102700200529     C                     ELSE
102800200529     C           RECI      IFNE '*'
102900200529     C                     MOVE CSNM      CSNMC
103000200529     C                     MOVE CRNM      CRNMC
103100200529     C                     MOVE CTWN      CTWNC
103200200529     C                     ELSE
103300200529     C                     MOVE *BLANK    CSNMC
103400200529     C                     MOVE *BLANK    CRNMC
103500200529     C                     MOVE *BLANK    CTWNC
103600200529     C                     END
103700200529     C                     END
103800200529      *
103900200529      * FORMAT DUE DATE
104000200529     C                     Z-ADDPDUD      ZDAYNO
104100200529     C                     EXSR ZDATE2
104200200529     C                     MOVE ZADATE    ZAPDUD
104300200529      *                                                                   S01512
104400200529      ** Format Value Date if core feature S01512 switched ON             S01512
104500200529     C           *IN38     IFEQ '1'                                       S01512
104600200529     C                     Z-ADDPSVL      ZDAYNO                          S01512
104700200529     C                     EXSR ZDATE2                                    S01512
104800200529     C                     MOVE ZADATE    ZAPSVL                          S01512
104900200529     C                     END                                            S01512
105000200529      *
105100200529      * FORMAT EVENT TYPE LEGEND
105200200529     C                     MOVE *BLANK    LPEVT  14
105300200529     C                     MOVE *BLANK    WWPTYP  2                       CSE007
105400200529     C           PEVT      IFEQ 'CP'
105500200529     C                     MOVEL'COUPON ' LPEVT
105600200529     C                     MOVE 'DATE   ' LPEVT
105700200529     C                     ELSE
105800200529     C           PEVT      IFEQ 'DV'
105900200529     C                     MOVE 'DIVIDEND'LPEVT
106000200529     C                     ELSE
106100200529     C           PEVT      IFEQ 'PP'
106200200529     C                     MOVE 'P.P.CALL'LPEVT
106300200529     C                     ELSE
106400200529     C           PEVT      IFEQ 'MT'
106500200529     C                     MOVE 'MATURITY'LPEVT
106600200529     C                     ELSE
106700200529     C           PEVT      IFEQ 'RC'                                      S01496
106800200529     C           S01496    ANDEQ'Y'                                       S01496
106900200529     C                     MOVE 'EARLY RE'LPEVT                           S01496
107000200529     C                     MOVE 'DEMP.'   LPEVT                           S01496
107100200529     C                     ELSE                                           S01496
107200200529     C           PEVT      IFEQ 'MP'
107300200529     C                     MOVEL'MORTGAGE'LPEVT
107400200529     C                     MOVE 'PAYT.'   LPEVT
107500200529     C                     ELSE                                           CSE007
107600200529     C           CSE007    IFEQ 'Y'                                       CSE007
107700200529     C           CEU017    OREQ 'Y'                                       CEU017
107800200529     C*                                                                   CSE007
107900200529     C           PEVT      CHAINSECOATL0             89                   CSE007
108000200529     C           *IN89     IFEQ '0'                                       CSE007
108100200529     C                     MOVEL'CORPORAT'LPEVT                           CSE007
108200200529     C                     MOVE 'E ACT.'  LPEVT                           CSE007
108300200529     C                     MOVE MMPTYP    WWPTYP                          CSE007
108400200529     C                     END                                            CSE007
108500200529     C*                                                                   CSE007
108600200529     C                     END                                            CSE007
108700200529     C                     END
108800200529     C                     END                                            S01496
108900200529     C                     END
109000200529     C                     END
109100200529     C                     END
109200200529     C                     END
109300200529      * FORMAT NOMINAL POSITION
109400200529      *    USE DEC PLACES FROM SECTYD FOR ZDECS
109500200529      *    AS INPUT TO ZSEDIT
109600200529     C           PNMP      IFEQ 0
109700200529     C                     MOVE *BLANK    ZEPNMP
109800200529     C                     ELSE
109900200529     C                     Z-ADDNMDP      ZDECS
110000200529      *
110100200529     C                     MOVE *BLANKS   ZFLD15
110200200529     C                     MOVE PNMP      ZFLD15
110300200529     C                     MOVE 'J'       ZECODE
110400200529     C                     EXSR ZSEDIT
110500200529     C                     MOVE ZOUT21    ZEPNMP 16
110600200529     C                     END
110700200529      *
110800200529      * FORMAT PAY SETTLEMENT LEGEND
110900200529     C                     SETOF                     60
111000200529     C           PSMT      LOKUPTABSET    TABLEG         60
111100200529     C           *IN60     IFEQ '0'
111200200529     C                     MOVE *BLANK    LPSMT  14
111300200529     C                     ELSE
111400200529     C                     MOVE TABLEG    LPSMT
111500200529     C                     END
111600200529      *
111700200529      * FORMAT SETT.ACCOUNT DEPENDING ON SETTLEMENT METHOD
111800200529     C**********           MOVE *BLANK    ZPSE14 14                                           CGL029
111900200529     C**********           MOVE *BLANK    ZPSE12 12                                           CGL029
112000200529     C                     MOVE *BLANK    ZPSE14 20                                           CGL029
112100200529     C                     MOVE *BLANK    ZPSE12 18                                           CGL029
112200200529      *
112300200529      *    FORMAT NNNNNN-NN-NNNN FOR SETTLEMENT CODE 05
112400200529     C           PSMT      IFEQ 05
112500200529     C                     MOVELPSEA06    ZPSE07  7
112600200529     C                     MOVE '-'       ZPSE07
112700200529      *
112800200529     C**********           MOVELPSEA04    ZPSE05  5                                           CGL029
112900200529     C                     MOVELPSEA04    ZPSE05 11                                           CGL029
113000200529     C                     MOVE '-'       ZPSE05
113100200529      *
113200200529     C                     MOVELZPSE07    ZPSE12
113300200529     C                     MOVE ZPSE05    ZPSE12
113400200529      *
113500200529     C                     MOVELZPSE12    ZPSE14
113600200529     C                     MOVE PSEA02    ZPSE14
113700200529     C                     ELSE
113800200529      *    FORMAT SETTLEMENT METHODS 01 02 07 08 12
113900200529     C           PSMT      IFEQ 01
114000200529      *
114100200529     C           PSMT      OREQ 02
114200200529      *
114300200529     C           PSMT      OREQ 07
114400200529      *
114500200529     C           PSMT      OREQ 08
114600200529      *
114700200529     C           PSMT      OREQ 12
114800200529      *
114900200529      *    TABLETL FILE USING KEY
115000200529      *    IF NO RECORD/RECORD DELETED - PRINT PSEA NOT SHORTNAME
115100200529      *
115200200529     C                     MOVE '70'      TLRECT
115300200529     C                     MOVE PSCU      TLPSCU
115400200529     C                     MOVELPSEA      TLPSE2
115500200529     C           TABTLK    CHAINTABLETLF             61
115600200529     C           *IN61     IFEQ '1'
115700200529     C                     MOVELPSEA      ZPSE14
115800200529     C                     ELSE
115900200529     C           RECI      IFEQ '*'
116000200529     C                     MOVELPSEA      ZPSE14
116100200529     C                     ELSE
116200200529      *
116300200529      * FORMAT CUSTOMER SHORT NAME
116400200529      *    READ CLINTCB FILE USING KEY
116500200529      *    IF NO RECORD/RECORD DELETED/ - PRINT PSEA NOT SHORTNAME
116600200529     C**********           Z-ADDCNUM      CBNUM                                               CSD027
116700200529     C                     MOVE CNUM      CBNUM                                               CSD027
116800200529     C                     MOVE 'A'       CBRCDT
116900200529     C           CLICBK    CHAINCLINTCBF             58
117000200529     C           *IN58     IFEQ '1'
117100200529     C                     MOVELPSEA      ZPSE14
117200200529     C                     ELSE
117300200529     C           RECI      IFEQ '*'
117400200529     C                     MOVELPSEA      ZPSE14
117500200529     C                     ELSE
117600200529     C                     MOVELTLPSE2    ZPSE12
117700200529     C                     MOVE CSNM      ZPSE12
117800200529     C                     MOVELZPSE12    ZPSE14
117900200529     C                     END
118000200529     C                     END
118100200529     C                     END
118200200529     C                     END
118300200529      *    CATCH ALL - ANY OTHER SETTLEMENT CODES
118400200529     C                     ELSE
118500200529     C                     MOVELPSEA      ZPSE14
118600200529      *
118700200529     C                     END
118800200529     C                     END
118900200529      *
119000200529      * FORMAT NOM CCY POSETA
119100200529     C                     MOVE PNCY      ZPNCYA
119200200529      *
119300200529      * FORMAT PAY/REC LEGEND
119400200529     C                     SETOF                     646566
119500200529     C                     SETOF                     67
119600200529      *     PPRE IS P
119700200529     C           PPRE      IFEQ 'P'
119800200529     C                     SETON                     64
119900200529     C                     ELSE
120000200529      *     PPRE IS R
120100200529     C                     SETON                     65
120200200529     C                     END
120300200529      *
120400200529      * FORMAT AMOUNT
120500200529     C                     MOVEL'20      'TKEY
120600200529     C                     MOVE PNCY      TPNCY
120700200529     C                     MOVE '1'       TKEY
120800200529     C           TABTK     CHAINTABTG10F             63
120900200529     C           *IN63     IFEQ '0'
121000200529     C           RECI      IFEQ '*'
121100200529     C                     SETON                     63
121200200529     C                     END
121300200529     C                     END
121400200529     C           *IN63     IFEQ '1'
121500200529     C***********          MOVEL'1'       *INU8                           S01117
121600200529     C***********          MOVEL'1'       *INU7                           S01117
121700200529     C**********           MOVEL'04'      DBASE            **DB ERROR 04**E20651
121800200529     C***********          MOVEL'06'      DBASE            **DB E E20651  S01117
121900200529     C           *LOCK     IN   LDA                                       S01117
122000200529     C                     Z-ADD6         DBASE            **DB ERROR 06**S01117
122100200529     C                     MOVEL'TABLE'   DBFILE
122200200529     C                     MOVELTKEY      DBKEY
122300200529     C                     OUT  LDA                                       S01117
122400200529     C                     EXSR DBERR                                     S01117
122500200529     C***********          WRITEHEADAU                                    S01117
122600200529     C***********          WRITEERROR                                     S01117
122700200529     C***********          WRITETRAILAU                                   S01117
122800200529     C***********          GOTO ENDPGM                                    S01117
122900200529     C                     END
123000200529      *    USE DEC PLACES FROM TABTG10 FOR ZDECS
123100200529      *    AS INPUT TO ZSEDIT
123200200529     C                     Z-ADDCDP       ZDECS
123300200529      *
123400200529     C                     Z-ADDPAMD      ZFLD15
123500200529     C                     MOVE 'J'       ZECODE
123600200529     C                     EXSR ZSEDIT
123700200529     C                     MOVE ZOUT21    ZEPAMD 18
123800200529      *
123900200529      * FORMAT CHARGE DESCRIPTION
124000200529     C                     MOVE PNCY      SECCY
124100200529      *    BROKER COMMISSION
124200200529     C                     MOVE PCHC      SECCOM
124300200529     C                     MOVE *BLANKS   PCPRFC                          CAC002
124400200529     C***********SECHGK    CHAINSECHGDF              62                   S01169
124500200529     C           SECGTK    CHAINSECGTDF              62                   S01169
124600200529     C           *IN62     IFEQ '1'
124700200529     C                     MOVE *BLANK    ZCHNRA
124800200529     C                     ELSE
124900200529     C           RECI      IFEQ '*'
125000200529     C                     MOVE *BLANK    ZCHNRA
125100200529     C                     ELSE
125200200529     C                     MOVE CHNR      ZCHNRA
125300200529      *                                                                   CAC002
125400200529      * Output Charges Profit Centre                                      CAC002
125500200529      *                                                                   CAC002
125600200529     C           BGN0ST    IFEQ 'Y'                                       CAC002
125700200529     C           BOTR      IFEQ *BLANK                                    CAC002
125800200529     C                     MOVE PRFC      PCPRFC                          CAC002
125900200529     C                     ELSE                                           CAC002
126000200529     C                     MOVE PPFC      PCPRFC                          CAC002
126100200529     C                     ENDIF                                          CAC002
126200200529     C                     ENDIF                                          CAC002
126300200529     C*                                                                   CAC002
126400200529     C                     END
126500200529     C                     END
126600200529      *
126700200529      * FORMAT PLUS / LESS LEGEND
126800200529      *    READ CLINTSE FILE USING KEY
126900200529     C**********           Z-ADDPCPY      SENUM                                               CSD027
127000200529     C                     MOVE PCPY      SENUM                                               CSD027
127100200529     C                     MOVE '1'       SERCDT
127200200529     C           CLISEK    CHAINCLINTSEF             55
127300200529     C           *IN55     IFEQ '0'
127400200529     C           RECI      IFEQ '*'
127500200529     C                     SETON                     55
127600200529     C                     END
127700200529     C                     END
127800200529     C           *IN55     IFEQ '1'
127900200529     C***********          MOVEL'1'       *INU8                           S01117
128000200529     C***********          MOVEL'1'       *INU7                           S01117
128100200529     C***********          MOVEL'05'      DBASE            **DB ERROR 05**S01117
128200200529     C           *LOCK     IN   LDA                                       S01117
128300200529     C                     Z-ADD5         DBASE            **DB ERROR 05**S01117
128400200529     C                     MOVEL'CLINTSE' DBFILE
128500200529     C                     MOVELSERCDT    DBKEY7  7
128600200529     C                     MOVE PCPY      DBKEY7
128700200529     C                     MOVELDBKEY7    DBKEY
128800200529     C                     OUT  LDA                                       S01117
128900200529     C                     EXSR DBERR                                     S01117
129000200529     C***********          WRITEHEADAU                                    S01117
129100200529     C***********          WRITEERROR                                     S01117
129200200529     C***********          WRITETRAILAU                                   S01117
129300200529     C***********          GOTO ENDPGM                                    S01117
129400200529     C                     END
129500200529      *
129600200529     C************IN64     IFEQ '1'                                       E14881
129700200529     C***********C1DI      ANDEQ'X'                                       E14881
129800200529     C************IN65     OREQ '1'                                       E14881
129900200529     C***********C1DI      ANDNE'X'                                       E14881
130000200529      ******PLUS                                                          E14881
130100200529     C***********          SETON                     66                   E14881
130200200529     C***********          ELSE                                           E14881
130300200529      ******LESS                                                          E14881
130400200529     C***********          SETON                     67                   E14881
130500200529     C***********          END                                            E14881
130600200529      *
130700200529      * FORMAT CHARGE AMOUNT
130800200529      *    USE DEC PLACES FROM TABTG10 FOR ZDECS
130900200529      *    AS INPUT TO ZSEDIT
131000200529     C                     Z-ADDCDP       ZDECS
131100200529      *
131200200529     C                     Z-ADDPCHA      ZFLD15
131300200529     C                     MOVE 'J'       ZECODE
131400200529     C                     EXSR ZSEDIT
131500200529     C                     MOVE ZOUT21    ZEPCHA 18
131600200529     C*                                                                   S01408
131700200529     C/COPY WNCPYSRC,SE0335CCP1                                           S01408
131800200529     C*                                                                   S01408
131900200529      *
132000200529      * FORMAT COMMISSION DESCRIPTION
132100200529     C                     MOVE PNCY      SECCY
132200200529      *    BROKER COMMISSION
132300200529     C                     MOVE PCCD      SECCOM
132400200529     C                     MOVE *BLANKS   PPRFC                           CAC002
132500200529     C***********SECHGK    CHAINSECHGDF              62                   S01169
132600200529     C           SECGTK    CHAINSECGTDF              62                   S01169
132700200529     C           *IN62     IFEQ '1'
132800200529     C                     MOVE *BLANK    ZCHNRB
132900200529     C                     ELSE
133000200529     C           RECI      IFEQ '*'
133100200529     C                     MOVE *BLANK    ZCHNRB
133200200529     C                     ELSE
133300200529     C                     MOVE CHNR      ZCHNRB
133400200529      *                                                                   CAC002
133500200529      * Output Charges Profit Centre                                      CAC002
133600200529      *                                                                   CAC002
133700200529     C           BGN0ST    IFEQ 'Y'                                       CAC002
133800200529     C           BOTR      IFEQ *BLANK                                    CAC002
133900200529     C                     MOVE PRFC      PPRFC                           CAC002
134000200529     C                     ELSE                                           CAC002
134100200529     C                     MOVE PPFC      PPRFC                           CAC002
134200200529     C                     ENDIF                                          CAC002
134300200529     C                     ENDIF                                          CAC002
134400200529     C*                                                                   CAC002
134500200529     C                     END
134600200529     C                     END
134700200529      * FORMAT COMMISSION AMOUNT
134800200529      *    USE DEC PLACES FROM TABTG10 FOR ZDECS
134900200529      *    AS INPUT TO ZSEDIT
135000200529     C                     Z-ADDCDP       ZDECS
135100200529      *
135200200529     C                     Z-ADDPCAM      ZFLD15
135300200529     C                     MOVE 'J'       ZECODE
135400200529     C                     EXSR ZSEDIT
135500200529     C                     MOVE ZOUT21    ZEPCAM 18
135600200529     C*                                                                   S01408
135700200529     C/COPY WNCPYSRC,SE0335CCP2                                           S01408
135800200529     C*                                                                   S01408
135900200529      *
136000200529      * FORMAT NOM CCY POSETA
136100200529     C                     MOVE PNCY      ZPNCYB
136200200529      * FORMAT TOTAL AMOUNT
136300200529     C                     Z-ADD0         TOTL   150
136400200529     C           TOTL      ADD  PAMD      TOTL
136500200529      *
136600200529     C*  - FOR PORTFOLIO CLIENT                                           E14881
136700200529     C           C1DI      IFEQ 'S'                                       E14881
136800200529     C           C1DI      OREQ 'D'                                       E14881
136900200529     C*                                                                   E14881
137000200529     C************IN66     IFEQ '1'                                       E14881
137100200529     C           PPRE      IFEQ 'R'                                       E14881
137200200529     C                     MOVE '1'       *IN66                           E14881
137300200529     C*                                                                   S01408
137400200529     C/COPY WNCPYSRC,SE0335CCP3                                           S01408
137500200529     C*                                                                   S01408
137600200529     C           TOTL      ADD  PCHA      TOTL
137700200529     C           TOTL      ADD  PCAM      TOTL
137800200529     C*                                                                   S01408
137900200529     C/COPY WNCPYSRC,SE0335CCP5                                           S01408
138000200529     C*                                                                   S01408
138100200529     C                     ELSE
138200200529      *
138300200529     C                     MOVE '1'       *IN67                           E14881
138400200529     C*                                                                   S01408
138500200529     C/COPY WNCPYSRC,SE0335CCP4                                           S01408
138600200529     C*                                                                   S01408
138700200529     C           TOTL      SUB  PCHA      TOTL
138800200529     C           TOTL      SUB  PCAM      TOTL
138900200529     C*                                                                   S01408
139000200529     C/COPY WNCPYSRC,SE0335CCP5                                           S01408
139100200529     C*                                                                   S01408
139200200529     C                     END
139300200529      *                                                                   E14881
139400200529     C                     ELSE                                           E14881
139500200529     C*  - FOR DEPOT                                                      E14881
139600200529     C           PPRE      IFEQ 'R'                                       E14881
139700200529     C                     MOVE '1'       *IN67                           E14881
139800200529     C*                                                                   S01408
139900200529     C/COPY WNCPYSRC,SE0335CCP4                                           S01408
140000200529     C*                                                                   S01408
140100200529     C           TOTL      SUB  PCHA      TOTL                            E14881
140200200529     C           TOTL      SUB  PCAM      TOTL                            E14881
140300200529     C*                                                                   S01408
140400200529     C/COPY WNCPYSRC,SE0335CCP5                                           S01408
140500200529     C*                                                                   S01408
140600200529     C                     ELSE                                           E14881
140700200529      *                                                                   E14881
140800200529     C                     MOVE '1'       *IN66                           E14881
140900200529     C*                                                                   S01408
141000200529     C/COPY WNCPYSRC,SE0335CCP3                                           S01408
141100200529     C*                                                                   S01408
141200200529     C           TOTL      ADD  PCHA      TOTL                            E14881
141300200529     C           TOTL      ADD  PCAM      TOTL                            E14881
141400200529     C*                                                                   S01408
141500200529     C/COPY WNCPYSRC,SE0335CCP5                                           S01408
141600200529     C*                                                                   S01408
141700200529     C                     END                                            E14881
141800200529     C                     END                                            E14881
141900200529      *
142000200529     C                     Z-ADDCDP       ZDECS
142100200529      *
142200200529     C                     Z-ADDTOTL      ZFLD15
142300200529     C                     MOVE 'J'       ZECODE
142400200529     C                     EXSR ZSEDIT
142500200529     C                     MOVE ZOUT21    ZETOT  18
142600200529      *
142700200529      * FORMAT SETTLEMENT CURRENCY
142800200529     C                     MOVEL'20      'TKEY
142900200529     C                     MOVE PSCU      TPNCY
143000200529     C                     MOVE '1'       TKEY
143100200529     C           TABTK     CHAINTABTG10F             63
143200200529     C           *IN63     IFEQ '0'
143300200529     C           RECI      IFEQ '*'
143400200529     C                     SETON                     63
143500200529     C                     END
143600200529     C                     END
143700200529     C           *IN63     IFEQ '1'
143800200529     C***********          MOVEL'1'       *INU8                           S01117
143900200529     C***********          MOVEL'1'       *INU7                           S01117
144000200529     C**********           MOVEL'04'      DBASE            **DB ERROR 04**E20651
144100200529     C***********          MOVEL'07'      DBASE            **DB E E20651  S01117
144200200529     C           *LOCK     IN   LDA                                       S01117
144300200529     C                     Z-ADD7         DBASE            **DB ERROR 07**S01117
144400200529     C                     MOVEL'TABLE'   DBFILE
144500200529     C                     MOVELTKEY      DBKEY
144600200529     C                     OUT  LDA                                       S01117
144700200529     C                     EXSR DBERR                                     S01117
144800200529     C***********          WRITEHEADAU                                    S01117
144900200529     C***********          WRITEERROR                                     S01117
145000200529     C***********          WRITETRAILAU                                   S01117
145100200529     C***********          GOTO ENDPGM                                    S01117
145200200529     C                     END
145300200529      *    USE DEC PLACES FROM TABTG10 FOR ZDECS
145400200529      *    AS INPUT TO ZSEDIT
145500200529     C                     Z-ADDCDP       ZDECS
145600200529      *
145700200529     C                     Z-ADDPSAT      ZFLD15
145800200529     C                     MOVE 'J'       ZECODE
145900200529     C                     EXSR ZSEDIT
146000200529     C                     MOVE ZOUT21    ZEPSAT 18
146100200529      *                                                                   CAC002
146200200529      * Output FX margin points and amount if Settlement currency         CAC002
146300200529      * is not the same as the nominal currency.                          CAC002
146400200529      *                                                                   CAC002
146500200529     C           BGN0ST    IFEQ 'Y'                                       CAC002
146600200529     C           PSCU      ANDNEPNCY                                      CAC002
146700200529      *                                                                   CAC002
146800200529     C                     MOVE '1'       *IN19                           CAC002
146900200529      *                                                                   CAC002
147000200529      **  FX Margin Points                                                CAC002
147100200529      *                                                                   CAC002
147200200529     C                     MOVE *BLANKS   ZFLD15                          CAC002
147300200529     C                     MOVE FXMP      ZFLD15                          CAC002
147400200529     C                     Z-ADD2         ZDECS                           CAC002
147500200529     C                     MOVE 'L'       ZECODE                          CAC002
147600200529     C                     EXSR ZSEDIT                                    CAC002
147700200529     C                     MOVE ZOUT21    PFXMP                           CAC002
147800200529      *                                                                   CAC002
147900200529      **  Settlement Currency                                             CAC002
148000200529      *                                                                   CAC002
148100200529     C                     MOVE PSCU      PSCU1                           CAC002
148200200529      *                                                                   CAC002
148300200529      **  Margin Amount                                                   CAC002
148400200529      *                                                                   CAC002
148500200529     C                     MOVE *BLANKS   ZFLD15                          CAC002
148600200529     C                     MOVE MAMT      ZFLD15                          CAC002
148700200529     C                     Z-ADDCDP       ZDECS                           CAC002
148800200529     C                     MOVE 'J'       ZECODE                          CAC002
148900200529     C                     EXSR ZSEDIT                                    CAC002
149000200529     C                     MOVE ZOUT21    PMAMT                           CAC002
149100200529      *                                                                   CAC002
149200200529     C                     ELSE                                           CAC002
149300200529     C                     MOVE '0'       *IN19                           CAC002
149400200529     C                     ENDIF                                          CAC002
149500200529      *
149600200529      * FORMAT DETAILS FOR PRINT OUTPUT
149700200529     C                     SETOF                     515253
149800200529     C***********          SETOF                     54                   S01486
149900200529     C                     SETOF                     5456                 S01486
150000200529     C   70                SETOF                     69                   S01496
150100200529     C                     MOVE *OFF      *IN87                                             AR324888
150200200529     C           *IN88     IFEQ *OFF                                                        AR324888
150300200529     C           ZCHTP     IFEQ 'A'
150400200529     C                     SETON                     51
150500200529     C                     ELSE
150600200529     C           ZCHTP     IFEQ 'I'
150700200529     C                     SETON                     52
150800200529     C                     ELSE
150900200529     C           ZCHTP     IFEQ 'D'
151000200529     C                     SETON                     53
151100200529     C                     ELSE
151200200529     C           ZCHTP     IFEQ 'Y'
151300200529     C                     SETON                     54
151400200529     C                     ELSE                                           S01496
151500200529     C           S01496    IFEQ 'Y'                                       S01496
151600200529     C           ZCHTP     ANDEQ'R'                                       S01496
151700200529     C           CSE007    OREQ 'Y'                                       CSE007
151800200529     C           ZCHTP     ANDEQ'R'                                       CSE007
151900200529     C           CEU017    OREQ 'Y'                                       CEU017
152000200529     C           ZCHTP     ANDEQ'R'                                       CEU017
152100200529     C                     SETON                     69                   S01496
152200200529     C                     ELSE                                                             AR324888
152300200529     C           ZCHTP     IFEQ 'U'                                                         AR324888
152400200529     C                     MOVE *ON       *IN87                                             AR324888
152500200529     C                     ENDIF                                                            AR324888
152600200529     C                     END                                            S01496
152700200529     C                     END
152800200529     C                     END
152900200529     C                     END
153000200529     C                     END
153100200529     C                     ENDIF                                                            AR324888
153200200529      *                                                                   S01486
153300200529      * SETUP PORTFOLIO REFERENCE DETAILS                                 S01486
153400200529      *                                                                   S01486
153500200529     C           BGPFMG    IFEQ 'Y'                                       S01486
153600200529     C           PTFR      ANDNE*BLANKS                                   S01486
153700200529     C           BGN4ST    OREQ 'Y'                                       CPB001
153800200529     C           PTFR      ANDNE*BLANKS                                   CPB001
153900200529     C                     SETON                     56                   S01486
154000200529      *                                                                   S01486
154100200529      * PORTFOLIO REFERENCE                                               S01486
154200200529     C           PTFR      IFNE '9997'                                    S01486
154300200529     C           BGN4ST    OREQ 'Y'                                       CPB001
154400200529     C                     MOVE PTFR      RRPREF                          S01486
154500200529     C                     ELSE                                           S01486
154600200529     C                     MOVE FCR997    RRPREF                          S01486
154700200529     C                     END                                            S01486
154800200529      *                                                                   S01486
154900200529      *PORTFOLIO NARRATIVE                                                S01486
155000200529     C           PTFR      IFEQ '9997'                                    S01486
155100200529     C           BGN4ST    ANDNE'Y'                                       CPB001
155200200529     C                     MOVE FCN997    RRPNAR                          S01486
155300200529     C                     ELSE                                           S01486
155400200529     C                     OPEN PMPORTPD                                  S01486
155500200529     C           PMPORK    CHAINPMPORTPD             71                   S01486
155600200529     C                     CLOSEPMPORTPD                                  S01486
155700200529     C           *IN71     IFEQ '0'                                       S01486
155800200529     C                     MOVE PNPTFN    RRPNAR                          S01486
155900200529     C                     ELSE                                           S01486
156000200529     C           *LOCK     IN   LDA                                       S01486
156100200529     C                     MOVE PCPY      WPCPY                           S01486
156200200529     C                     MOVEL'PMPORTPD'DBFILE                          S01486
156300200529     C                     MOVELPMKEY     DBKEY            ***************S01486
156400200529     C                     MOVE *BLANKS   DBOPTN           * DBERROR 011 *S01486
156500200529     C                     Z-ADD11        DBASE            ***************S01486
156600200529     C                     OUT  LDA                                       S01486
156700200529     C                     EXSR DBERR                                     S01486
156800200529     C                     END                                            S01486
156900200529      *                                                                   S01486
157000200529     C                     END                                            S01486
157100200529      *                                                                   S01486
157200200529     C                     END                                            S01486
157300200529      *
157400200529      * FORMAT DATES FOR PRINT OUTPUT
157500200529      *
157600200529     C                     Z-ADDZLCD      ZDAYNO
157700200529     C                     EXSR ZDATE2
157800200529     C                     MOVE ZADATE    ZALCD
157900200529      *                                                                   S01401
158000200529      ***  Format SWIFT Further Identification field (for MT554).         S01401
158100200529      *                                                                   S01401
158200200529     C           S01401    IFEQ 'Y'                                       S01401
158300200529      *                                                                   S01401
158400200529      **  Reset indicator (Do not print extended settlement format)       S01401
158500200529     C                     MOVEL*OFF      *IN83                           S01401
158600200529      *                                                                   S01401
158700200529      **  If portfolio customer and coupon or dividend                    S01401
158800200529     C           C1DI      IFEQ 'D'                                       S01401
158900200529     C           C1DI      OREQ 'S'                                       S01401
159000200529      *                                                                   S01401
159100200529     C           PEVT      IFEQ 'CP'                                      S01401
159200200529     C           PEVT      OREQ 'DV'                                      S01401
159300200529     C           KPOSET    CHAINPOSETDD1             68                   S01401
159400200529      *                                                                   S01401
159500200529     C           *IN68     IFEQ '1'                                       S01401
159600200529     C           *LOCK     IN   LDA                                       S01401
159700200529     C                     MOVEL'POSETDY1'DBFILE                          S01401
159800200529     C                     MOVELPOSKEY    DBKEY            ***************S01401
159900200529     C                     MOVE *BLANKS   DBOPTN           * DB ERROR 09 *S01401
160000200529     C                     Z-ADD09        DBASE            ***************S01401
160100200529     C                     OUT  LDA                                       S01401
160200200529     C                     EXSR DBERR                                     S01401
160300200529     C                     END                                            S01401
160400200529     C                     MOVEL*ON       *IN83                           S01401
160500200529     C                     ENDIF                                          S01401
160600200529     C                     ENDIF                                          S01401
160700200529     C                     END                                            S01401
160800200529      *                                                                   S01447
160900200529      *** If the feature S01447 is switched on then .....                 S01447
161000200529      *                                                                   S01447
161100200529     C           *IN34     IFEQ '1'                                       S01447
161200200529      *                                                                   S01447
161300200529      ***     If the event could have WHT then process ....               S01447
161400200529      ***     OR If the Corporate Action Type has a processing Type 'DV'  CSE007
161500200529      ***     OR If the Securities Redenomination has a proc. Type 'DV'   CEU017
161600200529      *                                                                   S01447
161700200529     C           PEVT      IFEQ 'CP'                                      S01447
161800200529     C           PEVT      OREQ 'DV'                                      S01447
161900200529     C           WWPTYP    OREQ 'DV'                                      CSE007
162000200529     C           CSE007    ANDEQ'Y'                                       CSE007
162100200529     C           WWPTYP    OREQ 'DV'                                      CEU017
162200200529     C           CEU017    ANDEQ'Y'                                       CEU017
162300200529     C                     MOVE *ON       *IN33                           S01447
162400200529     C                     EXSR PRTADT                                    S01447
162500200529     C                     ELSE                                           S01447
162600200529      *                                                                   S01447
162700200529      ***       else ensure WHT narrative not printed                     S01447
162800200529      *                                                                   S01447
162900200529     C                     MOVE *OFF      *IN33                           S01447
163000200529     C                     ENDIF                                          S01447
163100200529     C                     ENDIF                                          S01447
163200200529      *                                                                   CAC002
163300200529      **  Make exchange rate equal to what was entered in I/C             CAC002
163400200529      *                                                                   CAC002
163500200529     C           PPRE      IFEQ 'P'                                       CAC002
163600200529     C           PMDI      ANDEQ'M'                                       CAC002
163700200529     C           PPRE      OREQ 'R'                                       CAC002
163800200529     C           PMDI      ANDEQ'D'                                       CAC002
163900200529     C                     ADD  FXMR      PSXR                            CAC002
164000200529     C                     ELSE                                           CAC002
164100200529     C                     SUB  FXMR      PSXR                            CAC002
164200200529     C                     ENDIF                                          CAC002
164300200529      *                                                                   S01447
164400200529     C                     ADD  1         LINCNT
164500200529      *                                                                   CSE023
164600200529      ** If CSE023 is installed, print withholding tax details            CSE023
164700200529      *                                                                   CSE023
164800200529     C           CSE023    IFEQ 'Y'                                       CSE023
164900200529      *                                                                   CSE023
165000200529      ** Sequence Number                                                  CSE023
165100200529      *                                                                   CSE023
165200200529     C                     MOVE PSEQ      RPSEQ                           CSE023
165300200529      *                                                                   CSE023
165400200529      ** Format Total discounted amount                                   CSE023
165500200529      *                                                                   CSE023
165600200529     C                     MOVE *BLANKS   ZFLD15                          CSE023
165700200529     C                     Z-ADDDAMT      ZFLD15                          CSE023
165800200529     C                     MOVE 'J'       ZECODE                          CSE023
165900200529     C                     EXSR ZSEDIT                                    CSE023
166000200529     C                     MOVE ZOUT21    RDAMT                           CSE023
166100200529      *                                                                   CSE023
166200200529     C                     ADD  1         LINCNT                          CSE023
166300200529     C                     ENDIF                                          CSE023
166400200529     C/COPY WNCPYSRC,SE0335C003
166500200529      *                                                                   S01447
166600200529     C                     WRITEDETAIL
166700200529     C/COPY WNCPYSRC,SE0335C004
166800200529      *                                                                   S01447
166900200529      * HOLD DATA UNTIL NEXT POSET READ
167000200529     C***********          Z-ADDPBCH      ZPBCH   30                      S01117
167100200529     C                     MOVELPBCA      ZPBCA   3                       S01117
167200200529      *
167300200529     C*
167400200529     C* NEXT
167500200529     C           NEXT      TAG                             ** NEXT TAG  **
167600200529     C***********          READ POSET                    50               178530
167700200529     C                     READ POSET1                   50               178530
167800200529      *
167900200529     C** CHECK FOR REQUESTED BRANCH FOR MULTIBRANCHING                    S01117
168000200529     C           MBIN      IFEQ 'Y'                                       S01117
168100200529     C           ENT       IFNE 'ALL'                                     S01117
168200200529     C           ENT       ANDNEPBCA                                      S01117
168300200529     C                     MOVE '1'       *IN50                           S01117
168400200529     C                     MOVE '1'       *IN80                           S01117
168500200529     C                     GOTO ENDSEL                                    S01117
168600200529     C                     END                                            S01117
168700200529     C                     END                                            S01117
168800200529      *
168900200529      * DETERMINE NEED TO CLOSE PRINTER FILE
169000200529      *
169100200529      * EOF OR 'L' MODE - DELETED RECORD OR 'I' MODE LCD NOT EQUAL
169200200529     C           *IN50     IFNE '1'
169300200529     C           MODE      IFEQ 'L'
169400200529     C           RECI      ANDEQ'*'
169500200529     C                     ELSE
169600200529     C           MODE      IFEQ 'I'
169700200529     C           LCD       ANDNERUND
169800200529     C                     ELSE
169900200529      *
170000200529      * BRANCH CHANGE
170100200529     C***********ZPBCH     IFNE PBCH                                      S01117
170200200529     C           MBIN      IFEQ 'Y'                                       S01117
170300200529     C           ZPBCA     IFNE PBCA                                      S01117
170400200529     C                     SETON                     80
170500200529     C                     END
170600200529     C                     END                                            S01117
170700200529      *
170800200529      * TOTAL OUTPUT - CLOSE SE0335P1-IF DETAIL RECORDS WRITTEN
170900200529      *   BRANCH CHANGE
171000200529      *
171100200529     C           ENDSEL    TAG                             * ENDSEL *     S01117
171200200529     C**                                                                  S01117
171300200529     C           ZCOUNT    IFEQ 0
171400200529     C           ZLIVP1    ANDEQ0
171500200529     C           ZCHGP1    ANDEQ0
171600200529     C                     ELSE
171700200529      *
171800200529     C           *IN80     IFEQ '1'
171900200529     C           LINCNT    IFGE MAXCNT                                    S01447
172000200529     C                     WRITEHEADP1                                    S01447
172100200529     C                     END                                            S01447
172200200529     C                     WRITETOTAL
172300200529     C                     WRITETRAILP1
172400200529     C                     Z-ADD0         ZCOUNT
172500200529     C                     Z-ADD0         ZLIVP1
172600200529     C                     Z-ADD0         ZCHGP1
172700200529     C                     CLOSESE0335P1
172800200529     C                     END
172900200529     C                     END
173000200529     C                     END
173100200529     C                     END
173200200529     C                     END
173300200529     C                     END
173400200529     C/SPACE 3
173500200529      *
173600200529      * END OF FILE - IF DETAIL RECORDS WRITTEN - WRITE TOTAL LINE
173700200529      *
173800200529     C           TOTALS    TAG                             ** TOTALS TAG**
173900200529      *
174000200529     C           ZCOUNT    IFEQ 0
174100200529     C           ZLIVP1    ANDEQ0
174200200529     C           ZCHGP1    ANDEQ0
174300200529     C                     ELSE
174400200529      *
174500200529     C           *IN82     IFEQ '1'
174600200529     C           LINCNT    IFGE MAXCNT                                    S01447
174700200529     C                     WRITEHEADP1                                    S01447
174800200529     C                     END                                            S01447
174900200529     C                     WRITETOTAL
175000200529     C***********          WRITETRAILP1                                   S01117
175100200529     C                     END
175200200529     C                     END
175300200529      *
175400200529     C** WRITE '*** NO DETAILS TO REPORT ***' LINE                        S01117
175500200529     C           *IN82     IFEQ '0'                                       S01117
175600200529     C                     MOVE '1'       *IN36                           S01117
175700200529     C                     END                                            S01117
175800200529     C**                                                                  S01117
175900200529     C/SPACE 3
176000200529      *================================================================
176100200529      *  RUN CONTROL PROCESS
176200200529      *================================================================
176300200529      *
176400200529      *
176500200529      **WRITE*CONTROL*REPORT*HEADINGS*************************************S01117
176600200529     C***********          WRITEHEADAU                                    S01117
176700200529      *
176800200529      * READ AUDIT RECORD
176900200529     C                     READ POSETA                   50
177000200529     C           *IN,50    IFEQ '1'
177100200529     C***********          MOVEL'1'       *INU8                           S01117
177200200529     C***********          MOVEL'1'       *INU7                           S01117
177300200529     C***********          MOVEL'02'      DBASE            **DB ERROR 02**S01117
177400200529     C           *LOCK     IN   LDA                                       S01117
177500200529     C                     Z-ADD2         DBASE            **DB ERROR 02**S01117
177600200529     C                     MOVEL'POSETA'  DBFILE
177700200529     C                     MOVEL'AUDIT'   DBKEY
177800200529     C                     OUT  LDA                                       S01117
177900200529     C                     EXSR DBERR                                     S01117
178000200529     C***********          WRITEERROR                                     S01117
178100200529     C***********          WRITETRAILAU                                   S01117
178200200529     C***********          GOTO ENDPGM                                    S01117
178300200529     C                     END
178400200529      *
178500200529      * 'I' MODE - PRINT REPORT
178600200529     C           MODE      IFEQ 'I'
178700200529     C                     WRITEHEADAU                                    S01117
178800200529     C                     WRITECONTROLI
178900200529      *
179000200529      *
179100200529      * 'A'/'L' MODE -
179200200529     C                     ELSE
179300200529      *
179400200529      *
179500200529      * 'A' MODE - DO RUN CONTROLS
179600200529     C           MODE      IFEQ 'A'
179700200529     C           NLRB      ADD  NOIN      ZWORK
179800200529     C           ZWORK     SUB  NODE      ZWORK
179900200529     C           ZWORK     IFNE ZLIVE
180000200529     C           MBIN      IFEQ 'N'                                       S01117
180100200529     C                     SETON                     U881
180200200529     C                     ELSE                                           S01117
180300200529     C           ENT       IFEQ 'ALL'                                     S01117
180400200529     C                     SETON                     U881                 S01117
180500200529     C                     END                                            S01117
180600200529     C                     END                                            S01117
180700200529     C                     END
180800200529      *
180900200529      *          - PRINT REPORT
181000200529     C                     WRITEHEADAU                                    S01117
181100200529     C                     WRITECONTROLA
181200200529      *
181300200529      *          - UPDATE AUDIT RECORD
181400200529     C           *INU8     IFEQ '0'
181500200529     C                     Z-ADD0         NOIN
181600200529     C                     Z-ADD0         NOAM
181700200529     C                     Z-ADD0         NODE
181800200529     C                     Z-ADDNORE      NLRB
181900200529     C                     UPDATPOSETAF
182000200529     C                     END
182100200529      *
182200200529      * 'L' MODE - DO RUN CONTROLS
182300200529     C                     ELSE
182400200529     C           NORE      IFNE ZLIVE
182500200529     C           MBIN      IFEQ 'N'                                       S01117
182600200529     C                     SETON                     U881
182700200529     C                     ELSE                                           S01117
182800200529     C           ENT       IFEQ 'ALL'                                     S01117
182900200529     C                     SETON                     U881                 S01117
183000200529     C                     END                                            S01117
183100200529     C                     END                                            S01117
183200200529     C                     END
183300200529      *
183400200529      *          - PRINT REPORT
183500200529     C                     WRITEHEADAU                                    S01117
183600200529     C                     WRITECONTROLL
183700200529     C                     END
183800200529     C                     END
183900200529      *
184000200529      *  IF NO OUTPUT - WRITE MESSAGE TO THIS EFFECT
184100200529     C************IN82     IFEQ '0'                                       S01117
184200200529     C           *IN36     IFEQ '1'                                       S01117
184300200529     C                     WRITENONE
184400200529     C                     ELSE                                           S01117
184500200529     C** WRITE P1 '*** END OF REPORT ***' LINE IF P1 OPENED               S01117
184600200529     C           *IN82     IFNE '1'                        ***************S01117
184700200529     C           *IN82     OREQ '1'                        * P1 NOT OPEN *S01117
184800200529     C           *IN80     ANDEQ'1'                        ***************S01117
184900200529     C                     ELSE                                           S01117
185000200529     C                     WRITETRAILP1                                   S01117
185100200529     C                     END                                            S01117
185200200529     C                     END
185300200529      *
185400200529     C***********          WRITETRAILAU                                   S01117
185500200529     C/SPACE 3
185600200529      *================================================================
185700200529      *  END OF PROGRAM
185800200529      *================================================================
185900200529      *
186000200529     C           ENDPGM    TAG                             ** ENDPGM TAG**
186100200529     C                     SETON                     LR
186200200529     C                     RETRN
186300200529     C*
186400200529     C*****************************************************************
186500200529      /EJECT
186600200529     C********************************************************************S01447
186700200529     C*                                                                   S01447
186800200529     C*   PRTADT SR. - SR. TO PROCESS TAX DETAILS                         S01447
186900200529     C*                                                                   S01447
187000200529     C********************************************************************S01447
187100200529      *                                                                   S01447
187200200529     C           PRTADT    BEGSR                                          S01447
187300200529      *
187400200529     C                     MOVE *BLANK    STASO  18
187500200529     C                     MOVE *BLANK    STASR  18
187600200529     C                     MOVE *BLANK    STAUS  18
187700200529      *                                                                   S01447
187800200529     C                     MOVE *BLANKS   ZFLD15                          S01447
187900200529     C                     MOVE TASO      ZFLD15                          S01447
188000200529     C                     MOVE 'J'       ZECODE                          S01447
188100200529     C                     EXSR ZSEDIT                                    S01447
188200200529     C                     MOVE ZOUT21    STASO                           S01447
188300200529      *                                                                   S01447
188400200529     C                     MOVE *BLANKS   ZFLD15                          S01447
188500200529     C                     MOVE TASR      ZFLD15                          S01447
188600200529     C                     MOVE 'J'       ZECODE                          S01447
188700200529     C                     EXSR ZSEDIT                                    S01447
188800200529     C                     MOVE ZOUT21    STASR                           S01447
188900200529      *                                                                   S01447
189000200529     C                     MOVE *BLANKS   ZFLD15                          S01447
189100200529     C                     MOVE TAUS      ZFLD15                          S01447
189200200529     C                     MOVE 'J'       ZECODE                          S01447
189300200529     C                     EXSR ZSEDIT                                    S01447
189400200529     C                     MOVE ZOUT21    STAUS                           S01447
189500200529      *                                                                   S01447
189600200529      *** Now deduct the Tax deducted at source and the Tax deducted      S01447
189700200529      *** by the user from the Total.                                     S01447
189800200529      *                                                                   S01447
189900200529     C           TASO      ADD  TAUS      TEMP1  180                      S01447
190000200529     C           TOTL      SUB  TEMP1     TOTL                            S01447
190100200529      *                                                                   S01447
190200200529     C                     MOVE TOTL      ZFLD15                          S01447
190300200529     C                     MOVE 'J'       ZECODE                          S01447
190400200529     C                     EXSR ZSEDIT                                    S01447
190500200529     C                     MOVE ZOUT21    ZETOT  18                       S01447
190600200529      *                                                                   S01447
190700200529     C                     ENDSR                                          S01447
190800200529     C******************************************************************* S01447
190900200529      /EJECT                                                              S01447
191000200529     C********************************************************************S01447
191100200529     C********************************************************************S01117
191200200529     C*                                                                   S01117
191300200529     C*   ACCBRH SR. - SR. TO ACCESS BRANCH DETAILS                       S01117
191400200529     C*                                                                   S01117
191500200529     C********************************************************************S01117
191600200529     C*                                                                   S01117
191700200529     C           ACCBRH    BEGSR                           * ACCBRH *     S01117
191800200529     C**                                                                  S01117
191900200529     C                     MOVE *BLANK    ZBRNM                           S01117
192000200529     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
192100200529     C                     CALL 'AOBRCHR1'                                                    CGL029
192200200529     C                     PARM '*MSG   ' @RTCD                           S01117
192300200529     C                     PARM '*KEY   ' @OPTN                           S01117
192400200529     C                     PARM PENT      @DSNB   3                       S01117
192500200529     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
192600200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
192700200529     C**                                                                  S01117
192800200529     C**  CHECK FOR DATABASE ERROR                                        S01117
192900200529     C**                                                                  S01117
193000200529     C           @RTCD     IFNE *BLANK                                    S01117
193100200529     C           *LOCK     IN   LDA                                       S01117
193200200529     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
193300200529     C                     MOVELPENT      DBKEY                           S01117
193400200529     C                     MOVEL@OPTN     DBOPTN           ***************S01117
193500200529     C                     Z-ADD8         DBASE            * DB ERROR 08 *S01117
193600200529     C                     OUT  LDA                        ***************S01117
193700200529     C                     EXSR DBERR                                     S01117
193800200529     C                     END                                            S01117
193900200529     C                     MOVE A8BRNM    ZBRNM                           S01117
194000200529     C**                                                                  S01117
194100200529     C                     ENDSR                                          S01117
194200200529     C**                                                                  S01117
194300200529     C********************************************************************S01117
194400200529     C/EJECT                                                              S01117
194500200529     C********************************************************************S01117
194600200529     C*                                                                   S01117
194700200529     C**   DBERR SR.- DATABASE ERROR SUBROUTINE                           S01117
194800200529     C*                                                                   S01117
194900200529     C********************************************************************S01117
195000200529     C*                                                                   S01117
195100200529     C           DBERR     BEGSR                           ** DBERR SR ** S01117
195200200529     C*                                                                   S01117
195300200529     C**   DATABASE ERROR HANDLING , REPORT ETC.                          S01117
195400200529     C*                                                                   S01117
195500200529     C** WRITE DB ERROR DETAILS TO P1                                     S01117
195600200529     C*                                                                   S01117
195700200529     C           *IN82     IFNE '1'                        ***************S01117
195800200529     C           *IN82     OREQ '1'                        * P1 NOT OPEN *S01117
195900200529     C           *IN80     ANDEQ'1'                        ***************S01117
196000200529     C                     ELSE                            * P1 OPENED    S01117
196100200529     C                     ADD  1         LINCNT                          S01117
196200200529     C           LINCNT    IFGT MAXCNT                                    S01117
196300200529     C                     WRITEHEADP1                                    S01117
196400200529     C                     END                                            S01117
196500200529     C                     WRITEERRORP1                                   S01117
196600200529     C                     WRITETRAILP1                                   S01117
196700200529     C                     END                                            S01117
196800200529     C*                                                                   S01117
196900200529     C** OUTPUT RUN CONTROL DETAILS FOR AU                                S01117
197000200529     C*                                                                   S01117
197100200529     C                     WRITEHEADAU                                    S01117
197200200529     C           MODE      IFEQ 'I'                                       S01117
197300200529     C                     WRITECONTROLI                                  S01117
197400200529     C                     ELSE                                           S01117
197500200529     C           MODE      IFEQ 'A'                                       S01117
197600200529     C                     WRITECONTROLA                                  S01117
197700200529     C                     ELSE                                           S01117
197800200529     C                     WRITECONTROLL                                  S01117
197900200529     C                     END                                            S01117
198000200529     C                     END                                            S01117
198100200529     C*                                                                   S01117
198200200529     C** OUTPUT DB ERROR DETAILS FOR AU                                   S01117
198300200529     C*                                                                   S01117
198400200529     C                     WRITEERROR                                     S01117
198500200529     C**                                                                  S01117
198600200529     C                     EXSR *PSSR                                     S01117
198700200529     C**                                                                  S01117
198800200529     C                     ENDSR                                          S01117
198900200529     C********************************************************************S01117
199000200529     C/EJECT                                                              S01117
199100200529     C********************************************************************S01117
199200200529     C*                                                                   S01117
199300200529     C*   *PSSR -- ERROR HANDLING SUBROUTINE                              S01117
199400200529     C*                                                                   S01117
199500200529     C********************************************************************S01117
199600200529     C**                                                                  S01117
199700200529     C           *PSSR     BEGSR                                          S01117
199800200529     C**                                                                  S01117
199900200529     C                     SETON                     U7U8                 S01117
200000200529     C           @RUN      IFEQ *BLANKS                                   S01117
200100200529     C                     MOVE 'Y'       @RUN    1                       S01117
200200200529     C                     DUMP                                           S01117
200300200529     C                     END                                            S01117
200400200529     C**                                                                  S01117
200500200529     C                     SETON                     LR                   S01117
200600200529     C                     RETRN                                          S01117
200700200529     C**                                                                  S01117
200800200529     C                     ENDSR                                          S01117
200900200529     C**                                                                  S01117
201000200529     C********************************************************************S01117
201100200529     C/EJECT                                                              S01117
201200200529     C********************************************************************S01117
201300200529     C*                                                                   S01117
201400200529     C*   RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF         S01117
201500200529     C*                                                                   S01117
201600200529     C********************************************************************S01117
201700200529     C*                                                                   S01117
201800200529     C           RCFP1     BEGSR                            ** RCFP1 **   S01117
201900200529     C*                                                                   S01117
202000200529     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01117
202100200529     C*                                                                   S01117
202200200529     C                     MOVE *BLANKS   PPBCA   3                       S01117
202300200529     C           MBIN      IFEQ 'Y'                                       S01117
202400200529     C           ENT       IFEQ 'ALL'                                     S01117
202500200529     C           *IN36     IFEQ '0'                                       S01117
202600200529     C                     MOVE PBCA      PPBCA                           S01117
202700200529     C                     END                                            S01117
202800200529     C                     ELSE                                           S01117
202900200529     C                     MOVE ENT       PPBCA                           S01117
203000200529     C                     END                                            S01117
203100200529     C                     END                                            S01117
203200200529     C**                                                                  S01117
203300200529     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
203400200529     C**                                                                  S01117
203500200529     C                     CALL 'ZSFILE'                                  S01117
203600200529     C                     PARM           SEQ     5                       S01117
203700200529     C                     PARM PPBCA     SENTY   3                       S01117
203800200529     C                     PARM           SFILE                           S01117
203900200529     C                     PARM           ZSNUM                           S01117
204000200529     C                     PARM           ZSERR   1                       S01117
204100200529     C*                                                                   S01117
204200200529     C           ZSERR     IFEQ 'Y'                                       S01117
204300200529     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
204400200529     C                     SETON                     U7U8LR               S01117
204500200529     C                     RETRN                                          S01117
204600200529     C                     END                                            S01117
204700200529     C*                                                                   S01117
204800200529     C                     ENDSR                                          S01117
204900200529     C*                                                                   S01117
205000200529     C********************************************************************S01117
205100200529     C/EJECT                                                              S01117
205200200529     C********************************************************************S01117
205300200529     C*                                                                   S01117
205400200529     C*   RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF         S01117
205500200529     C*                                                                   S01117
205600200529     C********************************************************************S01117
205700200529     C*                                                                   S01117
205800200529     C           RCFAU     BEGSR                            ** RCFAU **   S01117
205900200529     C*                                                                   S01117
206000200529     C**      ENSURE AUDIT SPOOL FILE RECORDED BY RCF                     S01117
206100200529     C*                                                                   S01117
206200200529     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
206300200529     C**                                                                  S01117
206400200529     C                     CALL 'ZSFILE'                                  S01117
206500200529     C                     PARM           SEQ     5                       S01117
206600200529     C                     PARM *BLANK    SENTY   3                       S01117
206700200529     C                     PARM           SFILEU                          S01117
206800200529     C                     PARM           ZSNUMU                          S01117
206900200529     C                     PARM           ZSERR   1                       S01117
207000200529     C*                                                                   S01117
207100200529     C           ZSERR     IFEQ 'Y'                                       S01117
207200200529     C*                                                                   S01117
207300200529     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
207400200529     C*                                                                   S01117
207500200529     C                     SETON                     U7U8LR               S01117
207600200529     C                     RETRN                                          S01117
207700200529     C                     END                                            S01117
207800200529     C*                                                                   S01117
207900200529     C                     ENDSR                                          S01117
208000200529     C*                                                                   S01117
208100200529     C********************************************************************S01117
208200200529     C/COPY ZSRSRC,ZDATE2Z4
208300200529      /EJECT
208400200529     C/COPY ZSRSRC,ZSDESCZ3
208500200529      /EJECT
208600200529     C/COPY ZSRSRC,ZSEDITZ3
208700200529      /EJECT
208800200529     C*COPY*ZSRSRC,ZSYSTMZ1**                                             S01117
208900200529      /EJECT
209000200529      ***
209100200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
2092002005290366073110961461
209300200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
209400200529000031059090120151181212243273304334365
209500200529**   ZMNM - MONTHS SHORT NAMES
209600200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
209700200529**  SETTLEMENT METHOD/LEGEND TABLE
20980020052901NOSTRO        02CHEQ.SENT     03COMPENS.SUSP. 04PRIME RET.A/C 05SPECIFIED A/C
20990020052906COMPUTER SUSP.07CHIPS         08SWIFT         12CHEQ.COLLECTED14RETAIL A/C
21000020052915NOMINATED A/C
210100200529**  CPY@
210200200529(c) Finastra International Limited 2001
