     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Limits List - Currencies')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Securities Trading Module
     F*                                                               *
     F*  SE0352 - LIMIT LIST - CURRENCY LIMITS                        *
     F*                                                               *
     F*  Function:  This program produces a report, for audit         *
     F*   (I/C)     purposes, of all currency limits defined to the   *
     F*   (COB)     system.  The sequence of the report is company,   *
     F*             branch, book, currency.                           *
     F*                                                               *
     F*  Called By: 1) SEC0301 - Audit Reports - Input Cycle          *
     F*             2) SEC0601 - Audit Reports - Close of Business    *
     F*             3) SEC0302 - Full Lists - On Request              *
     F*                                                               *
     F*             Frequency:                                        *
     F*             The report is available in 3 modes (I,A,L):       *
     F*             1) On request during I/C; an interim report       *
     F*                showing the latest status of currency limits   *
     F*                inserted, amended or deleted during the day.   *
     F*             2) During COB; a report of all currency limits    *
     F*                inserted, amended or deleted during the day.   *
     F*             3) On request; a report of all live currency      *
     F*                limits in the system (ie. deleted items are    *
     F*                not included).                                 *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *  Prev Amend No. CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU011             Date 31Mar98               *
      *                 052254             Date 10Jan94               *
      *                 E35515             Date 10Feb92               *
     F*                E29170              DATE 12NOV91               *
     F*                E28705              DATE 24SEP91               *
     F*                S01117              DATE 01NOV90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CEU011 - EMU Position/Risk Reporting                         *
     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
     F*           to 10,9                                             *
     F*  E35515 - Recompiled over changed printer file                *
     F*  E29170 - Report Control Facility changes                     *
     F*  E28705 - Recompiled over changed PRTF                        *
     F*  S01117 - MULTIBRANCHING                                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
     F***SLIMFLLCIF  E           K        DISK                        UC  CEU011
     F***SLIMFL**IF  E           K        DISK                        UC  CEU011
     F*********** SLIMFF                            KRENAMESLIMFFX        CEU011
     F*TABSE**IF**E***        K        DISK                               S01117
     F*********** TABTB10F                          KIGNORE               S01117
     F*********** TABLETAF                          KIGNORE               S01117
     F*********** TABTB11F                          KIGNORE               S01117
     F*********** TABTB36F                          KIGNORE               S01117
     F*********** TABTE10F                          KIGNORE               S01117
     F*********** TABTE20F                          KIGNORE               S01117
     F*********** TABTG20F                          KIGNORE               S01117
     F*********** TABLETHF                          KIGNORE               S01117
     F*********** TABLETJF                          KIGNORE               S01117
     F*********** TABLETKF                          KIGNORE               S01117
     F*********** TABLETLF                          KIGNORE               S01117
     F*********** TABLETNF                          KIGNORE               S01117
     F*********** TABLETPF                          KIGNORE               S01117
     F*********** TABLETRF                          KIGNORE               S01117
     F*********** TABLETXF                          KIGNORE               S01117
     F*********** TABLET2F                          KIGNORE               S01117
     F*********** TABLET3F                          KIGNORE               S01117
     F*********** TABLET5F                          KIGNORE               S01117
     FSESLIML0IF  E           K        DISK                           UC  CEU011
     FSESLIML1IF  E           K        DISK                           UC  CEU011
     F            SESLIMD0                          KRENAMESESLIMPX       CEU011
     FSLIMA   UF  E           K        DISK
     F*E0352P1O** E                    PRINTER                        UC  S01117
     F*E0352AUO** E                    PRINTER                            S01117
     FSE0352P1O   E                    PRINTER                        UC  S01117
     F                                              KINFDS SPOOL          S01117
     FSE0352AUO   E                    PRINTER                            S01117
     F                                              KINFDS SPOOLU         S01117
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   35       MULTIBRANCHING                                     *   S01117
     F*   36       'NO DETAILS TO REPORT'                             *   S01117
     F*   40       INPUT PARAMETER IS I (INPUT CYCLE MODE)            *
     F*   41       INPUT PARAMETER IS A (AUDIT MODE)                  *
     F*   42       INPUT PARAMETER IS L (FULL LIST MODE)              *
     F*   43       LEVEL IS S (BANK)                                  *
     F*   44       LEVEL IS C (COMPANY)                               *
     F*   45       LEVEL IS B (BRANCH)                                *
     F*   46       INPUT PARAMETER LEVEL IS 'C'                       *   S01117
     F*   47       INPUT PARAMETER LEVEL IS 'B'                       *   S01117
      *   48       Currency is an 'In' ccy                            *   CEU011
      *   49       CEU011 is switched on                              *   CEU011
     F*   50       END OF INPUT FILE / FILE READ ERROR                *
     F*   51-53    PRINT AMD/INS/DEL LEGEND                           *
     F*   54       PRINT 'DIFFERENCE' LEGEND                          *
     F*   55       DETAIL REPORT OPEN                                 *
     F****56*******NO*TABTG10*RECORD***********************************   S01117
     F****57*******NO*TABLETR*RECORD***********************************   S01117
     F*   60       OPEN/CLOSE PRINTER FILE SE0352P1                   *
     F*   61       SUBHEADINGS REQUIRED ON DETAIL FILE SE0352P1       *   E29170
     F*   90-99    USED IN STANDARD SUB-ROUTINES                      *
     F*   U7       DATABASE ERROR                                     *
     F*   U8       DATABASE / CONTROL ERROR                           *
     F*****************************************************************
     F/SPACE 3
     F*****************************************************************
     F*                                                               *
     F* S U B R O U T I N E   I N D E X                               *
     F*                                                               *
     F*   ACCENT - ACCESS ENTITY NAME                                 *   S01117
     F*   DBERR  - DATABASE ERROR SUBROUTINE                          *   S01117
     F*   RCFP1  - REGISTER P1 FILE VIA RCF                           *   S01117
     F*   RCFAU  - REGISTER AU FILE VIA RCF                           *   S01117
     F*   *PSSR  - ERROR HANDLING                                     *   S01117
     F*                                                               *   S01117
     F****ZSYSTM*-*ACCESS*ICD*RECORD*********************             *   S01117
     F*   ZDATE2 - DAYNO - DATE CONVERSION                            *
     F*                                                               *
     F*****************************************************************
      /EJECT
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1
     E/SPACE 3
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*LDA********UDS                           256                       S01117
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 177 DBASE                 S01117
     I*                                                                   S01117
     ILDA         DS                            256                       S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I*                                                                   S01117
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01117
     I*                                                                   S01117
     I              BJURPT                          TITL                  S01117
     I*                                                                   S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I*                                                                   S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I*                                                                   S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01117
     ISDCURR    E DSSDCURRPD                                              S01117
     I*                                                                   S01117
     I** Currency Details                                                 S01117
     I*                                                                   S01117
     ISCSARD    E DSSCSARDPD                                              CEU011
      *                                                                   CEU011
      ** Switchable Feature Details                                       CEU011
      *                                                                   CEU011
     ISDGELR    E DSSDGELRPD                                              CEU011
      *                                                                   CEU011
      ** General Ledger Details                                           CEU011
      *                                                                   CEU011
     ISDCOMP    E DSSDCOMPL0                                              S01117
     I*                                                                   S01117
     I**  EXTERNAL DS FOR COMPANY CODE DETAILS                            S01117
     I*                                                                   S01117
     I              APCMNM                          CMNM                  S01117
     I*                                                                   S01117
     IRUNDT       DS                                                      S01117
     I*                                                                   S01117
     I**  DATA STRUCTURE FOR RUN DATE DETAILS                             S01117
     I*                                                                   S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I*                                                                   S01117
     I**  DS FOR LINE NO. TO HANDLE OVERFLOW                              S01117
     I*                                                                   S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01117
     I** DATA STRUCTURE FOR ACCESS OBJECTS, SHORT DATA STRUCTURE          S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I**                                                                  S01117
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01117
     I*                                                                   S01117
     I** SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE               S01117
     I*                                                                   S01117
     I           SDS
     I                                      244 246 WSID
     I                                      254 263 USID
     I*
     I* DATA STRUCTURE FOR FILE KEYS
     I*
     I            DS
     I                                        1  12 TKEY
     I                                        1   2 TRECT
     I                                        3   8 TZZ6
     I                                        9  11 TCNCL
     I                                       12  12 TSREC
     I*
     I*********** DS                                                      S01117
     I***********                             1  12 TRKEY                 S01117
     I***********                             1   2 TRRECT                S01117
     I***********                             3   9 TRZZ7                 S01117
     I***********                            10  12 TRETYF                S01117
     I*
     C/EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T                                  *
     C*================================================================
     C*
     C**DEFINE*KEYLIST*FOR*CHAINING*TO*TABSE*FILE**********************   S01117
     C***********                                                         S01117
     C***********TABTK     KLIST                                          S01117
     C***********          KFLD           TKEY                            S01117
     C***********                                                         S01117
     C***********TABTRK    KLIST                                          S01117
     C***********          KFLD           TRKEY                           S01117
      * PREPARE LDA
      *
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                        INITIALIZE     S01117
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'SE0352'  DBPGM
     C                     OUT  LDA                                       S01117
      *
      * INPUT PARAMETER :
      *
     C           *ENTRY    PLIST
     C                     PARM           MODE    1
     C                     PARM           SEQ     5                       S01117
     C                     PARM           LVL     1                       S01117
     C                     PARM           ENT     3                       S01117
      * DEFINE WORK FIELDS
      *
     C           *LIKE     DEFN LCD       ZLCD
     C           *LIKE     DEFN CHTP      ZCHTP
     C           *LIKE     DEFN TNLU      ZTNLU
     C           *LIKE     DEFN ISRF      ZINS
     C           *LIKE     DEFN AMNF      ZAMD
     C           *LIKE     DEFN NDLF      ZDEL
     C**                                                                  S01117
     C** REGISTER SPOOL ENTRY FOR AU                                      S01117
     C**                                                                  S01117
     C                     EXSR RCFAU                                     S01117
     C**                                                                  S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**  TEST FOR MULTIBRANCHING                                         S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     35                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** CHECK SYSTEM FORMAT DATE, DDMMYY OR MMDDYY(98 ON)                S01117
     C**                                                                  S01117
     C           DATF      IFEQ 'M'                                       S01117
     C                     SETON                     98                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     98                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** CHECK FOR INPUT PARAMETER LEVEL                                  S01117
     C**                                                                  S01117
     C           LVL       IFEQ 'C'                                       S01117
     C                     MOVE '1'       *IN46                           S01117
     C                     ELSE                                           S01117
     C           LVL       IFEQ 'B'                                       S01117
     C                     MOVE '1'       *IN47                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C/EJECT
      *================================================================
      *  FIRST TIME PROCESSING
      *================================================================
      *
      * SET INDICATORS FOR REPORT HEADING & OPEN INPUT FILE
     C           MODE      IFEQ 'I'
     C                     SETON                     40
     C                     ELSE
     C           MODE      IFEQ 'A'
     C                     SETON                     41
     C                     ELSE
     C                     SETON                     42
     C                     END
     C                     END
     C**                                                                  S01117
     C** INITIALISE OUTPUT ENTITY FIELDS BY INPUT PARAMETER               S01117
     C**                                                                  S01117
     C                     MOVE ENT       ETYF                            S01117
     C                     MOVE ENT       ZETYF                           S01117
     C**                                                                  S01117
     C**   ACCESS BANK DETAILS, FOR TITLE                                 S01117
     C**                                                                  S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBANKPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DB ERROR 01 *S01117
     C                     Z-ADD1         DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
      *                                                                   CEU011
      ** Check if CEU011 is present                                       CEU011
      *                                                                   CEU011
     C                     MOVEL'N'       CEU011                          CEU011
     C                     MOVE '0'       *IN49                           CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   P@RTCD  7                       CEU011
     C                     PARM '*VERIFY 'P@OPTN  7                       CEU011
     C                     PARM 'CEU011'  P@SARD  6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           P@RTCD    IFEQ *BLANKS                                   CEU011
     C                     MOVEL'Y'       CEU011  1                       CEU011
     C                     MOVE '1'       *IN49                           CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
      ** Handle Database Error                                            CEU011
      *                                                                   CEU011
     C           P@RTCD    IFNE '*NRF    '                                CEU011
     C           *LOCK     IN   LDA                                       CEU011
     C                     MOVEL'SCSARDPD'DBFILE           ***************CEU011
     C                     Z-ADD5         DBASE            * DB ERROR 05 *CEU011
     C                     MOVEL'CEU011'  DBKEY            ***************CEU011
     C                     OUT  LDA                                       CEU011
     C                     EXSR DBERR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      **  Access General Ledger Details                                   CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                CEU011              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   P@RTCD                          CEU011
     C                     PARM '*FIRST ' P@OPTN                          CEU011
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU011              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU011
     C           P@RTCD    IFNE *BLANK                                    CEU011
     C           *LOCK     IN   LDA                                       CEU011
     C                     MOVEL'SDGELRPD'DBFILE           ***************CEU011
     C                     Z-ADD6         DBASE            * DB ERROR 06 *CEU011
     C                     MOVEL'*FIRST ' DBKEY            ***************CEU011
     C                     OUT  LDA                                       CEU011
     C                     EXSR DBERR                                     CEU011
     C                     ENDIF                                          CEU011
      *
      *
      **GET*INSTALLATION*CONTROL*DATA*RECORD*1****************************S01117
      *
     C***********          EXSR ZSYSTM                                    S01117
      *
      **ERROR*IN*ZSYSTM***************************************************S01117
      *
     C************IN,99    IFEQ '1'                                       S01117
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
     C***********          MOVEL'TABLE'   DBFILE                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          WRITEHEADAU                                    S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C***********          END                                            S01117
      *
      *
     C***40******          OPEN SLIMFLLC                                  CEU011
     C   40                OPEN SESLIML1                                  CEU011
     C**N40******          OPEN SLIMFL                                    CEU011
     C  N40                OPEN SESLIML0                                  CEU011
     C                     Z-ADD40        MAXCNT  20
     C/SPACE 3
      *================================================================
      *  M A I N   P R O C E S S I N G
      *================================================================
      *
      *
     C***40******          READ SLIMFLLC                 50               CEU011
     C   40                READ SESLIML1                 50               CEU011
     C**N40******          READ SLIMFL                   50               CEU011
     C  N40                READ SESLIML0                 50               CEU011
      *
     C           *IN50     DOWNE'1'
      *
      * A RECORD HAS BEEN READ :-
     C**                                                                  S01117
     C** CHECK FOR REQUESTED LEVEL/ENTITY, ONLY FOR LVL = 'B' OR 'C'      S01117
     C** AND ENTITY NOT = 'ALL'.                                          S01117
     C*                                                                   S01117
     C           LVL       IFEQ 'B'                                       S01117
     C           LVL       OREQ 'C'                                       S01117
     C*                                                                   S01117
     C           ENT       IFNE 'ALL'                                     S01117
     C*                                                                   S01117
     C           LVL       IFNE LVLF                                      S01117
     C           ENT       ORNE ETYF                                      S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     MOVE '1'       *IN60                           S01117
     C                     GOTO ENDSEL                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C           LVL       IFNE LVLF                                      S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     MOVE '1'       *IN60                           S01117
     C                     GOTO ENDSEL                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
      *
      * MOVE DATA INTO UNIQUE FIELDS
      *
     C                     Z-ADDLCD       ZLCD
     C                     MOVE CHTP      ZCHTP
     C                     Z-ADDTNLU      ZTNLU
      *
      * IF PARM=I & LAST CHANGE DATE NOT = RUN DATE - IGNORE
     C           MODE      IFEQ 'I'
     C           ZLCD      IFNE RUND
     C                     GOTO NEXT
     C                     END
     C                     END
      *
      * MAINTAIN COUNTS AS NECESSARY
     C           MODE      IFEQ 'I'
     C           MODE      OREQ 'A'
      *
      **  IF RUN DATE IS THE SAME AS LAST CHANGE DATE
      *
     C           ZLCD      IFEQ RUND
      * I OR A MODES - INCLUDE DELETED RECORDS
     C           ZCHTP     IFEQ 'I'
     C                     ADD  1         ZINS
     C                     ELSE
     C           ZCHTP     IFEQ 'A'
     C                     ADD  1         ZAMD
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     ADD  1         ZDEL
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
      * I MODE - COUNT OF RECORDS CHANGED TODAY
     C           MODE      IFEQ 'I'
     C           ZLCD      IFEQ RUND
     C                     ADD  1         ZCHG
     C                     ADD  1         ZCHGP1
     C                     END
     C                     ELSE
      * A MODE -
     C           MODE      IFEQ 'A'
     C           RECI      IFNE '*'
     C                     ADD  1         ZLIVE
     C                     END
     C           ZLCD      IFEQ RUND
      * A MODE - COUNT OF RECORDS READ + LIVE RECORDS
     C                     ADD  1         ZCOUNT
     C                     ELSE
      *  - IGNORE IF LCD NOT EQUAL RUN DATE
     C                     GOTO NEXT
     C                     END
      *
     C                     ELSE
      * L MODE - COUNT OF LIVE RECORDS
     C           RECI      IFNE '*'
     C                     ADD  1         ZLIVE
     C                     ADD  1         ZLIVP1
     C                     ELSE
      * L MODE - IGNORE IF DELETED RECORD
     C                     GOTO NEXT
     C                     END
     C                     END
     C                     END
      *
      * RECORD TO BE PRINTED -
      *     OPEN OUTPUT FILE IF REQUIRED FIRST TIME ONLY
     C           *IN55     IFEQ '0'
     C                     SETON                     55
     C                     Z-ADD70        LINCNT  20
     C                     OPEN SE0352P1
     C                     EXSR RCFP1                                     S01117
     C                     MOVE ETYF      ZETYF                           S01117
     C***********          SETOF                     60                   E29170
     C                     SETOF                     6061                 E29170
     C                     ELSE
      *     OPEN OUTPUT FILE IF REQUIRED NEW LEVEL/BRANCH
     C           *IN60     IFEQ '1'
     C                     Z-ADD70        LINCNT
     C           LVL       IFNE 'S'                                       S01117
     C                     Z-ADD0         PAGE
     C                     OPEN SE0352P1
     C                     MOVE ETYF      ZETYF                           S01117
     C                     EXSR RCFP1                                     S01117
     C                     END                                            S01117
     C***********          SETOF                     60                   E29170
     C                     SETOF                     6061                 E29170
     C                     END
     C                     END
      *
      * DETERMINE LEVEL FOR OUTPUT AND PRINT
      *
     C                     SETOF                     434445
     C           LVLF      IFEQ 'S'
     C                     SETON                     43
     C                     ELSE
     C           LVLF      IFEQ 'C'
     C                     SETON                     44
     C                     ELSE
     C                     SETON                     45
     C                     END
     C                     END
      *
      **FORMAT*BRANCH*HEADING*-*TABLETR*FILE*USING*KEY*************       S01117
      *********IF*NO*RECORD/RECORD*DELETED*-*PRINT*BLANK***********       S01117
      *                                                                   S01117
     C************IN45     IFEQ '1'                                       S01117
     C***********          MOVEL'10      'TRKEY                           S01117
     C***********          MOVE ETYF      TRETYF                          S01117
     C***********TABTRK    CHAINTABLETRF             57                   S01117
     C************IN57     IFEQ '1'                                       S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE BRNM      ZBRNM                           S01117
     C***********          ELSE                                           S01117
     C***********          MOVE *BLANK    ZBRNM                           S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C**                                                                  S01117
     C**  ACCESS ENTITY NAME                                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE ETYF      PENT    3                       S01117
     C                     EXSR ACCENT                                    S01117
     C                     END                                            S01117
      *
      *     PRINT PAGE HEADINGS
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     SETON                     61                   E29170
     C                     END
     C*                                                                   E29170
     C**    PRINT SUBHEADINGS                                             E29170
     C*                                                                   E29170
     C           *IN61     IFEQ '1'                                       E29170
     C                     SETOF                     61                   E29170
     C                     WRITESUBHD                                     E29170
     C                     END                                            E29170
      *
      **  FORMAT OUTPUT & PRINT
     C****CURRENCY*NAMES-READ*TABTG10*FILE*USING*KEY*-*****************   S01117
     C**  ACCESS CURRENCY NAME USING AO AOCURRR0                          S01117
      **   IF NO RECORD/RECORD DELETED - PRINT BLANK
     C***********          MOVEL'20      'TKEY                            S01117
     C***********          MOVE CNCL      TCNCL                           S01117
     C***********          MOVE '1'       TKEY                            S01117
     C***********TABTK     CHAINTABTG10F             56                   S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM *BLANK    @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM CNCL      @AJCD   3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFEQ *BLANKS                                   S01117
     C************IN56     IFEQ '1'                                       S01117
     C***********          MOVE *BLANK    ZCCNM                           S01117
     C***********          ELSE                                           S01117
     C***********RECI      IFNE '*'                                       S01117
     C***********          MOVE CCNM      ZCCNM                           S01117
     C                     MOVE A6CYNM    ZCCNM                           S01117
     C                     ELSE
     C                     MOVE *BLANK    ZCCNM
     C***********          END                                            S01117
     C                     END
      *
      * FORMAT DETAILS FOR PRINT OUTPUT
     C                     SETOF                     515253
     C           ZCHTP     IFEQ 'A'
     C                     SETON                     51
     C                     ELSE
     C           ZCHTP     IFEQ 'I'
     C                     SETON                     52
     C                     ELSE
     C           ZCHTP     IFEQ 'D'
     C                     SETON                     53
     C                     END
     C                     END
     C                     END
      *                                                                   CEU011
     C                     MOVE '0'       *IN48                           CEU011
      *                                                                   CEU011
      **  Converts Long and Short Limit to Euro when Ccy is               CEU011
      **  an 'In' ccy CEU011 is installed                                 CEU011
      *                                                                   CEU011
     C           INCY      IFEQ 'Y'                                       CEU011
     C           CEU011    ANDEQ'Y'                                       CEU011
     C                     Z-ADDLLMF      PFRAM                           CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'                                  CEU011
     C                     PARM *BLANKS   PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM CNCL      PFRCY   3                       CEU011
     C                     PARM BKEURO    PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C           PRTCD     IFNE *BLANKS                                   CEU011
     C           *LOCK     IN   LDA                                       CEU011
     C                     MOVEL'EU0200  'DBFILE                          CEU011
     C                     MOVEL'*CALL   'DBKEY            ***************CEU011
     C                     Z-ADD7         DBASE            * DB ERROR 07 *CEU011
     C                     OUT  LDA                        ***************CEU011
     C                     EXSR DBERR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADDPOUTA     REULN                           CEU011
      *                                                                   CEU011
     C                     Z-ADDSLMF      PFRAM                           CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'                                  CEU011
     C                     PARM *BLANKS   PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM CNCL      PFRCY   3                       CEU011
     C                     PARM BKEURO    PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C           PRTCD     IFNE *BLANKS                                   CEU011
     C           *LOCK     IN   LDA                                       CEU011
     C                     MOVEL'EU0200  'DBFILE                          CEU011
     C                     MOVEL'*CALL   'DBKEY            ***************CEU011
     C                     Z-ADD8         DBASE            * DB ERROR 08 *CEU011
     C                     OUT  LDA                        ***************CEU011
     C                     EXSR DBERR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADDPOUTA     REUSH                           CEU011
     C                     MOVE '1'       *IN48                           CEU011
     C                     ENDIF                                          CEU011
      *
      * FORMAT DATES FOR PRINT OUTPUT
     C                     Z-ADDRVDF      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZRDATE
      *
     C                     MOVE *BLANK    ZEDATE
     C           EXDF      IFNE 0
     C                     Z-ADDEXDF      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ZEDATE
     C                     END
      *
     C                     Z-ADDZLCD      ZDAYNO
     C                     EXSR ZDATE2
      *
     C                     ADD  1         LINCNT
     C                     WRITEDETAIL
      * HOLD DATA UNTIL NEXT SLIMF READ
     C                     MOVE LVLF      ZLVLF   1
     C                     MOVE ETYF      ZETYF
      *
     C*
     C* NEXT
     C           NEXT      TAG                             ** NEXT TAG  **
     C***40******          READ SLIMFLLC                 50               CEU011
     C   40                READ SESLIML1                 50               CEU011
     C**N40******          READ SLIMFL                   50               CEU011
     C  N40                READ SESLIML0                 50               CEU011
     C*                                                                   S01117
     C           ENDSEL    TAG                                            S01117
     C*                                                                   S01117
      *
      * DETERMINE NEED TO CLOSE PRINTER FILE
      *
      * EOF OR 'L' MODE - DELETED RECORD OR 'I' MODE LCD NOT EQUAL
     C           *IN50     IFNE '1'
     C           MODE      IFEQ 'L'
     C           RECI      ANDEQ'*'
     C                     ELSE
     C           MODE      IFEQ 'I'
     C           LCD       ANDNERUND
     C                     ELSE
      *
      * LEVEL CHANGE
     C** ONLY PRODUCE NEW SPOOL FILE IF LEVE IS 'B' OR 'C'                S01117
     C*                                                                   S01117
     C***********MBIN      IFEQ 'Y'                                 S01117E29170
     C           ZLVLF     IFNE LVLF
     C***********          SETON                     60                   E29170
     C                     SETON                     61                   E29170
     C***********          ELSE                                           E29170
     C                     END                                            E29170
      *
      **BRANCH*CHANGE*****************************************************E29170
     C* ENTITY CHANGE                                                     E29170
     C*                                                                   S01117
     C***********ZLVLF     IFEQ 'B'                                       S01117
     C***********ZETYF     ANDNEETYF                                      S01117
     C           ENT       IFEQ 'ALL'                                     E29170
     C           ZETYF     IFNE ETYF                                      S01117
     C                     SETON                     60
     C                     END
     C                     END
     C***********          END                                      S01117E29170
      *
      * TOTAL OUTPUT - CLOSE SE0352P1-IF DETAIL RECORDS WRITTEN
      * LEVEL/BRANCH CHANGE
      *
     C           ZCOUNT    IFEQ 0
     C           ZLIVP1    ANDEQ0
     C           ZCHGP1    ANDEQ0
     C                     ELSE
      *
     C           *IN60     IFEQ '1'
     C                     ADD  6         LINCNT
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
     C                     WRITETOTAL
     C           LVL       IFNE 'S'                                       S01117
     C                     WRITETRAILP1
     C***********          Z-ADD0         ZCOUNT                          S01117
     C***********          Z-ADD0         ZLIVP1                          S01117
     C***********          Z-ADD0         ZCHGP1                          S01117
     C                     CLOSESE0352P1
     C                     END                                            S01117
     C                     Z-ADD0         ZCOUNT                          S01117
     C                     Z-ADD0         ZLIVP1                          S01117
     C                     Z-ADD0         ZCHGP1                          S01117
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C/SPACE 3
      *
      * END OF FILE - IF DETAIL RECORDS WRITTEN - WRITE TOTAL LINE
      *
     C           TOTALS    TAG                             ** TOTALS TAG**
      *
     C           ZCOUNT    IFEQ 0
     C           ZLIVP1    ANDEQ0
     C           ZCHGP1    ANDEQ0
     C                     ELSE
      *
     C           *IN55     IFEQ '1'
     C                     ADD  6         LINCNT
     C*                                                                   S01117
     C           LINCNT    IFGT MAXCNT
     C                     Z-ADD0         LINCNT
     C                     WRITEHEADP1
     C                     END
     C*                                                                   S01117
     C                     WRITETOTAL
     C                     WRITETRAILP1
     C           LVL       IFEQ 'S'                                       S01117
     C                     CLOSESE0352P1                                  S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END
     C                     END
      *
     C/SPACE 3
      *================================================================
      *  RUN CONTROL PROCESS
      *================================================================
      *
      *
      **WRITE*CONTROL*REPORT*HEADINGS*************************************S01117
     C***********          WRITEHEADAU                                    S01117
      *
      * READ AUDIT RECORD
      *
     C                     READ SLIMA                    50
     C           *IN,50    IFEQ '1'
     C***********          MOVEL'1'       *INU8                           S01117
     C***********          MOVEL'1'       *INU7                           S01117
     C***********          MOVEL'02'      DBASE            **DB ERROR 02**S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     Z-ADD2         DBASE            **DB ERROR 02**S01117
     C                     MOVEL'SLIMA'   DBFILE
     C                     MOVE *BLANK    DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C***********          WRITEERROR                                     S01117
     C***********          WRITETRAILAU                                   S01117
     C***********          GOTO ENDPGM                                    S01117
     C                     END
      *
      * 'I' MODE - PRINT REPORT
     C           MODE      IFEQ 'I'
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLI
      *
      *
      * 'A'/'L' MODE -
     C                     ELSE
      *
      *
      * 'A' MODE - DO RUN CONTROLS
     C           MODE      IFEQ 'A'
     C           NLRF      ADD  ISRF      ZWORK
     C           ZWORK     SUB  NDLF      ZWORK
     C           ZWORK     IFNE ZLIVE
     C           LVL       ANDEQ'S'                                       S01117
     C                     SETON                     U854
     C                     END
      *
      *   - PRINT REPORT
      *
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLA
      *
      *  - UPDATE AUDIT RECORD
     C           *INU8     IFEQ '0'
     C                     Z-ADD0         ISRF
     C                     Z-ADD0         AMNF
     C                     Z-ADD0         NDLF
     C                     Z-ADDNRCF      NLRF
     C                     UPDATSLIMAF
     C                     END
      *
      * 'L' MODE - DO RUN CONTROLS
     C                     ELSE
     C           NRCF      IFNE ZLIVE
     C           LVL       ANDEQ'S'                                       S01117
     C                     SETON                     U854
     C                     END
      *
      *  - PRINT REPORT
     C                     WRITEHEADAU                                    S01117
     C                     WRITECONTROLL
     C                     END
     C                     END
      *
      *  IF NO OUTPUT - WRITE MESSAGE TO THIS EFFECT
      *
     C           *IN55     IFEQ '0'
     C                     WRITENONE
     C                     END
      *
     C***********          WRITETRAILAU                                   S01117
     C/SPACE 3
      *================================================================
      *  END OF PROGRAM                                               *
      *================================================================
      *
     C           ENDPGM    TAG                             ** ENDPGM TAG**
     C                     SETON                     LR
     C                     RETRN
     C*
     C*****************************************************************
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C**                                                              *   S01117
     C**  ACCENT SR.- ACCESS ENTITY NAME                              *   S01117
     C**                                                              *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           ACCENT    BEGSR                           *** ACCENT *** S01117
     C**                                                                  S01117
     C** FOR MULTIBRANCHING:-                                             S01117
     C**   FORMAT BRANCH/COMPANY HEADING USING ACCESS OBJECT              S01117
     C**   IF FAILED, PRODUCE DBASE ERROR                                 S01117
     C**                                                                  S01117
     C           LVL       IFEQ 'B'                                       S01117
     C                     MOVE *BLANK    ZBRNM                           S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM PENT      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C**                                                                  S01117
     C**  CHECK FOR DATABASE ERROR                                        S01117
     C**                                                                  S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVELPENT      DBKEY                           S01117
     C                     MOVEL@OPTN     DBOPTN           ***************S01117
     C                     Z-ADD3         DBASE            * DB ERROR 03 *S01117
     C                     OUT  LDA                        ***************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C                     MOVE BRNM      ZBRNM                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           LVL       IFEQ 'C'                                       S01117
     C                     MOVE *BLANK    ZCMNM                           S01117
     C                     CALL 'AOCOMPR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM PENT      @CENB   3                       S01117
     C           SDCOMP    PARM SDCOMP    DSFDY                           S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVELPENT      DBKEY                           S01117
     C                     MOVEL'SDCOMPPD'DBFILE           ***************S01117
     C                     Z-ADD4         DBASE            * DB ERROR 04 *S01117
     C                     MOVEL@OPTN     DBOPTN           ***************S01117
     C                     OUT  LDA                                       S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C                     MOVE CMNM      ZCMNM                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C**                                                              *   S01117
     C**   DBERR SR.- DATABASE ERROR SUBROUTINE                       *   S01117
     C**                                                              *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           DBERR     BEGSR                           ** DBERR SR ** S01117
     C**                                                                  S01117
     C**   DATABASE ERROR HANDLING , REPORT ETC.                          S01117
     C**                                                                  S01117
     C** WRITE DB ERROR DETAILS TO P1                                     S01117
     C**                                                                  S01117
     C           *IN55     IFNE '1'                                       S01117
     C           *IN55     OREQ '1'                        * P1 NOT OPEN  S01117
     C           *IN60     ANDEQ'1'                                       S01117
     C                     ELSE                            * P1 OPENED    S01117
     C                     ADD  9         LINCNT                          S01117
     C           LINCNT    IFGT MAXCNT                                    S01117
     C                     WRITEHEADP1                                    S01117
     C                     END                                            S01117
     C                     WRITEERRORP1                                   E29170
     C                     WRITETRAILP1                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** OUTPUT RUN CONTROL DETAILS FOR AU                                S01117
     C**                                                                  S01117
     C                     WRITEHEADAU                                    S01117
     C           MODE      IFEQ 'I'                                       S01117
     C                     WRITECONTROLI                                  S01117
     C                     ELSE                                           S01117
     C           MODE      IFEQ 'A'                                       S01117
     C                     WRITECONTROLA                                  S01117
     C                     ELSE                                           S01117
     C                     WRITECONTROLL                                  S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** OUTPUT DB ERROR DETAILS FOR AU                                   S01117
     C**                                                                  S01117
     C                     WRITEERROR                                     S01117
     C*                                                                   S01117
     C                     SETON                     U7U8                 S01117
     C                     EXSR *PSSR                                     S01117
     C**                                                                  S01117
     C                     SETON                     LR                   S01117
     C                     RETRN                                          S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
     C*****************************************************************   S01117
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C**                                                              *   S01117
     C** RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF      *   S01117
     C**                                                              *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           RCFP1     BEGSR                            ** RCFP1 **   S01117
     C*                                                                   S01117
     C**      ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     MOVE *BLANK    PETYF   3                       S01117
     C**                                                                  S01117
     C**    IF LEVEL = 'C', ENTITY = 'ALL', FILE NOT EMPTY OR             S01117
     C**       LEVEL = 'B', ENTITY = 'ALL', FILE NOT EMPTY                S01117
     C**                                                                  S01117
     C           ENT       IFEQ 'ALL'                                     S01117
     C************IN55     ANDEQ'0'                                 S01117E29170
     C           *IN55     ANDEQ'1'                                       E29170
     C                     MOVE ETYF      PETYF                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**    IF LEVEL = 'C', ENTITY NOT = 'ALL' OR                         S01117
     C**       LEVEL = 'B', ENTITY NOT = 'ALL'                            S01117
     C**                                                                  S01117
     C           LVL       IFEQ 'C'                                       S01117
     C           ENT       ANDNE'ALL'                                     S01117
     C           LVL       OREQ 'B'                                       S01117
     C           ENT       ANDNE'ALL'                                     S01117
     C                     MOVE ENT       PETYF                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM PETYF     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C**                                                              *   S01117
     C** RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF      *   S01117
     C**                                                              *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           RCFAU     BEGSR                            ** RCFAU **   S01117
     C*                                                                   S01117
     C**      ENSURE AUDIT SPOOL FILE RECORDED BY RCF                     S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           ZSNUMU                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
      *****************************************************************   S01117
      /EJECT                                                              S01117
      *****************************************************************   S01117
      *                                                               *   S01117
      *  *PSSR  - Error control subroutine                            *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
      *                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C**                                                                  S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
     C********************************************************************S01117
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
     C*COPY*ZSRSRC*ZSYSTMZ1************                                   S01117
      /EJECT
      ***
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
