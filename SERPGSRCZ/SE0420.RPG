     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Formatted telexes split')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Securities Trading Module                            *
     F*                                                               *
     F*  SE0420 - Formatted Telexes Split                             *
     F*                                                               *
     F*  Function:  This program produces, from the Telex Extract     *
     F*   (COB)     file, formatted telex output files for reporting  *
     F*   (I/C)     and transmission to Euroclear and Cedel.          *
     F*                                                               *
     F*  Called By: SEC0603 - COB Pay/Receive Telexes                 *
     F*             SEC3305 - I/C Pay/Receive Telexes                 *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046998A          Date 15Apr21               *      
      *  Prev Amend No. MD057247           Date 01Feb21               *
      *                 MD046248           Date 27Oct17               *
      *                 226449             Date 24Jun15               *
      *                 BUG27939A          Date 12Aug10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG18053           Date 15Apr08               *
      *                 248637             Date 26Jun07               *
      *                 CPK027             Date 17Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 162270A            Date 12Jan07               *
      *                 162270             Date 18Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG11613           Date 26Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSE071             Date 19Jul05               *
      *                 221297             Date 29Mar01               *
      *                 CGL029             Date 01Sep03               *
      *                 208241             Date 21Aug02               *
      *                 180056             Date 18Oct00               *
      *                 CSE037             Date 29Apr02               *
      *                 CSE035             Date 22Apr02               *
      *                 CAS006             Date 21Jan03               *
      *                 206316             Date 19Jul02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CPK015             Date 01Jul02               *
      *                 CSE031             Date 09Nov01               *
      *                 180707             Date 25Jul00               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE022             Date 29Mar01               *
      *                 127566             Date 09May01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 130862             Date 18Oct98               *
      *                 151945             DATE 06Jan99               *
     F*                 CAP003             DATE 04FEB97               *
     F*                 CSE005             DATE 04FEB97               *
     F*                 065352             DATE 15APR97               *
     F*                 101997 AC          DATE 11JUL96               *
     F*                 090903             DATE 27JUN96               *
     F*                 100228             DATE 30MAY96               *
     F*                 100017             DATE 18APR96               *
     F*                 092649             DATE 15APR96               *
     F*                 071476             DATE 23FEB96               *
     F*                 092961             DATE 04OCT95               *
     F*                 091254             DATE 20OCT95               *
     F*                 086491             DATE 15JUN95               *
     F*                 050501             DATE 15AUG94               *
     F*                 052254             DATE 10JAN94               *
     F*                 S01401             DATE 16JUN93               *
     F*                 S01397             DATE 10SEP92               *
     F*                 E41705             DATE 22JUN92               *
     F*                 E40869             DATE 10JUN92               *
     F*                 E38340             DATE 24MAY92               *
     F*                 E31187             DATE 20NOV91               *
     F*                 E32081             DATE 18NOV91               *
     F*                 E32028             DATE 18NOV91               *
     F*                 E29170             DATE 07OCT91               *
     F*                 S01117             DATE 07MAY91               *
     F*                 S01269             DATE 17JUL90               *
     F*                 S01271             DATE 07JUN90               *
     F*                 E23697             DATE 05OCT90               *
     F*                 E21524             DATE 12JUN90               *
     F*                 E21222             DATE 26FEB90               *
     F*                 E20651             DATE 04JAN90               *
     F*                 E19949             DATE 27OCT89               *
     F*                 E18208             DATE 07/07/89              *
     F*                 E16475             DATE 07/07/89              *
     F*                 E16301             DATE 07/07/89              *
     F*                 S01190             DATE 24/02/89              *
     F*                 S01186             DATE 09/11/88              *
     F*                 S01176             DATE 09/11/88              *
     F*                 E14592             DATE 12/10/88              *
     F*                 E15014             DATE 07/10/88              *
     F*                 E15436             DATE 04/10/88              *
     F*                 E14515             DATE 23/09/88              *
     F*                 E14219             DATE 20/09/88              *
     F*                 S01175             DATE 01/07/88              *
     F*                 S01170             DATE 01/07/88              *
     F*                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046998A - Recompiled due to changes in /COPY ZDYYRZ3       *
      *            - Applied fix for MD057480                         *      
      *  MD057247 - Multiple calls of UTCHOBJEX for several COB com-  *
      *             ponents - Securities module.                      *
      *           - Moved the call of AOSARDR0 from /copy ZLCDZ1.     *
      *  MD046248 - Finastra Rebranding                               *
      *  226449 - Recompiled over changes made in /COPY ZDYYRZ3.      *
      *         - Applied for MD034387.                               *
      *  BUG27939A - Halt COB if DB Error encountered in SEDORFRTV    *
      *  BUG18053 - SEC0603 Database Error 007                        *
      *  248637 - Database error 12 in pgm/SE0500, file ACNUM.        *
      *  CPK027 - Errors in compiling MP1_3_TTTS - change WPYFM to 6A *
      *  162270A- Change feature BCY001 to CSE099.                    *
      *  162270 - Amended program such that for a TP trade with a     *
      *           pay code of 1, a clearance type of 3 or 4 and a pay *
      *           from different to the delivered to, MT202 and MT210 *
      *           will be generated.                                  *
      *  BUG11613 - SEC0603 00001 failed, DB error 15 encountered     *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  221297 - Avoid Dbase error 18 for PAYT and PAYF              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  208241 - Recompiled over changed /CPY ZSDESCZ3.              *
      *  180056 - Recompiled over changed in ZDYYRZ3.                 *
      *  CSE037 - Bond Pricing - 3 Decimal Places in Trades Input     *
      *  CSE035 - NX/NNX Coupon Payment Processing.                   *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
     F*  206316 - Recompiled over changed ZLCDZ1.                     *
      *  CPK015 - Release 4.01 Packaging:                             *
      *           - A default timestamp string is required for WRITE. *
     F*  CSE031 - Coupon Fixing for Floating Rate Notes.              *
     F*           (recompilation due to change to ZNCD/ZLCD)          *
     F*  180707 - No Position Settlements generated. Recompile over   *
     F*           changes in /COPY ZNCDZ3.                            *
      *  CSE022 - Depository Definition Enhancement                   *
      *  127566 - Recompiled over changed ZSDESCZ3                    *
      *  CSE023 - Treaty Withholding Tax (Recompiled ATPRP)           *
     F*  130862 - Recompiled over ZLCDZ1 & ZDAYSZ2 changes.           *
     F*  151945 - Recompiled Over changed ZDYYRZ3 .                   *
     F*  CAP003 - Conversion of Midas inputs to modular API structure *
     F*           Phase 2.  Recompiled.                               *
     F*  CSE005 - Effect of holidays on FRN Coupon Dates              *
     F*           (recompilation due to change to ZNCD/ZLCD)          *
     F*  065352 - Database error 03 due to indicators not being reset *
     F*  101997 - FIELD INPUT DECLARE  AS CHAR SO TEST IF EQUAL TO    *
     F*           BLANKS AS WELL LIKE PAYT.AVOID DATA BASE ERROR AT 18*
     F*  090903 - Bypass Database error checking for the For A/C of   *
     F*           field. Customer will not be validated as SE customer*
     F*  100228 - ADD STANDARD SR ZLCDZ1.                             *
     F*           RECOMPILE OVER CHANGED ZDYYRZ3, ZLCDZ1 & ZNCDZ3.    *
     F*  100017 - Position settlement unable to pick up day adj. on   *
     F*           SECTYD. Change subroutine to use DADJN to stop      *
     F*           interest day adjustment being used for amortisation.*
     F*           Recompile over amended subroutine ZDAYS.            *
     F*  092649 - DBASE ERROR AT 18 : WHEN EXSR HOUSE, THE FIELD      *
     F*           INPUT MUST HAVE A CORRECT NUMBER. IF BLANKS, SET IT *
     F*           TO THE COUNTERPARTY CUSTOMER NUMBER (TCNR)          *
     F*  071476 - Dbase error 18 occurred if 'Pay to for account of'  *
     F*           was entered as a counterparty nostro. Code changed  *
     F*           so that if counterparty nostro is entered the CNUM  *
     F*           of the 'counterparty customer no' is used.          *
     F*  092961 - Recompile over ZDAYSZ2 which was amended by 086491  *
     F*           (Wrong number of days calculated for day basis 1    *
     F*           when start or end day is last day of February)      *
     F*  091254 - RECOMPILE OVER CHANGED ZLCDZ1 & ZNCDZ3              *
     F*  086491 - Wrong nbr of days calculated for day basis 1        *
     F*           when start or end day is last day of February       *
     F*           Recompiled for ZSRSRC/ZDAYSZ2 changes.              *
     F*  050501 - Program does not access ICD2 (TABTB11) causing an   *
     F*           error when TABTB11 field DNWD is used. Added        *
     F*           standard subroutine ZICD2 to get TABTB11 data.      *
     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
     F*           to 10,9                                             *
     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
     F*          - Recompiled due to changes to files.                *
     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
     F*          - Recompiled due to changes to files.                *
     F*  E41705 - Do not CHAIN to CLINT if Input blank in SR/HOUSE    *
     F*           for Clearance Type = 2 :-                           *
     F*           1. Deliver From and Trade Purchase                  *
     F*           2. Deliver To and Trade Sale                        *
     F*           See E22374 in SE0050 (Trades Maint), which defaults *
     F*           above fields to blank if no Std Settlements for CUST*
     F*           - If this is the case use TCNR(Trade Cust) instead. *
     F*  E40869  -  Prevent a database error if either the            *
     F*             'Deliver to' or the 'Deliver from' fields         *
     F*             on the original trade are blank                   *
     F*  E38340 - Various changes:                                    *
     F*          - Cedel Cusip Number is 9 digits, not 6 - changed    *
     F*            the CEDTXnn extract files to reflect this.         *
     F*          - Execution of SR/CLIENT is missing in a few places  *
     F*            leading to incorrect details being printed.        *
     F*          - Correction of some commenting, etc.                *
     F*  E31187 - Reference on AU should say SE0420AU not SE0420      *
     F*  E32028 - No pay/receives being produced for authorised trad  *
     F*  E29170 - RCF PROCESSING                                      *
     F*  S01117 - Multibranching                                      *
     F*  S01269 - Trades Authorisation                                *
     F*  S01271 - SE Pay/Receive in Input Cycle                       *
     F*             -  Check Amended trades file before Start of Busi-*
     F*                ness trades.  Add IC/COB narrative.            *
     F*             -  Write new ATPRP record after processing Action *
     F*                code 'I' during Input Cycle.                   *
     F*             -  Also needed recompiling as SEEUC changed.      *
     F*             -  Also includes some clear up of comments.       *
     F*             -  Also corrected legend on Audit report.         *
     F*  E23697  - Other settlements "AGAINST PAYMENT" purchases must *
     F*            show where payment is due (pay to/ for a/c) and not*
     F*            from where the stock is coming. New field PAYNOS   *
     F*            introduced to file OTHSTD for counterparty nostro. *
     F*            Zero settlement method should show a blank pay type*
     F*  E21524 - Rename BRCD from CLINTCB in Telex programs to avoid *
     F*           it accidentally overwriting Settlement Branch Code. *
     F*  E21222 - ENSURE CORRECT VALUE DATE IS WRITTEN OUT            *
     F*  E20651 - DB ERRORS NUMBERS USED IN MORE THAN ONE PLACE.      *
     F*           NEW ERROR NUMBERS AS FOLLOWS:                       *
     F*            DB ERROR 09  ->  18                                *
     F*            DB ERROR 09  ->  19                                *
     F*            DB ERROR 11  ->  20                                *
     F*            DB ERROR 11  ->  21                                *
     F*  E19949 - CHAIN FAIL ON PAY FROM OR PAY TO FIELD IF ENTRY     *
     F*           IS A COUNTERPARTY NOSTRO NAME. *IN99 IS USED IN     *
     F*           RSR38 SUBROUTINE FOR A SUCCESSFUL MATCH OF A        *
     F*           COUNTERPARTY DEPOT WITH THE DEPOTS' ARRAY 'DAR'.    *
     F*           IT WAS NOT SET OFF, SO AT THE NEXT TEST FOR 99 ON   *
     F*           DB ERROR 03 ENDED THE PROGRAM.                      *
     F*  E18208 - TRADES WITH PAY CODES 2 OR 4 SHOULD BE TREATED      *
     F*           AS PAY CODE 3 FOR EUCLID AND CEDEL                  *
     F*           IF TYPE '03' EUCLID INSTRUCTION THE ACTION CODE     *
     F*           FROM PREVIOUS TRADE WAS BEING USED                  *
     F*  E16475 - IN SOME CASES THE EUCLID AND CEDEL PARTICIPANT      *
     F*           NOS (5 DIGITS IN A 6 DIGIT FIELD) IS BEING MOVED    *
     F*           RATHER THAN MOVED LEFT INTO 5 DIGIT RESULT FIELD    *
     F*  E16301 - SHOULD NOT CAUSE A DB ERROR IF TRADE IS THROUGH     *
     F*           DEPOT THAT IS NOT ON INVESTMENT TYPE OF SECURITY    *
     F*           ALSO SOME CEDEL MESSAGES ARE PRODUCED WHEN          *
     F*           TRADE IS THROUGH EUROCLEAR                          *
     F*  S01190 - EUCLID CHANGES.                                     *
     F*  S01186 - POST-INCORPORATION ENHANCEMENT.                     *
     F*  S01176 - SECURITIES TRADING 3.1 (LF/INSTR REPLACED BY        *
     F*           LF/OTHST)                                           *
     F*  E14592 - CCYCHK S/R PRODUCES DB ERROR IF EUCLID FIELDS       *
     F*           HAVE NOT BEEN ENTERED IN SD0020.HOWEVER THESE       *
     F*           FIELDS ARE NOT MANDATORY SO CHECK IS REMOVED.       *
     F*  E15014 - ERROR IN PRODUCING CEDEL MESSAGES. ALSO             *
     F*           DATABASE ERROR NOT REPORTED CORRECTLY               *
     F*  E15436 - ENSURE CCY CODE INSERTED FOR EI TYPE 02             *
     F*         - SEEUCD1 TRADE PRICE - OUTPUT FROM PRIC NOT TDPY     *
     F*  E14515 - PREVENT DATABASE ERROR ON DEPOTS ON INVESTMENT      *
     F*           TYPE                                                *
     F*  E14219 - 2 TELEXES ARE NOT NEEDED WHEN TRADE IS WITH A       *
     F*           PORTFOLIO CLIENT                                    *
     F*  S01175 - EUCLID FIXES                                        *
     F*  S01170 - AMENDMENT TO INCLUDE SWIFT EXTRACTING FOR           *
     F*           SECURITIES TRADING II                               *
     F*                                                               *
     F*****************************************************************
      *
     FACNUM   IF  E           K        DISK
     FSETLXD  IP  E           K        DISK
     FSETLXA  IF  E           K        DISK
     FSECTY   IF  E           K        DISK
     FINVTP   IF  E           K        DISK
     FTABSE   IF  E           K        DISK
     F            TABLETAF                          KIGNORE
     F*********** TABTB11F                          KIGNORE               S01190
     F            TABTB40F                          KIGNORE
     F            TABTE10F                          KIGNORE
     F            TABTE20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F*********** TABLETJF                          KIGNORE               S01117
     F            TABLETKF                          KIGNORE
     F            TABLETNF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETXF                          KIGNORE
     F************TABLET2F                          KIGNORE               E19949
     F            TABLET3F                          KIGNORE
     F            TABLET5F                          KIGNORE
     FTRADS   IF  E           K        DISK
     FTRATX   UF  E           K        DISK                               S01269
     F            TRADSDF                           KRENAMETRAXF          S01269
     FSOBTR   IF  E           K        DISK                               S01190
     F            TRADSDF                           KRENAMETRADF          S01190
     FATPRP   UF  E           K        DISK                      A        S01271
     F            TRADSDF                           KRENAMEATPRPDF        S01271
     FCLINT   IF  E           K        DISK
     F            CLINTC1F                          KIGNORE
     FNOTLX   O   E           K        DISK
     FUNFOR   O   E           K        DISK
     FECASH   O   E           K        DISK
     F** ECTLX   UF  E           K        DISK                      A
     FSEEUC   UF  E           K        DISK                      A
     FCEDCS   O   E           K        DISK
     FCEDTX   O   E           K        DISK
     FSTPR2   O   E           K        DISK
     F***INSTR   O   E           K        DISK                            S01176
     FOTHST   O   E           K        DISK                               S01176
     FOTHSTA  UF  E                    DISK                               S01176
     FSE0420AUO   F     132     OF     PRINTER
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   01         S/SETLXD - FORMAT SETLXDF                        *
     F*   02         S/SETLXA - FORMAT SETLXAF                        *
     F*   03         S/TRADS - FORMAT TRADSDF                         *
     F*   06         S/SECTY - FORMAT SECTYDF                         *
     F*   07         S/CLINT - FORMAT CLINTCBF                        *
     F*   08         S/CLINT - FORMAT CLINTSEF                        *
     F*   10         S/TABLE - FORMAT TABTB10F                        *
     F*   11                 - FORMAT TABTG10F                        *
     F*   12                 - FORMAT TABTG20F                        *
     F*   13                 - FORMAT TABTB36F                        *
     F*   14                 - FORMAT TABLETRF                        *
     F*   15                 - FORMAT TABELTLF                        *
     F*                                                               *
     F*   16         EXCEPTION OUTPUT TO STPR2TXF                     *
     F*   17         'BRIDGE' INDICATOR FOR OUTPUT SUBROUTINES        *
     F*   18         SUPPRESS TELEX = 'Y' ON S/TRADE OR S/STCAN       *
     F*   19         EXCEPTION OUTPUT TO UNFORABF                     *
     F*   20         EXCEPTION OUTPUT TO NOTLXABF                     *
     F*   21         EXCEPTION OUTPUT TO ECASHABF                     *
     F****22*********EXCEPTION*OUTPUT*TO*INSTRABF**********************   S01176
     F*   22         EXCEPTION OUTPUT TO OTHSTDF                      *   S01176
     F*   23         EXCEPTION OUTPUT TO SEEUCD0F                     *
     F*   24                             SEEUCD1F                     *
     F*   25                             SEEUCD2F                     *
     F*   26         EXCEPTION OUTPUT TO CEDCS10F                     *
     F*   27                             CEDCS12F                     *
     F*   28                             CEDCS90F                     *
     F*   29                             CEDCS92F                     *
     F*   30         EXCEPTION OUTPUT TO CEDTX31F                     *
     F*   31                             CEDTX32F                     *
     F*   32                             CEDTX41F                     *
     F*   33                             CEDTX42F                     *
     F*   34                             CEDTX51F                     *
     F*   35                             CEDTX52F                     *
     F*   36                             CEDTX61F                     *
     F*   37                             CEDTX62F                     *
     F*   38                             CEDTX81F                     *
     F*   39                             CEDTX82F                     *
     F*                                                               *
     F*   40         NOT FIRST CYCLE                                  *
     F*                                                               *
     F*   43         CURRENCY HAS 0 D.P.                              *
     F*   44         CURRENCY HAS 1 D.P.                              *
     F*   45         CURRENCY HAS 2 D.P.                              *
     F*   46         CURRENCY HAS 3 D.P.                              *
     F*   47         VALID TRAILER RECORD READ                        *
     F*                                                               *
     F*   50         ACTION CODE - C                                  *
     F****51*****                - I                                  *   S01271
     F****52*****                - P OR Q                             *   S01271
     F*                                                               *
     F*   53         WORK INDICATOR                                   *
     F*                                                               *
     F*   54         CLEARANCE TYPE - 0                               *
     F*   55                        - 1                               *
     F*   56                        - 2                               *
     F*   57                        - 3                               *
     F*   58                        - 4                               *
     F*   59                        - 5                               *
     F*   60         TRADE IS A PURCHASE (N60 MEANS A SALE)           *
     F*   61         ON = MARKET , OFF = SAFE CUSTODY                 *
     F*   62-63      WORK INDICATORS IN MAIN                          *
     F*   64         DELIVER TO BLANK FOR PURCHASE                    *
     F*   65         DELIVER FROM BLANK FOR SALE                      *
     F*   66         WORK INDICATOR  IN 'R' S/R'S                     *
     F*   67         WORK INDICATOR                                   *
     F*   70         WORK INDICATOR                                   *
     F*   71         WORK INDICATOR                                   *
     F*   74         ATPRP ACCESS                                     *   S01271
     F*   75         SOBTR ACCESS                                     *   S01271
     F*   76         TRATX ACCESS                                     *   S01269
     F****80*********PAY*CODE*.NE.*'3'*********************************   E38340
     F*   80         Pay Code: ON - (0, 1, 5); OFF - (2, 3, 4)        *   E38340
     F*   81         When = 0, Input Cycle run; when = 1, COB run     *   S01271
     F*   83         CURRENCY IS JAPANESE YEN                         *
     F*   84         USER IS FUNGIBLE                                 *
     F*   85         C/PARTY IS FUNGIBLE                              *
     F*   88         EOF ON S/TABLE WHEN READING CURRENCIES           *
      *   89         Retail Settlements                               *                       248637
     F*                                                               *
     F*   90-97      STANDARD USE                                     *
     F*                                                               *
     F*   91         WORK IND FOR ZZADD/ZZSUB                         *
     F*   98         ON = MMDDYY DATE FORMAT                          *
     F*   99         MIDAS STANDARD SUBROUTINE ERROR                  *
     F*                                                               *
     F*   L1         'PAY TO' IS RETAIL A/C NUMBER OR NOSTRO          *
     F*   L2         'PAY FROM' IS RETAIL A/C NUMBER OR NOSTRO        *
     F*                                                               *
     F*   OUTPUT                                                      *
     F*   NU7+U8     FILE CONTROLS OUT OF BALANCE                     *
     F*   U7+U8      DATABASE ERROR                                   *
     F*                                                               *
     F*****************************************************************
      /EJECT
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZSDESCZ1
     E/COPY ZSRSRC,ZPOWERZ1
     E/COPY ZSRSRC,ZNCDZ1                                                 S01190
     E                    CCYZ      150  3               CURRENCIES
     E                    DPAR      150  1 0             CCY D.P.
     E                    SWAR      150  3               SWIFT CCY'S
     E                    E1AR      150  2 0             E/C CCY 1
     E                    E2AR      150  2 0             E/C CCY 2
     E                    CAAR      150  3               CEDEL ALPHA
     E                    CNAR      150  2 0             & NUM. CCY'S
     E**********          DAR        10  6 0             DEPOTS TABTB36                S01176 CSD027
     E                    DAR        10  6               DEPOTS TABTB36                       CSD027
     E**********          ODR        10  6        DEPOTS CLINTSE   S01176 CSE022
     E                    ODR        10 20                                CSE022
     E                    HARR       12  1               HASH ARRAY       S01190
     E/COPY ZSRSRC,ZALIGNZ1                                               S01175
     E/COPY ZSRSRC,ZDAYSZ1                                                S01190
     E                    STAMP   1   1 26                                                    CPK015
      ** Array containing dummy timestamp                                                     CPK015
      /EJECT
     ISETLXDF     01
     I*
     I*   S/SETLX FILE
     I*
     I              RECI                            RECITX
     I***********   BCHT                            BRCDX                 S01117
     I              BCBA                            BRCDX                 S01117
     I*
     ISETLXAF     02
     I              NORE                            NORETX
     I*
     ITRADSDF     03
     ISECTYDF     06
     I*
     ICLINTCBF    07
     I***********   BRCD                            BRCDCL         E21524 S01117
     I              BRCB                            BRCDCL                S01117
     I*
     ICLINTSEF    08
     I*
     ITABTB10F    10
     I*
     I*   S/TABLE FILE
     I*
     ITABTG10F    11
     I*
     ITABTG20F    12
     I*
     ITABTB36F    13
     I*
     ITABLETRF    14
     I*
     ITABLETLF    15
      *                                                                                       CSE037
     IINVTPDF                                                                                 CSE037
     I              SFLG                            ISFLG                                     CSE037
     I*
     ISCSARD    E DSSCSARDPD                                              CSE022
      ** External DS for SAR Details                                      CSE022
      *                                                                   CSE022
     IDSFDY     E DSDSFDY                                                 CSE022
      ** First DS for Access Programs, short data structure               CSE022
      *                                                                                       CSD027
     ISDCNST    E DSSDCNSTPD                                                                  CSD027
     I* Counterparty Nostro Details                                                           CSD027
      *                                                                   CSE022
     I*LDA********UDS                            256                      S01117
     ILDA         DS                            256                       S01117
     I*       LOCAL DATA AREA
     I*
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 183 DBLOT                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I            DS
     I*   DS TO GET AT PAYT AS A NOSTRO CODE OR A CLIENT NUMBER
     I*
     I                                        1   2 PYNOST
     I**********                              1   60PYCLNT                                    CSD027
     I                                        1   6 PYCLNT                                    CSD027
     I                                        1   7 PYCLAT
     I**********                              3  12 PYREST                                    CGL029
     I                                        3  18 PYREST                                    CGL029
     I                                        1  10 PYT10
     I                                       11  12 PYTAC
     I                                        1   8 PYCLZT
     I**********                              9  12 PYTCPN                             E80816 CGL029
     I**********                              7  10 PYTOCK                                    CGL029
     I**********                              3  10 PYTL10                                    CGL029
     I**********                              1  12 PAYT                                      CGL029
     I                                        9  18 PYTCPN                                    CGL029
     I                                        7  16 PYTOCK                                    CGL029
     I                                        3  16 PYTL10                                    CGL029
     I                                        1  18 PAYT                                      CGL029
     I            DS
     I*   DS TO GET AT PYFM AS A NOSTRO CODE OR A CLIENT NUMBER
     I*
     I                                        1   2 PYNOSF
     I**********                              1   60PYCLNF                                    CSD027
     I                                        1   6 PYCLNF                                    CSD027
     I                                        1   7 PYCLAF
     I**********                              3  12 PYRESF                                    CGL029
     I                                        3  18 PYRESF                                    CGL029
     I                                        1  10 PYF10
     I                                       11  12 PYFAC
     I                                        1   8 PYCLZF
     I**********                              9  12 PYFCPN                             E80816 CGL029
     I**********                              7  10 PYFRCK                                    CGL029
     I**********                              3  10 PYFL10                                    CGL029
     I**********                              1  12 PYFM                                      CGL029
     I                                        9  18 PYFCPN                                    CGL029
     I                                        7  16 PYFRCK                                    CGL029
     I                                        3  16 PYFL10                                    CGL029
     I                                        1  18 PYFM                                      CGL029
     I            DS
     I*   DS TO PUT TWO INTEGER FIELDS TOGETHER AS A REAL NUMBER
     I*
     I***********                             1  132FORHSH                S01190
     I***********                             1  110EUCU                  S01190
     I***********                            12  130EUCD                  S01190
     I                                        1  152FORHSH                S01190
     I                                        1  130EUCA                  S01190
     I                                       14  150EUCD                  S01190
     I            DS
     I*   DS TO SPLIT A REAL INTO TWO INTEGERS
     I*
     I***********                             1  132HASH                  S01190
     I***********                             1  110HASHI                 S01190
     I***********                            12  130HASHD                 S01190
     I                                        1  152HASH                  S01190
     I                                        1  130HASHI                 S01190
     I                                       14  150HASHD                 S01190
     I*           DS                                                      S01190
     I*   DS TO GET AT CVIV(A 13,0) AS A 12,2 IN FOUR DIFFERENT WAYS      S01190
     I*         DEPENDING ON HOW MAY D.P. THE RELEVANT CCY HAS
     I*
     I***********                             1  130CVIV                  S01190
     I***********                             3  130CVI0                  S01190
     I***********                             2  120CVI1                  S01190
     I***********                            13  130CVD1                  S01190
     I***********                             1  110CVI2                  S01190
     I***********                            12  130CVD2                  S01190
     I***********                             1  100CVI3                  S01190
     I***********                            11  120CVD3                  S01190
     I*
     I            DS
     I                                        1  150CVAL                  S01190
     I                                        1  130CVA1                  S01190
     I                                       14  150CVA2                  S01190
     I                                        1  140CVA3                  S01190
     I                                       15  150CVA4                  S01190
     I            DS
     I*   DS ON KEY FOR ACCNT FROM ACNUM
     I*
     I**********                              1   60CNUM                                      CSD027
     I                                        1   6 CNUM                                      CSD027
     I**********                              7  100ACOD                                      CGL029
     I**********                             11  120ACSQ                                      CGL029
     I**********                              1  12 ACCKEY                                    CGL029
     I                                        7  160ACOD                                      CGL029
     I                                       17  180ACSQ                                      CGL029
     I                                        1  18 ACCKEY                                    CGL029
     I**********  DS
     I****DS*ON*KEY*FOR*ECTLX**-*USED*IF*DATABASE*ERROR****************
     I**********
     I**********                              1   1 ACTC
     I**********                              2   60EUDT
     I**********                              7  110EURO
     I**********                             12  130EUIN
     I**********                             14  190NINES
     I**********                              1  19 ECTLXK
     I            DS
     I*   DS ON KEY FOR SEEUC  - USED IF DATABASE ERROR
     I*
     I                                        1   20EUB9                  S01129
     I                                        3   3 ACTC                  S01129
     I                                        4   80EURO                  S01129
     I                                        9  130EUDT                  S01129
     I                                       14  150EUIN                  S01129
     I                                       16  210TRDR                  S01129
     I                                        1  21 SEELXK                S01129
     I            DS
     I*   DS ON KEY FOR S/CLINT - USED IF DATABASE ERROR
     I*
     I                                        1   7 CLNTDS
     I**********                              1   60CK1                                       CSD027
     I                                        1   6 CK1                                       CSD027
     I                                        7   7 CK2
     I            DS
     I*   DS TO GET THE CCY CODE OUT OF THE KEY FOR A S/TABLE RECORD
     I*
     I                                        1  12 KEY
     I                                        9  11 CCYC
     I            DS
     I*   DS TO BUILD A KEY FOR THE NOSTRO CODES TABLE
     I*
     I                                        1  12 NOSKEY
     I                                        1   7 NOSBLK
     I                                        8  10 SETC
     I                                       11  12 NOSNOS
     I            DS
     I*   DS TO BUILD A KEY FOR THE BRANCH CODES TABLE
     I*
     I                                        1  12 BCHKEY
     I                                        1   20BCH10
     I                                        3   9 BCHBLK
     I***********                            10  120BCHS                  S01117
     I                                       10  12 BCSA                  S01117
     I            DS
     I*   DS USED IN OUTPUT OF A COMPOSITE TEXT IN CEDEL MESSAGES
     I*
     I                                        1  43 ALL
     I                                        1  39 WTHFOR
     I                                        1   3 FOR
     I                                        5  24 CRNM
     I                                       26  35 CTWN
     I                                        5  43 NOTFOR
     I*                                                                   S01129
     I            DS                                                      S01129
     I                                        1  158TPDY                  S01129
     I***********                             1   70WTPDYI          S01129S01190
     I                                        1  136WCPDY                 S01175
     I***********                             8  150WTPDYD          S01129E15436
     I*                                                                   E15436
     I            DS                                                      E15436
     I                                        1  158PRIC                  E15436
     I                                        1   70WTPDYI                S01190
     I                                        8  150WTPDYD                E15436
     I*                                                                   S01190
     I            DS                                                      S01190
     I**   LAST 10 DIGITS OF SECURITY CODE = COMMON CODE                  S01190
     I**                                                                  S01190
     I                                        1  12 EUSC                  S01190
     I                                        3  12 EUSCI                 S01190
     I**                                                                  S01190
     I**  TO FORMAT PRINCIPAL AMOUNT                                      S01190
     I            DS                                                      S01190
     I                                        1  150PAMTID                S01190
     I                                        1  14 PAMTI1                S01190
     I                                       15  15 PAMTI2                S01190
     I                                        1  13 PAMTI3                S01190
     I                                       14  15 PAMTI4                S01190
     I**                                                                  S01190
     I**  TO FORMAT PRINCIPAL EXCHANGE RATE                               S01190
     I            DS                                                      S01190
     I                                        1  138PETEMP                S01190
     I                                        1   5 PETI                  S01190
     I                                        6  13 PETD                  S01190
     I**                                                                  S01190
     I**  TO FORMAT ACCRUED EXCHANGE RATE                                 S01190
     I            DS                                                      S01190
     I                                        1  138TDER                  S01190
     I                                        1   5 TDERI                 S01190
     I                                        6  13 TDERD                 S01190
     I**                                                                  S01190
     I**  TO FORMAT ACCRUED INTEREST                                      S01190
     I            DS                                                      S01190
     I                                        1  150ATEMP                 S01190
     I                                        1  14 ATEMP1                S01190
     I                                       15  15 ATEMP2                S01190
     I                                        1  13 ATEMP3                S01190
     I                                       14  15 ATEMP4                S01190
     I**                                                                  S01190
     I**  TO FORMAT SUM OF FEES/COMMISIONS                                S01190
     I            DS                                                      S01190
     I                                        1  130FCTEMP                S01190
     I                                        1  12 FCT1I                 S01190
     I                                       13  13 FCT1D                 S01190
     I                                        1  11 FCT2I                 S01190
     I                                       12  13 FCT2D                 S01190
     I**                                                                  S01190
     I**  TO FORMAT RATE OF ACCRUED INTEREST                              S01190
     I            DS                                                      S01190
     I                                        1  117TDCR                  S01190
     I                                        1   4 TDCRI                 S01190
     I                                        5  11 TDCRD                 S01190
     I**                                                                  S01190
     I**  TO FORMAT NO. OF DAYS ACCRUED                                   S01190
     I            DS                                                      S01190
     I                                        1  158ACRT2                 S01190
     I                                        5   70ACRT3                 S01190
     I                                        4   60ACRT4                 S01190
     I                                        3   50ACRT5                 S01190
     I                                        8   80ACRT6                 S01190
     I                                        7   70ACRT7                 S01190
     I                                        6   60ACRT8                 S01190
     I**                                                                  S01190
     I*  DEPOTS ON TABTB36                                                S01176
     I            DS                                                      S01176
     I                                        1  60 DAR                   S01176
     I**********                              1   60DC01                               S01176 CSD027
     I**********                              7  120DC02                               S01176 CSD027
     I**********                             13  180DC03                               S01176 CSD027
     I**********                             19  240DC04                               S01176 CSD027
     I**********                             25  300DC05                               S01176 CSD027
     I**********                             31  360DC06                               S01176 CSD027
     I**********                             37  420DC07                               S01176 CSD027
     I**********                             43  480DC08                               S01176 CSD027
     I**********                             49  540DC09                               S01176 CSD027
     I**********                             55  600DC10                               S01176 CSD027
     I                                        1   6 DC01                                      CSD027
     I                                        7  12 DC02                                      CSD027
     I                                       13  18 DC03                                      CSD027
     I                                       19  24 DC04                                      CSD027
     I                                       25  30 DC05                                      CSD027
     I                                       31  36 DC06                                      CSD027
     I                                       37  42 DC07                                      CSD027
     I                                       43  48 DC08                                      CSD027
     I                                       49  54 DC09                                      CSD027
     I                                       55  60 DC10                                      CSD027
     I*  DEPOTS ON CLINTSE                                                S01176
     I            DS                                                      S01176
     I**********                              1  60 ODR            S01176 CSE022
     I**********                              1   6 C101           S01176 CSE022
     I**********                              7  12 C102           S01176 CSE022
     I**********                             13  18 C103           S01176 CSE022
     I**********                             19  24 C104           S01176 CSE022
     I**********                             25  30 C105           S01176 CSE022
     I**********                             31  36 C106           S01176 CSE022
     I**********                             37  42 C107           S01176 CSE022
     I**********                             43  48 C108           S01176 CSE022
     I**********                             49  54 C109           S01176 CSE022
     I**********                             55  60 C110           S01176 CSE022
     I                                        1 200 ODR                   CSE022
     I                                        1  20 C201                  CSE022
     I                                       21  40 C202                  CSE022
     I                                       41  60 C203                  CSE022
     I                                       61  80 C204                  CSE022
     I                                       81 100 C205                  CSE022
     I                                      101 120 C206                  CSE022
     I                                      121 140 C207                  CSE022
     I                                      141 160 C208                  CSE022
     I                                      161 180 C209                  CSE022
     I                                      181 200 C210                  CSE022
     I/COPY WNCPYSRC,SE0420I001
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I/COPY ZSRSRC,ZSDESCZ2
     I/COPY ZSRSRC,ZNCDZ2                                                 S01190
     I*                                                                   S01271
     I*   TIME DATA STRUCTURE                                             S01271
     I*                                                                   S01271
     I            DS                                                      S01271
     I                                        1   60CTIME                 S01271
     I                                        1   2 CHOUR                 S01271
     I                                        3   4 CMINT                 S01271
     I*                                                                   S01271
     I*   STRUCTURE TO STORE TRADE RECORD                                 S01271
     I*                                                                   S01271
     C/EJECT
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
     C*
     C*   S/CLINT KEY LIST
     C*
     C           CLNTKY    KLIST
     C**********           KFLD           CK1     60                                          CSD027
     C                     KFLD           CK1     6                                           CSD027
     C                     KFLD           CK2     1
     C*
     C*   S/SEEUC KEY LIST
     C*
     C           SEEKEY    KLIST                                          S01129
     C                     KFLD           EUB9                            S01129
     C                     KFLD           ACTC                            S01129
     C                     KFLD           EURO                            S01129
     C                     KFLD           EUDT                            S01129
     C                     KFLD           EUIN                            S01129
     C                     KFLD           TRDR                            S01129
     C*
     C**  LF/INVTP KEY LIST
     C*
     C           INVTKY    KLIST
     C                     KFLD           NMCY
     C                     KFLD           SITP
     C*
     C*****************************************************************
     C*
     C   40                GOTO START
     C*
     C                     SETON                     40
     C*
     C                     EXSR FIRST
     C   99                GOTO END
      *                                                                   CSE022
      ** Check if Depository Definition Enhancement is installed.         CSE022
      *                                                                   CSE022
     C                     CALL 'AOSARDR0'                                CSE022
     C                     PARM *BLANKS   PRTCO   7                       CSE022
     C                     PARM '*VERIFY' POPTN   7                       CSE022
     C                     PARM 'CSE022'  PSARD   6                       CSE022
     C           SCSARD    PARM SCSARD    DSFDY                           CSE022
      *                                                                   CSE022
     C           PRTCO     IFNE *BLANKS                                   CSE022
     C           PRTCO     ANDNE'*NRF   '                                 CSE022
     C                     MOVE *ON       *INU7                           CSE022
     C                     MOVE *ON       *INU8                           CSE022
     C                     MOVE *ON       *INLR                           CSE022
     C           *LOCK     IN   LDA                                       CSE022
     C                     MOVE 'SCSARDPD'DBFILE                          CSE022
     C                     MOVELPSARD     DBKEY                           CSE022
     C                     Z-ADD22        DBASE                           CSE022
     C                     EXSR *PSSR                                     CSE022
     C                     OUT  LDA                                       CSE022
     C                     GOTO END                                       CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C           PRTCO     IFEQ *BLANKS                                   CSE022
      *                                                                   CSE022
     C                     MOVE 'Y'       CSE022  1                       CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
     C                     MOVE 'N'       CSE022                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                                       162270
      ***Access*SAR*Details*file*to*determine*if*BCY001*installed                     162270 162270A
      ** Access SAR Details file to determine if CSE099 installed                            162270A
      *                                                                                       162270
     C                     CALL 'AOSARDR0'                                                    162270
     C                     PARM '       ' @RTCD                                               162270
     C                     PARM '*VERIFY' @OPTN                                               162270
     C*********************PARM 'BCY001'  @SARD   6                                   162270 162270A
     C                     PARM 'CSE099'  @SARD   6                                          162270A
     C           SCSARD    PARM SCSARD    DSFDY                                               162270
     C           @RTCD     IFNE *BLANK                                                        162270
     C           @RTCD     ANDNE'*NRF   '                                                     162270
     C                     MOVEL'SCSARDPD'DBFILE           **************                     162270
     C                     MOVEL'035'     DBASE            * DBERROR 035*                     162270
     C                     MOVEL@RTCD     DBKEY            **************                     162270
     C                     SETON                     U7U8                                     162270
     C                     EXSR *PSSR                                                         162270
     C                     END                                                                162270
     C           @RTCD     IFEQ *BLANK                                                        162270
     C*********************MOVE 'Y'       BCY001  1                                   162270 162270A
     C                     MOVE 'Y'       CSE099  1                                          162270A
     C                     ELSE                                                               162270
     C*********************MOVE 'N'       BCY001                                      162270 162270A
     C                     MOVE 'N'       CSE099                                             162270A
     C                     ENDIF                                                              162270
     C*
     C**  GET IN ICD 36
     C*
     C                     MOVE '  36'    ZTABKY
     C           ZTABKY    CHAINTABSE                99
     C*
     C** ERROR IF RECORD NOT FOUND OR DELETED
     C*
     C  N99      RECI      COMP 'D'                  9999
     C  N99                GOTO NOER01
     C                     SETON                     U7U8LR
     C                     MOVE 'TABLE'   DBFILE
     C                     MOVELZTABKY    DBKEY            ***************
     C                     Z-ADD01        DBASE            * DB ERROR 01 *
     C                     GOTO END                        ***************
     C*
     C           NOER01    TAG                             ** NOER01 **
     C*
     C                     SETOF                     98
     C*
     C                     MOVE '.'       EDP1
     C                     MOVE '.'       EDP2
     C                     MOVE 'TP'      EUL1                            S01175
     C                     Z-ADD10        BCH10                           S01186
     C*
     C** SET UP FIXED PART OF KEY FOR CHAINING TO NOSTRO CODES TABLE
     C                     MOVEL'70     ' NOSBLK
     C*
     C*   READ IN ALL OF THE CURRENCIES & STORE THE NEEDED DATA
     C*     IN A GROUP OF ARRAYS
     C*
     C                     MOVEL'20      'CCYKEY 12
     C                     MOVE 'AAA1'    CCYKEY
     C           CCYKEY    SETLLTABSE
     C           AGAIN     TAG                             ***  AGAIN  ***
     C*
     C** IF NUMBER OF CURRENCIES READ EXCEEDS 150 THEN DATABASE ERROR
     C*
     C           CCYPTR    COMP 150                  99
     C*
     C  N99                GOTO NOER02
     C                     SETON                     U7U8LR
     C                     MOVE 'TABLE'   DBFILE
     C                     MOVELKEY       DBKEY            ***************
     C                     Z-ADD02        DBASE            * DB ERROR 02 *
     C                     GOTO END                        ***************
     C*
     C           NOER02    TAG                             ** NOER02 **
     C*
     C                     READ TABSE                    88
     C*
     C*  IF END OF CURRENCIES FOUND - GOTO START
     C*
     C   88
     COR   N11N12          GOTO START
     C*
     C*  VALIDATE RECORD IDENTIFICATION ON RECORD READ
     C*
     C           RECI      COMP 'D'                  8888
     C   88                GOTO AGAIN
     C*
     C*  LOAD CURRENCY ARRAYS
     C*
     C  N11                GOTO CCY20
     C                     ADD  1         CCYPTR  30
     C                     Z-ADDCCYPTR    U       30
     C                     MOVE CCYC      CCYZ,U
     C                     Z-ADDCDP       DPAR,U
     C                     MOVE CCYS      SWAR,U
     C*
     C           CCY20     TAG                             ** CCY20 **
     C  N12                GOTO ENDCCY
     C                     Z-ADDECC1      E1AR,U
     C                     Z-ADDECC2      E2AR,U
     C                     MOVE CACC      CAAR,U
     C                     Z-ADDCNCC      CNAR,U
     C           ENDCCY    TAG                             ** ENDCCY **
     C*
     C                     SETOF                       1112
     C                     GOTO AGAIN
     C*
     C****************************************************************
     C*              M A I N    P R O C E S S I N G                  *
     C****************************************************************
     C*
     C           START     TAG                             ** START **
     C*
     C                     SETOF                     L1L218
     C                     MOVE *BLANKS   PAYNOS                          E23697
     C*
     C*    VALIDATE RECORD IDENTIFICATION
     C*
     C   01      RECITX    COMP 'D'                      01
     C   01                ADD  1         CTXEXT  50
     C*
     C**  TEST IF CANCELLATION
     C           ACTO      COMP 'C'                      50
     C*
     C*
     C  N01                GOTO END
     C*                                                                   065352
     C                     MOVE '0'       *IN75                           065352
     C                     MOVE '0'       *IN99                           065352
     C*
     C           ACTO      IFEQ 'C'                                       S01190
     C*                                                                   S01271
     C*    GET CANCEL DETAILS FROM AMENDED TRADES FILE IF POSSIBLE        S01271
     C*     - IF NOT THEN GET THEM FROM START OF BUSINESS TRADES          S01271
     C*                                                                   S01271
     C           TRDE      SETGTATPRP                74                   S01271
     C                     READPATPRP                    74               S01271
     C           *IN74     IFEQ '1'                                       S01271
     C           TRDE      ORNE TDRF                                      S01271
     C***********TRDE      CHAINSOBTR                75            S01190 S01269
     C           TRDE      CHAINTRATX                76                   S01269
     C           *IN76     IFEQ '1'                                       S01269
     C           TRDE      CHAINSOBTR                75                   S01269
     C                     ELSE                                           S01269
     C                     MOVE RECI      SVRECI  1                       S01269
     C                     MOVE '*'       RECI                            S01269
     C                     UPDATTRAXF                                     S01269
     C                     MOVE SVRECI    RECI                            S01269
     C                     END                                            S01269
     C                     END                                            S01271
     C                     ELSE                                           S01190
     C           TRDE      CHAINTRADS                99    -REC NOT FOUND
     C                     END                                            S01190
     C*
     C           *IN99     IFEQ '1'
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TRADS'   DBFILE
     C                     MOVELTRDE      DBKEY            ***************
     C                     Z-ADD03        DBASE            * DB ERROR 03 *
     C                     EXSR *PSSR                      ***************S01117
     C                     OUT  LDA                                       S01117
     C                     GOTO END
      *                                                                   E21222
     C                     ELSE                                           E21222
     C                     Z-ADDTDVD      VDAT                            E21222
      *                                                                   E21222
     C                     END
     C*                                                                   S01190
     C           *IN75     IFEQ '1'                                       S01190
     C                     SETON                     U7U8LR               S01190
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'SOBTR'   DBFILE                          S01190
     C                     MOVELTRDE      DBKEY            ***************S01190
     C                     Z-ADD17        DBASE            * DB ERROR 17 *S01190
     C                     EXSR *PSSR                      ***************S01117
     C                     OUT  LDA                                       S01117
     C                     GOTO END                                       S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C*** BLANK OUT FORHSH                                                S01190
     C                     MOVE *BLANKS   FORHSH                          S01190
      *                                                                                       248637
      ** Seton indicator 89 if retail settlement                                              248637
      *                                                                                       248637
     C           SMTH      IFEQ 14                                                            248637
     C                     MOVE '1'       *IN89                                               248637
     C                     ELSE                                                               248637
     C                     MOVE '0'       *IN89                                               248637
     C                     ENDIF                                                              248637
     C*
     C*** CALCULATE COUNTERVALUE IN SETTLEMENT CURRENCY
     C*
     C                     Z-ADDTCTR      ZAMTCI
     C                     Z-ADDTDER      ZEXCH
     C                     MOVE TMDI      ZMD
     C                     Z-ADD1         U                               S01117
     C           TNMC      LOKUPCCYZ,U                   67               S01117
     C                     Z-ADDDPAR,U    ZCDPI                           S01117
     C                     MOVE TNMC      ZCCYI
     C                     Z-ADD1         U                               S01117
     C           SETC      LOKUPCCYZ,U                   67               S01117
     C                     Z-ADDDPAR,U    ZCDPO                           S01117
     C                     MOVE SETC      ZCCYO
     C                     EXSR ZCONV
     C*********************Z-ADDZAMTCO    CVIV                            S01190
     C                     Z-ADDZAMTCO    CVIV   130                      S01190
     C                     Z-ADDZAMTCO    CVAL                            S01190
     C*
     C**  CHECK IF TRADE IS INCOMPLETE OR GREY
     C*
     C           TINC      IFEQ 'I'
     C           TDMI      OREQ 'G'
     C           RECI      OREQ 'L'                                       S01269
     C           RECI      OREQ 'P'                                       S01269
     C           RECI      OREQ 'R'                                       S01269
     C                     EXSR RSR36
     C                     GOTO END
     C                     END
     C*
     C****PROCESS*ACCORDING*TO*CLEARANCE*TYPE*(0 - 5)******************   S01175
     C**********           SETOF                     545556               S01175
     C**********           SETOF                     575859               S01175
     C********** CLTY      COMP '1'                  565455
     C***56***** CLTY      COMP '2'                  585657
     C***58***** CLTY      COMP '3'                    5859
     C***********CLTY      COMP '1'                  565455               S01175
     C***56******CLTY      COMP '3'                  585657               S01175
     C***58******CLTY      COMP '5'                    5859               S01175
     C*****PROCESS*ACCORDING*TO*TRADE*TYPE*AND*DISCRETIONARY*INDICATOR.   S01175
     C***********TDTP      COMP 'TP'                     60               S01175
     C*****CHAIN*TO*S/CLINTSE*TO*GET*DISCRETIONARY*INDICATOR***********   S01175
     C*
     C**  FIND IF COUNTERPARTY IS MARKET CLIENT OR PORTFOLIO CLIENT       S01175
     C*                                                                   S01175
     C**********           Z-ADDTCNR      CK1                                          S01175 CSD027
     C                     MOVE TCNR      CK1                                                 CSD027
     C                     EXSR CLIENT                                    S01175
     C**********           EXSR CLINT1
     C           C1DI      COMP 'M'                      61               S01175
     C*
     C** IF CLEARANCE TYPE '0' OR SETTLEMENT TYPE '03',WRITE TO S/STPR2
     C*
     C           CLTY      IFEQ '0'                                       S01175
     C           SMTH      OREQ 3                                         S01175
     C                     EXSR RSR37                                     S01175
     C                     ELSE                                           S01175
     C***********SMTH      COMP 3                        62               S01175
     C***********                                                         E38340
     C***54******                                                         S01175
     C*R*62******          EXSR RSR37                                     S01175
     C***54******                                                         S01175
     C*R*62******          GOTO END                                       S01175
     C*****IF*CLEARANCE*TYPE*'5',*WRITE*TO*S/UNFOR*********************   S01175
     C**N51*******         GOTO ACNMB                                     S01175
     C************         EXSR RSR35                                     S01175
     C*****IF*DELIVER*TO*IS*BLANK*FOR*PURCHASE*OR*DELIVER*FROM*********   S01175
     C*****IS*BLANK*FOR*SALE*DO*NOT*O/P*RECORD*TO*S/INSTR**************   S01175
     C***********          SETOF                     6465                 S01175
     C***60******DELT      COMP 0                        64               S01175
     C**N60******DELF      COMP 0                        65               S01175
     C***64******                                                         S01175
     C*R*65******          GOTO END                                       S01175
     C*****IF*CPARTY*IS*ALSO*A*MARKET*CLIENT,*WRITE*TO*S/INSTR*********   S01175
     C*****CHAIN*TO*S/CLINTSE*TO*GET*DISC******************************   S01175
     C***********          Z-ADDTCNR      CK1                             S01175
     C***********          EXSR CLINT1                                    S01175
     C***********C1DI      COMP 'M'                      62               S01175
     C**N62******          GOTO END                                       S01175
     C***********          EXSR RSR38                                     S01175
     C***********          GOTO END                                       S01175
     C***********ACNMB     TAG                                            S01175
     C*
     C**  IF RETAIL A/C OR NOSTRO ENTERED ON PAY TO,CONVERT TO A/C NO.
     C*
     C           PAYT      COMP *BLANK               L1L1
     C   L1      PYTAC     COMP *BLANK                   L1
     C   L1      PYTOCK    COMP *BLANK               L1L1
     C   L1      PYTCPN    COMP *BLANK               L1L1                 E80816
     C   L1                MOVE PYT10     ACNO
     C   L1      ACNO      CHAINACNUM                99
     C   L1N99   RECI      COMP 'D'                  9999
     C  N99                GOTO ACNMT
     C*
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'ACNUM'   DBFILE
     C                     MOVELPYT10     DBKEY            ***************
     C                     Z-ADD05        DBASE            * DB ERROR 05 *
     C                     EXSR *PSSR                      ***************S01117
     C                     OUT  LDA                                       S01117
     C                     GOTO END
     C*
     C           ACNMT     TAG                             ** ACNMT TAG **
     C*
     C***L1*****           MOVELACNO      L1SAVE 12                                           CGL029
     C   L1                MOVELACNO      L1SAVE 18                                           CGL029
     C***L1*****           MOVELACCKEY    PAYT                                                248637
     C           *INL1     IFEQ '1'                                                           248637
     C           *IN89     IFEQ '1'                                                           248637
     C           *IN99     OREQ '0'                                                           248637
     C                     MOVE *BLANKS   PAYT                                                248637
     C                     MOVELACNO      PAYT                                                248637
     C                     ELSE                                                               248637
     C                     MOVELACCKEY    PAYT                                                248637
     C                     ENDIF                                                              248637
     C                     ENDIF                                                              248637
     C*
     C** IF RETAIL A/C OR NOSTRO ENTERED ON PAY FROM,CONVERT TO A/C NO.
     C*
     C           PYFM      COMP *BLANK               L2L2
     C   L2      PYFAC     COMP *BLANK                   L2
     C   L2      PYFRCK    COMP *BLANK               L2L2
     C   L2      PYFCPN    COMP *BLANK               L2L2                 E80816
     C   L2                MOVE PYF10     ACNO
     C   L2      ACNO      CHAINACNUM                99
     C   L2N99   RECI      COMP 'D'                  9999
     C  N99                GOTO ACNMF
     C*
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'ACNUM'   DBFILE
     C                     MOVELPYF10     DBKEY            ***************
     C                     Z-ADD06        DBASE            * DB ERROR 06 *
     C                     EXSR *PSSR                      ***************S01117
     C                     OUT  LDA                                       S01117
     C                     GOTO END
     C*
     C           ACNMF     TAG                             ** ACNMF TAG **
     C*
     C***L2*****           MOVELACNO      L2SAVE 10                                           CGL029
     C   L2                MOVELACNO      L2SAVE 16                                           CGL029
     C***L2*****           MOVELACCKEY    PYFM                                                248637
     C           *INL2     IFEQ '1'                                                           248637
     C           *IN89     IFEQ '1'                                                           248637
     C           *IN99     OREQ '0'                                                           248637
     C                     MOVE *BLANKS   PYFM                                                248637
     C                     MOVELACNO      PYFM                                                248637
     C                     ELSE                                                               248637
     C                     MOVELACCKEY    PYFM                                                248637
     C                     ENDIF                                                              248637
     C                     ENDIF                                                              248637
     C*
     C*  IF NOSTRO ENTERED ON PAY TO, CONVERT TO A/C NO
     C*
     C   L1                GOTO ENDPT
     C*
     C           PAYT      COMP *BLANK               L1L1
     C   L1      PYTL10    COMP *BLANK                   L1
     C   L1                MOVELPYNOST    NOSNOS
     C   L1                EXSR NOSCHN
     C   L1 U8             GOTO END
     C   L1                MOVELPAYT      L1SAVE
     C***L1*****           MOVE ACCKEY    WRK006  6                                           CGL029
     C   L1                MOVE ACCKEY    WRK006 12                                           CGL029
     C   L1                MOVELCNUM      PAYT
     C   L1                MOVE WRK006    PAYT
     C*
     C           ENDPT     TAG                             *** ENDPT ***
     C*
     C*  IF NOSTRO ENTERED ON PAY FROM, CONVERT TO A/C NO
     C*
     C   L2                GOTO ENDPF
     C*
     C           PYFM      COMP *BLANK               L2L2
     C   L2      PYFL10    COMP *BLANK                   L2
     C   L2                MOVELPYNOSF    NOSNOS
     C   L2                EXSR NOSCHN
     C   L2 U8             GOTO END
     C   L2                MOVELPYFM      L2SAVE
     C   L2                MOVE ACCKEY    WRK006
     C   L2                MOVELCNUM      PYFM
     C   L2                MOVE WRK006    PYFM
     C*
     C           ENDPF     TAG                             *** ENDPF ***
     C*
     C*  GET SETTLEMENT CURRENCY NO. OF DECIMAL PLACES
     C*
     C                     MOVE SETC      ARGMNT  3
     C                     EXSR CCYCHK
     C   U8                GOTO END
     C                     SETOF                     434445
     C                     SETOF                     46
     C           CDP       COMP 1                    454344
     C   45      CDP       COMP 3                      4546
     C*
     C*  GET NOMINAL CURRENCY NO. OF DECIMAL PLACES                       S01190
     C*                                                                   S01190
     C                     MOVE TNMC      ARGMNT  3                       S01190
     C                     EXSR NOCCHK                                    S01190
     C   U8                GOTO END                                       S01190
     C**                                                                  S01190
     C*  SET PAY CODE INDICATOR
     C*
     C***********PCOD      COMP '3'                  8080                 E18208
     C           PCOD      IFEQ '2'                                       E18208
     C           PCOD      OREQ '3'                                       E18208
     C           PCOD      OREQ '4'                                       E18208
     C                     SETOF                     80                   E18208
     C                     ELSE                                           E18208
     C                     SETON                     80                   E18208
     C                     END                                            E18208
      *                                                                                       162270
     C***********BCY001    IFEQ 'Y'                                                   162270 162270A
     C           CSE099    IFEQ 'Y'                                                          162270A
     C**********           MOVELPYFM      WPYFM   60                                   162270 CPK027
     C                     MOVELPYFM      WPYFM   6                                           CPK027
     C           TDTP      IFEQ 'TP'                                                          162270
     C           WPYFM     ANDNEDELT                                                          162270
     C           PCOD      ANDEQ'1'                                                           162270
     C           CLTY      IFEQ '3'                                                           162270
     C           CLTY      OREQ '4'                                                           162270
     C                     SETOF                     80                                       162270
     C                     END                                                                162270
     C                     END                                                                162270
     C                     ENDIF                                                              162270
      *                                                                                       162270
     C/COPY WNCPYSRC,SE0420C002
     C*
     C*   GET CLEARING HOUSE DETAILS FOR ALL PARTIES IN SETTLEMENT
     C*
     C                     MOVE DELF      INPUT   6
     C           INPUT     IFEQ '000000'                                  E41705
     C           INPUT     OREQ *BLANKS                                   101997
     C                     MOVE TCNR      INPUT                           E41705
     C                     END                                            E41705
     C*                                                                   E40869
     C***If*deliver*from*(DELF)*is*blank,*switch*on                E40869 E41705
     C***indicator*55*to*prevent*a*database*error**                E40869 E41705
     C**********                                                   E40869 E41705
     C**********           SETON                     55            E40869 E41705
     C*                                                                   E40869
     C                     EXSR HOUSE
     C*                                                                   E40869
     C**********           SETOF                     55            E40869 E41705
     C*                                                                   E40869
     C**********           MOVE OUTPUT    DLFRAT  1                       S01175
     C                     Z-ADDOUTPUT    DLFRAT  10                      S01175
     C*
     C                     MOVE DELT      INPUT
     C           INPUT     IFEQ '000000'                                  E41705
     C           INPUT     OREQ *BLANKS                                   101997
     C                     MOVE TCNR      INPUT                           E41705
     C                     END                                            E41705
     C*                                                                   E40869
     C***If*deliver*to*(DELT)*is*blank,*switch*on**                E40869 E41705
     C***indicator*55*to*prevent*a*database*error**                E40869 E41705
     C**********                                                   E40869 E41705
     C**********           SETON                     55            E40869 E41705
     C*                                                                   E40869
     C                     EXSR HOUSE
     C*                                                                   E40869
     C**********           SETOF                     55            E40869 E41705
     C*                                                                   E40869
     C**********           MOVE OUTPUT    DLTOAT  1                       S01175
     C                     Z-ADDOUTPUT    DLTOAT  10                      S01175
     C*                                                                   S01175
     C*  IF 'DELIVER TO' ON PURCHASE IS NOT                               S01175
     C*  A EUROCLEAR OR CEDEL DEPOT OUTPUT TO LF/UNFOR                    S01175
     C*                                                                   S01175
     C           TDTP      IFEQ 'TP'                                      S01175
     C           DLTOAT    ANDGE3                                         S01175
     C                     EXSR RSR35                                     S01175
     C*                                                                   S01175
     C*  IF 'FOR A/C OF - DELIVER TO' / COUNTERPARTY IS A MARKET CLIENT   S01175
     C***OUTPUT*TO*LF/INSTR**************************************   S01175S01176
     C*  OUTPUT TO LF/OTHST                                               S01176
     C*                                                                   S01175
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C           C1DI      IFEQ 'M'                                       S01175
     C           *IN99     ANDEQ'0'                                       S01175
     C                     EXSR RSR38                                     S01175
     C                     END                                            S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '1'                                       S01175
     C                     EXSR RSR38                                     S01175
     C                     END                                            S01175
     C                     END                                            S01175
     C                     GOTO END                                       S01170
     C                     END                                            S01175
     C*                                                                   S01175
     C*  IF 'DELIVER FROM' ON SALE IS NOT                                 S01175
     C*  A EUROCLEAR OR CEDEL DEPOT OUTPUT TO LF/UNFOR                    S01175
     C*                                                                   S01175
     C           TDTP      IFEQ 'TS'                                      S01175
     C           DLFRAT    ANDGE3                                         S01175
     C                     EXSR RSR35                                     S01175
     C*                                                                   S01175
     C*  IF 'FOR A/C OF - DELIVER FROM' / COUNTERPARTY IS A MARKET        S01175
     C***CLIENT*OUTPUT*TO*LF/INSTR*******************************   S01175S01176
     C*  CLIENT OUTPUT TO LF/OTHST                                        S01176
     C*                                                                   S01175
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C           C1DI      IFEQ 'M'                                       S01175
     C           *IN99     ANDEQ'0'                                       S01175
     C                     EXSR RSR38                                     S01175
     C                     END                                            S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '1'                                       S01175
     C                     EXSR RSR38                                     S01175
     C                     END                                            S01175
     C                     END                                            S01175
     C                     GOTO END                                       S01170
     C                     END                                            S01175
     C*
     C*  FIND CLEARING HOUSE DETAILS FOR PAY TO AND PAY FROM IF TRADE I   S01175
     C*  FREE OF PAYMENT                                                  S01175
     C*                                                                   S01175
     C           *IN80     IFEQ '0'                                       S01175
     C                     SETON                     55                   S01175
     C                     MOVELPAYT      INPUT
     C           INPUT     IFEQ '000000'                                  092649
     C           INPUT     OREQ *BLANKS                                   101997
     C                     MOVE TCNR      INPUT                           092649
     C                     END                                            092649
     C                     EXSR HOUSE
     C************         MOVE OUTPUT    PYTOAT  1                       S01175
     C                     Z-ADDOUTPUT    PYTOAT  10                      S01175
     C*
     C                     MOVELPYFM      INPUT                           S01175
     C           INPUT     IFEQ '000000'                                  092649
     C           INPUT     OREQ *BLANKS                                   101997
     C                     MOVE TCNR      INPUT                           092649
     C                     END                                            092649
     C                     EXSR HOUSE
     C***********          MOVE OUTPUT    PYFRAT  1                       S01175
     C                     Z-ADDOUTPUT    PYFRAT  10                      S01175
     C                     SETOF                     55                   S01175
     C                     END                                            S01175
     C*
     C****SET*UP*REQUESTED*FORMAT*INDICATORS***************************   S01175
     C***********                                                         E38340
     C***********          EXSR REQUT                                     S01175
     C*
     C**  SPLIT CONTROLLING PROCESSING BY TYPE
     C*
     C           *IN61     IFEQ '0'                                       S01175
     C           DELF      ANDEQDELT                                      S01175
     C                     GOTO END                                       S01175
     C                     END                                            S01175
      *                                                                   E38340
      ***  The following conditioning was confusing, so rewritten to      E38340
      ***  say the same thing, but more clearly.                          E38340
      *                                                                   E38340
     C***********PCOD      IFEQ '1'                                       E38340
     C***********PCOD      OREQ '5'                                S01129 E38340
     C***80******          EXSR AGST                                      E38340
     C***********          END                                            E38340
     C**N80******          EXSR FREE                                      E38340
     C***********          END                                     S01175 E38340
      *                                                                   E38340
      *                                                                                       162270
     C***********BCY001    IFEQ 'Y'                                                   162270 162270A
     C           CSE099    IFEQ 'Y'                                                          162270A
     C                     MOVELPYFM      WPYFM                                               162270
     C           TDTP      IFEQ 'TP'                                                          162270
     C           WPYFM     ANDNEDELT                                                          162270
     C           PCOD      ANDEQ'1'                                                           162270
     C           CLTY      IFEQ '3'                                                           162270
     C           CLTY      OREQ '4'                                                           162270
     C                     EXSR FREE                                                          162270
     C                     END                                                                162270
     C                     ELSE                                                               162270
      *                                                                                       162270
     C/COPY WNCPYSRC,SE0420C003
     C           PCOD      IFEQ '1'                                       E38340
     C           PCOD      OREQ '5'                                       E38340
     C                     EXSR AGST                                      E38340
     C                     END                                            E38340
     C                     ENDIF                                                              162270
      *                                                                                       162270
     C                     ELSE                                                               162270
     C           PCOD      IFEQ '1'                                                           162270
     C           PCOD      OREQ '5'                                                           162270
     C                     EXSR AGST                                                          162270
     C                     END                                                                162270
     C                     ENDIF                                                              162270
      *                                                                                       162270
     C/COPY WNCPYSRC,SE0420C004
      *                                                                   E38340
     C           PCOD      IFEQ '2'                                       E38340
     C           PCOD      OREQ '3'                                       E38340
     C           PCOD      OREQ '4'                                       E38340
     C                     EXSR FREE                                      E38340
     C                     END                                            E38340
      *                                                                   E38340
      ***  END of IF/ELSE CLTY = '0' OR SMTH = 3                          E38340
     C                     END                                            E38340
     C*
     C           END       TAG                             **   END   **
     C*                                                                   S01271
     C*   Write ATPRP record - only needed during input cycle for         S01271
     C*                               insert SETLX records.               S01271
     C*                                                                   S01271
     C           RECI      IFNE 'L'                                       E32028
     C           RECI      ANDNE'P'                                       E32028
     C           RECI      ANDNE'R'                                       E32028
     C*                                                                   E32028
     C           PRPHAS    IFEQ 'I'                                       S01271
     C           *INU7     ANDEQ'0'                                       S01271
     C           ACTO      ANDEQ'I'                                       S01271
     C                     MOVEASTAMP,1   TMST             Default Timestamp                  CPK015
     C                     WRITEATPRPDF                                   S01271
     C                     END                                            S01271
     C                     END                                            E32028
     C*
     C**  LAST RECORD PROCESSING
     C*
     CLR   N40             EXSR FIRST
     CLRNU7NU8             EXSR LAST
     C*                                                                   S01176
     C**  UPDATE OTHER SETTLEMENTS AUDIT                                  S01176
     CLR         1         CHAINOTHSTAF              99                   S01176
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         *IN99     IFEQ '1'                        ***************S01176
     CLR                   Z-ADD16        DBASE            * DB ERROR 16 *S01176
     CLR                   MOVEL'OTHST'   DBFILE           ***************S01176
     CLR                   MOVEL'AUDIT'   DBKEY                           S01176
     CLR                   OUT  LDA                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   SETON                     U7U8                 S01176
     CLR                   ELSE                                           S01176
     CLR                   ADD  COTHST    NORE                            S01176
     CLR                   UPDATOTHSTAF                                   S01176
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
     CLR                   END                                            S01176
      *================================================================
      /EJECT
     C*****************************************************************   S01175
     C*                                                               *   S01175
     C*  SUBROUTINE REPLACED BELOW BY SR/CLIENT  -  S01175 (01JUL88)  *   S01175
     C*                                                               *   S01175
     C******CLINT1*S/R*-*TO*CHAIN*FOR*A*CLINT*'1'*RECORD***************   S01175
     C***********                                                     *   S01175
     C***************CALLED*FROM:***EVERYWHERE*************************   S01175
     C***********                                                     *   S01175
     C***********CLINT1    BEGSR                           *** CLINT1 *** S01175
     C***********EXITC1    ENDSR                           ** EXITC1 **   S01175
     C*****************************************************************   S01175
      /EJECT                                                              S01175
     C*****************************************************************   S01175
     C*                                                               *   S01175
     C*  CLIENT  - S/R TO CHAIN FOR A CLINT '1' RECORD                *   S01175
     C*                                                               *   S01175
     C*  CALLED FROM: MAIN & HOUSE                                    *   S01175
     C*                                                               *   E38340
     C*  CALLS:   None.                                               *   E38340
     C*                                                               *   S01175
     C*****************************************************************   S01175
     C*                                                                   S01175
     C           CLIENT    BEGSR                           *** CLIENT *** S01175
     C*                                                                   S01175
     C                     MOVE '1'       CK2                             S01175
     C           CLNTKY    CHAINCLINT                99                   S01175
     C  N99      RECI      COMP 'D'                  9999                 S01175
     C           *IN99     IFEQ '1'                                       S01175
     C           NODEBE    ANDNE'Y'                                       E15014
     C           *IN55     ANDNE'1'                                       221297
     C                     SETON                     U7U8LR               S01175
     C***********          MOVE 'CLINT'   DBFILE     ***************S01175E20651
     C***********          MOVE CK1       DBKEY      **DB*ERROR*9***S01175E20651
     C***********          Z-ADD9         DBASE      ***************S01175E20651
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'CLINT'   DBFILE           ***************E20651
     C                     MOVE CK1       DBKEY            * DB ERROR 18 *E20651
     C                     Z-ADD18        DBASE            ***************E20651
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01175
     C*                                                                   S01175
     C                     ENDSR                                          S01175
     C*                                                                   S01175
     C*****************************************************************   S01175
      /EJECT
     C*****************************************************************
     C*
     C*  CLINTB  - S/R TO CHAIN FOR A CLINT 'B' RECORD
     C*                                                               *   E38340
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           CLINTB    BEGSR                           *** CLINTB ***
     C*
     C                     MOVE 'A'       CK2
     C*
     C           CLNTKY    CHAINCLINT                99
     C  N99      RECI      COMP 'D'                  9999
     C*
     C  N99                GOTO EXITCB
     C*                                                                   E19949
     C                     MOVE *BLANKS   KEY12  12                       E19949
     C                     MOVEL'71'      KEY12                           E19949
     C                     MOVE WFLD8     KEY12                           E19949
     C           KEY12     CHAINTABLET2F             99                   E19949
     C  N99      RECI      COMP 'D'                  9999                 E19949
     C  N99                MOVELWFLD8     CRNM                            E19949
     C  N99                MOVE *BLANKS   WFLD8                           E19949
     C*                                                                   E19949
     C  N99                GOTO EXITCB                                    E19949
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'CLINT'   DBFILE
     C                     MOVELCLNTDS    DBKEY            ***************
     C                     Z-ADD07        DBASE            * DB ERROR 07 *
     C*                                                    ***************
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C           EXITCB    ENDSR                           ** EXITCB **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR35  - S/R TO PERFORM SETUP AND OUTPUT OF A RECORD TO
     C*               S/UNFOR
     C*
     C***CALLS:**CLINT1************************************************   E38340
     C*  CALLS:  CLIENT                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR35     BEGSR                           *** RSR35 ***
     C*
     C** OURS/THEIRS FROM PAY TO/FROM (OR SAVED FIELDS IF RETAIL A/CS)
     C*
     C                     SETOF                     66
     C***60******          SETON                     66                   S01175
     C           TDTP      IFEQ 'TP'                                      S01175
     C                     SETON                     66                   S01175
     C                     END                                            S01175
     C   66NL1             MOVELPAYT      THEIRS
     C   66 L1             MOVELL1SAVE    THEIRS
     C   66NL2             MOVELPYFM      OURS
     C   66 L2             MOVELL2SAVE    OURS
     C***66*****           MOVE TDFA      FACO                            S01170
     C   66                MOVELTDFA      FACO                            S01170
     C   66                MOVE TDSI      SPI
     C*
     C   66                GOTO R35T1
     C*
     C     NL1             MOVELPAYT      OURS
     C      L1             MOVELL1SAVE    OURS
     C     NL2             MOVELPYFM      THEIRS
     C      L2             MOVELL2SAVE    THEIRS
     C                     MOVE *BLANKS   FACO
     C                     MOVE *BLANKS   SPI
     C           R35T1     TAG                             ** R35T1 **
     C*
     C**  CHAIN TO S/CLINTSE TO GET DISC
     C**********           Z-ADDTCNR      CK1                                                 CSD027
     C                     MOVE TCNR      CK1                                                 CSD027
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C*
     C**  MOVE DATA TO OUTPUT FIELDS
     C*
     C                     MOVE TDRF      TRDR
     C                     MOVE TDSS      SECS
     C***********          Z-ADDBCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C                     MOVE ACTO      ACTC
     C                     Z-ADDSMTH      SETL
     C**********           Z-ADDTCNR      CLNT                                                CSD027
     C                     MOVE TCNR      CLNT                                                CSD027
     C                     MOVE C1DI      DISC
     C                     MOVE TDTP      TRTP
     C**********           Z-ADDVDAT      ZDAYNO                    S01129S01186
     C                     Z-ADDTDVD      VDAT
     C                     MOVE SETC      VCCY
     C                     MOVE PCOD      PYCD
     C*
     C                     ADD  1         CUNFOR  50
     C*
     C                     SETON                     19
     C                     MOVE 'D'       RECI
     C                     EXCPT
     C                     SETOF                     19
     C*
     C           EXTR35    ENDSR                           ** EXTR35 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  CHNSEC  - S/R TO CHAIN FOR A S/SECTY RECORD
     C*                                                               *   E38340
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           CHNSEC    BEGSR                           *** CHNSEC ***
     C*
     C           TDSS      CHAINSECTY                99
     C  N99      RECI      COMP '*'                      99
     C  N99                GOTO EXITSC
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'SECTY'   DBFILE
     C                     MOVELTDSS      DBKEY            ***************
     C                     Z-ADD08        DBASE            * DB ERROR 08 *
     C*                                                    ***************
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C           EXITSC    ENDSR                           ** EXITSC **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  SECREF - SR TO DETERMINE SECURITY REFERENCE AT A GIVEN
     C*           DEPOT (IF HELD ON SECTYD)
     C*
     C*           INPUT - DPTIN    OUTPUT - DPTOUT
     C*                                                               *   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           SECREF    BEGSR
     C*
     C***********          MOVE DPTIN     DPTIN   60                      S01175
     C***********          MOVE *BLANKS   DPTOUT  9                       S01175
     C*                                                                   E15014
     C**  DO NOT REPORT A DB ERROR IN SUBROUTINE CLIENT                   E15014
     C                     MOVEL'Y'       NODEBE  1                       E15014
     C*                                                                   E15014
     C                     Z-ADD0         DPTOUT  10                      S01175
     C           INVTKY    CHAININVTP                99
     C           *IN99     IFEQ '0'
     C*                                                                   E14515
     C********** SDC1      IFNE *ZEROS                                                 E14515 CSD027
     C           SDC1      IFNE *BLANKS                                                       CSD027
     C           SDC1      ANDNE'000000'                                                    BUG11613
     C                     MOVE SDC1      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C           C1DI      IFEQ DPTIN                                     S01175
     C           *IN99     ANDEQ'0'                                       S01175
     C                     MOVE 1         DPTOUT                          S01175
     C***********          ELSE                                   S01175  E14515
     C                     END                                            E14515
     C                     END                                            E14515
     C*                                                                   E14515
     C********** SDC2      IFNE *ZEROS                                                 E14515 CSD027
     C           SDC2      IFNE *BLANKS                                                       CSD027
     C           SDC1      ANDNE'000000'                                                    BUG11613
     C           DPTOUT    ANDEQ0                                         E14515
     C                     MOVE SDC2      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C           C1DI      IFEQ DPTIN                                     S01175
     C           *IN99     ANDEQ'0'                                       S01175
     C                     MOVE 2         DPTOUT                          S01175
     C***********          ELSE                                   S01175  E14515
     C                     END                                            E14515
     C                     END                                            E14515
     C*                                                                   E14515
     C********** SDC3      IFNE *ZEROS                                                 E14515 CSD027
     C           SDC3      IFNE *BLANKS                                                       CSD027
     C           SDC1      ANDNE'000000'                                                    BUG11613
     C           DPTOUT    ANDEQ0                                         E14515
     C                     MOVE SDC3      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C           C1DI      IFEQ DPTIN                                     S01175
     C           *IN99     ANDEQ'0'                                       S01175
     C                     MOVE 3         DPTOUT                          S01175
     C                     END                                            S01175
     C                     END                                            S01175
     C***********          END                                    S01175  E14515
     C***********DPTIN     IFEQ SDC1                                      S01175
     C***********          MOVELD1SR      DPTOUT                          S01175
     C***********          END                                            S01175
     C***********DPTIN     IFEQ SDC2                                      S01175
     C***********          MOVELD2SR      DPTOUT                          S01175
     C***********          END                                            S01175
     C***********DPTIN     IFEQ SDC3                                      S01175
     C***********          MOVELD3SR      DPTOUT                          S01175
     C***********          END                                            S01175
     C***********          END                                     S01175 E16301
     C                     MOVEL' '       NODEBE                          E15014
     C*                                                                   E15014
     C* DB ERROR IF THE RELEVANT DEPOT HAS NOT BEEN FOUND                 E15014
     C*                                                                   E15014
     C***********DPTOUT    IFEQ 0                                  E15014 E16301
     C***********DPTIN     ANDNE'X'                                S01176 E16301
     C           *IN99     IFEQ '1'                                       E16301
     C                     SETON                     U7U8LR               E15014
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'DEPOT'   DBFILE           ***************E15014
     C                     MOVELTDRF      DBKEY            * DB ERROR 15 *E15014
     C                     Z-ADD15        DBASE            ***************E15014
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            E15014
     C                     END                                            E16301
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  HOUSE S/R - TO SET UP CLEARANCE HOUSE DETAILS FOR EACH PARTY
     C*              IN THE SETTLEMENT (NOS 1-4)                          S01175
     C*           1  -  PARTY IS DEPOT AT EUROCLEAR                       S01175
     C*           2  -  PARTY IS DEPOT AT CEDEL                           S01175
     C*           3  -  PARTY IS DEPOT AT KASSENVEREIN                    S01175
     C*           4  -  PARTY IS NOT A DEPOT AT CEDEL OR EUROCLEAR        S01175
     C*                                                               *   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*
     C*****************IN*THE*SETTLEMENT*(BITS*0-2,*4-6)***************   S01175
     C*****************************************************************   E38340
     C*****************BIT*0*-*EUROCLEAR*-*PARTY*IS*CLEARING*HOUSE*ACCOUNTS01175
     C*********************1*-*****"*****-*PARTY*IS*PARTICIPANT********   S01175
     C*********************2*-*****"*****-*PARTY*HAS*NON-ZERO*REFERENCE   S01175
     C*********************3*-*****"*****-*FORMATTED*TELEX*REQUESTED***   S01175
     C*****************************************************************   E38340
     C*****************BIT*4*-*CEDEL*-*PARTY*IS*CLEARING*HOUSE*ACCOUNT*   S01175
     C*********************5*-***"***-*PARTY*IS*PARTICIPANT***********:   S01175
     C*********************6*-***"***-*PARTY*HAS*NON-ZERO*REFERENCE****   S01175
     C*********************7*-***"***-*FORMATTED*TELEX*REQUESTED*******   S01175
     C*****************************************************************   E38340
     C*****************************************************************
     C*                                                                   S01175
     C           HOUSE     BEGSR
     C*
     C***********          BITOF'01234567'OUTPUT  1                       S01175
     C                     Z-ADD0         OUTPUT  10                      S01175
     C*
     C                     MOVELINPUT     CK1
      *                                                                   E38340
     C***********          MOVE '1'       CK2                      S01175 E38340
     C***********CLNTKY    CHAINCLINT                99            S01175 E38340
      *                                                                   E38340
     C                     EXSR CLIENT                                    E38340
     C*                                                                   S01175
     C**  IF PAY FROM / PAY TO                                            S01175
     C*                                                                   S01175
     C           *IN55     IFEQ '1'                                       S01175
     C           *IN99     ANDEQ'1'                                       S01175
     C                     SETOF                     99                   S01175
     C                     SETOF                     U7U8LR               S01175
     C                     MOVE *BLANKS   C1DI                            E14219
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C***99******          GOTO HOUS99                                    S01175
     C*
     C           C1DI      IFEQ 'E'
     C                     Z-ADD1         OUTPUT                          S01175
     C                     ELSE                                           S01175
     C           C1DI      IFEQ 'C'                                       S01175
     C                     Z-ADD2         OUTPUT                          S01175
     C                     ELSE                                           S01175
     C********** C1DI      IFEQ 'K'                                S01175 CSE022
     C**********           Z-ADD3         OUTPUT                   S01175 CSE022
     C**********           ELSE                                    S01175 CSE022
     C                     Z-ADD4         OUTPUT                          S01175
     C**********           END                                     S01175 CSE022
     C                     END                                            S01175
     C                     END                                            S01175
     C**********           END                                            S01175
     C**********           MOVELTCNR      CK1                             S01175
     C**********           EXSR CLINT1                                    S01175
     C***********PN01      IFEQ 'P'                                       S01175
     C***********          BITON '0'      OUTPUT                          S01175
     C**********           END                                            S01175
     C********** C101      IFNE ' '                                       S01175
     C***********EURO      IFGT *ZERO                                     S01175
     C***********          END                                            S01175
     C***********          ELSE                                           S01175
     C***********C1DI      IFEQ 'C'                                       S01175
     C***********          BITON'4'       OUTPUT                          S01175
     C***********          END                                            S01175
     C***********          MOVELTCNR      CK1
     C***********          EXSR CLINT1
     C***********          END                                            S01175
     C***********PN02      IFEQ 'P'                                       S01175
     C***********          BITON'5'       OUTPUT                          S01175
     C***********          END                                            S01175
     C***********C102      IFNE ' '
     C***********CEDL      IFGT *ZERO                                     S01175
     C***********          BITON'6'       OUTPUT                          S01175
     C***********          END                                            S01175
     C***********          END
     C***********          END
     C           HOUS99    ENDSR                           *** HOUS99 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR01  - S/R TO PERFORM SETUP AND OUTPUT OF A WIRE TRANSFER
     C*                   TO ECASHAB
     C*                                                               *   E38340
     C*  CALLS:   BCHCHN                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR01     BEGSR                           *** RSR01 ***
     C*
     C                     MOVE 'D'       RECI
     C                     MOVE 'W'       CSHT
     C                     MOVE SETC      ECCC
     C                     Z-ADD10        BCH10
     C                     EXSR BCHCHN
     C                     MOVELBICN      ECLN
     C   43                Z-ADDCVIV      ECAM
     C   44      CVIV      DIV  10        ECAM
     C   45      CVIV      DIV  100       ECAM
     C   46      CVIV      DIV  1000      ECAM
     C                     MOVELPYCLZT    SCNM
     C*
     C*  MOVE DATA TO OUPUT FIELDS                                     L
     C                     MOVE TDRF      TRDR
     C                     MOVE ACTO      ACTC
     C***********          MOVE BCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C                     MOVE TDSS      SECS
     C*
     C                     ADD  1         CECASH  50
     C*
     C                     SETON                         21
     C                     EXCPT
     C                     SETOF                         21
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR03  - S/R TO PERFORM SETUP AND OUTPUT OF A BOOK TRANSFER
     C*                TO ECASHAB
     C*                                                               *   E38340
     C*  CALLS:   BCHCHN                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR03     BEGSR                           *** RSR03 ***
     C*
     C                     MOVE 'D'       RECI
     C                     MOVE 'B'       CSHT
     C                     MOVE SETC      ECCC
     C                     MOVE *BLANKS   FACO
     C                     Z-ADD10        BCH10
     C                     EXSR BCHCHN
     C                     MOVELBICN      ECLN
     C   43                Z-ADDCVIV      ECAM
     C   44      CVIV      DIV  10        ECAM
     C   45      CVIV      DIV  100       ECAM
     C   46      CVIV      DIV  1000      ECAM
     C                     MOVELPYCLZT    SCNM
     C*
     C*  MOVE DATA TO OUPUT FIELDS
     C                     MOVE TDRF      TRDR
     C                     MOVE ACTO      ACTC
     C***********          MOVE BCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C                     MOVE TDSS      SECS
     C*
     C                     ADD  1         CECASH
     C*
     C                     SETON                         21
     C                     EXCPT
     C                     SETOF                         21
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR07  - S/R TO PERFORM SETUP AND OUTPUT OF A LINE 0 FOR
     C*               A EUROCLEAR '02' TO SEEUCD0
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C************ZDATE2***********************************************   E38340
     C*
     C*****************************************************************
     C*
     C           RSR07     BEGSR                           *** RSR07 ***
     C*
     C                     Z-ADD0         EULN
     C                     Z-ADD2         EUIT
     C*
     C*  USE ONLY RIGHT MOST 5 DIGITS OF TRDR FOR E/C REF.
     C                     MOVE TDRF      TEMP01  5
     C                     MOVE TEMP01    EURF
     C                     MOVE TDRF      TRDR
     C*                                                                   E38340
     C****SEVERAL*FIELDS*ARE*SET*TO*0/' '*IF*PAY*CODE*IS*3********* S01129E38340
     C***80******          GOTO R08T1                                     S01175
     C***80N50***          GOTO R08T1                               S01129S01190
     C***********          Z-ADD0         EUCU                      S01129S01190
     C***********          Z-ADD0         EUCD                      S01129S01190
     C***********          MOVE *BLANKS   EUVY                      S01129S01190
     C***********          GOTO OVER1                               S01129S01190
     C***********R08T1     TAG                                      S01129S01190
      *                                                                   E38340
     C**  PAYMENT CODE                                                    S01190
     C           PCOD      IFEQ '1'                                       S01190
     C           PCOD      OREQ '5'                                       S01190
     C                     MOVE 'P'       EUPC                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'F'       EUPC                            S01190
     C                     END                                            S01190
     C   50                MOVE ' '       EUPC                            S01190
     C*                                                                   S01129
     C****PUT*THE*COUNTERVALUE*INTO*TWO*FIELDS*WHICH*TOGETHER*FORM*A*12,2 S01190
     C***43******          Z-ADDCVI0      EUCU                      S01129S01190
     C***44******          Z-ADDCVI1      EUCU                      S01129S01190
     C***45******          Z-ADDCVI2      EUCU                      S01129S01190
     C***46******          Z-ADDCVI3      EUCU                      S01129S01190
     C***43******          Z-ADD0         EUCD                      S01129S01190
     C***44******          Z-ADDCVD1      EUCD                      S01129S01190
     C***45******          Z-ADDCVD2      EUCD                      S01129S01190
     C***46******          Z-ADDCVD3      EUCD                      S01129S01190
     C*                                                                   S01129
     C           EUPC      IFEQ 'F'                                       S01190
     C           *IN61     ANDEQ'0'                                       S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     ELSE                                           S01190
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE CVAL      EUCA                            S01190
     C                     MOVE '00'      EUCD                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVE CVA3      EUCA                            S01190
     C                     MOVE '0'       EUCD                            S01190
     C                     MOVELCVA4      EUCD                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 2                                         S01190
     C           NCDP      OREQ 3                                         S01190
     C                     MOVE CVA1      EUCA                            S01190
     C                     MOVE CVA2      EUCD                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP1                            S01190
     C                     END                                            S01190
     C           ACTO      IFEQ 'C'                                       S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     END                                            S01190
     C****USE*SWIFT*CCY*CODE*******************************************   S01175
     C***********          MOVE CCYS      EUVY                            S01175
     C*   USE SWIFT CCY CODE                                              E15436
     C                     MOVE CCYS      EUVY                            E15436
     C*                                                                   S01129
     C***********OVER1     TAG                             *** OVER S01129S01190
     C*
     C*
     C***VALUE*OF*EUPC/EUVY*DEPENDS*ON*WHETHER*PAY*CODE*IS*3*OR*NOT       S01190
     C***IF*CANCELATION*OUTPUT*'*'*                                       S01190
     C**N80****************MOVE *BLANKS   EUVY                            S01190
     C****USE*SWIFT*CURRENCY*CODE**************************************   S01175
     C***80******          MOVE CCYS      EUVY                            S01175
     C***80******          MOVE 'P'       EUPC                            S01190
     C**N80******          MOVE 'F'       EUPC                            S01190
     C***50******          MOVE ' '       EUPC                      S01175S01190
     C***********                                                         S01190
      *                                                                   E38340
     C**  CEDEL COUNTERPARTY INDICATOR                                    S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C*
     C***********ACTO      IFEQ 'C'                                 S01175S01190
     C***********          MOVE *BLANKS   EUSD                      S01175S01190
     C***********          MOVE *BLANKS   EUPR                      S01175S01190
     C***********          ELSE                                     S01175S01190
     C****FORMAT*SETTLEMENT*DATE******************                        S01190
     C***********          Z-ADDTDVD      ZDAYNO                          S01190
     C***********          EXSR ZDATE2                                    S01190
     C***********          MOVE ZDATE     EUSD                            S01190
     C***********                                                         E38340
     C***********          MOVE PRYC      EUPR                            S01190
     C***********          END                                      S01175S01190
     C*
     C**  GET E/C NUMBER OF CLIENT
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELT      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVELTCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C**********           MOVELC101      EUCPN   50               S01175 CSE022
     C**********           MOVELC101      EUCP                     S01175 CSE022
     C                     MOVELC201      EUCPN   50                      CSE022
     C                     MOVELC201      EUCP                            CSE022
     C***********          Z-ADDEURO      EUCP                            S01175
     C***********          MOVELEURO      EUCP                            S01175
     C                     MOVE *BLANKS   EUCL                            S01175
     C*
     C****IF*NOMINAL*IS*IN*JAP*YEN*VALUE*IS*DIVIDED*BY*1000************   S01175
     C***********TNMC      COMP ECJY                     83               S01175
     C***83******NOML      DIV  1000      EUNA                            S01175
     C**N83******          Z-ADDNOML      EUNA                            S01175
     C***********          Z-ADDNOML      EUNA                      S01175S01190
     C                     Z-ADDNOML      ENAM                      S01175S01190
     C*
     C**  GET E/C NUMBER OF SECURITY BEING PROCESSED
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR07
     C***********          MOVELDC01      DPTIN                           S01175
     C                     MOVE 'E'       DPTIN   1                       S01175
     C                     EXSR SECREF
     C************         MOVELDPTOUT    EUSC                            S01175
     C                     MOVE *BLANKS   EUSC                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C************         MOVELD1SR      EUSC                      S01175S01176
     C                     MOVELDASR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C************         MOVELD2SR      EUSC                      S01175S01176
     C                     MOVELDCSR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C************         MOVELD3SR      EUSC                      S01175S01176
     C                     MOVELDDSR      EUSC                            S01176
     C                     END                                            S01175
     C*
     C**  USE OUR EUROCLEAR ACCOUNT FOR EURO.
     C*
     C***********          MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC101      EURO                     S01175 CSE022
     C                     MOVELC201      EURO                            CSE022
     C                     Z-ADD2         EUIN
     C                     MOVE ACTO      ACTC
     C*
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         23
     C                     EXCPT
     C                     SETOF                         23
     C*
     C           EXTR07    ENDSR
     C*
     C*****************************************************************   S01190
      /EJECT
     C*****************************************************************
     C*
     C*  RSR08 S/R - TO PERFORM SETUP AND OUTPUT OF LINE 1 RECORD FOR
     C*                 A EUROCLEAR '02' TO ECTLXL1
     C*
     C*  CALLS:   ZDATE2
     C*           ZALIGN                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR08     BEGSR                           *** RSR08 ***
     C*
     C                     Z-ADD0         EULN
     C*
     C**  IF CANCELATION, NO LINE 1 PRODUCED                              S01175
     C*
     C   50                GOTO EXTR08                                    S01175
     C**                                                                  S01190
     C**  USE SWIFT CCY CODE                                              S01190
     C           EDP1      IFEQ *BLANKS                                   S01190
     C                     MOVE *BLANKS   EUVY                            S01190
     C                     ELSE                                           S01190
     C                     MOVE CCYS      EUVY                            S01190
     C                     END                                            S01190
     C*
     C****FORM*THE*HASH*FIGURE*AFTER*THE*FORMATTED*COUNTER*VALUE*HAS*BEEN S01190
     C*****FORMED*BUT*BEFORE*THE*COUNTERPARTY*&*SECURITRY*CODE*GET*RESET  S01190
     C***********          Z-ADD2         HASH                            S01190
     C***********          ADD  EUCPN     HASH                            S01190
     C***********          ADD  EUSC      HASH                      S01129S01190
     C***********          MOVE *BLANKS   ZFIELD                    S01175S01190
     C***********          MOVELEUSC      ZFIELD                    S01175S01190
     C***********          Z-ADD6         ZADIG                     S01175S01190
     C***********          Z-ADD*ZERO     ZADEC                     S01175S01190
     C***********          EXSR ZALIGN                              S01175S01190
     C***********          MOVE ZFIELD    WORK1   60                S01175S01190
     C***********          ADD  WORK1     HASH                      S01175S01190
     C*********************MOVELEUSC      WORK1   50                S01129S01175
     C*********************Z-ADDWORK1     HASH                      S01129S01175
     C***********          ADD  FORHSH    HASH                            S01190
     C***********          ADD  EUNA      HASH                            S01190
     C***********                                                         E38340
     C***********          Z-ADDHASHI     EUHU                            S01190
     C***********          Z-ADDHASHD     EUHD                            S01190
     C*
     C**  E/C SETTLEMENT DATE IS VALUE DATE IN DDMMYY FORMAT              S01190
     C                     Z-ADDTDVD      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     MOVE ZDATE     EUSD                            S01190
     C**                                                                  S01190
     C***********          MOVE PRYC      EUPR                            S01175
     C                     MOVE PRYC      EUPR                            S01190
     C                     MOVE *BLANKS   EUCO
     C                     MOVE *BLANKS   EUCP
     C                     MOVE *BLANKS   ECCP                            S01190
     C*                                                                   S01190
     C**FORM THE HASH FIGURE AFTER THE FORMATTED COUNTER VALUE HAS BEEN   S01190
     C** FORMED BUT BEFORE THE COUNTERPARTY & SECURITY CODE GET RESET     S01190
     C*
     C                     Z-ADD2         HASH                            S01190
     C                     ADD  EUCPN     HASH                            S01190
     C                     MOVE *BLANKS   ZFIELD                          S01190
     C                     MOVE *BLANKS   WORK2  100                      S01190
     C                     MOVEAEUSC      HARR                            S01190
     C           HARR,12   IFEQ *BLANK                                    S01190
     C                     Z-ADD1         C       20                      S01190
     C           HARR,C    DOUEQ*BLANK                                    S01190
     C           C         OREQ 10                                        S01190
     C                     ADD  1         C                               S01190
     C                     END                                            S01190
     C                     SUB  1         C                               S01190
     C                     Z-ADDC         ZADIG                           S01190
     C                     MOVELEUSC      ZFIELD                          S01190
     C                     ELSE                                           S01190
     C                     Z-ADD10        ZADIG                           S01190
     C                     MOVELEUSCI     ZFIELD                          S01190
     C                     END                                            S01190
     C                     Z-ADD*ZERO     ZADEC                           S01190
     C                     EXSR ZALIGN                                    S01190
     C           *IN99     IFEQ '0'                                       S01190
     C                     MOVE ZFIELD    WORK2                           S01190
     C                     END                                            S01190
     C                     ADD  WORK2     HASH                            S01190
     C                     ADD  FORHSH    HASH                            S01190
     C                     ADD  ENAM      HASH                            S01190
     C*                                                                   S01190
     C                     Z-ADDHASHI     EUHA                            S01190
     C                     MOVE '.'       EDP2                            S01190
     C                     Z-ADDHASHD     EUHD                            S01190
     C*                                                                   S01190
     C**  PRINCIPLE/AGENT INDICATOR                                       S01190
     C*                                                                   S01190
     C           *IN61     IFEQ '1'                                       S01190
     C                     MOVE 'AG'      ELAG                            S01190
     C           TCAP      IFEQ 0                                         S01190
     C           TCAP      OREQ 2                                         S01190
     C           TCAP      OREQ 5                                         S01190
     C                     MOVE 'P'       EUPA                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'A'       EUPA                            S01190
     C                     END                                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ELAG                            S01190
     C                     MOVE *BLANKS   EUPA                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C** REALIGNEMENT WITH MATCHING INDICATOR                             S01190
     C           *IN61     IFEQ '0'                                       S01190
     C                     MOVE 'Y'       EREM                            S01190
     C                     MOVE 'RE'      ELRE                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ELRE                            S01190
     C                     MOVE *BLANKS   EREM                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C***********          Z-ADD2         EUIT                            S01175
     C***********                                                         E38340
     C***USE*ONLY*RIGHT*MOST*5*DIGITS*OF*TRDR*FOR*E/C*REF.*************   S01175
     C***********          MOVE TDRF      TEMP01  5                       S01175
     C***********          MOVE TEMP01    EURF                            S01175
     C***********                                                         E38340
     C******USE*OUR*EUROCLEAR*ACCOUNT*FOR*EURO.************************   E38340
     C***********                                                         E38340
     C***********          Z-ADD2         EUIN                            S01190
     C***********                                                   S01175E38340
     C***********          MOVE *BLANKS   ETPN                      S01175S01190
     C***********          MOVE *ZEROS    ETPR                      S01175S01190
     C***********          MOVE *ZEROS    ETPD                      S01175S01190
     C***********          MOVE *ZEROS    ETDT                      S01175S01190
     C***********          MOVE *BLANKS   ESPI                      S01175S01190
     C***********                                                   S01175E38340
     C******SET*UP*TRADE*DETAILS*IF*TRADE*IS*AGAINST*PAYMENT*****   S01175S01190
     C***********PCOD      IFEQ '1'                                 S01175S01190
     C***********PCOD      OREQ '5'                                 S01175S01190
     C***********                                                         E38340
     C*****SET*UP*TRADE*PRICE******                                 S01129S01190
     C***********          MOVE '.'       ETPN                      S01129S01190
     C***********          Z-ADDTPDYI     ETPR                      S01129S01190
     C***********          MOVELWTPDYD    ETPD                      S01129S01190
     C***********                                                   S01129E38340
     C*****SET*UP*TRADE*DATE******                                  S01129S01190
     C***********          Z-ADDTDDT      ZDAYNO                    S01129S01190
     C***********          EXSR ZDATE2                              S01129S01190
     C***********          Z-ADDZDATE     ETDT                      S01129S01190
     C***********                                                   S01129E38340
     C*****SET*UP*SPECIAL*INSTRUCTIONS                              S01129S01190
     C***********PCOD      IFEQ '5'                                 S01129S01190
     C***********          MOVE 'G'       ESPI                      S01129S01190
     C***********          ELSE                                     S01129S01190
     C***********          MOVE 'N'       ESPI                      S01129S01190
     C***********          END                                      S01129S01190
     C***********          END                                      S01175S01190
     C*                                                                   S01129
     C                     MOVE *BLANKS   EUB1                            S01129
     C*                                                                   S01129
     C***********          MOVE TDRF      TRDR                            S01190
     C***********          MOVE ACTO      ACTC                            S01190
     C*
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         24
     C                     EXCPT
     C                     SETOF                         24
     C*
     C           EXTR08    ENDSR                           *** EXTR08 ***
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR13 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 0 FOR A
     C*              EUROCLEAR '07' TO ECTLXL0
     C*
     C*  CALLS:   CHNSEC
     C*           SECREF
     C*           CLIENT                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR13     BEGSR                           *** RSR13 ***
     C*
     C                     Z-ADD0         EULN
     C                     Z-ADD7         EUIT
     C*
     C*  USE ONLY RIGHT MOST 5 DIGITS OF TRDR FOR E/C REF.
     C                     MOVE TDRF      TEMP01
     C                     MOVE TEMP01    EURF
     C                     MOVE TDRF      TRDR
     C*
     C**  PAYMENT CODE                                                    S01190
     C           PCOD      IFEQ '1'                                       S01190
     C           PCOD      OREQ '5'                                       S01190
     C                     MOVE 'P'       EUPC                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'F'       EUPC                            S01190
     C                     END                                            S01190
     C   50                MOVE ' '       EUPC                            S01190
     C*                                                                   S01129
     C****SEVERAL*FIELDS*ARE*SET*TO*0/'*'*IF*PAY*CODE*IS*3***       S01129S01190
     C***80******          GOTO R14T1                               S01129S01190
     C***********          Z-ADD0         EUCU                      S01129S01190
     C***********          Z-ADD0         EUCD                      S01129S01190
     C***********          MOVE *BLANKS   EUVY                      S01129S01190
     C***********          GOTO OVER2                               S01129S01190
     C***********R14T1     TAG                             ** R14T1 **1129S01190
     C***********                                                   S01129E38340
     C****PUT*THE*COUNTERVALUE*INTO*TWO*FIELDS*WHICH*TOGETHER*FORM*A*12,2 S01190
     C***43******          Z-ADDCVI0      EUCU                      S01129S01190
     C***44******          Z-ADDCVI1      EUCU                      S01129S01190
     C***45******          Z-ADDCVI2      EUCU                      S01129S01190
     C***46******          Z-ADDCVI3      EUCU                      S01129S01190
     C***43******          Z-ADD0         EUCD                      S01129S01190
     C***44******          Z-ADDCVD1      EUCD                      S01129S01190
     C***45******          Z-ADDCVD2      EUCD                      S01129S01190
     C***46******          Z-ADDCVD3      EUCD                      S01129S01190
     C*                                                                   S01129
     C**  PUT THE COUNTERVALUE INTO TWO FIELDS WHICH                      S01190
     C**  TOGETHER FORM A 15,2 FIELD                                      S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           EUPC      ANDEQ'F'                                       S01190
     C           *IN61     ANDEQ'0'                                       S01190
     C           DLTOAT    ORGT 2                                         S01190
     C           EUPC      ANDEQ'F'                                       S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     ELSE                                           S01190
     C**                                                                  S01190
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE CVAL      EUCA                            S01190
     C                     MOVE '00'      EUCD                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVE CVA3      EUCA                            S01190
     C                     MOVE '0'       EUCD                            S01190
     C                     MOVELCVA4      EUCD                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 2                                         S01190
     C           NCDP      OREQ 3                                         S01190
     C                     MOVE CVA1      EUCA                            S01190
     C                     MOVE CVA2      EUCD                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP1                            S01190
     C                     END                                            S01190
     C           ACTO      IFEQ 'C'                                       S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     END                                            S01190
     C*   USE SWIFT CCY CODE                                              S01129
     C                     MOVE CCYS      EUVY                            S01129
     C           OVER2     TAG                             *** OVER2 ***  S01129
     C*
     C***VALUE*OF*EUPC*DEPENDS*ON*WHETHER*PAY*CODE*IS*3*OR*NOT*********   E38340
     C***IF*CANCELATION,*OUTPUT*' '************************************   E38340
     C***80******          MOVE 'P'       EUPC                            S01190
     C**N80******          MOVE 'F'       EUPC                            S01190
     C***50******          MOVE ' '       EUPC                      S01175S01190
     C**                                                                  S01190
     C**  CEDEL COUNTERPARTY INDICATOR                                    S01190
     C           ACTO      IFEQ 'C'                                       S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C                     MOVE 'C'       ECCP                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C***********ACTO      IFEQ 'C'                                 S01175S01190
     C***********          MOVE *BLANKS   EUSD                      S01175S01190
     C***********          MOVE *BLANKS   EUPR                      S01175S01190
     C***********          ELSE                                     S01175S01190
     C***********                                                   S01129E38340
     C****E/C*SETTLEMENT*DATE*IS*VALUE*DATE*IN*DDMMYY*FORMAT*****   S01129S01190
     C***********          Z-ADDVDAT      ZDAYNO                    S01129S01190
     C***********          Z-ADDTDVD      ZDAYNO                          S01190
     C***********          EXSR ZDATE2                              S01129S01190
     C***********          MOVE ZDATE     EUSD                      S01129S01190
     C***********                                                   S01129E38340
     C***********          MOVE ECLD      EUPR                            S01175
     C***********          MOVE PRYC      EUPR                      S01175S01190
     C***********          END                                      S01175S01190
     C***********                                                   S01129E38340
     C***USE*ONLY*RIGHT*MOST*5*DIGITS*OF*TRDR*FOR*E/C*REF.*************   S01175
     C***********          MOVE TDRF      TEMP01                          S01175
     C***********          MOVE TEMP01    EURF                            S01175
     C*
     C                     MOVE *BLANKS   EUCP
     C*                                                                   E38340
     C***1F*CANCELATION,*OUTPUT*' '************************************   S01175
     C**N17********        MOVE *BLANKS   EUCL                            S01175
     C***17********        MOVE 'C'       EUCL                            S01175
     C****IF*CLEARING*HOUSE*IS*KASSENVEREIN,*OUTPUT*K******************   S01175
     C**N50******CLRH      IFEQ 'K'                                       S01175
     C***********          MOVE 'K'       EUCL                            S01175
     C***********          END                                            S01175
     C***50******          MOVE ' '       EUCL                            S01175
     C*                                                                   S01175
     C*   GET CLEARING HOUSE INDICATOR                                    S01175
     C*
     C                     MOVE *BLANKS   EUCL                            S01175
     C           DLTOAT    IFEQ 2                                         S01175
     C                     MOVE 'C'       EUCL                            S01175
     C                     END                                            S01175
     C********** DLTOAT    IFEQ 3                                  S01175 CSE022
     C**********           MOVE 'K'       EUCL                     S01175 CSE022
     C**********           END                                     S01175 CSE022
     C   50                MOVE ' '       EUCL                            S01190
     C****IF*NOMINAL*IS*IN*JAP*YEN*VALUE*IS*DIVIDED*BY*1000************   S01175
     C***********TNMC      COMP ECJY                     83               S01175
     C***83******NOML      DIV  1000      EUNA                            S01175
     C**N83******          Z-ADDNOML      EUNA                            S01175
     C***********          Z-ADDNOML      EUNA                      S01175S01190
     C                     Z-ADDNOML      ENAM                            S01190
     C*
     C*   GET E/C NUMBER OF SECURITY BEING PROCESSED
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR13
     C***********          MOVELDC01      DPTIN                           S01175
     C                     MOVE 'E'       DPTIN   1                       S01175
     C                     EXSR SECREF
     C***********          MOVELDPTOUT    EUSC                            S01175
     C                     MOVE *BLANKS   EUSC                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C***********          MOVELD1SR      EUSC                      S01175S01176
     C                     MOVELDASR      EUSC                            S01116
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      EUSC                      S01175S01176
     C                     MOVELDCSR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      EUSC                      S01175S01176
     C                     MOVELDDSR      EUSC                            S01176
     C                     END                                            S01175
     C*                                                                   S01175
     C*  GET BENEFICIARY COUNTERPARTY (ONLY IF CANCELLATION)              S01190
     C*                                                                   S01190
     C           ACTO      IFEQ 'C'                                       S01190
     C           DTFA      IFNE *BLANKS                                   S01190
     C                     MOVELDTFA      CK1                             S01190
     C                     EXSR CLIENT                                    S01190
     C                     ELSE                                           S01190
     C           *IN61     IFEQ '0'                                       S01190
     C                     MOVELDELT      CK1                             S01190
     C                     ELSE                                           S01190
     C                     MOVELTCNR      CK1                             S01190
     C                     END                                            S01190
     C                     EXSR CLIENT                                    S01190
     C                     END                                            S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C**********           MOVELC102      EUCP                     S01190 CSE022
     C**********           MOVELC102      EUCPN   50               S01190 CSE022
     C                     MOVELC202      EUCP                            CSE022
     C                     MOVELC202      EUCPN   50                      CSE022
     C                     ELSE                                           S01190
     C**********           MOVELC101      EUCPN   50               S01190 CSE022
     C**********           MOVELC101      EUCP                     S01190 CSE022
     C                     MOVELC201      EUCPN   50                      CSE022
     C                     MOVELC201      EUCP                            CSE022
     C                     END                                            S01190
     C                     END                                            S01190
     C*
     C**  USE OUR EUROCLEAR ACCOUNT FOR EURO.
     C*
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C**********           EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC101      EURO                     S01175 CSE022
     C                     MOVELC201      EURO                            CSE022
     C***********          MOVELEURO      EUROSV  5                       S01175
     C                     Z-ADD7         EUIN
     C                     MOVE ACTO      ACTC
     C*
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         23
     C                     EXCPT
     C                     SETOF                         23
     C*
     C           EXTR13    ENDSR                           ** EXTR13 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR14 S/R - TO PERFORM SETUP AND OUTPUT OF LINE 1 RECORD FOR
     C*              A EUROCLEAR '07' TO ECTLXL1
     C*
     C***CALLS:***ZDATE2***********************************************   E38340
     C************CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           ZALIGN                                              *   E38340
     C*           ZDATE2                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR14     BEGSR                           *** RSR14 ***
     C*
     C*    IF CANCELATION, NO LINE 1 PRODUCED                             S01175
     C*
     C   50                GOTO EXTR14                                    S01175
     C*
     C                     Z-ADD0         EULN
     C*                                                                   S01190
     C**  USE SWIFT CCY CODE                                              S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           EUPC      ANDEQ'F'                                       S01190
     C           *IN61     ANDEQ'0'                                       S01190
     C                     MOVE *BLANKS   EUVY                            S01190
     C                     ELSE                                           S01190
     C                     MOVE CCYS      EUVY                            S01190
     C                     END                                            S01190
     C           EDP1      IFEQ *BLANKS                                   S01190
     C                     MOVE *BLANKS   EUVY                            S01190
     C                     ELSE                                           S01190
     C                     MOVE CCYS      EUVY                            S01190
     C                     END                                            S01190
     C*
     C****SEC.*CORR.*IS*EURO*NUMBER*FOR*DLTO***************************   S01186
     C*   SEC. CORR. IS EURO NUMBER FOR DELT
     C*
     C**  CORRESPONDENT - BLANK IF OWN ACC. TRANSFER                      S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           EUPC      ANDEQ'F'                                       S01190
     C           *IN61     ANDEQ'0'                                       S01190
     C                     MOVE *BLANKS   EUCO                            S01190
     C                     END                                            S01190
     C*
     C***********CLRH      IFNE 'C'                                       S01175
     C           EUCL      IFNE 'C'                                       S01175
     C**********           MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC101      EUCO                     S01175 CSE022
     C                     MOVELC201      EUCO                            CSE022
     C***********          EXSR CLINT1                                    S01175
     C***********          MOVELEURO      EUCO                            S01175
     C                     ELSE
     C                     MOVE *BLANKS   EUCO
     C                     END
     C*                                                                   E38340
     C****C/PARTY*IS*EURO*NUMBER*FOR*DLTO******************************   S01186
     C****C/PARTY*IS*EURO*NUMBER*FOR*DELT******************************   S01175
     C***********                                                         E38340
     C***********          MOVELDLTO      CK1                             S01186
     C***********          MOVELDELT      CK1                             S01175
     C***********          EXSR CLINT1                                    S01175
     C***********          MOVELEURO      EUCP                            S01175
     C***********          MOVELEURO      EUCPN                           S01175
     C***********                                                         E38340
     C****C/PARTY*IS*EURO*NUMBER*FOR*FACO*(UNLESS*THIS*IS*BLANK)*AND***   S01175
     C****PROVIDED*CLEARING*HOUSE*IS*BLANK*****************************   S01175
     C***********                                                         E38340
     C***********CLRH      IFEQ ' '                                       S01175
     C***********FACO      ANDNE*BLANK                                    S01175
     C***********          MOVELFACO      CK1                             S01175
     C***********          EXSR CLINT1                                    S01175
     C*                                                                   S01175
     C*  GET BENEFICIARY COUNTERPARTY                                     S01175
     C*                                                                   S01175
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELT      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVELTCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C           DLTOAT    IFEQ 2                                         S01190
     C**********           MOVELC102      EUCP                     S01190 CSE022
     C**********           MOVELC102      EUCPN   50               S01190 CSE022
     C                     MOVELC202      EUCP                            CSE022
     C                     MOVELC202      EUCPN   50                      CSE022
     C                     ELSE                                           S01190
     C**********           MOVELC101      EUCPN   50               S01175 CSE022
     C**********           MOVELC101      EUCP                     S01175 CSE022
     C                     MOVELC201      EUCPN   50                      CSE022
     C                     MOVELC201      EUCP                            CSE022
     C***********          MOVELEURO      EUCP                            S01175
     C***********          MOVELEURO      EUCPN                           S01175
     C***********          END                                            S01175
     C                     END                                            S01190
     C*                                                                   S01190
     C           *IN61     IFEQ '1'                                       S01190
     C           DLTOAT    IFGT 2                                         S01190
     C                     MOVE EUCP      EUCO                            S01190
     C                     Z-ADD7         EUIT
     C                     END                                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C*   FORM THE HASH FIGURE AFTER THE FORMATTED COUNTER VALUE HAS BEEN S01190
     C*    FORMED BUT BEFORE THE COUNTERPARTY & SECURITY CODE GET RESET
     C                     Z-ADD7         HASH
     C                     ADD  EUCPN     HASH
     C                     MOVE *BLANKS   ZFIELD                          S01190
     C                     MOVE *BLANKS   WORK2  100                      S01190
     C**********           ADD  EUSC      HASH                            S01129
     C**********           MOVE *BLANKS   ZFIELD                    S01175S01190
     C**********           MOVELEUSC      ZFIELD                    S01175S01190
     C**********           Z-ADD6         ZADIG                     S01175S01190
     C**********           Z-ADD*ZERO     ZADEC                     S01175S01190
     C**********           EXSR ZALIGN                              S01175S01190
     C*********************MOVELEUSC      WORK1   50                S01129S01175
     C*********************Z-ADDWORK1     HASH                      S01129S01175
     C**********           MOVE ZFIELD    WORK1                     S01175S01190
     C**********           ADD  WORK1     HASH                      S01175S01190
     C                     MOVEAEUSC      HARR                            S01190
     C           HARR,12   IFEQ *BLANK                                    S01190
     C                     Z-ADD1         C       20                      S01190
     C           HARR,C    DOUEQ*BLANK                                    S01190
     C           C         OREQ 10                                        S01190
     C                     ADD  1         C                               S01190
     C                     END                                            S01190
     C                     SUB  1         C                               S01190
     C                     Z-ADDC         ZADIG                           S01190
     C                     MOVELEUSC      ZFIELD                          S01190
     C                     ELSE                                           S01190
     C                     Z-ADD10        ZADIG                           S01190
     C                     MOVELEUSCI     ZFIELD                          S01190
     C                     END                                            S01190
     C                     Z-ADD*ZERO     ZADEC                           S01190
     C                     EXSR ZALIGN                                    S01190
     C           *IN99     IFEQ '0'                                       S01190
     C                     MOVE ZFIELD    WORK2                           S01190
     C                     END                                            S01190
     C                     ADD  WORK2     HASH                            S01190
     C                     ADD  FORHSH    HASH
     C*********************ADD  NOMI      HASH                            S01175
     C***********          ADD  EUNA      HASH                            S01190
     C                     ADD  ENAM      HASH                            S01190
     C*                                                                   S01190
     C**********           Z-ADDHASHI     EUHU                            S01190
     C                     Z-ADDHASHI     EUHA                            S01190
     C                     MOVE '.'       EDP2                            S01190
     C                     Z-ADDHASHD     EUHD
     C*                                                                   S01190
     C**  PRINCIPLE/AGENT INDICATOR                                       S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           *IN61     ANDEQ'1'                                       S01190
     C                     MOVE 'AG'      ELAG                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ELAG                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           EUPC      IFEQ 'F'                                       S01190
     C           *IN61     ANDEQ'0'                                       S01190
     C                     MOVE *BLANKS   EUPA                            S01190
     C                     ELSE                                           S01190
     C           TCAP      IFEQ 0                                         S01190
     C           TCAP      OREQ 2                                         S01190
     C           TCAP      OREQ 5                                         S01190
     C                     MOVE 'P'       EUPA                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'A'       EUPA                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   EUPA                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C** REALIGNEMENT WITH MATCHING INDICATOR                             S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           EUPC      ANDEQ'F'                                       S01190
     C           *IN61     ANDEQ'0'                                       S01190
     C                     MOVE 'RE'      ELRE                            S01190
     C                     MOVE 'N'       EREM                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ELRE                            S01190
     C                     MOVE *BLANKS   EREM                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C**  E/C SETTLEMENT DATE IS VALUE DATE IN DDMMYY FORMAT              S01190
     C                     Z-ADDTDVD      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     MOVE ZDATE     EUSD                            S01190
     C**  PRIORITY CODE
     C                     MOVE PRYC      EUPR                            S01190
     C*                                                                   S01190
     C**  CEDEL COUNTERPARTY IND.                                         S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C                     MOVE 'C'       ECCP                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C                     END                                            S01190
     C*
     C***********          MOVE TDRF      TRDR                            S01190
     C***********          MOVE ACTO      ACTC                            S01190
     C*
     C******USE*OUR*EUROCLEAR*ACCOUNT*FOR*EURO.************************   E38340
     C***********                                                         E38340
     C***********          MOVE EUROSV    EURO                            S01175
     C***********          Z-ADD7         EUIN                            S01190
     C***********                                                   S01175E38340
     C***********          MOVE *BLANKS   ETPN                      S01175S01190
     C***********          MOVE *ZEROS    ETPR                      S01175S01190
     C***********          MOVE *ZEROS    ETPD                      S01175S01190
     C***********          MOVE *ZEROS    ETDT                      S01175S01190
     C***********          MOVE *BLANKS   ESPI                      S01175S01190
     C***********                                                   S01175E38340
     C*****SET*UP*TRADE*DETAILS*IF*ACROSS*BRIDGE******************* S01175S01190
     C********** EUCL      IFEQ 'C'                                 S01175S01190
     C*****SET*UP*TRADE*PRICE************************************** S01129S01190
     C**********           MOVE '.'       ETPN                      S01129S01190
     C**********           Z-ADDWTPDYI    ETPR                      S01129S01190
     C**********           MOVELWTPDYD    ETPD                      S01129S01190
     C***********                                                   S01129E38340
     C*****SET*UP*TRADE*DATE*************************************** S01129S01190
     C**********           Z-ADDTDDT      ZDAYNO                    S01129S01190
     C**********           EXSR ZDATE2                              S01129S01190
     C**********           Z-ADDZDATE     ETDT                      S01129S01190
     C**********                                                    S01129S01190
     C*****SET*UP*SPECIAL*INSTRUCTIONS***************************** S01129S01190
     C********** PCOD      IFEQ '5'                                 S01129S01190
     C**********           MOVE 'G'       ESPI                      S01129S01190
     C**********           ELSE                                     S01129S01190
     C**********           MOVE 'N'       ESPI                      S01129S01190
     C**********           END                                      S01129S01190
     C**********           END                                      S01175S01190
     C***********                                                   S01129E38340
     C***********          MOVE *BLANKS   EUB1                      S01129S01190
     C*
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         24
     C                     EXCPT
     C                     SETOF                         24
     C*
     C           EXTR14    ENDSR                           ** EXTR14 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *   E38340
     C*  Subroutine made redundant in March 1989.                     *   E38340
     C*                                                               *   E38340
     C*****RSR15*S/R*-*TO*PERFORM*SETUP*AND*OUTPUT*OF*A*LINE 2 RECORD FOR S01190
     C*****************A*EUROCLEAR*'07'*TO*ECTLXL2*********************   S01190
     C*                                                               *
     C*****************************************************************
     C***********                                                         E38340
     C***********RSR15     BEGSR                           *** RSR15 ***  S01190
     C***********EXTR15    ENDSR                           ** EXTR15 **   S01190
     C***********                                                         E38340
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR29 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 81 & 82
     C*              (Stock Telex) Executed for Trade Sale or when    *   E38340
     C*              the Counterparty is a Portfolio Customer.        *   E38340
     C*              When 'Deliver From' is Cedel AND                 *   E38340
     C*              'Deliver To' is NOT Cedel or Euroclear.          *   E38340
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*           ZDATE2
     C*           CLINTB
     C*           ZSDESC
     C*
     C*****************************************************************
     C*
     C           RSR29     BEGSR                           *** RSR29 ***
     C*
     C                     MOVE '81'      CTCD
     C                     Z-ADD81        CEIN
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C** LOOK AT FUNGIBILITY INDICATOR FOR C/PARTY
     C*
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELT      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVELTCNR      CK1                             S01175
     C                     END                                            S01175
     C**********           MOVELDLTO      CK1                             S01186
     C**********           MOVELDELT      CK1                             S01175
     C**********           EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C           C1CF      COMP 'F'                      85
     C*
     C         85          Z-ADD0         FUCD
     C        N85          Z-ADD1         FUCD
     C*
     C**N17******          MOVELCEDL      CANB                            S01175
     C***17******          MOVELEURO      CANB                            S01175
     C           DLTOAT    IFEQ 3                                         S01175
     C***********          MOVE C102      CANB                     S01175 E16475
     C**********           MOVELC102      CANB                     E16475 CSE022
     C                     MOVELC202      CANB                            CSE022
     C                     ELSE                                           S01175
     C                     MOVE *ZEROS    CANB                            S01175
     C                     END                                            S01175
     C*
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C**********           EXSR CLINT1                                    S01175
     C**********           MOVELCEDL      CANS                            S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C*
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR29
     C***********          MOVELDC02      DPTIN                           S01175
     C                     MOVE 'C'       DPTIN   1                       S01175
     C                     EXSR SECREF
     C***********          MOVELDPTOUT    CEDL                            S01175
     C           DPTOUT    IFEQ 1                                         S01175
     C                     MOVE *BLANKS   CEDL                            E14515
     C***********          MOVELD1SR      CEDL                      S01175S01176
     C                     MOVELDASR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      CEDL                      S01175S01176
     C                     MOVELDCSR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      CEDL                      S01175S01176
     C                     MOVELDDSR      CEDL                            S01176
     C                     END                                            S01175
     C*
     C           DLTOAT    IFNE 3                                         S01175
     C   80 43             Z-ADDCVIV      CDAM
     C   80 44   CVIV      DIV  10        CDAM
     C   80 45   CVIV      DIV  100       CDAM
     C   80 46   CVIV      DIV  1000      CDAM
     C  N80                Z-ADD0         CDAM
     C                     ELSE                                           S01175
     C                     MOVE *ZEROS    CDAM                            S01175
     C                     END                                            S01175
     C*
     C*    GET THE CEDEL CCY NUMBER
     C   80                Z-ADD1         U
     C   80      SETC      LOKUPCCYZ,U                   66
     C   80                Z-ADDCNAR,U    CURN
     C  N80                Z-ADD0         CURN
     C*
     C*     REFORMAT DATE
     C                     Z-ADDTDVD      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     Z-ADDNOML      NOMI
     C                     MOVE TDRF      TRDR
     C                     MOVE ACTO      ACTC
     C*
     C*   GET THE CUSTOMER REPORT NAME FROM THE CLINT,CB RECORD
     C*      FOR THE SELLER
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLINTB
     C   U8                GOTO EXTR29
     C                     MOVE CRNM      CRNS
     C*
     C*    BUILD A REPORT TITLE USING ZSDESC
     C                     MOVE SRPN      ZSRPN
     C                     MOVE RSFD      ZRSFD                           S01117
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     CSRN
     C*
     C   80                MOVE SETC      CUCD
     C   80                MOVE CAAR,U    CCCD
     C  N80                MOVE *BLANKS   CUCD
     C  N80                MOVE *BLANKS   CCCD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         38
     C                     EXCPT
     C                     SETOF                         38
     C*
     C                     MOVE '82'      CTCD
     C                     Z-ADD81        CEIN
     C                     Z-ADD0         CSQN
     C*
     C********** DLTO      COMP 0                        66               S01186
     C********** DELT      COMP 0                        66                                   CSD027
     C           DELT      COMP *BLANKS                  66                                   CSD027
     C********** DELT      COMP '000000'                 66                        BUG11613 BUG18053
     C  N66      DELT      COMP '000000'                 66                                 BUG18053
     C   66                GOTO OVER8
     C                     MOVE 'L'       CMSG
     C                     ADD  1         CSQN
     C**********           MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C                     EXSR CLINTB
     C   U8                GOTO EXTR29
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         39
     C                     EXCPT
     C                     SETOF                         39
     C*
     C           OVER8     TAG                             **  OVER8  **
     C           FACO      COMP *BLANKS                  66
     C                     MOVE 'M'       CMSG
     C                     ADD  1         CSQN
     C  N66                MOVELFACO      FACONM
     C  N66                MOVELFACONM    CK1
     C  N66                EXSR CLINTB
     C  N66 U8             GOTO EXTR29
     C  N66                MOVE NOTFOR    CWRD
     C   66                MOVE *BLANKS   CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         39
     C                     EXCPT
     C                     SETOF                         39
     C*
     C********** DLFR      COMP 0                        66               S01186
     C********** DELF      COMP 0                        66                                   CSD027
     C           DELF      COMP *BLANKS                  66                                   CSD027
     C********** DELF      COMP '000000'                 66                        BUG11613 BUG18053
     C  N66      DELF      COMP '000000'                 66                                 BUG18053
     C   66                GOTO EXTR29
     C                     MOVE 'N'       CMSG
     C                     ADD  1         CSQN
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C                     EXSR CLINTB
     C   U8                GOTO EXTR29
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         39
     C                     EXCPT
     C                     SETOF                         39
     C*
     C           EXTR29    ENDSR                           ** EXTR29 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR33 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 90
     C*
     C*  CALLS:   ZDATE2
     C*           CLIENT                                              *   E38340
     C*           CLINTB
     C*
     C*****************************************************************
     C*
     C           RSR33     BEGSR                           *** RSR33 ***
     C*
     C                     MOVE '90'      CTCD
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C                     MOVELPYCLNF    CK1
     C***********          EXSR CLINT1                                    S01175
     C***********          MOVELCEDL      CANS                            S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C*
     C   43                Z-ADDCVIV      CDAM
     C   44      CVIV      DIV  10        CDAM
     C   45      CVIV      DIV  100       CDAM
     C   46      CVIV      DIV  1000      CDAM
     C*
     C                     Z-ADD1         U
     C           SETC      LOKUPCCYZ,U                   66
     C                     Z-ADDCNAR,U    CURN
     C                     MOVELCAAR,U    CCCD
     C*
     C           TDVD      SUB  1         ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     MOVELPYCLNF    CK1
     C                     MOVELPYCLZF    WFLD8   8                       E19949
     C                     EXSR CLINTB
     C   U8                GOTO EXTR33
     C                     MOVE CRNM      RISS
     C                     MOVE SETC      CUCD
     C                     MOVE ACTO      ACTC
     C*
     C                     ADD  1         CCEDCS  50
     C*
     C                     SETON                     28
     C                     EXCPT
     C                     SETOF                     28
     C*
     C           EXTR33    ENDSR                           ** EXTR33 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR34 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 92
     C*
     C*  CALLS:   CLINTB
     C*
     C*****************************************************************
     C*
     C           RSR34     BEGSR                           *** RSR34 ***
     C*
     C                     MOVE '92'      CTCD
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C                     Z-ADDCANS      CANS
     C                     Z-ADD0         CSQN
     C                     MOVE ACTO      ACTC
     C*
     C*
     C           PAYT      COMP *BLANK                   66
     C   66                GOTO OVER10
     C                     MOVE 'L'       CMSG
     C                     ADD  1         CSQN
     C                     MOVELPYCLNT    CK1
     C                     MOVELPYCLZT    WFLD8                           E19949
     C                     EXSR CLINTB
     C   U8                GOTO EXTR34
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDCS
     C*
     C                     SETON                         29
     C                     EXCPT
     C                     SETOF                         29
     C*
     C           OVER10    TAG                             **  OVER10 **
     C           FACO      COMP *BLANKS                  66
     C   66                GOTO OVER11
     C                     MOVE 'M'       CMSG
     C                     ADD  1         CSQN
     C                     MOVELFACO      FACONM
     C**********           Z-ADDFACONM    CK1                                                 CSD027
     C                     MOVE FACONM    CK1                                                 CSD027
     C                     EXSR CLINTB
     C   U8                GOTO EXTR34
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDCS
     C*
     C                     SETON                         29
     C                     EXCPT
     C                     SETOF                         29
     C           OVER11    TAG                             **  OVER11 **
     C*
     C********** TCNR      COMP 0                        66                                   CSD027
     C           TCNR      COMP *BLANKS                  66                                   CSD027
     C********** TCNR      COMP '000000'                 66                        BUG11613 BUG18053
     C  N66      TCNR      COMP '000000'                 66                                 BUG18053
     C   66                GOTO EXTR34
     C                     MOVE 'N'       CMSG
     C                     ADD  1         CSQN
     C**********           Z-ADDTCNR      CK1                                                 CSD027
     C                     MOVE TCNR      CK1                                                 CSD027
     C                     EXSR CLINTB
     C   U8                GOTO EXTR34
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDCS
     C*
     C                     SETON                         29
     C                     EXCPT
     C                     SETOF                         29
     C*
     C           EXTR34    ENDSR                           ** EXTR34 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR02 S/R - TO PERFORM SETUP AND OUTPUT OF A PREADVICE
     C*                TO ECASHAB
     C*                                                               *   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR02     BEGSR                           *** RSR02 ***
     C*
     C                     MOVE 'D'       RECI
     C                     MOVE 'A'       CSHT
     C                     MOVE SETC      ECCC
     C                     MOVE *BLANKS   FACO
     C                     Z-ADD10        BCH10
     C                     EXSR BCHCHN
     C                     MOVELBICN      ECLN
     C   43                Z-ADDCVIV      ECAM
     C   44      CVIV      DIV  10        ECAM
     C   45      CVIV      DIV  100       ECAM
     C   46      CVIV      DIV  1000      ECAM
     C                     MOVELPYCLZF    SCNM
     C*
     C*  MOVE DATA TO OUPUT FIELDS
     C                     MOVE TDRF      TRDR
     C                     MOVE ACTO      ACTC
     C***********          MOVE BCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C                     MOVE TDSS      SECS
     C*
     C*
     C                     ADD  1         CECASH
     C*
     C                     SETON                         21
     C                     EXCPT
     C                     SETOF                         21
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR05 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 0 FOR
     C*              A EUROCLEAR '01' TO ECTLXL0
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*
     C*****************************************************************
     C*
     C           RSR05     BEGSR                           *** RSR05 ***
     C*
     C                     Z-ADD0         EULN
     C                     Z-ADD1         EUIT
     C*
     C*  USE ONLY RIGHT MOST 5 DIGITS OF TRDR FOR E/C REF.
     C                     MOVE TDRF      TEMP01  5
     C                     MOVE TEMP01    EURF
     C*                                                                   S01129
     C****SEVERAL*FIELDS*ARE*SET*TO*0/' '*IF PAY*CODE*IS*3*************   S01175
     C***80******          GOTO R05T1                                     S01175
     C***********          Z-ADD0         EUCU                            S01175
     C***********          Z-ADD0         EUCD                            S01175
     C***********          MOVE *BLANKS   EUVY                            S01175
     C***********          GOTO OVER5                                     S01175
     C***********R05T1     TAG                                            S01175
     C***********ACTO      IFEQ 'C'                                 S01175S01190
     C***********          Z-ADD0         EUCU                            S01190
      *                                                                   E38340
     C                     Z-ADD0         EUCA                            S01190
     C                     Z-ADD0         EUCD                            S01175
      *                                                                   E38340
     C***********          MOVE *BLANKS   EUVY                      S01175S01190
     C***********          MOVE *BLANKS   EUSD                      S01175S01190
     C***********          MOVE *BLANKS   EUPC                      S01175S01190
     C***********                                                   S01129E38340
     C****PUT*THE*COUNTERVALUE*INTO*TWO*FIELDS*WHICH*TOGETHER*FORM* S01129S01190
     C****A*12,2*FIELD.******************************************** S01129E38340
     C***********          ELSE                                     S01175S01190
     C***43******          Z-ADDCVI0      EUCU                      S01129S01190
     C***44******          Z-ADDCVI1      EUCU                      S01129S01190
     C***45******          Z-ADDCVI2      EUCU                      S01129S01190
     C***46******          Z-ADDCVI3      EUCU                      S01129S01190
     C***43******          Z-ADD0         EUCD                      S01129S01190
     C***44******          Z-ADDCVD1      EUCD                      S01129S01190
     C***45******          Z-ADDCVD2      EUCD                      S01129S01190
     C***46******          Z-ADDCVD3      EUCD                      S01129S01190
     C**                                                                  E38340
     C**  PUT THE COUNTERVALUE INTO TWO FIELDS WHICH                      S01190
     C**  TOGETHER FORM A 15,2 FIELD                                      S01190
     C**                                                                  E38340
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE CVAL      EUCA                            S01190
     C                     MOVE '00'      EUCD                            S01190
     C                     ELSE                                           S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVE CVA3      EUCA                            S01190
     C                     MOVE '0'       EUCD                            S01190
     C                     MOVELCVA4      EUCD                            S01190
     C                     ELSE                                           S01190
     C                     MOVE CVA1      EUCA                            S01190
     C                     MOVE CVA2      EUCD                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP1                            S01190
     C*                                                                   S01129
     C           ACTO      IFEQ 'C'                                       S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     END                                            S01190
      *                                                                   E38340
     C****USE*SWIFT*CCY*CODE*************************************** S01129E38340
     C***********          MOVE CCYS      EUVY                      S01129S01190
     C***********                                                   S01129E38340
     C***********0VER5     TAG                             *** OVER5 ***  S01129
     C***********                                                         E38340
     C***VALUE*OF*EUPC/EUVY*DEPENDS*ON*WHETHER*PAY*CODE*IS*3*OR*NOT****   S01175
     C*****IF*CANCELATION,*OUTPUT*' '**********************************   E38340
     C****USE*SWIFT*CURRENCY*CODE**************************************   S01175
     C***80******          MOVE CCYS      EUVY                            S01175
     C***80******          MOVE 'P'       EUPC                            S01190
     C**N80******          MOVE 'F'       EUPC                            S01175
     C***50******          MOVE ' '       EUPC                            S01175
     C*                                                                   S01190
     C**  PAYMENT CODE                                                    S01190
     C           PCOD      IFEQ '1'                                       S01190
     C           PCOD      OREQ '5'                                       S01190
     C                     MOVE 'P'       EUPC                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'F'       EUPC                            S01190
     C                     END                                            S01190
     C   50                MOVE ' '       EUPC                            S01190
     C**                                                                  S01190
     C**  CEDEL COUNTERPARTY INDICATOR                                    S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C*
     C****FORMAT*SETTLEMENT*DATE*******                                   S01190
     C***********          Z-ADDTDVD      ZDAYNO                          S01190
     C***********          EXSR ZDATE2                                    S01190
     C***********          MOVE ZDATE     EUSD                            S01190
     C***********                                                         E38340
     C***********          MOVE PRYC      EUPR                            S01175
     C***********          END                                      S01175S01190
     C***********          MOVE *BLANKS   EUPR                      S01175S01190
     C*
     C*   GET E/C NUMBER OF CLIENT
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELF      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVELTCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C***********          MOVELEURO      EUCPN   50                      S01175
     C***********          MOVELEURO      EUCP                            S01175
     C**********           MOVELC101      EUCPN   50               S01175 CSE022
     C**********           MOVELC101      EUCP                     S01175 CSE022
     C                     MOVELC201      EUCPN   50                      CSE022
     C                     MOVELC201      EUCP                            CSE022
     C                     MOVE *BLANKS   EUCL
     C*
     C****IF*NOMINAL*IS*IN*JAP*YEN*VALUE*IS*DIVIDED*BY*1000************   S01175
     C***********TNMC      COMP ECJY                     83               S01175
     C***83******NOML      DIV  1000      EUNA                            S01175
     C**N83******          Z-ADDNOML      EUNA                            S01175
     C***********          Z-ADDNOML      EUNA                      S01175S01190
     C**                                                                  S01190
     C**  NOMINAL                                                         S01190
     C                     Z-ADDNOML      ENAM                            S01190
     C*
     C*   GET E/C NUMBER OF SECURITY BEING PROCESSED
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR05
     C***********          MOVELDC01      DPTIN                           S01175
     C                     MOVE 'E'       DPTIN   1                       S01175
     C                     EXSR SECREF                                    S01175
     C***********          MOVELDPTOUT    EUSC                            S01175
     C                     MOVE *BLANKS   EUSC                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C***********          MOVELD1SR      EUSC                      S01175S01176
     C                     MOVELDASR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      EUSC                      S01175S01176
     C                     MOVELDCSR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      EUSC                      S01175S01176
     C                     MOVELDDSR      EUSC                            S01176
     C                     END                                            S01175
     C*
     C**  USE OUR EUROCLEAR ACCOUNT FOR EURO.
     C*
     C**********           MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C**********           EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC101      EURO                     S01175 CSE022
     C                     MOVELC201      EURO                            CSE022
     C                     Z-ADD1         EUIN
     C                     MOVE TDRF      TRDR
     C                     MOVE ACTO      ACTC
     C                     MOVE *BLANKS   EUB1                            S01190
     C*
     C                     ADD  1         CECTLX  50
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         23
     C                     EXCPT
     C                     SETOF                         23
     C*
     C           EXTR05    ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR06 S/R - TO PERFORM SETUP AND OUTPUT OF LINE 1 RECORD FOR
     C*              A EUROCLEAR '01' TO ECTLXL1
     C*                                                               *   E38340
     C*  CALLS:   ZALIGN                                              *   E38340
     C*           ZDATE2                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR06     BEGSR                           *** RSR06 ***
     C*
     C*    IF CANCELATION, NO LINE 1 PRODUCED
     C*
     C   50                GOTO EXTR06
     C*
     C                     Z-ADD0         EULN
     C**
     C**  USE SWIFT CCY CODE
     C**                   MOVE CCYS      EUVY
     C                     MOVE CCYS      EUVY                            S01190
     C*                                                                   S01190
     C**FORM THE HASH FIGURE AFTER THE FORMATTED COUNTER VALUE HAS BEEN
     C** FORMED BUT BEFORE THE COUNTERPARTY & SECURITY CODE GET RESET
     C                     Z-ADD1         HASH
     C                     ADD  EUCPN     HASH
     C**********           ADD  EUSC      HASH     ??????????
     C                     MOVE *BLANKS   ZFIELD                          S01175
     C                     MOVE *BLANKS   WORK2  100                      S01190
     C**********           MOVELEUSC      ZFIELD                    S01175S01190
     C**********           Z-ADD6         ZADIG                     S01175S01190
     C**********           Z-ADD*ZERO     ZADEC                     S01175S01190
     C**********           EXSR ZALIGN                              S01175S01190
     C**********           MOVE ZFIELD    WORK1                     S01175S01190
     C**********           ADD  WORK1     HASH                      S01175S01190
     C*********************MOVELEUSC      WORK1   50                      S01175
     C*********************Z-ADDWORK1     HASH                            S01175
     C                     MOVEAEUSC      HARR                            S01190
     C           HARR,12   IFEQ *BLANK                                    S01190
     C                     Z-ADD1         C       20                      S01190
     C           HARR,C    DOUEQ*BLANK                                    S01190
     C           C         OREQ 10                                        S01190
     C                     ADD  1         C                               S01190
     C                     END                                            S01190
     C                     SUB  1         C                               S01190
     C                     Z-ADDC         ZADIG                           S01190
     C                     MOVELEUSC      ZFIELD                          S01190
     C                     ELSE                                           S01190
     C                     Z-ADD10        ZADIG                           S01190
     C                     MOVELEUSCI     ZFIELD                          S01190
     C                     END                                            S01190
     C                     Z-ADD*ZERO     ZADEC                           S01190
     C                     EXSR ZALIGN                                    S01190
     C           *IN99     IFEQ '0'                                       S01190
     C                     MOVE ZFIELD    WORK2                           S01190
     C                     END                                            S01190
     C                     ADD  WORK2     HASH                            S01190
     C                     ADD  FORHSH    HASH
     C***********          ADD  EUNA      HASH                            S01190
     C                     ADD  ENAM      HASH                            S01190
     C*
     C**********           Z-ADDHASHI     EUHU                            S01190
     C                     Z-ADDHASHI     EUHA                            S01190
     C                     MOVE '.'       EDP2                            S01190
     C                     Z-ADDHASHD     EUHD
     C**
     C                     Z-ADDTDVD      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     MOVE ZDATE     EUSD                            S01190
     C*
     C*
     C**********           MOVE PRYC      EUPR                            S01175
     C                     MOVE *BLANKS   EUPR                            S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C                     MOVE *BLANKS   EUCO
     C                     MOVE *BLANKS   EUCP
     C**                                                                  S01190
     C**  PRINCIPLE/AGENT INDICATOR                                       S01190
     C                     MOVE 'AG'      ELAG                            S01190
     C           TCAP      IFEQ 0                                         S01190
     C           TCAP      OREQ 2                                         S01190
     C           TCAP      OREQ 5                                         S01190
     C                     MOVE 'P'       EUPA                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'A'       EUPA                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C** REALIGNEMENT WITH MATCHING INDICATOR                             S01190
     C                     MOVE *BLANKS   ELRE                            S01190
     C                     MOVE *BLANKS   EREM                            S01190
     C*
     C**********           Z-ADD1         EUIT                            S01175
     C***********                                                         E38340
     C***USE*ONLY*RIGHT*MOST*5*DIGITS*OF*TRDR*FOR*E/C*REF.*************   S01175
     C**********           MOVE TDRF      TEMP01  5                       S01175
     C**********           MOVE TEMP01    EURF                            S01175
     C***********                                                         E38340
     C******USE*OUR*EUROCLEAR*ACCOUNT*FOR*EURO.************************   S01175
     C***********                                                         E38340
     C***********          Z-ADD1         EUIN                            S01190
     C***********                                                   S01175E38340
     C***********          MOVE *BLANKS   ETPN                      S01175S01190
     C***********          MOVE *ZEROS    ETPR                      S01175S01190
     C***********          MOVE *ZEROS    ETPD                      S01175S01190
     C***********          MOVE *ZEROS    ETDT                      S01175S01190
     C***********          MOVE *BLANKS   ESPI                      S01175S01190
     C***********                                                         E38340
     C*****SET*UP*TRADE*PRICE************************************** S01129S01190
     C***********          MOVE '.'       ETPN                      S01129S01190
     C***********          Z-ADDWTPDYI    ETPR                      S01129S01190
     C***********          MOVELWTPDYD    ETPD                      S01129S01190
     C***********                                                   S01129E38340
     C*****SET*UP*TRADE*DATE*************************************** S01129S01190
     C***********          Z-ADDTDDT      ZDAYNO                    S01129S01190
     C***********          EXSR ZDATE2                              S01129S01190
     C***********          Z-ADDZDATE     ETDT                      S01129S01190
     C***********                                                   S01129E38340
     C*****SET*UP*SPECIAL*INSTRUCTIONS***************************** S01129S01190
     C***********PCOD      IFEQ '5'                                 S01129S01190
     C***********          MOVE 'G'       ESPI                      S01129S01190
     C***********          ELSE                                     S01129S01190
     C***********          MOVE 'N'       ESPI                      S01129S01190
     C***********          END                                      S01129S01190
     C*                                                                   S01129
     C                     MOVE *BLANKS   EUB1                            S01129
     C*                                                                   S01129
     C***********          MOVE TDRF      TRDR                            S01190
     C***********          MOVE ACTO      ACTC                            S01190
     C*                                                                   S01190
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         24
     C                     EXCPT
     C                     SETOF                         24
     C*
     C           EXTR06    ENDSR                           *** EXTR06 ***
     C*
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN1 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 2 FOR A        S01190
     C*              EUROCLEAR '01' TO ECTLXL0                            S01190
     C*              OR FOR A LINE 2 TYPE '02'                            S01190
     C*                                                               *   E38340
     C*  CALLS:   ZDATE2                                              *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN1     BEGSR                           *** RSRN1 ***  S01190
     C*                                                                   S01190
     C*    IF CANCELATION, NO LINE 2 PRODUCED                             S01190
     C*                                                                   S01190
     C           ACTO      IFNE 'C'                                       S01190
     C*                                                                   S01190
     C                     Z-ADD0         EULN                            S01190
     C**                                                                  S01190
     C**   TRADE PRICE                                                    S01190
     C                     MOVE 'TP'      EUL1                            S01190
     C                     MOVE *BLANK    ETPS                            S01190
     C**   SET UP TRADE PRICE                                             S01190
     C                     MOVE '.'       ETPN                            S01190
     C                     Z-ADDWTPDYI    ETDP                            S01190
     C                     MOVELWTPDYD    ETPD                            S01190
     C*                                                                   S01190
     C**   SET UP TRADE DATE                                              S01190
     C                     Z-ADDTDDT      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     Z-ADDZDATE     ETDT                            S01190
     C*                                                                   S01190
     C**   SET UP SPECIAL INSTRUCTIONS                                    S01190
     C           PCOD      IFEQ '5'                                       S01190
     C                     MOVE 'G'       ESPI                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'N'       ESPI                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C**  TRADE REFERENCE                                                 S01190
     C                     MOVE 'TR'      ELTR                            S01190
     C                     MOVE TDRF      ETRF                            S01190
     C**                                                                  S01190
     C**  MARKET INDICATOR                                                S01190
     C                     MOVE 'MT'      ELMT                            S01190
     C                     MOVE TDMI      EMKT                            S01190
     C*                                                                   S01190
     C                     MOVE *BLANKS   EUB2                            S01190
     C*                                                                   S01190
     C                     SETON                         25               S01190
     C                     EXCPT                                          S01190
     C                     SETOF                         25               S01190
     C                     ADD  1         CECTLX                          S01190
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*                                                                   S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C                     ENDSR                                          S01190
     C*                                                                   S01190
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN2 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 3 FOR          S01190
     C*              TRADE DETAILS                                        S01190
     C*                                                                   S01190
     C*  IF CANCELLATION, NO LINE 3 PRODUCED                              S01190
     C*                                                               *   E38340
     C*  CALLS:   None.                                               *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN2     BEGSR                           *** RSRN2 ***  S01190
     C**                                                                  S01190
     C           ACTO      IFNE 'C'                                       S01190
     C                     Z-ADD0         EULN                            S01190
     C**                                                                  S01190
     C**  PRINCIPAL AMOUNT                                                S01190
     C                     MOVE 'PA'      ELPA                            S01190
     C                     MOVE TCSR      PAMTID                          S01190
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE PAMTID    EPRA                            S01190
     C                     MOVE '00'      EPRD                            S01190
     C                     ELSE                                           S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVE PAMTI1    EPRA                            S01190
     C                     MOVE '0'       EPRD                            S01190
     C                     MOVELPAMTI2    EPRD                            S01190
     C                     ELSE                                           S01190
     C                     MOVE PAMTI3    EPRA                            S01190
     C                     MOVE PAMTI4    EPRD                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP3                            S01190
     C**                                                                  S01190
     C**  PRINCIPAL CURRENCY                                              S01190
     C                     MOVE TNMC      EPRC                            S01190
     C**                                                                  S01190
     C**  PRINCIPAL EXCHANGE RATE (CALCULATION DEPENDENT ON               S01190
     C**                           MULT/DIV INDICATOR)                    S01190
     C           TMDI      IFEQ 'M'                                       S01190
     C                     MOVE TDERI     EPRX                            S01190
     C                     MOVELTDERD     EPXD                            S01190
     C                     ELSE                                           S01190
     C           1         DIV  TDER      PETEMP 138                      S01190
     C                     MOVE PETI      EPRX                            S01190
     C                     MOVELPETD      EPXD                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP4                            S01190
     C**                                                                  S01190
     C**  ACCRUED INTEREST                                                S01190
     C**          (NOMINAL DECIMAL PLACES GIVES FORMAT FOR                S01190
     C**           ACCRUED INTEREST OUTPUT)                               S01190
     C                     MOVE 'AI'      ELAI                            S01190
     C           ITRA      ADD  TINA      ATEMP  150                      S01190
     C           ATEMP     IFGE 0                                         S01190
     C                     MOVE '+'       EAIS                            S01190
     C                     ELSE                                           S01190
     C                     MOVE '-'       EAIS                            S01190
     C                     Z-SUBATEMP     ATEMP                           E32081
     C                     END                                            S01190
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE ATEMP     EAIA                            S01190
     C                     MOVE '00'      EAID                            S01190
     C                     ELSE                                           S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVE ATEMP1    EAIA                            S01190
     C                     MOVE '0'       EAID                            S01190
     C                     MOVELATEMP2    EAID                            S01190
     C                     ELSE                                           S01190
     C                     MOVE ATEMP3    EAIA                            S01190
     C                     MOVE ATEMP4    EAID                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP5                            S01190
     C**                                                                  S01190
     C**  ACCRUED CURRENCY                                                S01190
     C                     MOVE TNMC      EAIC                            S01190
     C**                                                                  S01190
     C                     MOVE *BLANKS   EUB3                            S01190
     C*                                                                   S01190
     C                     SETON                         41               S01190
     C                     EXCPT                                          S01190
     C                     SETOF                         41               S01190
     C                     ADD  1         CECTLX                          S01190
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*                                                                   S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C                     ENDSR                                          S01190
     C**                                                                  S01190
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN3 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 4 FOR          S01190
     C*              TRADE DETAILS                                        S01190
     C*                                                               *   E38340
     C*  CALLS:   RSRN6                                               *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN3     BEGSR                           *** RSRN3 ***  S01190
     C**                                                                  S01190
     C           ACTO      IFNE 'C'                                       S01190
     C*                                                                   S01190
     C                     Z-ADD0         EULN                            S01190
     C**                                                                  S01190
     C**  ACCRUED EXCHANGE RATE (CALCULATION DEPENDENT ON                 S01190
     C**                           MULT/DIV INDICATOR)                    S01190
     C           TMDI      IFEQ 'M'                                       S01190
     C                     MOVE TDERI     EAIX                            S01190
     C                     MOVELTDERD     EAXD                            S01190
     C                     ELSE                                           S01190
     C           1         DIV  TDER      PETEMP 138                      S01190
     C                     MOVE PETI      EAIX                            S01190
     C                     MOVELPETD      EAXD                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP6                            S01190
     C**                                                                  S01190
     C**  RATE OF ACCRUED INTEREST                                        S01190
     C**                                                                  S01190
     C                     EXSR RSRN6                                     S01190
     C**                                                                  S01190
     C**  SET UP FEES/COMMISIONS   (SUM OF)                               S01190
     C                     MOVE 'FC'      ELFC                            S01190
     C                     Z-ADDTBCA      FCTEMP 130                      S01190
     C                     ADD  TCCA      FCTEMP                          S01190
     C                     ADD  TCA1      FCTEMP                          S01190
     C                     ADD  TCA2      FCTEMP                          S01190
     C                     ADD  TCA3      FCTEMP                          S01190
     C                     ADD  TCA4      FCTEMP                          S01190
     C                     ADD  TCA5      FCTEMP                          S01190
     C                     ADD  TCA6      FCTEMP                          S01190
     C                     ADD  TCA7      FCTEMP                          S01190
     C           FCTEMP    IFLT 0                                         S01190
     C           FCTEMP    MULT -1        FCTEMP                          S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE FCTEMP    EFCA                            S01190
     C                     MOVE '00'      EFCD                            S01190
     C                     ELSE                                           S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVEL'0'       EFCA                            S01190
     C                     MOVE FCT1I     EFCA                            S01190
     C                     MOVE ' 0'      EFCD                            S01190
     C                     MOVELFCT1D     EFCD                            S01190
     C                     ELSE                                           S01190
     C                     MOVEL'00'      EFCA                            S01190
     C                     MOVE FCT2I     EFCA                            S01190
     C                     MOVE FCT2D     EFCD                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP8                            S01190
     C**                                                                  S01190
     C**  FEE'S CURRENCY (NOMINAL)                                        S01190
     C                     MOVE TNMC      EFCC                            S01190
     C**                                                                  S01190
     C**  FEES EXCHANGE RATE (CALCULATION DEPENDENT ON                    S01190
     C**                           MULT/DIV INDICATOR)                    S01190
     C           TMDI      IFEQ 'M'                                       S01190
     C                     MOVE TDERI     EFCX                            S01190
     C                     MOVELTDERD     EFXD                            S01190
     C                     ELSE                                           S01190
     C           1         DIV  TDER      PETEMP 138                      S01190
     C                     MOVE PETI      EFCX                            S01190
     C                     MOVELPETD      EFXD                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP9                            S01190
     C                     MOVE *BLANKS   EUB4                            S01190
     C*                                                                   S01190
     C**                                                                  S01190
     C                     SETON                         42               S01190
     C                     EXCPT                                          S01190
     C                     SETOF                         42               S01190
     C                     ADD  1         CECTLX                          S01190
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C**                                                                  S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C                     ENDSR                                          S01190
     C*                                                                   S01190
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN6 S/R - CALCULATE ACCRUED INTEREST FIELDS                    S01190
     C*                                                                   S01190
     C*         IF PROCESSING TYPE = 3,5,8 OR PARTLY PAID INDICATOR       S01190
     C*          = Y FIELDS (EDAC,EARA,EDP7,ECLB) ARE BLANK.              S01190
     C*                                                               *   E38340
     C*  CALLS:   ZEVCD                                               *   E38340
     C*           ZNCD                                                *   E38340
     C*           ZDYYR                                               *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN6     BEGSR                           *** RSRN6 ***  S01190
     C**                                                                  S01190
     C           PROT      IFEQ '3'                                       S01190
     C           PROT      OREQ '5'                                       S01190
     C           PROT      OREQ '8'                                       S01190
     C           PPDI      OREQ 'Y'                                       S01190
     C           TDCR      ORLE 0                                         S01190
     C                     MOVE *BLANKS   EDAC                            S01190
     C                     MOVE *BLANKS   EARA                            S01190
     C                     MOVE *BLANKS   EDP7                            S01190
     C                     MOVE *BLANKS   EARD                            S01190
     C                     MOVE *BLANKS   ECLB                            S01190
     C                     MOVE *BLANKS   ELRA                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'RA'      ELRA                            S01190
     C           ITRA      ADD  TINA      BTEMP  130                      S01190
     C                     Z-ADDDNWD      ZZDNWD                          S01117
     C                     Z-ADDAPDA      ZZAPDT                          S01117
     C                     EXSR ZEVCD                                     S01190
     C                     EXSR ZNCD                                      S01190
     C                     EXSR ZDYYR                                     S01190
     C           BTEMP     DIV  NOML      ACRT1  158                      S01190
     C           100       DIV  TDCR      ACRT2  158                      S01190
     C           ACRT1     MULT ACRT2     ACRT2                           S01190
     C           ACRT2     MULT ZINTDD    ACRT2                           S01190
     C           NCDP      IFEQ 0                                         S01190
     C           ACRT6     IFGE 5                                         S01190
     C           ACRT3     ADD  1         ACRT3                           S01190
     C                     END                                            S01190
     C                     MOVE ACRT3     EDAC                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 1                                         S01190
     C           ACRT7     IFGE 5                                         S01190
     C           ACRT4     ADD  1         ACRT4                           S01190
     C                     END                                            S01190
     C                     MOVE ACRT4     EDAC                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 2                                         S01190
     C           NCDP      OREQ 3                                         S01190
     C           ACRT8     IFGE 5                                         S01190
     C           ACRT5     ADD  1         ACRT5                           S01190
     C                     END                                            S01190
     C                     MOVE ACRT5     EDAC                            S01190
     C                     END                                            S01190
     C                     MOVE TDCRI     EARA                            S01190
     C                     MOVE '.'       EDP7                            S01190
     C                     MOVELTDCRD     EARD                            S01190
     C                     MOVE ZINTDD    ECLB                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C                     ENDSR                                          S01190
     C**                                                                  S01190
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN4 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 5 FOR          S01190
     C*              NARRATIVE                                            S01190
     C*                                                               *   E38340
     C*  CALLS:   None.                                               *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN4     BEGSR                           *** RSRN4 ***  S01190
     C**                                                                  S01190
     C*     (ONLY USED IF SPECIAL INSTRUCTIONS HAVE BEEN ENTERED          S01190
     C*      ON TRADE)                                                    S01190
     C           ACTO      IFNE 'C'                                       S01190
     C           TDSI      IFNE *BLANKS                                   S01190
     C                     Z-ADD0         EULN                            S01190
     C**                                                                  S01190
     C**  NARRATIVE                                                       S01190
     C                     MOVE 'NA'      ELNA                            S01190
     C                     MOVELTDSI      EUNR                            S01190
     C**                                                                  S01190
     C                     SETON                         48               S01190
     C                     EXCPT                                          S01190
     C                     SETOF                         48               S01190
     C                     ADD  1         CECTLX                          S01190
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*                                                                   S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C                     ENDSR                                          S01190
     C*                                                                   S01190
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN5 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 2 FOR A        S01190
     C*              EUROCLEAR '03' TO ECTLXL0                            S01190
     C*                                                               *   E38340
     C*  CALLS:   ZDATE2                                              *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN5     BEGSR                           *** RSRN5 ***  S01190
     C*                                                                   S01190
     C**  IF CANCELATION, NO LINE 2 PRODUCED                              S01190
     C*                                                                   S01190
     C           ACTO      IFNE 'C'                                       S01190
     C*                                                                   S01190
     C                     Z-ADD0         EULN                            S01190
     C**                                                                  S01190
     C**  TRADE PRICE  (LABEL = 'TP' IF WITH CEDEL, ELSE = 'TD')          S01190
     C           DLFRAT    IFEQ 2                                         S01190
     C                     MOVE 'TP'      EUL1                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'TD'      EUL1                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C           DLFRAT    IFEQ 2                                         S01190
     C**   SET UP TRADE PRICE                                             S01190
     C                     MOVE '.'       ETPN                            S01190
     C                     Z-ADDWTPDYI    ETDP                            S01190
     C                     MOVELWTPDYD    ETPD                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANK    ETPN                            S01190
     C                     MOVE *BLANK    ETDP                            S01190
     C                     MOVE *BLANK    ETPD                            S01190
     C                     END                                            S01190
     C                     MOVE *BLANK    ETPS                            S01190
     C*                                                                   S01190
     C**   SET UP TRADE DATE                                              S01190
     C                     Z-ADDTDDT      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     Z-ADDZDATE     ETDT                            S01190
     C*                                                                   S01190
     C**   SET UP SPECIAL INSTRUCTIONS                                    S01190
     C           DLFRAT    IFEQ 2                                         S01190
     C           PCOD      IFEQ '5'                                       S01190
     C                     MOVE 'G'       ESPI                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'N'       ESPI                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C**  TRADE REFERENCE                                                 S01190
     C                     MOVE 'TR'      ELTR                            S01190
     C                     MOVE TDRF      ETRF                            S01190
     C**                                                                  S01190
     C**  MARKET INDICATOR                                                S01190
     C                     MOVE 'MT'      ELMT                            S01190
     C                     MOVE TDMI      EMKT                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ESPI                            S01190
     C                     MOVE *BLANKS   ELTR                            S01190
     C                     MOVE *BLANKS   ETRF                            S01190
     C                     MOVE *BLANKS   ELMT                            S01190
     C                     MOVE *BLANKS   EMKT                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C*                                                                   S01190
     C                     MOVE *BLANKS   EUB2                            S01190
     C*                                                                   S01190
     C                     SETON                         25               S01190
     C                     EXCPT                                          S01190
     C                     SETOF                         25               S01190
     C                     ADD  1         CECTLX                          S01190
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*                                                                   S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C                     ENDSR                                          S01190
     C*                                                                   S01190
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  RSRN7 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 2 FOR A        S01190
     C*              EUROCLEAR '07' TO ECTLXL0                            S01190
     C*                                                               *   E38340
     C*  CALLS:   ZDATE2                                              *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           RSRN7     BEGSR                           *** RSRN7 ***  S01190
     C*                                                                   S01190
     C**   DO NOT USE THIS S/R IF OWN ACCOUNT TRANSFER                    S01190
     C**                                                                  S01190
     C*    IF CANCELATION, NO LINE 2 PRODUCED                             S01190
     C*                                                                   S01190
     C           ACTO      IFNE 'C'                                       S01190
     C*                                                                   S01190
     C                     Z-ADD0         EULN                            S01190
     C**                                                                  S01190
     C**   TRADE PRICE  (LABEL = 'TP' IF WITH CEDEL, ELSE = 'TD')         S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C                     MOVE 'TP'      EUL1                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'TD'      EUL1                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C**   SET UP TRADE PRICE                                             S01190
     C                     MOVE '.'       ETPN                            S01190
     C                     Z-ADDWTPDYI    ETDP                            S01190
     C                     MOVELWTPDYD    ETPD                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ETPN                            S01190
     C                     MOVE *BLANKS   ETDP                            S01190
     C                     MOVE *BLANKS   ETPD                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C                     MOVE *BLANK    ETPS                            S01190
     C*                                                                   S01190
     C**   SET UP TRADE DATE                                              S01190
     C                     Z-ADDTDDT      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     Z-ADDZDATE     ETDT                            S01190
     C*                                                                   S01190
     C**   SET UP SPECIAL INSTRUCTIONS                                    S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C           PCOD      IFEQ '5'                                       S01190
     C                     MOVE 'G'       ESPI                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'N'       ESPI                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C**  TRADE REFERENCE                                                 S01190
     C                     MOVE 'TR'      ELTR                            S01190
     C                     MOVE TDRF      ETRF                            S01190
     C**                                                                  S01190
     C**  MARKET INDICATOR                                                S01190
     C                     MOVE 'MT'      ELMT                            S01190
     C                     MOVE TDMI      EMKT                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ESPI                            S01190
     C                     MOVE *BLANKS   ELTR                            S01190
     C                     MOVE *BLANKS   ETRF                            S01190
     C                     MOVE *BLANKS   ELMT                            S01190
     C                     MOVE *BLANKS   EMKT                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C                     SETON                         25               S01190
     C                     EXCPT                                          S01190
     C                     SETOF                         25               S01190
     C                     ADD  1         CECTLX                          S01190
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*                                                                   S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C                     ENDSR                                          S01190
     C*                                                                   S01190
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR09 S/R - TO PERFORM SETUP AND OUTPUT OF A LINE 0 FOR A
     C*              EUROCLEAR '03' TO ECTLXL0
     C*                                                                   S01190
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*
     C*****************************************************************
     C*
     C           RSR09     BEGSR                           *** RSR09 ***
     C*
     C                     Z-ADD0         EULN
     C                     Z-ADD3         EUIT
     C*
     C*  USE ONLY RIGHT MOST 5 DIGITS OF TRDR FOR E/C REF.
     C                     MOVE TDRF      TEMP01
     C                     MOVE TEMP01    EURF
     C                     MOVE TDRF      TRDR
     C*                                                                   S01129
     C****SEVERAL*FIELDS*ARE*SET*TO*0/' '*IF*PAY*CODE*IS*3******** S01129 E38340
     C***80******          GOTO R09T1                                     S01175
     C***********          Z-ADD0         EUCU                            S01175
     C***********          Z-ADD0         EUCD                            S01175
     C***********          MOVE *BLANKS   EUVY                            S01175
     C***********          GOTO OVER9                                     S01175
     C***********R09T1     TAG                                            S01175
      *                                                                   E38340
     C           ACTO      IFEQ 'C'                                       S01175
      *                                                                   E38340
     C***********          Z-ADD0         EUCU                      S01175S01190
      *                                                                   E38340
     C                     Z-ADD0         EUCA                            S01190
     C                     Z-ADD0         EUCD                            S01175
      *                                                                   E38340
     C***********          MOVE *BLANKS   EUVY                      S01175S01190
     C***********          MOVE *BLANKS   EUSD                      S01175S01190
     C***********          MOVE *BLANKS   EUPC                      S01175S01190
     C                     END                                            S01190
     C**  PAYMENT CODE                                                    S01190
     C           PCOD      IFEQ '1'                                       S01190
     C           PCOD      OREQ '5'                                       S01190
     C                     MOVE 'P'       EUPC                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'F'       EUPC                            S01190
     C                     END                                            S01190
     C*                                                                   S01129
     C**  CEDEL COUNTERPARTY INDICATOR                                    S01190
     C           DLFRAT    IFEQ 2                                         S01190
     C                     MOVE 'C'       ECCP                            S01190
     C                     ELSE                                           S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C*                                                                   S01129
     C****PUT*THE*COUNTERVALUE*INTO*TWO*FIELDS*WHICH*TOGETHER*FORM*A*12,2 S01190
     C*********************ELSE                                           S01190
     C***43******          Z-ADDCVI0      EUCU                      S01129S01190
     C***44******          Z-ADDCVI1      EUCU                      S01129S01190
     C***45******          Z-ADDCVI2      EUCU                      S01129S01190
     C***46******          Z-ADDCVI3      EUCU                      S01129S01190
     C***43******          Z-ADD0         EUCD                      S01129S01190
     C***44******          Z-ADDCVD1      EUCD                      S01129S01190
     C***45******          Z-ADDCVD2      EUCD                      S01129S01190
     C***46******          Z-ADDCVD3      EUCD                      S01129S01190
     C*                                                                   S01129
     C           EUPC      IFEQ 'F'                                       S01190
     C           ECCP      ANDNE'C'                                       S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     ELSE                                           S01190
     C           NCDP      IFEQ 0                                         S01190
     C                     MOVE CVAL      EUCA                            S01190
     C                     MOVE '00'      EUCD                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 1                                         S01190
     C                     MOVE CVA3      EUCA                            S01190
     C                     MOVE '0'       EUCD                            S01190
     C                     MOVELCVA4      EUCD                            S01190
     C                     END                                            S01190
     C           NCDP      IFEQ 2                                         S01190
     C           NCDP      OREQ 3                                         S01190
     C                     MOVE CVA1      EUCA                            S01190
     C                     MOVE CVA2      EUCD                            S01190
     C                     END                                            S01190
     C                     MOVE '.'       EDP1                            S01190
     C                     END                                            S01190
     C           ACTO      IFEQ 'C'                                       S01190
     C                     MOVE *BLANKS   EDP1                            S01190
     C                     MOVE *BLANKS   EUCA                            S01190
     C                     MOVE *BLANKS   EUCD                            S01190
     C                     END                                            S01190
     C*                                                                   S01129
     C****USE*SWIFT*CCY*CODE*************************************** S01129S01190
     C***********          MOVE CCYS      EUVY                      S01129S01190
     C***********                                                   S01129E38340
     C***********OVER9     TAG                             *** OVER9 ***  S01175
     C***********                                                         E38340
     C***VALUE*OF*EUPC/EUVY*DEPENDS*ON*WHETHER*PAY*CODE*IS*3*OR*NOT****   S01190
     C****USE*SWIFT*CURRENCY*CODE**************************************   S01175
     C***80******          MOVE CCYS      EUVY                            S01175
     C***80******          MOVE 'P'       EUPC                            S01190
     C**N80******          MOVE 'F'       EUPC                            S01175
     C***50******          MOVE ' '       EUPC                      S01175S01190
      *                                                                   E38340
     C** IF CANCELLATION, OUTPUT ' '
     C   50                MOVE ' '       EUPC                            S01190
     C*
     C****FORMAT*SETTLEMENT*DATE***************************************   E38340
     C***********          Z-ADDTDVD      ZDAYNO                          S01190
     C***********          EXSR ZDATE2                                    S01190
     C***********          MOVE ZDATE     EUSD                            S01190
     C***********          END                                      S01175S01190
     C***********          MOVE *BLANKS   EUPR                      S01175S01190
     C*
     C**  GET E/C NUMBER OF CLIENT
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1                             S01175
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     ELSE                                           S01175
     C                     MOVELTCNR      CK1                             S01175
     C***********          EXSR CLINT1                                    S01175
     C                     END                                            S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C***********          MOVELEURO      EUCPN   50                      S01175
     C***********          MOVELEURO      EUCP                            S01175
     C           DLFRAT    IFEQ 2                                         S01190
     C**********           MOVELC102      EUCP                     S01190 CSE022
     C**********           MOVELC102      EUCPN   50               S01190 CSE022
     C                     MOVELC202      EUCP                            CSE022
     C                     MOVELC202      EUCPN   50                      CSE022
     C                     ELSE                                           S01190
     C**********           MOVELC101      EUCPN   50               S01175 CSE022
     C**********           MOVELC101      EUCP                     S01175 CSE022
     C                     MOVELC201      EUCPN   50                      CSE022
     C                     MOVELC201      EUCP                            CSE022
     C                     END                                            S01190
     C**N17******          MOVE *BLANKS   EUCL                            S01175
     C***17******          MOVE 'C'       EUCL                            S01175
     C*                                                                   S01175
     C*   SET CLEARING HOUSE INDICATOR                                    S01175
     C           ACTO      IFNE 'C'                                       S01190
     C           DLFRAT    IFEQ 2                                         S01175
     C***********ACTO      ANDNE'C'                                S01175 S01190
     C                     MOVE 'C'       EUCL                            S01175
     C*********************ELSE                                    S01175 S01190
     C                     END                                            S01190
     C           DLFRAT    IFEQ 3                                         S01190
     C********** EUPC      IFEQ 'P'                                S01175 CSE022
     C**********           MOVE 'K'       EUCL                     S01190 CSE022
     C**********           END                                     S01190 CSE022
     C           EUPC      IFEQ 'F'                                       S01175
     C                     MOVE *BLANKS   EUCL                            S01175
     C                     END                                            S01190
     C                     END                                            S01175
     C           DLFRAT    IFNE 2                                         S01175
     C           DLFRAT    ANDNE3                                         S01175
     C                     MOVE *BLANKS   EUCL                            S01175
     C                     END                                            S01190
     C                     END                                            S01175
     C   50                MOVE ' '       EUCL                            S01190
     C*
     C****IF*NOMINAL*IS*IN*JAP*YEN*VALUE*IS*DIVIDED*BY*1000************   S01175
     C***********TNMC      COMP ECJY                     83               S01175
     C***83******NOML      DIV  1000      EUNA                            S01175
     C**N83******          Z-ADDNOML      EUNA                            S01175
     C***********          Z-ADDNOML      EUNA                      S01175S01190
     C                     Z-ADDNOML      ENAM                            S01190
     C*
     C*   GET E/C NUMBER OF SECURITY BEING PROCESSED
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR09
     C***********          MOVELDC01      DPTIN                           S01175
     C                     MOVE 'E'       DPTIN                           S01175
     C                     EXSR SECREF
     C***********          MOVELDPTOUT    EUSC                            S01175
     C                     MOVE *BLANKS   EUSC                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C***********          MOVELD1SR      EUSC                      S01175S01176
     C                     MOVELDASR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      EUSC                      S01175S01176
     C                     MOVELDCSR      EUSC                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      EUSC                      S01175S01176
     C                     MOVELDDSR      EUSC                            S01176
     C                     END                                            S01175
     C*
     C*     USE OUR EUROCLEAR ACCOUNT FOR EURO.
     C*
     C**********           MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C**********           EXSR CLINT1                                    S01175
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC101      EURO                     S01175 CSE022
     C                     MOVELC201      EURO                            CSE022
     C                     Z-ADD3         EUIN
     C                     MOVE ACTO      ACTC                            E18208
     C*
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         23
     C                     EXCPT
     C                     SETOF                         23
     C*
     C           EXTR09    ENDSR                           ** EXTR09 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR10 S/R - TO PERFORM SETUP AND OUTPUT OF LINE 1 RECORD FOR
     C*              A EUROCLEAR '03' TO ECTLXL1
     C*
     C*  CALLS:   ZDATE2
     C*           ZALIGN                                              *   E38340
     C*           CLIENT                                              *   E38340
     C************CLINT1***********************************************   E38340
     C*
     C*****************************************************************
     C*
     C           RSR10     BEGSR                           *** RSR10 ***
     C*
     C**  IF CANCELATION, NO LINE 1 PRODUCED                              S01175
     C*
     C   50                GOTO EXTR10                                    S01175
     C*
     C                     Z-ADD0         EULN
     C*
     C****PUT*THE*COUNTERVALUE*INTO*TWO*FIELDS*WHICH*TOGETHER*FORM*A*12,2 S01190
     C***43******          Z-ADDCVI0      EUCU                            S01190
     C***44******          Z-ADDCVI1      EUCU                            S01190
     C***45******          Z-ADDCVI2      EUCU                            S01190
     C***46******          Z-ADDCVI3      EUCU                            S01190
     C***43******          Z-ADD0         EUCD                            S01190
     C***44******          Z-ADDCVD1      EUCD                            S01190
     C***45******          Z-ADDCVD2      EUCD                            S01190
     C***46******          Z-ADDCVD3      EUCD                            S01190
     C***********                                                         E38340
     C****USE*SWIFT*CCY*CODE*******************************************   S01175
     C***********          MOVE CCYS      EUVY                            S01175
     C**  USE SWIFT CCY CODE                                              S01190
     C           EDP1      IFEQ *BLANKS                                   S01190
     C                     MOVE *BLANKS   EUVY                            S01190
     C                     ELSE                                           S01190
     C                     MOVE CCYS      EUVY                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C                     MOVE *BLANKS   EUPR                            S01190
     C*
     C* FORM THE HASH FIGURE AFTER THE FORMATTED COUNTER VALUE HAS BEEN
     C* FORMED BUT BEFORE THE COUNTERPARTY & SECURITY CODE GET RESET
     C                     Z-ADD3         HASH
     C                     ADD  EUCPN     HASH
     C**********           ADD  EUSC      HASH      ??????????
     C                     MOVE *BLANKS   ZFIELD                          S01175
     C                     MOVE *BLANKS   WORK2  100                      S01190
     C**********           MOVELEUSC      ZFIELD                    S01175S01190
     C**********           Z-ADD6         ZADIG                     S01175S01190
     C**********           Z-ADD*ZERO     ZADEC                     S01175S01190
     C**********           EXSR ZALIGN                              S01175S01190
     C**********           MOVE ZFIELD    WORK1                     S01175S01190
     C**********           ADD  WORK1     HASH                      S01175S01190
     C                     MOVEAEUSC      HARR                            S01190
     C           HARR,12   IFEQ *BLANK                                    S01190
     C                     Z-ADD1         C       20                      S01190
     C           HARR,C    DOUEQ*BLANK                                    S01190
     C           C         OREQ 10                                        S01190
     C                     ADD  1         C                               S01190
     C                     END                                            S01190
     C                     SUB  1         C                               S01190
     C                     Z-ADDC         ZADIG                           S01190
     C                     MOVELEUSC      ZFIELD                          S01190
     C                     ELSE                                           S01190
     C                     Z-ADD10        ZADIG                           S01190
     C                     MOVELEUSCI     ZFIELD                          S01190
     C                     END                                            S01190
     C                     Z-ADD*ZERO     ZADEC                           S01190
     C                     EXSR ZALIGN                                    S01190
     C           *IN99     IFEQ '0'                                       S01190
     C                     MOVE ZFIELD    WORK2                           S01190
     C                     END                                            S01190
     C                     ADD  WORK2     HASH                            S01190
     C                     ADD  FORHSH    HASH
     C**********           ADD  EUNA      HASH                            S01190
     C                     ADD  ENAM      HASH                            S01190
     C*                                                                   S01190
     C**********           Z-ADDHASHI     EUHU                            S01190
     C                     Z-ADDHASHI     EUHA                            S01190
     C                     MOVE '.'       EDP2                            S01190
     C                     Z-ADDHASHD     EUHD
     C**                                                                  S01190
     C**  PRINCIPLE/AGENT INDICATOR                                       S01190
     C           DLFRAT    IFNE 2                                         S01190
     C                     MOVE *BLANKS   ELAG                            S01190
     C                     MOVE *BLANKS   EUPA                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'AG'      ELAG                            S01190
     C           TCAP      IFEQ 0                                         S01190
     C           TCAP      OREQ 2                                         S01190
     C           TCAP      OREQ 5                                         S01190
     C                     MOVE 'P'       EUPA                            S01190
     C                     ELSE                                           S01190
     C                     MOVE 'A'       EUPA                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C** REALIGNEMENT WITH MATCHING INDICATOR                             S01190
     C                     MOVE *BLANKS   ELRE                            S01190
     C                     MOVE *BLANKS   EREM                            S01190
     C**                                                                  S01190
     C**  CEDEL COUNTERPARTY IND.                                         S01190
     C                     MOVE *BLANKS   ECCP                            S01190
     C**                                                                  S01190
     C****E/C*SETTLEMENT*DATE*IS*VALUE*DATE*IN*DDMMYY*FORMAT***********   S01175
     C**********           Z-ADDTDVD      ZDAYNO                          S01175
     C**********           EXSR ZDATE2                                    S01175
     C**********           MOVE ZDATE     EUSD                            S01175
      *                                                                   E38340
     C**  E/C SETTLEMENT DATE IS VALUE DATE IN DDMMYY FORMAT              S01190
     C                     Z-ADDTDVD      ZDAYNO                          S01190
     C                     EXSR ZDATE2                                    S01190
     C                     MOVE ZDATE     EUSD                            S01190
     C*
     C**********           MOVE *BLANKS   EUPR                            S01175
     C**                                                                  S01190
     C**  COUNTERPARTY NO.                                                S01190
     C                     MOVE *BLANKS   EUCP
     C*
     C*   CORRESPONDENT IS EURO NUMBER FOR THE CLIENT (IF NOT BRIDGE)
     C*                                                                   E38340
     C**N17******PAYT      COMP *BLANK                   17               S01175
     C**N17******          MOVELPYCLNT    CK1                             S01175
     C**N17******          EXSR CLINT1                                    S01175
     C**N17******          MOVELEURO      EUCO                            S01175
     C***17******          MOVE *BLANKS   EUCO                            S01175
     C***********EUCL      IFEQ ' '                                       S01190
      *                                                                   E38340
     C           EUCL      IFEQ 'C'                                       S01190
     C                     MOVE *BLANKS   EUCO                            S01190
     C                     ELSE                                           S01190
     C                     MOVELPAYT      CK1                             S01175
     C                     EXSR CLIENT                                    S01175
     C           *IN99     IFEQ '1'                                       S01175
     C                     SETOF                     99                   S01175
     C                     SETOF                     U7U8LR               S01175
     C                     MOVE *BLANKS   EUCO                            S01175
     C                     ELSE                                           S01175
     C**********           MOVELC101      EUCO                     S01175 CSE022
     C                     MOVELC201      EUCO                            CSE022
     C                     END                                            S01175
     C***********          ELSE                                           S01175
     C***********          MOVE *BLANKS   EUCO                            S01175
     C                     END                                            S01175
     C*                                                                   S01175
     C***********          MOVE *BLANKS   ETPN                      S01175S01190
     C***********          MOVE *ZEROS    ETPR                      S01175S01190
     C***********          MOVE *ZEROS    ETPD                      S01175S01190
     C***********          MOVE *ZEROS    ETDT                      S01175S01190
     C***********          MOVE *BLANKS   ESPI                      S01175S01190
     C***********                                                   S01175E38340
     C****GET*TRADE*DETAILS*IF*ACROSS*BRIDGE*********************** S01175S01190
     C***********                                                         E38340
     C***********EUCL      IFEQ 'C'                                 S01175S01190
     C***********                                                   S01175E38340
     C*****SET*UP*TRADE*PRICE************************************** S01175S01190
     C***********          MOVE '.'       ETPN                      S01175S01190
     C***********          Z-ADDWTPDYI    ETPR                      S01175S01190
     C***********          MOVELWTPDYD    ETPD                      S01175S01190
     C***********                                                   S01175E38340
     C*****SET*UP*TRADE*DATE*************************************** S01175S01190
     C**********           Z-ADDTDDT      ZDAYNO                    S01175S01190
     C**********           EXSR ZDATE2                              S01175S01190
     C*********            Z-ADDZDATE     ETDT                      S01175S01190
     C***********                                                   S01175E38340
     C*****SET*UP*SPECIAL*INSTRUCTIONS***************************** S01175S01190
     C***********PCOD      IFEQ '5'                                 S01175S01190
     C***********          MOVE 'G'       ESPI                      S01175S01190
     C***********          ELSE                                     S01175S01190
     C***********          MOVE 'N'       ESPI                      S01175S01190
     C***********          END                                      S01175S01190
     C***********          END                                      S01175S01190
     C*                                                                   S01175
     C                     Z-ADD3         EUIT
     C*
     C***USE*ONLY*RIGHT*MOST*5*DIGITS*OF*TRDR*FOR*E/C*REF.*************   S01190
     C**********           MOVE TDRF      TEMP01                          S01190
     C**********           MOVE TEMP01    EURF                            S01190
     C**********           MOVE TDRF      TRDR                            S01190
     C***********                                                         E38340
     C******USE*OUR*EUROCLEAR*ACCOUNT*FOR*EURO.************************   S01175
     C***********                                                         E38340
     C***********          MOVELDLTO      CK1                             S01186
     C***********          MOVELDELT      CK1                             S01175
     C***********          EXSR CLINT1                                    S01175
     C***********          Z-ADD3         EUIN                            S01190
     C***********          MOVE ACTO      ACTC                            S01190
     C*
     C                     ADD  1         CECTLX
     C*                                                                   S01271
     C*  SET EUCLID PR TELEX INDICATOR                                    S01271
     C*                                                                   S01271
     C                     MOVE 'N'       EUTG                            S01271
     C*
     C                     SETON                         24
     C                     EXCPT
     C                     SETOF                         24
     C*
     C           EXTR10    ENDSR                           ** EXTR10 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR21 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 31 & 32
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*           ZDATE2
     C*           CLINTB
     C*           ZSDESC
     C*
     C*****************************************************************
     C*
     C           RSR21     BEGSR                           *** RSR21 ***
     C*
     C                     MOVE '31'      CTCD
     C                     Z-ADD31        CEIN
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C*  LOOK AT FUNGIBILITY INDICATORS FOR 'US' AND 'THEM' & A/C NO.
     C*
     C***********          MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C           C1CF      COMP 'F'                      84
     C*
     C***********          MOVELCEDL      CANS                            S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C*
     C***********          MOVELDLTO      CK1                             S01186
     C***********          MOVELDELT      CK1                             S01175
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELT      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C**N17******C1CF      COMP 'F'                      85               S01175
     C***17******          SETON                         85               S01175
     C           DLTOAT    IFEQ 2                                         S01175
     C           C1CF      COMP 'F'                      85               S01175
     C**********           MOVELC102      CANB                     S01175 CSE022
     C                     MOVELC202      CANB                            CSE022
     C                     ELSE                                           S01175
     C                     SETON                         85               S01175
     C**********           MOVELC101      CANB                     S01175 CSE022
     C                     MOVELC201      CANB                            CSE022
     C                     END                                            S01175
     C*
     C**N17******          MOVELCEDL      CANB                            S01175
     C***17******          MOVELEURO      CANB                            S01175
     C*
     C      84 85          Z-ADD0         FUCD
     C     N84N85          Z-ADD1         FUCD
     C     N84 85          Z-ADD2         FUCD
     C      84N85          Z-ADD3         FUCD
     C*
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR21
     C***********          MOVELDC02      DPTIN                           S01175
     C                     MOVE 'C'       DPTIN   1                       S01175
     C                     EXSR SECREF
     C************         MOVELDPTOUT    CEDL                            S01175
     C                     MOVE *BLANKS   CEDL                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C************         MOVELD1SR      CEDL                      S01175S01176
     C                     MOVELDASR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C************         MOVELD2SR      CEDL                      S01175S01176
     C                     MOVELDCSR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      CEDL                      S01175S01176
     C                     MOVELDDSR      CEDL                            S01176
     C                     END                                            S01175
     C*
     C                     Z-ADDTDVD      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     Z-ADDNOML      NOMI
     C                     MOVE ACTO      ACTC
     C                     MOVE TDRF      TRDR
     C*
     C*   GET THE CUSTOMER REPORT NAME FROM THE CLINT,CB RECORD
     C*      FOR EACH OF THE TWO SIDES IN THE TRADE
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLINTB
     C   U8                GOTO EXTR21
     C                     MOVE CRNM      CRNS
     C**********           MOVELDLTO      CK1                             S01186
     C**********           MOVELDELT      CK1                             S01175
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C                     EXSR CLINTB
     C   U8                GOTO EXTR21
     C                     MOVE CRNM      CRNB
     C*
     C**  BUILD A REPORT TITLE USING ZSDESC
     C                     MOVE SRPN      ZSRPN
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     CSRN
     C*
     C                     ADD  1         CCEDTX  50
     C*
     C                     SETON                         30
     C                     EXCPT
     C                     SETOF                         30
     C*
     C                     MOVE '32'      CTCD
     C                     Z-ADD31        CEIN
     C                     Z-ADD1         CSQN
     C                     MOVE 'O'       CMSG
     C                     MOVE 'FOR'     FOR
     C                     MOVE WTHFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         31
     C                     EXCPT
     C                     SETOF                         31
     C*
     C           EXTR21    ENDSR                           ** EXTR21 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR23 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 41 & 42
     C*              (Stock Telex) Executed for Trade Purchase or when*   E38340
     C*              the Counterparty is a Portfolio Customer.        *   E38340
     C*              When 'Deliver To' is Cedel AND                   *   E38340
     C*              'Deliver From' is Cedel or Euroclear.            *   E38340
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*           ZDATE2
     C*           CLINTB
     C*           ZSDESC
     C*
     C*****************************************************************
     C*
     C           RSR23     BEGSR                           *** RSR23 ***
     C*
     C                     MOVE '41'      CTCD
     C                     Z-ADD41        CEIN
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C*  LOOK AT FUNGIBILITY INDICATOR FOR C/PARTY
     C**********           MOVELDLFR      CK1                             S01186
     C**********           MOVELDELF      CK1                             S01175
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     EXSR CLIENT                                    E38340
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELF      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C           C1CF      COMP 'F'                      85
     C*
     C         85          Z-ADD0         FUCD
     C        N85          Z-ADD1         FUCD
     C*
     C**N17******          MOVELCEDL      CANS                            S01175
     C***17******          MOVELEURO      CANS                            S01175
     C           DLFRAT    IFEQ 2                                         S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C                     ELSE                                           S01175
     C***********          MOVE C101      CANS                     S01175 E16475
     C**********           MOVELC101      CANS                     E16475 CSE022
     C                     MOVELC201      CANS                            CSE022
     C                     END                                            S01175
     C*
     C***********          MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C***********          EXSR CLINT1                                    S01175
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLIENT                                    S01175
     C***********          MOVELCEDL      CANB                            S01175
     C**********           MOVELC102      CANB                     S01175 CSE022
     C                     MOVELC202      CANB                            CSE022
     C*
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR23
     C***********          MOVELDC02      DPTIN                           S01175
     C                     MOVE 'C'       DPTIN                           S01175
     C                     EXSR SECREF
     C***********          MOVELDPTOUT    CEDL                            S01175
     C                     MOVE *BLANKS   CEDL                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C***********          MOVELD1SR      CEDL                      S01175S01176
     C                     MOVELDASR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      CEDL                      S01175S01176
     C                     MOVELDCSR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      CEDL                      S01175S01176
     C                     MOVELDDSR      CEDL                            S01176
     C                     END                                            S01175
     C*
     C   43                Z-ADDCVIV      CDAM
     C   44      CVIV      DIV  10        CDAM
     C   45      CVIV      DIV  100       CDAM
     C   46      CVIV      DIV  1000      CDAM
     C*
     C*    GET THE CEDEL CCY NUMBER
     C                     Z-ADD1         U
     C           VCCY      LOKUPCCYZ,U                   66
     C                     Z-ADDCNAR,U    CURN
     C*
     C*     REFORMAT DATE
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     Z-ADDNOML      NOMI
     C                     MOVE ACTO      ACTC
     C                     MOVE TDRF      TRDR
     C*
     C*   GET THE CUSTOMER REPORT NAME FROM THE CLINT,CB RECORD
     C*      FOR EACH OF THE TWO SIDES IN THE TRADE
     C**********           MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLINTB
     C   U8                GOTO EXTR23
     C                     MOVE CRNM      CRNB
     C**********           MOVELDLFR      CK1                             S01186
     C**********           MOVELDELF      CK1                             S01175
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C                     EXSR CLINTB
     C   99                GOTO EXTR23
     C                     MOVE CRNM      CRNS
     C*
     C*    BUILD A REPORT TITLE USING ZSDESC
     C                     MOVE SRPN      ZSRPN
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     CSRN
     C*
     C                     MOVE SETC      CUCD
     C                     MOVE CAAR,U    CCCD
     C*    SET UP TRADE PRICE                                             S01175
     C                     Z-ADDWCPDY     CTPR                            S01175
     C*                                                                   S01175
     C*    SET UP TRADE DATE                                              S01175
     C                     Z-ADDTDDT      ZDAYNO                          S01175
     C                     EXSR ZDATE2                                    S01175
     C                     MOVELZDATE     CTDT                            S01175
     C*                                                                   S01175
     C*    SET UP SPECIAL INSTRUCTIONS                                    S01175
     C           PCOD      IFEQ '5'                                       S01175
     C                     MOVE 'G'       CGDL                            S01175
     C                     ELSE                                           S01175
     C                     MOVE 'N'       CGDL                            S01175
     C                     END                                            S01175
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         32
     C                     EXCPT
     C                     SETOF                         32
     C*
     C                     MOVE '42'      CTCD
     C                     Z-ADD41        CEIN
     C                     Z-ADD1         CSQN
     C                     MOVE 'O'       CMSG
     C                     MOVE 'FOR'     FOR
     C                     MOVE WTHFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         33
     C                     EXCPT
     C                     SETOF                         33
     C*
     C           EXTR23    ENDSR                           ** EXTR23 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR25 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 51 & 52
     C*              (Stock Telex) Executed for Trade Sale or when    *   E38340
     C*              the Counterparty is a Portfolio Customer.        *   E38340
     C*              When 'Deliver From' is Cedel AND                 *   E38340
     C*              'Deliver To' is Cedel or Euroclear.              *   E38340
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*           ZDATE2
     C*           CLINTB
     C*           ZSDESC
     C*
     C*****************************************************************
     C*
     C           RSR25     BEGSR                           *** RSR25 ***
     C*
     C                     MOVE '51'      CTCD
     C                     Z-ADD51        CEIN
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C*  LOOK AT FUNGIBILITY INDICATOR FOR C/PARTY
     C*
     C***********          MOVELDLTO      CK1                             S01186
     C***********          MOVELDELT      CK1                             S01175
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     EXSR CLIENT                                    E38340
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELT      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C           C1CF      COMP 'F'                      85
     C*
     C         85          Z-ADD0         FUCD
     C        N85          Z-ADD1         FUCD
     C*
     C**N17******          MOVELCEDL      CANB                            S01175
     C***17******          MOVELEURO      CANB                            S01175
     C           DLTOAT    IFEQ 2                                         S01175
     C**********           MOVELC102      CANB                     S01175 CSE022
     C                     MOVELC202      CANB                            CSE022
     C                     ELSE                                           S01175
     C***********          MOVE C101      CANB                     S01175 E16475
     C**********           MOVELC101      CANB                     E16475 CSE022
     C                     MOVELC201      CANB                            CSE022
     C                     END                                            S01175
     C*
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1                             S01175
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C**********           EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELCEDL      CANS                            S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C*
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR25
     C***********          MOVELDC02      DPTIN                           S01175
     C                     MOVE 'C'       DPTIN                           S01175
     C                     EXSR SECREF
     C***********          MOVELDPTOUT    CEDL                            S01175
     C                     MOVE *BLANKS   CEDL                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C***********          MOVELD1SR      CEDL                      S01175S01176
     C                     MOVELDASR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      CEDL                      S01175S01176
     C                     MOVELDCSR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      CEDL                      S01175S01176
     C                     MOVELDDSR      CEDL                            S01176
     C                     END                                            S01175
     C*
     C   43                Z-ADDCVIV      CDAM
     C   44      CVIV      DIV  10        CDAM
     C   45      CVIV      DIV  100       CDAM
     C   46      CVIV      DIV  1000      CDAM
     C*
     C*    GET THE CEDEL CCY NUMBER
     C                     Z-ADD1         U
     C           SETC      LOKUPCCYZ,U                   66
     C                     Z-ADDCNAR,U    CURN
     C*
     C*     REFORMAT DATE
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     Z-ADDNOML      NOMI
     C                     MOVE ACTO      ACTC
     C                     MOVE TDRF      TRDR
     C*
     C*   GET THE CUSTOMER REPORT NAME FROM THE CLINT,CB RECORD
     C*      FOR EACH OF THE TWO SIDES IN THE TRADE
     C*
     C***********          MOVELDLTO      CK1                             S01186
     C***********          MOVELDELT      CK1                             S01175
     C           DTFA      IFNE *BLANKS                                   S01175
     C                     MOVELDTFA      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C                     EXSR CLINTB
     C   U8                GOTO EXTR25
     C                     MOVE CRNM      CRNB
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLINTB
     C   U8                GOTO EXTR25
     C                     MOVE CRNM      CRNS
     C*
     C*    SET UP TRADE PRICE                                             S01175
     C                     Z-ADDWCPDY     CTPR                            S01175
     C*                                                                   S01175
     C*    SET UP TRADE DATE                                              S01175
     C                     Z-ADDTDDT      ZDAYNO                          S01175
     C                     EXSR ZDATE2                                    S01175
     C                     MOVELZDATE     CTDT                            S01175
     C*                                                                   S01175
     C*    SET UP SPECIAL INSTRUCTIONS                                    S01175
     C           PCOD      IFEQ '5'                                       S01175
     C                     MOVE 'G'       CGDL                            S01175
     C                     ELSE                                           S01175
     C                     MOVE 'N'       CGDL                            S01175
     C                     END                                            S01175
     C*
     C**   BUILD A REPORT TITLE USING ZSDESC
     C                     MOVE SRPN      ZSRPN
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     CSRN
     C*
     C                     MOVE SETC      CUCD
     C                     MOVE CAAR,U    CCCD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         34
     C                     EXCPT
     C                     SETOF                         34
     C*
     C                     MOVE '52'      CTCD
     C                     Z-ADD51        CEIN
     C                     Z-ADD1         CSQN
     C                     MOVE 'O'       CMSG
     C                     MOVE 'FOR'     FOR
     C                     MOVE WTHFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         35
     C                     EXCPT
     C                     SETOF                         35
     C*
     C           EXTR25    ENDSR                           ** EXTR25 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR27 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 61 & 62
     C*              (Stock Telex) Executed for Trade Purchase or when*   E38340
     C*              the Counterparty is a Portfolio Customer.        *   E38340
     C*              When 'Deliver To' is Cedel AND                   *   E38340
     C*              'Deliver From' is NOT Cedel or Euroclear.        *   E38340
     C*
     C***CALLS:***CLINT1***********************************************   E38340
     C*  CALLS:   CLIENT                                              *   E38340
     C*           CHNSEC
     C*           SECREF
     C*           ZDATE2
     C*           CLINTB
     C*           ZSDESC
     C*
     C*****************************************************************
     C*
     C           RSR27     BEGSR                           *** RSR27 ***
     C*
     C                     MOVE '61'      CTCD
     C                     Z-ADD61        CEIN
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C*  LOOK AT FUNGIBILITY INDICATOR FOR C/PARTY
     C***********          MOVELDLFR      CK1                             S01186
     C***********          MOVELDELF      CK1                             S01175
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     EXSR CLIENT                                    E38340
     C                     ELSE                                           S01175
     C           *IN61     IFEQ '0'                                       S01175
     C                     MOVELDELF      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C***********          EXSR CLINT1                                    S01175
     C                     EXSR CLIENT                                    S01175
     C                     END                                            S01175
     C           C1CF      COMP 'F'                      85
     C*
     C         85          Z-ADD0         FUCD
     C        N85          Z-ADD1         FUCD
     C*
     C*****N17**           MOVELCEDL      CANS                            S01175
     C******17             MOVELEURO      CANS                            S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C*
     C**********           MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C**********           EXSR CLINT1                                    S01175
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELCEDL      CANB                            S01175
     C**********           MOVELC102      CANB                     S01175 CSE022
     C                     MOVELC202      CANB                            CSE022
     C*
     C                     EXSR CHNSEC
     C   U8                GOTO EXTR27
     C***********          MOVELDC02      DPTIN                           S01175
     C                     MOVE 'C'       DPTIN                           S01175
     C                     EXSR SECREF
     C************         MOVELDPTOUT    CEDL                            S01175
     C                     MOVE *BLANKS   CEDL                            E14515
     C           DPTOUT    IFEQ 1                                         S01175
     C***********          MOVELD1SR      CEDL                      S01175S01176
     C                     MOVELDASR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 2                                         S01175
     C***********          MOVELD2SR      CEDL                      S01175S01176
     C                     MOVELDCSR      CEDL                            S01176
     C                     END                                            S01175
     C           DPTOUT    IFEQ 3                                         S01175
     C***********          MOVELD3SR      CEDL                      S01175S01176
     C                     MOVELDDSR      CEDL                            S01176
     C                     END                                            S01175
     C*
     C   43                Z-ADDCVIV      CDAM
     C   44      CVIV      DIV  10        CDAM
     C   45      CVIV      DIV  100       CDAM
     C   46      CVIV      DIV  1000      CDAM
     C*
     C*    GET THE CEDEL CCY NUMBER
     C                     Z-ADD1         U
     C           SETC      LOKUPCCYZ,U                   66
     C                     Z-ADDCNAR,U    CURN
     C*
     C*     REFORMAT DATE
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     Z-ADDNOML      NOMI
     C                     MOVE ACTO      ACTC
     C                     MOVE TDRF      TRDR
     C*
     C**  GET THE CUSTOMER REPORT NAME FROM THE CLINT,CB RECORD
     C**     FOR EACH OF THE TWO SIDES IN THE TRADE
     C*
     C***********          MOVELDLTO      CK1                             S01186
     C                     MOVELDELT      CK1
     C********** CK1       IFEQ 0                                                      E41705 CSD027
     C           CK1       IFEQ *BLANKS                                                       CSD027
     C           CK1       OREQ '000000'                                                    BUG11613
     C                     MOVELTCNR      CK1                             E41705
     C                     END                                            E41705
     C                     EXSR CLINTB
     C   U8                GOTO EXTR27
     C                     MOVE CRNM      CRNB
     C***********          MOVELDLFR      CK1                             S01186
     C***********          MOVELDELF      CK1                             S01175
     C           DFFA      IFNE *BLANKS                                   S01175
     C                     MOVELDFFA      CK1                             S01175
     C                     ELSE                                           S01175
     C                     MOVE TCNR      CK1                             S01175
     C                     END                                            S01175
     C                     EXSR CLINTB
     C   U8                GOTO EXTR27
     C                     MOVE CRNM      CRNS
     C*
     C**   BUILD A REPORT TITLE USING ZSDESC
     C                     MOVE SRPN      ZSRPN
     C                     EXSR ZSDESC
     C                     MOVE ZRNME     CSRN
     C*
     C                     MOVE SETC      CUCD
     C                     MOVE CAAR,U    CCCD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         36
     C                     EXCPT
     C                     SETOF                         36
     C*
     C                     MOVE '62'      CTCD
     C                     Z-ADD61        CEIN
     C                     Z-ADD0         CSQN
     C*
     C           PAYT      COMP *BLANKS                  66
     C   66                GOTO OVER6
     C                     MOVE 'L'       CMSG
     C                     ADD  1         CSQN
     C                     MOVELPYCLAT    CK1
     C                     MOVELPYCLZT    WFLD8                           E19949
     C                     EXSR CLINTB
     C   U8                GOTO EXTR27
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         37
     C                     EXCPT
     C                     SETOF                         37
     C*
     C           OVER6     TAG                             **  OVER6  **
     C           FACO      COMP *BLANKS                  66
     C   66                GOTO OVER7
     C                     MOVE 'M'       CMSG
     C                     ADD  1         CSQN
     C**********           MOVELFACO      FACONM  60                                          CSD027
     C                     MOVELFACO      FACONM  6                                           CSD027
     C                     MOVELFACONM    CK1
     C                     EXSR CLINTB
     C   U8                GOTO EXTR27
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         37
     C                     EXCPT
     C                     SETOF                         37
     C*
     C           OVER7     TAG                             **  OVER7  **
     C********** DLFR      COMP 0                        66               S01186
     C********** DELF      COMP 0                        66                                   CSD027
     C           DELF      COMP *BLANKS                  66                                   CSD027
     C********** DELF      COMP '000000'                 66                        BUG11613 BUG18053
     C  N66      DELF      COMP '000000'                 66                                 BUG18053
     C   66                GOTO EXTR27
     C                     MOVE 'N'       CMSG
     C                     ADD  1         CSQN
     C**********           MOVELDLFR      CK1                             S01186
     C                     MOVELDELF      CK1
     C                     EXSR CLINTB
     C   U8                GOTO EXTR27
     C                     MOVE NOTFOR    CWRD
     C*
     C                     ADD  1         CCEDTX
     C*
     C                     SETON                         37
     C                     EXCPT
     C                     SETOF                         37
     C*
     C           EXTR27    ENDSR                           ** EXTR27 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR31 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 10
     C*
     C*  CALLS:   ZDATE2
     C*           CLINTB
     C*           CLIENT                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR31     BEGSR                           *** RSR31 ***
     C*
     C                     MOVE '10'      CTCD
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C                     MOVELPYCLNT    CK1                             S01175
     C***********          EXSR CLINT1                                    S01175
     C***********          MOVELCEDL      CANS                            S01175
     C                     EXSR CLIENT                                    S01175
     C**********           MOVELC102      CANS                     S01175 CSE022
     C                     MOVELC202      CANS                            CSE022
     C*
     C   43                Z-ADDCVIV      CDAM
     C   44      CVIV      DIV  10        CDAM
     C   45      CVIV      DIV  100       CDAM
     C   46      CVIV      DIV  1000      CDAM
     C*
     C                     Z-ADD1         U
     C           SETC      LOKUPCCYZ,U                   66
     C                     Z-ADDCNAR,U    CURN
     C*
     C                     Z-ADDTDVD      ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     CSDT
     C*
     C                     MOVELPYCLNT    CK1
     C                     MOVELPYCLZT    WFLD8                           E19949
     C                     EXSR CLINTB
     C   U8                GOTO EXTR31
     C                     MOVE CRNM      RBEN
     C                     MOVE SETC      CUCD
     C*
     C                     ADD  1         CCEDCS  50
     C*
     C                     SETON                     26
     C                     EXCPT
     C                     SETOF                     26
     C*
     C           EXTR31    ENDSR                           ** EXTR31 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR32 S/R - TO PERFORM SETUP AND OUTPUT OF CEDEL TYPE 12
     C*
     C*  CALLS:   CLINTB
     C*
     C*****************************************************************
     C*
     C           RSR32     BEGSR                           *** RSR32 ***
     C*
     C                     MOVE '12'      CTCD
     C                     MOVE TDRF      CTNO
     C                     MOVE BCSA      BRCA                            S01117
     C*
     C                     Z-ADDCANS      CANS
     C*
     C                     Z-ADD1         CSQN
     C                     MOVE 'O'       CMSG
     C           PYFM      IFNE *BLANK
     C                     MOVELPYCLNF    CK1
     C                     MOVELPYCLZF    WFLD8                           E19949
     C                     EXSR CLINTB
     C   U8                GOTO EXTR32
     C                     MOVE *BLANKS   CWRD
     C                     MOVELCRNM      CWRD
     C                     ELSE
     C                     MOVE *BLANKS   CWRD
     C                     END
     C*
     C                     ADD  1         CCEDCS  50
     C*
     C                     SETON                     27
     C                     EXCPT
     C                     SETOF                     27
     C*
     C           EXTR32    ENDSR                           ** EXTR32 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR36 S/R - TO PERFORM SETUP AND OUTPUT OF A RECORD TO
     C*              S/NOTLX
     C*
     C*  CALLED FROM:   MAIN
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR36     BEGSR                           *** RSR36 ***
     C*
     C*  IF TRADE REFERENCE IS SAME AS PREVIOUS THEN SUPPRESS OUTPUT.
     C*
     C           TDRF      COMP TRDRP                2020
     C  N20                GOTO EXTR36
     C                     MOVE TDRF      TRDRP   6
     C*
     C***********          MOVE 'D'       RECI                            S01269
     C*
     C*     MOVE DATA TO OUTPUT FIELDS
     C*
     C                     MOVE TDRF      TRDR
     C                     MOVE TDMI      MARK
     C***********          Z-ADDBCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C                     MOVE TINC      INCI
     C                     MOVE ACTO      ACTC
     C                     ADD  1         CNOTLX  50
     C*
     C                     SETON                     20
     C                     EXCPT
     C                     SETOF                     20
     C*
     C           EXTR36    ENDSR                           ** EXTR36 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR37 S/R - TO PERFORM SETUP AND OUTPUT OF A RECORD TO
     C*              S/STPR2
     C*
     C*  CALLED FROM:   MAIN
     C*  CALLS:   ZZADD                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR37     BEGSR                           *** RSR37 ***
     C*
     C                     MOVE 'D'       RECI
     C*
     C*    OURS/THEIRS FROM PAY TO/FROM (OR SAVED FIELDS IF RETAIL A/CS)
     C*
     C                     SETOF                     66
     C***60******          SETON                     66                   S01175
     C           TDTP      IFEQ 'TP'                                      S01175
     C                     SETON                     66                   S01175
     C                     END                                            S01175
     C   66NL1             MOVELPAYT      THEIRS
     C   66 L1             MOVELL1SAVE    THEIRS
     C   66NL2             MOVELPYFM      OURS
     C   66 L2             MOVELL2SAVE    OURS
     C*
     C   66                GOTO R37T1
     C*
     C     NL1             MOVELPAYT      OURS
     C      L1             MOVELL1SAVE    OURS
     C     NL2             MOVELPYFM      THEIRS
     C      L2             MOVELL2SAVE    THEIRS
     C                     MOVE *BLANKS   FACO
     C           R37T1     TAG                             ** R37T1 **
     C*
     C**  MOVE DATA TO OUTPUT FIELDS
     C*
     C***********          MOVE BCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C                     MOVE SMTH      SETL
     C                     MOVE SETC      VCCY
     C                     MOVE TDVD      VDAT
     C                     MOVE ACTO      ACTC
     C                     MOVE TDRF      TRDR
     C                     MOVE TDSS      SECS
     C                     MOVE TCNR      CLNT
     C*
     C**  IF TRADE TYPE IS 'TS' THEN TELEX IS FOR A SALE;
     C**  THEREFORE 'P Y I N' IS 'R'.
     C*
     C           TRTP      COMP 'TS'                     66
     C*
     C   66                MOVE 'R'       PYIN    1
     C  N66                MOVE 'P'       PYIN
     C*
     C*    HASH TOTAL FILE CONTROL
     C*
     C                     Z-ADDHSTA02    ZZTOTI
     C                     Z-ADDHSTB02    ZZTOTD
     C           CVIV      DIV  1000      ZZAMT
     C*
     C                     EXSR ZZADD
     C*
     C                     Z-ADDZZTOTI    HSTA02 150
     C                     Z-ADDZZTOTD    HSTB02  30
     C*
     C                     ADD  1         CSTPR2  50
     C*
     C                     SETON                     16
     C                     EXCPT
     C                     SETOF                     16
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  RSR38 S/R - TO PERFORM SETUP AND OUTPUT OF A RECORD TO
     C*              S/OTHST                                              S01176
     C******************S/INSTR****************************************   S01176
     C*
     C*  CALLED FROM:   MAIN
     C*  CALLS:   CHNSEC                                              *   E38340
     C*           SECREF                                              *   E38340
     C*           CLIENT                                              *   E38340
     C*
     C*****************************************************************
     C*
     C           RSR38     BEGSR                           *** RSR38 ***
     C*
     C*****CHAIN*TO*S/SECUR*FOR*FNAM*AND*S/TABLETR*FOR*BRANCH*NAME*****   S01176
     C*    CHAIN TO S/SECUR FOR FNAM                                      S01176
     C*
     C                     EXSR CHNSEC
     C***********          Z-ADD10        BCH10                           S01176
     C**NU7******          EXSR BCHCHN                                    S01176
     C*                                                                   S01176
     C*    GET SECURITY REFERENCE AT DEPOT                                S01176
     C*                                                                   S01176
     C  NU7                MOVEL'X'       DPTIN                           S01176
     C  NU7                EXSR SECREF                                    S01176
     C*                                                                   S01176
     C   U7                GOTO R38TZ
     C*
     C*    MOVE DATA TO OUTPUT FIELDS
     C*
     C***********          MOVE BCHS      BRCD                            S01176
     C***********          MOVE TDRF      TRDR                            S01176
     C***********          MOVE TDTP      TRTP                            S01176
     C***********          MOVE TDDT      TRDD                            S01176
     C***********          MOVE PCOD      PYCD                            S01176
     C***********          MOVE SETC      VCCY                            S01176
     C***********          MOVE TDVD      VDAT                            S01176
     C***********          MOVE NOML      NOMI                            S01176
     C***********          MOVE TCNR      CLNT                            S01176
     C***********          MOVE SRPN      FNAM                            S01176
     C***********          MOVE DELF      DLFR                            S01176
     C***********          MOVE DELT      DLTO                            S01176
     C*                                                                   S01176
     C* BRANCH CODE                                                       S01176
     C***********          MOVE BCHS      BRCD                            S01117
     C                     MOVE BCSA      BRCA                            S01117
     C*                                                                   S01176
     C* OUR DEPOT, COUNTERPARTY DEPOT, FOR THE ACCOUNT OF,                S01176
     C* DELIVER/RECEIVE INDICATOR                                         S01176
     C           TDTP      IFEQ 'TP'                                      S01176
     C                     MOVELDELT      OUDP                            S01176
     C*********************MOVELDELF      CDTN                      S01176E23697
     C**                                                                  E23697
     C*  For Purchases "Against Payment" the reported C/party depot       E23697
     C*      is to whom the payment is due. For "Free" delivery its       E23697
     C*      the Deliver from depot.                                      E23697
     C**                                                                  E23697
     C           PCOD      IFEQ '1'                                       E23697
     C           PCOD      OREQ '5'                                       E23697
     C                     MOVELPAYT      CDTN                            E23697
     C                     MOVELPAYT      SIX     6                       E23697
     C**********           TESTN          SIX        70                                E23697 CSD027
     C********** *IN70     IFNE '1'                                                    E23697 CSD027
     C                     MOVELPAYT      PAYNOS                          E23697
     C**********           END                                                         E23697 CSD027
     C           TDFA      IFNE *BLANK                                    E23697
     C*                                                                   071476
     C** TDFA may be a counterparty Nostro,ie non numeric if it           071476
     C** is use counterparty customer no as for account of.               071476
     C*                                                                   071476
     C* Check whether the TDFA is C Party Nostro                                              CSD027
     C                     CALL 'AOCNSTR0'                                                    CSD027
     C                     PARM '*MSG   ' @RTCD   7                                           CSD027
     C                     PARM '*KEY   ' @OPTN   7                                           CSD027
     C                     PARM TDFA      @ARCD   8                                           CSD027
     C           SDCNST    PARM SDCNST    DSFDY                                               CSD027
     C*                                                                                       CSD027
     C***********          MOVELTDFA      WRK6A   6                       071476              CSD027
     C***********          MOVELWRK6A     WRK7    70                      071476              CSD027
     C***********          MOVELWRK7      WRK6B   6                       071476              CSD027
     C***********WRK6A     IFEQ WRK6B                                     071476              CSD027
     C           @RTCD     IFEQ *BLANK                                                        CSD027
     C                     MOVELTDFA      FAON                            E23697
     C                     ELSE                                           071476
     C                     MOVELTCNR      FAON                            071476
     C                     ENDIF                                          071476
     C*                                                                   071476
     C                     ELSE                                           E23697
     C                     MOVELTCNR      FAON                            E23697
     C                     END                                            E23697
     C                     ELSE                                           E23697
     C** Free Delivery                                                    E23697
     C*                                                                   E23697
     C                     MOVELDELF      CDTN                            E23697
     C           DFFA      IFNE *BLANK                                    S01176
     C                     MOVELDFFA      FAON                            S01176
     C                     ELSE                                           S01176
     C                     MOVELTCNR      FAON                            S01176
     C                     END                                            S01176
     C                     END                                            E23697
     C                     MOVEL'R'       DERE                            S01176
     C                     ELSE                                           S01176
     C                     MOVELDELF      OUDP                            S01176
     C                     MOVELDELT      CDTN                            S01176
     C           DTFA      IFNE *BLANK                                    S01176
     C                     MOVELDTFA      FAON                            S01176
     C                     ELSE                                           S01176
     C                     MOVELTCNR      FAON                            S01176
     C                     END                                            S01176
     C                     MOVEL'D'       DERE                            S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C* MOVEMENT ORIGIN                                                   S01176
     C                     Z-ADD1         MOVO                            S01176
     C*                                                                   S01176
     C* VALUE DATE                                                        S01176
     C                     Z-ADDTDVD      VALD                            S01176
     C*                                                                   S01176
     C* SECURITY REFERENCE                                                S01176
     C           DPTOUT    IFEQ 0                                         S01176
     C                     MOVEL*BLANK    SCYR                            S01176
     C                     END                                            S01176
     C           DPTOUT    IFEQ 1                                         S01176
     C                     MOVELDASR      SCYR                            S01176
     C                     END                                            S01176
     C           DPTOUT    IFEQ 2                                         S01176
     C                     MOVELDCSR      SCYR                            S01176
     C                     END                                            S01176
     C           DPTOUT    IFEQ 3                                         S01176
     C                     MOVELDDSR      SCYR                            S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C* SECURITY SHORTNAME                                                S01176
     C                     MOVELTDSS      SCSN                            S01176
     C*                                                                   S01176
     C* COUNTERPARTY DEPOT REFERENCE                                      S01176
     C           OUDP      IFNE CDTN                                      S01176
     C                     MOVELOUDP      CK1                             S01176
     C                     EXSR CLIENT                                    S01176
     C   U7                GOTO R38TZ                                     S01176
     C*                                                                   S01176
      ** If the feature CSE022 is present, the module SEDORFRTV is used   CSE022
      ** to setup the Counter Party Depot Reference and 'For the A/C      CSE022
      ** of' reference.                                                   CSE022
      *                                                                   CSE022
     C           CSE022    IFEQ 'N'                                       CSE022
     C                     Z-ADD1         ZX      20                      S01176
     C           CDTN      LOKUPDAR,ZX                   99               S01176
     C  N99                MOVEL*BLANK    CDTR                            S01176
     C   99                MOVELODR,ZX    CDTR                            S01176
     C*                                                                   S01176
     C                     ELSE                                           CSE022
      *                                                                   CSE022
     C                     MOVEL'SEDOR'   WPGM    9                       CSE022
     C                     MOVE 'FRTV'    WPGM                            CSE022
     C**********           Z-ADDCDTN      WCDTN   60                                   CSE022 CSD027
     C                     MOVE CDTN      WCDTN   6                                           CSD027
     C                     MOVELWCDTN     PDEPOT                          CSE022
     C                     MOVELCNUM      PCNUM                           CSE022
      *                                                                   CSE022
     C                     CALL WPGM                                      CSE022
     C                     PARM *BLANKS   PRTCD  10                       CSE022
     C                     PARM           PDEPOT  6                       CSE022
     C                     PARM           PCNUM   6                       CSE022
     C                     PARM *BLANKS   PSKALR 20                       CSE022
      *                                                                   CSE022
     C           PRTCD     IFEQ '*ERROR'                                                   BUG27939A
     C                     SETON                     U7U8LR                                BUG27939A
     C           *LOCK     IN   LDA                                                        BUG27939A
     C                     MOVE WPGM      DBFILE                                           BUG27939A
     C                     MOVELPCNUM     DBKEY                                            BUG27939A
     C                     Z-ADD36        DBASE                                            BUG27939A
     C                     OUT  LDA                                                        BUG27939A
     C                     EXSR *PSSR                                                      BUG27939A
      *                                                                                    BUG27939A
     C                     ELSE                                                            BUG27939A
     C                     MOVELPSKALR    CDTR                            CSE022
     C                     ENDIF                                                           BUG27939A
      *                                                                                    BUG27939A
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     ELSE                                           S01176
     C                     MOVE *BLANK    CDTR                            S01176
     C                     END                                            S01176
     C*                                                                   S01176
     C* FOR ACCOUNT OF REFERENCE                                          S01176
     C                     MOVELFAON      CK1                             S01176
     C                     MOVEL'Y'       NODEBE                          090903
     C                     EXSR CLIENT                                    S01176
     C                     MOVEL' '       NODEBE                          090903
     C   U7                GOTO R38TZ                                     S01176
     C*                                                                   S01176
     C           CSE022    IFEQ 'N'                                       CSE022
     C                     Z-ADD1         ZX                              S01176
     C           CDTN      LOKUPDAR,ZX                   99               S01176
     C  N99                MOVEL*BLANK    FAOR                            S01176
     C   99                MOVELODR,ZX    FAOR                            S01176
     C                     SETOF                     99                   E19949
     C                     ELSE                                           CSE022
      *                                                                   CSE022
     C                     MOVEL'SEDOR'   WPGM    9                       CSE022
     C                     MOVE 'FRTV'    WPGM                            CSE022
     C**********           Z-ADDCDTN      WCDTN   60                                   CSE022 CSD027
     C                     MOVE CDTN      WCDTN   6                                           CSD027
     C                     MOVELWCDTN     PDEPOT                          CSE022
     C                     MOVELCNUM      PCNUM                           CSE022
      *                                                                   CSE022
     C                     CALL WPGM                                      CSE022
     C                     PARM *BLANKS   PRTCD                           CSE022
     C                     PARM           PDEPOT                          CSE022
     C                     PARM           PCNUM                           CSE022
     C                     PARM *BLANKS   PSKALR                          CSE022
      *                                                                   CSE022
     C           PRTCD     IFEQ '*ERROR'                                                   BUG27939A
     C                     SETON                     U7U8LR                                BUG27939A
     C           *LOCK     IN   LDA                                                        BUG27939A
     C                     MOVE WPGM      DBFILE                                           BUG27939A
     C                     MOVELPCNUM     DBKEY                                            BUG27939A
     C                     Z-ADD37        DBASE                                            BUG27939A
     C                     OUT  LDA                                                        BUG27939A
     C                     EXSR *PSSR                                                      BUG27939A
      *                                                                                    BUG27939A
     C                     ELSE                                                            BUG27939A
     C                     MOVELPSKALR    FAOR                            CSE022
     C                     ENDIF                                                           BUG27939A
      *                                                                                    BUG27939A
     C                     ENDIF                                          CSE022
     C*                                                                   S01176
     C* PAY CODE                                                          S01176
     C           SMTH      IFNE 0                                         E23697
     C                     MOVELPCOD      PAYC                            S01176
     C                     ELSE                                           E23697
     C                     MOVE '0'       PAYC                            E23697
     C                     END                                            E23697
     C*                                                                   S01176
     C* MOVEMENT TYPE                                                     S01176
     C                     MOVEL*BLANK    DPMV                            S01176
     C*                                                                   S01176
     C* CASH AMOUNT                                                       S01176
     C                     Z-ADDCVIV      CASA                            S01176
     C*                                                                   S01176
     C* VALUE CURRENCY                                                    S01176
     C                     MOVELSETC      VCCY                            S01176
     C*                                                                   S01176
     C                     MOVE 'D'       RECI                            S01176
     C***********          ADD  1         CINSTR  50                      S01176
     C                     ADD  1         COTHST  50                      S01176
     C*
     C*****HASH*TOTAL*FILE*CONTROL*************************************   S01176
     C***********                                                         S01176
     C***********          Z-ADDHSTAIN    ZZTOTI                          S01176
     C***********          Z-ADDHSTBIN    ZZTOTD                          S01176
     C***********NOMI      DIV  1000      ZZAMT                           S01176
     C***********                                                         S01176
     C***********          EXSR ZZADD                                     S01176
     C***********                                                         S01176
     C***********          Z-ADDZZTOTI    HSTAIN 150                      S01176
     C***********          Z-ADDZZTOTD    HSTBIN  30                      S01176
     C*
     C                     SETON                     22
     C                     EXCPT
     C                     SETOF                     22
     C*
     C           R38TZ     ENDSR                           ***  R38TZ  ***
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  BCHCHN S/R - TO CHAIN FOR A BRANCH CODES TABLE RECORD
     C*
     C*  CALLED FROM:   RSR38
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           BCHCHN    BEGSR                           *** BCHCHN ***
     C*
     C           BCHKEY    CHAINTABSE                99
     C  N99      RECI      COMP '*'                      99
     C  N99                GOTO EXITBH
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE'   DBFILE
     C                     MOVELBCHKEY    DBKEY            ***************
     C                     Z-ADD14        DBASE            * DB ERROR 14 *
     C*                                                    ***************
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C           EXITBH    ENDSR                           ** EXITBH **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  NOSCHN S/R - TO CHAIN FOR A NOSTRO CODES TABLE RECORD
     C*
     C*  CALLED FROM:   MAIN
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           NOSCHN    BEGSR                           *** NOSCHN ***
     C*
     C           NOSKEY    CHAINTABSE                99
     C  N99      RECI      COMP '*'                      99
     C  N99                GOTO EXITNS
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE'   DBFILE
     C************         MOVELNOSKEY    DBKEY            ***************E20651
     C************         Z-ADD09        DBASE            **DB*ERROR*09**E20651
     C                     MOVELNOSKEY    DBKEY            ***************E20651
     C                     Z-ADD19        DBASE            * DB ERROR 19 *E20651
     C*                                                    ***************
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C           EXITNS    ENDSR                           ** EXITNS **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  FIRST  - SR. TO PERFORM ESSENTIAL FIRST CYCLE PROCESSING.
     C*
     C*  CALLED FROM:   MAIN
     C*  CALLS:   ZSYSTM
     C*
     C*****************************************************************
     C*
     C           FIRST     BEGSR                           *** FIRST ***
     C*
     C****GET*IN*ICD*10************************************************   S01117
     C*                                                                   S01117
     C*  PREPARE LDA                                                      S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL*BLANK    DBLOT                           S01117
     C                     MOVEL'SE0420  'DBPGM
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C**  GET IN ICD 10                                                   S01117
     C                     EXSR ZSYSTM
     C  N99                GOTO TAGF1
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE '  DBFILE
     C                     MOVE ZTABKY    DBKEY            ***************
     C                     Z-ADD10        DBASE            * DB ERROR 10 *
     C                     GOTO EXITF                      ***************
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C           TAGF1     TAG                             ** TAGF1 **
     C*
     C                     Z-ADDRUND      EUDT
     C*                                                                   050501
     C** Access ICD2                                                      050501
     C*                                                                   050501
     C                     EXSR ZICD2                                     050501
     C*                                                                   050501
     C           *IN99     IFEQ '1'                                       050501
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE '  DBFILE                          050501
     C                     MOVE ZTABKY    DBKEY            ***************050501
     C                     Z-ADD11        DBASE            * DB ERROR 11 *050501
     C                     OUT  LDA                        ***************050501
     C                     EXSR *PSSR                                     050501
     C                     MOVE '1'       *INU7                           050501
     C                     MOVE '1'       *INU8                           050501
     C                     MOVE '1'       *INLR                           050501
     C                     END                                            050501
     C*                                                                   S01271
     C*    INPUT CYCLE / CLOSE OF BUSINESS PARAMETER                      S01271
     C*                                                                   S01271
     C           *ENTRY    PLIST                                          S01271
     C                     PARM           PRPHAS  1                       S01271
     C                     PARM           SEQ     5                       S01117
     C           PRPHAS    IFEQ 'I'                                       S01271
     C                     SETOF                     81                   S01271
     C                     TIME           CTIME                           S01271
     C                     MOVE ':  '     ATIME   5                       S01271
     C                     MOVE CMINT     ATIME                           S01271
     C                     MOVELCHOUR     ATIME                           S01271
     C                     ELSE                                           S01271
     C                     SETON                     81                   S01271
     C                     END                                            S01271
     C*                                                                   S01271
     C                     Z-ADD0         COTHST  50                      S01271
      *                                                                                       CSE035
      ** Access SAR details file to see if CSE035 is installed                                CSE035
      *                                                                                       CSE035
     C                     CALL 'AOSARDR0'                                                    CSE035
     C                     PARM *BLANKS   @RTCD   7                                           CSE035
     C                     PARM '*VERIFY' @OPTN   7                                           CSE035
     C                     PARM 'CSE035'  @SARD   6                                           CSE035
      *                                                                                       CSE035
     C           @RTCD     IFEQ *BLANK                                                        CSE035
     C                     MOVE 'Y'       CSE035  1                                           CSE035
     C                     ELSE                                                               CSE035
     C                     MOVE 'N'       CSE035                                              CSE035
     C                     ENDIF                                                              CSE035
      *                                                                                       CSE035
      ** Access Switchable Features file to determine if CSE031 is                          MD057247
      ** installed in the system.                                                           MD057247
      *                                                                                     MD057247
     C                     CALL 'AOSARDR0'                                                  MD057247
     C                     PARM           URTNCD  7                                         MD057247
     C                     PARM '*VERIFY' UOPTN   7                                         MD057247
     C                     PARM 'CSE031'  UUKEY   6                                         MD057247
     C                     PARM           UDSFDY 76                                         MD057247
      *                                                                                     MD057247
     C                     MOVE 'N'       CSE031  1                                         MD057247
     C           URTNCD    IFEQ *BLANKS                                                     MD057247
     C                     MOVE 'Y'       CSE031                                            MD057247
     C                     ENDIF                                                            MD057247
      *                                                                                     MD057247
      ** Access Switchable Features file to determine if CSE071 is                          MD057247
      ** installed in the system.                                                           MD057247
      *                                                                                     MD057247
     C                     CALL 'AOSARDR0'                                                  MD057247
     C                     PARM           URTNCD                                            MD057247
     C                     PARM '*VERIFY' UOPTN                                             MD057247
     C                     PARM 'CSE071'  UUKEY                                             MD057247
     C                     PARM           UDSFDY                                            MD057247
      *                                                                                     MD057247
     C                     MOVE 'N'       CSE071  1                                         MD057247
     C           URTNCD    IFEQ *BLANKS                                                     MD057247
     C                     MOVE 'Y'       CSE071                                            MD057247
     C                     ENDIF                                                            MD057247
      *                                                                                     MD057247
     C*
     C/COPY WNCPYSRC,SE0420C001
     C           EXITF     ENDSR                            ** EXITF **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *   E38340
     C*  Subroutine made redundant in July 1988                       *   E38340
     C*                                                               *   E38340
     C*****REQUT*S/R*-*TO*SET*UP*THE*REQUEST*DETAILS*FOR*EACH*PARTY**:*   S01175
     C*****************IN*THE*SETTLEMENT*(BITS 3, 7)****************: *   S01175
     C*                                                               *
     C*****************************************************************
     C***********                                                         S01175
     C***********REQUT     BEGSR                                          S01175
     C***********          ENDSR                                          S01175
     C***********                                                         E38340
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  FREE S/R - TO CONTROL TELEX PRODUCTION FOR TRADES FREE OF
     C*             PAYMENT
     C*
     C*****************BIT*0*-*EUROCLEAR*-*PARTY*IS*CLEARING*HOUSE*ACCOUNTS01175
     C*********************1*-*****"*****-*PARTY*IS*PARTICIPANT********   S01175
     C*********************2*-*****"*****-*PARTY*HAS*NON-ZERO*REFERENCE   S01175
     C*********************3*-*****"*****-*FORMATTED*TELEX*REQUESTED***   S01175
     C*****************************************************************   E38340
     C*****************BIT*4*-*CEDEL*-*PARTY*IS*CLEARING*HOUSE*ACCOUNT*   S01175
     C*********************5*-***"***-*PARTY*IS*PARTICIPANT***********:   S01175
     C*********************6*-***"***-*PARTY*HAS*NON-ZERO*REFERENCE****   S01175
     C*********************7*-***"***-*FORMATTED*TELEX*REQUESTED*******   S01175
     C*                                                                   S01175
     C*           1  -  PARTY IS DEPOT AT EUROCLEAR                       S01175
     C*           2  -  PARTY IS DEPOT AT CEDEL                           S01175
     C*           3  -  PARTY IS DEPOT AT KASSENVEREIN                    S01175
     C*           4  -  PARTY IS NONE OF ABOVE                            S01175
     C*                                                               *   E38340
     C*  CALLS:   RSR01/02/03/05/06/07/08/09/10/13/14/31/32/33/34/35  *   E38340
     C*           RSRN1/N2/N3/N4/N5/N7                                *   E38340
     C************RSR21/29*********************************************   E38340
     C*
     C*****************************************************************
     C*
     C           FREE      BEGSR
     C*
     C*   CASH TELEX PRODUCED BY BUYER FOR PURCHASE, SO IF MARKET SALE NO
     C*   TELEX OF THIS TYPE PRODUCED
     C****UNLESS*COUNTERPARTY*IS*A*PORTFOLIO*CLIENT*************** S01175 E38340
     C***********                                                         E38340
     C**N60*61***          GOTO FREE01                                    S01175
      *                                                                   E38340
     C           TDTP      IFEQ 'TP'                                      S01175
     C************IN61     OREQ '0'                               S01175  E14219
     C*
     C*   IF 'PAY FROM' IS NOT A CLEARING HOUSE ACCOUNT AT EITHER
     C*   EUROCLEAR OR CEDEL, OUTPUT TO S/UNFOR
     C*
     C           PYFRAT    IFGE 3                                         S01175
     C                     EXSR RSR35                                     S01175
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF BOTH 'PAY FROM' AND 'PAY TO' ARE DEPOTS AT EUROCLEAR         S01175
     C*   PRODUCE 'BOOK TRANSFER'                                         S01175
     C*                                                                   S01175
     C           PYFRAT    IFEQ 1                                         S01175
     C           PYTOAT    ANDEQ1                                         S01175
     C                     EXSR RSR03                                     S01175
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF 'PAY FROM' IS A EUROCLEAR DEPOT AND 'PAY TO' IS              S01175
     C*   NOT,  PRODUCE 'WIRE TRANSFER'                                   S01175
     C*                                                                   S01175
     C           PYFRAT    IFEQ 1                                         S01175
     C           PYTOAT    ANDGT1                                         S01175
     C                     EXSR RSR01                                     S01175
     C                     END                                            S01175
     C***********          TESTB'03'      PYFRAT     70                   S01175
     C***70******          TESTB'47'      PYFRAT     70                   S01175
     C***70******          EXSR RSR35                                     S01175
     C***70******          GOTO FREE01                                    S01175
     C*
     C*IF 'PAY FROM' IS A CLEARING HOUSE ACCOUNT AT CEDEL, PRODUCE '90'
     C*
     C           PYFRAT    IFEQ 2                                         S01175
     C                     EXSR RSR33                                     S01175
     C  NU8                EXSR RSR34                                     S01175
     C                     END                                            S01175
     C*********************END                                     S01175 S01190
     C**                                                                  S01190
     C**  IF 'DELIVER TO' IS A DEPOT AT EUROCLEAR                         S01190
     C**                                                                  S01190
     C           DLTOAT    IFEQ 1                                         S01190
     C**                                                                  S01190
     C**  AND 'DELIVER FROM' IS A DEPOT AT EUROCLEAR, PRODUCE TYPE '01'   S01190
     C**  INSTR. AS ECTYP01, TRDDETL AND NARR.                            S01190
     C           DLFRAT    IFEQ 1                                         S01190
     C                     EXSR RSR05                                     S01190
     C                     EXSR RSR06                                     S01190
     C                     EXSR RSRN1                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C**                                                                  S01190
     C**  OTHERWISE PRODUCE TYPE '03' TELEX                               S01190
     C**                                                                  S01190
     C                     ELSE                                           S01190
     C                     EXSR RSR09                                     S01190
     C                     EXSR RSR10                                     S01190
     C                     EXSR RSRN5                                     S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C**  IF ACROSS BRIDGE ('DELIVER FROM' IS CEDEL) INCLUDE TRADE        S01190
     C**  DETAILS AND NARRATIVE                                           S01190
     C**                                                                  S01190
     C           DLFRAT    IFEQ 2                                         S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C***********          TESTB'47'      PYFRAT         70               S01175
     C***70******          EXSR RSR33                                     S01175
     C***70NU8***          EXSR RSR34                                     S01175
     C***70******          GOTO FREE01                                    S01175
     C***********                                                         E38340
     C****IF*'PAY*FROM'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*EUROCLEAR*&*'PAY   S01175
     C****TO'*IS*PARTICIPANT*AT*EUROCLEAR,*PRODUCE*'BOOK*TRANSFER'*****   S01175
     C***********                                                         E38340
     C***********          TESTB'03'      PYFRAT         70               S01175
     C***70******          TESTB'13'      PYTOAT         70               S01175
     C***70******          EXSR RSR03                                     S01175
     C***70******          GOTO FREE01                                    S01175
     C***********                                                         E38340
     C****IF*'PAY*FROM'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*EUROCLEAR*&*'PAY   S01175
     C****TO'*IS*NOT*PARTICIPANT*AT*EUROCLEAR,*PRODUCE*'WIRE*TRANSFER'*   S01175
     C***********                                                         E38340
     C***********          TESTB'03'      PYFRAT         70               S01175
     C***70******          EXSR RSR01                                     S01175
     C*
     C**  IF TRADE IS OWN ACCOUNT TRANSFER                                S01190
     C*                                                                   S01190
     C           *IN61     IFEQ '0'                                       S01190
     C*                                                                   S01190
     C* IF DEL. FR. AND DEL. TO ARE BOTH EUROCLEAR PRODUCE TYPE '02'      S01190
     C*                                                                   S01190
     C           DLFRAT    IFEQ 1                                         S01190
     C           DLTOAT    ANDEQ1                                         S01190
     C                     EXSR RSR07                                     S01190
     C                     EXSR RSR08                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C* IF DEL. FR. IS EUROCLEAR AND DEL. TO IS CEDEL PRODUCE TYPE '07'   S01190
     C*                                                                   S01190
     C           DLFRAT    IFEQ 1                                         S01190
     C           DLTOAT    ANDEQ2                                         S01190
     C                     EXSR RSR13                                     S01190
     C  NU8                EXSR RSR14                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C                     END                                            S01190
     C**                                                                  S01190
     C***********FREE01    TAG                             ** FREE01 **   S01175
     C*
     C   U8                GOTO FREE99
     C*
     C*   CASH TELEX PRODUCED BY SELLER FOR SALE, SO IF MARKET PURCHASE
     C*   NO TELEX OF THIS TYPE PRODUCED
     C****UNLESS*COUNTERPARTY*IS*A*PORTFOLIO*CLIENT*************** S01175 E38340
     C*
     C           TDTP      IFEQ 'TS'                                      S01175
      *                                                                   E38340
     C************IN61     OREQ '0'                               S01175  E14219
     C***60*61***          GOTO FREE02                                    S01175
     C**                                                                  S01190
     C**  IF TRADE IS OWN ACCOUNT TRANSFER ...                            S01190
     C*                                                                   S01190
     C           *IN61     IFEQ '0'                                       S01190
     C*                                                                   S01190
     C**  AND 'DEL. TO' + 'DEL FROM' ARE BOTH EUROCLEAR.                  S01190
     C**  PRODUCE TYPE '01'                                               S01190
     C**                                                                  S01190
     C           DLFRAT    IFEQ 1                                         S01190
     C           DLTOAT    ANDEQ1                                         S01190
     C                     EXSR RSR05                                     S01190
     C                     EXSR RSR06                                     S01190
     C                     EXSR RSRN1                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01190
     C**  AND 'DEL. TO' IS EUROCLEAR AND DEL. FR. IS CEDEL PRODUCE        S01190
     C**  E TYPE '03FC'                                                   S01190
     C**                                                                  S01190
     C           DLFRAT    IFEQ 2                                         S01190
     C           DLTOAT    ANDEQ1                                         S01190
     C                     EXSR RSR09                                     S01190
     C                     EXSR RSR10                                     S01190
     C                     EXSR RSRN5                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01190
     C                     END                                            S01190
     C*
     C*   IF 'PAY TO' IS NOT A CLEARING HOUSE ACCOUNT AT EITHER
     C*   EUROCLEAR OR CEDEL, OUTPUT TO S/UNFOR
     C*
     C           PYTOAT    IFGE 3                                         S01175
     C                     EXSR RSR35                                     S01175
     C                     END                                            S01175
      *                                                                   E38340
     C***********          TESTB'03'      PYTOAT     70                   S01175
     C***70******          TESTB'47'      PYTOAT     70                   S01175
     C***70******          EXSR RSR35                                     S01175
     C***70******          GOTO FREE02                                    S01175
     C*
     C** IF 'PAY TO' IS A CLEARING HOUSE ACCOUNT AT CEDEL, PRODUCE '10'
     C*
     C           PYTOAT    IFEQ 2                                         S01175
     C                     EXSR RSR31                                     S01175
     C  NU8                EXSR RSR32                                     S01175
     C                     END                                            S01175
      *                                                                   E38340
     C***********          TESTB'47'      PYTOAT         70               S01175
     C***70******          EXSR RSR31                                     S01175
     C***70NU8***          EXSR RSR32                                     S01175
     C***70******          GOTO FREE02                                    S01175
     C*
     C****IF*'PAY*TO'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*EUROCLEAR*&*'PAY**   S01175
     C****FROM'*IS*NOT*PARTICIPANT,*PRODUCE*'PREADVICE'****************   S01175
     C*
     C*   IF 'PAY TO' IS A DEPOT AT EUROCLEAR AND PAY FROM IS NOT,        S01175
     C*    PRODUCE 'PREADVICE'                                            S01175
     C*   NB. IF 'PAY FROM' IS PARTICIPANT NO ADVICE IS SENT
     C*
     C           PYTOAT    IFEQ 1                                         S01175
     C           PYFRAT    ANDGT1                                         S01175
     C                     EXSR RSR02                                     S01175
     C                     END                                            S01175
      *                                                                   E38340
     C***********          TESTB'03'      PYTOAT         70               S01175
     C***70******          TESTB'1'       PYFRAT     70                   S01175
     C***70******          EXSR RSR02                                     S01175
     C***********                                                         E38340
     C***********FREE02    TAG                             ** FREE02 **   S01175
     C*
     C   U8                GOTO FREE99
     C*                                                                   S01175
     C*   IF BOTH 'DELIVER FROM' AND 'DELIVER TO' ARE EUROCLEAR DEPOTS    S01175
     C*   PRODUCE TYPE '02'                                               S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 1                                         S01175
     C***********DLTOAT    ANDEQ1                                   S01175S01190
     C           DLTOAT    IFEQ 1                                         S01190
     C           *IN61     IFEQ '0'                                       S01190
     C                     EXSR RSR07                                     S01175
     C  NU8                EXSR RSR08                                     S01175
     C                     EXSR RSRN4                                     S01190
     C                     ELSE                                           S01190
     C                     EXSR RSR07                                     S01190
     C                     EXSR RSR08                                     S01190
     C                     EXSR RSRN1                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01175
     C*                                                                   S01175
     C** IF 'DELIVER FROM' IS A EUROCLEAR DEPOT AND 'DELIVER TO' IS       S01175
     C** NOT, PRODUCE TYPE '07'                                           S01175
     C*                                                                   S01175
     C                     ELSE                                           S01190
     C***********DLFRAT    IFEQ 1                                   S01175S01190
     C***********DLTOAT    ANDGT1                                   S01175S01190
     C           *IN61     IFEQ '0'                                       S01190
     C           DLTOAT    ANDEQ2                                         S01190
     C                     EXSR RSR13                                     S01175
     C  NU8                EXSR RSR14                                     S01175
     C**NU8******          EXSR RSR15                               S01175S01190
     C                     EXSR RSRN4                               S01175S01190
     C                     ELSE                                           S01190
     C           DLTOAT    IFNE 2                                         S01190
     C                     EXSR RSR13                                     S01190
     C                     EXSR RSR14                                     S01190
     C                     EXSR RSRN7                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     ELSE                                           S01190
     C           DLTOAT    IFEQ 2                                         S01190
     C                     EXSR RSR13                                     S01190
     C                     EXSR RSR14                                     S01190
     C                     EXSR RSRN7                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01175
     C                     END                                            S01190
     C                     END                                            S01190
     C                     END                                            S01190
      *---------------------------------------------------------------*   E38340
      ***  The next two IF Statements are currently within the larger *   E38340
      ***  IF Condition "DLFRAT IFEQ 1" therefore will never be true. *   E38340
      *---------------------------------------------------------------*   E38340
     C*                                                                   S01175
     C*   IF 'DELIVER FROM' IS A CEDEL DEPOT AND 'DELIVER TO' IS A        S01175
     C*   DEPOT AT CEDEL OR EUROCLEAR, PRODUCE TYPE '31'                  S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 2                                         S01175
     C           DLTOAT    ANDEQ2                                         S01175
     C***********DLTOAT    OREQ 2                                  S01175 E16301
     C           DLFRAT    OREQ 2                                         E16301
     C           DLTOAT    ANDEQ1                                         E16301
     C                     EXSR RSR21                                     S01175
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF 'DELIVER FROM' IS A CEDEL DEPOT AND 'DELIVER TO' IS NOT A    S01175
     C*   DEPOT AT CEDEL OR EUROCLEAR, PRODUCE TYPE '81'                  S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 2                                         S01175
     C           DLTOAT    ANDGE3                                         S01175
     C***********DLTOAT    OREQ 2                                   S01175E16301
     C                     EXSR RSR29                                     S01175
     C                     END                                            S01175
      *---------------------------------------------------------------*   E38340
     C                     END                                            S01175
     C                     END                                            S01190
     C*
     C****FOR*A*TRADE*FREE*OF*PAYMENT*A*STOCK*TEELX*IS*PRODUCED*BY*THE    S01175
     C****SELLER,*SO*IF*MARKET*PURCHASE*NO*TELEX*OF*THIS*TYPE*PRODUCED    S01175
     C***********                                                         E38340
     C***60*61***          GOTO FREE99                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*FROM'*IS*NOT*A*CLEARING*HOUSE*ACCOUNT*AT*EITHER*:   S01175
     C****EUROCLEAR*OR*CEDEL,*NO*FURTHER*PROCESSING********************   S01175
     C***********                                                         E38340
     C***********          TESTB'03'      DLFRAT     70                   S01175
     C***70******          TESTB'47'      DLFRAT     70                   S01175
     C***70******          GOTO FREE99                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*FROM'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*EUROCLEAR,**.. S01175
     C***********                                                         E38340
     C***********          TESTB'03'      DLFRAT         70               S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*TO'*PARTICIPANT*AT*EUROCLEAR,*PRODUCE*'02'**   S01175
     C***********                                                         E38340
     C***70******          TESTB'13'      DLTOAT         71               S01175
     C***70*71***          EXSR RSR07                                     S01175
     C***70*71NU8          EXSR RSR08                                     S01175
     C***70*71***          GOTO FREE99                                    S01175
     C***********                                                         E38340
     C****.....*OTHERWISE*PRODUCE*'07'*-*NOTE:*IF*'DELIVER*TO'*IS******   S01175
     C**********PARTICIPANT*AT*CEDEL*PRODUCE*'07*BRIDGE'***************   S01175
     C***********                                                         E38340
     C***70******          TESTB'57'      DLTOAT         17               S01175
     C***********                                                         E38340
     C****.....*CLEARING*HOUSE*MUST*ALSO*BE*CEDEL*FOR*'07*BRIDGE'******   S01175
     C***********                                                         E38340
     C***70*17***CLRH      COMP 'C'                      17               S01175
     C***70******          EXSR RSR13                                     S01175
     C***70NU8***          EXSR RSR14                                     S01175
     C***70NU8***          EXSR RSR15                                     S01175
     C***70******          GOTO FREE99                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*FROM'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*CEDEL,*...**   S01175
     C***********                                                         E38340
     C************         TESTB'47'      DLFRAT         70               S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*TO'*PARTICIPANT*AT*CEDEL,*PRODUCE*'31'*-****   S01175
     C**********NOTE:*IF*'DELIVER*TO'*IS*PARTICIPANT*AT*EUROCLEAR,*****   S01175
     C**********PRODUCE*'31*BRIDGE'************************************   S01175
     C***********                                                         E38340
     C***70*******         TESTB'57'      DLTOAT         71               S01175
     C***70*******         TESTB'13'      DLTOAT         17               S01175
     C***17*******         SETON                     71                   S01175
     C***70*71****         EXSR RSR21                                     S01175
     C***70*71****         GOTO FREE99                                    S01175
     C***********                                                         E38340
     C****.....*OTHERWISE*PRODUCE*'81'*********************************   S01175
     C***********                                                         E38340
     C***70*******         EXSR RSR29                                     S01175
     C*
     C           FREE99    ENDSR                           ** FREE99 **
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  AGST S/R - TO CONTROL TELEX PRODUCTION FOR TRADES AGAINST
     C*             PAYMENT
     C*
     C*****************BIT*0*-*EUROCLEAR*-*PARTY*IS*CLEARING*HOUSE*ACCOUNTS01175
     C*********************1*-*****"*****-*PARTY*IS*PARTICIPANT********   S01175
     C*********************2*-*****"*****-*PARTY*HAS*NON-ZERO*REFERENCE   S01175
     C*********************3*-*****"*****-*FORMATTED*TELEX*REQUESTED***   S01175
     C*****************************************************************   E38340
     C*****************BIT*4*-*CEDEL*-*PARTY*IS*CLEARING*HOUSE*ACCOUNT*   S01175
     C*********************5*-***"***-*PARTY*IS*PARTICIPANT***********:   S01175
     C*********************6*-***"***-*PARTY*HAS*NON-ZERO*REFERENCE****   S01175
     C*********************7*-***"***-*FORMATTED*TELEX*REQUESTED*******   S01175
     C*                                                                   S01175
     C*           1  -  PARTY IS DEPOT AT EUROCLEAR                       S01175
     C*           2  -  PARTY IS DEPOT AT CEDEL                           S01175
     C*           3  -  PARTY IS DEPOT AT KASSENVEREIN                    S01175
     C*           4  -  PARTY IS NONE OF ABOVE                            S01175
     C*                                                               *   E38340
     C*  CALLS:   RSR05/06/07/08/09/10/13/14/23/25/27/29              *   E38340
     C*           RSRN1/N2/N3/N4/N5/N7                                *   E38340
     C*
     C*****************************************************************
     C*
     C           AGST      BEGSR
     C*
     C* NO CASH TELEXES AS SUCH ARE PRODUCED FOR TRADES AGAINST PAYMENT.
     C* CASH TRANSFER IS DONE WHEN TWO MATCHING STOCK TELEXES ARE
     C* RECONCILED BY THE CLEARING HOUSE(S)
     C*
     C* STOCK TELEX PRODUCED BY BUYER FOR PURCHASE, SO IF MARKET SALE,
     C* NO TELEX OF THIS TYPE IS PRODUCED
     C* UNLESS COUNTERPARTY IS A PORTFOLIO CLIENT                         S01175
     C*
     C           TDTP      IFEQ 'TP'                                      S01175
     C           *IN61     OREQ '0'                                       S01175
     C*                                                                   S01175
     C*   IF BOTH 'DELIVER TO' AND 'DELIVER FROM' ARE DEPOTS AT           S01175
     C*   EUROCLEAR PRODUCE TYPE '01'                                     S01175
     C*                                                                   S01175
     C           DLTOAT    IFEQ 1                                         S01175
     C           DLFRAT    ANDEQ1                                         S01175
     C                     EXSR RSR05                                     S01175
     C  NU8                EXSR RSR06                                     S01175
     C                     EXSR RSRN1                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF 'DELIVER TO' IS A EUROCLEAR DEPOT AND 'DELIVER FROM' IS      S01175
     C*   NOT,  PRODUCE TYPE '03'                                         S01175
     C*                                                                   S01175
     C           DLTOAT    IFEQ 1                                         S01175
     C           DLFRAT    ANDGT1                                         S01175
     C                     EXSR RSR09                                     S01175
     C  NU8                EXSR RSR10                                     S01175
     C                     EXSR RSRN5                                     S01190
     C                     END                                            S01175
     C*                                                                   S01175
     C**  IF TRADE IS ACROSS BRIDGE                                       S01190
     C           DLTOAT    IFEQ 1                                         S01190
     C           DLFRAT    ANDEQ2                                         S01190
     C                     EXSR RSRN2                                     S01190
     C  NU8                EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01190
     C*                                                                   S01190
     C*   IF 'DELIVER TO' IS A CEDEL DEPOT AND 'DELIVER FROM' IS A        S01175
     C*   DEPOT AT CEDEL OR EUROCLEAR  PRODUCE TYPE '41'                  S01175
     C*                                                                   S01175
     C           DLTOAT    IFEQ 2                                         S01175
     C           DLFRAT    ANDEQ2                                         S01175
     C           DLFRAT    OREQ 1                                         S01175
     C           DLTOAT    ANDEQ2                                         E16301
     C                     EXSR RSR23                                     S01175
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF 'DELIVER TO' IS A CEDEL DEPOT AND 'DELIVER FROM' IS NOT A    S01175
     C*   DEPOT AT CEDEL OR EUROCLEAR  PRODUCE TYPE '61'                  S01175
     C*                                                                   S01175
     C           DLTOAT    IFEQ 2                                         S01175
     C           DLFRAT    ANDGE3                                         S01175
     C                     EXSR RSR27                                     S01175
     C                     END                                            S01175
     C                     END                                            S01175
     C**N60*61***          GOTO AGST01                                    S01175
     C*
     C****IF*'DELIVER*TO'*IS*NOT*A*CLEARING*HOUSE*ACCOUNT*AT*EITHER****   S01175
     C****EUROCLEAR*OR*CEDEL,*OUTPUT*TO*S/UNFOR************************   S01175
     C***********                                                         E38340
     C*************        TESTB'03'      DLTOAT     70                   S01175
     C***70******          TESTB'47'      DLTOAT     70                   S01175
     C***70******          EXSR RSR35                                     S01175
     C***70******          GOTO AGST01                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*TO'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*EUROCLEAR,*...   S01175
     C***********                                                         E38340
     C***********          TESTB'03'      DLTOAT         70               S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER FROM'*PARTICIPANT*AT*EUROCLEAR,*PRODUCE*'01'   S01175
     C***********                                                         E38340
     C***70******          TESTB'13'      DLFRAT         71               S01175
     C***70*71***          EXSR RSR05                                     S01175
     C***70*71NU8          EXSR RSR06                                     S01175
     C***70*71**:          GOTO AGST01                                    S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER FROM'*RECOGNISED*AT*EUROCLEAR,*PRODUCE*'03'*   S01175
     C**********NOTE:*IF*'DELIVER*FROM'*PARTICIPANT*AT*CEDEL,*PRODUCE**   S01175
     C**********'03*BRIDGE'******************************************     S01175
     C***********                                                         E38340
     C***70********        TESTB'23'      DLFRAT         71               S01175
     C***70********        TESTB'57'      DLFRAT         17               S01175
     C***70*17*****        SETON                     71                   S01175
     C***********                                                         E38340
     C****.....*CLEARING*HOUSE*MUST*ALSO*BE*CEDEL*FOR*'03*BRIDGE'******   S01175
     C***********                                                         E38340
     C***70*17***CLRH      COMP 'C'                      17               S01175
     C***70*71***          EXSR RSR09                                     S01175
     C***70*71NU8          EXSR RSR10                                     S01175
     C***70*71***          GOTO AGST01                                    S01175
     C***********                                                         E38340
     C****.....*OTHERWISE*OUTPUT*TO*S/UNFOR****************************   S01175
     C***********                                                         E38340
     C***IF*THE*DELIVER*TO***DETAILS*WERE*FOR*EUROCLEAR*SETTLEMENT*****   S01175
     C***********          TESTB'3'       DLTOAT         70               S01175
     C***70******          EXSR RSR35                                     S01175
     C***70******          GOTO AGST01                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*TO'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*CEDEL,*...****   S01175
     C***********                                                         E38340
     C***********          TESTB'47'      DLTOAT         70               S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*FROM'*PARTICIPANT*AT*CEDEL,*PRODUCE*'41',***   S01175
     C**********OR*IF*'DELIVER*FROM'*IS*PARTICIPANT*AT*EUROCLEAR,*PRODUCE S01175
     C**********'41*BRIDGE'********************************************   S01175
     C***********                                                         E38340
     C***70******          TESTB'57'      DLFRAT         71               S01175
     C***70******          TESTB'13'      DLFRAT         17               S01175
     C***70*17***          SETON                     71                   S01175
     C***70*71***          EXSR RSR23                                     S01175
     C***70*71***          GOTO AGST01                                    S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*FROM'*RECOGNISED*AT*CEDEL,*PRODUCE*'61'*****   S01175
     C***********                                                         E38340
     C***70******          TESTB'67'      DLFRAT         71               S01175
     C***70*71***          EXSR RSR27                                     S01175
     C***70*71***          GOTO AGST01                                    S01175
     C***********                                                         E38340
     C****.....*OTHERWISE*OUTPUT*TO*S/UNFOR****************************   S01175
     C***********                                                         E38340
     C***IF*THE*DELIVER*TO***DETAILS*WERE*FOR*CEDEL*SETTLEMENT*********   S01175
     C***********          TESTB'7'       DLTOAT         70               S01175
     C***70******          EXSR RSR35                                     S01175
     C***********                                                         E38340
     C***********AGST01    TAG                             ** AGST01 **   S01175
     C*
     C*   STOCK TELEX PRODUCED BY SELLER FOR SALE, SO IF MARKET
     C*   PURCHASE, NO TELEX OF THIS TYPE IS PRODUCED
     C*   UNLESS COUNTERPARTY IS A PORTFOLIO CLIENT                       S01175
     C*                                                                   S01175
     C           TDTP      IFEQ 'TS'                                      S01175
     C           *IN61     OREQ '0'                                       S01175
     C*                                                                   S01175
     C*   IF BOTH 'DELIVER FROM' AND 'DELIVER TO' ARE DEPOTS AT           S01175
     C*   EUROCLEAR PRODUCE TYPE '02'                                     S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 1                                         S01175
     C           DLTOAT    ANDEQ1                                         S01175
     C                     EXSR RSR07                                     S01175
     C  NU8                EXSR RSR08                                     S01175
     C                     EXSR RSRN1                                     S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     EXSR RSRN4                                     S01190
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF 'DELIVER FROM' IS A EUROCLEAR DEPOT AND 'DELIVER TO' IS      S01175
     C*   NOT,  PRODUCE TYPE '07'                                         S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 1                                         S01175
     C           DLTOAT    ANDGT1                                         S01175
     C                     EXSR RSR13                                     S01175
     C  NU8                EXSR RSR14                                     S01175
     C**NU8******          EXSR RSR15                               S01175S01190
     C                     EXSR RSRN7                                     S01190
     C  NU8                EXSR RSRN4                                     S01190
     C                     END                                            S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 1                                         S01190
     C           DLTOAT    ANDEQ2                                         S01190
     C                     EXSR RSRN2                                     S01190
     C                     EXSR RSRN3                                     S01190
     C                     END                                            S01190
     C*   IF 'DELIVER FROM' IS A CEDEL DEPOT AND 'DELIVER TO' IS A        S01175
     C*   DEPOT AT CEDEL OR EUROCLEAR  PRODUCE TYPE '51'                  S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 2                                         S01175
     C           DLTOAT    ANDEQ2                                         S01175
     C***********DLTOAT    OREQ 1                                   S01175E15014
     C           DLFRAT    OREQ 2                                         E15014
     C           DLTOAT    ANDEQ1                                         E15014
     C                     EXSR RSR25                                     S01175
     C                     END                                            S01175
     C*                                                                   S01175
     C*   IF 'DELIVER FROM' IS A CEDEL DEPOT AND 'DELIVER TO' IS NOT A    S01175
     C*   DEPOT AT CEDEL OR EUROCLEAR  PRODUCE TYPE '81'                  S01175
     C*                                                                   S01175
     C           DLFRAT    IFEQ 2                                         S01175
     C           DLTOAT    ANDGE3                                         S01175
     C                     EXSR RSR29                                     S01175
     C                     END                                            S01175
     C                     END                                            S01175
     C*
     C***60*61**           GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*FROM'*IS*NOT*A*CLEARING*HOUSE*ACCOUNT*AT*EITHER**   S01175
     C****EUROCLEAR*OR*CEDEL,*OUTPUT*TO*S/UNFOR************************   S01175
     C***********                                                         E38340
     C***********          TESTB'03'      DLFRAT     70                   S01175
     C***70******          TESTB'47'      DLFRAT     70                   S01175
     C***70******          EXSR RSR35                                     S01175
     C***70******          GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*FROM'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*EUROCLEAR,**.. S01175
     C***********                                                         E38340
     C***********          TESTB'03'      DLFRAT         70               S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*TO'*PARTICIPANT*AT*EUROCLEAR,*PRODUCE*'02'**   S01175
     C***********                                                         E38340
     C***70******          TESTB'13'      DLTOAT         71               S01175
     C***70*71***          EXSR RSR07                                     S01175
     C***70*71NU8          EXSR RSR08                                     S01175
     C***70*71***          GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*TO'*RECOGNISED*AT*EUROCLEAR,*PRODUCE*'07'***   S01175
     C**********NOTE:*IF*'DELIVER*TO'*PARTICIPANT*AT*CEDEL,*PRODUCE****   S01175
     C**********'07*BRIDGE'********************************************   S01175
     C***********                                                         E38340
     C***70******          TESTB'23'      DLTOAT         71               S01175
     C***70******          TESTB'57'      DLTOAT         17               S01175
     C***70*17***          SETON                     71                   S01175
     C***********                                                         E38340
     C****.....*CLEARING*HOUSE*MUST*ALSO*BE*CEDEL*OR*KASSENVEREIN******   S01175
     C**********FOR*'07*BRIDGE'*OR*'07*GERMANY'************************   S01175
     C***********                                                         E38340
     C***70*71***CLRH      IFNE 'C'                                       S01175
     C***********CLRH      ANDNE'K'                                       S01175
     C***********          SETOF                     17                   S01175
     C***********          END                                            S01175
     C***70*71***          EXSR RSR13                                     S01175
     C***70*71NU8          EXSR RSR14                                     S01175
     C***70*71NU8          EXSR RSR15                                     S01175
     C***70*71***          GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****.....*OTHERWISE*OUTPUT*TO*S/UNFOR****************************   S01175
     C***********                                                         E38340
     C***IF*THE*DELIVER*FROM*DETAILS*WERE*FOR*EUROCLEAR*SETTLEMENT*****   S01175
     C***********          TESTB'3'       DLFRAT         70               S01175
     C***70******          EXSR RSR35                                     S01175
     C***70******          GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****IF*'DELIVER*FROM'*IS*A*CLEARING*HOUSE*ACCOUNT*AT*CEDEL,*...**   S01175
     C***********                                                         E38340
     C***********          TESTB'47'      DLFRAT         70               S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*TO'*PARTICIPANT*AT*CEDEL,*PRODUCE*'51',*****   S01175
     C**********OR*IF*'DELIVER*TO'*IS*PARTICIPANT*AT*EUROCLEAR,*PRODUCE   S01175
     C**********'51*BRIDGE'********************************************   S01175
     C***********                                                         E38340
     C***70******          TESTB'57'      DLTOAT         71               S01175
     C***70******          TESTB'13'      DLTOAT         17               S01175
     C***70*17***          SETON                     71                   S01175
     C***70*71***          EXSR RSR25                                     S01175
     C***70*71***          GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****.....*&*'DELIVER*TO'*RECOGNISED*AT*CEDEL,*PRODUCE*'81'*******   S01175
     C***********                                                         E38340
     C***70******          TESTB'67'      DLTOAT         71               S01175
     C***70*71***          EXSR RSR29                                     S01175
     C***70*71***          GOTO AGST99                                    S01175
     C***********                                                         E38340
     C****.....*OTHERWISE*OUTPUT*TO*S/UNFOR****************************   S01175
     C***********                                                         E38340
     C***IF*THE*DELIVER*FROM*DETAILS*WERE*FOR*CEDEL*SETTLEMENT*********   S01175
     C***********          TESTB'7'       DLFRAT         70               S01175
     C***70******          EXSR RSR35                                     S01175
     C*
     C           AGST99    ENDSR                           ** AGST99 **   S01175
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  CCYCHK S/R - TO CHECK IF A CURRENCY IS E/C-CEDEL ACCEPTABLE
     C*               AND TO MOVE ALL OF THE DATA INTO THE PGM FIELDS
     C*
     C*  CALLED FROM:   MAIN
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           CCYCHK    BEGSR                           *** CCYCHK ***
     C*
     C                     Z-ADD1         U
     C           ARGMNT    LOKUPCCYZ,U                   67
      *                                                                   E38340
     C***67******E1AR,U    COMP 0                    6868                 E14592
     C***67N68***CAAR,U    COMP *BLANKS              6868                 E14592
     C***********                                                         E38340
     C***67*68***          GOTO CCYT01                                    E14592
      *                                                                   E38340
     C   67                GOTO CCYT01                                    E14592
     C                     SETON                     U7U8LR
      *                                                                   E38340
     C***********          MOVE 'TABLE'   DBFILE           ***************E20651
     C***********          MOVELARGMNT    DBKEY            **DB*ERROR*11**E20651
     C***********          Z-ADD11        DBASE            ***************E20651
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE'   DBFILE           ***************E20651
     C                     MOVELARGMNT    DBKEY            * DB ERROR 20 *E20651
     C                     Z-ADD20        DBASE            ***************E20651
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO CCYT99
     C*
     C           CCYT01    TAG                             *** CCYT01 ***
     C*
     C                     Z-ADDDPAR,U    CDP
     C                     MOVE SWAR,U    CCYS
     C                     Z-ADDE1AR,U    ECC1
     C                     Z-ADDE2AR,U    ECC2
     C                     MOVE CAAR,U    CACC
     C                     Z-ADDCNAR,U    CNCC
     C*
     C           CCYT99    ENDSR                           *** CCYT99 ***
     C*
     C*****************************************************************   S01190
      /EJECT                                                              S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C*  NOCCHK S/R - TO CHECK IF A CURRENCY IS E/C-CEDEL ACCEPTABLE      S01190
     C*               AND TO MOVE ALL OF THE DATA INTO THE PGM FIELDS     S01190
     C*                                                                   S01190
     C*  CALLED FROM:   MAIN                                              S01190
     C*  CALLS:   None.                                               *   E38340
     C*                                                                   S01190
     C*****************************************************************   S01190
     C*                                                                   S01190
     C           NOCCHK    BEGSR                           *** NOCCHK *** S01190
     C*                                                                   S01190
     C                     Z-ADD1         U                               S01190
     C           ARGMNT    LOKUPCCYZ,U                   67               S01190
     C*                                                                   S01190
     C   67                GOTO CCYT02                                    S01190
     C                     SETON                     U7U8LR               S01190
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE 'TABLE'   DBFILE           ***************S01190
     C**********           MOVELARGMNT    DBKEY      **DB*ERROR*11**S01190E20651
     C**********           Z-ADD11        DBASE      ***************S01190E20651
     C                     MOVELARGMNT    DBKEY            * DB ERROR 21 *E20651
     C                     Z-ADD21        DBASE            ***************E20651
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO CCYC99                                    S01190
     C*                                                                   S01190
     C           CCYT02    TAG                             *** CCYT02 *** S01190
     C*                                                                   S01190
     C                     Z-ADDDPAR,U    NCDP    10                      S01190
     C*                                                                   S01190
     C           CCYC99    ENDSR                           *** CCYC99 *** S01190
     C*                                                                   S01190
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*
     C*  LAST  - SR. TO HANDLE TRAILER PROCESSING
     C*
     C*  CALLED FROM:   MAIN
     C***CALLS:***RSR04************************************************   E38340
     C*  CALLS:   None.                                               *   E38340
     C*
     C*****************************************************************
     C*
     C           LAST      BEGSR                           ***  LAST  ***
     C*
     C                     READ SETLXAF                  99
     C  N99                GOTO TAGL1
     C*
     C*      DATABASE ERROR ON TXEXT TRAILER
     C*
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SETLX'   DBFILE
     C                     MOVEL'999999'  DBKEY            ***************
     C                     Z-ADD12        DBASE            * DB ERROR 12 *
     C                     OUT  LDA                        ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO ENDLR                      ***************
     C*
     C           TAGL1     TAG                             ** TAGL1 **
     C*
     C           CTXEXT    COMP NORETX               U8U8
     C   U8                GOTO ENDLR
     C*
     C*   SETUP AND O/P E/C TRAILERS
     C                     MOVE 'T'       RECI
     C                     ADD  1         CECASH
     C                     Z-ADDCECASH    NORE
     C                     EXCPTECASHT
     C*
     C*   CHAIN TO PICK UP SEEUC TRAILER.
     C*
     C                     Z-ADD99        EUB9
     C                     MOVE '9'       ACTC
     C                     Z-ADD99999     EURO
     C                     Z-ADD99999     EUDT
     C                     Z-ADD99        EUIN
     C                     Z-ADD999999    TRDR
     C*
     C           SEEKEY    CHAINSEEUC                99
     C  N99                GOTO TAGL2
     C                     SETON                     U7U8LR
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'SEEUC'   DBFILE
     C                     MOVELSEELXK    DBKEY            ***************
     C                     Z-ADD13        DBASE            * DB ERROR 13 *
     C                     OUT  LDA                        ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO ENDLR                      ***************
     C*
     C           TAGL2     TAG                              ** TAGL2 **
     C*
     C                     ADD  CECTLX    EUNU
     C*
     C                     EXCPTECTLXT
     C*
     C*   SETUP AND O/P CEDEL TRAILERS
     C                     MOVE '99'      CTCD
     C                     Z-ADD99        CEIN
     C                     Z-ADD9999999   CTNO
     C                     ADD  1         CCEDCS
     C                     Z-ADDCCEDCS    NORE
     C                     EXCPTCEDCST
     C                     ADD  1         CCEDTX
     C                     Z-ADDCCEDTX    NORE
     C                     EXCPTCEDTXT
     C*
     C*   SETUP AND O/P S/UNFOR AND S/NOTLX TRAILERS
     C                     MOVE 'T'       RECI
     C                     ADD  1         CUNFOR
     C                     Z-ADDCUNFOR    NORE
     C                     EXCPTUNFORT
     C                     ADD  1         CNOTLX
     C                     Z-ADDCNOTLX    NORE
     C                     EXCPTNOTLXT
     C*
     C*   SETUP AND O/P STPR2 TRAILER.
     C                     MOVE 'T'       RECI
     C                     ADD  1         CSTPR2
     C                     Z-ADDCSTPR2    NORE
     C                     Z-ADDHSTA02    HRWN
     C                     Z-ADDHSTB02    HRDC
     C                     EXCPTSTPR2T
     C*
     C****SETUP*AND*O/P*INSTR*TRAILER.*********************************   S01176
     C*   SETUP AND O/P OTHST TRAILER.                                    S01176
     C***********          MOVE 'T'       RECI                            S01176
     C***********          ADD  1         CINSTR                          S01176
     C***********          Z-ADDCINSTR    NORE                            S01176
     C***********          Z-ADDHSTAIN    HRWN                            S01176
     C***********          Z-ADDHSTBIN    HRDC                            S01176
     C***********          EXCPTINSTRT                                    S01176
     C*
     C           ENDLR     ENDSR                           ** ENDLR **
     C*
      *****************************************************************   S01117
      /EJECT                                                              S01117
      *****************************************************************   S01117
      *                                                               *   S01117
      *  *PSSR  - Error control subroutine                            *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
      *                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C**                                                                  S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
     C*****************************************************************
      /EJECT                                                              S01175
     C/COPY ZSRSRC,ZALIGNZ2                                               S01175
      /EJECT
     C/COPY ZSRSRC,ZCONVZ1
      /EJECT                                                              S01190
     C/COPY ZSRSRC,ZDATE1Z2                                               S01190
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT                                                              S01190
     C/COPY ZSRSRC,ZDAYSZ2                                                S01190
      /EJECT                                                              S01190
     C/COPY ZSRSRC,ZDYYRZ3                                                S01190
      /EJECT                                                              S01190
     C/COPY ZSRSRC,ZEVCDZ1                                                S01190
      /EJECT                                                              S01190
     C/COPY ZSRSRC,ZNCDZ3                                                 S01190
      /EJECT
     C/COPY ZSRSRC,ZLCDZ1                                                            100228 MD057247
      /EJECT                                                              100228
     C/COPY ZSRSRC,ZSDESCZ3
      /EJECT
     C/COPY ZSRSRC,ZSYSTMZ1
      /EJECT
     C/COPY ZSRSRC,ZZADDZ1
     O/EJECT
     C/COPY ZSRSRC,ZICD2Z1                                                050501
     C/EJECT                                                              050501
     OSTPR2TXFE        16
     O                         *ALL
     OUNFORABFE        19
     O                         *ALL
     ONOTLXABFE        20
     O                         *ALL
     OECASHABFE        21
     O                         *ALL
     O***INSTRABFE        22                                              S01176
     OOTHSTDF E        22                                                 S01176
     O                         *ALL
     OSEEUCD0FEADD     23
     O                         *ALL
     OSEEUCD1FEADD     24
     O                         *ALL
     OSEEUCD2FEADD     25
     O                         *ALL
     OSEEUCD3FEADD     41                                                 S01190
     O                         *ALL                                       S01190
     OSEEUCD4FEADD     42                                                 S01190
     O                         *ALL                                       S01190
     OSEEUCD5FEADD     48                                                 S01190
     O                         *ALL                                       S01190
     O***ECTLXL0FEADD     23
     O***                      *ALL
     O***ECTLXL1FEADD     24
     O***                      *ALL
     O***ECTLXL2FEADD     25
     O***                      *ALL
     OCEDCS10FE        26
     O                         *ALL
     OCEDCS12FE        27
     O                         *ALL
     OCEDCS90FE        28
     O                         *ALL
     OCEDCS92FE        29
     O                         *ALL
     OCEDTX31FE        30
     O                         *ALL
     OCEDTX32FE        31
     O                         *ALL
     OCEDTX41FE        32
     O                         *ALL
     OCEDTX42FE        33
     O                         *ALL
     OCEDTX51FE        34
     O                         *ALL
     OCEDTX52FE        35
     O                         *ALL
     OCEDTX61FE        36
     O                         *ALL
     OCEDTX62FE        37
     O                         *ALL
     OCEDTX81FE        38
     O                         *ALL
     OCEDTX82FE        39
     O                         *ALL
     OECASHACFE        LR      ECASHT
     O                         *ALL
     O*** ECTLXL9FE        LR      ECTLXT
     OSEEUCAF E        LR      ECTLXT                                     S01129
     O                         *ALL
     OCEDCSACFE        LR      CEDCST
     O                         *ALL
     OCEDTXACFE        LR      CEDTXT
     O                         *ALL
     OUNFORACFE        LR      UNFORT
     O                         *ALL
     ONOTLXACFE        LR      NOTLXT
     O                         *ALL
     OSTPR2ZZFE        LR      STPR2T
     O                         *ALL
     O***INSTRACFE        LR      INSTRT                                  S01176
     O***                      *ALL                                       S01176
     O*****************************************************************
     OSE0420AUT  203   LR
     O*
     O*   FILE CONTROL REPORT
     O*
     O***********                        23 'REFERENCE SE0420 '           E31187
     O                                   23 'REFERENCE SE0420AU '         E31187
     O                         TITL      89
     O                                  104 'DATE'
     O                         RUNA     112
     O                                  122 'PAGE'
     O                         PAGE  Z  127
     O        T  1     LR
     O***********                        62 'FORMATTED TELEXES SPLIT'     S01271
     O***********                        84 '- FILE CONTROL REPORT'       S01271
     O                                   40 'FORMATTED TELEXES SPLIT'     S01271
     O                                   62 '- FILE CONTROL REPORT'       S01271
     O                N81                83 '- INPUT CYCLE - TIME'        S01271
     O                N81      ATIME     90                               S01271
     O                 81                82 ' - CLOSE OF BUSINESS'        S01271
     O        T  1     LR
     O***********                        62 '-----------------------'     S01271
     O***********                        84 '----------------------'      S01271
     O                                   40 '-----------------------'     S01271
     O                                   62 '----------------------'      S01271
     O                N81                83 '---------------------'       S01271
     O                N81                90 '--------'                    S01271
     O                 81                82 '--------------------'        S01271
     O        T  213   LR
     O                                   53 '-------- RECORDS -------'
     O                                   54 '-'
     O                                   92 '----------- HASH TOTAL '
     O                                  104 '------------'
     O        T  2     LR
     O                                   41 'FILE CONTROL'
     O                                   54 'CALCULATED'
     O                                   81 'FILE CONTROL'
     O                                  104 'CALCULATED'
     O        T  2     LR
     O                                   14 'S/STPR2'
     O                         CSTPR23   54
     O                         HSTA023  101
     O                         HSTB02   104
     O        T  2     LR
     O****************                   14 'S/INSTR'                     S01176
     O                                   14 'S/OTHST'                     S01176
     O                         COTHST3   54                               S01176
     O****************         CINSTR3   54                               S01176
     O****************         HSTAIN3  101                               S01176
     O****************         HSTBIN   104                               S01176
     O        T  2     LR
     O                                   14 'S/SETLX'
     O******                   NORE  3   41
     O                         NORETX3   41
     O                         CTXEXT3   54
     O                       U8          60 '***'
     O        T  2     LR
     O                                   14 'S/ECASH'
     O                         CECASH3   54
     O        T  2     LR
     O************                       14 'S/ECTLX'                     S01271
     O                                   14 'S/SEEUC'                     S01271
     O                         CECTLX3   54
     O        T  2     LR
     O                                   14 'S/CEDCS'
     O                         CCEDCS3   54
     O        T  2     LR
     O                                   14 'S/CEDTX'
     O                         CCEDTX3   54
     O        T  2     LR
     O                                   14 'S/UNFOR'
     O                         CUNFOR3   54
     O        T  2     LR
     O                                   14 'S/NOTLX'
     O                         CNOTLX3   54
     O        T  243   LR U7 U8
     O                                   56 'DATABASE ERROR AT'
     O***********              DBASE     59                               S01117
     O***********                        64 ', KEY'                       S01117
     O***********              DBKEY     94                               S01117
     O                         DBASE     60                               S01117
     O                                   65 ', KEY'                       S01117
     O                         DBKEY     95                               S01117
     O        T  1     LR U7 U8
     O***********                        64 'FILE NAME'                   S01117
     O***********              DBFILE    70                               S01117
     O                                   65 'FILE NAME'                   S01117
     O                         DBFILE    74                               S01117
     O        T  149   LR U8NU7
     O                                   64 '*** FILE CONTROLS OUT OF'
     O                                   76 ' BALANCE ***'
     O********T**153   LR   NU7                                           E29170
     O*************************          69 '*** END OF REPORT ***'       E29170
     O*****************************************************************
      /EJECT
      ***
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZF29 DAY NOS OF FEB 29 TO 2096 (INCLUDING 2000)
0006001521029820444305904073650882610287117481320914670161311759219053
2051421975234362489726358278192928030741322023366335124365853804639507
40968424294389045351
** STAMP - Dummy timestamp                                                                    CPK015
0001-01-01-00.00.00.000000                                                                    CPK015
