     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Cust Trading Statement Entry Vald')
     F*****************************************************************
     F*                                                               *
     F*  Midas SECURITIES TRADING RELEASE 2 MODULE                *
     F*                                                               *
     F*  SE0941 - CUSTOMER TRADING STATEMENT ENTRY VALIDATION         *
     F*                                                               *
     F*  Function: To validate Customer Trading Statements.           *
     F*   (COB)                                                       *
     F*                                                               *
     F*  Called by: SEC0905P - Customer Trading Statement Prompt      *
     F*                                                               *
     F*  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027A            Date 17May06               *
      *                 BUG3122            Date 17Jul04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 052254             Date 10Jan94               *
      *                 E40270             Date 27May92               *
     F*                 S01117             DATE 20MAY91               *
     F*                 E13576             DATE 05/07/88              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027A- Conversion of cust. no. to alpha (post 103 build)   *
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
     F*           to 10,9                                             *
     F*  E40270 - '?' should be allowed for customer on prompt.       *
     F*  S01117 - Multibranching                                      *
     F*  E13576 - Program SE0941 written to perform the necessary     *   E13576
     F*           validation of Customer Numbers without DB Errors.   *   E13576
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCCF                          KIGNORE
     F            CLINTC1F                          KIGNORE
      /SPACE 3
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   99  - CLIENT NUMBER INVALID                                 *
     F*                                                               *
     F*****************************************************************
      /SPACE 3
     E                    MSG     1   3 79               Error Messages
     E                    CPY@    1   1 80
      /SPACE 3
     I*
     IDSSDY     E DSDSSDY                                                 E40270
     I** SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE               E40270
     I**                                                                  E40270
     ISDSECS    E DSSDSECSPD                                              S01117
     I** Security Customer Details                                        S01117
     I**                                                                  E40270
     ICPYR@#      DS
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C/EJECT
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
     C           *ENTRY    PLIST
     C                     PARM           CUSTNO  6
     C                     PARM           IND     1
     C                     PARM           ERRMSG 76
     C*
     C                     MOVEL*BLANKS   ERRMSG                          E40270
     C                     MOVE ' '       IND                             E40270
     C                     MOVELCUSTNO    NUMB1   1                       E40270
     C*    If '?' not taken                                               E40270
     C           NUMB1     IFNE '?'                                       E40270
     C*    TEST FOR NUMERIC CUSTOMER NUMBER.
     C*
     C                     MOVELCUSTNO    NUMBA   7
     C                     MOVE '0'       NUMBA
     C                     TESTN          NUMBA      50
     C           *IN50     IFNE '1'
     C                     MOVE '1'       IND
     C                     MOVEAMSG,1     ERRMSG
     C                     GOTO ENDPGM
     C                     END
     C*
     C                     END                                            E40270
     C                     SETOF                     50
     C*
     C*    CALCULATION TO DEFINE NUMBER FIELD.
     C*
     C**********           MOVE CUSTNO    ZCNUM   60                                         CSD027A
     C                     MOVE CUSTNO    ZCNUM   6                                          CSD027A
     C*
     C*   Check for valid banking customer
     C*
     C           NUMB1     IFNE '?'                                       E40270
     C           ZCNUM     CHAINCLINTCBF             99
     C  N99      RECI      COMP '*'                      99
     C  N99      RECI      COMP 'C'                      99
     C           *IN99     IFEQ '1'
     C                     MOVE '2'       IND
     C                     MOVEAMSG,2     ERRMSG
     C                     GOTO ENDPGM
     C                     END
     C                     END                                            E40270
     C*
     C* Check for SE2 customer
     C*
     C           NUMB1     IFEQ '?'                                       E40270
     C                     MOVELNUMB1     @SKEY                           E40270
     C                     ELSE                                           E40270
     C                     MOVELZCNUM     @SKEY                           E40270
     C                     END                                            E40270
     C***********ZCNUM     CHAINCLINTSEF             99                   E40270
     C                     CALL 'AOSECSR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM           @SKEY   6                       S01117
     C           SDSECS    PARM SDSECS    DSSDY                           S01117
     C**N99******RECI      COMP '*'                      99
     C**N99******RECI      COMP 'C'                      99
     C************IN99     IFEQ '1'
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '3'       IND
     C                     MOVEAMSG,3     ERRMSG
     C                     GOTO ENDPGM
     C                     ELSE                                           E40270
     C                     MOVELBFCUST    CUSTNO                          E40270
     C                     MOVELBFCUST    CUSTMR  6                       E40270
     C                     END
     C*
     C           ENDPGM    TAG                             *** ENDPGM ***
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
      *                                                               *
     C                     SETON                     LRRT
      *                                                               *
      *****************************************************************   S01117
      /EJECT                                                              S01117
      *****************************************************************   S01117
      *                                                               *   S01117
      *  *PSSR  - Error control subroutine                            *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
      *                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C**                                                                  S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
      *================================================================
      /EJECT
      ***
**   MSG  - ERROR MESSAGES
CUSTOMER NUMBER MUST BE NUMERIC
CLIENT DOES NOT EXIST
CLIENT IS NOT A SECURITIES TRADING CUSTOMER
**  CPY@
(c) Finastra International Limited 2001
