000100200529     H        1
000200200529      *****************************************************************
000300200529/*STD *  RPGBASE                                                      *
000400200529/*EXI *  TEXT('Midas SE Trades extended settlements maint')           *
000500200529/*XBIA*  OVRDBF FILE(TRADSDZ2) TOFILE(TRADSDY2) SHARE(*NO)            *
000600200529     F/COPY WNCPYSRC,SE1806F002
000700200529      *****************************************************************
000800200529      *                                                               *
000900200529      *  Midas - Securities Trading Module                            *
001000200529      *                                                               *
001100200529      *  SE1806 - Trades Extended Settlements for MT5xxs              *
001200200529      *                                                               *
001300200529      *  Function: This program allows input of the fields needed     *
001400200529      *   (I/C)    to produce the SWIFT Messages - MT5XX.             *
001500200529      *                                                               *
001600200529      *  Called By: SE1805 - Trades Input - Extension File for MT5xx  *
001700200529      *                                                               *
001800200529      *         NB. ANY CHANGE MADE TO THIS PGM WILL ALMOST           *
001900200529      *             DEFINITELY NEED TO BE APPLIED TO SE1808           *
002000200529      *                                                               *
002100200529      *  (c) Finastra International Limited 2001                      *
002200200529      *                                                               *
002300200604      *  Last Amend No. 248683             Date 22May20               *
002400200529      *  Prev Amend No. MD046248           Date 27Oct17               *
002500200529      *                 AR573194           Date 19Aug14               *
002600200529      *                 212937             Date 09Jul10               *
002700200529      *                 AR642262           Date 14Sep10               *
002800200529      *                 AR640699           Date 09Sep10               *
002900200529      *                 AR635017           Date 28Aug10               *
003000200529      *                 AR632000           Date 24Aug10               *
003100200529      *                 AR589193           Date 09Aug10               *
003200200529      *                 CSW210             Date 04May10               *
003300200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
003400200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
003500200529      * Midas Plus 1.4 Base ------------------------------------------*
003600200529      * Midas Plus 1.3 ----------- Base ------------------------------*
003700200529      *                 CSD031             Date 10Apr06               *
003800200529      *                 CSD027             Date 09Dec05               *
003900200529      *                 CSE071             Date 19Jul05               *
004000200529      *                 CSW037A            Date 02May05               *
004100200529      *                 BUG6198            Date 04Apr05               *
004200200529      *                 215783             Date 25MAR03               *
004300200529      *                 215058             Date 21FEB03               *
004400200529      *                 CSD025             Date 11Jan05               *
004500200529      *                 CSW037             Date 15Dec04               *
004600200529      *                 218770             Date 13Jun03               *
004700200529      *                 CSW036             Date 15Dec04               *
004800200529      *                 BUG3122            Date 17Jul04               *
004900200529      *                 CLE025             Date 20Oct03               *
005000200529      *                 CGL029             Date 01Sep03               *
005100200529      *                 222331             Date 21Oct03               *
005200200529      *                 218770             Date 13Jun03               *
005300200529      *                 CSE045             Date 24Mar03               *
005400200529      *                 CSD015             Date 14Oct02               *
005500200529      * Midas Release 4.01.02 ----------------------------------------*
005600200529      *                 209945             Date 13Nov02               *
005700200529      *                 211823             Date 11NOV02               *
005800200529      *                 209247             Date 08Oct02               *
005900200529      *                 209949             Date 08Oct02               *
006000200529      *                 209890             Date 01Oct02               *
006100200529      * Midas Release 4.01 -------------------------------------------*
006200200529      *                 205689             Date 13May02               *
006300200529      *                 205667             Date 09May02               *
006400200529      *                 205665             Date 08May02               *
006500200529      *                 CSE034             Date 22Apr02               *
006600200529      *                 204960             Date 17Apr02               *
006700200529      *                 204917             Date 17Apr02               *
006800200529      *                 204804             Date 15Apr02               *
006900200529      *                 204592             Date 10Apr02               *
007000200529      *                 204550             Date 04Apr02               *
007100200529      *                 204464             Date 02Apr02               *
007200200529      *                 204151             Date 21Mar02               *
007300200529      *                 201429             Date 24Dec01               *
007400200529      *                 178484             Date 25Oct01               *
007500200529      *                 199797             Date 01Nov01               *
007600200529      * Midas Release 4 --------------- Base -------------------------*
007700200529      *                 CSE028             Date 06Jun01               *
007800200529      *                 CSW201             Date 02May01               *
007900200529      * Midas DBA 3.05 -----------------------------------------------*
008000200529      * Midas DBA 3.00 ---------------- Base -------------------------*
008100200529      *                 CSW014             Date 22Jun98               *
008200200529      *                 CSW098             Date 06Apr98               *
008300200529      *                 056348             DATE 08MAY96               *
008400200529      *                 061028             DATE 08MAY96               *
008500200529      *                 086910             DATE 08MAY96               *
008600200529      *                 CSW003             DATE 08FEB96               *
008700200529      *                 084735             DATE 23MAY95               *
008800200529      *                 S01401             DATE 16JUN93               *
008900200529      *                                                               *
009000200529      *---------------------------------------------------------------*
009100200529      *                                                               *
009200200529      *  248683 - Write 'Y' to SE1806 Data Area Flag.                 *
009300200529      *  MD046248 - Finastra Rebranding                               *
009400200529      *  AR573194 - TRDN screen does not continue on deal cannot be   *
009500200529      *           saved. Applied fix 212937.                          *
009600200529      *  212937 - Validation of fields should not be conditioned on   *
009700200529      *           the clearance type                                  *
009800200529      *  AR642262 - Error in IBAN validation                          *
009900200529      *  AR640699 - Debtor Address - DSS/Account test                 *
010000200529      *  AR635017 - Account with institution and Beneficiary of money *
010100200529      *             was not displayed in MT541, MT518 and MT545       *
010200200529      *  AR632000 - BULK- Error Message appear" In Deliver instruc-   *
010300200529      *             tions, this field can only be used for a trade    *
010400200529      *             confirmation."                                    *
010500200529      *  AR589193 - Error on ? in Extended settlement field           *
010600200529      *  CSW210 - SWIFT 2010 Changes                                  *
010700200529      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
010800200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
010900200529      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
011000200529      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
011100200529      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
011200200529      *  215783 - Place of settlement not defaulted if no SSI exist.  *
011300200529      *           Fix is to default value from market center details  *
011400200529      *           if no SSi exist.                                    *
011500200529      *  215058 - RESET PARM TO BLANK WHE CALLING SEDORFRTV           *
011600200529      *  218770 - Defaulting of counterparty safekeeping a/c incorrect*
011700200529      *           Fix is to default value of 'For a/c of' in SSI if   *
011800200529      *           not blanks, otherwise take normal defaulting.       *
011900200529      *  CSD025 - Customer De-Activation                              *
012000200529      *  CSW037 - Additional Field Data on MT300/MT320                *
012100200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
012200200529      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
012300200529      *  CLE025 - Credit Lines (Recompile)                            *
012400200529      *  CGL029 - Increase Account Code to 10 digits                  *
012500200529      *  222321 - Initialise field for CSE045 should be done          *
012600200529      *           uncondition to the switchable feature               *
012700200529      *  218770 - Defaulting of counterparty safekeeping a/c incorrect*
012800200529      *           Fix is to default value of 'For a/c of' in SSI if   *
012900200529      *           not blanks, otherwise take normal defaulting.       *
013000200529      *  CSE045 - API for Extended Settlement for Trade Input and     *
013100200529      *           Depot Movement                                      *
013200200529      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
013300200529      *  209945 - When enquiring a Trade, when rollup is taken from   *
013400200529      *           the 3rd screen of the Extended Settlements, program *
013500200529      *           goes to the first screen                            *
013600200529      *  211823 - SAFEKEEPING A/C SHOULD DEFAULT BASED ON DEPOT IF NOT*
013700200529      *           BY BICN                                             *
013800200529      *  209247 - Add Custodian and Safe A/c narrative                *
013900200529      *  209949 - Deliverer of field is not being defaulted           *
014000200529      *  209890 - SWIFT ISO 15022. Defaulting of the Counterparty     *
014100200529      *           Safekeeping Account                                 *
014200200529      *  205689 - Removed core fix 178484.                            *
014300200529      *  205667 - Incorrect SSI defaulting when Market Centre used.   *
014400200529      *  205665 - Incorrect Counterparty Safekeeping account.         *
014500200529      *  CSE034 - Standard Settlement Instruction improvements        *
014600200529      *  204960 - Default Reg Details from Book SSI for Trade Purch.  *
014700200529      *  204917 - Incorrect validation in Instructing Party field.    *
014800200529      *  204804 - Clearing Correspondent validation incorrect.        *
014900200529      *  204592 - Safekeeping account defaulting.                     *
015000200529      *  204550 - Receiver/Deliverer of securities defaulting.        *
015100200529      *  204464 - Receiver/Deliverer of securities should only be     *
015200200529      *           defaulted for confirmation requests.                *
015300200529      *  204151 - Amendments to trade extended settlements not done.  *
015400200529      *           Problem was caused by indicator 84 not being reset. *
015500200529      *  201429 - New validation needed for ISO15022 in               *
015600200529      *           extended settlement screen.                         *
015700200529      *  178484 - Re introduced fields for validation purposes.       *
015800200529      *           Compile Only.                                       *
015900200529      *  199797 - Additional changes and fixes for CSE028 (SSIs).     *
016000200529      *  CSE028 - Standing Settlement Instructions Enhancement.       *
016100200529      *  CSW201 - SWIFT 2001 Standards Update                         *
016200200529      *  CSW014 - ERI information for non-EMU users.                  *
016300200529      *         - Allow '/OCMT/' codeword on the "Sender to Receiver" *
016400200529      *           field.                                              *
016500200529      *  CSW098 - SWIFT 98 changes. New fields added.                 *
016600200529      *  056348 - FIELD 72 DOES NOT ACCEPT CODE WORK /TRADECP/        *        *
016700200529      *  061028 - Second and third part of field 72 does not accept   *
016800200529      *           blank                                               *
016900200529      *  086910 - If account line used for field 87 --> deliverer of  *
017000200529      *           securities should be inserted also.                 *
017100200529      *  CSW003 - MT5xx Message Generation - Phase 2                  *
017200200529      *  084735 - Recompile over changed file SE50DT.                 *
017300200529      *  S01401 - The generation of MT5xx SWIFT Messages if the option*
017400200529      *           is available.  NEW PROGRAM.                         *
017500200529      *                                                               *
017600200529      *****************************************************************
017700200529      *
017800200529     FTRADSDY2UF  E           K        DISK         KCOMIT       A
017900200529     F            TRADSDD2                          KRENAMEUPDIDX
018000200529     FTRADSDZ2IF  E           K        DISK
018100200529     F            TRADSDD2                          KRENAMERTVIDX
018200200529     FSECTY   IF  E           K        DISK                                                   199797
018300200529     F*
018400200529     FSEMKC   IF  E           K        DISK                                                   215783
018500200529     F*                                                                                       215783
018600200529     FSDCUSTL7IF  E           K        DISK                                                   204804
018700200529     F            @CUSTGE                           KRENAMESDCUSTSW                           204804
018800200529      *                                                                                       CSD015
018900200529      **  Compliance Watch Hit List File                                                      CSD015
019000200529     FSDCWHTL1IF  E           K        DISK                                                   CSD015
019100200529      *                                                                                       CSD015
019200200529     FSE1806DFCF  E                    WORKSTN
019300200529     F/COPY WNCPYSRC,SE1806F001
019400200529     F*****************************************************************
019500200529      /EJECT
019600200529     F*****************************************************************
019700200529     F*                                                               *
019800200529     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
019900200529     F*                                                               *
020000200529     F*    02  - Off=no errors on second screen                       *
020100200529     F*    03  - Destination From Depot                               *   CSW003
020200200529     F*    04  - Destination To Depot                                 *   CSW003
020300200529     F*    05  - Euroclear/Cedel destination                          *   CSW003
020400200529     F*    06  - Non Euroclear/Cedel destination                      *   CSW003
020500200529     F*    07  - Deliver message                                      *   CSW003
020600200529     F*    08  - Receive message                                      *   CSW003
020700200529     F*    09  - Protect Input Fields                                 *
020800200529     F*    10  - Protect Input Fields                                 *
020900200529     F*    11  - Not Found(SDCWHTL1)                                  *                       CSD015
021000200529     F*    11  - Debtor Identification                                *                       CSW210
021100200529     F*    12  - Debtor Account Line                                  *                       CSW210
021200200529     F*    14  - Debtor Address Line                                  *                       CSW210
021300200529     F*    15  - Debtor Address Line                                  *                       CSW210
021400200529     F*    16  - Debtor Address Line                                  *                       CSW210
021500200529     F*    17  - Debtor Address Line                                  *                       CSW210
021600200529     F*    19  - Investor                                             *   CSW098
021700200529     F*    20  - Switchable feature CSW098 is on or date is greater   *   CSW098
021800200529     F*          than 16 October 1998. Can also be error on call to   *   CSW098
021900200529     F*          SWIFT98.                                             *   CSW098
022000200529     F*    21  - A/c for Payment (MT510)                              *
022100200529     F*    22  -   "                                                  *
022200200529     F*    23  - A/c for Payment                                      *
022300200529     F*    24  -   "                                                  *
022400200529     F*    25  - A/c with Institution                                 *
022500200529     F*    26  -   "                                                  *
022600200529     F*    27  -   "                                                  *
022700200529     F*    28  - Beneficiary of Money                                 *
022800200529     F*    29  -   "                                                  *
022900200529     F*    30  -   "                                                  *
023000200529     F*    31  -   "                                                  *
023100200529     F*    32  - A/c for Charges                                      *
023200200529     F*    33  -   "                                                  *
023300200529     F*    34  - Sender to Receiver Information                       *
023400200529     F*    35  -   "                                                  *
023500200529     F*    36  -   "                                                  *
023600200529     F*    37  - Further Information                                  *
023700200529     F*    38  -   "                                                  *
023800200529     F*    39  - Registration Details                                 *
023900200529     F*    40  -   "                                                  *
024000200529     F*    41  - Narrative                                            *
024100200529     F*    42  -   "                                                  *
024200200529     F*    43  - Instructing Party                                    *
024300200529     F*    44  -   "                                                  *
024400200529     F*    45  - Counterparty (MT512)                                 *
024500200529     F*    46  -   "                                                  *
024600200529     F*    47  - Safekeeping A/c (MT510)                              *
024700200529     F*    48  -   "                                                  *
024800200529     F*    49  - Safekeeping A/c                                      *
024900200529     F*    50  -   "                                                  *
025000200529     F*    51  - Clearing Correspondent                               *
025100200529     F*    52  - Deliverer's Instructing Party                        *
025200200529     F*    53  - Receiver of Securities                               *
025300200529     F*    54  -   "                                                  *
025400200529     F*    55  -   "                                                  *
025500200529     F*    56  -   "                                                  *
025600200529     F*    57  -   "                                                  *
025700200529     F*    58  -   "                                                  *
025800200529     F*    59  - Deliverer of Securities                              *
025900200529     F*    60  -   "                                                  *
026000200529     F*    61  -   "                                                  *
026100200529     F*    62  -   "                                                  *
026200200529     F*    63  -   "                                                  *
026300200529     F*    64  -   "                                                  *
026400200529     F*    65  - Beneficiary Securities                               *
026500200529     F*    66  -   "                                                  *
026600200529     F*    67  -   "                                                  *
026700200529     F*    68  -   "                                                  *
026800200529     F*    69  - Indicator for SFLEND in SE1806DF                     *
026900200529     F*    70  - Receive message and CSE029 is on                     *                       209247
027000200529     F*    71  - Deliver message and CSE029 is on                     *                       209247
027100200529     F*    75  - General error in validation                          *
027200200529      *    76  - CSE028 is switched on                                *                       CSE028
027300200529      *    77  - ISO15022 is 'Y'                                      *                       CSE028
027400200529      *    79  - CHAIN in file SEMKCD                                 *                       215783
027500200529     F*    80  - No record found on chain                             *
027600200529     F*    81  - Work indicator                                       *
027700200529     F*    82  - Work indicator                                       *
027800200529      *    83  - CHAIN Indicator                                      *                       CSE028
027900200529      *    84  - Rollup on second screen                              *                       CSE028
028000200529     F*    85  - Rollup on first screen                               *
028100200529     F*    86  - Rolldown on second screen                            *
028200200529     F*    87  - Rolldown on first screen                             *
028300200529     F*    88  - Error on file update                                 *
028400200529     F*    89  - Error on file update                                 *
028500200529     F*                                                               *
028600200529     F*  90-99 - Used by Standard Subroutines                         *
028700200529     F*                                                               *
028800200529     F*  U7+U8 - Database Error                                       *
028900200529     F*                                                               *
029000200529     F*    KL  - Previous screen requested                            *
029100200529     F*    KS  - F18 - Override requested                             *
029200200529     F*    KT  - F19 - Reset Requested                                *
029300200529     F*                                                               *
029400200529     F*****************************************************************
029500200529      /EJECT
029600200529     F*****************************************************************
029700200529     F*                                                               *
029800200529     F*  S U B R O U T I N E   I N D E X                              *
029900200529     F*                                                               *
030000200529     F*  SRINS  - Process Insert                                      *
030100200529     F*  SRAMD  - Process Amend                                       *
030200200529     F*  SRENQ  - Process Enquiry                                     *
030300200529     F*  SRSMSG - Routine to send messages to message subfile.        *
030400200529     F*  SRALOC - Routine to access record via update index           *
030500200529     F*  SRRTRN - Routine to set up return code for calling program   *
030600200529     F*  SRSCR1 - Routine to output messages and first screen         *
030700200529     F*  SRSCR2 - Routine to output messages and second screen        *
030800200529      *  SRSCR3 - Routine to output third screen                      *                       CSE028
030900200529     F*  SRVAL  - Routine to control validation of each field.        *
031000200529     F*  SRAP1N - Validate A/c for Payment :53: (MT510)               *
031100200529     F*  SRAP1L - Validate A/c for Payment A/c Line :53: (MT510)      *
031200200529     F*  SRAFPN - Validate A/c for Payment :53:                       *
031300200529     F*  SRAFPL - Validate A/c for Payment A/c Line :53:              *
031400200529     F*  SRAWIA - Validate A/c with Institution TAG :57:              *
031500200529     F*  SRAWIN - Validate A/c with Institution :57:                  *
031600200529     F*  SRAWIL - Validate A/c with Institution A/c Line :57:         *
031700200529     F*  SRDIDN - Validate Debtor Identification                      *                       CSW210
031800200529     F*  SRDADD - Validate Debtor Address                             *                       CSW210
031900200529     F*  SRDLIN - Validate Debtor Account Line                        *                       CSW210
032000200529     F*  SRSWFT - SWIFT Address validation                            *                       CSW210
032100200529     F*  SRACHK - Validate Address Fields                             *                       CSW210
032200200529     F*  SRSWST - Check for valid Swift character used                *                       CSW210
032300200529     F*  SRVCDE - Checks the syntax of code word                      *                       CSW210
032400200529     F*  SRIBAN - IBAN Validation                                     *                       CSW210
032500200529     F*  SREMSG - To Send Messages to Message Subfile with            *                       CSW210
032600200529     F*           Message Data                                        *                       CSW210
032700200529     F*  SRBOFA - Validate Beneficiary of Money TAG :58:              *
032800200529     F*  SRBOFN - Validate Beneficiary of Money :58:                  *
032900200529     F*  SRBOF1 - Validate Beneficiary of Money A/c Line :58:         *
033000200529     F*  SRBOF2 - Validate Beneficiary of Money A/c Line :58:         *
033100200529     F*  SRACL1 - Validate A/c Charges Line 1 :71:                    *
033200200529     F*  SRACL2 - Validate A/c Charges Line 2 :71:                    *
033300200529     F*  SRSRL1 - Validate Sender to Receiver Info Line 1 :72:        *
033400200529     F*  SRSRL2 - Validate Sender to Receiver Info Line 2 :72:        *
033500200529     F*  SRSRL3 - Validate Sender TO Receiver INFO Line 3 :72:        *
033600200529     F*  SRFIN1 - Validate Further Information Line 1 :77:            *
033700200529     F*  SRFIN2 - Validate Further Information Line 2 :77:            *
033800200529     F*  SRRED1 - Validate Registration Details Line 1 :77:           *
033900200529     F*  SRRED2 - Validate Registration Details Line 1 :77:           *
034000200529     F*  SRNAL1 - Validate Narrative 1 :79:                           *
034100200529     F*  SRNAL2 - Validate Narrative 2 :79:                           *
034200200529     F*  SRIPYN - Validate Instructing Party :82:                     *
034300200529     F*  SRIPYL - Validate Instructing Party A/c Line :82:            *
034400200529     F*  SRCTYN - Validate Counterparty :82:                          *
034500200529     F*  SRCTYL - Validate Counterparty A/c Line :82:                 *
034600200529     F*  SRSA1N - Validate Safekeeping Account :83: (MT510)           *
034700200529     F*  SRSA1L - Validate Safekeeping Account A/c Line :83: (MT510)  *
034800200529     F*  SRSKAN - Validate Safekeeping Account :83:                   *
034900200529     F*  SRSKAL - Validate Safekeeping Account A/c Line :83:          *
035000200529     F*  SRCCTN - Validate Clearing Correspondent :84:                *
035100200529     F*  SRDCTL - Validate Deliver's Instructing Party :85:           *
035200200529     F*  SRRSSA - Validate Receiver of Securities TAG :87:            *
035300200529     F*  SRRSSN - Validate Receiver of Securities :87:                *
035400200529     F*  SRRSS1 - Validate Receiver of Securities A/c Line 1 :87:     *
035500200529     F*  SRRSS2 - Validate Receiver of Securities A/c Line 2 :87:     *
035600200529     F*  SRRSS3 - Validate Receiver of Securities A/c Line 3 :87:     *
035700200529     F*  SRRSS4 - Validate Receiver of Securities A/c Line 4 :87:     *
035800200529     F*  SRDSSA - Validate Deliverer of Securities TAG :87:           *
035900200529     F*  SRDSSN - Validate Deliverer of Securities :87:               *
036000200529     F*  SRDSS1 - Validate Deliverer of Securities A/c Line 1 :87:    *
036100200529     F*  SRDSS2 - Validate Deliverer of Securities A/c Line 2 :87:    *
036200200529     F*  SRDSS3 - Validate Deliverer of Securities A/c Line 3 :87:    *
036300200529     F*  SRDSS4 - Validate Deliverer of Securities A/c Line 4 :87:    *
036400200529     F*  SRBSSA - Validate Beneficiary of Securities TAG :88:         *
036500200529     F*  SRBSSN - Validate Beneficiary of Securities :88:             *
036600200529     F*  SRBSS1 - Validate Beneficiary of Securities A/c Line :88:    *
036700200529     F*  SRBSS2 - Validate Beneficiary of Securities A/c Line :88:    *
036800200529     F*  SRCUST - Validate Customer Number/Shortname/Nostro           *
036900200529     F*  SRLI35 - Validate A 35 Alpha Input Field                     *
037000200529     F*  SRME99 - Validate a 35 Alpha Input Field via ME9940          *   CSW098
037100200529     F*  SRINVE - Validate Investor.                                  *   CSW098
037200200529     F*  SRFMT  - Format watch list fields                            *                       CSD015
037300200529     F*  SRCWV1 - Validate if watch list field is not blanks.         *                       CSD015
037400200529     F*  SRCWV2 - Validate if watch list field has been changed.      *                       CSD015
037500200529     F*  SRCLS2 - To Clear Fields on Second Screen                    *
037600200529     F*  SRRTS2 - To Reset Fields on Second Screen to File Values     *
037700200529     F*  SRFTOS - To Move File Fields to Screen Fields                *
037800200529     F*  SRSTOF - To Move Screen Fields to File Fields                *
037900200529     F*  SRINIT - Routine to handle initial processing                *
038000200529     F*  *PSSR  - Routine to handle database errors                   *
038100200529     F*                                                               *
038200200529     F*  ZALIGN - Validate and right-align Numeric Fields             *
038300200529     F*  ZSEDIT - Insert dec. point and sign into numeric field and   *
038400200529     F*           blank out leading zeros, optionally inserting commas*
038500200529     F*                                                               *
038600200529     F*  ZA0340 - Send a message to the program message queue         *
038700200529     F*  ZA0250 - Clear program message queue                         *
038800200529     F*                                                               *
038900200529     F*****************************************************************
039000200529     E/EJECT
039100200529     E                    CPY@    1   1 80
039200200529     E                    CCO        12  1               Clearing Correspondent
039300200529     E                    VA0    36  36  1               Validations Alpha
039400200529     E**********          CWA     1  30 25               Midas Compliance Watch Tags   CSD015 CSW210
039500200529     E                    CWA     1  34 25               Midas Compliance Watch Tags          CSW210
039600200529     E                    WARY       10  1                                                    CSW201
039700200529      ** Work Array                                                                           CSW201
039800200529      *                                                                                       CSD015
039900200529     E**********          WLF        13 35                                             CSD015 CSW210
040000200529     E                    WLF        15 35                                                    CSW210
040100200529     E                    MMD         9 35                                                    CSD015
040200200529     E                    MSA         9 35                                                    CSD015
040300200529      **  Watch List Fields Work Arrays.                                                      CSD015
040400200529      *                                                                                       CSD015
040500200529     E                    STAMP   1   1 26                                                    CSE045
040600200529      ** Array containing Dummy Timestamp for Initialisation                                  CSE045
040700200529     E                    S210W   1   4 45                                                    CSW210
040800200529      * IBAN warning array                                                                    CSW210
040900200529     E*
041000200529     E/COPY ZSRSRC,ZALIGNZ1
041100200529     E*
041200200529     E/COPY ZSRSRC,ZSEDITZ1
041300200529     E*
041400200529     I/EJECT
041500200529     I/COPY ZSRSRC,ZSEDITZ2
041600200529      ** ZSEDIT data structure
041700200529      *
041800200529     IWWDS1       DS                             35
041900200529     I                                        1  35 WWLI35
042000200529     I                                        5   7 WW0507
042100200529     I                                        5  10 WW0510
042200200529     I                                        5  12 WW0512
042300200529     I                                        5  13 WW0513
042400200529     I                                        5  35 WW0535
042500200529     I                                        8  35 WW0835
042600200529     I                                       11  35 WW1135
042700200529     I                                       13  35 WW1335
042800200529     I                                       14  35 WW1435
042900200529      *
043000200529     I           SDS
043100200529      ** Get program name and window id from PSDS
043200200529     I                                     *PROGRAM WWPGM
043300200529     I                                      244 253 SJOB
043400200529     I                                      254 263 SUSER
043500200529      *
043600200529     I/COPY WNCPYSRC,SE1806I001
043700200529     IDSFDY     E DSDSFDY
043800200529      ** First Data Structure for Access Objects
043900200529      *
044000200529     IDSSDY     E DSDSSDY
044100200529      ** Second Data Structure for Access Objects
044200200529      *
044300200529     ISC24X7    E DSSC24X7                                                                    CSD015
044400200529      * 24X7 Data Structure                                                                   CSD015
044500200529      *                                                                                       CSD015
044600200529     ISDSTAT    E DSSDSTAT                                                                    CSD015
044700200529      * SDSTAT Data Structure                                                                 CSD015
044800200529      *                                                                                       CSD015
044900200529     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
045000200529      ** Midas Functions for Watch List Checking Deatils File                                 CSD015
045100200529      *                                                                                       CSD015
045200200529     ISCSARD    E DSSCSARDPD                                                                  CSD015
045300200529     I              LCD                             SARLCD                                    CSD015
045400200529      ** External DS for SAR details                                                          CSD015
045500200529      *                                                                                       CSD015
045600200529     ISDBANK    E DSSDBANKPD
045700200529      ** Bank details
045800200529      *
045900200529     ISDBRCH    E DSSDBRCHPD
046000200529      ** Branch details
046100200529      *
046200200529     ISDCUST    E DSSDCUSTPD
046300200529     I              QQDFAC                          QQDFAX                                    CGL029
046400200529      ** Customer details
046500200529      *
046600200529     ISDCNST    E DSSDCNSTPD
046700200529      ** Counterparty Nostro details
046800200529      *                                                                   CSW003
046900200529     ISDSECS    E DSSDSECSPD                                              CSW003
047000200529      ** Security Customer details                                        CSW003
047100200529      *
047200200529     IMEBICD    E DSMEBICDPD                                                                  CSW210
047300200529      ** Bank details                                                                         CSW210
047400200529      *                                                                                       CSW210
047500200529      ** DS for Trade Purchase                                                                CSE028
047600200529      *                                                                                       CSE028
047700200529     IPRTPCS    E DSSTDADSED                                                                  CSE028
047800200529     I              SARECI                          W4RECI                                    CSE028
047900200529     I              SABCH                           W4BCH                                     CSE028
048000200529     I              SACUST                          W4CUST                                    CSE028
048100200529     I              SABK                            W4BK                                      CSE028
048200200529     I              SACCY                           W4CCY                                     CSE028
048300200529     I              SAINV                           W4INV                                     CSE028
048400200529     I              SAPREF                          W4PREF                                    CSE028
048500200529     I              SATYPE                          W4TYPE                                    CSE028
048600200529     I              SAGMES                          W4GMES                                    CSE028
048700200529     I              SACONG                          W4CONG                                    CSE028
048800200529     I              SAINST                          W4INST                                    CSE028
048900200529     I              SAINSS                          W4INSS                                    CSE028
049000200529     I              SARPTY                          W4RPTY                                    CSE028
049100200529     I              SAGDEL                          W4GDEL                                    CSE028
049200200529     I              SASROL                          W4SROL                                    CSE028
049300200529     I              SAFIND                          W4FIND                                    CSE028
049400200529     I              SACCTN                          W4CCTN                                    CSE028
049500200529     I              SADRSN                          W4DRSN                                    CSE028
049600200529     I              SADRS1                          W4DRS1                                    CSE028
049700200529     I              SADRS2                          W4DRS2                                    CSE028
049800200529     I              SADRS3                          W4DRS3                                    CSE028
049900200529     I              SADRS4                          W4DRS4                                    CSE028
050000200529     I              SABSSN                          W4BSSN                                    CSE028
050100200529     I              SABSS1                          W4BSS1                                    CSE028
050200200529     I              SABSS2                          W4BSS2                                    CSE028
050300200529     I              SAFIN1                          W4FIN1                                    CSE028
050400200529     I              SAFIN2                          W4FIN2                                    CSE028
050500200529     I              SARED1                          W4RED1                                    CSE028
050600200529     I              SARED2                          W4RED2                                    CSE028
050700200529     I              SANAS1                          W4NAS1                                    CSE028
050800200529     I              SANAS2                          W4NAS2                                    CSE028
050900200529     I              SAIMD1                          W4IMD1                                    CSE028
051000200529     I              SAIMD2                          W4IMD2                                    CSE028
051100200529     I              SAIMD3                          W4IMD3                                    CSE028
051200200529     I              SAIMD4                          W4IMD4                                    CSE028
051300200529     I              SAIMD5                          W4IMD5                                    CSE028
051400200529     I              SAIMD6                          W4IMD6                                    CSE028
051500200529     I              SAIMD7                          W4IMD7                                    CSE028
051600200529     I              SAIMD8                          W4IMD8                                    CSE028
051700200529     I              SAIMD9                          W4IMD9                                    CSE028
051800200529     I              SAIMS1                          W4IMS1                                    CSE028
051900200529     I              SAIMS2                          W4IMS2                                    CSE028
052000200529     I              SAIMS3                          W4IMS3                                    CSE028
052100200529     I              SAIMS4                          W4IMS4                                    CSE028
052200200529     I              SAIMS5                          W4IMS5                                    CSE028
052300200529     I              SAIMS6                          W4IMS6                                    CSE028
052400200529     I              SAIMS7                          W4IMS7                                    CSE028
052500200529     I              SAIMS8                          W4IMS8                                    CSE028
052600200529     I              SAIMS9                          W4IMS9                                    CSE028
052700200529     I              SAPSET                          W4PSET                                    CSE028
052800200529     I              SAAWIN                          W4AWIN                                    CSE028
052900200529     I              SAAWIL                          W4AWIL                                    CSE028
053000200529     I              SAAFPN                          W4AFPN                                    CSE028
053100200529     I              SAAFPL                          W4AFPL                                    CSE028
053200200529     I              SABOFN                          W4BOFN                                    CSE028
053300200529     I              SABOF1                          W4BOF1                                    CSE028
053400200529     I              SABOF2                          W4BOF2                                    CSE028
053500200529     I              SASRL1                          W4SRL1                                    CSE028
053600200529     I              SASRL2                          W4SRL2                                    CSE028
053700200529     I              SASRL3                          W4SRL3                                    CSE028
053800200529     I              SANAC1                          W4NAC1                                    CSE028
053900200529     I              SANAC2                          W4NAC2                                    CSE028
054000200529     I              SASTMP                          W4STMP                                    CSE028
054100200529     I              SACHID                          W4CHID                                    CSE028
054200200529     I              SATRRM                          W4TRRM                                    CSE028
054300200529     I              SAMKT                           W4SMKT                                    CSE034
054400200529     I              SADIDN                          W4DIDN                                    CSW210
054500200529     I              SADAD1                          W4DAD1                                    CSW210
054600200529     I              SADAD2                          W4DAD2                                    CSW210
054700200529     I              SADAD3                          W4DAD3                                    CSW210
054800200529     I              SADAD4                          W4DAD4                                    CSW210
054900200529     I              SADLIN                          W4DLIN                                    CSW210
055000200529     I              SAQFIN                          W4QFIN                                    CSW210
055100200529     I              SAPCLR                          W4PCLR                                    CSW210
055200200529      *                                                                                       CSE028
055300200529      ** DS for Trade Sale                                                                    CSE028
055400200529      *                                                                                       CSE028
055500200529     IPRTSCS    E DSSTDADSED                                                                  CSE028
055600200529     I              SARECI                          W5RECI                                    CSE028
055700200529     I              SABCH                           W5BCH                                     CSE028
055800200529     I              SACUST                          W5CUST                                    CSE028
055900200529     I              SABK                            W5BK                                      CSE028
056000200529     I              SACCY                           W5CCY                                     CSE028
056100200529     I              SAINV                           W5INV                                     CSE028
056200200529     I              SAPREF                          W5PREF                                    CSE028
056300200529     I              SATYPE                          W5TYPE                                    CSE028
056400200529     I              SAGMES                          W5GMES                                    CSE028
056500200529     I              SACONG                          W5CONG                                    CSE028
056600200529     I              SAINST                          W5INST                                    CSE028
056700200529     I              SAINSS                          W5INSS                                    CSE028
056800200529     I              SARPTY                          W5RPTY                                    CSE028
056900200529     I              SAGDEL                          W5GDEL                                    CSE028
057000200529     I              SASROL                          W5SROL                                    CSE028
057100200529     I              SAFIND                          W5FIND                                    CSE028
057200200529     I              SACCTN                          W5CCTN                                    CSE028
057300200529     I              SADRSN                          W5DRSN                                    CSE028
057400200529     I              SADRS1                          W5DRS1                                    CSE028
057500200529     I              SADRS2                          W5DRS2                                    CSE028
057600200529     I              SADRS3                          W5DRS3                                    CSE028
057700200529     I              SADRS4                          W5DRS4                                    CSE028
057800200529     I              SABSSN                          W5BSSN                                    CSE028
057900200529     I              SABSS1                          W5BSS1                                    CSE028
058000200529     I              SABSS2                          W5BSS2                                    CSE028
058100200529     I              SAFIN1                          W5FIN1                                    CSE028
058200200529     I              SAFIN2                          W5FIN2                                    CSE028
058300200529     I              SARED1                          W5RED1                                    CSE028
058400200529     I              SARED2                          W5RED2                                    CSE028
058500200529     I              SANAS1                          W5NAS1                                    CSE028
058600200529     I              SANAS2                          W5NAS2                                    CSE028
058700200529     I              SAIMD1                          W5IMD1                                    CSE028
058800200529     I              SAIMD2                          W5IMD2                                    CSE028
058900200529     I              SAIMD3                          W5IMD3                                    CSE028
059000200529     I              SAIMD4                          W5IMD4                                    CSE028
059100200529     I              SAIMD5                          W5IMD5                                    CSE028
059200200529     I              SAIMD6                          W5IMD6                                    CSE028
059300200529     I              SAIMD7                          W5IMD7                                    CSE028
059400200529     I              SAIMD8                          W5IMD8                                    CSE028
059500200529     I              SAIMD9                          W5IMD9                                    CSE028
059600200529     I              SAIMS1                          W5IMS1                                    CSE028
059700200529     I              SAIMS2                          W5IMS2                                    CSE028
059800200529     I              SAIMS3                          W5IMS3                                    CSE028
059900200529     I              SAIMS4                          W5IMS4                                    CSE028
060000200529     I              SAIMS5                          W5IMS5                                    CSE028
060100200529     I              SAIMS6                          W5IMS6                                    CSE028
060200200529     I              SAIMS7                          W5IMS7                                    CSE028
060300200529     I              SAIMS8                          W5IMS8                                    CSE028
060400200529     I              SAIMS9                          W5IMS9                                    CSE028
060500200529     I              SAPSET                          W5PSET                                    CSE028
060600200529     I              SAAWIN                          W5AWIN                                    CSE028
060700200529     I              SAAWIL                          W5AWIL                                    CSE028
060800200529     I              SAAFPN                          W5AFPN                                    CSE028
060900200529     I              SAAFPL                          W5AFPL                                    CSE028
061000200529     I              SABOFN                          W5BOFN                                    CSE028
061100200529     I              SABOF1                          W5BOF1                                    CSE028
061200200529     I              SABOF2                          W5BOF2                                    CSE028
061300200529     I              SASRL1                          W5SRL1                                    CSE028
061400200529     I              SASRL2                          W5SRL2                                    CSE028
061500200529     I              SASRL3                          W5SRL3                                    CSE028
061600200529     I              SANAC1                          W5NAC1                                    CSE028
061700200529     I              SANAC2                          W5NAC2                                    CSE028
061800200529     I              SASTMP                          W5STMP                                    CSE028
061900200529     I              SACHID                          W5CHID                                    CSE028
062000200529     I              SATRRM                          W5TRRM                                    CSE028
062100200529     I              SAMKT                           W5SMKT                                    CSE034
062200200529     I              SADIDN                          W5DIDN                                    CSW210
062300200529     I              SADAD1                          W5DAD1                                    CSW210
062400200529     I              SADAD2                          W5DAD2                                    CSW210
062500200529     I              SADAD3                          W5DAD3                                    CSW210
062600200529     I              SADAD4                          W5DAD4                                    CSW210
062700200529     I              SADLIN                          W5DLIN                                    CSW210
062800200529     I              SAQFIN                          W5QFIN                                    CSW210
062900200529     I              SAPCLR                          W5PCLR                                    CSW210
063000200529      *                                                                                       CSW210
063100200529     IDADDRS      DS                            140                                           CSW210
063200200529      ** Data structure for Debtor Address Line                                               CSW210
063300200529     I                                        1  35 DSDAD1                                    CSW210
063400200529     I                                       36  70 DSDAD2                                    CSW210
063500200529     I                                       70  70 DSDA34                                  AR640699
063600200529     I                                       71 105 DSDAD3                                    CSW210
063700200529     I                                      106 140 DSDAD4                                    CSW210
063800200529      *                                                                                       CSE028
063900200529      ** DS for customer/book standard settlement instruction                                 CSE028
064000200529      **  to be passed to SESSIR0                                                             CSE028
064100200529      *                                                                                       CSE028
064200200529     IPCBSTD    E DSSTDSED                    2                                               CSE028
064300200529      *                                                                                       CSE028
064400200529      ** Data structure for standard additional settlement details                            CSE028
064500200529      ** for customer/book to be passed to SESSIR0                                            CSE028
064600200529      *                                                                                       CSE028
064700200529     IPCBSAD    E DSSTDADSED                  8                                               CSE028
064800200529      *                                                                                       CSE028
064900200529     IPMCWL       DS                           9999                                           CSD015
065000200529     ITEMPDS      DS                           3000                                           CSD015
065100200529      ** Additional entry parameter for Midas Compliance Watch                                CSD015
065200200529      *                                                                                       CSD015
065300200529     IDBERR       DS                            256
065400200529      ** Data structure for data-base error processing.
065500200529     I                                      134 141 DBFILE
065600200529     I                                      142 170 DBKEY
065700200529     I                                      171 180 DBPGM
065800200529     I                                      181 1830DBASE
065900200529      *
066000200529     IPDATA     E DSSE50DT
066100200529      ** Data structure to receive parameters from SE1805 for MT5xxs
066200200529     ITRADX2    E DSTRADSDX2
066300200529      **  Data structure for breaking up details of TRADSDX2 into
066400200529      **  renamed fields
066500200529      *
066600200529     I              T2TDRF                          W2TDRF
066700200529     I              T2AP1N                          W2AP1N
066800200529     I              T2AP1L                          W2AP1L
066900200529     I              T2AFPN                          W2AFPN
067000200529     I              T2AFPL                          W2AFPL
067100200529     I              T2AWIA                          W2AWIA
067200200529     I              T2AWIN                          W2AWIN
067300200529     I              T2AWIL                          W2AWIL
067400200529     I              T2BOFA                          W2BOFA
067500200529     I              T2BOFN                          W2BOFN
067600200529     I              T2BOF1                          W2BOF1
067700200529     I              T2BOF2                          W2BOF2
067800200529     I              T2ACL1                          W2ACL1
067900200529     I              T2ACL2                          W2ACL2
068000200529     I              T2SRL1                          W2SRL1
068100200529     I              T2SRL2                          W2SRL2
068200200529     I              T2SRL3                          W2SRL3
068300200529     I              T2FIN1                          W2FIN1
068400200529     I              T2FIN2                          W2FIN2
068500200529     I              T2RED1                          W2RED1
068600200529     I              T2RED2                          W2RED2
068700200529     I              T2NAL1                          W2NAL1
068800200529     I              T2NAL2                          W2NAL2
068900200529     I              T2IPYN                          W2IPYN
069000200529     I              T2IPYL                          W2IPYL
069100200529     I              T2CTYN                          W2CTYN
069200200529     I              T2CTYL                          W2CTYL
069300200529     I              T2SA1N                          W2SA1N
069400200529     I              T2SA1L                          W2SA1L
069500200529     I              T2SKAN                          W2SKAN
069600200529     I              T2SKAL                          W2SKAL
069700200529     I              T2CCTN                          W2CCTN
069800200529     I              T2DCTL                          W2DCTL
069900200529     I              T2RSSA                          W2RSSA
070000200529     I              T2RSSN                          W2RSSN
070100200529     I              T2RSS1                          W2RSS1
070200200529     I              T2RSS2                          W2RSS2
070300200529     I              T2RSS3                          W2RSS3
070400200529     I              T2RSS4                          W2RSS4
070500200529     I              T2DSSA                          W2DSSA
070600200529     I              T2DSSN                          W2DSSN
070700200529     I              T2DSS1                          W2DSS1
070800200529     I              T2DSS2                          W2DSS2
070900200529     I              T2DSS3                          W2DSS3
071000200529     I              T2DSS4                          W2DSS4
071100200529     I              T2BSSA                          W2BSSA
071200200529     I              T2BSSN                          W2BSSN
071300200529     I              T2BSS1                          W2BSS1
071400200529     I              T2BSS2                          W2BSS2
071500200529     I              T2INVE                          W2INVE                CSW098
071600200529     I              T2DIDN                          W2DIDN                                    CSW210
071700200529     I              T2DAD1                          W2DAD1                                    CSW210
071800200529     I              T2DAD2                          W2DAD2                                    CSW210
071900200529     I              T2DAD3                          W2DAD3                                    CSW210
072000200529     I              T2DAD4                          W2DAD4                                    CSW210
072100200529     I              T2DLIN                          W2DLIN                                    CSW210
072200200529     I              T2QFIN                          W2QFIN                                    CSW210
072300200529     I              T2PCLR                          W2PCLR                                    CSW210
072400200529      *                                                                   CSW098
072500200529      * Input Parameters                                                  CSW098
072600200529      *                                                                   CSW098
072700200529     I***I#PARM*     DS                            512                                 CSW098 CGL029
072800200529     II#PARM      DS                            514                                           CGL029
072900200529      * Field to be validated                                             CSW098
073000200529     I                                        1   5 I#VFLD                CSW098
073100200529      * Pay/Receive Settlement (PAY/REC)                                  CSW098
073200200529     I                                        6   8 I#PR                  CSW098
073300200529      * Customer/Counterparty Nostro /BIC indentified type                CSW098
073400200529      *    C           X              S  X-> C'party Nostro or Customer   CSW098
073500200529      * Customer/Counterparty/BIC indentified                             CSW098
073600200529     I                                        9   9 I#PRTT                CSW098
073700200529     I                                       10  20 I#PRTY                CSW098
073800200529      * Pay Currency                                                      CSW098
073900200529     I                                       21  23 I#PCCY                CSW098
074000200529      * Receive Currency                                                  CSW098
074100200529     I                                       24  26 I#RCCY                CSW098
074200200529      * Account Line                                                      CSW098
074300200529     I                                       27  61 I#ACLN                CSW098
074400200529      * Account Line Character 1                                          CSW098
074500200529     I                                       27  27 I#ACC1                CSW098
074600200529      * Account Line Character 2                                          CSW098
074700200529     I                                       28  28 I#ACC2                CSW098
074800200529      * Account Line Character 3                                          CSW098
074900200529     I                                       29  29 I#ACC3                CSW098
075000200529      * Account Line first 4 characters                                   CSW098
075100200529     I                                       27  30 I#ACCL                CSW098
075200200529      * Account Line Clearing System                                      CSW098
075300200529     I                                       29  30 I#ACCS                CSW098
075400200529      * Account Line No account data                                      CSW098
075500200529     I                                       31  61 I#SPC1                CSW098
075600200529      * Message Type                                                      CSW098
075700200529     I                                       62  64 I#MTYP                CSW098
075800200529      * Intermediary Institution for Bank to Bank validation              CSW098
075900200529     I                                       65  65 I#INBT                CSW098
076000200529     I                                       66  76 I#INBK                CSW098
076100200529      * Account with Institution for Bank to Bank validation              CSW098
076200200529     I                                       77  77 I#AWBT                CSW098
076300200529     I                                       78  88 I#AWBK                CSW098
076400200529      * Beneficiary for Bank to Bank validation                           CSW098
076500200529     I                                       89  89 I#BENT                CSW098
076600200529     I                                       90 100 I#BENF                CSW098
076700200529      * Pay and Receive Settlement Methods                                CSW098
076800200529     I                                      101 102 I#RSTM                CSW098
076900200529     I                                      103 104 I#PSTM                CSW098
077000200529      * Field 53 and 54 Entered                                           CSW098
077100200529     I                                      105 105 I#5354                CSW098
077200200529      * Midas Module                                                      CSW098
077300200529     I                                      106 107 I#MMOD                CSW098
077400200529      * Pay and Receive Settlement Accounts                               CSW098
077500200529     I**********                            108 125 I#PYAC                             CSW098 CGL029
077600200529     I**********                            126 143 I#RCAC                             CSW098 CGL029
077700200529     I                                      108 125 QQPYAC                                    CGL029
077800200529     I                                      126 143 QQRCAC                                    CGL029
077900200529      * Transaction Type                                                  CSW098
078000200529     I                                      144 145 I#TTYP                CSW098
078100200529      * Cover required                                                    CSW098
078200200529     I                                      146 146 I#COVR                CSW098
078300200529      * Bank to Bank Information                                          CSW098
078400200529     I                                      257 466 I#BTB                 CSW098
078500200529     I                                      257 291 I#BTB1                CSW098
078600200529     I                                      292 326 I#BTB2                CSW098
078700200529     I                                      327 361 I#BTB3                CSW098
078800200529     I                                      362 396 I#BTB4                CSW098
078900200529     I                                      397 431 I#BTB5                CSW098
079000200529     I                                      432 466 I#BTB6                CSW098
079100200529     I                                      467 490 I#PYAC                                    CGL029
079200200529     I                                      491 514 I#RCAC                                    CGL029
079300200529      *                                                                   CSW098
079400200529      * Output Parameters                                                 CSW098
079500200529      *                                                                   CSW098
079600200529     I***O#PARM*     DS                            512                                 CSW098 CGL029
079700200529     IO#PARM      DS                            514                                           CGL029
079800200529      * Account Line modified                                             CSW098
079900200529     I                                        1  35 O#ACLN                CSW098
080000200529      * Bank to Bank Information                                          CSW098
080100200529     I                                      257 466 O#BTB                 CSW098
080200200529     I                                      257 291 O#BTB1                CSW098
080300200529     I                                      292 326 O#BTB2                CSW098
080400200529     I                                      327 361 O#BTB3                CSW098
080500200529     I                                      362 396 O#BTB4                CSW098
080600200529     I                                      397 431 O#BTB5                CSW098
080700200529     I                                      432 466 O#BTB6                CSW098
080800200529      *                                                                   CSW098
080900200529      * Error Parameters                                                  CSW098
081000200529      *                                                                   CSW098
081100200529     IE#PARM      DS                            256                       CSW098
081200200529      * Calling Program                                                   CSW098
081300200529     I                                        1  10 E#CPGM                CSW098
081400200529      * Error message sent                                                CSW098
081500200529     I                                       12  12 E#ERRM                CSW098
081600200529      * Warning message sent                                              CSW098
081700200529     I                                       13  13 E#WARN                CSW098
081800200529      * Error index                                                       CSW098
081900200529     I                                       14  180E#INDX                CSW098
082000200529      * Message text to prefix error message                              CSW098
082100200529     I                                       19  25 E#MSGD                CSW098
082200200529     I                                       26  35 E#MSGF                CSW098
082300200529      * Error codes array                                                 CSW098
082400200529     I                                       51 200 E#ERCD                CSW098
082500200529     I                                       51 200 O#E                   CSW098
082600200529      *                                                                                       CSE028
082700200529     IPNARR       DS                                                                          CSE028
082800200529     I                                        1  35 PNARR1                                    CSE028
082900200529     I                                       36  70 PNARR2                                    CSE028
083000200529      *                                                                                       CSE028
083100200529     IPINTRM      DS                                                                          CSE028
083200200529     I                                        1  12 PIMMD1                                    CSE028
083300200529     I                                       13  24 PIMMD2                                    CSE028
083400200529     I                                       25  36 PIMMD3                                    CSE028
083500200529     I                                       37  48 PIMMD4                                    CSE028
083600200529     I                                       49  60 PIMMD5                                    CSE028
083700200529     I                                       61  72 PIMMD6                                    CSE028
083800200529     I                                       73  84 PIMMD7                                    CSE028
083900200529     I                                       85  96 PIMMD8                                    CSE028
084000200529     I                                       97 108 PIMMD9                                    CSE028
084100200529      *                                                                                       CSE028
084200200529     IPSAFEA      DS                                                                          CSE028
084300200529     I                                        1  20 PIMSA1                                    CSE028
084400200529     I                                       21  40 PIMSA2                                    CSE028
084500200529     I                                       41  60 PIMSA3                                    CSE028
084600200529     I                                       61  80 PIMSA4                                    CSE028
084700200529     I                                       81 100 PIMSA5                                    CSE028
084800200529     I                                      101 120 PIMSA6                                    CSE028
084900200529     I                                      121 140 PIMSA7                                    CSE028
085000200529     I                                      141 160 PIMSA8                                    CSE028
085100200529     I                                      161 180 PIMSA9                                    CSE028
085200200529      *
085300200529     I            DS                                                                          CSW210
085400200529      *                                                                                       CSW210
085500200529      ** Data Structure redefining Address fields                                             CSW210
085600200529     I                                        1 140 ADDRSS                                    CSW210
085700200529     I                                        1  35 ADCHK1                                    CSW210
085800200529     I                                       36  70 ADCHK2                                    CSW210
085900200529     I                                       71 105 ADCHK3                                    CSW210
086000200529     I                                      106 140 ADCHK4                                    CSW210
086100200529      *                                                                                       CSW210
086200200529      ** Blank Line Analysis data structure                                                   CSW210
086300200529     I                                       36 140 ADCH26                                    CSW210
086400200529     I                                       71 140 ADCH36                                    CSW210
086500200529      *                                                                                       CSW210
086600200529      ** SWIFT Address Analysis data structure                                                CSW210
086700200529     I                                        1   1 ADSLSH                                    CSW210
086800200529     I                                       12  35 ADEXSW                                    CSW210
086900200529      *                                                                                       CSW210
087000200529      ** Registration Details data structure                                                  CSW210
087100200529     IPREGD       DS                                                                          CSW210
087200200529     I                                        1  35 PREGD1                                    CSW210
087300200529     I                                       36  70 PREGD2                                    CSW210
087400200529      *                                                                                       CSW210
087500200529     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHAN                                    CSW210
087600200529     I              'UVWXYZ0123456789'                                                        CSW210
087700200529     I              'ABCDEFGHIJKLMNOPQRST-C         ISO                                       CSW210
087800200529     I              'UVWXYZ 1234567890/-?-                                                    CSW210
087900200529     I              '?:().,''+'                                                               CSW210
088000200529     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHA                                     CSW210
088100200529     I              'UVWXYZ'                                                                  CSW210
088200200529     I              '0123456789'          C         NMBRS                                     CSW210
088300200529      *                                                                                       CSW210
088400200529      ** IBAN DS                                                                              CSW210
088500200529     IDSIBAN      DS                                                                          CSW210
088600200529     I                                        1   1 DSISLH                                    CSW210
088700200529     I                                        2  35 DSIBN2                                    CSW210
088800200529     C/EJECT
088900200529      *================================================================
089000200529      *  P R O G R A M   S T A R T                                    *
089100200529      *================================================================
089200200529      *
089300200529      *  Initialisation routine
089400200529     C                     EXSR SRINIT
089500200529      *
089600200529      ** Execute specific routine depending on action
089700200529     C           PACTN     CASEQ'I'       SRINS
089800200529     C           PACTN     CASEQ'B'       SRINS
089900200529     C           PACTN     CASEQ'A'       SRAMD
090000200529     C           PACTN     CASEQ'Y'       SRAMD
090100200529     C           PACTN     CASEQ'E'       SRENQ
090200200529     C                     END
090300200529      *
090400200529      *================================================================
090500200529      *  P R O G R A M   E N D                                        *
090600200529      *                                                               *
090700200529      ** Execute routine to setup return code and exit program
090800200529     C                     EXSR SRRTRN
090900200529      *                                                               *
091000200529      *================================================================
091100200529      /EJECT
091200200529      *****************************************************************
091300200529      **                                                              *
091400200529      **  SRINS     - To Process Insert Action                        *
091500200529      **                                                              *
091600200529      **  Calls     -                                                 *
091700200529      **  Called By -                                                 *
091800200529      **                                                              *
091900200529      *****************************************************************
092000200529      *
092100200529     C           SRINS     BEGSR
092200200529      *
092300200529      ** Check whether record exists
092400200529      ** (it would already exist if F14 for Extended Settlements has
092500200529      **  been taken more than once during the same insert)
092600200529      *
092700200529      **  Because SE1806 can be called from the Bulk input programs,
092800200529      **  a decision needs to be made - what file do we check ?. If
092900200529      **  SE1806 was called from the Bulk input programs then the
093000200529      **  BULKSDX2 needs to be checked to find out whether the record
093100200529      **  exist or not. If SE1806 was called from Trades input then
093200200529      **  the TRADSDX2 needs to be checked to find out whether the
093300200529      **  record exist or not. Overrides issued in SEC3000 gives a
093400200529      **  broader view of the situation.
093500200529      *
093600200529     C           PACTN     IFEQ 'B'
093700200529     C           KEY001    CHAINUPDIDX               89
093800200529     C                     ELSE
093900200529     C           KEY001    CHAINRTVIDX               89
094000200529     C                     ENDIF
094100200529      *
094200200529      ** If record found then set up screen fields from file;
094300200529      ** else initialize screen fields and file fields.
094400200529     C           *IN89     IFEQ *OFF
094500200529     C                     EXSR SRFTOS
094600200529     C                     ELSE
094700200529      *                                                                                       CSE028
094800200529      ** If CSE028 is on, call SESSIR0 for default of MT5xx information                       CSE028
094900200529      *                                                                                       CSE028
095000200529     C           CSE028    IFEQ 'Y'                                                           CSE028
095100200529     C           DFTFLG    ANDEQ'Y'                                                           CSE034
095200200529      *                                                                                       CSE028
095300200529     C           PSESN     CHAINSECTYDF              99                                       199797
095400200529     C                     MOVELSITP      PINVT                                               199797
095500200529     C**********           MOVELSMCC      PSMCC                                        CSE034 205667
095600200529      *                                                                                       199797
095700200529     C                     CALL 'SESSIR0'                                                     CSE028
095800200529     C                     PARM 'D'       POTYP   1                                           CSE028
095900200529     C                     PARM           PTDBR                                               CSE028
096000200529     C                     PARM           PTCNR                                               CSE028
096100200529     C                     PARM           PPBKC                                               CSE028
096200200529     C                     PARM           PTNMC                                               CSE028
096300200529     C                     PARM           PSMCC   2                                           CSE034
096400200529     C                     PARM           PINVT   3                                           CSE028
096500200529     C                     PARM           PPTFR                                               CSE028
096600200529     C                     PARM           PCBSTD                                              CSE028
096700200529     C                     PARM           PCBSAD                                              CSE028
096800200529     C                     PARM *BLANKS   PRTCDE  5                                           CSE028
096900200529      *                                                                                       CSE028
097000200529     C           *LIKE     DEFN SFAT      WSFAT                                               218770
097100200529     C           *LIKE     DEFN SFAF      WSFAF                                               218770
097200200529     C                     MOVE SFAT      WSFAT                                               218770
097300200529     C                     MOVE SFAF      WSFAF                                               218770
097400200529     C                     SELEC                                                              CSE028
097500200529      *                                                                                       CSE028
097600200529     C           PTDTP     WHEQ 'TP'                                                          CSE028
097700200529     C                     DO                                                                 CSE028
097800200529      *                                                                                       204960
097900200529      ** For Trade Purchase, Reg Details should be defaulted                                  204960
098000200529      ** from the book SSI and not from the Counterparty SSI.                                 204960
098100200529      *                                                                                       204960
098200200529     C           *LIKE     DEFN SARED1    WKRD1                                               204960
098300200529     C           *LIKE     DEFN SARED2    WKRD2                                               204960
098400200529     C           1         OCUR PCBSAD                                                        204960
098500200529     C                     MOVE PCBSAD    PRTPCS                                              204960
098600200529     C                     MOVE W4RED1    WKRD1                                               204960
098700200529     C                     MOVE W4RED2    WKRD2                                               204960
098800200529     C           5         OCUR PCBSAD                                                        CSE028
098900200529     C                     MOVE PCBSAD    PRTPCS                                              CSE028
099000200529     C                     MOVE WKRD1     W4RED1                                              204960
099100200529     C                     MOVE WKRD2     W4RED2                                              204960
099200200529     C                     ENDDO                                                              CSE028
099300200529      *                                                                                       CSE028
099400200529     C           PTDTP     WHEQ 'TS'                                                          CSE028
099500200529     C                     DO                                                                 CSE028
099600200529     C           6         OCUR PCBSAD                                                        CSE028
099700200529     C                     MOVE PCBSAD    PRTSCS                                              CSE028
099800200529     C                     ENDDO                                                              CSE028
099900200529      *                                                                                       CSE028
100000200529     C                     ENDSL                                                              CSE028
100100200529      *                                                                                       CSE028
100200200529     C                     EXSR SRMOFS                                                        CSE028
100300200529      *                                                                                       CSE028
100400200529     C                     ELSE                                                               CSE028
100500200529     C                     CLEARUPDIDX
100600200529     C                     MOVE PTDSI     SSRL1
100700200529     C/COPY WNCPYSRC,SE1806C001
100800200529     C           PACTN     IFEQ 'B'
100900200529     C                     EXSR SRINB
101000200529     C                     ENDIF
101100200529     C/COPY WNCPYSRC,SE1806C020
101200200529     C                     ENDIF                                                              CSE028
101300200529      *                                                                                       CSE028
101400200529     C                     END
101500200529     C/COPY WNCPYSRC,SE1806C029
101600200529      *
101700200529      ** Handle screens until F3, F5 or F12 taken
101800200529      ** or until no errors but not rolldown
101900200529      ** No screen processing for mode = 'Y'                              CSE028
102000200529     C           PMODE     IFNE 'Y'                                       CSE028
102100200529     C           *INKC     DOUEQ*ON
102200200529     C           *INKE     OREQ *ON
102300200529     C           *INKL     OREQ *ON
102400200529     C           *IN75     OREQ *OFF
102500200529     C           *IN86     ANDEQ*OFF
102600200529      *
102700200529      ** If there are no errors on the second screen or if Rolldown
102800200529      ** taken then display the first screen; reset the Rolldown Ind.
102900200529      ** New field mode must equal 'N' for normal screen processing.      CSE028
103000200529     C           *IN02     IFEQ *OFF
103100200529     C           *IN86     OREQ *ON
103200200529     C           PMODE     IFEQ 'N'                                       CSE028
103300200529     C                     EXSR SRSCR1
103400200529     C                     SETOF                     86
103500200529     C                     ENDIF                                          CSE028
103600200529     C                     END
103700200529      *
103800200529      ** If F3, F5, F12 and Rolldown not taken continue
103900200529      ** (else repeat 'do until').
104000200529     C           *INKC     IFEQ *OFF
104100200529     C           *INKE     ANDEQ*OFF
104200200529     C           *INKL     ANDEQ*OFF
104300200529     C           *IN86     ANDEQ*OFF
104400200529      *
104500200529      ** If there are errors on the second screen or if Rollup taken
104600200529      ** then display the second screen; reset screen 2 error indicator
104700200529     C           *IN02     IFEQ *ON
104800200529     C           *IN85     OREQ *ON
104900200529     C/COPY WNCPYSRC,SE1806C030
105000200529      *                                                                                       CSE028
105100200529      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
105200200529      *
105300200529     C           CSE028    IFEQ 'Y'                                                           CSE028
105400200529      *                                                                                       CSE028
105500200529     C           PSNEW     IFEQ 'Y'                                                           CSE028
105600200529     C                     MOVE *ON       *IN84                                               CSE028
105700200529     C                     MOVE *ON       *IN77                                               CSE028
105800200529     C                     MOVE 'N'       W3RDFL  1                                           CSE028
105900200529     C                     ENDIF                                                              CSE028
106000200529      *                                                                                       CSE028
106100200529     C                     ENDIF                                                              CSE028
106200200529      *                                                                                       CSE028
106300200529      ** Default Counterparty Safekeeping Account                                             209890
106400200529      *                                                                                       209890
106500200529     C           *IN75     IFEQ *OFF                                                          209890
106600200529     C           SSA1N     IFEQ *BLANK                                                        218770
106700200529     C           PTDTP     IFEQ 'TP'                                                          209890
106800200529     C********** PDELF     ANDNE0                                                      209890 CSD027
106900200529     C           PDELF     ANDNE*BLANKS                                                       CSD027
107000200529     C                     MOVELPDELF     SSA1N                                               209890
107100200529     C                     ENDIF                                                              209890
107200200529     C           PTDTP     IFEQ 'TS'                                                          209890
107300200529     C********** PDELT     ANDNE0                                                      209890 CSD027
107400200529     C           PDELT     ANDNE*BLANKS                                                       CSD027
107500200529     C                     MOVELPDELT     SSA1N                                               209890
107600200529     C                     ENDIF                                                              209890
107700200529     C                     ENDIF                                                              218770
107800200529      *                                                                                       209949
107900200529      ** Default for Deliverer of Securities field                                            209949
108000200529      *                                                                                       209949
108100200529     C           PTDTP     IFEQ 'TP'                                                          209949
108200200529     C********** PDELF     ANDNE0                                                      209949 CSD027
108300200529     C           PDELF     ANDNE*BLANKS                                                       CSD027
108400200529     C           SDSSN     ANDEQ*BLANKS                                                       209949
108500200529     C           *IN07     ANDEQ*OFF                                                        AR632000
108600200529     C                     MOVELPDELF     SDSSN                                               209949
108700200529     C                     ENDIF                                                              209949
108800200529      *                                                                                       209949
108900200529     C           PTDTP     IFEQ 'TS'                                                          209949
109000200529     C********** PDELT     ANDNE0                                                      209949 CSD027
109100200529     C           PDELT     ANDNE*BLANKS                                                       CSD027
109200200529     C           SRSSN     ANDEQ*BLANKS                                                       209949
109300200529     C           *IN08     ANDEQ*OFF                                                        AR632000
109400200529     C                     MOVELPDELT     SRSSN                                               209949
109500200529     C                     ENDIF                                                              209949
109600200529      *                                                                                       209949
109700200529     C                     ENDIF                                                              209890
109800200529      *                                                                                       209890
109900200529     C                     EXSR SRSCR2
110000200529     C/COPY WNCPYSRC,SE1806C031
110100200529     C                     SETOF                     02
110200200529     C                     END
110300200529      *                                                                                       201429
110400200529      ** If Rollup was taken on second screen, call SE001810                                  201429
110500200529      *                                                                                       201429
110600200529     C           CSE028    IFEQ 'Y'                                                           201429
110700200529     C           *IN84     ANDEQ*ON                                                           201429
110800200529     C                     EXSR SRSCR3                                                        201429
110900200529     C                     ENDIF                                                              201429
111000200529      *
111100200529      ** Clear messages for redisplay
111200200529     C                     CALL 'ZA0250'
111300200529      *
111400200529      ** Validate input, only if F3, F5, F12 and Rolldown not taken
111500200529     C           *INKC     IFEQ *OFF
111600200529     C           *INKE     ANDEQ*OFF
111700200529     C           *INKL     ANDEQ*OFF
111800200529     C           *IN86     ANDEQ*OFF
111900200529     C           *IN84     ANDEQ*OFF                                                          201429
112000200529     C                     EXSR SRVAL
112100200529      *                                                                                       CSE028
112200200529      ***If*Rollup was taken on second screen, call SE001810                           CSE028 201429
112300200529      *                                                                                       CSE028
112400200529     C********** CSE028    IFEQ 'Y'                                                    CSE028 201429
112500200529     C********** *IN84     ANDEQ*ON                                                    CSE028 201429
112600200529     C********** *IN75     ANDEQ*OFF                                                   CSE028 201429
112700200529      *                                                                                       CSE028
112800200529     C**********           EXSR SRSCR3                                                 CSE028 201429
112900200529      *                                                                                       CSE028
113000200529     C**********           ENDIF                                                       CSE028 201429
113100200529      *                                                                                       CSE028
113200200529     C           *INKC     IFEQ *OFF                                                          CSE028
113300200529     C           *INKL     ANDEQ*OFF                                                          CSE028
113400200529     C********** *IN85     ANDEQ*OFF                                                   CSE028 199797
113500200529      *
113600200529      ** If no errors on validation update/write to the file and drop
113700200529      ** out of subroutine (and program).
113800200529     C           *IN75     IFEQ *OFF
113900200529      *                                                                                       CSD015
114000200529      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
114100200529      *                                                                                       CSD015
114200200529     C           CSD015    IFEQ 'Y'                                                           CSD015
114300200529     C           W1EWLC    ANDEQ'Y'                                                           CSD015
114400200529      *                                                                                       CSD015
114500200529      ** If 24X7 is not installed or the support system is off.                               CSD015
114600200529      *                                                                                       CSD015
114700200529     C           CSC011    IFEQ 'N'                                                           CSD015
114800200529     C           CSC011    OREQ 'Y'                                                           CSD015
114900200529     C           S1MAIN    ANDEQLIBR                                                          CSD015
115000200529      *                                                                                       CSD015
115100200529     C                     EXSR SRCWV1                                                        CSD015
115200200529      *                                                                                       CSD015
115300200529     C           WDIFFI    IFEQ 'Y'                                                           CSD015
115400200529     C           WIMDI     OREQ 'Y'                                                           CSD015
115500200529     C           WIMSI     OREQ 'Y'                                                           CSD015
115600200529     C                     EXSR SRFMT                                                         CSD015
115700200529     C                     ENDIF                                                              CSD015
115800200529      *                                                                                       CSD015
115900200529     C                     ENDIF                                                              CSD015
116000200529     C                     ENDIF                                                              CSD015
116100200529      *
116200200529      ** If record previously existed then allocate the record via the
116300200529      ** update index
116400200529     C           *IN89     IFEQ *OFF
116500200529     C                     EXSR SRALOC
116600200529      *
116700200529      ** If record on file and allocated then move screen values to
116800200529      ** file fields and update record;
116900200529      ** (else screen will be redisplayed)
117000200529     C           *IN80     IFEQ *OFF
117100200529     C           *IN81     ANDEQ*OFF
117200200529     C                     EXSR SRSTOF
117300200529     C                     UPDATUPDIDX                 88
117400200529     C                     END
117500200529      *
117600200529      ** Else (record does not already exist) move screen fields to
117700200529      ** file fields; write new record.
117800200529     C                     ELSE
117900200529     C                     EXSR SRSTOF
118000200529      *                                                                                       248683
118100200529      *  Write 'Y' to SE1806 Data Area Flag                                                   248683
118200200529      *                                                                                       248683
118300200529     C                     CALL 'SECDTARA'                                                    248683
118400200529     C                     PARM 'SE1806'  PRGNAM 10                                           248683
118500200529     C                     PARM 'Y'       WRTFLG  1                                           248683
118600200529      *                                                                                       248683
118700200529     C                     WRITEUPDIDX                 88
118800200529     C                     END
118900200529     C/COPY WNCPYSRC,SE1806C032
119000200529      *
119100200529     C                     END
119200200529      *
119300200529     C                     ENDIF                                                              CSE028
119400200529      *                                                                                       CSE028
119500200529     C                     END
119600200529      *
119700200529      ** If F12 taken from second screen then set Rolldown Ind (*IN86);
119800200529      ** set F12 off; and clear fields on 2nd screen.
119900200529     C           *INKL     IFEQ *ON
120000200529     C           W3RDFL    ANDEQ'N'                                                           CSE028
120100200529     C                     SETON                     86
120200200529     C                     MOVE *OFF      *INKL
120300200529     C                     EXSR SRCLS2
120400200529     C/COPY WNCPYSRC,SE1806C033
120500200529     C                     END
120600200529      *
120700200529     C                     END
120800200529      *
120900200529     C                     END
121000200529      *                                                                   CSE028
121100200529      ** MODE = 'Y' after missing screen processing                       CSE028
121200200529     C                     ELSE                                           CSE028
121300200529      ** MODE = 'Y' just do file updates                                  CSE028
121400200529      *                                                                   CSE028
121500200529      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
121600200529      *                                                                                       CSD015
121700200529     C           CSD015    IFEQ 'Y'                                                           CSD015
121800200529     C           W1EWLC    ANDEQ'Y'                                                           CSD015
121900200529      *                                                                                       CSD015
122000200529      ** If 24X7 is not installed or the suport system is off.                                CSD015
122100200529      *                                                                                       CSD015
122200200529     C           CSC011    IFEQ 'N'                                                           CSD015
122300200529     C           CSC011    OREQ 'Y'                                                           CSD015
122400200529     C           S1MAIN    ANDEQLIBR                                                          CSD015
122500200529      *                                                                                       CSD015
122600200529     C                     EXSR SRCWV1                                                        CSD015
122700200529      *                                                                                       CSD015
122800200529     C           WDIFFI    IFEQ 'Y'                                                           CSD015
122900200529     C           WIMDI     OREQ 'Y'                                                           CSD015
123000200529     C           WIMSI     OREQ 'Y'                                                           CSD015
123100200529     C                     EXSR SRFMT                                                         CSD015
123200200529     C                     ENDIF                                                              CSD015
123300200529      *                                                                                       CSD015
123400200529     C                     ENDIF                                                              CSD015
123500200529     C                     ENDIF                                                              CSD015
123600200529      *                                                                                       CSD015
123700200529      ** If record previously existed then allocate the record via the    CSE028
123800200529      ** update index                                                     CSE028
123900200529     C           *IN89     IFEQ '0'                                       CSE028
124000200529     C                     EXSR SRALOC                                    CSE028
124100200529      *                                                                   CSE028
124200200529      ** If record on file and allocated then move screen values to       CSE028
124300200529      ** file fields and update record;                                   CSE028
124400200529      ** (else screen will be redisplayed)                                CSE028
124500200529     C           *IN80     IFEQ '0'                                       CSE028
124600200529     C           *IN81     ANDEQ'0'                                       CSE028
124700200529     C                     EXSR SRSTOF                                    CSE028
124800200529     C                     UPDATUPDIDX                 88                 CSE028
124900200529     C                     ENDIF                                          CSE028
125000200529      *                                                                   CSE028
125100200529      ** Else (record does not already exist) move screen fields to       CSE028
125200200529      ** file fields; write new record.                                   CSE028
125300200529     C                     ELSE                                           CSE028
125400200529     C                     EXSR SRSTOF                                    CSE028
125500200529      *                                                                                       248683
125600200529      *  Write 'Y' to SE1806 Data Area Flag                                                   248683
125700200529      *                                                                                       248683
125800200529     C                     CALL 'SECDTARA'                                                    248683
125900200529     C                     PARM 'SE1806'  PRGNAM 10                                           248683
126000200529     C                     PARM 'Y'       WRTFLG  1                                           248683
126100200529      *                                                                                       248683
126200200529     C                     WRITEUPDIDX                 88                 CSE028
126300200529     C                     ENDIF                                          CSE028
126400200529     C                     ENDIF                                          CSE028
126500200529      *
126600200529      ** Reset override indicators
126700200529     C                     MOVE *BLANK    OVER2   1
126800200529     C                     MOVE *BLANK    OVER3   1
126900200529     C                     MOVE *BLANK    OVER6   1
127000200529     C                     MOVE *BLANK    OVER7   1
127100200529     C                     MOVE *BLANK    OVER8   1
127200200529     C                     MOVE *BLANK    OVER9   1
127300200529      *
127400200529     C                     ENDSR
127500200529      *
127600200529      *****************************************************************                       CSD015
127700200529      /EJECT                                                                                  CSD015
127800200529      *****************************************************************                       CSD015
127900200529      **                                                              *                       CSD015
128000200529      **  SRCWV1    - Validate if watch list field has been entered.  *                       CSD015
128100200529      **                                                              *                       CSD015
128200200529      **  Calls     - None.                                           *                       CSD015
128300200529      **  Called By - SRINS, SAMD                                     *                       CSD015
128400200529      **                                                              *                       CSD015
128500200529      *****************************************************************                       CSD015
128600200529      *                                                                                       CSD015
128700200529     C           SRCWV1    BEGSR                                                              CSD015
128800200529      *                                                                                       CSD015
128900200529     C                     MOVEL'N'       WDIFFI  1                                           CSD015
129000200529     C                     MOVEL'N'       WIMDI   1                                           CSD015
129100200529     C                     MOVEL'N'       WIMSI   1                                           CSD015
129200200529     C                     MOVEA*BLANKS   WLF,1                                               CSD015
129300200529     C                     MOVEA*BLANKS   MMD,1                                               CSD015
129400200529     C                     MOVEA*BLANKS   MSA,1                                               CSD015
129500200529      *                                                                                       CSD015
129600200529     C           WWAP1N    IFNE *BLANKS                                                       CSD015
129700200529     C                     MOVELWWAP1N    WLF,1                                               CSD015
129800200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
129900200529     C                     ENDIF                                                              CSD015
130000200529      *                                                                                       CSD015
130100200529     C           WWAFPN    IFNE *BLANKS                                                       CSD015
130200200529     C                     MOVELWWAFPN    WLF,2                                               CSD015
130300200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
130400200529     C                     ENDIF                                                              CSD015
130500200529      *                                                                                       CSD015
130600200529     C           WWAWIN    IFNE *BLANKS                                                       CSD015
130700200529     C                     MOVELWWAWIN    WLF,3                                               CSD015
130800200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
130900200529     C                     ENDIF                                                              CSD015
131000200529      *                                                                                       CSD015
131100200529     C           WWBOFN    IFNE *BLANKS                                                       CSD015
131200200529     C                     MOVELWWBOFN    WLF,4                                               CSD015
131300200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
131400200529     C                     ENDIF                                                              CSD015
131500200529      *                                                                                       CSD015
131600200529     C           WWIPYN    IFNE *BLANKS                                                       CSD015
131700200529     C                     MOVELWWIPYN    WLF,5                                               CSD015
131800200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
131900200529     C                     ENDIF                                                              CSD015
132000200529      *                                                                                       CSD015
132100200529     C           WWCTYN    IFNE *BLANKS                                                       CSD015
132200200529     C                     MOVELWWCTYN    WLF,6                                               CSD015
132300200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
132400200529     C                     ENDIF                                                              CSD015
132500200529      *                                                                                       CSD015
132600200529     C           WWSA1N    IFNE *BLANKS                                                       CSD015
132700200529     C                     MOVELWWSA1N    WLF,7                                               CSD015
132800200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
132900200529     C                     ENDIF                                                              CSD015
133000200529      *                                                                                       CSD015
133100200529     C           WWSKAN    IFNE *BLANKS                                                       CSD015
133200200529     C                     MOVELWWSKAN    WLF,8                                               CSD015
133300200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
133400200529     C                     ENDIF                                                              CSD015
133500200529      *                                                                                       CSD015
133600200529     C           SDCTL     IFNE *BLANKS                                                       CSD015
133700200529     C                     MOVELSDCTL     WLF,9                                               CSD015
133800200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
133900200529     C                     ENDIF                                                              CSD015
134000200529      *                                                                                       CSD015
134100200529     C           WWRSSN    IFNE *BLANKS                                                       CSD015
134200200529     C                     MOVELWWRSSN    WLF,10                                              CSD015
134300200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
134400200529     C                     ENDIF                                                              CSD015
134500200529      *                                                                                       CSD015
134600200529     C           WWDSSN    IFNE *BLANKS                                                       CSD015
134700200529     C                     MOVELWWDSSN    WLF,11                                              CSD015
134800200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
134900200529     C                     ENDIF                                                              CSD015
135000200529      *                                                                                       CSD015
135100200529     C           WWBSSN    IFNE *BLANKS                                                       CSD015
135200200529     C                     MOVELWWBSSN    WLF,12                                              CSD015
135300200529     C                     MOVEL'Y'       WDIFFI                                              CSD015
135400200529     C                     ENDIF                                                              CSD015
135500200529      *                                                                                       CSD015
135600200529     C********** WWINVE    IFNE *BLANKS                                                CSD015 CSW210
135700200529     C**********           MOVELWWINVE    WLF,13                                       CSD015 CSW210
135800200529     C**********           MOVEL'Y'       WDIFFI                                       CSD015 CSW210
135900200529     C**********           ENDIF                                                       CSD015 CSW210
136000200529     C           PINVE     IFNE *BLANKS                                                       CSW210
136100200529     C                     MOVELPINVE     WLF,13                                              CSW210
136200200529     C                     MOVEL'Y'       WDIFFI                                              CSW210
136300200529     C                     ENDIF                                                              CSW210
136400200529      *                                                                                       CSW210
136500200529     C           WWDIDN    IFNE *BLANKS                                                       CSW210
136600200529     C                     MOVELWWDIDN    WLF,14                                              CSW210
136700200529     C                     MOVEL'Y'       WDIFFI                                              CSW210
136800200529     C                     ENDIF                                                              CSW210
136900200529      *                                                                                       CSW210
137000200529     C           PQFIN     IFNE *BLANKS                                                       CSW210
137100200529     C                     MOVELPQFIN     WLF,15                                              CSW210
137200200529     C                     MOVEL'Y'       WDIFFI                                              CSW210
137300200529     C                     ENDIF                                                              CSW210
137400200529      *                                                                                       CSD015
137500200529      **  Settlement Party Intermediary                                                       CSD015
137600200529      *                                                                                       CSD015
137700200529     C           PIMMD1    IFNE *BLANKS                                                       CSD015
137800200529     C                     MOVELPIMMD1    MMD,1                                               CSD015
137900200529     C                     MOVEL'Y'       WIMDI                                               CSD015
138000200529     C                     ENDIF                                                              CSD015
138100200529      *                                                                                       CSD015
138200200529     C           PIMMD2    IFNE *BLANKS                                                       CSD015
138300200529     C                     MOVELPIMMD2    MMD,2                                               CSD015
138400200529     C                     MOVEL'Y'       WIMDI                                               CSD015
138500200529     C                     ENDIF                                                              CSD015
138600200529      *                                                                                       CSD015
138700200529     C           PIMMD3    IFNE *BLANKS                                                       CSD015
138800200529     C                     MOVELPIMMD3    MMD,3                                               CSD015
138900200529     C                     MOVEL'Y'       WIMDI                                               CSD015
139000200529     C                     ENDIF                                                              CSD015
139100200529      *                                                                                       CSD015
139200200529     C           PIMMD4    IFNE *BLANKS                                                       CSD015
139300200529     C                     MOVELPIMMD4    MMD,4                                               CSD015
139400200529     C                     MOVEL'Y'       WIMDI                                               CSD015
139500200529     C                     ENDIF                                                              CSD015
139600200529      *                                                                                       CSD015
139700200529     C           PIMMD5    IFNE *BLANKS                                                       CSD015
139800200529     C                     MOVELPIMMD5    MMD,5                                               CSD015
139900200529     C                     MOVEL'Y'       WIMDI                                               CSD015
140000200529     C                     ENDIF                                                              CSD015
140100200529      *                                                                                       CSD015
140200200529     C           PIMMD6    IFNE *BLANKS                                                       CSD015
140300200529     C                     MOVELPIMMD6    MMD,6                                               CSD015
140400200529     C                     MOVEL'Y'       WIMDI                                               CSD015
140500200529     C                     ENDIF                                                              CSD015
140600200529      *                                                                                       CSD015
140700200529     C           PIMMD7    IFNE *BLANKS                                                       CSD015
140800200529     C                     MOVELPIMMD7    MMD,7                                               CSD015
140900200529     C                     MOVEL'Y'       WIMDI                                               CSD015
141000200529     C                     ENDIF                                                              CSD015
141100200529      *                                                                                       CSD015
141200200529     C           PIMMD8    IFNE *BLANKS                                                       CSD015
141300200529     C                     MOVELPIMMD8    MMD,8                                               CSD015
141400200529     C                     MOVEL'Y'       WIMDI                                               CSD015
141500200529     C                     ENDIF                                                              CSD015
141600200529      *                                                                                       CSD015
141700200529     C           PIMMD9    IFNE *BLANKS                                                       CSD015
141800200529     C                     MOVELPIMMD9    MMD,9                                               CSD015
141900200529     C                     MOVEL'Y'       WIMDI                                               CSD015
142000200529     C                     ENDIF                                                              CSD015
142100200529      *                                                                                       CSD015
142200200529      **  Safekeeping Account Intermediary                                                    CSD015
142300200529      *                                                                                       CSD015
142400200529     C           PIMSA1    IFNE *BLANKS                                                       CSD015
142500200529     C                     MOVELPIMSA1    MSA,1                                               CSD015
142600200529     C                     MOVEL'Y'       WIMSI                                               CSD015
142700200529     C                     ENDIF                                                              CSD015
142800200529      *                                                                                       CSD015
142900200529     C           PIMSA2    IFNE *BLANKS                                                       CSD015
143000200529     C                     MOVELPIMSA2    MSA,2                                               CSD015
143100200529     C                     MOVEL'Y'       WIMSI                                               CSD015
143200200529     C                     ENDIF                                                              CSD015
143300200529      *                                                                                       CSD015
143400200529     C           PIMSA3    IFNE *BLANKS                                                       CSD015
143500200529     C                     MOVELPIMSA3    MSA,3                                               CSD015
143600200529     C                     MOVEL'Y'       WIMSI                                               CSD015
143700200529     C                     ENDIF                                                              CSD015
143800200529      *                                                                                       CSD015
143900200529     C           PIMSA4    IFNE *BLANKS                                                       CSD015
144000200529     C                     MOVELPIMSA4    MSA,4                                               CSD015
144100200529     C                     MOVEL'Y'       WIMSI                                               CSD015
144200200529     C                     ENDIF                                                              CSD015
144300200529      *                                                                                       CSD015
144400200529     C           PIMSA5    IFNE *BLANKS                                                       CSD015
144500200529     C                     MOVELPIMSA5    MSA,5                                               CSD015
144600200529     C                     MOVEL'Y'       WIMSI                                               CSD015
144700200529     C                     ENDIF                                                              CSD015
144800200529      *                                                                                       CSD015
144900200529     C           PIMSA6    IFNE *BLANKS                                                       CSD015
145000200529     C                     MOVELPIMSA6    MSA,6                                               CSD015
145100200529     C                     MOVEL'Y'       WIMSI                                               CSD015
145200200529     C                     ENDIF                                                              CSD015
145300200529      *                                                                                       CSD015
145400200529     C           PIMSA7    IFNE *BLANKS                                                       CSD015
145500200529     C                     MOVELPIMSA7    MSA,7                                               CSD015
145600200529     C                     MOVEL'Y'       WIMSI                                               CSD015
145700200529     C                     ENDIF                                                              CSD015
145800200529      *                                                                                       CSD015
145900200529     C           PIMSA8    IFNE *BLANKS                                                       CSD015
146000200529     C                     MOVELPIMSA8    MSA,8                                               CSD015
146100200529     C                     MOVEL'Y'       WIMSI                                               CSD015
146200200529     C                     ENDIF                                                              CSD015
146300200529      *                                                                                       CSD015
146400200529     C           PIMSA9    IFNE *BLANKS                                                       CSD015
146500200529     C                     MOVELPIMSA9    MSA,9                                               CSD015
146600200529     C                     MOVEL'Y'       WIMSI                                               CSD015
146700200529     C                     ENDIF                                                              CSD015
146800200529      *                                                                                       CSD015
146900200529     C                     ENDSR                                                              CSD015
147000200529      *                                                                                       CSD015
147100200529      *****************************************************************
147200200529      /EJECT
147300200529      *****************************************************************
147400200529      **                                                              *
147500200529      **  SRAMD     - To Handle Amend Action                          *
147600200529      **                                                              *
147700200529      **  Calls     -                                                 *
147800200529      **  Called By -                                                 *
147900200529      **                                                              *
148000200529      *****************************************************************
148100200529      *
148200200529     C           SRAMD     BEGSR
148300200529      *
148400200529      ** Check whether record exists
148500200529     C           KEY001    CHAINRTVIDX               89
148600200529     C/COPY WNCPYSRC,SE1806C034
148700200529      *
148800200529      ** If record not found then treat as insert because screen not
148900200529      ** mandatory (displayed by pressing F14)
149000200529     C           *IN89     IFEQ *ON
149100200529     C                     EXSR SRINS
149200200529     C                     ELSE
149300200529      *
149400200529      ** Else, record found, set file fields to screen fields
149500200529     C                     EXSR SRFTOS
149600200529      *
149700200529      ** Handle screens until F3, F5 or F12 taken
149800200529      ** or until no errors but not rolldown
149900200529     C           *INKC     DOUEQ*ON
150000200529     C           *INKE     OREQ *ON
150100200529     C           *INKL     OREQ *ON
150200200529     C           *IN75     OREQ *OFF
150300200529     C           *IN86     ANDEQ*OFF
150400200529      *
150500200529      ** If there are no errors on the second screen or if Rolldown
150600200529      ** taken then display the first screen; reset the Rolldown Ind.
150700200529     C           *IN02     IFEQ *OFF
150800200529     C           *IN86     OREQ *ON
150900200529     C                     EXSR SRSCR1
151000200529     C                     SETOF                     86
151100200529     C                     END
151200200529      *
151300200529      ** If F3, F5, F12 and Rolldown not taken continue
151400200529      ** (else repeat 'do until').
151500200529     C           *INKC     IFEQ *OFF
151600200529     C           *INKE     ANDEQ*OFF
151700200529     C           *INKL     ANDEQ*OFF
151800200529     C           *IN86     ANDEQ*OFF
151900200529      *
152000200529      ** If there are errors on the second screen or if Rollup taken
152100200529      ** then display the second screen; reset screen 2 error indicator
152200200529     C           *IN02     IFEQ *ON
152300200529     C           *IN85     OREQ *ON
152400200529     C/COPY WNCPYSRC,SE1806C035
152500200529      *                                                                                       CSE028
152600200529      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
152700200529      *                                                                                       CSE028
152800200529     C           CSE028    IFEQ 'Y'                                                           CSE028
152900200529      *                                                                                       CSE028
153000200529     C           PSNEW     IFEQ 'Y'                                                           CSE028
153100200529     C                     MOVE *ON       *IN84                                               CSE028
153200200529     C                     MOVE *ON       *IN77                                               CSE028
153300200529     C                     ENDIF                                                              CSE028
153400200529      *                                                                                       CSE028
153500200529     C                     ENDIF                                                              CSE028
153600200529      *                                                                                       CSE028
153700200529     C                     EXSR SRSCR2
153800200529     C/COPY WNCPYSRC,SE1806C036
153900200529     C                     SETOF                     02
154000200529     C                     END
154100200529      *                                                                                       201429
154200200529      ** If Rollup was taken on second screen, call SE001810                                  201429
154300200529      *                                                                                       201429
154400200529     C           CSE028    IFEQ 'Y'                                                           201429
154500200529     C           *IN84     ANDEQ*ON                                                           201429
154600200529     C                     EXSR SRSCR3                                                        201429
154700200529     C                     ENDIF                                                              201429
154800200529      *
154900200529      ** Clear messages for redisplay
155000200529     C                     CALL 'ZA0250'
155100200529      *
155200200529      ** Validate input, only if F3, F5, F12 and Rolldown not taken
155300200529     C           *INKC     IFEQ *OFF
155400200529     C           *INKE     ANDEQ*OFF
155500200529     C           *INKL     ANDEQ*OFF
155600200529     C           *IN86     ANDEQ*OFF
155700200529     C           *IN84     ANDEQ*OFF                                                          201429
155800200529     C                     EXSR SRVAL
155900200529      *                                                                                       CSE028
156000200529      ***If*Rollup was taken on second screen, call SE001810                           CSE028 201429
156100200529      *                                                                                       CSE028
156200200529     C********** CSE028    IFEQ 'Y'                                                    CSE028 201429
156300200529     C********** *IN84     ANDEQ*ON                                                    CSE028 201429
156400200529     C********** *IN75     ANDEQ*OFF                                                   CSE028 201429
156500200529      *                                                                                       CSE028
156600200529     C**********           EXSR SRSCR3                                                 CSE028 201429
156700200529      *                                                                                       CSE028
156800200529     C**********           ENDIF                                                       CSE028 201429
156900200529      *                                                                                       CSE028
157000200529     C           *INKC     IFEQ *OFF                                                          CSE028
157100200529     C           *INKL     ANDEQ*OFF                                                          CSE028
157200200529     C********** *IN85     ANDEQ*OFF                                                   CSE028 199797
157300200529      *
157400200529      ** If no errors on validation allocate record via update index
157500200529     C           *IN75     IFEQ *OFF
157600200529     C                     EXSR SRALOC
157700200529      *
157800200529      ** If record on file and allocated then move screen values to
157900200529      ** file fields and update record.
158000200529     C           *IN80     IFEQ *OFF
158100200529     C           *IN81     ANDEQ*OFF
158200200529      *                                                                                       CSD015
158300200529      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
158400200529      *                                                                                       CSD015
158500200529     C           CSD015    IFEQ 'Y'                                                           CSD015
158600200529     C           W1EWLC    ANDEQ'Y'                                                           CSD015
158700200529      *                                                                                       CSD015
158800200529      ** If 24X7 is not installed or the suport system is off.                                CSD015
158900200529      *                                                                                       CSD015
159000200529     C           CSC011    IFEQ 'N'                                                           CSD015
159100200529     C           CSC011    OREQ 'Y'                                                           CSD015
159200200529     C           S1MAIN    ANDEQLIBR                                                          CSD015
159300200529      *                                                                                       CSD015
159400200529     C                     MOVE *OFF      *IN11                                               CSD015
159500200529      *                                                                                       CSD015
159600200529     C                     MOVEL'TRADSD ' WFUNT                                               CSD015
159700200529     C                     MOVELW2TDRF    WIDEN                                               CSD015
159800200529     C                     MOVELPTDBR     WBRCH                                               CSD015
159900200529     C           CWHTKY    CHAINSDCWHTL1             11                                       CSD015
160000200529      *                                                                                       CSD015
160100200529     C           *IN11     IFEQ *OFF                                                          CSD015
160200200529     C           W3HSTS    ANDEQ*BLANKS                                                       CSD015
160300200529     C           W3UNCF    ANDEQ'Y'                                                           CSD015
160400200529      *                                                                                       CSD015
160500200529     C                     EXSR SRCWV1                                                        CSD015
160600200529     C                     EXSR SRFMT                                                         CSD015
160700200529      *                                                                                       CSD015
160800200529     C                     ELSE                                                               CSD015
160900200529      *                                                                                       CSD015
161000200529     C                     EXSR SRCWV2                                                        CSD015
161100200529      *                                                                                       CSD015
161200200529     C           WDIFFA    IFEQ 'Y'                                                           CSD015
161300200529     C           WIMDA     OREQ 'Y'                                                           CSD015
161400200529     C           WIMSA     OREQ 'Y'                                                           CSD015
161500200529     C                     EXSR SRFMT                                                         CSD015
161600200529     C                     ENDIF                                                              CSD015
161700200529      *                                                                                       CSD015
161800200529     C                     ENDIF                                                              CSD015
161900200529     C                     ENDIF                                                              CSD015
162000200529     C                     ENDIF                                                              CSD015
162100200529      *                                                                                       CSD015
162200200529     C                     EXSR SRSTOF
162300200529      *                                                                                       248683
162400200529      *  Write 'Y' to SE1806 Data Area Flag                                                   248683
162500200529      *                                                                                       248683
162600200529     C                     CALL 'SECDTARA'                                                    248683
162700200529     C                     PARM 'SE1806'  PRGNAM 10                                           248683
162800200529     C                     PARM 'Y'       WRTFLG  1                                           248683
162900200529      *                                                                                       248683
163000200529     C                     UPDATUPDIDX                 88
163100200529     C                     END
163200200529     C/COPY WNCPYSRC,SE1806C037
163300200529      *
163400200529     C                     END
163500200529      *
163600200529     C                     ENDIF                                                              CSE028
163700200529      *                                                                                       CSE028
163800200529     C                     END
163900200529      *
164000200529      ** If F12 taken from second screen then set Rolldown Ind (*IN86);
164100200529      ** set F12 off; and reset fields on 2nd screen.
164200200529     C           *INKL     IFEQ *ON
164300200529     C           W3RDFL    ANDEQ'N'                                                           CSE028
164400200529     C                     SETON                     86
164500200529     C                     MOVE *OFF      *INKL
164600200529     C                     EXSR SRRTS2
164700200529     C/COPY WNCPYSRC,SE1806C038
164800200529     C                     END
164900200529      *
165000200529     C                     END
165100200529      *
165200200529     C                     END
165300200529      *
165400200529     C                     END
165500200529      *
165600200529      ** Reset override indicators
165700200529     C                     MOVE *BLANK    OVER2
165800200529     C                     MOVE *BLANK    OVER3
165900200529     C                     MOVE *BLANK    OVER6
166000200529     C                     MOVE *BLANK    OVER7
166100200529     C                     MOVE *BLANK    OVER8
166200200529     C                     MOVE *BLANK    OVER9
166300200529      *
166400200529     C                     ENDSR
166500200529      *
166600200529      *****************************************************************                       CSD015
166700200529      /EJECT                                                                                  CSD015
166800200529      *****************************************************************                       CSD015
166900200529      **                                                              *                       CSD015
167000200529      **  SRCWV2    - Validate if watch list field has been changed.  *                       CSD015
167100200529      **                                                              *                       CSD015
167200200529      **  Calls     - None.                                           *                       CSD015
167300200529      **  Called By - SRAMD                                           *                       CSD015
167400200529      **                                                              *                       CSD015
167500200529      *****************************************************************                       CSD015
167600200529      *                                                                                       CSD015
167700200529     C           SRCWV2    BEGSR                                                              CSD015
167800200529      *                                                                                       CSD015
167900200529     C                     MOVEL'N'       WDIFFA  1                                           CSD015
168000200529     C                     MOVEL'N'       WIMDA   1                                           CSD015
168100200529     C                     MOVEL'N'       WIMSA   1                                           CSD015
168200200529     C                     MOVEA*BLANKS   WLF,1                                               CSD015
168300200529     C                     MOVEA*BLANKS   MMD,1                                               CSD015
168400200529     C                     MOVEA*BLANKS   MSA,1                                               CSD015
168500200529      *                                                                                       CSD015
168600200529     C           WWAP1N    IFNE T2AP1N                                                        CSD015
168700200529     C                     MOVELWWAP1N    WLF,1                                               CSD015
168800200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
168900200529     C                     ENDIF                                                              CSD015
169000200529      *                                                                                       CSD015
169100200529     C           WWAFPN    IFNE T2AFPN                                                        CSD015
169200200529     C                     MOVELWWAFPN    WLF,2                                               CSD015
169300200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
169400200529     C                     ENDIF                                                              CSD015
169500200529      *                                                                                       CSD015
169600200529     C           WWAWIN    IFNE T2AWIN                                                        CSD015
169700200529     C                     MOVELWWAWIN    WLF,3                                               CSD015
169800200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
169900200529     C                     ENDIF                                                              CSD015
170000200529      *                                                                                       CSD015
170100200529     C           WWBOFN    IFNE T2BOFN                                                        CSD015
170200200529     C                     MOVELWWBOFN    WLF,4                                               CSD015
170300200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
170400200529     C                     ENDIF                                                              CSD015
170500200529      *                                                                                       CSD015
170600200529     C           WWIPYN    IFNE T2IPYN                                                        CSD015
170700200529     C                     MOVELWWIPYN    WLF,5                                               CSD015
170800200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
170900200529     C                     ENDIF                                                              CSD015
171000200529      *                                                                                       CSD015
171100200529     C           WWCTYN    IFNE T2CTYN                                                        CSD015
171200200529     C                     MOVELWWCTYN    WLF,6                                               CSD015
171300200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
171400200529     C                     ENDIF                                                              CSD015
171500200529      *                                                                                       CSD015
171600200529     C           WWSA1N    IFNE T2SA1N                                                        CSD015
171700200529     C                     MOVELWWSA1N    WLF,7                                               CSD015
171800200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
171900200529     C                     ENDIF                                                              CSD015
172000200529      *                                                                                       CSD015
172100200529     C           WWSKAN    IFNE T2SKAN                                                        CSD015
172200200529     C                     MOVELWWSKAN    WLF,8                                               CSD015
172300200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
172400200529     C                     ENDIF                                                              CSD015
172500200529      *                                                                                       CSD015
172600200529     C           SDCTL     IFNE T2DCTL                                                        CSD015
172700200529     C                     MOVELSDCTL     WLF,9                                               CSD015
172800200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
172900200529     C                     ENDIF                                                              CSD015
173000200529      *                                                                                       CSD015
173100200529     C           WWRSSN    IFNE T2RSSN                                                        CSD015
173200200529     C                     MOVELWWRSSN    WLF,10                                              CSD015
173300200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
173400200529     C                     ENDIF                                                              CSD015
173500200529      *                                                                                       CSD015
173600200529     C           WWDSSN    IFNE T2DSSN                                                        CSD015
173700200529     C                     MOVELWWDSSN    WLF,11                                              CSD015
173800200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
173900200529     C                     ENDIF                                                              CSD015
174000200529      *                                                                                       CSD015
174100200529     C           WWBSSN    IFNE T2BSSN                                                        CSD015
174200200529     C                     MOVELWWBSSN    WLF,12                                              CSD015
174300200529     C                     MOVEL'Y'       WDIFFA                                              CSD015
174400200529     C                     ENDIF                                                              CSD015
174500200529      *                                                                                       CSD015
174600200529     C********** WWINVE    IFNE T2INVE                                                 CSD015 CSW210
174700200529     C**********           MOVELWWINVE    WLF,13                                       CSD015 CSW210
174800200529     C**********           MOVEL'Y'       WDIFFA                                       CSD015 CSW210
174900200529     C**********           ENDIF                                                       CSD015 CSW210
175000200529     C           PINVE     IFNE T2INVE                                                        CSW210
175100200529     C                     MOVELPINVE     WLF,13                                              CSW210
175200200529     C                     MOVEL'Y'       WDIFFA                                              CSW210
175300200529     C                     ENDIF                                                              CSW210
175400200529      *                                                                                       CSW210
175500200529     C           WWDIDN    IFNE T2DIDN                                                        CSW210
175600200529     C                     MOVELWWDIDN    WLF,14                                              CSW210
175700200529     C                     MOVEL'Y'       WDIFFA                                              CSW210
175800200529     C                     ENDIF                                                              CSW210
175900200529      *                                                                                       CSW210
176000200529     C           PQFIN     IFNE T2QFIN                                                        CSW210
176100200529     C                     MOVELPQFIN     WLF,15                                              CSW210
176200200529     C                     MOVEL'Y'       WDIFFA                                              CSW210
176300200529     C                     ENDIF                                                              CSW210
176400200529      *                                                                                       CSD015
176500200529      **  Settlement Party Intermediary                                                       CSD015
176600200529      *                                                                                       CSD015
176700200529     C           PIMMD1    IFNE T2IMD1                                                        CSD015
176800200529     C                     MOVELPIMMD1    MMD,1                                               CSD015
176900200529     C                     MOVEL'Y'       WIMDA                                               CSD015
177000200529     C                     ENDIF                                                              CSD015
177100200529      *                                                                                       CSD015
177200200529     C           PIMMD2    IFNE T2IMD2                                                        CSD015
177300200529     C                     MOVELPIMMD2    MMD,2                                               CSD015
177400200529     C                     MOVEL'Y'       WIMDA                                               CSD015
177500200529     C                     ENDIF                                                              CSD015
177600200529      *                                                                                       CSD015
177700200529     C           PIMMD3    IFNE T2IMD3                                                        CSD015
177800200529     C                     MOVELPIMMD3    MMD,3                                               CSD015
177900200529     C                     MOVEL'Y'       WIMDA                                               CSD015
178000200529     C                     ENDIF                                                              CSD015
178100200529      *                                                                                       CSD015
178200200529     C           PIMMD4    IFNE T2IMD4                                                        CSD015
178300200529     C                     MOVELPIMMD4    MMD,4                                               CSD015
178400200529     C                     MOVEL'Y'       WIMDA                                               CSD015
178500200529     C                     ENDIF                                                              CSD015
178600200529      *                                                                                       CSD015
178700200529     C           PIMMD5    IFNE T2IMD5                                                        CSD015
178800200529     C                     MOVELPIMMD5    MMD,5                                               CSD015
178900200529     C                     MOVEL'Y'       WIMDA                                               CSD015
179000200529     C                     ENDIF                                                              CSD015
179100200529      *                                                                                       CSD015
179200200529     C           PIMMD6    IFNE T2IMD6                                                        CSD015
179300200529     C                     MOVELPIMMD6    MMD,6                                               CSD015
179400200529     C                     MOVEL'Y'       WIMDA                                               CSD015
179500200529     C                     ENDIF                                                              CSD015
179600200529      *                                                                                       CSD015
179700200529     C           PIMMD7    IFNE T2IMD7                                                        CSD015
179800200529     C                     MOVELPIMMD7    MMD,7                                               CSD015
179900200529     C                     MOVEL'Y'       WIMDA                                               CSD015
180000200529     C                     ENDIF                                                              CSD015
180100200529      *                                                                                       CSD015
180200200529     C           PIMMD8    IFNE T2IMD8                                                        CSD015
180300200529     C                     MOVELPIMMD8    MMD,8                                               CSD015
180400200529     C                     MOVEL'Y'       WIMDA                                               CSD015
180500200529     C                     ENDIF                                                              CSD015
180600200529      *                                                                                       CSD015
180700200529     C           PIMMD9    IFNE T2IMD9                                                        CSD015
180800200529     C                     MOVELPIMMD9    MMD,9                                               CSD015
180900200529     C                     MOVEL'Y'       WIMDA                                               CSD015
181000200529     C                     ENDIF                                                              CSD015
181100200529      *                                                                                       CSD015
181200200529      **  Safekeeping Account Intermediary                                                    CSD015
181300200529      *                                                                                       CSD015
181400200529     C           PIMSA1    IFNE T2IMS1                                                        CSD015
181500200529     C                     MOVELPIMSA1    MSA,1                                               CSD015
181600200529     C                     MOVEL'Y'       WIMSA                                               CSD015
181700200529     C                     ENDIF                                                              CSD015
181800200529      *                                                                                       CSD015
181900200529     C           PIMSA2    IFNE T2IMS2                                                        CSD015
182000200529     C                     MOVELPIMSA2    MSA,2                                               CSD015
182100200529     C                     MOVEL'Y'       WIMSA                                               CSD015
182200200529     C                     ENDIF                                                              CSD015
182300200529      *                                                                                       CSD015
182400200529     C           PIMSA3    IFNE T2IMS3                                                        CSD015
182500200529     C                     MOVELPIMSA3    MSA,3                                               CSD015
182600200529     C                     MOVEL'Y'       WIMSA                                               CSD015
182700200529     C                     ENDIF                                                              CSD015
182800200529      *                                                                                       CSD015
182900200529     C           PIMSA4    IFNE T2IMS4                                                        CSD015
183000200529     C                     MOVELPIMSA4    MSA,4                                               CSD015
183100200529     C                     MOVEL'Y'       WIMSA                                               CSD015
183200200529     C                     ENDIF                                                              CSD015
183300200529      *                                                                                       CSD015
183400200529     C           PIMSA5    IFNE T2IMS5                                                        CSD015
183500200529     C                     MOVELPIMSA5    MSA,5                                               CSD015
183600200529     C                     MOVEL'Y'       WIMSA                                               CSD015
183700200529     C                     ENDIF                                                              CSD015
183800200529      *                                                                                       CSD015
183900200529     C           PIMSA6    IFNE T2IMS6                                                        CSD015
184000200529     C                     MOVELPIMSA6    MSA,6                                               CSD015
184100200529     C                     MOVEL'Y'       WIMSA                                               CSD015
184200200529     C                     ENDIF                                                              CSD015
184300200529      *                                                                                       CSD015
184400200529     C           PIMSA7    IFNE T2IMS7                                                        CSD015
184500200529     C                     MOVELPIMSA7    MSA,7                                               CSD015
184600200529     C                     MOVEL'Y'       WIMSA                                               CSD015
184700200529     C                     ENDIF                                                              CSD015
184800200529      *                                                                                       CSD015
184900200529     C           PIMSA8    IFNE T2IMS8                                                        CSD015
185000200529     C                     MOVELPIMSA8    MSA,8                                               CSD015
185100200529     C                     MOVEL'Y'       WIMSA                                               CSD015
185200200529     C                     ENDIF                                                              CSD015
185300200529      *                                                                                       CSD015
185400200529     C           PIMSA9    IFNE T2IMS9                                                        CSD015
185500200529     C                     MOVELPIMSA9    MSA,9                                               CSD015
185600200529     C                     MOVEL'Y'       WIMSA                                               CSD015
185700200529     C                     ENDIF                                                              CSD015
185800200529      *                                                                                       CSD015
185900200529     C                     ENDSR                                                              CSD015
186000200529      *                                                                                       CSD015
186100200529      *****************************************************************                       CSD015
186200200529      /EJECT                                                                                  CSD015
186300200529      *****************************************************************                       CSD015
186400200529      **                                                              *                       CSD015
186500200529      **  SRFMT     - Format watch list fields                        *                       CSD015
186600200529      **                                                              *                       CSD015
186700200529      **  Calls     - None.                                           *                       CSD015
186800200529      **  Called By - SRINS, SRAMD                                    *                       CSD015
186900200529      **                                                              *                       CSD015
187000200529      *****************************************************************                       CSD015
187100200529      *                                                                                       CSD015
187200200529     C           SRFMT     BEGSR                                                              CSD015
187300200529      *                                                                                       CSD015
187400200529     C                     CLEARPMCWL                                                         CSD015
187500200529      *                                                                                       CSD015
187600200529     C           WDIFFI    IFEQ 'Y'                                                           CSD015
187700200529     C           WDIFFA    OREQ 'Y'                                                           CSD015
187800200529      *                                                                                       CSD015
187900200529     C                     Z-ADD0         WID     20                                          CSD015
188000200529     C********** WID       DOUEQ13                                                     CSD015 CSW210
188100200529     C           WID       DOUEQ15                                                            CSW210
188200200529     C                     ADD  1         WID                                                 CSD015
188300200529     C                     MOVELWLF,WID   PINP1                                               CSD015
188400200529      *                                                                                       CSD015
188500200529     C           WLF,WID   IFNE *BLANKS                                                       CSD015
188600200529     C           WLF,WID   ANDNE'000000'                                                      CSD015
188700200529      *                                                                                       CSD015
188800200529     C                     CALL 'SDCWLFMT'                                                    CSD015
188900200529     C                     PARM           PRTCD   7                                           CSD015
189000200529     C                     PARM           PINP1  35                                           CSD015
189100200529     C                     PARM *BLANKS   PINP2  35                                           CSD015
189200200529     C                     PARM *BLANKS   PINP3  35                                           CSD015
189300200529     C                     PARM *BLANKS   PINP4  35                                           CSD015
189400200529     C                     PARM *BLANKS   PINP5  35                                           CSD015
189500200529     C                     PARM *BLANKS   PINP6  35                                           CSD015
189600200529     C                     PARM           PCCY    3                                           CSD015
189700200529     C                     PARM           POUT  216                                           CSD015
189800200529     C                     PARM           PCNUM   6                                           CSD015
189900200529      *                                                                                       CSD015
190000200529     C           WID       MULT 2         CLS     20                                          CSD015
190100200529     C           CLS       SUB  1         OPN     20                                          CSD015
190200200529      *                                                                                       CSD015
190300200529     C                     MOVELCWA,OPN   WOPN   25                                           CSD015
190400200529     C                     MOVELCWA,CLS   WCLS   25                                           CSD015
190500200529      *                                                                                       CSD015
190600200529     C           PMCWL     CAT  WOPN:0    PMCWL                                               CSD015
190700200529     C                     CAT  POUT:0    PMCWL                                               CSD015
190800200529      *                                                                                       CSD015
190900200529     C                     SELEC                                                              CSD015
191000200529     C           WID       WHEQ 1                                                             CSD015
191100200529     C                     CAT  SAP1L:0   PMCWL                                               CSD015
191200200529     C           WID       WHEQ 2                                                             CSD015
191300200529     C                     CAT  SAFPL:0   PMCWL                                               CSD015
191400200529     C           WID       WHEQ 3                                                             CSD015
191500200529     C                     CAT  SAWIL:0   PMCWL                                               CSD015
191600200529     C           WID       WHEQ 4                                                             CSD015
191700200529     C                     CAT  SBOF1:0   PMCWL                                               CSD015
191800200529     C                     CAT  SBOF2:0   PMCWL                                               CSD015
191900200529     C           WID       WHEQ 5                                                             CSD015
192000200529     C                     CAT  SIPYL:0   PMCWL                                               CSD015
192100200529     C           WID       WHEQ 6                                                             CSD015
192200200529     C                     CAT  SCTYL:0   PMCWL                                               CSD015
192300200529     C           WID       WHEQ 7                                                             CSD015
192400200529     C                     CAT  SSA1L:0   PMCWL                                               CSD015
192500200529     C           WID       WHEQ 8                                                             CSD015
192600200529     C                     CAT  SSKAL:0   PMCWL                                               CSD015
192700200529     C           WID       WHEQ 14                                                            CSW210
192800200529     C                     CAT  SDIDN:0   PMCWL                                               CSW210
192900200529     C           WID       WHEQ 15                                                            CSW210
193000200529     C                     CAT  PQFIN:0   PMCWL                                               CSW210
193100200529     C                     ENDSL                                                              CSD015
193200200529      *                                                                                       CSD015
193300200529     C                     CAT  WCLS:0    PMCWL                                               CSD015
193400200529      *                                                                                       CSD015
193500200529     C                     ENDIF                                                              CSD015
193600200529      *                                                                                       CSD015
193700200529     C                     ENDDO                                                              CSD015
193800200529     C                     ENDIF                                                              CSD015
193900200529      *                                                                                       CSD015
194000200529      ** Add the Settlement Party Intermediary                                                CSD015
194100200529      *                                                                                       CSD015
194200200529     C           WIMDI     IFEQ 'Y'                                                           CSD015
194300200529     C           WIMDA     OREQ 'Y'                                                           CSD015
194400200529      *                                                                                       CSD015
194500200529     C                     CLEARTEMPDS                                                        CSD015
194600200529     C                     Z-ADD0         WID     20                                          CSD015
194700200529      *                                                                                       CSD015
194800200529     C           WID       DOUEQ9                                                             CSD015
194900200529     C                     ADD  1         WID                                                 CSD015
195000200529     C                     MOVELMMD,WID   PINP1                                               CSD015
195100200529      *                                                                                       CSD015
195200200529     C           MMD,WID   IFNE *BLANKS                                                       CSD015
195300200529     C           MMD,WID   ANDNE'000000'                                                      CSD015
195400200529      *                                                                                       CSD015
195500200529     C                     CALL 'SDCWLFMT'                                                    CSD015
195600200529     C                     PARM           PRTCD   7                                           CSD015
195700200529     C                     PARM           PINP1  35                                           CSD015
195800200529     C                     PARM *BLANKS   PINP2  35                                           CSD015
195900200529     C                     PARM *BLANKS   PINP3  35                                           CSD015
196000200529     C                     PARM *BLANKS   PINP4  35                                           CSD015
196100200529     C                     PARM *BLANKS   PINP5  35                                           CSD015
196200200529     C                     PARM *BLANKS   PINP6  35                                           CSD015
196300200529     C                     PARM           PCCY    3                                           CSD015
196400200529     C                     PARM           POUT  216                                           CSD015
196500200529     C                     PARM           PCNUM   6                                           CSD015
196600200529      *                                                                                       CSD015
196700200529     C                     CAT  POUT:0    TEMPDS                                              CSD015
196800200529     C                     ENDIF                                                              CSD015
196900200529     C                     ENDDO                                                              CSD015
197000200529      *                                                                                       CSD015
197100200529     C           TEMPDS    IFNE *BLANKS                                                       CSD015
197200200529     C**********           CAT  CWA,27:0  PMCWL                                        CSD015 CSW210
197300200529     C                     CAT  CWA,31:0  PMCWL                                               CSW210
197400200529     C                     CAT  TEMPDS:0  PMCWL                                               CSD015
197500200529     C**********           CAT  CWA,28:0  PMCWL                                        CSD015 CSW210
197600200529     C                     CAT  CWA,32:0  PMCWL                                               CSW210
197700200529     C                     ENDIF                                                              CSD015
197800200529     C                     ENDIF                                                              CSD015
197900200529      *                                                                                       CSD015
198000200529      ** Add the Safekeeping Account Intermediary                                             CSD015
198100200529      *                                                                                       CSD015
198200200529     C           WIMSI     IFEQ 'Y'                                                           CSD015
198300200529     C           WIMSA     OREQ 'Y'                                                           CSD015
198400200529      *                                                                                       CSD015
198500200529     C                     CLEARTEMPDS                                                        CSD015
198600200529     C                     Z-ADD0         WID     20                                          CSD015
198700200529      *                                                                                       CSD015
198800200529     C           WID       DOUEQ9                                                             CSD015
198900200529     C                     ADD  1         WID                                                 CSD015
199000200529     C                     MOVELMSA,WID   PINP1                                               CSD015
199100200529      *                                                                                       CSD015
199200200529     C           MSA,WID   IFNE *BLANKS                                                       CSD015
199300200529     C           MSA,WID   ANDNE'000000'                                                      CSD015
199400200529      *                                                                                       CSD015
199500200529     C                     CALL 'SDCWLFMT'                                                    CSD015
199600200529     C                     PARM           PRTCD   7                                           CSD015
199700200529     C                     PARM           PINP1  35                                           CSD015
199800200529     C                     PARM *BLANKS   PINP2  35                                           CSD015
199900200529     C                     PARM *BLANKS   PINP3  35                                           CSD015
200000200529     C                     PARM *BLANKS   PINP4  35                                           CSD015
200100200529     C                     PARM *BLANKS   PINP5  35                                           CSD015
200200200529     C                     PARM *BLANKS   PINP6  35                                           CSD015
200300200529     C                     PARM           PCCY    3                                           CSD015
200400200529     C                     PARM           POUT  216                                           CSD015
200500200529     C                     PARM           PCNUM   6                                           CSD015
200600200529      *                                                                                       CSD015
200700200529     C                     CAT  POUT:0    TEMPDS                                              CSD015
200800200529     C                     ENDIF                                                              CSD015
200900200529     C                     ENDDO                                                              CSD015
201000200529      *                                                                                       CSD015
201100200529     C           TEMPDS    IFNE *BLANKS                                                       CSD015
201200200529     C**********           CAT  CWA,29:0  PMCWL                                        CSD015 CSW210
201300200529     C                     CAT  CWA,33:0  PMCWL                                               CSW210
201400200529     C                     CAT  TEMPDS:0  PMCWL                                               CSD015
201500200529     C**********           CAT  CWA,30:0  PMCWL                                        CSD015 CSW210
201600200529     C                     CAT  CWA,34:0  PMCWL                                               CSW210
201700200529     C                     ENDIF                                                              CSD015
201800200529     C                     ENDIF                                                              CSD015
201900200529      *                                                                                       CSD015
202000200529     C                     ENDSR                                                              CSD015
202100200529      *                                                                                       CSD015
202200200529      *****************************************************************
202300200529      /EJECT
202400200529      *****************************************************************
202500200529      **                                                              *
202600200529      **  SRENQ     - To Process Enquiry Action                       *
202700200529      **                                                              *
202800200529      **  Calls     -                                                 *
202900200529      **  Called By -                                                 *
203000200529      **                                                              *
203100200529      *****************************************************************
203200200529      *
203300200529     C           SRENQ     BEGSR
203400200529      *
203500200529      ** Set indicators to protect fields
203600200529     C                     SETON                     0910
203700200529      *
203800200529      ** Check whether record exists
203900200529     C           KEY001    CHAINRTVIDX               89
204000200529     C/COPY WNCPYSRC,SE1806C039
204100200529      *
204200200529      ** If record found then set file fields to screen fields
204300200529     C           *IN89     IFEQ *OFF
204400200529     C                     EXSR SRFTOS
204500200529      *
204600200529      ** Redisplay first screen until rolldown on 2nd screen NOT taken
204700200529      ** or F3 (to End) or F5 (to Refresh) taken
204800200529     C           *IN86     DOUEQ*OFF
204900200529     C           *INKC     OREQ *ON
205000200529     C           *INKE     OREQ *ON
205100200529     C                     SETOF                     86
205200200529      *
205300200529      ** Display first screen; if rollup taken display second screen;
205400200529     C                     EXSR SRSCR1
205500200529     C********** *IN85     IFEQ *ON                                                           209945
205600200529     C           *IN85     DOWEQ*ON                                                           209945
205700200529     C           *IN86     ANDEQ*OFF                                                          209945
205800200529     C           *INKC     ANDEQ*OFF                                                          209945
205900200529     C           *INKE     ANDEQ*OFF                                                          209945
206000200529     C/COPY WNCPYSRC,SE1806C040
206100200529      *                                                                                       CSE028
206200200529      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
206300200529      *                                                                                       CSE028
206400200529     C           CSE028    IFEQ 'Y'                                                           CSE028
206500200529      *                                                                                       CSE028
206600200529     C           PSNEW     IFEQ 'Y'                                                           CSE028
206700200529     C                     MOVE *ON       *IN84                                               CSE028
206800200529     C                     MOVE *ON       *IN77                                               CSE028
206900200529     C                     ENDIF                                                              CSE028
207000200529      *                                                                                       CSE028
207100200529     C                     ENDIF                                                              CSE028
207200200529      *                                                                                       CSE028
207300200529     C                     EXSR SRSCR2
207400200529      *                                                                                       CSE028
207500200529      ** If Rollup was taken on second screen, call SE001810                                  CSE028
207600200529      *                                                                                       CSE028
207700200529     C           CSE028    IFEQ 'Y'                                                           CSE028
207800200529     C           *IN84     ANDEQ*ON                                                           CSE028
207900200529      *                                                                                       CSE028
208000200529     C                     EXSR SRSCR3                                                        CSE028
208100200529      *                                                                                       CSE028
208200200529     C                     ENDIF                                                              CSE028
208300200529      *                                                                                       CSE028
208400200529     C/COPY WNCPYSRC,SE1806C041
208500200529     C                     END
208600200529     C                     END
208700200529      *
208800200529     C                     END
208900200529      *
209000200529     C                     ENDSR
209100200529      *
209200200529      *****************************************************************
209300200529      /EJECT
209400200529      *****************************************************************
209500200529      *                                                               *
209600200529      *  SRINB  - Routine to initialize screen fields with defaults.  *
209700200529      *                                                               *
209800200529      *****************************************************************
209900200529      *
210000200529     C           SRINB     BEGSR
210100200529      *
210200200529      **  Screen fields are initialized from the parameter TRADX2,
210300200529      **  which has the same layout as the file TRADSDX2
210400200529      **  Note positions (1 6) Trade reference have been replaced by
210500200529      **  the bulk reference number generated in SE3000.
210600200529     C                     MOVELW2TDRF    SBLKR
210700200529      *                                                                   CSW098
210800200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
210900200529     C                     MOVELW2AP1N    SAP1N
211000200529     C                     ELSE                                           CSW098
211100200529     C                     MOVEL*BLANKS   SAP1N                           CSW098
211200200529     C                     ENDIF                                          CSW098
211300200529      *                                                                   CSW098
211400200529     C                     MOVELW2AP1L    SAP1L
211500200529     C                     MOVELW2AFPN    SAFPN
211600200529     C                     MOVELW2AFPL    SAFPL
211700200529     C                     MOVELW2AWIA    SAWIA
211800200529     C                     MOVELW2AWIN    SAWIN
211900200529     C                     MOVELW2AWIL    SAWIL
212000200529     C                     MOVELW2BOFA    SBOFA
212100200529     C                     MOVELW2BOFN    SBOFN
212200200529     C                     MOVELW2BOF1    SBOF1
212300200529     C           CSW210    IFNE 'Y'                                                           CSW210
212400200529     C                     MOVELW2BOF2    SBOF2
212500200529     C                     ENDIF                                                              CSW210
212600200529     C                     MOVELW2ACL1    SACL1
212700200529     C                     MOVELW2ACL2    SACL2
212800200529     C                     MOVELW2SRL1    SSRL1
212900200529     C                     MOVELW2SRL2    SSRL2
213000200529     C                     MOVELW2SRL3    SSRL3
213100200529     C                     MOVELW2FIN1    SFIN1
213200200529     C                     MOVELW2FIN2    SFIN2
213300200529     C**********           MOVELW2RED1    SRED1                                               CSW210
213400200529     C**********           MOVELW2RED2    SRED2                                               CSW210
213500200529     C                     MOVELW2NAL1    SNAL1
213600200529     C                     MOVELW2NAL2    SNAL2
213700200529     C                     MOVELW2IPYN    SIPYN
213800200529     C                     MOVELW2IPYL    SIPYL
213900200529      *                                                                   CSW098
214000200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
214100200529     C                     MOVELW2CTYN    SCTYN
214200200529     C                     ELSE                                           CSW098
214300200529     C                     MOVEL*BLANKS   SCTYN                           CSW098
214400200529     C                     ENDIF                                          CSW098
214500200529      *                                                                   CSW098
214600200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
214700200529     C                     MOVELW2CTYL    SCTYL
214800200529     C**********           MOVEL*BLANKS   SINVE                                        CSW098 CSW210
214900200529     C                     MOVEL*BLANKS   PINVE                                               CSW210
215000200529     C                     ELSE                                           CSW098
215100200529     C                     MOVEL*BLANKS   SCTYL                           CSW098
215200200529     C**********           MOVELW2INVE    SINVE                                        CSW098 CSW210
215300200529     C                     MOVELW2INVE    PINVE                                               CSW210
215400200529     C                     ENDIF                                          CSW098
215500200529      *                                                                   CSW098
215600200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
215700200529     C           *IN78     OREQ *ON                                                           201429
215800200529     C                     MOVELW2SA1N    SSA1N
215900200529     C                     ELSE                                           CSW098
216000200529     C                     MOVEL*BLANKS   SSA1N                           CSW098
216100200529     C                     ENDIF                                          CSW098
216200200529      *                                                                   CSW098
216300200529     C                     MOVELW2SA1L    SSA1L
216400200529     C                     MOVELW2SKAN    SSKAN
216500200529     C                     MOVELW2SKAL    SSKAL
216600200529     C                     MOVELW2CCTN    SCCTN
216700200529     C                     MOVELW2DCTL    SDCTL
216800200529     C                     MOVELW2RSSA    SRSSA
216900200529     C                     MOVELW2RSSN    SRSSN
217000200529     C                     MOVELW2RSS1    SRSS1
217100200529     C                     MOVELW2RSS2    SRSS2
217200200529     C                     MOVELW2RSS3    SRSS3
217300200529     C                     MOVELW2RSS4    SRSS4
217400200529     C                     MOVELW2DSSA    SDSSA
217500200529     C                     MOVELW2DSSN    SDSSN
217600200529     C                     MOVELW2DSS1    SDSS1
217700200529      *
217800200529     C                     MOVELW2DSS2    SDSS2
217900200529     C                     MOVELW2DSS3    SDSS3
218000200529     C                     MOVELW2DSS4    SDSS4
218100200529     C                     MOVELW2BSSA    SBSSA
218200200529     C                     MOVELW2BSSN    SBSSN
218300200529     C                     MOVELW2BSS1    SBSS1
218400200529     C                     MOVELW2BSS2    SBSS2
218500200529      *
218600200529     C                     ENDSR
218700200529     C/COPY WNCPYSRC,SE1806C021
218800200529      *
218900200529      *****************************************************************
219000200529      /EJECT
219100200529      *****************************************************************
219200200529      **                                                              *
219300200529      **  SRSMSG    - To Send Messages to Message Subfile             *
219400200529      **                                                              *
219500200529      *****************************************************************
219600200529      *
219700200529     C           SRSMSG    BEGSR
219800200529      *
219900200529      ** Send specified message from specified message file to program
220000200529      ** message queue; then clear message id and message file
220100200529     C                     CALL 'ZA0340'
220200200529     C                     PARM 'SEUSRMSG'ZAMSGF 10
220300200529     C                     PARM           ZAMSID 10
220400200529      *
220500200529     C                     MOVEL*BLANK    ZAMSID
220600200529      *
220700200529     C                     ENDSR
220800200529      *
220900200529      *****************************************************************                       CSW210
221000200529      /EJECT                                                                                  CSW210
221100200529      *****************************************************************                       CSW210
221200200529      **                                                              *                       CSW210
221300200529      **  SREMSG    - To Send Messages to Message Subfile             *                       CSW210
221400200529      **              with Message Data                               *                       CSW210
221500200529      **                                                              *                       CSW210
221600200529      *****************************************************************                       CSW210
221700200529      *                                                                                       CSW210
221800200529     C           SREMSG    BEGSR                                                              CSW210
221900200529      *                                                                                       CSW210
222000200529      ** Send specified message from specified message file to program                        CSW210
222100200529      ** message queue; then clear message id and message file                                CSW210
222200200529     C                     CALL 'ZA0350'                                                      CSW210
222300200529     C                     PARM 'SEUSRMSG'ZAMSGF                                              CSW210
222400200529     C                     PARM           ZAMSID                                              CSW210
222500200529     C                     PARM           ZAMSDT 45                                           CSW210
222600200529      *                                                                                       CSW210
222700200529     C                     MOVEL*BLANK    ZAMSID                                              CSW210
222800200529     C                     MOVEL*BLANK    ZAMSDT                                              CSW210
222900200529      *                                                                                       CSW210
223000200529     C                     ENDSR                                                              CSW210
223100200529      *                                                                                       CSW210
223200200529      *****************************************************************
223300200529      /EJECT
223400200529      *****************************************************************
223500200529      **                                                              *
223600200529      **  SRALOC    - To Access Record via Update Index               *
223700200529      **                                                              *
223800200529      **  Calls     -                                                 *
223900200529      **  Called By -                                                 *
224000200529      **                                                              *
224100200529      *****************************************************************
224200200529      *
224300200529     C           SRALOC    BEGSR
224400200529      *
224500200529     C           KEY001    CHAINUPDIDX               8081
224600200529      *
224700200529      ** If record not on file, setup message 'Record deleted'
224800200529     C           *IN80     IFEQ *ON
224900200529     C                     MOVEL'SEW9998' ZAMSID
225000200529     C                     EXSR SRSMSG
225100200529     C                     END
225200200529      *
225300200529     C                     ENDSR
225400200529      *
225500200529     C/COPY WNCPYSRC,SE1806C042
225600200529      *****************************************************************
225700200529      /EJECT
225800200529      *****************************************************************
225900200529      **                                                              *
226000200529      **  SRRTRN    - To set up return code and exit program          *
226100200529      **                                                              *
226200200529      **  Calls     -                                                 *
226300200529      **  Called By -                                                 *
226400200529      **                                                              *
226500200529      *****************************************************************
226600200529      *
226700200529     C           SRRTRN    BEGSR
226800200529      *
226900200529     C                     MOVE 'N'       PERR
227000200529     C                     MOVE '00'      PCMD
227100200529      *
227200200529      ** If error on updating file set Return Error Code to 'U'
227300200529     C           *IN88     IFEQ *ON
227400200529     C                     MOVE 'U'       PERR
227500200529     C                     ELSE
227600200529      *
227700200529      ** If Rolldown or F12 (for Previous) set Return Command to '12'
227800200529     C           *IN87     IFEQ *ON
227900200529     C           *INKL     OREQ *ON
228000200529     C                     MOVE '12'      PCMD
228100200529     C                     ELSE
228200200529      *
228300200529      ** If no record retrieved for enquiry set Return Err Comm to 'R'
228400200529     C           PACTN     IFEQ 'E'
228500200529     C           *IN89     ANDEQ*ON
228600200529     C                     MOVE 'R'       PERR
228700200529     C                     ELSE
228800200529      *
228900200529      ** If F3 (to End) taken set Return Command to '03'
229000200529     C           *INKC     IFEQ *ON
229100200529     C                     MOVE '03'      PCMD
229200200529     C                     ELSE
229300200529      *
229400200529      ** If F5 (to Refresh) set Return Command to '05'
229500200529     C           *INKE     IFEQ *ON
229600200529     C                     MOVE '05'      PCMD
229700200529     C                     ELSE
229800200529      *
229900200529      ** If F14 (to Exit Extended Settlements) set Return Comm to '14'
230000200529     C           *INKN     IFEQ *ON
230100200529     C                     MOVE '14'      PCMD
230200200529     C                     END
230300200529      *
230400200529     C                     END
230500200529     C                     END
230600200529     C                     END
230700200529     C                     END
230800200529     C                     END
230900200529     C/COPY WNCPYSRC,SE1806C043
231000200529      *
231100200529      ** Seton *INLR to exit program
231200200529     C                     SETON                     LR
231300200529      *
231400200529     C                     ENDSR
231500200529      *
231600200529      *****************************************************************
231700200529      /EJECT
231800200529      *****************************************************************
231900200529      **                                                              *
232000200529      **  SRSCR1    - To Output Messages and First Screen             *
232100200529      **                                                              *
232200200529      **  Calls     -                                                 *
232300200529      **  Called By -                                                 *
232400200529      **                                                              *
232500200529      *****************************************************************
232600200529      *
232700200529     C           SRSCR1    BEGSR
232800200529      *
232900200529      ** Display message format; display first screen
233000200529     C                     WRITESE1806C1
233100200529     C                     EXFMTSE1806F1
233200200529      *
233300200529     C                     ENDSR
233400200529      *
233500200529      *****************************************************************
233600200529      /EJECT
233700200529      *****************************************************************
233800200529      **                                                              *
233900200529      **  SRSCR2    - To Output Messages and Second Screen            *
234000200529      **                                                              *
234100200529      **  Calls     -                                                 *
234200200529      **  Called By -                                                 *
234300200529      **                                                              *
234400200529      *****************************************************************
234500200529      *
234600200529     C           SRSCR2    BEGSR
234700200529      *
234800200529      ** Display message format; display second screen
234900200529     C                     WRITESE1806C1
235000200529     C                     EXFMTSE1806F2
235100200529      *
235200200529     C                     ENDSR
235300200529      *
235400200529     C/COPY WNCPYSRC,SE1806C044
235500200529      *****************************************************************
235600200529      /EJECT                                                                                  CSE028
235700200529      *****************************************************************                       CSE028
235800200529      *                                                               *                       CSE028
235900200529      *  SRSCR3    - Call SE001810 to display and process third screen*                       CSE028
236000200529      *                                                               *                       CSE028
236100200529      *  Calls     - SE001810                                         *                       CSE028
236200200529      *  Called By - SRINS, SRAMD & SRENQ                             *                       CSE028
236300200529      *                                                               *                       CSE028
236400200529      *****************************************************************                       CSE028
236500200529      *                                                                                       CSE028
236600200529     C           SRSCR3    BEGSR                                                              CSE028
236700200529      *                                                                                       CSE028
236800200529      ** Check if Place of settlement from STDADSED is blanks or no SSI                       215783
236900200529      ** exist. If so, get default from Market Center file.                                   215783
237000200529      *                                                                                       215783
237100200529     C           PACTN     IFEQ 'I'                                                           215783
237200200529     C           PPSET     ANDEQ*BLANKS                                                       215783
237300200529     C           PACTN     OREQ 'B'                                                           215783
237400200529     C           PPSET     ANDEQ*BLANKS                                                       215783
237500200529     C           PSMCC     CHAINSEMKC                79                                       215783
237600200529     C           *IN79     IFEQ '0'                                                           215783
237700200529     C                     MOVE PSETL     PPSET                                               215783
237800200529     C                     END                                                                215783
237900200529     C                     END                                                                215783
238000200529      *                                                                                       215783
238100200529     C                     CALL 'SE001810'                                                    CSE028
238200200529     C                     PARM           PACTN   1                                           CSE028
238300200529     C                     PARM           PINTRM                                              CSE028
238400200529     C                     PARM           PSAFEA                                              CSE028
238500200529     C                     PARM           PPSET  12                                           CSE028
238600200529     C                     PARM           PNARR                                               CSE028
238700200529     C                     PARM *BLANKS   PRTCD   7                                           CSE028
238800200529     C                     PARM           PREGD                                               CSW210
238900200529     C                     PARM           PINVE  10                                           CSW210
239000200529     C                     PARM           PQFIN  10                                           CSW210
239100200529     C                     PARM           PPCLR  10                                           CSW210
239200200529      *                                                                                       CSE028
239300200529      ** Check Return Code                                                                    CSE028
239400200529      *                                                                                       CSE028
239500200529     C           PRTCD     IFEQ 'SE10000'                                                     CSE028
239600200529     C                     MOVE *ON       *INKC                                               CSE028
239700200529     C                     ENDIF                                                              CSE028
239800200529      *                                                                                       CSE028
239900200529     C           PRTCD     IFEQ 'SE10001'                                                     CSE028
240000200529     C                     MOVE *ON       *INKL                                               CSE028
240100200529     C                     MOVE 'Y'       W3RDFL  1                                           CSE028
240200200529     C                     ENDIF                                                              CSE028
240300200529      *                                                                                       CSE028
240400200529     C           PRTCD     IFEQ 'SE10029'                                                     CSE028
240500200529     C                     MOVE *ON       *IN85                                               CSE028
240600200529     C                     MOVE *ON       *IN02                                               201429
240700200529     C                     MOVE *ON       *IN75                                               201429
240800200529     C                     ENDIF                                                              CSE028
240900200529      *                                                                                       CSE028
241000200529     C           PRTCD     IFEQ *BLANKS                                                       CSE028
241100200529     C                     MOVE *OFF      *IN75                                               CSE028
241200200529     C                     MOVE *OFF      *IN85                                               CSE028
241300200529     C                     MOVE *OFF      *IN84                                               201429
241400200529     C                     ENDIF                                                              CSE028
241500200529      *                                                                                       CSE028
241600200529     C                     ENDSR                                                              CSE028
241700200529      *****************************************************************                       CSE028
241800200529      /EJECT
241900200529      *****************************************************************
242000200529      **                                                              *
242100200529      **  SRVAL     - To Control Validation of each Field             *
242200200529      **                                                              *
242300200529      **  Calls     -                                                 *
242400200529      **  Called By -                                                 *
242500200529      **                                                              *
242600200529      *****************************************************************
242700200529      *
242800200529     C           SRVAL     BEGSR
242900200529      *
243000200529      ** Initialize error condition indicators
243100200529     C                     SETOF                     0275
243200200529     C                     SETOF                     111214                                   CSW210
243300200529     C                     SETOF                     151617                                   CSW210
243400200529      *
243500200529     C                     MOVEA'00000000'*IN,21
243600200529     C                     MOVEA'00000000'*IN,29
243700200529     C                     MOVEA'00000000'*IN,37
243800200529     C                     MOVEA'00000000'*IN,45
243900200529     C                     MOVEA'00000000'*IN,53
244000200529     C                     MOVEA'00000000'*IN,61
244100200529     C/COPY WNCPYSRC,SE1806C045
244200200529     C                     MOVE *OFF      *IN19                           CSW098
244300200529      *
244400200529      ** Reset validations by F19
244500200529     C           *INKT     IFEQ *ON
244600200529     C                     MOVE *BLANK    OVER2
244700200529     C                     MOVE *BLANK    OVER3
244800200529     C                     MOVE *BLANK    OVER6
244900200529     C                     MOVE *BLANK    OVER7
245000200529     C                     MOVE *BLANK    OVER8
245100200529     C                     MOVE *BLANK    OVER9
245200200529     C                     END
245300200529      *
245400200529      ** Validate A/c for Payment fields (MT510)
245500200529     C                     EXSR SRAP1N
245600200529     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
245700200529     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
245800200529     C                     EXSR SRAP1L
245900200529     C**********           ENDIF                                                       199797 CSW210
246000200529      *
246100200529      ** Validate Account For Payment fields
246200200529     C                     EXSR SRAFPN
246300200529     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
246400200529     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
246500200529     C                     EXSR SRAFPL
246600200529     C**********           ENDIF                                                       199797 CSW210
246700200529      *                                                                                       CSW210
246800200529     C           CSW210    IFEQ 'Y'                                                           CSW210
246900200529      *                                                                                       CSW210
247000200529      ** Validate Validate Debtor (Identification)                                            CSW210
247100200529     C                     EXSR SRDIDN                                                        CSW210
247200200529      *                                                                                       CSW210
247300200529      ** Validate Validate Debtor (Address)                                                   CSW210
247400200529     C                     EXSR SRDADD                                                        CSW210
247500200529      *                                                                                       CSW210
247600200529      ** Validate Validate Debtor (Account Line)                                              CSW210
247700200529     C                     EXSR SRDLIN                                                        CSW210
247800200529     C                     ENDIF                                                              CSW210
247900200529      *
248000200529      ** Validate Account With Institution fields
248100200529     C           PSNEW     IFNE 'Y'                                                           212937
248200200529     C                     EXSR SRAWIA
248300200529     C                     ENDIF                                                              212937
248400200529     C                     EXSR SRAWIN
248500200529     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
248600200529     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
248700200529     C                     EXSR SRAWIL
248800200529     C**********           ENDIF                                                       199797 CSW210
248900200529      *
249000200529      ** Validate Beneficiary of Money fields
249100200529     C           PSNEW     IFNE 'Y'                                                           212937
249200200529     C                     EXSR SRBOFA
249300200529     C                     ENDIF                                                              212937
249400200529     C                     EXSR SRBOFN
249500200529     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
249600200529     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
249700200529     C                     EXSR SRBOF1
249800200529     C           PSNEW     IFNE 'Y'                                                           CSW210
249900200529     C           CSE028    ORNE 'Y'                                                           CSW210
250000200529     C           CSW210    IFNE 'Y'                                                           CSW210
250100200529     C                     EXSR SRBOF2
250200200529     C                     ENDIF                                                              CSW210
250300200529     C                     ENDIF                                                              199797
250400200529      *
250500200529      ** Validate Account For Charges fields
250600200529     C           PSNEW     IFNE 'Y'                                                           199797
250700200529     C           CSE028    ORNE 'Y'                                                           199797
250800200529     C                     EXSR SRACL1
250900200529     C                     EXSR SRACL2
251000200529     C                     ENDIF                                                              199797
251100200529      *
251200200529      ** Validate Sender to Receiver Information
251300200529     C           PSNEW     IFNE 'Y'                                                           199797
251400200529     C           CSE028    ORNE 'Y'                                                           199797
251500200529     C                     EXSR SRSRL1
251600200529     C                     EXSR SRSRL2
251700200529     C                     EXSR SRSRL3
251800200529     C                     ENDIF                                                              199797
251900200529      *
252000200529      ** Validate Further Information field
252100200529     C/COPY WNCPYSRC,SE1806C046
252200200529     C                     EXSR SRFIN1
252300200529     C                     EXSR SRFIN2
252400200529     C/COPY WNCPYSRC,SE1806C047
252500200529      *
252600200529      ** Validate Registration Details field
252700200529     C/COPY WNCPYSRC,SE1806C048
252800200529     C**********           EXSR SRRED1                                                        CSW210
252900200529     C**********           EXSR SRRED2                                                        CSW210
253000200529     C/COPY WNCPYSRC,SE1806C049
253100200529      *
253200200529      ** Validate Narrative field
253300200529     C                     EXSR SRNAL1
253400200529     C                     EXSR SRNAL2
253500200529      *                                                                   CSW098
253600200529      ** If ccy clearing code entered for a/c w/ bank or beneficiary,     CSW098
253700200529      ** check whether Issuer Code has been defined for the currency      CSW098
253800200529      ** clearing system and output warning message if not defined.       CSW098
253900200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
254000200529     C           *IN75     ANDEQ*OFF                                      CSW098
254100200529     C           IAWBK     IFEQ 'Y'                                       CSW098
254200200529     C                     MOVE *ON       *IN75                           CSW098
254300200529     C                     MOVE *ON       *IN27                           CSW098
254400200529     C                     MOVEL'SEW5176' ZAMSID                          CSW098
254500200529     C                     EXSR SRSMSG                                    CSW098
254600200529     C                     MOVEL*BLANKS   IAWBK                           CSW098
254700200529     C                     ENDIF                                          CSW098
254800200529     C           IBENF     IFEQ 'Y'                                       CSW098
254900200529     C                     MOVE *ON       *IN75                           CSW098
255000200529     C                     MOVE *ON       *IN30                           CSW098
255100200529     C                     MOVEL'SEW5176' ZAMSID                          CSW098
255200200529     C                     EXSR SRSMSG                                    CSW098
255300200529     C                     MOVEL*BLANKS   IBENF                           CSW098
255400200529     C                     ENDIF                                          CSW098
255500200529     C                     ENDIF                                          CSW098
255600200529      *                                                                                       CSW210
255700200529      ** Issue Warning Message for BIC error                                                  CSW210
255800200529     C           CSW210    IFEQ 'Y'                                                           CSW210
255900200529     C           WWADD     IFEQ 'Y'                                                           CSW210
256000200529     C           *IN75     ANDEQ*OFF                                                          CSW210
256100200529     C                     MOVE *ON       *IN75                                               CSW210
256200200529     C                     MOVE 'N'       WWADD                                               CSW210
256300200529     C                     ENDIF                                                              CSW210
256400200529     C                     ENDIF                                                              CSW210
256500200529      *                                                                                       CSW210
256600200529      ** Issue Warning Message for IBAN-SDLIN error                                           CSW210
256700200529     C           CSW210    IFEQ 'Y'                                                           CSW210
256800200529     C           WSDLIN    IFEQ 'Y'                                                           CSW210
256900200529     C           *IN75     ANDEQ*OFF                                                          CSW210
257000200529     C                     MOVE *ON       *IN75                                               CSW210
257100200529     C                     ENDIF                                                              CSW210
257200200529     C                     ENDIF                                                              CSW210
257300200529      *                                                                                       CSW210
257400200529      ** Issue Warning Message for IBAN-SAP1L error                                           CSW210
257500200529     C           CSW210    IFEQ 'Y'                                                           CSW210
257600200529     C           WSAP1L    IFEQ 'Y'                                                           CSW210
257700200529     C           *IN75     ANDEQ*OFF                                                          CSW210
257800200529     C                     MOVE *ON       *IN75                                               CSW210
257900200529     C                     ENDIF                                                              CSW210
258000200529     C                     ENDIF                                                              CSW210
258100200529      *                                                                                       CSW210
258200200529      ** Issue Warning Message for IBAN-SAP2L error                                           CSW210
258300200529     C           CSW210    IFEQ 'Y'                                                           CSW210
258400200529     C           WSAP2L    IFEQ 'Y'                                                           CSW210
258500200529     C           *IN75     ANDEQ*OFF                                                          CSW210
258600200529     C                     MOVE *ON       *IN75                                               CSW210
258700200529     C                     ENDIF                                                              CSW210
258800200529     C                     ENDIF                                                              CSW210
258900200529      *                                                                                       CSW210
259000200529      ** Issue Warning Message for IBAN-SAWIL error                                           CSW210
259100200529     C           CSW210    IFEQ 'Y'                                                           CSW210
259200200529     C           WSAWIL    IFEQ 'Y'                                                           CSW210
259300200529     C           *IN75     ANDEQ*OFF                                                          CSW210
259400200529     C                     MOVE *ON       *IN75                                               CSW210
259500200529     C                     ENDIF                                                              CSW210
259600200529     C                     ENDIF                                                              CSW210
259700200529      *                                                                                       CSW210
259800200529      ** Issue Warning Message for IBAN-SBOF1 error                                           CSW210
259900200529     C           CSW210    IFEQ 'Y'                                                           CSW210
260000200529     C           WSBOF1    IFEQ 'Y'                                                           CSW210
260100200529     C           *IN75     ANDEQ*OFF                                                          CSW210
260200200529     C                     MOVE *ON       *IN75                                               CSW210
260300200529     C                     ENDIF                                                              CSW210
260400200529     C                     ENDIF                                                              CSW210
260500200529      *
260600200529      ** No errors found on first screen
260700200529     C           *IN75     IFEQ *OFF
260800200529     C                     SETON                     02
260900200529     C                     END
261000200529      *
261100200529      ** Validate Instructing Party fields
261200200529     C                     EXSR SRIPYN
261300200529     C           PSNEW     IFNE 'Y'                                                           199797
261400200529     C           CSE028    ORNE 'Y'                                                           199797
261500200529     C                     EXSR SRIPYL
261600200529     C                     ENDIF                                                              199797
261700200529      *                                                                   CSW098
261800200529      ** Validate Investor                                                CSW098
261900200529     C**********           EXSR SRINVE                                                 CSW098 CSW210
262000200529      *
262100200529      ** Validate Counterparty fields
262200200529     C                     EXSR SRCTYN
262300200529     C                     EXSR SRCTYL
262400200529      *
262500200529      ** Validate Safekeeping Account fields (MT510)
262600200529     C                     EXSR SRSA1N
262700200529     C           PSNEW     IFNE 'Y'                                                           199797
262800200529     C           CSE028    ORNE 'Y'                                                           199797
262900200529     C                     EXSR SRSA1L
263000200529     C                     ENDIF                                                              199797
263100200529      *
263200200529      ** Validate Safekeeping Account fields
263300200529     C           *IN05     IFEQ *OFF                                                          201429
263400200529     C                     EXSR SRSKAN
263500200529      *                                                                                       201429
263600200529     C           SSKAL     IFEQ *BLANKS                                                       201429
263700200529     C           PSAFA     ANDEQ*BLANKS                                                       201429
263800200529     C           *IN78     ANDEQ*ON                                                           201429
263900200529     C                     MOVE '1'       *IN75                                               201429
264000200529     C                     MOVE '1'       *IN50                                               201429
264100200529     C                     MOVEL'SEW9004' ZAMSID                                              201429
264200200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
264300200529     C                     EXSR SRSMSG                                                        201429
264400200529     C                     ENDIF                                                              201429
264500200529      *                                                                                       201429
264600200529     C           SSKAL     IFNE *BLANKS                                                       201429
264700200529     C           PSAFA     ANDNE*BLANKS                                                       201429
264800200529     C           *IN78     ANDEQ*ON                                                           201429
264900200529     C                     MOVE '1'       *IN75                                               201429
265000200529     C                     MOVE '1'       *IN50                                               201429
265100200529     C                     MOVEL'SEW9007' ZAMSID                                              201429
265200200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
265300200529     C                     EXSR SRSMSG                                                        201429
265400200529     C                     ENDIF                                                              201429
265500200529      *                                                                                       201429
265600200529     C           PSNEW     IFNE 'Y'                                                           199797
265700200529     C           CSE028    ORNE 'Y'                                                           199797
265800200529     C                     EXSR SRSKAL
265900200529     C                     ENDIF                                                              199797
266000200529     C                     ENDIF                                                              201429
266100200529      *
266200200529      ** Validate Clearing Correspondent fields
266300200529     C           *IN06     IFEQ '0'                                                           199797
266400200529     C                     EXSR SRCCTN
266500200529     C                     ENDIF                                                              199797
266600200529      *
266700200529      ** Validate Deliverer's Instructing Party field
266800200529     C/COPY WNCPYSRC,SE1806C050
266900200529     C           PSNEW     IFNE 'Y'                                                           199797
267000200529     C           CSE028    ORNE 'Y'                                                           199797
267100200529     C                     EXSR SRDCTL
267200200529     C                     ENDIF                                                              199797
267300200529     C/COPY WNCPYSRC,SE1806C051
267400200529      *
267500200529      ** Validate Receiver of Securities fields
267600200529     C           PSNEW     IFNE 'Y'                                                           212937
267700200529     C                     EXSR SRRSSA
267800200529     C                     ENDIF                                                              212937
267900200529     C                     EXSR SRRSSN
268000200529     C           PSNEW     IFNE 'Y'                                                           199797
268100200529     C           CSE028    ORNE 'Y'                                                           199797
268200200529     C                     EXSR SRRSS1
268300200529     C                     EXSR SRRSS2
268400200529     C                     EXSR SRRSS3
268500200529     C                     EXSR SRRSS4
268600200529     C                     ENDIF                                                              199797
268700200529      *
268800200529      ** Validate Deliverer of Securities fields
268900200529     C           PSNEW     IFNE 'Y'                                                           212937
269000200529     C                     EXSR SRDSSA
269100200529     C                     ENDIF                                                              212937
269200200529     C                     EXSR SRDSSN
269300200529     C           PSNEW     IFNE 'Y'                                                           199797
269400200529     C           CSE028    ORNE 'Y'                                                           199797
269500200529     C                     EXSR SRDSS1
269600200529     C                     EXSR SRDSS2
269700200529     C                     EXSR SRDSS3
269800200529     C                     EXSR SRDSS4
269900200529     C                     ENDIF                                                              199797
270000200529      *
270100200529      ** Validate Beneficiary of Securities fields
270200200529     C           PSNEW     IFNE 'Y'                                                           212937
270300200529     C                     EXSR SRBSSA
270400200529     C                     ENDIF                                                              212937
270500200529     C                     EXSR SRBSSN
270600200529     C           PSNEW     IFNE 'Y'                                                           199797
270700200529     C           CSE028    ORNE 'Y'                                                           199797
270800200529     C                     EXSR SRBSS1
270900200529     C                     EXSR SRBSS2
271000200529     C                     ENDIF                                                              199797
271100200529      *
271200200529      ** No errors found on second screen
271300200529     C           *IN75     IFEQ *OFF
271400200529     C                     SETOF                     02
271500200529     C                     END
271600200529      *
271700200529     C                     ENDSR
271800200529      *
271900200529      *****************************************************************
272000200529      /EJECT
272100200529      *****************************************************************
272200200529      **                                                              *
272300200529      **  SRAP1N    - Validate A/c for Payment :53: (MT510)           *
272400200529      **                                                              *
272500200529      **  Calls     - SRCUST                                          *
272600200529      **  Called By - SRVAL                                           *
272700200529      **                                                              *
272800200529      *****************************************************************
272900200529      *
273000200529     C           SRAP1N    BEGSR
273100200529      *
273200200529      ** Validate if not Blank.
273300200529     C           SAP1N     IFNE *BLANKS
273400200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
273500200529      *
273600200529      ** This Field may only be used to generate a MT510
273700200529     C           PGMEC     IFNE 'Y'
273800200529     C           PCCID     ORNE 'C'
273900200529     C                     SETON                     2175
274000200529     C                     MOVEL'SEW5206' ZAMSID
274100200529     C                     EXSR SRSMSG
274200200529     C                     END
274300200529      *
274400200529      ** Set Error Indicator ON this field Before Validation.
274500200529     C           *IN21     IFEQ *OFF
274600200529     C                     SETON                     21
274700200529      *
274800200529      ** Validate Customer Number/Shortname/Nostro
274900200529     C                     MOVE SAP1N     WWCUST 10
275000200529     C                     EXSR SRCUST
275100200529      *
275200200529      ** Reset Error Indicator IF field is Valid
275300200529     C           WWCUSS    IFEQ 'C'
275400200529     C           WWCUSS    OREQ 'S'
275500200529     C           WWCUSS    OREQ 'N'
275600200529     C                     SETOF                     21
275700200529     C                     END
275800200529      *
275900200529      ** Customer Number/Shortname
276000200529     C           WWCUSS    IFEQ 'C'
276100200529     C           WWCUSS    OREQ 'S'
276200200529     C                     MOVELBBCUST    WWAP1N
276300200529     C                     END
276400200529      *
276500200529      ** Nostro
276600200529     C           WWCUSS    IFEQ 'N'
276700200529     C                     MOVELAWCPNC    WWAP1N
276800200529     C                     END
276900200529     C                     END
277000200529      *
277100200529     C                     ELSE
277200200529      *
277300200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
277400200529     C                     MOVE *BLANKS   WWAP1N
277500200529     C                     END
277600200529      *
277700200529     C                     ENDSR
277800200529      *
277900200529      *****************************************************************
278000200529      /EJECT
278100200529      *****************************************************************
278200200529      **                                                              *
278300200529      **  SRAP1L    - Validate A/c for Payment A/c Line :53: (MT510)  *
278400200529      **                                                              *
278500200529      **  Calls     - SRSMSG                                          *
278600200529      **  Called By - SRVAL                                           *
278700200529      **                                                              *
278800200529      *****************************************************************
278900200529      *
279000200529     C           SRAP1L    BEGSR
279100200529      *
279200200529     C           PSNEW     IFNE 'Y'                                                           CSW210
279300200529     C           CSE028    ORNE 'Y'                                                           CSW210
279400200529      ** Validate If not Blank
279500200529     C           SAP1L     IFNE *BLANKS
279600200529      *
279700200529     C           PGMEC     IFNE 'Y'
279800200529     C           PCCID     ORNE 'C'
279900200529     C                     SETON                     2275
280000200529     C           SAP1N     IFEQ *BLANKS
280100200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
280200200529     C                     MOVEL'SEW5206' ZAMSID
280300200529     C                     EXSR SRSMSG
280400200529     C                     END
280500200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
280600200529     C                     MOVEL'SEW5177' ZAMSID                          CSW098
280700200529     C                     EXSR SRSMSG                                    CSW098
280800200529     C                     ENDIF                                          CSW098
280900200529     C                     END
281000200529      *
281100200529     C                     MOVELSAP1L     WWLI01  1
281200200529     C           WWLI01    IFNE '/'
281300200529     C                     SETON                     2275
281400200529     C                     MOVEL'SEW5210' ZAMSID
281500200529     C                     EXSR SRSMSG
281600200529     C                     END
281700200529      *
281800200529     C                     MOVELSAP1L     WWLI02  2
281900200529     C           WWLI02    IFEQ '//'
282000200529     C                     SETON                     2275
282100200529     C                     MOVEL'SEW5211' ZAMSID
282200200529     C                     EXSR SRSMSG
282300200529     C                     END
282400200529      *
282500200529     C                     MOVE SAP1L     WWLI34 34
282600200529     C           WWLI01    IFEQ '/'
282700200529     C           WWLI34    ANDEQ*BLANKS
282800200529     C                     SETON                     2275
282900200529     C                     MOVEL'SEW5212' ZAMSID
283000200529     C                     EXSR SRSMSG
283100200529     C                     END
283200200529      *
283300200529     C                     END
283400200529      *
283500200529      ** Either SWIFT Field 53 or (57 AND 58) can be Entered
283600200529     C           SAP1N     IFNE *BLANKS
283700200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
283800200529     C           SAP1L     ORNE *BLANKS
283900200529      *
284000200529     C           SAWIN     IFNE *BLANKS
284100200529     C           SAWIL     ORNE *BLANKS
284200200529     C           SBOFN     ORNE *BLANKS
284300200529     C           SBOF1     ORNE *BLANKS
284400200529     C           SBOF2     ORNE *BLANKS
284500200529     C                     SETON                     2275
284600200529     C                     MOVEL'SEW5215' ZAMSID
284700200529     C                     EXSR SRSMSG
284800200529     C                     END
284900200529     C                     END
285000200529      *                                                                                       CSW210
285100200529     C                     ENDIF                                                              CSW210
285200200529      *                                                                                       CSW210
285300200529      ** Check if value inserted is an IBAN                                                   CSW210
285400200529     C           SAP1L     IFNE *BLANKS                                                       CSW210
285500200529     C           CSW210    ANDEQ'Y'                                                           CSW210
285600200529     C           CFT004    ANDEQ'Y'                                                           CSW210
285700200529      *                                                                                       CSW210
285800200529     C                     MOVELSAP1L     DSIBAN                                              CSW210
285900200529     C           SAP1L     IFNE WWAP1L                                                        CSW210
286000200529     C                     EXSR SRIBAN                                                        CSW210
286100200529     C                     MOVE WVIBAN    WWFAP1                                              CSW210
286200200529     C                     ENDIF                                                              CSW210
286300200529     C                     MOVE WIBNWR    WSAP1L                                              CSW210
286400200529      *                                                                                       CSW210
286500200529      ** Replace field value if validated as an IBAN input                                    CSW210
286600200529     C           WIBRTN    IFNE *BLANKS                                                       CSW210
286700200529     C                     MOVE 'N'       WSAP1L                                              CSW210
286800200529     C                     MOVELWIBRTN    SAP1L                                               CSW210
286900200529     C                     MOVE *BLANKS   WIBRTN                                              CSW210
287000200529     C                     ELSE                                                               CSW210
287100200529      *                                                                                       CSW210
287200200529      ** If not IBAN, throw corresponding warning messages                                    CSW210
287300200529     C           WSAP1L    IFEQ 'Y'                                                           CSW210
287400200529     C           SAP1L     ANDEQWWAP1L                                                        CSW210
287500200529     C                     MOVE 'N'       WSAP1L                                              CSW210
287600200529     C                     ELSE                                                               CSW210
287700200529     C           WIBNWR    IFEQ 'Y'                                                           CSW210
287800200529     C           SAP1L     ANDNEWWAP1L                                                        CSW210
287900200529     C                     MOVELWTIBAN    SAP1L                                               CSW210
288000200529     C                     SETON                     22                                       CSW210
288100200529     C                     MOVE 'Y'       WSAP1L                                              CSW210
288200200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
288300200529     C                     MOVELS210W,1   ZAMSDT                                              CSW210
288400200529     C                     EXSR SREMSG                                                        CSW210
288500200529     C                     ENDIF                                                              CSW210
288600200529     C                     ENDIF                                                              CSW210
288700200529     C                     ENDIF                                                              CSW210
288800200529     C                     MOVELSAP1L     WWAP1L                                              CSW210
288900200529     C                     ELSE                                                               CSW210
289000200529     C                     MOVE 'N'       WWFAP1                                              CSW210
289100200529     C                     ENDIF                                                              CSW210
289200200529      *
289300200529     C                     ENDSR
289400200529      *
289500200529      *****************************************************************
289600200529      /EJECT
289700200529      *****************************************************************
289800200529      **                                                              *
289900200529      **  SRAFPN    - Validate A/c for Payment :53:                   *
290000200529      **                                                              *
290100200529      **  Calls     - SRCUST                                          *
290200200529      **  Called By - SRVAL                                           *
290300200529      **                                                              *
290400200529      *****************************************************************
290500200529      *
290600200529     C           SRAFPN    BEGSR
290700200529      *
290800200529      ** Validate If not Blank
290900200529     C           SAFPN     IFNE *BLANKS
291000200529      *
291100200529      ** Account for Payment must be left Blank for Clearance 1 to 4
291200200529     C           WWCLTY    IFEQ '14'
291300200529     C           PSNEW     IFNE 'Y'                                                           212937
291400200529     C                     SETON                     2375
291500200529     C                     MOVEL'SEW5216' ZAMSID
291600200529     C                     EXSR SRSMSG
291700200529     C                     ENDIF                                                              212937
291800200529      *
291900200529     C                     ELSE
292000200529      ** Account for Payment must be left Blank for Instructions Free
292100200529     C           PPCOD     IFNE '1'
292200200529     C           PPCOD     ANDNE'5'
292300200529     C                     SETON                     2375
292400200529     C                     MOVEL'SEW5217' ZAMSID
292500200529     C                     EXSR SRSMSG
292600200529     C                     END
292700200529     C                     END
292800200529      *
292900200529      ** Set Error Indicator ON this Field before Validation.
293000200529     C           *IN23     IFEQ *OFF
293100200529     C                     SETON                     23
293200200529      *
293300200529      ** Validate Customer Number/Shortname/Nostro
293400200529     C                     MOVE SAFPN     WWCUST 10
293500200529     C                     EXSR SRCUST
293600200529      *
293700200529      ** Reset Error Indicator If field is Valid
293800200529     C           WWCUSS    IFEQ 'C'
293900200529     C           WWCUSS    OREQ 'S'
294000200529     C           WWCUSS    OREQ 'N'
294100200529     C                     SETOF                     23
294200200529     C                     END
294300200529      *
294400200529      ** Customer Number/Shortname
294500200529     C           WWCUSS    IFEQ 'C'
294600200529     C           WWCUSS    OREQ 'S'
294700200529     C                     MOVELBBCUST    WWAFPN
294800200529     C                     END
294900200529     C                     END
295000200529      *
295100200529      ** Nostro
295200200529     C           WWCUSS    IFEQ 'N'
295300200529     C                     MOVELAWCPNC    WWAFPN
295400200529     C                     END
295500200529      *
295600200529     C                     ELSE
295700200529      *
295800200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
295900200529     C                     MOVE *BLANKS   WWAFPN
296000200529     C                     END
296100200529      *
296200200529     C                     ENDSR
296300200529      *
296400200529      *****************************************************************
296500200529      /EJECT
296600200529      *****************************************************************
296700200529      **                                                              *
296800200529      **  SRAFPL    - Validate A/c for Payment A/c Line :53:          *
296900200529      **                                                              *
297000200529      **  Calls     - SRSMSG                                          *
297100200529      **  Called By - SRVAL                                           *
297200200529      **                                                              *
297300200529      *****************************************************************
297400200529      *
297500200529     C           SRAFPL    BEGSR
297600200529      *
297700200529     C           PSNEW     IFNE 'Y'                                                           CSW210
297800200529     C           CSE028    ORNE 'Y'                                                           CSW210
297900200529      ** Validate If not Blank
298000200529     C                     MOVELSAFPL     WWAFPL  1
298100200529     C           SAFPL     IFNE *BLANKS
298200200529     C           WWAFPL    ANDNE'#'
298300200529      *
298400200529     C           WWCLTY    IFEQ '14'
298500200529     C                     SETON                     2475
298600200529     C           SAFPN     IFEQ *BLANKS
298700200529     C                     MOVEL'SEW5216' ZAMSID
298800200529     C                     EXSR SRSMSG
298900200529     C                     END
299000200529      *
299100200529     C                     ELSE
299200200529      ** Account for Payment must be left Blank for Instructions Free
299300200529     C           PPCOD     IFNE '1'
299400200529     C           PPCOD     ANDNE'5'
299500200529     C                     SETON                     2475
299600200529     C           SAFPN     IFEQ *BLANKS
299700200529     C                     MOVEL'SEW5217' ZAMSID
299800200529     C                     EXSR SRSMSG
299900200529     C                     END
300000200529     C                     END
300100200529     C                     END
300200200529      *
300300200529     C                     MOVELSAFPL     WWLI01
300400200529     C           WWLI01    IFNE '/'
300500200529     C                     SETON                     2475
300600200529     C                     MOVEL'SEW5210' ZAMSID
300700200529     C                     EXSR SRSMSG
300800200529     C                     END
300900200529      *
301000200529     C                     MOVELSAFPL     WWLI02
301100200529     C           WWLI02    IFEQ '//'
301200200529     C                     SETON                     2475
301300200529     C                     MOVEL'SEW5211' ZAMSID
301400200529     C                     EXSR SRSMSG
301500200529     C                     END
301600200529      *
301700200529     C                     MOVE SAFPL     WWLI34
301800200529     C           WWLI01    IFEQ '/'
301900200529     C           WWLI34    ANDEQ*BLANKS
302000200529     C                     SETON                     2475
302100200529     C                     MOVEL'SEW5212' ZAMSID
302200200529     C                     EXSR SRSMSG
302300200529     C                     END
302400200529      *
302500200529     C                     END
302600200529      *
302700200529      ** Either SWIFT Field 53 or (57 AND 58) can be Entered
302800200529     C***********PTDTP     IFEQ 'TS'                                      CSW003
302900200529     C           WTDTP     IFEQ 'TS'                                      CSW003
303000200529     C           SAFPN     ANDNE*BLANKS
303100200529     C***********PTDTP     OREQ 'TS'                                      CSW003
303200200529     C           WTDTP     OREQ 'TS'                                      CSW003
303300200529     C           SAFPL     ANDNE*BLANKS
303400200529      *
303500200529     C           SAWIN     IFNE *BLANKS
303600200529     C           SAWIL     ORNE *BLANKS
303700200529     C           SBOFN     ORNE *BLANKS
303800200529     C           SBOF1     ORNE *BLANKS
303900200529     C           SBOF2     ORNE *BLANKS
304000200529     C                     SETON                     2475
304100200529     C                     MOVEL'SEW5215' ZAMSID
304200200529     C                     EXSR SRSMSG
304300200529     C                     END
304400200529     C                     END
304500200529      *                                                                                       CSW210
304600200529     C                     ENDIF                                                              CSW210
304700200529      *                                                                                       CSW210
304800200529      ** Check if value inserted is an IBAN                                                   CSW210
304900200529     C           SAFPL     IFNE *BLANKS                                                       CSW210
305000200529     C           CSW210    ANDEQ'Y'                                                           CSW210
305100200529     C           CFT004    ANDEQ'Y'                                                           CSW210
305200200529      *                                                                                       CSW210
305300200529     C                     MOVELSAFPL     DSIBAN                                              CSW210
305400200529     C           SAFPL     IFNE WWAP2L                                                        CSW210
305500200529     C                     EXSR SRIBAN                                                        CSW210
305600200529     C                     MOVE WVIBAN    WWFAP2                                              CSW210
305700200529     C                     ENDIF                                                              CSW210
305800200529      *                                                                                       CSW210
305900200529      ** Replace field value if validated as an IBAN input                                    CSW210
306000200529     C           WIBRTN    IFNE *BLANKS                                                       CSW210
306100200529     C                     MOVE 'N'       WSAP2L                                              CSW210
306200200529     C                     MOVELWIBRTN    SAFPL                                               CSW210
306300200529     C                     MOVE *BLANKS   WIBRTN                                              CSW210
306400200529     C                     ELSE                                                               CSW210
306500200529      *                                                                                       CSW210
306600200529      ** If not IBAN, throw corresponding warning messages                                    CSW210
306700200529     C           WSAP2L    IFEQ 'Y'                                                           CSW210
306800200529     C           SAFPL     ANDEQWWAP2L                                                        CSW210
306900200529     C                     MOVE 'N'       WSAP2L                                              CSW210
307000200529     C                     ELSE                                                               CSW210
307100200529     C           WIBNWR    IFEQ 'Y'                                                           CSW210
307200200529     C           SAFPL     ANDNEWWAP2L                                                        CSW210
307300200529     C                     MOVELWTIBAN    SAFPL                                               CSW210
307400200529     C                     SETON                     24                                       CSW210
307500200529     C                     MOVE 'Y'       WSAP2L                                              CSW210
307600200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
307700200529     C                     MOVELS210W,1   ZAMSDT                                              CSW210
307800200529     C                     EXSR SREMSG                                                        CSW210
307900200529     C                     ENDIF                                                              CSW210
308000200529     C                     ENDIF                                                              CSW210
308100200529     C                     ENDIF                                                              CSW210
308200200529     C                     MOVELSAFPL     WWAP2L                                              CSW210
308300200529     C                     ELSE                                                               CSW210
308400200529     C                     MOVE 'N'       WWFAP2                                              CSW210
308500200529      *                                                                                       CSW210
308600200529     C                     ENDIF                                                              CSW210
308700200529      *
308800200529     C                     ENDSR
308900200529      *
309000200529      *****************************************************************                       CSW210
309100200529      /EJECT                                                                                  CSW210
309200200529      *****************************************************************                       CSW210
309300200529      **                                                              *                       CSW210
309400200529      **  SRDIDN    - Validate Debtor Identification                  *                       CSW210
309500200529      **                                                              *                       CSW210
309600200529      **  Calls     - SRCUST                                          *                       CSW210
309700200529      **  Called By - SRVAL                                           *                       CSW210
309800200529      **                                                              *                       CSW210
309900200529      *****************************************************************                       CSW210
310000200529      *                                                                                       CSW210
310100200529     C           SRDIDN    BEGSR                                                              CSW210
310200200529      *                                                                                       CSW210
310300200529      ** Validate If not Blank                                                                CSW210
310400200529     C           SDIDN     IFNE *BLANKS                                                       CSW210
310500200529      *                                                                                       CSW210
310600200529      ** Debtor must be left blank when instructions free of payment                          CSW210
310700200529     C           PPCOD     IFNE '1'                                                           CSW210
310800200529     C           PPCOD     ANDNE'5'                                                           CSW210
310900200529     C                     SETON                     1175                                     CSW210
311000200529     C                     MOVEL'ST00112' ZAMSID                                              CSW210
311100200529     C                     EXSR SRSMSG                                                        CSW210
311200200529     C                     END                                                                CSW210
311300200529      *                                                                                       CSW210
311400200529      ** Either Debtor Identification or Debtor Address lines may be                          CSW210
311500200529      *  entered, but not both                                                                CSW210
311600200529     C           SDAD1     IFNE *BLANKS                                                       CSW210
311700200529     C           SDAD2     ORNE *BLANKS                                                       CSW210
311800200529     C           SDAD3     ORNE *BLANKS                                                       CSW210
311900200529     C           SDAD4     ORNE *BLANKS                                                       CSW210
312000200529     C                     SETON                     1175                                     CSW210
312100200529     C                     MOVEL'ST00113' ZAMSID                                              CSW210
312200200529     C                     EXSR SRSMSG                                                        CSW210
312300200529     C                     ENDIF                                                              CSW210
312400200529      *                                                                                       CSW210
312500200529      ** Set Error Indicator ON this Field before Validation.                                 CSW210
312600200529     C           *IN11     IFEQ *OFF                                                          CSW210
312700200529     C                     SETON                     11                                       CSW210
312800200529      *                                                                                       CSW210
312900200529      ** Validate Customer Number/Shortname/Nostro                                            CSW210
313000200529     C                     MOVE SDIDN     WWCUST 10                                           CSW210
313100200529     C                     EXSR SRCUST                                                        CSW210
313200200529      *                                                                                       CSW210
313300200529      ** Reset Error Indicator If field is Valid                                              CSW210
313400200529     C           WWCUSS    IFEQ 'C'                                                           CSW210
313500200529     C           WWCUSS    OREQ 'S'                                                           CSW210
313600200529     C           WWCUSS    OREQ 'N'                                                           CSW210
313700200529     C                     SETOF                     11                                       CSW210
313800200529     C                     END                                                                CSW210
313900200529      *                                                                                       CSW210
314000200529      ** Customer Number/Shortname                                                            CSW210
314100200529     C           WWCUSS    IFEQ 'C'                                                           CSW210
314200200529     C           WWCUSS    OREQ 'S'                                                           CSW210
314300200529     C                     MOVELBBCUST    WWDIDN                                              CSW210
314400200529     C                     END                                                                CSW210
314500200529     C                     END                                                                CSW210
314600200529      *                                                                                       CSW210
314700200529      ** Nostro                                                                               CSW210
314800200529     C           WWCUSS    IFEQ 'N'                                                           CSW210
314900200529     C                     MOVELAWCPNC    WWDIDN                                              CSW210
315000200529     C                     END                                                                CSW210
315100200529      *                                                                                       CSW210
315200200529     C                     MOVELSDIDN     SDIDN1  1                                           CSW210
315300200529     C           SDIDN1    IFEQ '?'                                                           CSW210
315400200529     C                     MOVELWWDIDN    SDIDN                                               CSW210
315500200529     C                     ENDIF                                                              CSW210
315600200529      *                                                                                       CSW210
315700200529     C                     ELSE                                                               CSW210
315800200529      *                                                                                       CSW210
315900200529      ** Else If Screen Field is Blank, ensure workfield is also Blank                        CSW210
316000200529     C                     MOVE *BLANKS   WWDIDN                                              CSW210
316100200529     C                     END                                                                CSW210
316200200529      *                                                                                       CSW210
316300200529     C                     ENDSR                                                              CSW210
316400200529      *                                                                                       CSW210
316500200529      *****************************************************************                       CSW210
316600200529      /EJECT                                                                                  CSW210
316700200529      *****************************************************************                       CSW210
316800200529      **                                                              *                       CSW210
316900200529      **  SRDLIN    - Validate Debtor Account Line                    *                       CSW210
317000200529      **                                                              *                       CSW210
317100200529      **  Calls     - SRSMSG                                          *                       CSW210
317200200529      **  Called By - SRVAL                                           *                       CSW210
317300200529      **                                                              *                       CSW210
317400200529      *****************************************************************                       CSW210
317500200529      *                                                                                       CSW210
317600200529     C           SRDLIN    BEGSR                                                              CSW210
317700200529      *                                                                                       CSW210
317800200529      ** Validate If not Blank                                                                CSW210
317900200529     C           SDLIN     IFNE *BLANKS                                                       CSW210
318000200529      *                                                                                       CSW210
318100200529      ** Debtor must be left blank when instructions free of payment                          CSW210
318200200529     C           PPCOD     IFNE '1'                                                           CSW210
318300200529     C           PPCOD     ANDNE'5'                                                           CSW210
318400200529     C                     SETON                     1275                                     CSW210
318500200529     C                     MOVEL'ST00112' ZAMSID                                              CSW210
318600200529     C                     EXSR SRSMSG                                                        CSW210
318700200529     C                     ENDIF                                                              CSW210
318800200529      *                                                                                       CSW210
318900200529      ** Debtor Identification and Debtor Address lines are blanks                            CSW210
319000200529     C           SDIDN     IFEQ *BLANKS                                                       CSW210
319100200529     C           SDAD1     ANDEQ*BLANKS                                                       CSW210
319200200529     C           SDAD2     ANDEQ*BLANKS                                                       CSW210
319300200529     C           SDAD3     ANDEQ*BLANKS                                                       CSW210
319400200529     C           SDAD4     ANDEQ*BLANKS                                                       CSW210
319500200529     C                     SETON                     1275                                     CSW210
319600200529     C                     MOVEL'ST00082' ZAMSID                                              CSW210
319700200529     C                     EXSR SRSMSG                                                        CSW210
319800200529     C                     ENDIF                                                              CSW210
319900200529      *                                                                                       CSW210
320000200529      ** Check if value inserted is an IBAN                                                   CSW210
320100200529     C           CFT004    IFEQ 'Y'                                                           CSW210
320200200529     C                     MOVELSDLIN     DSIBAN                                              CSW210
320300200529     C           SDLIN     IFNE WWCOMP                                                        CSW210
320400200529     C                     EXSR SRIBAN                                                        CSW210
320500200529     C                     MOVE WVIBAN    WWFDBT                                              CSW210
320600200529     C                     ENDIF                                                              CSW210
320700200529      *                                                                                       CSW210
320800200529      ** Replace field value if validated as an IBAN input                                    CSW210
320900200529     C           WIBRTN    IFNE *BLANKS                                                       CSW210
321000200529     C                     MOVE 'N'       WSDLIN                                              CSW210
321100200529     C                     MOVELWIBRTN    SDLIN                                               CSW210
321200200529     C                     MOVE *BLANKS   WIBRTN                                              CSW210
321300200529     C                     ELSE                                                               CSW210
321400200529     C           WSDLIN    IFEQ 'Y'                                                           CSW210
321500200529     C           SDLIN     ANDEQWWCOMP                                                        CSW210
321600200529     C                     MOVE 'N'       WSDLIN                                              CSW210
321700200529     C                     ELSE                                                               CSW210
321800200529      *                                                                                       CSW210
321900200529      ** If not IBAN, throw corresponding warning messages                                    CSW210
322000200529     C           WIBNWR    IFEQ 'Y'                                                           CSW210
322100200529     C           SDLIN     ANDNEWWCOMP                                                        CSW210
322200200529     C                     MOVELWTIBAN    SDLIN                                               CSW210
322300200529     C                     SETON                     12                                       CSW210
322400200529     C                     MOVE 'Y'       WSDLIN                                              CSW210
322500200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
322600200529     C                     MOVELS210W,2   ZAMSDT                                              CSW210
322700200529     C                     EXSR SREMSG                                                        CSW210
322800200529     C                     ENDIF                                                              CSW210
322900200529     C                     ENDIF                                                              CSW210
323000200529      *                                                                                       CSW210
323100200529     C                     ENDIF                                                              CSW210
323200200529     C                     MOVELSDLIN     WWCOMP                                              CSW210
323300200529     C                     ENDIF                                                              CSW210
323400200529     C                     ELSE                                                               CSW210
323500200529     C                     MOVE 'N'       WWFDBT                                              CSW210
323600200529     C                     ENDIF                                                              CSW210
323700200529      *                                                                                       CSW210
323800200529     C                     ENDSR                                                              CSW210
323900200529      *                                                                                       CSW210
324000200529      *****************************************************************                       CSW210
324100200529      /EJECT                                                                                  CSW210
324200200529      *****************************************************************                       CSW210
324300200529      **                                                              *                       CSW210
324400200529      **  SRDADD    - Validate Debtor Address                         *                       CSW210
324500200529      **                                                              *                       CSW210
324600200529      **  Calls     - SRSMSG                                          *                       CSW210
324700200529      **  Called By - SRVAL                                           *                       CSW210
324800200529      **                                                              *                       CSW210
324900200529      *****************************************************************                       CSW210
325000200529      *                                                                                       CSW210
325100200529     C           SRDADD    BEGSR                                                              CSW210
325200200529      *                                                                                       CSW210
325300200529      ** Populate work fields                                                                 CSW210
325400200529     C                     MOVE *BLANKS   ACTFLG  1                                           CSW210
325500200529     C                     MOVELSDAD1     DSDAD1                                              CSW210
325600200529     C                     MOVELSDAD2     DSDAD2                                              CSW210
325700200529     C                     MOVELSDAD3     DSDAD3                                              CSW210
325800200529     C                     MOVELSDAD4     DSDAD4                                              CSW210
325900200529      *                                                                                       CSW210
326000200529      ** Validate If not Blank                                                                CSW210
326100200529     C           DADDRS    IFNE *BLANKS                                                       CSW210
326200200529      *                                                                                       CSW210
326300200529      ** Debtor Identification and Debtor Address lines are blanks                            CSW210
326400200529     C           PPCOD     IFNE '1'                                                           CSW210
326500200529     C           PPCOD     ANDNE'5'                                                           CSW210
326600200529     C                     SETON                     1475                                     CSW210
326700200529     C                     MOVEL'ST00112' ZAMSID                                              CSW210
326800200529     C                     EXSR SRSMSG                                                        CSW210
326900200529     C                     ENDIF                                                              CSW210
327000200529      *                                                                                       CSW210
327100200529      ** Debtor Identification and Debtor Address lines are blanks                            CSW210
327200200529     C           SDIDN     IFNE *BLANKS                                                       CSW210
327300200529     C                     SETON                     1475                                     CSW210
327400200529     C                     MOVEL'ST00113' ZAMSID                                              CSW210
327500200529     C                     EXSR SRSMSG                                                        CSW210
327600200529     C                     ENDIF                                                              CSW210
327700200529      *                                                                                       CSW210
327800200529     C                     MOVELDADDRS    ADDRSS                                              CSW210
327900200529      *                                                                                       CSW210
328000200529      ** Validate SWIFT Address                                                               CSW210
328100200529     C           ACTFLG    IFEQ *BLANKS                                                       CSW210
328200200529      *                                                                                       CSW210
328300200529     C           ADCH26    IFEQ *BLANKS                                                       CSW210
328400200529     C           ADEXSW    ANDEQ*BLANKS                                                       CSW210
328500200529     C           ADSLSH    ANDNE'/'                                                           CSW210
328600200529      *                                                                                       CSW210
328700200529      ** First 11 characters should be key for CLSWT                                          CSW210
328800200529     C                     MOVELADCHK1    CLSWTK 35                                           CSW210
328900200529      *                                                                                       CSW210
329000200529     C                     EXSR SRSWFT                                                        CSW210
329100200529      *                                                                                       CSW210
329200200529     C           ##CSID    IFEQ 'Y'                                                           CSW210
329300200529      *                                                                                       CSW210
329400200529      ** SWIFT Identifier was not found                                                       CSW210
329500200529     C           *IN91     IFEQ *ON                                                           CSW210
329600200529     C                     SETON                     1475                                     CSW210
329700200529     C                     MOVEL'ST00078' ZAMSID                                              CSW210
329800200529     C                     EXSR SRSMSG                                                        CSW210
329900200529     C                     ELSE                                                               CSW210
330000200529     C                     MOVE 'S'       ACTFLG                                              CSW210
330100200529      *                                                                                       CSW210
330200200529      ** The BIC directory is not loaded and the code is defined in the                       CSW210
330300200529      ** Customer detail file                                                                 CSW210
330400200529     C           *IN92     IFEQ *ON                                                           CSW210
330500200529     C           *IN91     ANDEQ*OFF                                                          CSW210
330600200529      *                                                                                       CSW210
330700200529     C           WWADD     IFNE *BLANK                                                        CSW210
330800200529     C           CLSWTK    ANDEQWDACT                                                         CSW210
330900200529     C                     MOVE 'N'       WWADD                                               CSW210
331000200529     C                     ELSE                                                               CSW210
331100200529     C           CLSWTK    IFNE WDACT                                                         CSW210
331200200529     C                     SETON                     14                                       CSW210
331300200529     C                     MOVE 'Y'       WWADD                                               CSW210
331400200529     C                     MOVEL'ST00079' ZAMSID                                              CSW210
331500200529     C                     EXSR SRSMSG                                                        CSW210
331600200529     C                     ENDIF                                                              CSW210
331700200529     C                     ENDIF                                                              CSW210
331800200529     C                     ENDIF                                                              CSW210
331900200529     C                     ENDIF                                                              CSW210
332000200529     C                     ENDIF                                                              CSW210
332100200529     C                     ENDIF                                                              CSW210
332200200529      *                                                                                       CSW210
332300200529     C                     ENDIF                                                              CSW210
332400200529      *                                                                                       CSW210
332500200529      ** Validate as codeword                                                                 CSW210
332600200529     C           ACTFLG    IFEQ *BLANK                                                        CSW210
332700200529      *                                                                                       CSW210
332800200529     C           ADSLSH    IFEQ '/'                                                           CSW210
332900200529      *                                                                                       CSW210
333000200529     C                     MOVE 'R'       ACTFLG                                              CSW210
333100200529     C                     MOVELSDAD1     PASWCD 35                                           CSW210
333200200529     C                     EXSR SRVCDE                                                        CSW210
333300200529      *                                                                                       CSW210
333400200529     C           WMEMID    IFEQ *BLANKS                                                       CSW210
333500200529      *                                                                                       CSW210
333600200529      ** Line 2 is mandatory                                                                  CSW210
333700200529     C           SDAD2     IFEQ *BLANKS                                                       CSW210
333800200529     C                     SETON                     1575                                     CSW210
333900200529     C                     MOVEL'ST00122' ZAMSID                                              CSW210
334000200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
334100200529     C                     EXSR SRSMSG                                                        CSW210
334200200529     C                     ELSE                                                               CSW210
334300200529     C                     MOVELSDAD2     I#FLD                                               CSW210
334400200529     C                     EXSR SRSWST                                                        CSW210
334500200529     C           INSET     IFEQ 'Y'                                                           CSW210
334600200529     C                     SETON                     1575                                     CSW210
334700200529     C                     MOVEL'ST00081' ZAMSID                                              CSW210
334800200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
334900200529     C                     EXSR SRSMSG                                                        CSW210
335000200529     C                     ENDIF                                                              CSW210
335100200529     C                     ENDIF                                                              CSW210
335200200529      *                                                                                     AR640699
335300200529      ** CODEWORD is valid and second line is more than 34 characters                       AR640699
335400200529      *                                                                                     AR640699
335500200529     C           DSDA34    IFNE *BLANKS                                                     AR640699
335600200529     C                     SETON                     1575                                   AR640699
335700200529     C                     MOVEL'ST00124' ZAMSID                                            AR640699
335800200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                            AR640699
335900200529     C                     EXSR SRSMSG                                                      AR640699
336000200529     C                     ENDIF                                                            AR640699
336100200529      *                                                                                       CSW210
336200200529      ** Linse 3 and 4 should be blanks                                                       CSW210
336300200529     C           SDAD3     IFNE *BLANKS                                                       CSW210
336400200529     C           SDAD4     ORNE *BLANKS                                                       CSW210
336500200529     C                     SETON                     161775                                   CSW210
336600200529     C                     MOVEL'ST00123' ZAMSID                                              CSW210
336700200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
336800200529     C                     EXSR SRSMSG                                                        CSW210
336900200529     C                     ENDIF                                                              CSW210
337000200529      *                                                                                       CSW210
337100200529     C                     ELSE                                                               CSW210
337200200529      *                                                                                       CSW210
337300200529      ** Error on SWIFT Code                                                                  CSW210
337400200529     C                     SETON                     1475                                     CSW210
337500200529     C                     MOVELWMEMID    ZAMSID                                              CSW210
337600200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
337700200529     C                     EXSR SRSMSG                                                        CSW210
337800200529     C                     ENDIF                                                              CSW210
337900200529      *                                                                                       CSW210
338000200529     C                     ENDIF                                                              CSW210
338100200529      *                                                                                       CSW210
338200200529     C                     ENDIF                                                              CSW210
338300200529      *                                                                                       CSW210
338400200529      ** Validate as an Address                                                               CSW210
338500200529     C           ACTFLG    IFEQ *BLANKS                                                       CSW210
338600200529     C                     EXSR SRACHK                                                        CSW210
338700200529      *                                                                                       CSW210
338800200529      ** Embedded blank lines exist in the Debtor address fields                              CSW210
338900200529     C           INVAL1    IFEQ 'Y'                                                           CSW210
339000200529     C                     MOVEA'1111'    *IN,14                                              CSW210
339100200529     C                     SETON                       75                                     CSW210
339200200529     C                     MOVEL'ST00080' ZAMSID                                              CSW210
339300200529     C                     EXSR SRSMSG                                                        CSW210
339400200529     C                     ENDIF                                                              CSW210
339500200529      *                                                                                       CSW210
339600200529      ** Non-valid SWIFT character is found                                                   CSW210
339700200529     C           INVAL2    IFEQ 'Y'                                                           CSW210
339800200529     C           AD#1      IFEQ 'Y'                                                           CSW210
339900200529     C                     SETON                     14                                       CSW210
340000200529     C                     ENDIF                                                              CSW210
340100200529     C           AD#2      IFEQ 'Y'                                                           CSW210
340200200529     C                     SETON                     15                                       CSW210
340300200529     C                     ENDIF                                                              CSW210
340400200529     C           AD#3      IFEQ 'Y'                                                           CSW210
340500200529     C                     SETON                     16                                       CSW210
340600200529     C                     ENDIF                                                              CSW210
340700200529     C           AD#4      IFEQ 'Y'                                                           CSW210
340800200529     C                     SETON                     17                                       CSW210
340900200529     C                     ENDIF                                                              CSW210
341000200529     C                     SETON                       75                                     CSW210
341100200529     C                     MOVEL'ST00081' ZAMSID                                              CSW210
341200200529     C                     EXSR SRSMSG                                                        CSW210
341300200529     C                     ENDIF                                                              CSW210
341400200529     C                     ENDIF                                                              CSW210
341500200529      *                                                                                       CSW210
341600200529      ** Consider as Address if valid                                                         CSW210
341700200529     C           *IN14     IFEQ *OFF                                                          CSW210
341800200529     C           *IN15     ANDEQ*OFF                                                          CSW210
341900200529     C           *IN16     ANDEQ*OFF                                                          CSW210
342000200529     C           *IN17     ANDEQ*OFF                                                          CSW210
342100200529     C                     MOVE 'A'       ACTFLG                                              CSW210
342200200529     C                     ENDIF                                                              CSW210
342300200529     C                     MOVELCLSWTK    WDACT                                               CSW210
342400200529     C                     ENDIF                                                              CSW210
342500200529      *                                                                                       CSW210
342600200529     C                     ENDSR                                                              CSW210
342700200529      *                                                                                       CSW210
342800200529      *****************************************************************                       CSW210
342900200529      /EJECT                                                                                  CSW210
343000200529      *****************************************************************                       CSW210
343100200529      **                                                              *                       CSW210
343200200529      **  SRSWFT    - SWIFT Address validation                        *                       CSW210
343300200529      **                                                              *                       CSW210
343400200529      **  Calls     - ME1400                                          *                       CSW210
343500200529      **  Called By - SRDADD                                          *                       CSW210
343600200529      **                                                              *                       CSW210
343700200529      *****************************************************************                       CSW210
343800200529      *                                                                                       CSW210
343900200529     C           SRSWFT    BEGSR                                                              CSW210
344000200529     C                     SETOF                     909192                                   CSW210
344100200529      *                                                                                       CSW210
344200200529      ** Test positions 1-8 for valid SWIFT Characters                                        CSW210
344300200529      ** Check how many characters are alphanumeric                                           CSW210
344400200529     C                     MOVEL*BLANKS   FLD    35                                           CSW210
344500200529     C                     MOVELCLSWTK    FLD                                                 CSW210
344600200529     C           ALPHAN    CHECKFLD       X#      30     90                                   CSW210
344700200529      *                                                                                       CSW210
344800200529      ** If the first 8 or 11 are ok proceed                                                  CSW210
344900200529     C           *IN90     IFEQ *ON                                                           CSW210
345000200529     C           X#        ANDEQ9                                                             CSW210
345100200529     C           *IN90     OREQ *ON                                                           CSW210
345200200529     C           X#        ANDEQ12                                                            CSW210
345300200529     C           ' '       CHECKFLD:X#    ##001   10     90                                   CSW210
345400200529      *                                                                                       CSW210
345500200529      ** Check for blanks if before 8 or 11 then assume address                               CSW210
345600200529     C           *IN90     IFEQ *ON                                                           CSW210
345700200529     C           X#        ANDEQ11                                                            CSW210
345800200529     C                     SETON                     91                                       CSW210
345900200529     C                     MOVE 'Y'       ##CSID  1                                           CSW210
346000200529     C                     GOTO ENDSWT                                                        CSW210
346100200529     C                     ENDIF                                                              CSW210
346200200529     C                     ENDIF                                                              CSW210
346300200529      *                                                                                       CSW210
346400200529      ** Invalid format - Not a S.W.I.F.T.                                                    CSW210
346500200529     C           *IN90     IFEQ *ON                                                           CSW210
346600200529     C                     MOVE 'N'       ##CSID                                              CSW210
346700200529     C                     GOTO ENDSWT                                                        CSW210
346800200529     C                     ENDIF                                                              CSW210
346900200529      *                                                                                       CSW210
347000200529      ** Call Access object to validate identifier                                            CSW210
347100200529     C                     MOVELFLD       W9BICC                                              CSW210
347200200529     C           3         SUBSTFLD:9     W9BICB                                              CSW210
347300200529      *                                                                                       CSW210
347400200529     C                     CALL 'ME1400'                                                      CSW210
347500200529     C                     PARM *BLANKS   W9RTN   7                                           CSW210
347600200529     C                     PARM           W9BICC  8                                           CSW210
347700200529     C                     PARM           W9BICB  3                                           CSW210
347800200529     C                     PARM           SDCUST                                              CSW210
347900200529     C                     PARM           SDCNST                                              CSW210
348000200529     C                     PARM           MEBICD                                              CSW210
348100200529     C                     PARM *BLANKS   W9CUST  1                                           CSW210
348200200529     C                     PARM *BLANKS   W9CNST  1                                           CSW210
348300200529     C                     PARM *BLANKS   W9BICD  1                                           CSW210
348400200529      *                                                                                       CSW210
348500200529     C                     SELEC                                                              CSW210
348600200529      *                                                                                       CSW210
348700200529      ** Record not found on directory but found on others                                    CSW210
348800200529      ** BIC directory has data so error                                                      CSW210
348900200529     C           W9RTN     WHEQ 'MIN0244'                                                     CSW210
349000200529     C           W9RTN     OREQ 'MIN0245'                                                     CSW210
349100200529     C           W9RTN     OREQ 'MIN0246'                                                     CSW210
349200200529     C                     SETON                     91                                       CSW210
349300200529     C                     MOVE 'Y'       ##CSID                                              CSW210
349400200529      *                                                                                       CSW210
349500200529      ** Record not found - S.W.I.F.T does not exist                                          CSW210
349600200529     C           W9RTN     WHEQ 'Y2U0005'                                                     CSW210
349700200529     C                     SETON                     92                                       CSW210
349800200529     C                     MOVE 'Y'       ##CSID                                              CSW210
349900200529      *                                                                                       CSW210
350000200529      ** Record found - BIC exists                                                            CSW210
350100200529     C           W9RTN     WHEQ *BLANKS                                                       CSW210
350200200529     C                     MOVE 'Y'       ##CSID                                              CSW210
350300200529     C                     ENDSL                                                              CSW210
350400200529      *                                                                                       CSW210
350500200529     C           ENDSWT    TAG                                                                CSW210
350600200529     C                     ENDSR                                                              CSW210
350700200529      *                                                                                       CSW210
350800200529      *****************************************************************                       CSW210
350900200529      /EJECT                                                                                  CSW210
351000200529      *****************************************************************                       CSW210
351100200529      **                                                              *                       CSW210
351200200529      **  SRACHK    - Validate Address Fields                         *                       CSW210
351300200529      **                                                              *                       CSW210
351400200529      **  Calls     - SRSWST                                          *                       CSW210
351500200529      **  Called By - SRDADD                                          *                       CSW210
351600200529      **                                                              *                       CSW210
351700200529      *****************************************************************                       CSW210
351800200529      *                                                                                       CSW210
351900200529     C           SRACHK    BEGSR                                                              CSW210
352000200529      *                                                                                       CSW210
352100200529      ** Set off indicators                                                                   CSW210
352200200529      *                                                                                       CSW210
352300200529     C                     SETOF                     1718                                     CSW210
352400200529      *                                                                                       CSW210
352500200529      ** Define error code texts                                                              CSW210
352600200529      *                                                                                       CSW210
352700200529     C                     MOVEL*BLANKS   AD#1                                                CSW210
352800200529     C                     MOVEL*BLANKS   AD#2                                                CSW210
352900200529     C                     MOVEL*BLANKS   AD#3                                                CSW210
353000200529     C                     MOVEL*BLANKS   AD#4                                                CSW210
353100200529     C                     MOVEL*BLANKS   INVAL1                                              CSW210
353200200529     C                     MOVEL*BLANKS   INVAL2                                              CSW210
353300200529      *                                                                                       CSW210
353400200529      ** There should be no embedded spaces                                                   CSW210
353500200529      *                                                                                       CSW210
353600200529     C           ADCHK1    IFEQ *BLANK                                                        CSW210
353700200529     C           ADCHK2    ANDNE*BLANK                                                        CSW210
353800200529      *                                                                                       CSW210
353900200529     C           ADCHK1    OREQ *BLANK                                                        CSW210
354000200529     C           ADCHK3    ANDNE*BLANK                                                        CSW210
354100200529      *                                                                                       CSW210
354200200529     C           ADCHK1    OREQ *BLANK                                                        CSW210
354300200529     C           ADCHK4    ANDNE*BLANK                                                        CSW210
354400200529      *                                                                                       CSW210
354500200529     C           ADCHK2    OREQ *BLANK                                                        CSW210
354600200529     C           ADCHK3    ANDNE*BLANK                                                        CSW210
354700200529      *                                                                                       CSW210
354800200529     C           ADCHK2    OREQ *BLANK                                                        CSW210
354900200529     C           ADCHK4    ANDNE*BLANK                                                        CSW210
355000200529      *                                                                                       CSW210
355100200529     C           ADCHK3    OREQ *BLANK                                                        CSW210
355200200529     C           ADCHK4    ANDNE*BLANK                                                        CSW210
355300200529      *                                                                                       CSW210
355400200529     C                     MOVE 'Y'       INVAL1  1                                           CSW210
355500200529      *                                                                                       CSW210
355600200529     C                     END                                                                CSW210
355700200529      *                                                                                       CSW210
355800200529      ** Check for non-valid SWIFT characters                                                 CSW210
355900200529      *                                                                                       CSW210
356000200529     C           ADCHK1    IFNE *BLANKS                                                       CSW210
356100200529     C                     MOVEL*BLANKS   I#FLD  35                                           CSW210
356200200529     C                     MOVELADCHK1    I#FLD                                               CSW210
356300200529     C                     EXSR SRSWST                                                        CSW210
356400200529      *                                                                                       CSW210
356500200529     C           INSET     IFEQ 'Y'                                                           CSW210
356600200529     C                     MOVEL'Y'       AD#1    1                                           CSW210
356700200529     C                     MOVE 'Y'       INVAL2  1                                           CSW210
356800200529     C                     END                                                                CSW210
356900200529      *                                                                                       CSW210
357000200529     C                     END                                                                CSW210
357100200529      *                                                                                       CSW210
357200200529     C           ADCHK2    IFNE *BLANKS                                                       CSW210
357300200529     C                     MOVEL*BLANKS   I#FLD                                               CSW210
357400200529     C                     MOVELADCHK2    I#FLD                                               CSW210
357500200529     C                     EXSR SRSWST                                                        CSW210
357600200529      *                                                                                       CSW210
357700200529     C           INSET     IFEQ 'Y'                                                           CSW210
357800200529     C                     MOVEL'Y'       AD#2    1                                           CSW210
357900200529     C                     MOVE 'Y'       INVAL2  1                                           CSW210
358000200529     C                     END                                                                CSW210
358100200529      *                                                                                       CSW210
358200200529     C                     END                                                                CSW210
358300200529      *                                                                                       CSW210
358400200529     C           ADCHK3    IFNE *BLANKS                                                       CSW210
358500200529     C                     MOVEL*BLANKS   I#FLD                                               CSW210
358600200529     C                     MOVELADCHK3    I#FLD                                               CSW210
358700200529     C                     EXSR SRSWST                                                        CSW210
358800200529      *                                                                                       CSW210
358900200529     C           INSET     IFEQ 'Y'                                                           CSW210
359000200529     C                     MOVEL'Y'       AD#3    1                                           CSW210
359100200529     C                     MOVE 'Y'       INVAL2  1                                           CSW210
359200200529     C                     END                                                                CSW210
359300200529     C                     END                                                                CSW210
359400200529      *                                                                                       CSW210
359500200529     C           ADCHK4    IFNE *BLANKS                                                       CSW210
359600200529     C                     MOVEL*BLANKS   I#FLD                                               CSW210
359700200529     C                     MOVELADCHK4    I#FLD                                               CSW210
359800200529     C                     EXSR SRSWST                                                        CSW210
359900200529      *                                                                                       CSW210
360000200529     C           INSET     IFEQ 'Y'                                                           CSW210
360100200529     C                     MOVEL'Y'       AD#4    1                                           CSW210
360200200529     C                     MOVE 'Y'       INVAL2  1                                           CSW210
360300200529     C                     END                                                                CSW210
360400200529      *                                                                                       CSW210
360500200529     C                     END                                                                CSW210
360600200529      *                                                                                       CSW210
360700200529     C           EXADCK    TAG                                                                CSW210
360800200529     *                                                                                       CSW210
360900200529     C                     ENDSR                                                              CSW210
361000200529      *                                                                                       CSW210
361100200529      *****************************************************************                       CSW210
361200200529      /EJECT                                                                                  CSW210
361300200529      *****************************************************************                       CSW210
361400200529      **                                                              *                       CSW210
361500200529      **  SRSWST    - Check for valid Swift character used            *                       CSW210
361600200529      **                                                              *                       CSW210
361700200529      **  Calls     -                                                 *                       CSW210
361800200529      **  Called By - SRACHK                                          *                       CSW210
361900200529      **                                                              *                       CSW210
362000200529      *****************************************************************                       CSW210
362100200529      *                                                                                       CSW210
362200200529     C           SRSWST    BEGSR                                                              CSW210
362300200529      *                                                                                       CSW210
362400200529     C                     MOVEL*BLANKS   INSET   1                                           CSW210
362500200529      *                                                                                       CSW210
362600200529     C           ISO       CHECKI#FLD     X#      30     90                                   CSW210
362700200529      *                                                                                       CSW210
362800200529      ** If invalid then get character and format number                                      CSW210
362900200529      *                                                                                       CSW210
363000200529     C           *IN90     IFEQ *ON                                                           CSW210
363100200529     C           1         SUBSTI#FLD:X#  ##004   1                                           CSW210
363200200529     C                     MOVEL'Y'       INSET                                               CSW210
363300200529     C                     MOVE X#        ##005   2                                           CSW210
363400200529     C                     END                                                                CSW210
363500200529      *                                                                                       CSW210
363600200529     C           EXSWST    TAG                                                                CSW210
363700200529     *                                                                                       CSW210
363800200529     C                     ENDSR                                                              CSW210
363900200529      *                                                                                       CSW210
364000200529      *****************************************************************                       CSW210
364100200529      /EJECT                                                                                  CSW210
364200200529      *****************************************************************                       CSW210
364300200529      **                                                              *                       CSW210
364400200529      **  SRIBAN    - IBAN Validation                                 *                       CSW210
364500200529      **                                                              *                       CSW210
364600200529      **  Calls     - None                                            *                       CSW210
364700200529      **  Called By -                                                 *                       CSW210
364800200529      **                                                              *                       CSW210
364900200529      *****************************************************************                       CSW210
365000200529      *                                                                                       CSW210
365100200529     C           SRIBAN    BEGSR                                                              CSW210
365200200529      *                                                                                       CSW210
365300200529      ** Temporary work variable for IBAN                                                     CSW210
365400200529     C                     MOVEL*BLANKS   WIBRTN 35                                           CSW210
365500200529     C                     MOVEL*BLANKS   WTIBAN 34                                           CSW210
365600200529     C                     MOVEL*BLANKS   WTIBA1 47                                           CSW210
365700200529     C                     MOVEL'N'       WVIBAN  1                                           CSW210
365800200529     C                     MOVE 'N'       WIBNWR  1                                           CSW210
365900200529      *                                                                                       CSW210
366000200529     C           DSISLH    IFEQ '/'                                                           CSW210
366100200529     C                     MOVELDSIBN2    WTIBA1                                              CSW210
366200200529     C                     ELSE                                                               CSW210
366300200529     C                     MOVELDSIBAN    WTIBA1                                              CSW210
366400200529     C                     ENDIF                                                              CSW210
366500200529      *                                                                                       CSW210
366600200529     C                     CALL 'AOIBANR3'                                                    CSW210
366700200529     C                     PARM *BLANKS   @RTCD                                               CSW210
366800200529     C                     PARM           WTIBA1                                              CSW210
366900200529     C                     PARM           WIBLNK 47                                           CSW210
367000200529     C                     PARM           WOBLNK 34                                           CSW210
367100200529      *                                                                                       CSW210
367200200529     C           2         SUBSTWOBLNK:1  WOBCH   2                                           CSW210
367300200529     C           2         SUBSTWOBLNK:3  WOBNB   2                                           CSW210
367400200529      *                                                                                       CSW210
367500200529     C           ALPHA     CHECKWOBCH                    81                                   CSW210
367600200529     C           NMBRS     CHECKWOBNB                    82                                   CSW210
367700200529      *                                                                                       CSW210
367800200529      ** IBAN starts with 'AANN'                                                              CSW210
367900200529     C           *IN81     IFEQ *OFF                                                          CSW210
368000200529     C           *IN82     ANDEQ*OFF                                                          CSW210
368100200529     C                     MOVELWOBLNK    WTIBAN                                              CSW210
368200200529      *                                                                                       CSW210
368300200529     C                     CALL 'AOIBANR5'             82                                     CSW210
368400200529     C                     PARM *BLANKS   @RTCD                                               CSW210
368500200529     C                     PARM           WTIBAN                                              CSW210
368600200529      *                                                                                       CSW210
368700200529     C           @RTCD     IFEQ *BLANKS                                                       CSW210
368800200529     C           *IN82     ANDEQ*OFF                                                          CSW210
368900200529     C                     MOVE 'Y'       WVIBAN                                              CSW210
369000200529     C                     MOVELWTIBAN    WIBRTN                                              CSW210
369100200529     C                     ELSE                                                               CSW210
369200200529     C                     MOVE 'N'       WVIBAN                                              CSW210
369300200529     C                     SELEC                                                              CSW210
369400200529     C           @RTCD     WHEQ '      1'                                                     CSW210
369500200529     C                     MOVEL'ST00102' ZAMSID                                              CSW210
369600200529     C           @RTCD     WHEQ '      2'                                                     CSW210
369700200529     C                     MOVEL'ST00103' ZAMSID                                              CSW210
369800200529     C           @RTCD     WHEQ '      3'                                                     CSW210
369900200529     C                     MOVEL'ST00104' ZAMSID                                              CSW210
370000200529     C           @RTCD     WHEQ '      4'                                                     CSW210
370100200529     C                     MOVEL'ST00105' ZAMSID                                              CSW210
370200200529     C           @RTCD     WHEQ '      5'                                                     CSW210
370300200529     C                     MOVEL'ST00106' ZAMSID                                              CSW210
370400200529     C                     OTHER                                                              CSW210
370500200529     C                     MOVEL'ST00107' ZAMSID                                              CSW210
370600200529     C                     ENDSL                                                              CSW210
370700200529     C                     MOVE 'Y'       WIBNWR                                              CSW210
370800200529     C********** DSISLH    IFEQ '/'                                                  CSW210 AR642262
370900200529     C********** '/'       CAT  WTIBAN    WTIBAN                                     CSW210 AR642262
371000200529     C**********           ENDIF                                                     CSW210 AR642262
371100200529     C                     MOVELDSIBAN    WTIBAN                                            AR642262
371200200529     C                     ENDIF                                                              CSW210
371300200529      *                                                                                       CSW210
371400200529     C                     ELSE                                                               CSW210
371500200529     C                     MOVE 'N'       WVIBAN                                              CSW210
371600200529     C                     ENDIF                                                              CSW210
371700200529      *                                                                                       CSW210
371800200529     C                     ENDSR                                                              CSW210
371900200529      *****************************************************************                       CSW210
372000200529      /EJECT                                                                                  CSW210
372100200529      *****************************************************************                       CSW210
372200200529      *                                                               *                       CSW210
372300200529      * SRVCDE  - Checks the syntax of code word                      *                       CSW210
372400200529      *                                                               *                       CSW210
372500200529      *****************************************************************                       CSW210
372600200529      *                                                                                       CSW210
372700200529     C           SRVCDE    BEGSR                                                              CSW210
372800200529      *                                                                                       CSW210
372900200529     C                     MOVE *BLANKS   WMEMID  7                                           CSW210
373000200529      *                                                                                       CSW210
373100200529      ** check for presence and position of terminating '/'; W@ is                            CSW210
373200200529      ** position of second '/'                                                               CSW210
373300200529     C           '/'       SCAN PASWCD:2  W@      50     82                                   CSW210
373400200529      *                                                                                       CSW210
373500200529      ** If second '/' not found - error: codeword must end '/'                               CSW210
373600200529     C           *IN82     IFEQ '0'                                                           CSW210
373700200529     C                     MOVEL'ST00115' WMEMID                                              CSW210
373800200529     C                     GOTO EXVLC                                                         CSW210
373900200529     C                     ENDIF                                                              CSW210
374000200529      *                                                                                       CSW210
374100200529      ** If '/' is in posn. 2 - error: '//' invalid for codeword                              CSW210
374200200529     C           W@        IFEQ 2                                                             CSW210
374300200529     C                     MOVEL'ST00116' WMEMID                                              CSW210
374400200529     C                     GOTO EXVLC                                                         CSW210
374500200529     C                     ENDIF                                                              CSW210
374600200529      *                                                                                       CSW210
374700200529      ** If '/' is in posn. 11 or greater - error: codeword should be                         CSW210
374800200529      ** 8 characters or fewer.                                                               CSW210
374900200529     C           W@        IFGT 10                                                            CSW210
375000200529      *                                                                                       CSW210
375100200529     C           CSW201    IFEQ 'Y'                                                           CSW210
375200200529     C                     MOVEL'ST00120' WMEMID                                              CSW210
375300200529     C                     GOTO EXVLC                                                         CSW210
375400200529     C                     ELSE                                                               CSW210
375500200529     C                     MOVEL'ST00117' WMEMID                                              CSW210
375600200529     C                     GOTO EXVLC                                                         CSW210
375700200529     C                     ENDIF                                                              CSW210
375800200529      *                                                                                       CSW210
375900200529     C                     ENDIF                                                              CSW210
376000200529      *                                                                                       CSW210
376100200529      ** If any characters after second '/' - error: should be blank                          CSW210
376200200529     C           35        SUB  W@        W@L     50                                          CSW210
376300200529     C           W@        ADD  1         W@P     50                                          CSW210
376400200529     C           W@L       SUBSTPASWCD:W@PW@SBBL 32 P                                         CSW210
376500200529     C           W@SBBL    IFNE *BLANKS                                                       CSW210
376600200529     C                     MOVEL'ST00118' WMEMID                                              CSW210
376700200529     C                     GOTO EXVLC                                                         CSW210
376800200529     C                     ENDIF                                                              CSW210
376900200529      *                                                                                       CSW210
377000200529      ** If codeword contains non-upper case or non-numeric characters                        CSW210
377100200529      *                                                                                       CSW210
377200200529     C           CSW201    IFEQ 'Y'                                                           CSW210
377300200529      *                                                                                       CSW210
377400200529     C           ALPHAN    CHECKPASWCD:2  W@L                                                 CSW210
377500200529     C           W@L       IFLT W@                                                            CSW210
377600200529     C                     MOVEL'ST00121' WMEMID                                              CSW210
377700200529     C                     GOTO EXVLC                                                         CSW210
377800200529     C                     ENDIF                                                              CSW210
377900200529      *                                                                                       CSW210
378000200529     C                     ELSE                                                               CSW210
378100200529      *                                                                                       CSW210
378200200529      ** If codeword contains non-upper case alpha characters - error:                        CSW210
378300200529      ** codeword should be SWIFT 8a.                                                         CSW210
378400200529     C           ALPHA     CHECKPASWCD:2  W@L                                                 CSW210
378500200529     C           W@L       IFLT W@                                                            CSW210
378600200529     C                     MOVEL'ST00119' WMEMID                                              CSW210
378700200529     C                     GOTO EXVLC                                                         CSW210
378800200529     C                     ENDIF                                                              CSW210
378900200529      *                                                                                       CSW210
379000200529     C                     ENDIF                                                              CSW210
379100200529      *                                                                                       CSW210
379200200529     C           EXVLC     ENDSR                                                              CSW210
379300200529      *****************************************************************
379400200529      /EJECT
379500200529      *****************************************************************
379600200529      **                                                              *
379700200529      **  SRAWIA    - Validate A/c with Institution TAG :57:          *
379800200529      **                                                              *
379900200529      **  Calls     - SRSMSG                                          *
380000200529      **  Called By - SRVAL                                           *
380100200529      **                                                              *
380200200529      *****************************************************************
380300200529      *
380400200529     C           SRAWIA    BEGSR
380500200529      *
380600200529      ** this Field can only be Entered for Clearance Type 1 to 4
380700200529     C           WWCLTY    IFEQ '14'
380800200529      *
380900200529     C           SAWIA     IFNE 'A'
381000200529     C           SAWIA     ANDNE'D'
381100200529     C           SAWIA     ANDNE*BLANK
381200200529     C                     SETON                     2575
381300200529     C                     MOVEL'SEW5220' ZAMSID
381400200529     C                     EXSR SRSMSG
381500200529     C                     END
381600200529      *
381700200529      ** The A/c Lines may not be left Blank when Entering the TAG Field
381800200529     C           SAWIA     IFNE *BLANK
381900200529     C           SAWIL     ANDEQ*BLANK
382000200529     C                     SETON                     2775
382100200529     C                     MOVEL'SEW5227' ZAMSID
382200200529     C                     EXSR SRSMSG
382300200529     C                     END
382400200529      *
382500200529     C                     ELSE
382600200529      ** This Field must be left Blank If Clearance Type not 1 to 4
382700200529     C           SAWIA     IFNE *BLANK
382800200529     C                     SETON                     2575
382900200529     C                     MOVEL'SEW5221' ZAMSID
383000200529     C                     EXSR SRSMSG
383100200529     C                     END
383200200529     C                     END
383300200529      *
383400200529     C                     ENDSR
383500200529      *
383600200529      *****************************************************************
383700200529      /EJECT
383800200529      *****************************************************************
383900200529      **                                                              *
384000200529      **  SRAWIN    - Validate A/c with Institution :57:              *
384100200529      **                                                              *
384200200529      **  Calls     - SRCUST, SRSMSG                                  *
384300200529      **  Called By - SRVAL                                           *
384400200529      **                                                              *
384500200529      *****************************************************************
384600200529      *
384700200529     C           SRAWIN    BEGSR
384800200529      *
384900200529     C                     MOVEL*BLANKS   WAWIN                           CSW098
385000200529     C*                                                                   CSW098
385100200529      ** Validate If not Blank
385200200529     C           SAWIN     IFNE *BLANKS
385300200529      *
385400200529      ** TAG Field must be left Blank
385500200529     C           SAWIA     IFNE *BLANKS
385600200529     C                     SETON                     2675
385700200529     C                     MOVEL'SEW5228' ZAMSID
385800200529     C                     EXSR SRSMSG
385900200529     C                     ELSE
386000200529      *
386100200529      ** Set Error Indicator ON this Field before Validation
386200200529     C                     SETON                     26
386300200529      *
386400200529      ** Validate Customer Number/Shortname/Nostro
386500200529     C                     MOVE SAWIN     WWCUST
386600200529     C                     EXSR SRCUST
386700200529     C                     MOVELBBCUST    SAWIN                                             AR589193
386800200529      *
386900200529      ** Reset Error Indicator If field is Valid
387000200529     C           WWCUSS    IFEQ 'C'
387100200529     C           WWCUSS    OREQ 'S'
387200200529     C           WWCUSS    OREQ 'N'
387300200529     C                     SETOF                     26
387400200529     C                     END
387500200529      *
387600200529      ** Customer Number/Shortname
387700200529     C           WWCUSS    IFEQ 'C'
387800200529     C           WWCUSS    OREQ 'S'
387900200529      *
388000200529      ** A/c must be a Bank
388100200529     C           WWBNBI    IFNE 'Y'
388200200529     C                     SETON                     2675
388300200529     C                     MOVEL'SEW5225' ZAMSID
388400200529     C                     EXSR SRSMSG
388500200529     C                     ELSE
388600200529     C                     MOVELBBCUST    WWAWIN
388700200529     C                     END
388800200529     C                     END
388900200529      *
389000200529      ** Nostro
389100200529     C           WWCUSS    IFEQ 'N'
389200200529     C                     MOVELAWCPNC    WWAWIN
389300200529     C                     END
389400200529      *                                                                   CSW098
389500200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
389600200529     C                     MOVELWWAWIN    WAWIN                           CSW098
389700200529     C                     ENDIF                                          CSW098
389800200529      *
389900200529      ** Either SBOFN or SBOF1 must not be left Blank
390000200529      ** (SWIFT Field 58 must be Entered If 57 is Entered)
390100200529     C           SBOFN     IFEQ *BLANKS
390200200529     C           SBOF1     ANDEQ*BLANKS
390300200529     C                     MOVE *BLANKS   WWAWIN
390400200529     C                     SETON                     293075
390500200529     C                     MOVEL'SEW5226' ZAMSID
390600200529     C                     EXSR SRSMSG
390700200529     C                     END
390800200529     C                     END
390900200529      *
391000200529     C                     ELSE
391100200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
391200200529     C                     MOVE *BLANKS   WWAWIN
391300200529     C                     END
391400200529      *
391500200529     C                     ENDSR
391600200529      *
391700200529      *****************************************************************
391800200529      /EJECT
391900200529      *****************************************************************
392000200529      **                                                              *
392100200529      **  SRAWIL    - Validate A/c with Institution A/c Line :57:     *
392200200529      **                                                              *
392300200529      ****Calls*****-*SRSMSG,*SRLI35                                  *   CSW098
392400200529      **  Calls     - SRSMSG, SRLI35, SRME99                          *   CSW098
392500200529      **  Called By - SRVAL                                           *
392600200529      **                                                              *
392700200529      *****************************************************************
392800200529      *
392900200529     C           SRAWIL    BEGSR
393000200529      *
393100200529     C           PSNEW     IFNE 'Y'                                                           CSW210
393200200529     C           CSE028    ORNE 'Y'                                                           CSW210
393300200529      ** Validate If not Blank
393400200529     C                     MOVELSAWIL     WWAWIL  1
393500200529     C           SAWIL     IFNE *BLANKS
393600200529     C           WWAWIL    ANDNE'#'
393700200529      *
393800200529      ** Override by F18
393900200529     C           PSENT     IFEQ 'CEDEL'
394000200529     C           *INKS     ANDEQ*ON
394100200529     C           OVER2     ANDEQ'1'
394200200529     C                     MOVE *OFF      *INKS
394300200529     C                     MOVE 'Y'       OVER2
394400200529     C                     END
394500200529      *
394600200529      ** If not Overridden
394700200529     C           OVER2     IFNE 'Y'
394800200529      *
394900200529     C           SAWIN     IFEQ *BLANKS
395000200529     C           SAWIA     ANDEQ*BLANKS
395100200529     C                     SETON                     2675
395200200529     C                     MOVE '1'       OVER2
395300200529     C                     MOVEL'SEW5230' ZAMSID
395400200529     C                     EXSR SRSMSG
395500200529      *
395600200529     C                     ELSE
395700200529     C                     MOVELSAWIL     WWLI01
395800200529     C                     MOVELSAWIL     WWLI02
395900200529     C                     MOVELSAWIL     WWLI04  4
396000200529     C                     MOVELSAWIL     WWLI05  5
396100200529     C                     MOVELSAWIL     WWLI35
396200200529     C                     SETON                     27
396300200529     C                     MOVE '1'       OVER2
396400200529      *                                                                   CSW098
396500200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
396600200529     C                     EXSR SRLI35
396700200529     C                     ELSE                                           CSW098
396800200529      *                                                                   CSW098
396900200529      ** Set up parameters for call to ME9940                             CSW098
397000200529     C                     MOVE *BLANKS   W0RTN                           CSW098
397100200529     C                     CLEARI#PARM                                    CSW098
397200200529     C                     MOVEL'AWBK '   I#VFLD                          CSW098
397300200529     C                     MOVEL'PAY'     I#PR                            CSW098
397400200529      *                                                                   CSW098
397500200529     C           WWCUSS    IFEQ 'N'                                       CSW098
397600200529     C                     MOVEL'X'       I#PRTT                          CSW098
397700200529     C                     ELSE                                           CSW098
397800200529     C                     MOVELWWCUSS    I#PRTT                          CSW098
397900200529     C                     ENDIF                                          CSW098
398000200529      *                                                                   CSW098
398100200529     C                     MOVELWAWIN     I#PRTY                          CSW098
398200200529     C                     MOVELPTNMC     I#PCCY                          CSW098
398300200529     C                     MOVELPTNMC     I#RCCY                          CSW098
398400200529     C                     MOVELWWLI35    I#ACLN                          CSW098
398500200529     C                     CLEARO#PARM                                    CSW098
398600200529     C                     CLEARE#PARM                                    CSW098
398700200529     C                     MOVEL'SE1806'  E#CPGM                          CSW098
398800200529     C                     MOVEL'MEC0017' E#MSGD                          CSW098
398900200529     C                     MOVEL'MEMSG'   E#MSGF                          CSW098
399000200529      *                                                                   CSW098
399100200529     C                     MOVELWAWBK     WACLN                           CSW098
399200200529      *                                                                   CSW098
399300200529     C                     EXSR SRME99                                    CSW098
399400200529      *                                                                   CSW098
399500200529      ** If no issuer code defined for the currency clearing system,      CSW098
399600200529      ** set flag to display warning message for later display.           CSW098
399700200529      *                                                                   CSW098
399800200529     C           WICNIL    IFEQ 'Y'                                       CSW098
399900200529     C                     MOVEL'Y'       IAWBK                           CSW098
400000200529     C                     MOVEL*BLANKS   WICNIL                          CSW098
400100200529     C                     ENDIF                                          CSW098
400200200529      *                                                                   CSW098
400300200529     C                     MOVELWWLI35    WAWBK                           CSW098
400400200529      *                                                                   CSW098
400500200529     C                     ENDIF                                          CSW098
400600200529      *
400700200529     C           WWER35    IFNE 'Y'
400800200529     C                     SETOF                     27
400900200529     C                     MOVE '0'       OVER2
401000200529     C                     MOVELWWLI35    SAWIL
401100200529     C                     END
401200200529      *
401300200529     C                     END
401400200529     C                     END
401500200529     C                     END
401600200529      *                                                                                       CSW210
401700200529     C                     ENDIF                                                              CSW210
401800200529      *                                                                                       CSW210
401900200529      ** Check if value inserted is an IBAN                                                   CSW210
402000200529     C           SAWIL     IFNE *BLANKS                                                       CSW210
402100200529     C           CSW210    ANDEQ'Y'                                                           CSW210
402200200529     C           CFT004    ANDEQ'Y'                                                           CSW210
402300200529      *                                                                                       CSW210
402400200529     C                     MOVELSAWIL     DSIBAN                                              CSW210
402500200529     C           SAWIL     IFNE WWAIL                                                         CSW210
402600200529     C                     EXSR SRIBAN                                                        CSW210
402700200529     C                     MOVE WVIBAN    WWFAI1                                              CSW210
402800200529     C                     ENDIF                                                              CSW210
402900200529      *                                                                                       CSW210
403000200529      ** Replace field value if validated as an IBAN input                                    CSW210
403100200529     C           WIBRTN    IFNE *BLANKS                                                       CSW210
403200200529     C                     MOVE 'N'       WSAWIL                                              CSW210
403300200529     C                     MOVELWIBRTN    SAWIL                                               CSW210
403400200529     C                     MOVE *BLANKS   WIBRTN                                              CSW210
403500200529     C                     ELSE                                                               CSW210
403600200529      *                                                                                       CSW210
403700200529      ** If not IBAN, throw corresponding warning messages                                    CSW210
403800200529     C           WSAWIL    IFEQ 'Y'                                                           CSW210
403900200529     C           SAWIL     ANDEQWWAIL                                                         CSW210
404000200529     C                     MOVE 'N'       WSAWIL                                              CSW210
404100200529     C                     ELSE                                                               CSW210
404200200529     C           WIBNWR    IFEQ 'Y'                                                           CSW210
404300200529     C           SAWIL     ANDNEWWAIL                                                         CSW210
404400200529     C                     MOVELWTIBAN    SAWIL                                               CSW210
404500200529     C                     SETON                     27                                       CSW210
404600200529     C                     MOVE 'Y'       WSAWIL                                              CSW210
404700200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
404800200529     C                     MOVELS210W,3   ZAMSDT                                              CSW210
404900200529     C                     EXSR SREMSG                                                        CSW210
405000200529     C                     ENDIF                                                              CSW210
405100200529     C                     ENDIF                                                              CSW210
405200200529     C                     ENDIF                                                              CSW210
405300200529     C                     MOVELSAWIL     WWAIL                                               CSW210
405400200529     C                     ELSE                                                               CSW210
405500200529     C                     MOVE 'N'       WWFAI1                                              CSW210
405600200529      *                                                                                       CSW210
405700200529     C                     ENDIF                                                              CSW210
405800200529      *
405900200529     C                     ENDSR
406000200529      *
406100200529      *****************************************************************
406200200529      /EJECT
406300200529      *****************************************************************
406400200529      **                                                              *
406500200529      **  SRBOFA    - Validate Beneficiary of Money TAG :58:          *
406600200529      **                                                              *
406700200529      **  Calls     - SRSMSG                                          *
406800200529      **  Called By - SRVAL                                           *
406900200529      **                                                              *
407000200529      *****************************************************************
407100200529      *
407200200529     C           SRBOFA    BEGSR
407300200529      *
407400200529      ** this Field can only be Entered for Clearance Type 1 to 4
407500200529     C           WWCLTY    IFEQ '14'
407600200529      *
407700200529     C           SBOFA     IFNE 'D'
407800200529     C           SBOFA     ANDNE*BLANK
407900200529     C                     SETON                     2875
408000200529     C                     MOVEL'SEW5222' ZAMSID
408100200529     C                     EXSR SRSMSG
408200200529     C                     END
408300200529      *
408400200529      ** The A/c Lines may not be left Blank when Entering the TAG Field
408500200529     C           SBOFA     IFNE *BLANK
408600200529     C           SBOF1     ANDEQ*BLANK
408700200529     C                     SETON                     3075
408800200529     C                     MOVEL'SEW5227' ZAMSID
408900200529     C                     EXSR SRSMSG
409000200529     C                     END
409100200529      *
409200200529     C                     ELSE
409300200529      ** this Field must be left Blank If Clearance Type not 1 to 4
409400200529     C           SBOFA     IFNE *BLANK
409500200529     C                     SETON                     2875
409600200529     C                     MOVEL'SEW5221' ZAMSID
409700200529     C                     EXSR SRSMSG
409800200529     C                     END
409900200529     C                     END
410000200529      *
410100200529     C                     ENDSR
410200200529      *
410300200529      *****************************************************************
410400200529      /EJECT
410500200529      *****************************************************************
410600200529      **                                                              *
410700200529      **  SRBOFN    - Validate Beneficiary of Money :58:              *
410800200529      **                                                              *
410900200529      **  Calls     - SRCUST, SRSMSG                                  *
411000200529      **  Called By - SRVAL                                           *
411100200529      **                                                              *
411200200529      *****************************************************************
411300200529      *
411400200529     C           SRBOFN    BEGSR
411500200529      *                                                                   CSW098
411600200529     C                     MOVEL*BLANKS   WBOFN                           CSW098
411700200529      *
411800200529      ** Validate If not Blank
411900200529     C           SBOFN     IFNE *BLANKS
412000200529      *
412100200529      ** TAG Field must be left Blank
412200200529     C           SBOFA     IFNE *BLANKS
412300200529     C                     SETON                     2975
412400200529     C                     MOVEL'SEW5228' ZAMSID
412500200529     C                     EXSR SRSMSG
412600200529     C                     ELSE
412700200529      *
412800200529      ** Set Error Indicator ON this Field before Validation
412900200529     C                     SETON                     29
413000200529      *
413100200529      ** Validate Customer Number/Shortname/Nostro
413200200529     C                     MOVE SBOFN     WWCUST
413300200529     C                     EXSR SRCUST
413400200529     C                     MOVELBBCUST    SBOFN                                             AR589193
413500200529      *
413600200529      ** Reset Error Indicator If field is Valid
413700200529     C           WWCUSS    IFEQ 'C'
413800200529     C           WWCUSS    OREQ 'S'
413900200529     C           WWCUSS    OREQ 'N'
414000200529     C                     SETOF                     29
414100200529     C                     END
414200200529      *
414300200529      ** Customer Number/Shortname
414400200529     C           WWCUSS    IFEQ 'C'
414500200529     C           WWCUSS    OREQ 'S'
414600200529     C                     MOVELBBCUST    WWBOFN
414700200529     C                     END
414800200529      *
414900200529      ** Nostro
415000200529     C           WWCUSS    IFEQ 'N'
415100200529     C                     MOVELAWCPNC    WWBOFN
415200200529     C                     END
415300200529      *                                                                   CSW098
415400200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
415500200529     C                     MOVELWWBOFN    WBOFN                           CSW098
415600200529     C                     ENDIF                                          CSW098
415700200529      *
415800200529      ** Either SAWIN or SAWIL must be Non-Blank
415900200529      ** (SWIFT Field 57 must be Entered If 58 is Entered)
416000200529     C           SAWIN     IFEQ *BLANKS
416100200529     C           SAWIL     ANDEQ*BLANKS
416200200529     C           *IN78     ANDEQ*OFF                                                          201429
416300200529     C                     MOVE *BLANKS   WWBOFN
416400200529     C                     SETON                     262775
416500200529     C                     MOVEL'SEW5245' ZAMSID
416600200529     C                     EXSR SRSMSG
416700200529     C                     END
416800200529     C                     END
416900200529      *
417000200529     C                     ELSE
417100200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
417200200529     C                     MOVE *BLANKS   WWBOFN
417300200529     C                     END
417400200529      *
417500200529     C                     ENDSR
417600200529      *
417700200529      *****************************************************************
417800200529      /EJECT
417900200529      *****************************************************************
418000200529      **                                                              *
418100200529      **  SRBOF1    - Validate Beneficiary of Money A/c Line :58:     *
418200200529      **                                                              *
418300200529      ****Calls*****-*SRSMSG,*SRLI35***********************************   CSW098
418400200529      **  Calls     - SRSMSG, SRLI35, SRME99                          *   CSW098
418500200529      **  Called By - SRVAL                                           *
418600200529      **                                                              *
418700200529      *****************************************************************
418800200529      *
418900200529     C           SRBOF1    BEGSR
419000200529      *
419100200529     C           PSNEW     IFNE 'Y'                                                           CSW210
419200200529     C           CSE028    ORNE 'Y'                                                           CSW210
419300200529      ** Validate If not Blank
419400200529     C                     MOVELSBOF1     WWBOF1  1
419500200529     C           SBOF1     IFNE *BLANKS
419600200529     C           WWBOF1    ANDNE'#'
419700200529      *
419800200529      ** Override by F18
419900200529     C           PSENT     IFEQ 'CEDEL'
420000200529     C           *INKS     ANDEQ*ON
420100200529     C           OVER3     ANDEQ'1'
420200200529     C                     MOVE *OFF      *INKS
420300200529     C                     MOVE 'Y'       OVER3
420400200529     C                     END
420500200529      *
420600200529      ** If not Overridden
420700200529     C           OVER3     IFNE 'Y'
420800200529      *
420900200529     C           SBOFN     IFEQ *BLANKS
421000200529     C           SBOFA     ANDEQ*BLANKS
421100200529     C                     SETON                     2975
421200200529     C                     MOVE '1'       OVER3
421300200529     C                     MOVEL'SEW5230' ZAMSID
421400200529     C                     EXSR SRSMSG
421500200529      *
421600200529     C                     ELSE
421700200529     C                     MOVELSBOF1     WWLI01
421800200529     C                     MOVELSBOF1     WWLI02
421900200529     C                     MOVELSBOF1     WWLI04
422000200529     C                     MOVELSBOF1     WWLI05
422100200529     C                     MOVELSBOF1     WWLI35
422200200529      *
422300200529     C           WWLI02    IFEQ '//'
422400200529     C           WWCUSS    ANDEQ'C'
422500200529     C           WWBNBI    ANDEQ'N'
422600200529     C           WWLI02    OREQ '//'
422700200529     C           WWCUSS    ANDEQ'S'
422800200529     C           WWBNBI    ANDEQ'N'
422900200529     C                     SETON                     3075
423000200529     C                     MOVE '1'       OVER3
423100200529     C                     MOVEL'SEW5250' ZAMSID
423200200529     C                     EXSR SRSMSG
423300200529      *
423400200529     C                     ELSE
423500200529     C                     SETON                     30
423600200529     C                     MOVE '1'       OVER3
423700200529      *                                                                   CSW098
423800200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
423900200529     C                     EXSR SRLI35
424000200529     C                     ELSE                                           CSW098
424100200529      *                                                                   CSW098
424200200529      ** Set up parameters for call to ME9940                             CSW098
424300200529     C                     MOVE *BLANKS   W0RTN                           CSW098
424400200529     C                     CLEARI#PARM                                    CSW098
424500200529     C                     MOVEL'BENF '   I#VFLD                          CSW098
424600200529     C                     MOVEL'PAY'     I#PR                            CSW098
424700200529      *                                                                   CSW098
424800200529     C           WWCUSS    IFEQ 'N'                                       CSW098
424900200529     C                     MOVEL'X'       I#PRTT                          CSW098
425000200529     C                     ELSE                                           CSW098
425100200529     C                     MOVELWWCUSS    I#PRTT                          CSW098
425200200529     C                     ENDIF                                          CSW098
425300200529      *                                                                   CSW098
425400200529     C                     MOVELWBOFN     I#PRTY                          CSW098
425500200529     C                     MOVELPTNMC     I#PCCY                          CSW098
425600200529     C                     MOVELPTNMC     I#RCCY                          CSW098
425700200529     C                     MOVELWWLI35    I#ACLN                          CSW098
425800200529     C                     CLEARO#PARM                                    CSW098
425900200529     C                     CLEARE#PARM                                    CSW098
426000200529     C                     MOVEL'SE1806'  E#CPGM                          CSW098
426100200529     C                     MOVEL'MEC0018' E#MSGD                          CSW098
426200200529     C                     MOVEL'MEMSG'   E#MSGF                          CSW098
426300200529      *                                                                   CSW098
426400200529     C                     MOVELWBENF     WACLN                           CSW098
426500200529      *                                                                   CSW098
426600200529     C                     EXSR SRME99                                    CSW098
426700200529      *                                                                   CSW098
426800200529      ** If no issuer code defined for the currency clearing system,      CSW098
426900200529      ** set flag to display warning message for later display.           CSW098
427000200529      *                                                                   CSW098
427100200529     C           WICNIL    IFEQ 'Y'                                       CSW098
427200200529     C                     MOVEL'Y'       IBENF   1                       CSW098
427300200529     C                     MOVEL*BLANKS   WICNIL                          CSW098
427400200529     C                     ENDIF                                          CSW098
427500200529      *                                                                   CSW098
427600200529     C                     MOVELWWLI35    WBENF                           CSW098
427700200529      *                                                                   CSW098
427800200529     C                     ENDIF                                          CSW098
427900200529      *
428000200529     C           WWER35    IFNE 'Y'
428100200529     C                     SETOF                     30
428200200529     C                     MOVE '0'       OVER3
428300200529     C                     MOVELWWLI35    SBOF1
428400200529     C                     END
428500200529      *
428600200529     C                     END
428700200529     C                     END
428800200529     C                     END
428900200529     C                     END
429000200529      *                                                                                       CSW210
429100200529     C                     ENDIF                                                              CSW210
429200200529      *                                                                                       CSW210
429300200529      ** Check if value inserted is an IBAN                                                   CSW210
429400200529     C           SBOF1     IFNE *BLANKS                                                       CSW210
429500200529     C           CSW210    ANDEQ'Y'                                                           CSW210
429600200529     C           CFT004    ANDEQ'Y'                                                           CSW210
429700200529      *                                                                                       CSW210
429800200529     C                     MOVELSBOF1     DSIBAN                                              CSW210
429900200529     C           SBOF1     IFNE WWSBOF                                                        CSW210
430000200529     C                     EXSR SRIBAN                                                        CSW210
430100200529     C                     MOVE WVIBAN    WWFBF1                                              CSW210
430200200529     C                     ENDIF                                                              CSW210
430300200529      *                                                                                       CSW210
430400200529      ** Replace field value if validated as an IBAN input                                    CSW210
430500200529     C           WIBRTN    IFNE *BLANKS                                                       CSW210
430600200529     C                     MOVE 'N'       WSBOF1                                              CSW210
430700200529     C                     MOVELWIBRTN    SBOF1                                               CSW210
430800200529     C                     MOVE *BLANKS   WIBRTN                                              CSW210
430900200529     C                     ELSE                                                               CSW210
431000200529      *                                                                                       CSW210
431100200529      ** If not IBAN, throw corresponding warning messages                                    CSW210
431200200529     C           WSBOF1    IFEQ 'Y'                                                           CSW210
431300200529     C           SBOF1     ANDEQWWSBOF                                                        CSW210
431400200529     C                     MOVE 'N'       WSBOF1                                              CSW210
431500200529     C                     ELSE                                                               CSW210
431600200529     C           WIBNWR    IFEQ 'Y'                                                           CSW210
431700200529     C           SBOF1     ANDNEWWSBOF                                                        CSW210
431800200529     C                     MOVELWTIBAN    SBOF1                                               CSW210
431900200529     C                     SETON                     30                                       CSW210
432000200529     C                     MOVE 'Y'       WSBOF1                                              CSW210
432100200529     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
432200200529     C                     MOVELS210W,4   ZAMSDT                                              CSW210
432300200529     C                     EXSR SREMSG                                                        CSW210
432400200529     C                     ENDIF                                                              CSW210
432500200529     C                     ENDIF                                                              CSW210
432600200529     C                     ENDIF                                                              CSW210
432700200529     C                     MOVELSBOF1     WWSBOF                                              CSW210
432800200529     C                     ELSE                                                               CSW210
432900200529     C                     MOVE 'N'       WWFBF1                                              CSW210
433000200529      *                                                                                       CSW210
433100200529     C                     ENDIF                                                              CSW210
433200200529      *
433300200529     C                     ENDSR
433400200529      *
433500200529      *****************************************************************
433600200529      /EJECT
433700200529      *****************************************************************
433800200529      **                                                              *
433900200529      **  SRBOF2    - Validate Beneficiary of Money A/c Line :58:     *
434000200529      **                                                              *
434100200529      **  Calls     - SRSMSG                                          *
434200200529      **  Called By - SRVAL                                           *
434300200529      **                                                              *
434400200529      *****************************************************************
434500200529      *
434600200529     C           SRBOF2    BEGSR
434700200529      *
434800200529      ** Validate If not Blank and not Overridden
434900200529     C                     MOVELSBOF2     WWBOF2  1
435000200529     C           SBOF2     IFNE *BLANKS
435100200529     C           WWBOF2    ANDNE'#'
435200200529     C           OVER3     ANDNE'Y'
435300200529      *
435400200529      ** Override by F18
435500200529     C           PSENT     IFEQ 'CEDEL'
435600200529     C           *INKS     ANDEQ*ON
435700200529     C           OVER3     ANDEQ'1'
435800200529     C                     MOVE *OFF      *INKS
435900200529     C                     MOVE 'Y'       OVER3
436000200529     C                     END
436100200529      *
436200200529      ** If not Overridden
436300200529     C           OVER3     IFNE 'Y'
436400200529      *
436500200529     C           SBOF1     IFEQ *BLANKS
436600200529     C                     SETON                     3075
436700200529     C                     MOVEL'SEW5255' ZAMSID
436800200529     C                     EXSR SRSMSG
436900200529     C                     END
437000200529      *
437100200529     C           WWBOF1    IFNE '/'
437200200529     C           WWBOF2    ANDEQ'/'
437300200529     C                     SETON                     3175
437400200529     C                     MOVE '1'       OVER3
437500200529     C                     MOVEL'SEW5256' ZAMSID
437600200529     C                     EXSR SRSMSG
437700200529     C                     END
437800200529      *
437900200529     C                     MOVELSBOF2     WWLI02
438000200529     C           WWBOF2    IFEQ '/'
438100200529     C           WWLI02    ANDNE'//'
438200200529     C                     SETON                     3175
438300200529     C                     MOVE '1'       OVER3
438400200529     C                     MOVEL'SEW5257' ZAMSID
438500200529     C                     EXSR SRSMSG
438600200529     C                     END
438700200529      *
438800200529     C           SBOF2     IFEQ SBOF1
438900200529     C                     SETON                     3175
439000200529     C                     MOVEL'SEW5258' ZAMSID
439100200529     C                     EXSR SRSMSG
439200200529     C                     END
439300200529      *
439400200529     C                     END
439500200529     C                     END
439600200529      *
439700200529     C                     ENDSR
439800200529      *
439900200529      *****************************************************************
440000200529      /EJECT
440100200529      *****************************************************************
440200200529      **                                                              *
440300200529      **  SRACL1    - Validate A/c Charges Line 1 :71:                *
440400200529      **                                                              *
440500200529      **  Calls     - SRSMSG                                          *
440600200529      **  Called By - SRVAL                                           *
440700200529      **                                                              *
440800200529      *****************************************************************
440900200529      *
441000200529     C           SRACL1    BEGSR
441100200529      *
441200200529      ** Validate If not Blank
441300200529     C                     MOVE *BLANKS   WWACL1  1
441400200529     C                     MOVE *BLANKS   WWVALI  1
441500200529     C           SACL1     IFNE *BLANKS
441600200529     C                     MOVELSACL1     WWACL1
441700200529      *
441800200529     C           WWACL1    IFEQ '/'
441900200529     C                     MOVELSACL1     WWLI08  8
442000200529     C           WWLI08    IFNE '/ACCCAP/'
442100200529     C           WWLI08    ANDNE'/ACCCHG/'
442200200529     C           WWLI08    ANDNE'/ACCFEE/'
442300200529     C           WWLI08    ANDNE'/ACCREV/'
442400200529     C                     MOVE 'N'       WWVALI
442500200529     C                     END
442600200529      *
442700200529     C           WWVALI    IFEQ 'N'
442800200529     C                     SETON                     3275
442900200529     C                     MOVEL'SEW5260' ZAMSID
443000200529     C                     EXSR SRSMSG
443100200529     C                     END
443200200529      *
443300200529     C                     END
443400200529     C                     END
443500200529      *
443600200529     C                     ENDSR
443700200529      *
443800200529      *****************************************************************
443900200529      /EJECT
444000200529      *****************************************************************
444100200529      **                                                              *
444200200529      **  SRACL2    - Validate A/c Charges Line 2 :71:                *
444300200529      **                                                              *
444400200529      **  Calls     - SRSMSG                                          *
444500200529      **  Called By - SRVAL                                           *
444600200529      **                                                              *
444700200529      *****************************************************************
444800200529      *
444900200529     C           SRACL2    BEGSR
445000200529      *
445100200529      ** Validate If not Blank
445200200529     C           SACL2     IFNE *BLANKS
445300200529      *
445400200529     C           SACL1     IFEQ *BLANKS
445500200529     C                     SETON                     3275
445600200529     C                     MOVEL'SEW5255' ZAMSID
445700200529     C                     EXSR SRSMSG
445800200529     C                     END
445900200529      *
446000200529     C                     MOVELSACL2     WWACL2  1
446100200529     C           WWACL1    IFNE '/'
446200200529     C           WWACL2    ANDEQ'/'
446300200529     C                     SETON                     3375
446400200529     C                     MOVEL'SEW5256' ZAMSID
446500200529     C                     EXSR SRSMSG
446600200529     C                     END
446700200529      *
446800200529     C                     MOVELSACL2     WWLI02
446900200529     C           WWACL1    IFEQ '/'
447000200529     C           WWLI02    ANDNE'//'
447100200529     C                     SETON                     3375
447200200529     C                     MOVEL'SEW5214' ZAMSID
447300200529     C                     EXSR SRSMSG
447400200529     C                     END
447500200529      *
447600200529     C           WWACL2    IFEQ '/'
447700200529     C           WWLI02    ANDNE'//'
447800200529     C                     SETON                     3375
447900200529     C                     MOVEL'SEW5257' ZAMSID
448000200529     C                     EXSR SRSMSG
448100200529     C                     END
448200200529      *
448300200529     C                     MOVE SACL2     WWLI33 33
448400200529     C           WWLI02    IFEQ '//'
448500200529     C           WWLI33    ANDEQ*BLANKS
448600200529     C                     SETON                     3375
448700200529     C                     MOVEL'SEW5213' ZAMSID
448800200529     C                     EXSR SRSMSG
448900200529     C                     END
449000200529      *
449100200529     C           SACL2     IFEQ SACL1
449200200529     C                     SETON                     3375
449300200529     C                     MOVEL'SEW5258' ZAMSID
449400200529     C                     EXSR SRSMSG
449500200529     C                     END
449600200529      *
449700200529     C                     ELSE
449800200529      ** May not be Blank as a Continuation Line
449900200529     C                     MOVELSACL2     WWLI02
450000200529     C           WWACL1    IFEQ '/'
450100200529     C           WWLI02    ANDNE'//'
450200200529     C                     SETON                     3375
450300200529     C                     MOVEL'SEW5214' ZAMSID
450400200529     C                     EXSR SRSMSG
450500200529     C                     END
450600200529     C                     END
450700200529      *
450800200529     C                     ENDSR
450900200529      *
451000200529      *****************************************************************
451100200529      /EJECT
451200200529      *****************************************************************
451300200529      **                                                              *
451400200529      **  SRSRL1    - Validate Sender to Receiver Info Line 1 :72:    *
451500200529      **                                                              *
451600200529      **  Calls     - SRSMSG                                          *
451700200529      **  Called By - SRVAL                                           *
451800200529      **                                                              *
451900200529      *****************************************************************
452000200529      *
452100200529     C           SRSRL1    BEGSR
452200200529      *
452300200529     C/COPY WNCPYSRC,SE1806C017
452400200529      ** Validate If not Blank
452500200529     C                     MOVE *BLANK    WKSRL1  1                       056348
452600200529     C                     MOVE *BLANKS   WWSRL1  1
452700200529     C                     MOVE *BLANKS   WWVALI
452800200529     C           SSRL1     IFNE *BLANKS
452900200529      *
453000200529     C                     MOVELSSRL1     WWSRL1
453100200529     C           WWSRL1    IFEQ '/'
453200200529      *
453300200529     C***********PTDTP     IFEQ 'TS'                                      CSW003
453400200529     C***********PCLTY     ANDEQ'5'                                       CSW003
453500200529     C           WTDTP     IFEQ 'TS'                                      CSW003
453600200529     C           WWCLTY    ANDNE'14'                                      CSW003
453700200529     C                     MOVELSSRL1     WWSR10 10
453800200529     C                     MOVELWWSR10    WWSR06  6
453900200529     C                     MOVE WWSR10    WWSR04  4
454000200529     C           WWSR06    IFEQ '/PRIOR'
454100200529     C           WWSR04    ANDEQ'REQ/'
454200200529     C                     MOVE 'Y'       WWVALI
454300200529     C                     MOVE 'Y'       WKSRL1                          056348
454400200529     C                     END
454500200529     C                     END
454600200529     C           WTDTP     IFEQ 'TP'                                      056348
454700200529     C           WWCLTY    ANDNE'14'                                      056348
454800200529     C                     MOVELSSRL1     WWSR10                          056348
454900200529     C                     MOVELWWSR10    WWSR06                          056348
455000200529     C                     MOVE WWSR10    WWSR04                          056348
455100200529     C           WWSR06    IFEQ '/TRADE'                                  056348
455200200529     C           WWSR04    ANDEQ'CP/ '                                    056348
455300200529     C                     MOVE 'Y'       WWVALI                          056348
455400200529     C                     MOVE 'Y'       WKSRL1                          056348
455500200529     C                     END                                            056348
455600200529     C                     END                                            056348
455700200529     C           WTDTP     IFEQ 'TP'                                      056348
455800200529     C           WWCLTY    ANDEQ'5'                                       056348
455900200529     C                     MOVELSSRL1     WWSR10                          056348
456000200529     C                     MOVELWWSR10    WWSR06                          056348
456100200529     C                     MOVE WWSR10    WWSR04                          056348
456200200529     C                     MOVELWWSR04    WWSR03  3                       056348
456300200529     C           WWSR06    IFEQ '/TRADE'                                  056348
456400200529     C           WWSR03    ANDEQ'CP/'                                     056348
456500200529     C                     MOVE 'Y'       WWVALI                          056348
456600200529     C                     MOVE 'Y'       WKSRL1                          056348
456700200529     C                     END                                            056348
456800200529     C                     END                                            056348
456900200529      *
457000200529     C                     MOVELSSRL1     WWSR06
457100200529     C                     MOVELSSRL1     WWSR07  7
457200200529     C                     MOVELSSRL1     WWSR08  8
457300200529     C           WWSR06    IFEQ '/AGEN/'
457400200529     C           WWSR06    OREQ '/PRIN/'
457500200529     C           WWSR06    OREQ '/PHON/'
457600200529     C                     MOVE 'Y'       WWVALI
457700200529     C                     END
457800200529     C           WWSR07    IFEQ '/TELEX/'
457900200529     C                     MOVE 'Y'       WWVALI
458000200529     C                     END
458100200529     C           WWSR08    IFEQ '/BROKER/'
458200200529     C                     MOVE 'Y'       WWVALI
458300200529     C                     END
458400200529      *
458500200529     C***********          MOVE *BLANK    WKSRL1  1                       056348
458600200529     C           WWCLTY    IFEQ '14'
458700200529     C                     MOVELSSRL1     WWSR10
458800200529     C                     MOVELWWSR10    WWSR06
458900200529     C                     MOVE WWSR10    WWSR04
459000200529     C                     MOVE SSRL1     WWSR25 25
459100200529     C           WWSR06    IFEQ '/ADDPR'
459200200529     C           WWSR04    ANDEQ'TY/ '
459300200529     C           WWSR25    ANDEQ*BLANKS
459400200529     C                     MOVE 'Y'       WWVALI
459500200529     C                     MOVE 'Y'       WKSRL1
459600200529     C                     END
459700200529     C           WWSR06    IFEQ '/CANCE'
459800200529     C           WWSR04    ANDEQ'L/  '
459900200529     C           WWSR25    ANDEQ*BLANKS
460000200529     C                     MOVE 'Y'       WWVALI
460100200529     C                     MOVE 'Y'       WKSRL1
460200200529     C                     END
460300200529     C           WWSR06    IFEQ '/CONFI'
460400200529     C           WWSR04    ANDEQ'RM/ '
460500200529     C           WWSR25    ANDEQ*BLANKS
460600200529     C                     MOVE 'Y'       WWVALI
460700200529     C                     MOVE 'Y'       WKSRL1
460800200529     C                     END
460900200529     C                     END
461000200529      *                                                                   CSW014
461100200529     C           CSW014    IFEQ 'Y'                                       CSW014
461200200529     C                     MOVELSSRL1     WWSR06  6                       CSW014
461300200529     C           WWSR06    IFEQ '/OCMT/'                                  CSW014
461400200529     C                     MOVE 'Y'       WWVALI                          CSW014
461500200529     C                     ENDIF                                          CSW014
461600200529     C                     ENDIF                                          CSW014
461700200529      *
461800200529     C           CSW201    IFEQ 'Y'                                                           CSW201
461900200529     C                     MOVELSSRL1     WWSR10                                              CSW201
462000200529     C                     EXSR SR2001                                                        CSW201
462100200529     C                     ENDIF                                                              CSW201
462200200529      *                                                                                       CSW201
462300200529     C/COPY WNCPYSRC,SE1806C022
462400200529     C           WWVALI    IFNE 'Y'
462500200529     C                     SETON                     3475
462600200529     C           CSW201    IFEQ 'Y'                                                           CSW201
462700200529     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
462800200529     C                     ELSE                                                               CSW201
462900200529     C                     MOVEL'SEW5265' ZAMSID
463000200529     C                     ENDIF                                                              CSW201
463100200529     C                     EXSR SRSMSG
463200200529     C                     END
463300200529      *
463400200529     C                     END
463500200529     C                     END
463600200529     C/COPY WNCPYSRC,SE1806C018
463700200529      *
463800200529     C                     ENDSR
463900200529      *
464000200529      *****************************************************************
464100200529      /EJECT
464200200529      *****************************************************************
464300200529      **                                                              *
464400200529      **  SRSRL2    - Validate Sender to Receiver Info Line 2 :72:    *
464500200529      **                                                              *
464600200529      **  Calls     - SRSMSG                                          *
464700200529      **  Called By - SRVAL                                           *
464800200529      **                                                              *
464900200529      *****************************************************************
465000200529      *
465100200529     C           SRSRL2    BEGSR
465200200529      *
465300200529      ** Validate If not Blank
465400200529     C                     MOVE *BLANKS   WWSRL2  1
465500200529     C                     MOVE *BLANKS   WWVALI
465600200529     C           SSRL2     IFNE *BLANKS
465700200529      *
465800200529     C           SSRL1     IFEQ *BLANKS
465900200529     C                     SETON                     3475
466000200529     C                     MOVEL'SEW5255' ZAMSID
466100200529     C                     EXSR SRSMSG
466200200529     C                     END
466300200529      *
466400200529     C                     MOVELSSRL2     WWSRL2
466500200529     C           WWSRL1    IFNE '/'
466600200529     C           WWSRL2    ANDEQ'/'
466700200529     C/COPY WNCPYSRC,SE1806C023
466800200529     C                     SETON                     3575
466900200529     C                     MOVEL'SEW5256' ZAMSID
467000200529     C                     EXSR SRSMSG
467100200529     C                     END
467200200529      *
467300200529     C                     MOVELSSRL2     WWLI02
467400200529      *                                                                                       CSW201
467500200529     C           CSW201    IFEQ 'Y'                                                           CSW201
467600200529     C           WWLI02    ANDNE'//'                                                          CSW201
467700200529     C                     MOVELSSRL2     WWSR10                                              CSW201
467800200529     C                     EXSR SR2001                                                        CSW201
467900200529      *                                                                                       CSW201
468000200529     C           WWVALI    IFNE 'Y'                                                           CSW201
468100200529     C                     MOVE *ON       *IN35                                               CSW201
468200200529     C                     MOVE *ON       *IN75                                               CSW201
468300200529     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
468400200529     C                     EXSR SRSMSG                                                        CSW201
468500200529     C                     ENDIF                                                              CSW201
468600200529      *                                                                                       CSW201
468700200529     C                     ENDIF                                                              CSW201
468800200529      *                                                                                       CSW201
468900200529     C           CSW201    IFEQ 'N'                                                           CSW201
469000200529      *                                                                                       CSW201
469100200529     C           WKSRL1    IFEQ *BLANK
469200200529     C           WWSRL1    ANDEQ'/'
469300200529     C           WWLI02    ANDNE'//'
469400200529     C/COPY WNCPYSRC,SE1806C024
469500200529     C                     SETON                     3575
469600200529     C                     MOVEL'SEW5214' ZAMSID
469700200529     C                     EXSR SRSMSG
469800200529     C                     END
469900200529      *
470000200529     C           WWSRL2    IFEQ '/'
470100200529     C           WWLI02    ANDNE'//'
470200200529     C/COPY WNCPYSRC,SE1806C025
470300200529     C                     SETON                     3575
470400200529     C                     MOVEL'SEW5257' ZAMSID
470500200529     C                     EXSR SRSMSG
470600200529     C                     END
470700200529     C                     ENDIF                                                              CSW201
470800200529      *
470900200529     C                     MOVE SSRL2     WWLI33
471000200529     C           WWLI02    IFEQ '//'
471100200529     C           WWLI33    ANDEQ*BLANKS
471200200529     C                     SETON                     3575
471300200529     C                     MOVEL'SEW5213' ZAMSID
471400200529     C                     EXSR SRSMSG
471500200529     C                     END
471600200529      *
471700200529     C           SSRL2     IFEQ SSRL1
471800200529     C                     SETON                     3575
471900200529     C                     MOVEL'SEW5258' ZAMSID
472000200529     C                     EXSR SRSMSG
472100200529     C                     END
472200200529      *
472300200529     C           CSW201    IFEQ 'N'                                                           CSW201
472400200529     C           WKSRL1    IFNE *BLANK
472500200529     C           SSRL2     ANDNE*BLANKS
472600200529     C                     SETON                     3575
472700200529     C                     MOVEL'SEW5259' ZAMSID
472800200529     C                     EXSR SRSMSG
472900200529     C                     END
473000200529      *
473100200529     C                     ENDIF                                                              CSW201
473200200529      *                                                                                       CSW201
473300200529     C                     ELSE
473400200529      ** may not be Blank as a Continuation Line
473500200529     C                     MOVELSSRL2     WWLI02
473600200529      *--   AT THIS LEVEL LINE 2 IS EMPTY   --*                           061028
473700200529     C***********WKSRL1    IFEQ *BLANK                                    061028
473800200529     C***********WWSRL1    ANDEQ'/'                                       061028
473900200529     C***********WWLI02    ANDNE'//'                                      061028
474000200529     C***********          SETON                     3575                 061028
474100200529     C***********          MOVEL'SEW5214' ZAMSID                          061028
474200200529     C***********          EXSR SRSMSG                                    061028
474300200529     C***********          END                                            061028
474400200529     C                     END
474500200529      *
474600200529     C                     ENDSR
474700200529      *
474800200529      *****************************************************************
474900200529      /EJECT
475000200529      *****************************************************************
475100200529      **                                                              *
475200200529      **  SRSRL3    - Validate Sender to Receiver Info Line 3 :72:    *
475300200529      **                                                              *
475400200529      **  Calls     - SRSMSG                                          *
475500200529      **  Called By - SRVAL                                           *
475600200529      **                                                              *
475700200529      *****************************************************************
475800200529      *
475900200529     C           SRSRL3    BEGSR
476000200529      *
476100200529      ** Validate If not Blank
476200200529     C                     MOVE *BLANKS   WWVALI                                              CSW201
476300200529     C           SSRL3     IFNE *BLANKS
476400200529      *
476500200529     C           SSRL2     IFEQ *BLANKS
476600200529     C                     SETON                     3575
476700200529     C                     MOVEL'SEW5255' ZAMSID
476800200529     C                     EXSR SRSMSG
476900200529     C                     END
477000200529      *
477100200529     C                     MOVELSSRL3     WWSRL3  1
477200200529     C           WWSRL2    IFNE '/'
477300200529     C           WWSRL3    ANDEQ'/'
477400200529     C/COPY WNCPYSRC,SE1806C026
477500200529     C                     SETON                     3675
477600200529     C                     MOVEL'SEW5256' ZAMSID
477700200529     C                     EXSR SRSMSG
477800200529     C                     END
477900200529      *
478000200529     C                     MOVELSSRL3     WWLI02
478100200529      *                                                                                       CSW201
478200200529     C           CSW201    IFEQ 'Y'                                                           CSW201
478300200529     C           WWLI02    ANDNE'//'                                                          CSW201
478400200529     C                     MOVELSSRL3     WWSR10                                              CSW201
478500200529     C                     EXSR SR2001                                                        CSW201
478600200529      *                                                                                       CSW201
478700200529     C           WWVALI    IFNE 'Y'                                                           CSW201
478800200529     C                     MOVE *ON       *IN36                                               CSW201
478900200529     C                     MOVE *ON       *IN75                                               CSW201
479000200529     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
479100200529     C                     EXSR SRSMSG                                                        CSW201
479200200529     C                     ENDIF                                                              CSW201
479300200529      *                                                                                       CSW201
479400200529     C                     ENDIF                                                              CSW201
479500200529      *                                                                                       CSW201
479600200529     C           CSW201    IFEQ 'N'                                                           CSW201
479700200529      *                                                                                       CSW201
479800200529     C           WWSRL2    IFEQ '/'
479900200529     C           WWLI02    ANDNE'//'
480000200529     C/COPY WNCPYSRC,SE1806C027
480100200529     C                     SETON                     3675
480200200529     C                     MOVEL'SEW5214' ZAMSID
480300200529     C                     EXSR SRSMSG
480400200529     C                     END
480500200529      *
480600200529     C           WWSRL2    IFEQ '/'
480700200529     C           WWLI02    ANDNE'//'
480800200529     C/COPY WNCPYSRC,SE1806C028
480900200529     C                     SETON                     3675
481000200529     C                     MOVEL'SEW5257' ZAMSID
481100200529     C                     EXSR SRSMSG
481200200529     C                     END
481300200529     C                     ENDIF                                                              CSW201
481400200529      *
481500200529     C                     MOVE SSRL3     WWLI33
481600200529     C           WWLI02    IFEQ '//'
481700200529     C           WWLI33    ANDEQ*BLANKS
481800200529     C                     SETON                     3675
481900200529     C                     MOVEL'SEW5213' ZAMSID
482000200529     C                     EXSR SRSMSG
482100200529     C                     END
482200200529      *
482300200529     C           SSRL3     IFEQ SSRL2
482400200529     C                     SETON                     3675
482500200529     C                     MOVEL'SEW5258' ZAMSID
482600200529     C                     EXSR SRSMSG
482700200529     C                     END
482800200529      *
482900200529     C                     ELSE
483000200529      ** may not be Blank as a Continuation Line
483100200529     C                     MOVELSSRL3     WWLI02
483200200529      *--   AT THIS LEVEL LINE 3 IS EMPTY   --*                           061028
483300200529     C***********WWSRL2    IFEQ '/'                                       061028
483400200529     C***********WWLI02    ANDNE'//'                                      061028
483500200529     C***********          SETON                     3675                 061028
483600200529     C***********          MOVEL'SEW5214' ZAMSID                          061028
483700200529     C***********          EXSR SRSMSG                                    061028
483800200529     C***********          END                                            061028
483900200529     C                     END
484000200529      *
484100200529     C                     ENDSR
484200200529      *
484300200529      *****************************************************************
484400200529      /EJECT
484500200529      *****************************************************************
484600200529      **                                                              *
484700200529      **  SRFIN1    - Validate Further Information Line 1 :77:        *
484800200529      **                                                              *
484900200529      **  Calls     - SRSMSG                                          *
485000200529      **  Called By - SRVAL                                           *
485100200529      **                                                              *
485200200529      *****************************************************************
485300200529      *
485400200529     C           SRFIN1    BEGSR
485500200529      *
485600200529      ** Validate If not Blank
485700200529     C           SFIN1     IFNE *BLANKS
485800200529      *
485900200529     C                     MOVELSFIN1     WWLI01
486000200529     C           WWLI01    IFEQ '/'
486100200529     C                     SETON                     3775
486200200529     C                     MOVEL'SEW5285' ZAMSID
486300200529     C                     EXSR SRSMSG
486400200529     C                     END
486500200529      *
486600200529     C                     END
486700200529      *
486800200529     C                     ENDSR
486900200529      *
487000200529      *****************************************************************
487100200529      /EJECT
487200200529      *****************************************************************
487300200529      **                                                              *
487400200529      **  SRFIN2    - Validate Further Information Line 2 :77:        *
487500200529      **                                                              *
487600200529      **  Calls     - SRSMSG                                          *
487700200529      **  Called By - SRVAL                                           *
487800200529      **                                                              *
487900200529      *****************************************************************
488000200529      *
488100200529     C           SRFIN2    BEGSR
488200200529      *
488300200529      ** Validate If not Blank
488400200529     C           SFIN2     IFNE *BLANKS
488500200529      *
488600200529     C           SFIN1     IFEQ *BLANKS
488700200529     C                     SETON                     3775
488800200529     C                     MOVEL'SEW5255' ZAMSID
488900200529     C                     EXSR SRSMSG
489000200529     C                     END
489100200529      *
489200200529     C           SFIN2     IFEQ SFIN1
489300200529     C                     SETON                     3875
489400200529     C                     MOVEL'SEW5258' ZAMSID
489500200529     C                     EXSR SRSMSG
489600200529     C                     END
489700200529      *
489800200529     C                     MOVELSFIN2     WWLI01
489900200529     C           WWLI01    IFEQ '/'
490000200529     C                     SETON                     3875
490100200529     C                     MOVEL'SEW5285' ZAMSID
490200200529     C                     EXSR SRSMSG
490300200529     C                     END
490400200529      *
490500200529     C                     END
490600200529      *
490700200529     C                     ENDSR
490800200529     C/COPY WNCPYSRC,SE1806C052
490900200529      *
491000200529      *****************************************************************
491100200529      ***/EJECT********************************************************                       CSW210
491200200529      *****************************************************************
491300200529      *****************************************************************                       CSW210
491400200529      ****SRRED1****-*Validate*Registration*Details*Line*1*:77:********                       CSW210
491500200529      *****************************************************************                       CSW210
491600200529      ****Calls*****-*SRSMSG*******************************************                       CSW210
491700200529      ****Called*By*-*SRVAL********************************************                       CSW210
491800200529      *****************************************************************                       CSW210
491900200529      *****************************************************************
492000200529      *****************************************************************                       CSW210
492100200529     C********** SRRED1    BEGSR                                                              CSW210
492200200529      *****************************************************************                       CSW210
492300200529     C***/COPY*WNCPYSRC,SE1806C005                                                            CSW210
492400200529      ***Validate*Field*If*not*Blank***********************************                       CSW210
492500200529     C********** SRED1     IFNE *BLANKS                                                       CSW210
492600200529     C***/COPY*WNCPYSRC,SE1806C006                                                            CSW210
492700200529      *****************************************************************                       CSW210
492800200529     C**********           MOVELSRED1     WWLI01                                              CSW210
492900200529     C********** WWLI01    IFEQ '/'                                                           CSW210
493000200529     C***/COPY*WNCPYSRC,SE1806C003                                                            CSW210
493100200529     C**********           SETON                     3975                                     CSW210
493200200529     C**********           MOVEL'SEW5285' ZAMSID                                              CSW210
493300200529     C**********           EXSR SRSMSG                                                        CSW210
493400200529     C**********           END                                                                CSW210
493500200529      *****************************************************************                       CSW210
493600200529     C**********           END                                                                CSW210
493700200529      *****************************************************************                       CSW210
493800200529     C**********           ENDSR                                                              CSW210
493900200529      *****************************************************************                       CSW210
494000200529      *****************************************************************
494100200529      ***/EJECT********************************************************                       CSW210
494200200529      *****************************************************************
494300200529      *****************************************************************                       CSW210
494400200529      ****SRRED2****-*Validate*Registration*Details*Line*1*:77:********                       CSW210
494500200529      *****************************************************************                       CSW210
494600200529      ****Calls*****-*SRSMSG*******************************************                       CSW210
494700200529      ****Called*By*-*SRVAL********************************************                       CSW210
494800200529      *****************************************************************                       CSW210
494900200529      *****************************************************************
495000200529      *****************************************************************                       CSW210
495100200529     C********** SRRED2    BEGSR                                                              CSW210
495200200529      *****************************************************************                       CSW210
495300200529      ***Validate*If*not*Blank*****************************************                       CSW210
495400200529     C********** SRED2     IFNE *BLANKS                                                       CSW210
495500200529     C***/COPY*WNCPYSRC,SE1806C007                                                            CSW210
495600200529      *****************************************************************                       CSW210
495700200529     C********** SRED1     IFEQ *BLANKS                                                       CSW210
495800200529     C**********           SETON                     4075                                     CSW210
495900200529     C**********           MOVEL'SEW5255' ZAMSID                                              CSW210
496000200529     C**********           EXSR SRSMSG                                                        CSW210
496100200529     C**********           END                                                                CSW210
496200200529      *****************************************************************                       CSW210
496300200529     C********** SRED2     IFEQ SRED1                                                         CSW210
496400200529     C**********           SETON                     4075                                     CSW210
496500200529     C**********           MOVEL'SEW5258' ZAMSID                                              CSW210
496600200529     C**********           EXSR SRSMSG                                                        CSW210
496700200529     C**********           END                                                                CSW210
496800200529      *****************************************************************                       CSW210
496900200529     C**********           MOVELSRED2     WWLI01                                              CSW210
497000200529     C********** WWLI01    IFEQ '/'                                                           CSW210
497100200529     C***/COPY*WNCPYSRC,SE1806C004                                                            CSW210
497200200529     C**********           SETON                     4075                                     CSW210
497300200529     C**********           MOVEL'SEW5285' ZAMSID                                              CSW210
497400200529     C**********           EXSR SRSMSG                                                        CSW210
497500200529     C**********           END                                                                CSW210
497600200529      *****************************************************************                       CSW210
497700200529     C***/COPY*WNCPYSRC,SE1806C008                                                            CSW210
497800200529     C**********           END                                                                CSW210
497900200529      *****************************************************************                       CSW210
498000200529     C**********           ENDSR                                                              CSW210
498100200529      *****************************************************************                       CSW210
498200200529     C/COPY WNCPYSRC,SE1806C053
498300200529      *****************************************************************
498400200529      /EJECT
498500200529      *****************************************************************
498600200529      **                                                              *
498700200529      **  SRNAL1    - Validate Narrative 1 :79:                       *
498800200529      **                                                              *
498900200529      **  Calls     - SRSMSG                                          *
499000200529      **  Called By - SRVAL                                           *
499100200529      **                                                              *
499200200529      *****************************************************************
499300200529      *
499400200529     C           SRNAL1    BEGSR
499500200529      *
499600200529      ** Validate Field If not Blank
499700200529     C                     MOVE *BLANKS   WWNAL1  1
499800200529     C           SNAL1     IFNE *BLANKS
499900200529      *
500000200529     C                     MOVELSNAL1     WWNAL1
500100200529     C                     MOVE SNAL1     WWLI34
500200200529     C           WWNAL1    IFEQ '/'
500300200529     C           WWLI34    ANDEQ*BLANKS
500400200529     C                     SETON                     4175
500500200529     C                     MOVEL'SEW5263' ZAMSID
500600200529     C                     EXSR SRSMSG
500700200529     C                     END
500800200529      *
500900200529     C                     END
501000200529      *
501100200529     C                     ENDSR
501200200529      *
501300200529      *****************************************************************
501400200529      /EJECT
501500200529      *****************************************************************
501600200529      **                                                              *
501700200529      **  SRNAL2    - Validate Narrative 2 :79:                       *
501800200529      **                                                              *
501900200529      **  Calls     - SRSMSG                                          *
502000200529      **  Called By - SRVAL                                           *
502100200529      **                                                              *
502200200529      *****************************************************************
502300200529      *
502400200529     C           SRNAL2    BEGSR
502500200529      *
502600200529      ** Validate If not Blank
502700200529     C           SNAL2     IFNE *BLANKS
502800200529      *
502900200529     C           SNAL1     IFEQ *BLANKS
503000200529     C                     SETON                     4175
503100200529     C                     MOVEL'SEW5255' ZAMSID
503200200529     C                     EXSR SRSMSG
503300200529     C                     END
503400200529      *
503500200529     C                     MOVELSNAL2     WWNAL2  1
503600200529     C           WWNAL1    IFNE '/'
503700200529     C           WWNAL2    ANDEQ'/'
503800200529     C                     SETON                     4275
503900200529     C                     MOVEL'SEW5256' ZAMSID
504000200529     C                     EXSR SRSMSG
504100200529     C                     END
504200200529      *
504300200529     C                     MOVELSNAL2     WWLI02
504400200529     C           WWNAL1    IFEQ '/'
504500200529     C           WWLI02    ANDNE'//'
504600200529     C                     SETON                     4275
504700200529     C                     MOVEL'SEW5214' ZAMSID
504800200529     C                     EXSR SRSMSG
504900200529     C                     END
505000200529      *
505100200529     C           WWNAL2    IFEQ '/'
505200200529     C           WWLI02    ANDNE'//'
505300200529     C                     SETON                     4275
505400200529     C                     MOVEL'SEW5257' ZAMSID
505500200529     C                     EXSR SRSMSG
505600200529     C                     END
505700200529      *
505800200529     C                     MOVE SNAL2     WWLI33 33
505900200529     C           WWLI02    IFEQ '//'
506000200529     C           WWLI33    ANDEQ*BLANKS
506100200529     C                     SETON                     4275
506200200529     C                     MOVEL'SEW5213' ZAMSID
506300200529     C                     EXSR SRSMSG
506400200529     C                     END
506500200529      *
506600200529     C           SNAL2     IFEQ SNAL1
506700200529     C                     SETON                     4275
506800200529     C                     MOVEL'SEW5258' ZAMSID
506900200529     C                     EXSR SRSMSG
507000200529     C                     END
507100200529      *
507200200529     C                     ELSE
507300200529      ** May not be Blank as a Continuation Line
507400200529     C                     MOVELSNAL2     WWLI02
507500200529     C           WWNAL1    IFEQ '/'
507600200529     C           WWLI02    ANDNE'//'
507700200529     C                     SETON                     4275
507800200529     C                     MOVEL'SEW5214' ZAMSID
507900200529     C                     EXSR SRSMSG
508000200529     C                     END
508100200529     C                     END
508200200529      *
508300200529     C                     ENDSR
508400200529      *
508500200529      *****************************************************************
508600200529      /EJECT
508700200529      *****************************************************************
508800200529      **                                                              *
508900200529      **  SRIPYN    - Validate Instructing Party :82:                 *
509000200529      **                                                              *
509100200529      **  Calls     - SRCUST                                          *
509200200529      **  Called By - SRVAL                                           *
509300200529      **                                                              *
509400200529      *****************************************************************
509500200529      *
509600200529     C           SRIPYN    BEGSR
509700200529      *
509800200529      ** Validate If not Blank
509900200529     C           SIPYN     IFNE *BLANKS
510000200529      *
510100200529      ** This Field may not be used when Clearance Type is 1 to 4
510200200529      ** and MT510 is not required
510300200529     C           WWCLTY    IFEQ '14'
510400200529     C********** PGMEC     ANDNE'Y'                                                           212937
510500200529     C           PSNEW     ANDNE'Y'                                                           212937
510600200529     C********** WWCLTY    OREQ '14'                                                          204917
510700200529     C********** PCCID     ANDNE'C'                                                           204917
510800200529     C                     SETON                     4375
510900200529     C                     MOVEL'SEW5267' ZAMSID
511000200529     C                     EXSR SRSMSG
511100200529     C                     END
511200200529      *
511300200529      ** Set Error Indicator ON this Field before Validation.
511400200529     C           *IN43     IFEQ *OFF
511500200529     C                     SETON                     43
511600200529      *
511700200529      ** Validate Customer Number/Shortname/Nostro
511800200529     C                     MOVE SIPYN     WWCUST
511900200529     C                     EXSR SRCUST
512000200529     C                     MOVELBBCUST    SIPYN                                             AR589193
512100200529      *
512200200529      ** Reset Error Indicator If field is Valid
512300200529     C           WWCUSS    IFEQ 'C'
512400200529     C           WWCUSS    OREQ 'S'
512500200529     C           WWCUSS    OREQ 'N'
512600200529     C                     SETOF                     43
512700200529     C                     END
512800200529      *
512900200529      ** Customer Number/Shortname
513000200529     C           WWCUSS    IFEQ 'C'
513100200529     C           WWCUSS    OREQ 'S'
513200200529     C                     MOVELBBCUST    WWIPYN
513300200529     C                     END
513400200529     C                     END
513500200529      *
513600200529      ** Nostro
513700200529     C           WWCUSS    IFEQ 'N'
513800200529     C                     MOVELAWCPNC    WWIPYN
513900200529     C                     END
514000200529      *
514100200529     C                     ELSE
514200200529      *
514300200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
514400200529     C                     MOVE *BLANKS   WWIPYN
514500200529     C                     END
514600200529      *
514700200529     C                     ENDSR
514800200529      *
514900200529      *****************************************************************
515000200529      /EJECT
515100200529      *****************************************************************
515200200529      **                                                              *
515300200529      **  SRIPYL    - Validate Instructing Party A/c Line :82:        *
515400200529      **                                                              *
515500200529      **  Calls     - SRSMSG                                          *
515600200529      **  Called By - SRVAL                                           *
515700200529      **                                                              *
515800200529      *****************************************************************
515900200529      *
516000200529     C           SRIPYL    BEGSR
516100200529      *
516200200529      ** Validate If not Blank
516300200529     C                     MOVELSIPYL     WWIPYL  1
516400200529     C           SIPYL     IFNE *BLANKS
516500200529     C           WWIPYL    ANDNE'#'
516600200529      *
516700200529     C           WWCLTY    IFEQ '14'
516800200529     C           PGMEC     ANDNE'Y'
516900200529     C           WWCLTY    OREQ '14'
517000200529     C           PCCID     ANDNE'C'
517100200529     C                     SETON                     4475
517200200529     C           SIPYN     IFEQ *BLANKS
517300200529     C                     MOVEL'SEW5267' ZAMSID
517400200529     C                     EXSR SRSMSG
517500200529     C                     END
517600200529     C                     END
517700200529      *
517800200529     C           WWIPYL    IFNE '/'
517900200529     C                     SETON                     4475
518000200529     C                     MOVEL'SEW5210' ZAMSID
518100200529     C                     EXSR SRSMSG
518200200529     C                     END
518300200529      *
518400200529     C                     MOVELSIPYL     WWLI02
518500200529     C           WWLI02    IFEQ '//'
518600200529     C                     SETON                     4475
518700200529     C                     MOVEL'SEW5211' ZAMSID
518800200529     C                     EXSR SRSMSG
518900200529     C                     END
519000200529      *
519100200529     C                     MOVE SIPYL     WWLI34
519200200529     C           WWLI01    IFEQ '/'
519300200529     C           WWLI34    ANDEQ*BLANKS
519400200529     C                     SETON                     4475
519500200529     C                     MOVEL'SEW5212' ZAMSID
519600200529     C                     EXSR SRSMSG
519700200529     C                     END
519800200529      *
519900200529     C                     END
520000200529      *
520100200529     C                     ENDSR
520200200529      *
520300200529      *****************************************************************
520400200529      /EJECT
520500200529      *****************************************************************
520600200529      **                                                              *
520700200529      **  SRCTYN    - Validate Counterparty :82:                      *
520800200529      **                                                              *
520900200529      **  Calls     - SRCUST                                          *
521000200529      **  Called By - SRVAL                                           *
521100200529      **                                                              *
521200200529      *****************************************************************
521300200529      *
521400200529     C           SRCTYN    BEGSR
521500200529      *
521600200529      ** Validate If not Blank
521700200529     C           SCTYN     IFNE *BLANKS
521800200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
521900200529      *
522000200529      ** this Field may only be used to generate a MT512
522100200529     C           PGMEC     IFNE 'Y'
522200200529     C           PCCID     ORNE 'P'
522300200529     C                     SETON                     4575
522400200529     C                     MOVEL'SEW5207' ZAMSID
522500200529     C                     EXSR SRSMSG
522600200529     C                     END
522700200529      *
522800200529      ** Set Error Indicator ON this Field before Validation.
522900200529     C           *IN45     IFEQ *OFF
523000200529     C                     SETON                     45
523100200529      *
523200200529      ** Validate Customer Number/Shortname/Nostro
523300200529     C                     MOVE SCTYN     WWCUST
523400200529     C                     EXSR SRCUST
523500200529     C                     MOVELBBCUST    SCTYN                                             AR589193
523600200529      *
523700200529      ** Reset Error Indicator If field is Valid
523800200529     C           WWCUSS    IFEQ 'C'
523900200529     C           WWCUSS    OREQ 'S'
524000200529     C           WWCUSS    OREQ 'N'
524100200529     C                     SETOF                     45
524200200529     C                     END
524300200529      *
524400200529      ** Customer Number/Shortname
524500200529     C           WWCUSS    IFEQ 'C'
524600200529     C           WWCUSS    OREQ 'S'
524700200529     C                     MOVELBBCUST    WWCTYN
524800200529     C                     END
524900200529      *
525000200529      ** Nostro
525100200529     C           WWCUSS    IFEQ 'N'
525200200529     C                     MOVELAWCPNC    WWCTYN
525300200529     C                     END
525400200529     C                     END
525500200529      *
525600200529     C                     ELSE
525700200529      *
525800200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
525900200529     C                     MOVE *BLANKS   WWCTYN
526000200529     C                     END
526100200529      *
526200200529     C                     ENDSR
526300200529      *
526400200529      *****************************************************************
526500200529      /EJECT
526600200529      *****************************************************************
526700200529      **                                                              *
526800200529      **  SRCTYL    - Validate Counterparty A/c Line :82:             *
526900200529      **                                                              *
527000200529      **  Calls     - SRSMSG                                          *
527100200529      **  Called By - SRVAL                                           *
527200200529      **                                                              *
527300200529      *****************************************************************
527400200529      *
527500200529     C           SRCTYL    BEGSR
527600200529      *
527700200529      ** Validate If not Blank
527800200529     C                     MOVELSCTYL     WWCTYL  1
527900200529     C           SCTYL     IFNE *BLANKS
528000200529     C           WWCTYL    ANDNE'#'
528100200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
528200200529      *
528300200529     C           PGMEC     IFNE 'Y'
528400200529     C           PCCID     ORNE 'P'
528500200529     C                     SETON                     4675
528600200529     C           SCTYN     IFEQ *BLANKS
528700200529     C                     MOVEL'SEW5207' ZAMSID
528800200529     C                     EXSR SRSMSG
528900200529     C                     END
529000200529     C                     END
529100200529      *
529200200529     C           WWCTYL    IFNE '/'
529300200529     C                     SETON                     4675
529400200529     C                     MOVEL'SEW5210' ZAMSID
529500200529     C                     EXSR SRSMSG
529600200529     C                     END
529700200529      *
529800200529     C                     MOVELSCTYL     WWLI02
529900200529     C           WWLI02    IFEQ '//'
530000200529     C                     SETON                     4675
530100200529     C                     MOVEL'SEW5211' ZAMSID
530200200529     C                     EXSR SRSMSG
530300200529     C                     END
530400200529      *
530500200529     C                     MOVE SCTYL     WWLI34
530600200529     C           WWLI01    IFEQ '/'
530700200529     C           WWLI34    ANDEQ*BLANKS
530800200529     C                     SETON                     4675
530900200529     C                     MOVEL'SEW5212' ZAMSID
531000200529     C                     EXSR SRSMSG
531100200529     C                     END
531200200529      *
531300200529     C                     END
531400200529      *
531500200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
531600200529     C                     MOVE *BLANKS   SCTYL                           CSW098
531700200529     C                     ENDIF                                          CSW098
531800200529      *                                                                   CSW098
531900200529     C                     ENDSR
532000200529      *
532100200529      *****************************************************************
532200200529      /EJECT
532300200529      *****************************************************************
532400200529      **                                                              *
532500200529      **  SRSA1N    - Validate Safekeeping Account :83: (MT510)       *
532600200529      **                                                              *
532700200529      **  Calls     - SRCUST                                          *
532800200529      **  Called By - SRVAL                                           *
532900200529      **                                                              *
533000200529      *****************************************************************
533100200529      *
533200200529     C           SRSA1N    BEGSR
533300200529      **********                                                                       201429 209890
533400200529      ***Counterparty*is*mandatory*if*first*intermediary*is*entered***                 201429 209890
533500200529      **********                                                                       201429 209890
533600200529     C********** SSA1N     IFEQ *BLANKS                                                201429 209890
533700200529     C********** *IN78     ANDEQ*ON                                                    201429 209890
533800200529     C********** PIMMD1    ANDNE*BLANKS                                                201429 204592
533900200529     C********** PTDTP     IFEQ 'TP'                                                   204592 209890
534000200529     C********** PDELF     ANDNE0                                                      204592 209890
534100200529     C**********           MOVELPDELF     SSA1N                                        204592 209890
534200200529     C**********           ELSE                                                        204592 209890
534300200529     C********** PTDTP     IFEQ 'TS'                                                   204592 209890
534400200529     C********** PDELT     ANDNE0                                                      204592 209890
534500200529     C**********           MOVELPDELT     SSA1N                                        204592 209890
534600200529     C**********           ELSE                                                        204592 209890
534700200529     C**********           MOVE '1'       *IN75                                        201429 209890
534800200529     C**********           MOVE '1'       *IN47                                        201429 209890
534900200529     C**********           MOVEL'SEW9008' ZAMSID                                       201429 209890
535000200529     C**********           MOVEL'SEUSRMSG'ZAMSGF                                       201429 209890
535100200529     C**********           EXSR SRSMSG                                                 201429 209890
535200200529     C**********           ENDIF                                                       204592 209890
535300200529     C**********           ENDIF                                                       204592 209890
535400200529     C**********           ENDIF                                                       201429 209890
535500200529      *
535600200529      ** Validate If not Blank
535700200529     C           SSA1N     IFNE *BLANKS
535800200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
535900200529      *                                                                                       201429
536000200529     C           SSA1N     ORNE *BLANKS                                                       201429
536100200529     C           *IN78     ANDEQ*ON                                                           201429
536200200529      *
536300200529      ** This Field may only be used to generate a MT510
536400200529     C           PGMEC     IFNE 'Y'
536500200529     C           SWRTN     ANDNE'CSW098'                                                      201429
536600200529     C           PCCID     ORNE 'C'
536700200529     C           SWRTN     ANDNE'CSW098'                                                      201429
536800200529     C                     SETON                     4775
536900200529     C                     MOVEL'SEW5206' ZAMSID
537000200529     C                     EXSR SRSMSG
537100200529     C                     END
537200200529      *
537300200529      ** Set Error Indicator ON this Field before Validation.
537400200529     C           *IN47     IFEQ *OFF
537500200529     C                     SETON                     47
537600200529      *
537700200529      ** Validate Customer Number/Shortname/Nostro
537800200529     C                     MOVE SSA1N     WWCUST
537900200529     C                     EXSR SRCUST
538000200529      *
538100200529      ** Reset Error Indicator If field is Valid
538200200529     C           WWCUSS    IFEQ 'C'
538300200529     C           WWCUSS    OREQ 'S'
538400200529     C           WWCUSS    OREQ 'N'
538500200529     C                     SETOF                     47
538600200529     C                     END
538700200529      *
538800200529      ** Customer Number/Shortname
538900200529     C           WWCUSS    IFEQ 'C'
539000200529     C           WWCUSS    OREQ 'S'
539100200529     C                     MOVELBBCUST    WWSA1N
539200200529     C                     END
539300200529      *
539400200529      ** Nostro
539500200529     C           WWCUSS    IFEQ 'N'
539600200529     C                     MOVELAWCPNC    WWSA1N
539700200529     C                     END
539800200529     C                     END
539900200529      *
540000200529     C                     ELSE
540100200529      *
540200200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
540300200529     C                     MOVE *BLANKS   WWSA1N
540400200529     C                     END
540500200529      *
540600200529     C                     ENDSR
540700200529      *
540800200529      *****************************************************************
540900200529      /EJECT
541000200529      *****************************************************************
541100200529      **                                                              *
541200200529      **  SRSA1L    - Validate Safekeeping Account A/c Line :83:      *
541300200529      **              (MT510)                                         *
541400200529      **                                                              *
541500200529      **  Calls     - SRSMSG                                          *
541600200529      **  Called By - SRVAL                                           *
541700200529      **                                                              *
541800200529      *****************************************************************
541900200529      *
542000200529     C           SRSA1L    BEGSR
542100200529      *
542200200529      ** SSA1L If not Blank
542300200529     C           SSA1L     IFNE *BLANKS
542400200529      *
542500200529     C           PGMEC     IFNE 'Y'
542600200529     C           *IN78     ANDEQ*OFF                                                          201429
542700200529     C           PCCID     ORNE 'C'
542800200529     C           *IN78     ANDEQ*OFF                                                          201429
542900200529     C                     SETON                     4875
543000200529     C           SSA1N     IFEQ *BLANKS
543100200529     C           SWRTN     ANDNE'CSW098 '                                 CSW098
543200200529     C                     MOVEL'SEW5206' ZAMSID
543300200529     C                     EXSR SRSMSG
543400200529     C                     END
543500200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
543600200529     C                     MOVEL'SEW5177' ZAMSID                          CSW098
543700200529     C                     EXSR SRSMSG                                    CSW098
543800200529     C                     ENDIF                                          CSW098
543900200529     C                     END
544000200529      *
544100200529     C                     MOVELSSA1L     WWSA1L  1
544200200529     C           WWSA1L    IFNE '/'
544300200529     C                     SETON                     4675
544400200529     C                     MOVEL'SEW5210' ZAMSID
544500200529     C                     EXSR SRSMSG
544600200529     C                     END
544700200529      *
544800200529     C                     MOVELSSA1L     WWLI02
544900200529     C           WWLI02    IFEQ '//'
545000200529     C                     SETON                     4875
545100200529     C                     MOVEL'SEW5211' ZAMSID
545200200529     C                     EXSR SRSMSG
545300200529     C                     END
545400200529      *
545500200529     C                     END
545600200529      *
545700200529      ** For a Confirmation of Purchase, Either Field 83 or 87 may
545800200529      ** be present.
545900200529     C***********PTDTP     IFEQ 'TP'                                      CSW003
546000200529     C           WTDTP     IFEQ 'TP'                                      CSW003
546100200529     C           SSA1N     ANDNE*BLANKS
546200200529     C           SWRTN     ANDNE'CSW098  '                                CSW098
546300200529     C***********PTDTP     OREQ 'TP'                                      CSW003
546400200529     C           WTDTP     OREQ 'TP'                                      CSW003
546500200529     C           SSA1L     ANDNE*BLANKS
546600200529      *
546700200529     C           SRSSN     IFNE *BLANKS
546800200529     C           SRSS1     ORNE *BLANKS
546900200529     C           SDSSN     ORNE *BLANKS
547000200529     C           SDSS1     ORNE *BLANKS
547100200529     C                     SETON                     474875
547200200529     C                     MOVEL'SEW5270' ZAMSID
547300200529     C                     EXSR SRSMSG
547400200529     C                     END
547500200529     C                     END
547600200529      *
547700200529     C                     ENDSR
547800200529      *
547900200529      *****************************************************************
548000200529      /EJECT
548100200529      *****************************************************************
548200200529      **                                                              *
548300200529      **  SRSKAN    - Validate Safekeeping Account :83:               *
548400200529      **                                                              *
548500200529      **  Calls     - SRCUST                                          *
548600200529      **  Called By - SRVAL                                           *
548700200529      **                                                              *
548800200529      *****************************************************************
548900200529      *
549000200529     C           SRSKAN    BEGSR
549100200529      *                                                                                       204592
549200200529     C           PTDTP     IFEQ 'TP'                                                          204592
549300200529     C********** PDELT     ANDNE0                                                      204592 CSD027
549400200529     C           PDELT     ANDNE*BLANKS                                                       CSD027
549500200529     C                     MOVELPDELT     SSKAN                                               204592
549600200529     C                     ELSE                                                               204592
549700200529     C           PTDTP     IFEQ 'TS'                                                          204592
549800200529     C********** PDELF     ANDNE0                                                      204592 CSD027
549900200529     C           PDELF     ANDNE*BLANKS                                                       CSD027
550000200529     C                     MOVELPDELF     SSKAN                                               204592
550100200529     C                     ENDIF                                                              204592
550200200529     C                     ENDIF                                                              204592
550300200529      *
550400200529      ** Validate If not Blank
550500200529     C           SSKAN     IFNE *BLANKS
550600200529      *
550700200529      ** Safekeeping Account must be left Blank for Clearance 1 to 4
550800200529      ** (Safekeeping Account must be Entered on first Screen)
550900200529     C           WWCLTY    IFEQ '14'
551000200529     C                     SETON                     4975
551100200529     C                     MOVEL'SEW5272' ZAMSID
551200200529     C                     EXSR SRSMSG
551300200529      *
551400200529     C                     ELSE
551500200529      ** Set Error Indicator ON this Field before Validation
551600200529     C                     SETON                     49
551700200529      *
551800200529      ** Validate Customer Number/Shortname/Nostro
551900200529     C                     MOVE SSKAN     WWCUST
552000200529     C                     EXSR SRCUST
552100200529      *
552200200529      ** Reset Error Indicator If field is Valid
552300200529     C           WWCUSS    IFEQ 'C'
552400200529     C           WWCUSS    OREQ 'S'
552500200529     C           WWCUSS    OREQ 'N'
552600200529     C                     SETOF                     49
552700200529     C                     END
552800200529      *
552900200529      ** Customer Number/Shortname
553000200529     C           WWCUSS    IFEQ 'C'
553100200529     C           WWCUSS    OREQ 'S'
553200200529     C                     MOVELBBCUST    WWSKAN
553300200529     C                     END
553400200529      *
553500200529      ** Nostro
553600200529     C           WWCUSS    IFEQ 'N'
553700200529     C                     MOVELAWCPNC    WWSKAN
553800200529     C                     END
553900200529      *
554000200529     C                     END
554100200529      *
554200200529     C                     ELSE
554300200529      *
554400200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
554500200529     C                     MOVE *BLANKS   WWSKAN
554600200529     C                     END
554700200529      *
554800200529     C                     ENDSR
554900200529      *
555000200529      *****************************************************************
555100200529      /EJECT
555200200529      *****************************************************************
555300200529      **                                                              *
555400200529      **  SRSKAL    - Validate Safekeeping Account A/c Line :83:      *
555500200529      **                                                              *
555600200529      **  Calls     - SRSMSG                                          *
555700200529      **  Called By - SRVAL                                           *
555800200529      **                                                              *
555900200529      *****************************************************************
556000200529      *
556100200529     C           SRSKAL    BEGSR
556200200529     C/COPY WNCPYSRC,SE1806C009
556300200529      *
556400200529      ** Validate If not Blank
556500200529     C                     MOVELSSKAL     WWSKAL  1
556600200529     C           SSKAL     IFNE *BLANKS
556700200529     C           WWSKAL    ANDNE'#'
556800200529      *
556900200529      ** Safekeeping Account must be left Blank for Clearance 1 to 4
557000200529      ** (Safekeeping Account must be Entered on First Screen)
557100200529     C           WWCLTY    IFEQ '14'
557200200529     C                     SETON                     5075
557300200529     C                     MOVEL'SEW5272' ZAMSID
557400200529     C/COPY WNCPYSRC,SE1806C010
557500200529     C                     EXSR SRSMSG
557600200529     C/COPY WNCPYSRC,SE1806C011
557700200529      *
557800200529     C                     ELSE
557900200529      ** Override by F18
558000200529     C           PSENT     IFEQ 'CEDEL'
558100200529     C           *INKS     ANDEQ*ON
558200200529     C           OVER6     ANDEQ'1'
558300200529     C                     MOVE *OFF      *INKS
558400200529     C                     MOVE 'Y'       OVER6
558500200529     C                     END
558600200529      *
558700200529      ** If not Overridden
558800200529     C           OVER6     IFNE 'Y'
558900200529      *
559000200529     C           WWSKAL    IFNE '/'
559100200529     C                     SETON                     5075
559200200529     C                     MOVE '1'       OVER6
559300200529     C                     MOVEL'SEW5210' ZAMSID
559400200529     C/COPY WNCPYSRC,SE1806C012
559500200529     C                     EXSR SRSMSG
559600200529     C/COPY WNCPYSRC,SE1806C013
559700200529     C                     END
559800200529      *
559900200529     C                     MOVELSSKAL     WWLI02
560000200529     C           WWLI02    IFEQ '//'
560100200529     C                     SETON                     5075
560200200529     C                     MOVE '1'       OVER6
560300200529     C                     MOVEL'SEW5211' ZAMSID
560400200529     C                     EXSR SRSMSG
560500200529     C                     END
560600200529      *
560700200529     C                     MOVE SSKAL     WWLI34
560800200529     C           WWLI01    IFEQ '/'
560900200529     C           WWLI34    ANDEQ*BLANKS
561000200529     C                     SETON                     5075
561100200529     C                     MOVE '1'       OVER6
561200200529     C                     MOVEL'SEW5212' ZAMSID
561300200529     C/COPY WNCPYSRC,SE1806C014
561400200529     C                     EXSR SRSMSG
561500200529     C/COPY WNCPYSRC,SE1806C015
561600200529     C                     END
561700200529      *
561800200529     C                     END
561900200529     C                     END
562000200529     C                     END
562100200529      *
562200200529     C/COPY WNCPYSRC,SE1806C016
562300200529     C                     ENDSR
562400200529      *
562500200529      *****************************************************************
562600200529      /EJECT
562700200529      *****************************************************************
562800200529      **                                                              *
562900200529      **  SRCCTN    - Validate Clearing Correspondent :84:            *
563000200529      **                                                              *
563100200529      **  Calls     - SRCUST                                          *
563200200529      **  Called By - SRVAL                                           *
563300200529      **                                                              *
563400200529      *****************************************************************
563500200529      *
563600200529     C           SRCCTN    BEGSR
563700200529      *
563800200529      ** Validate If not Blank
563900200529     C           SCCTN     IFNE *BLANKS
564000200529      *
564100200529      ** Clearance Type must be 1, 2, 3 or 4
564200200529     C           WWCLTY    IFNE '14'
564300200529     C           PSNEW     ANDNE'Y'                                                           212937
564400200529     C                     SETON                     5175
564500200529     C                     MOVEL'SEW5275' ZAMSID
564600200529     C                     EXSR SRSMSG
564700200529     C                     END
564800200529      ***********                                                                             204804
564900200529      ***Check*Entry*is*Alphanumeric*with*no*embedded*Blanks***********                       204804
565000200529     C***********          MOVEASCCTN     CCO                                                 204804
565100200529     C***********          SETOF                     82                                       204804
565200200529     C***********          Z-ADD0         I       20                                          204804
565300200529     C***********I         DOWLE7                                                             204804
565400200529     C************IN51     ANDEQ*OFF                                                          204804
565500200529     C***********          ADD  1         I                                                   204804
565600200529     C***********CCO,I     IFEQ ' '                                                           204804
565700200529     C***********          SETON                     51                                       204804
565800200529     C***********          ELSE                                                               204804
565900200529     C***********CCO,I     LOKUPVA0                      82                                   204804
566000200529     C************IN82     IFEQ *OFF                                                          204804
566100200529     C***********          SETON                     51                                       204804
566200200529     C***********          END                                                                204804
566300200529     C***********          END                                                                204804
566400200529     C***********          END                                                                204804
566500200529      *
566600200529     C                     MOVELSCCTN     WKVAR  10                                           204804
566700200529     C                     CALL 'AOCUSTR0'                                                    204804
566800200529     C                     PARM *BLANKS   WKRTCD  7                                           204804
566900200529     C                     PARM '*KEY   ' WKOPTN  7                                           204804
567000200529     C                     PARM           WKVAR                                               204804
567100200529     C                     PARM           WKYSTS  7                                           204804
567200200529     C           SDCUST    PARM SDCUST    DSSDY                                               204804
567300200529      *                                                                                       204804
567400200529     C           WKRTCD    IFEQ *BLANK                                                        204804
567500200529     C           WKYSTS    ANDNE'*ERROR'                                                      204804
567600200529     C                     MOVELBBCSID    SCCTN                                               204804
567700200529      *                                                                                       204804
567800200529     C                     ELSE                                                               204804
567900200529      *                                                                                       204804
568000200529     C           *LOVAL    SETLLSDCUSTSW                                                      204804
568100200529     C           SCCTN     CHAINSDCUSTSW             99                                       204804
568200200529     C           *IN99     IFEQ *ON                                                           204804
568300200529      *                                                                                       204804
568400200529      ** Check if SWIFT Address exist in BIC file                                             204804
568500200529      *                                                                                       204804
568600200529     C                     CALL 'AOBICDV0'                                                    204804
568700200529     C                     PARM *BLANKS   @CRTCD  7                                           204804
568800200529     C                     PARM           SCCTN                                               204804
568900200529     C                     PARM           @CTYPE  7                                           204804
569000200529     C                     PARM           DSSDY                                               204804
569100200529     C           @CRTCD    IFNE '*BICFND'                                                     204804
569200200529     C           @CTYPE    ANDNE'*BIC'                                                        204804
569300200529     C                     MOVE '1'       *IN51                                               204804
569400200529     C                     ENDIF                                                              204804
569500200529     C                     ENDIF                                                              204804
569600200529     C                     ENDIF                                                              204804
569700200529      *                                                                                       204804
569800200529     C           *IN51     IFEQ *ON
569900200529     C                     SETON                     75
570000200529     C                     MOVEL'SEW5276' ZAMSID
570100200529     C                     EXSR SRSMSG
570200200529     C                     END
570300200529      *
570400200529     C                     END
570500200529      *
570600200529     C                     ENDSR
570700200529      *
570800200529      *****************************************************************
570900200529      /EJECT
571000200529      *****************************************************************
571100200529      **                                                              *
571200200529      **  SRDCTL    - Validate Deliver's Instructing Party :85:       *
571300200529      **                                                              *
571400200529      **  Calls     - SRSMSG                                          *
571500200529      **  Called By - SRVAL                                           *
571600200529      **                                                              *
571700200529      *****************************************************************
571800200529      *
571900200529     C           SRDCTL    BEGSR
572000200529      *
572100200529      ** Validate If not Blank
572200200529     C           SDCTL     IFNE *BLANKS
572300200529      *
572400200529      ***Clearance*Type*must*be*1,*2,*3*or*4************                  CSW003
572500200529     C***********WWCLTY    IFNE '14'                                      CSW003
572600200529     C***********          SETON                     5275                 CSW003
572700200529     C***********          MOVEL'SEW5280' ZAMSID                          CSW003
572800200529     C***********          EXSR SRSMSG                                    CSW003
572900200529     C***********          END                                            CSW003
573000200529      *
573100200529      ** SDCTL must start with a Slash "/" followed by 5 Digits
573200200529     C                     MOVELSDCTL     WWLI01
573300200529     C                     MOVE SDCTL     WWLI05
573400200529     C                     MOVELWWLI05    WWNUM6  60
573500200529     C                     MOVELWWNUM6    WWALF5  5
573600200529     C           WWLI05    IFNE WWALF5
573700200529     C           WWLI01    ORNE '/'
573800200529     C                     SETON                     5275
573900200529     C                     MOVEL'SEW5281' ZAMSID
574000200529     C                     EXSR SRSMSG
574100200529     C                     END
574200200529      *
574300200529     C                     END
574400200529      *
574500200529     C                     ENDSR
574600200529      *
574700200529     C/COPY WNCPYSRC,SE1806C054
574800200529      *****************************************************************
574900200529      /EJECT
575000200529      *****************************************************************
575100200529      **                                                              *
575200200529      **  SRRSSA    - Validate Receiver of Securities TAG :87:        *
575300200529      **                                                              *
575400200529      **  Calls     -                                                 *
575500200529      **  Called By - SRVAL                                           *
575600200529      **                                                              *
575700200529      *****************************************************************
575800200529      *
575900200529     C           SRRSSA    BEGSR
576000200529      *
576100200529      ** this Field can only be Entered for Clearance Type 1 to 4
576200200529     C           WWCLTY    IFEQ '14'
576300200529      *
576400200529     C           SRSSA     IFNE 'C'
576500200529     C           SRSSA     ANDNE'D'
576600200529     C           SRSSA     ANDNE*BLANK
576700200529     C                     SETON                     5375
576800200529     C                     MOVEL'SEW5223' ZAMSID
576900200529     C                     EXSR SRSMSG
577000200529     C                     END
577100200529      *
577200200529      ** The A/c Lines may not be left Blank when Entering the TAG Field
577300200529     C           SRSSA     IFNE *BLANK
577400200529     C           SRSS1     ANDEQ*BLANK
577500200529     C                     SETON                     5575
577600200529     C                     MOVEL'SEW5227' ZAMSID
577700200529     C                     EXSR SRSMSG
577800200529     C                     END
577900200529      *
578000200529     C                     ELSE
578100200529      ** This Field must be left Blank If Clearance Type not 1 to 4
578200200529     C           SRSSA     IFNE *BLANK
578300200529     C                     SETON                     5375
578400200529     C                     MOVEL'SEW5221' ZAMSID
578500200529     C                     EXSR SRSMSG
578600200529     C                     END
578700200529     C                     END
578800200529      *
578900200529     C                     ENDSR
579000200529      *
579100200529      *****************************************************************
579200200529      /EJECT
579300200529      *****************************************************************
579400200529      **                                                              *
579500200529      **  SRRSSN    - Validate Receiver of Securities :87:            *
579600200529      **                                                              *
579700200529      **  Calls     - SRCUST                                          *
579800200529      **  Called By - SRVAL                                           *
579900200529      **                                                              *
580000200529      *****************************************************************
580100200529      *
580200200529     C           SRRSSN    BEGSR
580300200529      **********                                                                       201429 209949
580400200529      ***Receiver*of*securities*is*mandatory*is*ISO15022*is*'Y'********                201429 209949
580500200529      ***and*trade*type*is*'Trade*Sell'.*******************************                201429 209949
580600200529      **********                                                                       201429 209949
580700200529     C********** *IN78     IFEQ *ON                                                    201429 209949
580800200529     C********** PTDTP     ANDEQ'TS'                                                   201429 209949
580900200529     C********** SRSSN     ANDEQ*BLANKS                                                201429 209949
581000200529     C********** *IN08     ANDEQ*OFF                                                   201429 209949
581100200529     C********** PDELT     IFNE 0                                                      204550 209949
581200200529     C**********           MOVELPDELT     SRSSN                                        204550 209949
581300200529     C**********           ELSE                                                        204550 209949
581400200529     C**********           MOVE '1'       *IN75                                        201429 209949
581500200529     C**********           MOVE '1'       *IN54                                        201429 209949
581600200529     C**********           MOVEL'SEW9006' ZAMSID                                       201429 209949
581700200529     C**********           EXSR SRSMSG                                                 201429 209949
581800200529     C**********           ENDIF                                                       204550 209949
581900200529     C**********           ENDIF                                                       201429 209949
582000200529      *
582100200529      ** Validate If not Blank
582200200529     C           SRSSN     IFNE *BLANKS
582300200529      *
582400200529      ** TAG Field must be left Blank
582500200529     C           SRSSA     IFNE *BLANKS
582600200529     C                     SETON                     5475
582700200529     C                     MOVEL'SEW5228' ZAMSID
582800200529     C                     EXSR SRSMSG
582900200529     C                     END
583000200529      *
583100200529      ** This Field may only be Entered for Receipt Instructions
583200200529      ** Or when a MT512 is required
583300200529     C***********PTDTP     IFEQ 'TP'                                      CSW003
583400200529     C           WTDTP     IFEQ 'TP'                                      CSW003
583500200529     C           PGMEC     ANDNE'Y'
583600200529     C***********PTDTP     OREQ 'TP'                                      CSW003
583700200529     C           WTDTP     OREQ 'TP'                                      CSW003
583800200529     C           PCCID     ANDNE'P'
583900200529     C                     SETON                     5475
584000200529     C                     MOVEL'SEW5291' ZAMSID
584100200529     C                     EXSR SRSMSG
584200200529     C                     END
584300200529      *
584400200529      ** Set On Error Indicator for this Field before Validation
584500200529     C           *IN54     IFEQ *OFF
584600200529     C                     SETON                     54
584700200529      *
584800200529      ** Validate Customer Number/Shortname/Nostro
584900200529     C                     MOVE SRSSN     WWCUST
585000200529     C                     EXSR SRCUST
585100200529      *
585200200529      ** Reset Error Indicator If field is Valid
585300200529     C           WWCUSS    IFEQ 'C'
585400200529     C           WWCUSS    OREQ 'S'
585500200529     C           WWCUSS    OREQ 'N'
585600200529     C                     SETOF                     54
585700200529     C                     END
585800200529      *
585900200529      ** Customer Number/Shortname
586000200529     C           WWCUSS    IFEQ 'C'
586100200529     C           WWCUSS    OREQ 'S'
586200200529     C                     MOVELBBCUST    WWRSSN
586300200529     C                     END
586400200529      *
586500200529      ** Nostro
586600200529     C           WWCUSS    IFEQ 'N'
586700200529     C                     MOVELAWCPNC    WWRSSN
586800200529     C                     END
586900200529     C                     END
587000200529      *
587100200529     C                     ELSE
587200200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
587300200529     C                     MOVE *BLANKS   WWRSSN
587400200529     C                     END
587500200529      *
587600200529     C                     ENDSR
587700200529      *
587800200529      *****************************************************************
587900200529      /EJECT
588000200529      *****************************************************************
588100200529      **                                                              *
588200200529      **  SRRSS1    - Validate Receiver of Securities A/c Line 1 :87: *
588300200529      **                                                              *
588400200529      **  Calls     - SRSMSG                                          *
588500200529      **  Called By - SRVAL                                           *
588600200529      **                                                              *
588700200529      *****************************************************************
588800200529      *
588900200529     C           SRRSS1    BEGSR
589000200529      *
589100200529      ** Validate If not Blank
589200200529     C                     MOVELSRSS1     WWRSS1  1
589300200529     C           SRSS1     IFNE *BLANKS
589400200529     C           WWRSS1    ANDNE'#'
589500200529      *
589600200529      ** Override by F18
589700200529     C           PSENT     IFEQ 'CEDEL'
589800200529     C           *INKS     ANDEQ*ON
589900200529     C           OVER7     ANDEQ'1'
590000200529     C                     MOVE *OFF      *INKS
590100200529     C                     MOVE 'Y'       OVER7
590200200529     C                     END
590300200529      *
590400200529      ** If not Overridden
590500200529     C           OVER7     IFNE 'Y'
590600200529      *
590700200529     C***********PTDTP     IFEQ 'TP'                                      CSW003
590800200529     C           WTDTP     IFEQ 'TP'                                      CSW003
590900200529     C           PGMEC     ANDNE'Y'
591000200529     C***********PTDTP     OREQ 'TP'                                      CSW003
591100200529     C           WTDTP     OREQ 'TP'                                      CSW003
591200200529     C           PCCID     ANDNE'P'
591300200529     C                     SETON                     5575
591400200529     C                     MOVEL'SEW5291' ZAMSID
591500200529     C                     EXSR SRSMSG
591600200529     C                     END
591700200529      *
591800200529     C           WWRSS1    IFNE '/'
591900200529     C                     SETON                     5575
592000200529     C                     MOVE '1'       OVER7
592100200529     C                     MOVEL'SEW5210' ZAMSID
592200200529     C                     EXSR SRSMSG
592300200529     C                     END
592400200529      *
592500200529     C                     MOVELSRSS1     WWLI02
592600200529     C           WWRSS1    IFEQ '//'
592700200529     C                     SETON                     5575
592800200529     C                     MOVE '1'       OVER7
592900200529     C                     MOVEL'SEW5211' ZAMSID
593000200529     C                     EXSR SRSMSG
593100200529     C                     END
593200200529      *
593300200529     C                     MOVE SRSS1     WWLI34
593400200529     C           WWLI01    IFEQ '/'
593500200529     C           WWLI34    ANDEQ*BLANKS
593600200529     C                     SETON                     5575
593700200529     C                     MOVE '1'       OVER7
593800200529     C                     MOVEL'SEW5212' ZAMSID
593900200529     C                     EXSR SRSMSG
594000200529     C                     END
594100200529      *
594200200529     C                     END
594300200529     C                     END
594400200529      *
594500200529     C                     ENDSR
594600200529      *
594700200529      *****************************************************************
594800200529      /EJECT
594900200529      *****************************************************************
595000200529      **                                                              *
595100200529      **  SRRSS2    - Validate Receiver of Securities A/c Line 2 :87: *
595200200529      **                                                              *
595300200529      **  Calls     -                                                 *
595400200529      **  Called By - SRVAL                                           *
595500200529      **                                                              *
595600200529      *****************************************************************
595700200529      *
595800200529     C           SRRSS2    BEGSR
595900200529      *
596000200529      ** Validate If not Blank and not Overridden
596100200529     C                     MOVELSRSS2     WWRSS2  1
596200200529     C           SRSS2     IFNE *BLANKS
596300200529     C           WWRSS2    ANDNE'#'
596400200529     C           OVER7     ANDNE'Y'
596500200529      *
596600200529      ** Override by F18
596700200529     C           PSENT     IFEQ 'CEDEL'
596800200529     C           *INKS     ANDEQ*ON
596900200529     C           OVER7     ANDEQ'1'
597000200529     C                     MOVE *OFF      *INKS
597100200529     C                     MOVE 'Y'       OVER7
597200200529     C                     END
597300200529      *
597400200529      ** If not Overridden
597500200529     C           OVER7     IFNE 'Y'
597600200529      *
597700200529     C           SRSS1     IFEQ *BLANKS
597800200529     C                     SETON                     5675
597900200529     C                     MOVEL'SEW5255' ZAMSID
598000200529     C                     EXSR SRSMSG
598100200529     C                     END
598200200529      *
598300200529     C           SRSS2     IFEQ SRSS1
598400200529     C                     SETON                     5675
598500200529     C                     MOVEL'SEW5258' ZAMSID
598600200529     C                     EXSR SRSMSG
598700200529     C                     END
598800200529      *
598900200529     C                     MOVELSRSS2     WWLI02
599000200529     C                     MOVE SRSS2     WWLI33
599100200529     C           WWLI02    IFNE '//'
599200200529     C           WWLI33    OREQ *BLANKS
599300200529     C                     SETON                     5675
599400200529     C                     MOVE '1'       OVER7
599500200529     C                     MOVEL'SEW5213' ZAMSID
599600200529     C                     EXSR SRSMSG
599700200529     C                     END
599800200529      *
599900200529     C                     END
600000200529     C                     END
600100200529      *
600200200529     C                     ENDSR
600300200529      *
600400200529      *****************************************************************
600500200529      /EJECT
600600200529      *****************************************************************
600700200529      **                                                              *
600800200529      **  SRRSS3    - Validate Receiver of Securities A/c Line 3 :87: *
600900200529      **                                                              *
601000200529      **  Calls     -                                                 *
601100200529      **  Called By - SRVAL                                           *
601200200529      **                                                              *
601300200529      *****************************************************************
601400200529      *
601500200529     C           SRRSS3    BEGSR
601600200529      *
601700200529      ** Validate If not Blank and not Overridden
601800200529     C                     MOVELSRSS3     WWRSS3  1
601900200529     C           SRSS3     IFNE *BLANKS
602000200529     C           WWRSS3    ANDNE'#'
602100200529     C           OVER7     ANDNE'Y'
602200200529      *
602300200529      ** Override by F18
602400200529     C           PSENT     IFEQ 'CEDEL'
602500200529     C           *INKS     ANDEQ*ON
602600200529     C           OVER7     ANDEQ'1'
602700200529     C                     MOVE *OFF      *INKS
602800200529     C                     MOVE 'Y'       OVER7
602900200529     C                     END
603000200529      *
603100200529      ** If not Overridden
603200200529     C           OVER7     IFNE 'Y'
603300200529      *
603400200529     C           SRSS2     IFEQ *BLANKS
603500200529     C                     SETON                     5775
603600200529     C                     MOVEL'SEW5255' ZAMSID
603700200529     C                     EXSR SRSMSG
603800200529     C                     END
603900200529      *
604000200529     C           SRSS3     IFEQ SRSS2
604100200529     C                     SETON                     5775
604200200529     C                     MOVEL'SEW5258' ZAMSID
604300200529     C                     EXSR SRSMSG
604400200529     C                     END
604500200529      *
604600200529     C                     MOVELSRSS3     WWLI02
604700200529     C                     MOVE SRSS3     WWLI33
604800200529     C           WWLI02    IFNE '//'
604900200529     C           WWLI33    OREQ *BLANKS
605000200529     C                     SETON                     5775
605100200529     C                     MOVE '1'       OVER7
605200200529     C                     MOVEL'SEW5213' ZAMSID
605300200529     C                     EXSR SRSMSG
605400200529     C                     END
605500200529      *
605600200529     C                     END
605700200529     C                     END
605800200529      *
605900200529     C                     ENDSR
606000200529      *
606100200529      *****************************************************************
606200200529      /EJECT
606300200529      *****************************************************************
606400200529      **                                                              *
606500200529      **  SRRSS4    - Validate Receiver of Securities A/c Line 4 :87: *
606600200529      **                                                              *
606700200529      **  Calls     -                                                 *
606800200529      **  Called By - SRVAL                                           *
606900200529      **                                                              *
607000200529      *****************************************************************
607100200529      *
607200200529     C           SRRSS4    BEGSR
607300200529      *
607400200529      ** Validate If not Blank and not Overridden
607500200529     C                     MOVELSRSS4     WWRSS4  1
607600200529     C           SRSS4     IFNE *BLANKS
607700200529     C           WWRSS4    ANDNE'#'
607800200529     C           OVER7     ANDNE'Y'
607900200529      *
608000200529      ** Override by F18
608100200529     C           PSENT     IFEQ 'CEDEL'
608200200529     C           *INKS     ANDEQ*ON
608300200529     C           OVER7     ANDEQ'1'
608400200529     C                     MOVE *OFF      *INKS
608500200529     C                     MOVE 'Y'       OVER7
608600200529     C                     END
608700200529      *
608800200529      ** If not Overridden
608900200529     C           OVER7     IFNE 'Y'
609000200529      *
609100200529     C           SRSS3     IFEQ *BLANKS
609200200529     C                     SETON                     5875
609300200529     C                     MOVEL'SEW5255' ZAMSID
609400200529     C                     EXSR SRSMSG
609500200529     C                     END
609600200529      *
609700200529     C           SRSS4     IFEQ SRSS3
609800200529     C                     SETON                     5875
609900200529     C                     MOVEL'SEW5258' ZAMSID
610000200529     C                     EXSR SRSMSG
610100200529     C                     END
610200200529      *
610300200529     C                     MOVELSRSS4     WWLI02
610400200529     C                     MOVE SRSS4     WWLI33
610500200529     C           WWLI02    IFNE '//'
610600200529     C           WWLI33    OREQ *BLANKS
610700200529     C                     SETON                     5875
610800200529     C                     MOVE '1'       OVER7
610900200529     C                     MOVEL'SEW5213' ZAMSID
611000200529     C                     EXSR SRSMSG
611100200529     C                     END
611200200529      *
611300200529     C                     END
611400200529     C                     END
611500200529      *
611600200529     C                     ENDSR
611700200529      *
611800200529      *****************************************************************
611900200529      /EJECT
612000200529      *****************************************************************
612100200529      **                                                              *
612200200529      **  SRDSSA    - Validate Deliverer of Securities TAG :87:       *
612300200529      **                                                              *
612400200529      **  Calls     -                                                 *
612500200529      **  Called By - SRVAL                                           *
612600200529      **                                                              *
612700200529      *****************************************************************
612800200529      *
612900200529     C           SRDSSA    BEGSR
613000200529      *
613100200529      ** this Field can only be Entered for Clearance Type 1 to 4
613200200529     C           WWCLTY    IFEQ '14'
613300200529      *
613400200529     C           SDSSA     IFNE 'C'
613500200529     C           SDSSA     ANDNE'D'
613600200529     C           SDSSA     ANDNE*BLANK
613700200529     C                     SETON                     5975
613800200529     C                     MOVEL'SEW5223' ZAMSID
613900200529     C                     EXSR SRSMSG
614000200529     C                     END
614100200529      *
614200200529      ** The A/c Lines may not be left Blank when Entering the TAG Field
614300200529     C           SDSSA     IFNE *BLANK
614400200529     C           SDSS1     ANDEQ*BLANK
614500200529     C                     SETON                     6175
614600200529     C                     MOVEL'SEW5227' ZAMSID
614700200529     C                     EXSR SRSMSG
614800200529     C                     END
614900200529      *
615000200529     C                     ELSE
615100200529      ** this Field must be left Blank If Clearance Type Not 1 to 4
615200200529     C           SDSSA     IFNE *BLANK
615300200529     C                     SETON                     5975
615400200529     C                     MOVEL'SEW5221' ZAMSID
615500200529     C                     EXSR SRSMSG
615600200529     C                     END
615700200529     C                     END
615800200529      *
615900200529     C                     ENDSR
616000200529      *
616100200529      *****************************************************************
616200200529      /EJECT
616300200529      *****************************************************************
616400200529      **                                                              *
616500200529      **  SRDSSN    - Validate Deliverer of Securities :87:           *
616600200529      **                                                              *
616700200529      **  Calls     - SRCUST                                          *
616800200529      **  Called By - SRVAL                                           *
616900200529      **                                                              *
617000200529      *****************************************************************
617100200529      *
617200200529     C           SRDSSN    BEGSR
617300200529      **********                                                                       201429 209949
617400200529      ***Deliverer*of*securities*is*mandatory*if*ISO15022*is*'Y'*******                201429 209949
617500200529      ***and*type*is*Trade*Purchase.***********************************                201429 209949
617600200529      **********                                                                       201429 209949
617700200529     C********** *IN78     IFEQ *ON                                                    201429 209949
617800200529     C********** PTDTP     ANDEQ'TP'                                                   201429 209949
617900200529     C********** SDSSN     ANDEQ*BLANKS                                                201429 209949
618000200529     C********** *IN07     ANDEQ*OFF                                                   201429 209949
618100200529     C********** PDELF     IFNE 0                                                      204550 209949
618200200529     C**********           MOVELPDELF     SDSSN                                        204550 209949
618300200529     C**********           ELSE                                                        204550 209949
618400200529     C**********           MOVE '1'       *IN75                                        201429 209949
618500200529     C**********           MOVE '1'       *IN60                                        201429 209949
618600200529     C**********           MOVEL'SEW9003' ZAMSID                                       201429 209949
618700200529     C**********           EXSR SRSMSG                                                 201429 209949
618800200529     C**********           ENDIF                                                       204550 209949
618900200529     C**********           ENDIF                                                       201429 209949
619000200529      *
619100200529      ** Validate If not Blank
619200200529     C           SDSSN     IFNE *BLANKS
619300200529      *
619400200529      ** TAG Field must be left Blank
619500200529     C           SDSSA     IFNE *BLANKS
619600200529     C                     SETON                     6075
619700200529     C                     MOVEL'SEW5228' ZAMSID
619800200529     C                     EXSR SRSMSG
619900200529     C                     END
620000200529      *
620100200529      ** This Field may only be Entered for Deliver Instructions
620200200529      ** Or when a MT512 is required
620300200529     C***********PTDTP     IFEQ 'TS'                                      CSW003
620400200529     C           WTDTP     IFEQ 'TS'                                      CSW003
620500200529     C           PGMEC     ANDNE'Y'
620600200529     C***********PTDTP     OREQ 'TS'                                      CSW003
620700200529     C           WTDTP     OREQ 'TS'                                      CSW003
620800200529     C           PCCID     ANDNE'P'
620900200529     C                     SETON                     6075
621000200529     C                     MOVEL'SEW5290' ZAMSID
621100200529     C                     EXSR SRSMSG
621200200529     C                     END
621300200529      *
621400200529      ** Set On Error Indicator for this Field before Validation
621500200529     C           *IN60     IFEQ *OFF
621600200529     C                     SETON                     60
621700200529      *
621800200529      ** Validate Customer Number/Shortname/Nostro
621900200529     C                     MOVE SDSSN     WWCUST
622000200529     C                     EXSR SRCUST
622100200529     C                     MOVELBBCUST    SDSSN                                             AR589193
622200200529      *
622300200529      ** Reset Error Indicator If field is Valid
622400200529     C           WWCUSS    IFEQ 'C'
622500200529     C           WWCUSS    OREQ 'S'
622600200529     C           WWCUSS    OREQ 'N'
622700200529     C                     SETOF                     60
622800200529     C                     END
622900200529      *
623000200529      ** Customer Number/Shortname
623100200529     C           WWCUSS    IFEQ 'C'
623200200529     C           WWCUSS    OREQ 'S'
623300200529     C                     MOVELBBCUST    WWDSSN
623400200529     C                     END
623500200529      *
623600200529      ** Nostro
623700200529     C           WWCUSS    IFEQ 'N'
623800200529     C                     MOVELAWCPNC    WWDSSN
623900200529     C                     END
624000200529     C                     END
624100200529      *
624200200529     C                     ELSE
624300200529     C** ELSE if screen field is blank but account line 1 is not blank    086910
624400200529     C** THEN it is an error.                                             086910
624500200529     C           SDSSN     IFEQ *BLANKS                                   086910
624600200529     C           SDSS1     ANDNE*BLANKS                                   086910
624700200529     C           PSNEW     ANDNE'Y'                                                           209949
624800200529     C                     MOVE '1'       *IN75                           086910
624900200529     C                     MOVE '1'       *IN61                           086910
625000200529     C                     MOVE '1'       OVER8                           086910
625100200529     C                     MOVEL'SEW5208' ZAMSID                          086910
625200200529     C                     MOVEL'SE500MSG'ZAMSGF                          086910
625300200529     C                     EXSR SRSMSG                                    086910
625400200529     C                     ENDIF                                          086910
625500200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
625600200529     C                     MOVE *BLANKS   WWDSSN
625700200529     C                     END
625800200529      *
625900200529     C                     ENDSR
626000200529      *
626100200529      *****************************************************************
626200200529      /EJECT
626300200529      *****************************************************************
626400200529      **                                                              *
626500200529      **  SRDSS1   - Validate Deliverer of Securities A/c Line 1 :87: *
626600200529      **                                                              *
626700200529      **  Calls     - SRSMSG                                          *
626800200529      **  Called By - SRVAL                                           *
626900200529      **                                                              *
627000200529      *****************************************************************
627100200529      *
627200200529     C           SRDSS1    BEGSR
627300200529      *
627400200529      ** Validate If not Blank
627500200529     C                     MOVELSDSS1     WWDSS1  1
627600200529     C           SDSS1     IFNE *BLANKS
627700200529     C           WWDSS1    ANDNE'#'
627800200529      *
627900200529      ** Override by F18
628000200529     C           PSENT     IFEQ 'CEDEL'
628100200529     C           *INKS     ANDEQ*ON
628200200529     C           OVER8     ANDEQ'1'
628300200529     C                     MOVE *OFF      *INKS
628400200529     C                     MOVE 'Y'       OVER8
628500200529     C                     END
628600200529      *
628700200529      ** If not Overridden
628800200529     C           OVER8     IFNE 'Y'
628900200529      *
629000200529     C***********PTDTP     IFEQ 'TS'                                      CSW003
629100200529     C           WTDTP     IFEQ 'TS'                                      CSW003
629200200529     C           PGMEC     ANDNE'Y'
629300200529     C***********PTDTP     OREQ 'TS'                                      CSW003
629400200529     C           WTDTP     OREQ 'TS'                                      CSW003
629500200529     C           PCCID     ANDNE'P'
629600200529     C                     SETON                     6175
629700200529     C                     MOVEL'SEW5290' ZAMSID
629800200529     C                     EXSR SRSMSG
629900200529     C                     END
630000200529      *
630100200529     C           WWDSS1    IFNE '/'
630200200529     C                     SETON                     6175
630300200529     C                     MOVE '1'       OVER8
630400200529     C                     MOVEL'SEW5210' ZAMSID
630500200529     C                     EXSR SRSMSG
630600200529     C                     END
630700200529      *
630800200529     C                     MOVELSDSS1     WWLI02
630900200529     C           WWDSS1    IFEQ '//'
631000200529     C                     SETON                     6175
631100200529     C                     MOVE '1'       OVER8
631200200529     C                     MOVEL'SEW5211' ZAMSID
631300200529     C                     EXSR SRSMSG
631400200529     C                     END
631500200529      *
631600200529     C                     MOVE SDSS1     WWLI34
631700200529     C           WWLI01    IFEQ '/'
631800200529     C           WWLI34    ANDEQ*BLANKS
631900200529     C                     SETON                     6175
632000200529     C                     MOVE '1'       OVER8
632100200529     C                     MOVEL'SEW5212' ZAMSID
632200200529     C                     EXSR SRSMSG
632300200529     C                     END
632400200529      *
632500200529     C                     END
632600200529     C                     END
632700200529      *
632800200529     C                     ENDSR
632900200529      *
633000200529      *****************************************************************
633100200529      /EJECT
633200200529      *****************************************************************
633300200529      **                                                              *
633400200529      **  SRDSS2   - Validate Deliverer of Securities A/c Line 2 :87: *
633500200529      **                                                              *
633600200529      **  Calls     -                                                 *
633700200529      **  Called By - SRVAL                                           *
633800200529      **                                                              *
633900200529      *****************************************************************
634000200529      *
634100200529     C           SRDSS2    BEGSR
634200200529      *
634300200529      ** Validate If not Blank and not Overridden
634400200529     C                     MOVELSDSS2     WWDSS2  1
634500200529     C           SDSS2     IFNE *BLANKS
634600200529     C           WWDSS2    ANDNE'#'
634700200529     C           OVER8     ANDNE'Y'
634800200529      *
634900200529      ** Override by F18
635000200529     C           PSENT     IFEQ 'CEDEL'
635100200529     C           *INKS     ANDEQ*ON
635200200529     C           OVER8     ANDEQ'1'
635300200529     C                     MOVE *OFF      *INKS
635400200529     C                     MOVE 'Y'       OVER8
635500200529     C                     END
635600200529      *
635700200529      ** If not Overridden
635800200529     C           OVER8     IFNE 'Y'
635900200529      *
636000200529     C           SDSS1     IFEQ *BLANKS
636100200529     C                     SETON                     6275
636200200529     C                     MOVEL'SEW5255' ZAMSID
636300200529     C                     EXSR SRSMSG
636400200529     C                     END
636500200529      *
636600200529     C           SDSS2     IFEQ SDSS1
636700200529     C                     SETON                     6275
636800200529     C                     MOVEL'SEW5258' ZAMSID
636900200529     C                     EXSR SRSMSG
637000200529     C                     END
637100200529      *
637200200529     C                     MOVELSDSS2     WWLI02
637300200529     C                     MOVE SDSS2     WWLI33
637400200529     C           WWLI02    IFNE '//'
637500200529     C           WWLI33    OREQ *BLANKS
637600200529     C                     SETON                     6275
637700200529     C                     MOVE '1'       OVER8
637800200529     C                     MOVEL'SEW5213' ZAMSID
637900200529     C                     EXSR SRSMSG
638000200529     C                     END
638100200529      *
638200200529     C                     END
638300200529     C                     END
638400200529      *
638500200529     C                     ENDSR
638600200529      *
638700200529      *****************************************************************
638800200529      /EJECT
638900200529      *****************************************************************
639000200529      **                                                              *
639100200529      **  SRDSS3   - Validate Deliverer of Securities A/c Line 3 :87: *
639200200529      **                                                              *
639300200529      **  Calls     -                                                 *
639400200529      **  Called By - SRVAL                                           *
639500200529      **                                                              *
639600200529      *****************************************************************
639700200529      *
639800200529     C           SRDSS3    BEGSR
639900200529      *
640000200529      ** Validate If not Blank and not Overridden
640100200529     C                     MOVELSDSS3     WWDSS3  1
640200200529     C           SDSS3     IFNE *BLANKS
640300200529     C           WWDSS3    ANDNE'#'
640400200529     C           OVER8     ANDNE'Y'
640500200529      *
640600200529      ** Override by F18
640700200529     C           PSENT     IFEQ 'CEDEL'
640800200529     C           *INKS     ANDEQ*ON
640900200529     C           OVER8     ANDEQ'1'
641000200529     C                     MOVE *OFF      *INKS
641100200529     C                     MOVE 'Y'       OVER8
641200200529     C                     END
641300200529      *
641400200529      ** If not Overridden
641500200529     C           OVER8     IFNE 'Y'
641600200529      *
641700200529     C           SDSS2     IFEQ *BLANKS
641800200529     C                     SETON                     6375
641900200529     C                     MOVEL'SEW5255' ZAMSID
642000200529     C                     EXSR SRSMSG
642100200529     C                     END
642200200529      *
642300200529     C           SDSS3     IFEQ SDSS2
642400200529     C                     SETON                     6375
642500200529     C                     MOVEL'SEW5258' ZAMSID
642600200529     C                     EXSR SRSMSG
642700200529     C                     END
642800200529      *
642900200529     C                     MOVELSDSS3     WWLI02
643000200529     C                     MOVE SDSS3     WWLI33
643100200529     C           WWLI02    IFNE '//'
643200200529     C           WWLI33    OREQ *BLANKS
643300200529     C                     SETON                     6375
643400200529     C                     MOVE '1'       OVER8
643500200529     C                     MOVEL'SEW5213' ZAMSID
643600200529     C                     EXSR SRSMSG
643700200529     C                     END
643800200529      *
643900200529     C                     END
644000200529     C                     END
644100200529      *
644200200529     C                     ENDSR
644300200529      *
644400200529      *****************************************************************
644500200529      /EJECT
644600200529      *****************************************************************
644700200529      **                                                              *
644800200529      **  SRDSS4   - Validate Deliverer of Securities A/c Line 4 :87: *
644900200529      **                                                              *
645000200529      **  Calls     -                                                 *
645100200529      **  Called By - SRVAL                                           *
645200200529      **                                                              *
645300200529      *****************************************************************
645400200529      *
645500200529     C           SRDSS4    BEGSR
645600200529      *
645700200529      ** Validate If not Blank and not Overridden
645800200529     C                     MOVELSDSS4     WWDSS4  1
645900200529     C           SDSS4     IFNE *BLANKS
646000200529     C           WWDSS4    ANDNE'#'
646100200529     C           OVER8     ANDNE'Y'
646200200529      *
646300200529      ** Override by F18
646400200529     C           PSENT     IFEQ 'CEDEL'
646500200529     C           *INKS     ANDEQ*ON
646600200529     C           OVER8     ANDEQ'1'
646700200529     C                     MOVE *OFF      *INKS
646800200529     C                     MOVE 'Y'       OVER8
646900200529     C                     END
647000200529      *
647100200529      ** If not Overridden
647200200529     C           OVER8     IFNE 'Y'
647300200529      *
647400200529     C           SDSS3     IFEQ *BLANKS
647500200529     C                     SETON                     6475
647600200529     C                     MOVEL'SEW5255' ZAMSID
647700200529     C                     EXSR SRSMSG
647800200529     C                     END
647900200529      *
648000200529     C           SDSS4     IFEQ SDSS3
648100200529     C                     SETON                     6475
648200200529     C                     MOVEL'SEW5258' ZAMSID
648300200529     C                     EXSR SRSMSG
648400200529     C                     END
648500200529      *
648600200529     C                     MOVELSDSS4     WWLI02
648700200529     C                     MOVE SDSS4     WWLI33
648800200529     C           WWLI02    IFNE '//'
648900200529     C           WWLI33    OREQ *BLANKS
649000200529     C                     SETON                     6475
649100200529     C                     MOVE '1'       OVER8
649200200529     C                     MOVEL'SEW5213' ZAMSID
649300200529     C                     EXSR SRSMSG
649400200529     C                     END
649500200529      *
649600200529     C                     END
649700200529     C                     END
649800200529      *
649900200529     C                     ENDSR
650000200529      *
650100200529      *****************************************************************
650200200529      /EJECT
650300200529      *****************************************************************
650400200529      **                                                              *
650500200529      **  SRBSSA    - Validate Beneficiary of Securities TAG :88:     *
650600200529      **                                                              *
650700200529      **  Calls     -                                                 *
650800200529      **  Called By - SRVAL                                           *
650900200529      **                                                              *
651000200529      *****************************************************************
651100200529      *
651200200529     C           SRBSSA    BEGSR
651300200529      *
651400200529      ** this Field can only be Entered for Clearance Type 1 to 4
651500200529     C           WWCLTY    IFEQ '14'
651600200529      *
651700200529     C           SBSSA     IFNE 'C'
651800200529     C           SBSSA     ANDNE'D'
651900200529     C           SBSSA     ANDNE*BLANK
652000200529     C                     SETON                     6575
652100200529     C                     MOVEL'SEW5223' ZAMSID
652200200529     C                     EXSR SRSMSG
652300200529     C                     END
652400200529      *
652500200529      ** The A/c Lines may not be left Blank when Entering the TAG Field
652600200529     C           SBSSA     IFNE *BLANK
652700200529     C           SBSS1     ANDEQ*BLANK
652800200529     C                     SETON                     6775
652900200529     C                     MOVEL'SEW5227' ZAMSID
653000200529     C                     EXSR SRSMSG
653100200529     C                     END
653200200529      *
653300200529     C                     ELSE
653400200529      ** this Field must be left Blank If Clearance Type not 1 to 4
653500200529     C           SBSSA     IFNE *BLANK
653600200529     C                     SETON                     6575
653700200529     C                     MOVEL'SEW5221' ZAMSID
653800200529     C                     EXSR SRSMSG
653900200529     C                     END
654000200529     C                     END
654100200529      *
654200200529     C                     ENDSR
654300200529      *
654400200529      *****************************************************************
654500200529      /EJECT
654600200529      *****************************************************************
654700200529      **                                                              *
654800200529      **  SRBSSN    - Validate Beneficiary of Securities :88:         *
654900200529      **                                                              *
655000200529      **  Calls     - SRCUST                                          *
655100200529      **  Called By - SRVAL                                           *
655200200529      **                                                              *
655300200529      *****************************************************************
655400200529      *
655500200529     C           SRBSSN    BEGSR
655600200529      *
655700200529      ** Validate If not Blank
655800200529     C           SBSSN     IFNE *BLANKS
655900200529      *
656000200529      ** TAG Field must be left Blank
656100200529     C           SBSSA     IFNE *BLANKS
656200200529     C                     SETON                     6675
656300200529     C                     MOVEL'SEW5228' ZAMSID
656400200529     C                     EXSR SRSMSG
656500200529     C                     ELSE
656600200529      *
656700200529      ** Set On Error Indicator for this Field before Validation
656800200529     C                     SETON                     66
656900200529      *
657000200529      ** Validate Customer Number/Shortname/Nostro
657100200529     C                     MOVE SBSSN     WWCUST
657200200529     C                     EXSR SRCUST
657300200529     C                     MOVELBBCUST    SBSSN                                             AR589193
657400200529      *
657500200529      ** Reset Error Indicator If field is Valid
657600200529     C           WWCUSS    IFEQ 'C'
657700200529     C           WWCUSS    OREQ 'S'
657800200529     C           WWCUSS    OREQ 'N'
657900200529     C                     SETOF                     66
658000200529     C                     END
658100200529      *
658200200529      ** Customer Number/Shortname
658300200529     C           WWCUSS    IFEQ 'C'
658400200529     C           WWCUSS    OREQ 'S'
658500200529     C                     MOVELBBCUST    WWBSSN
658600200529     C                     END
658700200529      *
658800200529      ** Nostro
658900200529     C           WWCUSS    IFEQ 'N'
659000200529     C                     MOVELAWCPNC    WWBSSN
659100200529     C                     END
659200200529     C                     END
659300200529      *
659400200529     C                     ELSE
659500200529      ** Else If Screen Field is Blank, ensure workfield is also Blank
659600200529     C                     MOVE *BLANKS   WWBSSN
659700200529     C                     END
659800200529      *
659900200529     C                     ENDSR
660000200529      *
660100200529      *****************************************************************
660200200529      /EJECT
660300200529      *****************************************************************
660400200529      **                                                              *
660500200529      **  SRBSS1    - Validate Beneficiary of Securities A/c Line :88:*
660600200529      **                                                              *
660700200529      **  Calls     - SRSMSG                                          *
660800200529      **  Called By - SRVAL                                           *
660900200529      **                                                              *
661000200529      *****************************************************************
661100200529      *
661200200529     C           SRBSS1    BEGSR
661300200529      *
661400200529      ** Validate If not Blank
661500200529     C                     MOVELSBSS1     WWBSS1  1
661600200529     C           SBSS1     IFNE *BLANKS
661700200529     C           WWBSS1    ANDNE'#'
661800200529      *
661900200529      ** Override by F18
662000200529     C           PSENT     IFEQ 'CEDEL'
662100200529     C           *INKS     ANDEQ*ON
662200200529     C           OVER9     ANDEQ'1'
662300200529     C                     MOVE *OFF      *INKS
662400200529     C                     MOVE 'Y'       OVER9
662500200529     C                     END
662600200529      *
662700200529      ** If not Overridden
662800200529     C           OVER9     IFNE 'Y'
662900200529      *
663000200529     C           WWBSS1    IFNE '/'
663100200529     C                     SETON                     6775
663200200529     C                     MOVE '1'       OVER9
663300200529     C                     MOVEL'SEW5210' ZAMSID
663400200529     C                     EXSR SRSMSG
663500200529     C                     END
663600200529      *
663700200529     C                     MOVELSBSS1     WWLI02
663800200529     C           WWBSS1    IFEQ '//'
663900200529     C                     SETON                     6775
664000200529     C                     MOVE '1'       OVER9
664100200529     C                     MOVEL'SEW5211' ZAMSID
664200200529     C                     EXSR SRSMSG
664300200529     C                     END
664400200529      *
664500200529     C                     MOVE SBSS1     WWLI34
664600200529     C           WWLI01    IFEQ '/'
664700200529     C           WWLI34    ANDEQ*BLANKS
664800200529     C                     SETON                     6775
664900200529     C                     MOVE '1'       OVER9
665000200529     C                     MOVEL'SEW5212' ZAMSID
665100200529     C                     EXSR SRSMSG
665200200529     C                     END
665300200529      *
665400200529     C                     END
665500200529     C                     END
665600200529      *
665700200529     C                     ENDSR
665800200529      *
665900200529      *****************************************************************
666000200529      /EJECT
666100200529      *****************************************************************
666200200529      **                                                              *
666300200529      **  SRBSS2    - Validate Beneficiary of Securities A/c Line :88:*
666400200529      **                                                              *
666500200529      **  Calls     - SRSMSG                                          *
666600200529      **  Called By - SRVAL                                           *
666700200529      **                                                              *
666800200529      *****************************************************************
666900200529      *
667000200529     C           SRBSS2    BEGSR
667100200529      *
667200200529      ** Validate If not Blank and not Overridden
667300200529     C                     MOVELSBSS2     WWBSS2  1
667400200529     C           SBSS2     IFNE *BLANKS
667500200529     C           WWBSS2    ANDNE'#'
667600200529     C           OVER9     ANDNE'Y'
667700200529      *
667800200529      ** Override by F18
667900200529     C           PSENT     IFEQ 'CEDEL'
668000200529     C           *INKS     ANDEQ*ON
668100200529     C           OVER9     ANDEQ'1'
668200200529     C                     MOVE *OFF      *INKS
668300200529     C                     MOVE 'Y'       OVER9
668400200529     C                     END
668500200529      *
668600200529      ** If not Overridden
668700200529     C           OVER9     IFNE 'Y'
668800200529      *
668900200529     C           SBSS1     IFEQ *BLANKS
669000200529     C                     SETON                     6875
669100200529     C                     MOVEL'SEW5255' ZAMSID
669200200529     C                     EXSR SRSMSG
669300200529     C                     END
669400200529      *
669500200529     C           SBSS2     IFEQ SBSS1
669600200529     C                     SETON                     6875
669700200529     C                     MOVEL'SEW5258' ZAMSID
669800200529     C                     EXSR SRSMSG
669900200529     C                     END
670000200529      *
670100200529     C                     MOVELSBSS2     WWLI02
670200200529     C                     MOVE SBSS2     WWLI33
670300200529     C           WWLI02    IFNE '//'
670400200529     C           WWLI33    OREQ *BLANKS
670500200529     C                     SETON                     6875
670600200529     C                     MOVE '1'       OVER9
670700200529     C                     MOVEL'SEW5213' ZAMSID
670800200529     C                     EXSR SRSMSG
670900200529     C                     END
671000200529      *
671100200529     C                     END
671200200529     C                     END
671300200529      *
671400200529     C                     ENDSR
671500200529      *
671600200529      *****************************************************************
671700200529      /EJECT
671800200529      *****************************************************************
671900200529      **                                                              *
672000200529      **  SRCUST    - Validate Customer Number/Shortname/Nostro       *
672100200529      **                                                              *
672200200529      **  Calls     -                                                 *
672300200529      **  Called By -                                                 *
672400200529      **                                                              *
672500200529      *****************************************************************
672600200529      *
672700200529     C           SRCUST    BEGSR
672800200529      *
672900200529     C                     MOVE *BLANKS   WWCUSS  1
673000200529      *
673100200529      ** Call Access Program for Customer Details using the Customer
673200200529      ** Number or the Customer Shortname.
673300200529     C                     CALL 'AOCUSTR0'
673400200529     C                     PARM *BLANKS   WRTCD
673500200529     C                     PARM '*KEY   ' WOPTN
673600200529     C                     PARM WWCUST    WKEY1  10
673700200529     C                     PARM *BLANKS   WKYST   7
673800200529     C           SDCUST    PARM SDCUST    DSSDY
673900200529      *
674000200529      ** If Return code is blank then set WWCUSS to 'C' if Customer
674100200529      ** Number; to 'S' if Customer Shortname.
674200200529     C           WRTCD     IFEQ *BLANK
674300200529     C           WKYST     ANDNE'*ERROR'
674400200529      *
674500200529     C           WKYST     IFEQ '*CNUM'
674600200529     C                     MOVE 'C'       WWCUSS
674700200529     C                     ELSE
674800200529     C                     MOVE 'S'       WWCUSS
674900200529     C                     END
675000200529      *
675100200529      ** If Customer Number or Shortname then save file fields.
675200200529     C                     MOVE BBCABA    WWCABA
675300200529     C                     MOVE BBCSID    WWCSID
675400200529     C                     MOVE BBBLCD    WWBLCD
675500200529     C                     MOVE BBFWCD    WWFWCD
675600200529     C                     MOVE BBCHID    WWCHID
675700200529     C                     MOVE BBCHSC    WWCHSC
675800200529     C                     MOVE BBBNBI    WWBNBI
675900200529      *
676000200529      ** Else (error on Customer file) may be a Counterparty Nostro
676100200529     C                     ELSE
676200200529     C                     MOVELWWCUST    WWNOST  8
676300200529     C                     CALL 'AOCNSTR0'
676400200529     C                     PARM *BLANKS   WRTCD
676500200529     C                     PARM '*KEY   ' WOPTN
676600200529     C                     PARM WWNOST    WKEY2   8
676700200529     C           SDCNST    PARM SDCNST    DSFDY
676800200529      *
676900200529      ** If Counterparty Nostro found set WWCUSS to 'N'.
677000200529     C           WRTCD     IFEQ *BLANK
677100200529     C                     MOVE 'N'       WWCUSS
677200200529     C                     MOVE AWSWID    WWCSID
677300200529     C                     MOVE AWFWCD    WWFWCD  9
677400200529     C                     MOVE 'Y'       WWBNBI
677500200529     C                     END
677600200529     C                     END
677700200529      *
677800200529      ** If no record found on either file then send error message
677900200529     C           WWCUSS    IFNE 'C'
678000200529     C           WWCUSS    ANDNE'S'
678100200529     C           WWCUSS    ANDNE'N'
678200200529     C                     SETON                     75
678300200529     C                     MOVEL'SEW5205' ZAMSID
678400200529     C                     EXSR SRSMSG
678500200529     C                     END
678600200529      *
678700200529     C                     ENDSR
678800200529      *
678900200529      *****************************************************************
679000200529      /EJECT
679100200529      *****************************************************************
679200200529      **                                                              *
679300200529      **  SRLI35    - Validate A 35 Alpha Input Field                 *
679400200529      **                                                              *
679500200529      **  Calls     - SRSMSG                                          *
679600200529      **  Called By -                                                 *
679700200529      **                                                              *
679800200529      *****************************************************************
679900200529      *
680000200529     C           SRLI35    BEGSR
680100200529      *
680200200529      ** Initialise Flag to Send Error Message If 35A Fields not
680300200529      ** correctly Formatted.
680400200529     C                     MOVE *BLANKS   WWER35
680500200529      *
680600200529      ** Validate First Character
680700200529     C           WWLI01    IFNE '/'
680800200529     C                     MOVE 'Y'       WWER35  1
680900200529     C                     END
681000200529      *
681100200529      ** Validate First 2 Characters
681200200529     C           WWLI02    IFEQ '//'
681300200529     C           WWLI04    ANDNE'//BL'
681400200529     C           WWLI04    ANDNE'//CH'
681500200529     C           WWLI04    ANDNE'//CP'
681600200529     C           WWLI04    ANDNE'//FW'
681700200529     C           WWLI04    ANDNE'//SC'
681800200529     C                     MOVE 'Y'       WWER35
681900200529     C                     END
682000200529      *
682100200529      ** Validate First 4 Characters
682200200529     C           PTNMC     IFNE 'USD'
682300200529     C           WWLI04    IFEQ '//CH'
682400200529     C           WWLI04    OREQ '//CP'
682500200529     C           WWLI04    OREQ '//FW'
682600200529     C                     MOVE 'Y'       WWER35
682700200529     C                     END
682800200529     C                     END
682900200529      *
683000200529     C           PTNMC     IFNE 'DEM'
683100200529     C           WWLI04    ANDEQ'//BL'
683200200529     C                     MOVE 'Y'       WWER35
683300200529     C                     END
683400200529      *
683500200529      ** Invalid Entry
683600200529     C           WWER35    IFEQ 'Y'
683700200529     C                     MOVE 'Y'       WWER35
683800200529     C                     SETON                     75
683900200529     C                     MOVEL'SEW5235' ZAMSID
684000200529     C                     EXSR SRSMSG
684100200529     C                     END
684200200529      *
684300200529      ** Validate First 5 Characters
684400200529     C           WWLI05    IFEQ '//CP '
684500200529      *
684600200529     C           WWCUSS    IFEQ 'C'
684700200529     C           WWCUSS    OREQ 'S'
684800200529      ** If //CP is followed by Blanks then Default this to the
684900200529      ** Customer CHIPS Participant
685000200529     C           WWBNBI    IFEQ 'Y'
685100200529     C           WW0535    ANDEQ*BLANKS
685200200529     C                     MOVELWWCABA    WW0507
685300200529     C                     END
685400200529     C                     END
685500200529      *
685600200529      ** Error If ' //CP' is not followed by a 3 Digit Number
685700200529      ** followed by Blanks
685800200529     C                     MOVELWW0507    WWNUM4  40
685900200529     C                     MOVELWWNUM4    WWALP3  3
686000200529     C           WW0507    IFNE WWALP3
686100200529     C           WW0835    ORNE *BLANKS
686200200529     C                     MOVE 'Y'       WWER35
686300200529     C                     SETON                     75
686400200529     C                     MOVEL'SEW5236' ZAMSID
686500200529     C                     EXSR SRSMSG
686600200529     C                     END
686700200529     C                     END
686800200529      *
686900200529      ** If Leftmost 4 Chars are '//FW' followed by Blanks and
687000200529      ** Customer SWIFT Id is Blank then Set Up Fedwire Account
687100200529     C           WWLI04    IFEQ '//FW'
687200200529      *
687300200529     C           WW0535    IFEQ *BLANKS
687400200529     C           WWCSID    ANDEQ*BLANKS
687500200529     C                     MOVELWWFWCD    WW0513
687600200529     C                     END
687700200529      *
687800200529      ** Error If Positions 14 -35 of WWLI35 are not Blank
687900200529     C           WW1435    IFNE *BLANKS
688000200529     C                     MOVE 'Y'       WWER35
688100200529     C                     SETON                     75
688200200529     C                     MOVEL'SEW5237' ZAMSID
688300200529     C                     EXSR SRSMSG
688400200529     C                     END
688500200529      *
688600200529      ** Fedwire Account may only be Blank for a Bank with a Valid
688700200529      ** SWIFT Address
688800200529     C           WW0513    IFEQ *BLANKS
688900200529      *
689000200529     C           WWCUSS    IFNE 'C'
689100200529     C           WWCUSS    ANDNE'S'
689200200529     C           WWBNBI    OREQ 'N'
689300200529     C           WWCSID    OREQ *BLANKS
689400200529     C                     MOVE 'Y'       WWER35
689500200529     C                     SETON                     75
689600200529     C                     MOVEL'SEW5238' ZAMSID
689700200529     C                     EXSR SRSMSG
689800200529     C                     END
689900200529      *
690000200529     C                     ELSE
690100200529      ** Else, must be A 9 Digit Number
690200200529     C                     MOVELWW0513    WWNU10 100
690300200529     C                     MOVELWWNU10    WWALP9  9
690400200529     C           WW0513    IFNE WWALP9
690500200529     C                     MOVE 'Y'       WWER35
690600200529     C                     SETON                     75
690700200529     C                     MOVEL'SEW5239' ZAMSID
690800200529     C                     EXSR SRSMSG
690900200529     C                     END
691000200529      *
691100200529     C                     END
691200200529      *
691300200529      ** Customer or Bank must have a SWIFT Address or a Fedwire A/c
691400200529     C           WWCSID    IFEQ *BLANKS
691500200529     C           WWFWCD    ANDEQ*BLANKS
691600200529     C                     MOVE 'Y'       WWER35
691700200529     C                     SETON                     75
691800200529     C                     MOVEL'SEW5240' ZAMSID
691900200529     C                     EXSR SRSMSG
692000200529     C                     END
692100200529      *
692200200529     C                     END
692300200529      *
692400200529      ** If Leftmost 4 Chars of WWLI35 are '//BL' followed by Blanks
692500200529      ** Set Up the Bankleitzahl Code
692600200529     C           WWLI04    IFEQ '//BL'
692700200529      *
692800200529     C           WWCUSS    IFEQ 'C'
692900200529     C           WWCUSS    OREQ 'S'
693000200529     C           WWBNBI    IFEQ 'Y'
693100200529     C           WW0535    ANDEQ*BLANKS
693200200529     C                     MOVELWWBLCD    WW0512
693300200529     C                     END
693400200529     C                     END
693500200529      *
693600200529      ** Error If '//BL' not followed by 8 Digits Number followed by
693700200529      ** Blanks
693800200529     C                     MOVELWW0512    WWNUM9  90
693900200529     C                     MOVELWWNUM9    WWALP8  8
694000200529     C           WW0512    IFNE WWALP8
694100200529     C           WW1335    ORNE *BLANKS
694200200529     C                     MOVE 'Y'       WWER35
694300200529     C                     SETON                     75
694400200529     C                     MOVEL'SEW5241' ZAMSID
694500200529     C                     EXSR SRSMSG
694600200529     C                     END
694700200529      *
694800200529     C                     END
694900200529      *
695000200529      ** If Leftmost 4 Chars of WWLI35 are '//CH' followed by Blanks
695100200529      ** Set Up Customer CHIPS Universal Id
695200200529     C           WWLI04    IFEQ '//CH'
695300200529      *
695400200529     C           WWCUSS    IFEQ 'C'
695500200529     C           WWCUSS    OREQ 'S'
695600200529     C           WWBNBI    IFEQ 'Y'
695700200529     C           WW0535    ANDEQ*BLANKS
695800200529     C                     MOVELWWCHID    WW0510
695900200529     C                     END
696000200529     C                     END
696100200529      *
696200200529     C                     END
696300200529      *
696400200529      ** If Leftmost 4 Chars of WWLI35 are '//SC' followed by Blanks
696500200529      ** Set Up CHAPS Sort Code
696600200529     C           WWLI04    IFEQ '//SC'
696700200529      *
696800200529     C           WWCUSS    IFEQ 'C'
696900200529     C           WWCUSS    OREQ 'S'
697000200529     C           WWBNBI    IFEQ 'Y'
697100200529     C           WW0535    ANDEQ*BLANKS
697200200529     C                     MOVELWWCHSC    WW0510
697300200529     C                     END
697400200529     C                     END
697500200529     C                     END
697600200529      *
697700200529      ** Error If '//CH' or '//SC' are not followed by a 6 Digit Number
697800200529     C           WWLI04    IFEQ '//CH'
697900200529     C           WWLI04    OREQ '//SC'
698000200529      *
698100200529     C                     MOVELWW0510    WWNUM7  70
698200200529     C                     MOVELWWNUM7    WWALP6  6
698300200529     C           WW0510    IFNE WWALP6
698400200529     C           WW1135    ORNE *BLANKS
698500200529     C                     MOVE 'Y'       WWER35
698600200529     C                     SETON                     75
698700200529     C                     MOVEL'SEW5242' ZAMSID
698800200529     C                     EXSR SRSMSG
698900200529     C                     END
699000200529      *
699100200529     C                     END
699200200529      *
699300200529     C                     ENDSR
699400200529      *
699500200529      *****************************************************************
699600200529      /EJECT
699700200529      *****************************************************************
699800200529      **                                                              *
699900200529      **  SRCLS2    - To Clear Fields on Second Screen                *
700000200529      **              and Reset Error Indicators                      *
700100200529      **                                                              *
700200200529      **  Calls     -                                                 *
700300200529      **  Called By -                                                 *
700400200529      **                                                              *
700500200529      *****************************************************************
700600200529      *
700700200529     C           SRCLS2    BEGSR
700800200529      *
700900200529     C                     MOVE *BLANKS   SIPYN
701000200529     C                     MOVE *BLANKS   SIPYL
701100200529     C                     MOVE *BLANKS   SCTYN
701200200529     C                     MOVE *BLANKS   SCTYL
701300200529     C                     MOVE *BLANKS   SSA1L
701400200529     C                     MOVE *BLANKS   SSA1N
701500200529     C                     MOVE *BLANKS   SSKAN
701600200529     C                     MOVE *BLANKS   SSKAL
701700200529     C                     MOVE *BLANKS   SCCTN
701800200529     C                     MOVE *BLANKS   SDCTL
701900200529     C                     MOVE *BLANKS   SRSSA
702000200529     C                     MOVE *BLANKS   SRSSN
702100200529     C                     MOVE *BLANKS   SRSS1
702200200529     C                     MOVE *BLANKS   SRSS2
702300200529     C                     MOVE *BLANKS   SRSS3
702400200529     C                     MOVE *BLANKS   SRSS4
702500200529     C                     MOVE *BLANKS   SDSSA
702600200529     C                     MOVE *BLANKS   SDSSN
702700200529     C                     MOVE *BLANKS   SDSS1
702800200529     C                     MOVE *BLANKS   SDSS2
702900200529     C                     MOVE *BLANKS   SDSS3
703000200529     C                     MOVE *BLANKS   SDSS4
703100200529     C                     MOVE *BLANKS   SBSSA
703200200529     C                     MOVE *BLANKS   SBSSN
703300200529     C                     MOVE *BLANKS   SBSS1
703400200529     C                     MOVE *BLANKS   SBSS2
703500200529     C**********           MOVE *BLANKS   SINVE                                        CSW098 CSW210
703600200529      *
703700200529     C                     SETOF                       4344
703800200529     C                     SETOF                     454647
703900200529     C                     SETOF                     484950
704000200529     C                     SETOF                     515253
704100200529     C                     SETOF                     545556
704200200529     C                     SETOF                     575859
704300200529     C                     SETOF                     606162
704400200529     C                     SETOF                     636465
704500200529     C                     SETOF                     666768
704600200529     C                     SETOF                     19                   CSW098
704700200529      *
704800200529     C                     ENDSR
704900200529      *
705000200529     C/COPY WNCPYSRC,SE1806C055
705100200529      *****************************************************************
705200200529      /EJECT
705300200529      *****************************************************************
705400200529      **                                                              *
705500200529      **  SRRTS2    - To reset Fields on Second Screen to File Values *
705600200529      **              and Reset Error Indicators                      *
705700200529      **                                                              *
705800200529      **  Calls     -                                                 *
705900200529      **  Called By -                                                 *
706000200529      **                                                              *
706100200529      *****************************************************************
706200200529      *
706300200529     C           SRRTS2    BEGSR
706400200529      *
706500200529     C                     MOVE T2IPYN    SIPYN
706600200529     C                     MOVE T2IPYL    SIPYL
706700200529     C                     MOVE T2CTYN    SCTYN
706800200529     C                     MOVE T2CTYL    SCTYL
706900200529     C                     MOVE T2SA1L    SSA1L
707000200529     C                     MOVE T2SA1N    SSA1N
707100200529     C                     MOVE T2SKAN    SSKAN
707200200529     C                     MOVE T2SKAL    SSKAL
707300200529     C                     MOVE T2CCTN    SCCTN
707400200529     C                     MOVE T2DCTL    SDCTL
707500200529     C                     MOVE T2RSSA    SRSSA
707600200529     C                     MOVE T2RSSN    SRSSN
707700200529     C                     MOVE T2RSS1    SRSS1
707800200529     C                     MOVE T2RSS2    SRSS2
707900200529     C                     MOVE T2RSS3    SRSS3
708000200529     C                     MOVE T2RSS4    SRSS4
708100200529     C                     MOVE T2DSSA    SDSSA
708200200529     C                     MOVE T2DSSN    SDSSN
708300200529     C                     MOVE T2DSS1    SDSS1
708400200529     C                     MOVE T2DSS2    SDSS2
708500200529     C                     MOVE T2DSS3    SDSS3
708600200529     C                     MOVE T2DSS4    SDSS4
708700200529     C                     MOVE T2BSSA    SBSSA
708800200529     C                     MOVE T2BSSN    SBSSN
708900200529     C                     MOVE T2BSS1    SBSS1
709000200529     C                     MOVE T2BSS2    SBSS2
709100200529     C**********           MOVE T2INVE    SINVE                                        CSW098 CSW210
709200200529     C                     MOVE T2INVE    PINVE                                               CSW210
709300200529      *
709400200529     C                     SETOF                       4344
709500200529     C                     SETOF                     454647
709600200529     C                     SETOF                     484950
709700200529     C                     SETOF                     515253
709800200529     C                     SETOF                     545556
709900200529     C                     SETOF                     575859
710000200529     C                     SETOF                     606162
710100200529     C                     SETOF                     636465
710200200529     C                     SETOF                     666768
710300200529     C                     SETOF                     19                   CSW098
710400200529      *
710500200529     C                     ENDSR
710600200529     C/COPY WNCPYSRC,SE1806C056
710700200529      *
710800200529      *****************************************************************                       CSE028
710900200529      /EJECT                                                                                  CSE028
711000200529      *****************************************************************                       CSE028
711100200529      *                                                               *                       CSE028
711200200529      *  SRMOFS    - Default Retrieved File Fields to Screen Fields   *                       CSE028
711300200529      *                                                               *                       CSE028
711400200529      *  Calls     - None.                                            *                       CSE028
711500200529      *                                                               *                       CSE028
711600200529      *  Called By - SRINS - Process Insert                           *                       CSE028
711700200529      *                                                               *                       CSE028
711800200529      *****************************************************************                       CSE028
711900200529      *                                                                                       CSE028
712000200529     C           SRMOFS    BEGSR                                                              CSE028
712100200529      *                                                                                       CSE028
712200200529     C           WCTPCN    IFEQ *BLANKS                                                       CSE028
712300200529     C                     MOVELPTCNR     WCTPCN                                              CSE028
712400200529     C                     ENDIF                                                              CSE028
712500200529      *                                                                                       CSE028
712600200529      ** Retrieve classification of counterparty                                              CSE028
712700200529      *                                                                                       CSE028
712800200529     C                     CALL 'AOSECSR0'                                                    CSE028
712900200529     C                     PARM '*DBERR ' WRTCD                                               CSE028
713000200529     C                     PARM '*KEY   ' WOPTN                                               CSE028
713100200529     C                     PARM WCTPCN    WCUST                                               CSE028
713200200529     C           SDSECS    PARM SDSECS    DSSDY                                               CSE028
713300200529      *                                                                                       CSE028
713400200529     C           PTDTP     IFEQ 'TP'                                                          CSE028
713500200529      *                                                                                       CSE028
713600200529     C                     MOVE W4AFPN    SAFPN                                               CSE028
713700200529     C                     MOVE W4AFPL    SAFPL                                               CSE028
713800200529     C                     MOVE W4AWIN    SAWIN                                               CSE028
713900200529     C                     MOVE W4AWIL    SAWIL                                               CSE028
714000200529     C                     MOVE W4BOFN    SBOFN                                               CSE028
714100200529     C                     MOVE W4BOF1    SBOF1                                               CSE028
714200200529     C           CSW210    IFNE 'Y'                                                           CSW210
714300200529     C                     MOVE W4BOF2    SBOF2                                               CSE028
714400200529     C                     ENDIF                                                              CSW210
714500200529     C                     MOVE W4SRL1    SSRL1                                               CSE028
714600200529     C                     MOVE W4SRL2    SSRL2                                               CSE028
714700200529     C                     MOVE W4SRL3    SSRL3                                               CSE028
714800200529     C                     MOVE W4FIN1    SFIN1                                               CSE028
714900200529     C                     MOVE W4FIN2    SFIN2                                               CSE028
715000200529     C**********           MOVE W4RED1    SRED1                                        CSE028 CSW210
715100200529     C**********           MOVE W4RED2    SRED2                                        CSE028 CSW210
715200200529     C                     MOVE W4NAS1    SNAL1                                               CSE028
715300200529     C                     MOVE W4NAS2    SNAL2                                               CSE028
715400200529     C                     MOVE W4CCTN    SCCTN                                               CSE028
715500200529     C********** *IN08     IFEQ '1'                                                    204464 209949
715600200529     C********** PGMEC     ANDEQ'Y'                                                    204464 209949
715700200529     C                     MOVE W4DRSN    SDSSN                                               CSE028
715800200529     C                     MOVE W4DRS1    SDSS1                                               CSE028
715900200529     C                     MOVE W4DRS2    SDSS2                                               CSE028
716000200529     C                     MOVE W4DRS3    SDSS3                                               CSE028
716100200529     C                     MOVE W4DRS4    SDSS4                                               CSE028
716200200529     C**********           ENDIF                                                       204464 209949
716300200529     C                     MOVE W4BSSN    SBSSN                                               CSE028
716400200529     C                     MOVE W4BSS1    SBSS1                                               CSE028
716500200529     C                     MOVE W4BSS2    SBSS2                                               CSE028
716600200529     C                     MOVELW4IMD1    PIMMD1                                              CSE028
716700200529     C                     MOVELW4IMD2    PIMMD2                                              CSE028
716800200529     C                     MOVELW4IMD3    PIMMD3                                              CSE028
716900200529     C                     MOVELW4IMD4    PIMMD4                                              CSE028
717000200529     C                     MOVELW4IMD5    PIMMD5                                              CSE028
717100200529     C                     MOVELW4IMD6    PIMMD6                                              CSE028
717200200529     C                     MOVELW4IMD7    PIMMD7                                              CSE028
717300200529     C                     MOVELW4IMD8    PIMMD8                                              CSE028
717400200529     C                     MOVELW4IMD9    PIMMD9                                              CSE028
717500200529     C                     MOVELW4IMS1    PIMSA1                                              CSE028
717600200529     C                     MOVELW4IMS2    PIMSA2                                              CSE028
717700200529     C                     MOVELW4IMS3    PIMSA3                                              CSE028
717800200529     C                     MOVELW4IMS4    PIMSA4                                              CSE028
717900200529     C                     MOVELW4IMS5    PIMSA5                                              CSE028
718000200529     C                     MOVELW4IMS6    PIMSA6                                              CSE028
718100200529     C                     MOVELW4IMS7    PIMSA7                                              CSE028
718200200529     C                     MOVELW4IMS8    PIMSA8                                              CSE028
718300200529     C                     MOVELW4IMS9    PIMSA9                                              CSE028
718400200529     C                     MOVELW4PSET    PPSET                                               CSE028
718500200529     C                     MOVELW4NAC1    PNARR1                                              CSE028
718600200529     C                     MOVELW4NAC2    PNARR2                                              CSE028
718700200529     C                     MOVE W4RED1    PREGD1                                              CSW210
718800200529     C                     MOVE W4RED2    PREGD2                                              CSW210
718900200529      *                                                                                       CSW210
719000200529     C           CSW210    IFEQ 'Y'                                                           CSW210
719100200529     C                     MOVELW4DIDN    SDIDN                                               CSW210
719200200529     C                     MOVELW4DLIN    SDLIN                                               CSW210
719300200529     C                     MOVELW4DAD1    SDAD1                                               CSW210
719400200529     C                     MOVELW4DAD2    SDAD2                                               CSW210
719500200529     C                     MOVELW4DAD3    SDAD3                                               CSW210
719600200529     C                     MOVELW4DAD4    SDAD4                                               CSW210
719700200529     C                     MOVELW4QFIN    PQFIN                                               CSW210
719800200529     C                     MOVELW4PCLR    PPCLR                                               CSW210
719900200529     C                     ENDIF                                                              CSW210
720000200529      *                                                                                       CSE028
720100200529      ** Setup parameters to call module SEDORFRTV                                            CSE028
720200200529      *                                                                                       CSE028
720300200529     C           BFCLAS    IFEQ 'M'                                                           CSE028
720400200529     C                     MOVELPDELT     PDEPO                                               CSE028
720500200529     C                     MOVELWWBICN    PCUST                                               CSE028
720600200529     C                     MOVELPDELF     PDEPO2                                              204592
720700200529     C                     ELSE                                                               CSE028
720800200529     C                     MOVELPDELT     PDEPO                                               CSE028
720900200529     C                     MOVELWCTPCN    PCUST                                               CSE028
721000200529     C                     MOVELPDELF     PDEPO2                                              204592
721100200529     C                     ENDIF                                                              CSE028
721200200529      *                                                                                       CSE028
721300200529     C                     ELSE                                                               CSE028
721400200529      *                                                                                       CSE028
721500200529     C                     MOVE W5AFPN    SAFPN                                               CSE028
721600200529     C                     MOVE W5AFPL    SAFPL                                               CSE028
721700200529     C                     MOVE W5AWIN    SAWIN                                               CSE028
721800200529     C                     MOVE W5AWIL    SAWIL                                               CSE028
721900200529     C                     MOVE W5BOFN    SBOFN                                               CSE028
722000200529     C                     MOVE W5BOF1    SBOF1                                               CSE028
722100200529     C           CSW210    IFNE 'Y'                                                           CSW210
722200200529     C                     MOVE W5BOF2    SBOF2                                               CSE028
722300200529     C                     ENDIF                                                              CSW210
722400200529     C                     MOVE W5SRL1    SSRL1                                               CSE028
722500200529     C                     MOVE W5SRL2    SSRL2                                               CSE028
722600200529     C                     MOVE W5SRL3    SSRL3                                               CSE028
722700200529     C                     MOVE W5FIN1    SFIN1                                               CSE028
722800200529     C                     MOVE W5FIN2    SFIN2                                               CSE028
722900200529     C**********           MOVE W5RED1    SRED1                                        CSE028 CSW210
723000200529     C**********           MOVE W5RED2    SRED2                                        CSE028 CSW210
723100200529     C                     MOVE W5NAS1    SNAL1                                               CSE028
723200200529     C                     MOVE W5NAS2    SNAL2                                               CSE028
723300200529     C                     MOVE W5CCTN    SCCTN                                               CSE028
723400200529     C********** *IN07     IFEQ '1'                                                    204464 209949
723500200529     C********** PGMEC     ANDEQ'Y'                                                    204464 209949
723600200529     C                     MOVE W5DRSN    SRSSN                                               CSE028
723700200529     C                     MOVE W5DRS1    SRSS1                                               CSE028
723800200529     C                     MOVE W5DRS2    SRSS2                                               CSE028
723900200529     C                     MOVE W5DRS3    SRSS3                                               CSE028
724000200529     C                     MOVE W5DRS4    SRSS4                                               CSE028
724100200529     C**********           ENDIF                                                       204464 209949
724200200529     C                     MOVE W5BSSN    SBSSN                                               CSE028
724300200529     C                     MOVE W5BSS1    SBSS1                                               CSE028
724400200529     C                     MOVE W5BSS2    SBSS2                                               CSE028
724500200529     C                     MOVELW5IMD1    PIMMD1                                              CSE028
724600200529     C                     MOVELW5IMD2    PIMMD2                                              CSE028
724700200529     C                     MOVELW5IMD3    PIMMD3                                              CSE028
724800200529     C                     MOVELW5IMD4    PIMMD4                                              CSE028
724900200529     C                     MOVELW5IMD5    PIMMD5                                              CSE028
725000200529     C                     MOVELW5IMD6    PIMMD6                                              CSE028
725100200529     C                     MOVELW5IMD7    PIMMD7                                              CSE028
725200200529     C                     MOVELW5IMD8    PIMMD8                                              CSE028
725300200529     C                     MOVELW5IMD9    PIMMD9                                              CSE028
725400200529     C                     MOVELW5IMS1    PIMSA1                                              CSE028
725500200529     C                     MOVELW5IMS2    PIMSA2                                              CSE028
725600200529     C                     MOVELW5IMS3    PIMSA3                                              CSE028
725700200529     C                     MOVELW5IMS4    PIMSA4                                              CSE028
725800200529     C                     MOVELW5IMS5    PIMSA5                                              CSE028
725900200529     C                     MOVELW5IMS6    PIMSA6                                              CSE028
726000200529     C                     MOVELW5IMS7    PIMSA7                                              CSE028
726100200529     C                     MOVELW5IMS8    PIMSA8                                              CSE028
726200200529     C                     MOVELW5IMS9    PIMSA9                                              CSE028
726300200529     C                     MOVELW5PSET    PPSET                                               CSE028
726400200529     C                     MOVELW5NAC1    PNARR1                                              CSE028
726500200529     C                     MOVELW5NAC2    PNARR2                                              CSE028
726600200529     C                     MOVE W5RED1    PREGD1                                              CSW210
726700200529     C                     MOVE W5RED2    PREGD2                                              CSW210
726800200529      *                                                                                       CSW210
726900200529     C           CSW210    IFEQ 'Y'                                                           CSW210
727000200529     C                     MOVELW5DIDN    SDIDN                                               CSW210
727100200529     C                     MOVELW5DLIN    SDLIN                                               CSW210
727200200529     C                     MOVELW5DAD1    SDAD1                                               CSW210
727300200529     C                     MOVELW5DAD2    SDAD2                                               CSW210
727400200529     C                     MOVELW5DAD3    SDAD3                                               CSW210
727500200529     C                     MOVELW5DAD4    SDAD4                                               CSW210
727600200529     C                     MOVELW5QFIN    PQFIN                                               CSW210
727700200529     C                     MOVELW5PCLR    PPCLR                                               CSW210
727800200529     C                     ENDIF                                                              CSW210
727900200529      *                                                                                       CSE028
728000200529      ** Setup parameters to call module SEDORFRTV                                            CSE028
728100200529      *                                                                                       CSE028
728200200529     C           BFCLAS    IFEQ 'M'                                                           CSE028
728300200529     C                     MOVELPDELF     PDEPO                                               CSE028
728400200529     C                     MOVELWWBICN    PCUST                                               CSE028
728500200529     C                     MOVELPDELT     PDEPO2                                              204592
728600200529     C                     ELSE                                                               CSE028
728700200529     C                     MOVELPDELF     PDEPO                                               CSE028
728800200529     C                     MOVELWCTPCN    PCUST                                               CSE028
728900200529     C                     MOVELPDELT     PDEPO2                                              204592
729000200529     C                     ENDIF                                                              CSE028
729100200529      *                                                                                       CSE028
729200200529     C                     ENDIF                                                              CSE028
729300200529      *                                                                                       CSE028
729400200529      ** If CSE022 is installed then setup Safekeeping A/C Line by using module SEDORFRTV     CSE028
729500200529      *                                                                                       CSE028
729600200529     C           CSE022    IFEQ 'Y'                                                           CSE028
729700200529      *                                                                                       CSE028
729800200529     C                     CALL PGMNAM                                                        CSE028
729900200529     C                     PARM *BLANKS   PRETC  10                                           CSE028
730000200529     C                     PARM           PDEPO   6                                           CSE028
730100200529     C                     PARM           PCUST   6                                           CSE028
730200200529     C**********           PARM           PSKAL  20                                    CSE028 215058
730300200529     C                     PARM *BLANKS   PSKAL  20                                           215058
730400200529      *                                                                                       211823
730500200529     C           PSKAL     IFEQ *BLANKS                                                       211823
730600200529     C                     CALL PGMNAM                                                        211823
730700200529     C                     PARM *BLANKS   PRETC  10                                           211823
730800200529     C                     PARM           PDEPO   6                                           211823
730900200529     C                     PARM           PDEPO   6                                           211823
731000200529     C                     PARM           PSKAL  20                                           211823
731100200529     C                     ENDIF                                                              211823
731200200529      *                                                                                       CSE028
731300200529     C                     MOVELPDEPO     SSKAN                                               204592
731400200529     C                     MOVELPSKAL     SSKAL                                               CSE028
731500200529      *                                                                                       204592
731600200529     C                     CALL PGMNAM                                                        204592
731700200529     C                     PARM *BLANKS   PRETC  10                                           204592
731800200529     C                     PARM           PDEPO2  6                                           204592
731900200529     C**********           PARM           PCUST   6                                    204592 205665
732000200529     C                     PARM           PTCNR                                               205665
732100200529     C**********           PARM           PSKAL  20                                    204592 215058
732200200529     C                     PARM *BLANKS   PSKAL  20                                           215058
732300200529      *                                                                                       204592
732400200529     C           PTDTP     IFEQ 'TP'                                                          218770
732500200529     C           WSFAF     ANDNE*BLANKS                                                       218770
732600200529     C                     MOVELWSFAF     SSA1N                                               218770
732700200529     C                     ELSE                                                               218770
732800200529     C           PTDTP     IFEQ 'TS'                                                          218770
732900200529     C           WSFAT     ANDNE*BLANKS                                                       218770
733000200529     C                     MOVELWSFAT     SSA1N                                               218770
733100200529     C                     ELSE                                                               218770
733200200529     C                     MOVELPDEPO2    SSA1N                                               204592
733300200529     C                     ENDIF                                                              218770
733400200529     C                     ENDIF                                                              218770
733500200529      *                                                                                       218770
733600200529     C                     MOVELPSKAL     SSA1L                                               CSE028
733700200529      *                                                                                       CSE028
733800200529     C                     ENDIF                                                              CSE028
733900200529      *                                                                                       CSE028
734000200529     C                     ENDSR                                                              CSE028
734100200529      *                                                                                       CSE028
734200200529      *****************************************************************
734300200529      /EJECT
734400200529      *****************************************************************
734500200529      **                                                              *
734600200529      **  SRFTOS    - To Move File Fields To Screen Fields            *
734700200529      **                                                              *
734800200529      **  Calls     -                                                 *
734900200529      **  Called By -                                                 *
735000200529      **                                                              *
735100200529      *****************************************************************
735200200529      *
735300200529     C           SRFTOS    BEGSR
735400200529      *
735500200529     C                     MOVE T2AP1N    SAP1N
735600200529     C                     MOVE T2AP1L    SAP1L
735700200529     C                     MOVE T2AFPN    SAFPN
735800200529     C                     MOVE T2AFPL    SAFPL
735900200529     C                     MOVE T2AWIA    SAWIA
736000200529     C                     MOVE T2AWIN    SAWIN
736100200529     C                     MOVE T2AWIN    WWAWIN                                            AR635017
736200200529     C                     MOVE T2AWIL    SAWIL
736300200529     C                     MOVE T2BOFA    SBOFA
736400200529     C                     MOVE T2BOFN    SBOFN
736500200529     C                     MOVE T2BOFN    WWBOFN                                            AR635017
736600200529     C                     MOVE T2BOF1    SBOF1
736700200529     C           CSW210    IFNE 'Y'                                                           CSW210
736800200529     C                     MOVE T2BOF2    SBOF2
736900200529     C                     ENDIF                                                              CSW210
737000200529     C                     MOVE T2ACL1    SACL1
737100200529     C                     MOVE T2ACL2    SACL2
737200200529     C                     MOVE T2SRL1    SSRL1
737300200529     C                     MOVE T2SRL2    SSRL2
737400200529     C                     MOVE T2SRL3    SSRL3
737500200529     C                     MOVE T2FIN1    SFIN1
737600200529     C                     MOVE T2FIN2    SFIN2
737700200529     C**********           MOVE T2RED1    SRED1                                               CSW210
737800200529     C**********           MOVE T2RED2    SRED2                                               CSW210
737900200529     C                     MOVE T2NAL1    SNAL1
738000200529     C                     MOVE T2NAL2    SNAL2
738100200529     C                     MOVE T2IPYN    SIPYN
738200200529     C                     MOVE T2IPYL    SIPYL
738300200529     C                     MOVE T2CTYN    SCTYN
738400200529     C                     MOVE T2CTYL    SCTYL
738500200529     C                     MOVE T2SA1L    SSA1L
738600200529     C                     MOVE T2SA1N    SSA1N
738700200529     C                     MOVE T2SKAN    SSKAN
738800200529     C                     MOVE T2SKAL    SSKAL
738900200529     C                     MOVE T2CCTN    SCCTN
739000200529     C                     MOVE T2DCTL    SDCTL
739100200529     C                     MOVE T2RSSA    SRSSA
739200200529     C                     MOVE T2RSSN    SRSSN
739300200529     C                     MOVE T2RSS1    SRSS1
739400200529     C                     MOVE T2RSS2    SRSS2
739500200529     C                     MOVE T2RSS3    SRSS3
739600200529     C                     MOVE T2RSS4    SRSS4
739700200529     C                     MOVE T2DSSA    SDSSA
739800200529     C                     MOVE T2DSSN    SDSSN
739900200529     C                     MOVE T2DSS1    SDSS1
740000200529     C                     MOVE T2DSS2    SDSS2
740100200529     C                     MOVE T2DSS3    SDSS3
740200200529     C                     MOVE T2DSS4    SDSS4
740300200529     C                     MOVE T2BSSA    SBSSA
740400200529     C                     MOVE T2BSSN    SBSSN
740500200529     C                     MOVE T2BSS1    SBSS1
740600200529     C                     MOVE T2BSS2    SBSS2
740700200529     C**********           MOVE T2INVE    SINVE                                        CSW098 CSW210
740800200529     C                     MOVE T2RED1    PREGD1                                              CSW210
740900200529     C                     MOVE T2RED2    PREGD2                                              CSW210
741000200529     C                     MOVE T2INVE    PINVE                                               CSW210
741100200529      *                                                                                       CSW210
741200200529     C           CSW210    IFEQ 'Y'                                                           CSW210
741300200529     C                     MOVELT2DIDN    SDIDN                                               CSW210
741400200529     C                     MOVELT2DLIN    SDLIN                                               CSW210
741500200529     C                     MOVELT2DAD1    SDAD1                                               CSW210
741600200529     C                     MOVELT2DAD2    SDAD2                                               CSW210
741700200529     C                     MOVELT2DAD3    SDAD3                                               CSW210
741800200529     C                     MOVELT2DAD4    SDAD4                                               CSW210
741900200529     C                     MOVELT2QFIN    PQFIN                                               CSW210
742000200529     C                     MOVELT2PCLR    PPCLR                                               CSW210
742100200529     C           CFT004    IFEQ 'Y'                                                           CSW210
742200200529     C                     MOVE T2FAP1    WWFAP1                                              CSW210
742300200529     C                     MOVE T2FAP2    WWFAP2                                              CSW210
742400200529     C                     MOVE T2FDBT    WWFDBT                                              CSW210
742500200529     C                     MOVE T2FAI1    WWFAI1                                              CSW210
742600200529     C                     MOVE T2FBF1    WWFBF1                                              CSW210
742700200529     C                     ENDIF                                                              CSW210
742800200529     C                     ENDIF                                                              CSW210
742900200529      *                                                                                       CSE028
743000200529     C           CSE028    IFEQ 'Y'                                                           CSE028
743100200529     C                     MOVELT2IMD1    PIMMD1                                              CSE028
743200200529     C                     MOVELT2IMD2    PIMMD2                                              CSE028
743300200529     C                     MOVELT2IMD3    PIMMD3                                              CSE028
743400200529     C                     MOVELT2IMD4    PIMMD4                                              CSE028
743500200529     C                     MOVELT2IMD5    PIMMD5                                              CSE028
743600200529     C                     MOVELT2IMD6    PIMMD6                                              CSE028
743700200529     C                     MOVELT2IMD7    PIMMD7                                              CSE028
743800200529     C                     MOVELT2IMD8    PIMMD8                                              CSE028
743900200529     C                     MOVELT2IMD9    PIMMD9                                              CSE028
744000200529     C                     MOVELT2IMS1    PIMSA1                                              CSE028
744100200529     C                     MOVELT2IMS2    PIMSA2                                              CSE028
744200200529     C                     MOVELT2IMS3    PIMSA3                                              CSE028
744300200529     C                     MOVELT2IMS4    PIMSA4                                              CSE028
744400200529     C                     MOVELT2IMS5    PIMSA5                                              CSE028
744500200529     C                     MOVELT2IMS6    PIMSA6                                              CSE028
744600200529     C                     MOVELT2IMS7    PIMSA7                                              CSE028
744700200529     C                     MOVELT2IMS8    PIMSA8                                              CSE028
744800200529     C                     MOVELT2IMS9    PIMSA9                                              CSE028
744900200529     C                     MOVELT2PSET    PPSET                                               CSE028
745000200529     C                     MOVELT2NAC1    PNARR1                                              CSE028
745100200529     C                     MOVELT2NAC2    PNARR2                                              CSE028
745200200529      *                                                                                       CSE028
745300200529     C           T2CTYN    IFNE *BLANKS                                                       CSE028
745400200529     C                     CALL 'AOCUSTR0'                                                    CSE028
745500200529     C                     PARM '*DBERR ' WRTCD                                               CSE028
745600200529     C                     PARM '*KEY   ' WOPTN                                               CSE028
745700200529     C                     PARM T2CTYN    WKEY1  10                                           CSE028
745800200529     C                     PARM *BLANKS   WKYST   7                                           CSE028
745900200529     C           SDCUST    PARM SDCUST    DSSDY                                               CSE028
746000200529      *                                                                                       CSE028
746100200529     C           WRTCD     IFEQ *BLANK                                                        CSE028
746200200529     C                     MOVELBBCUST    WCTPCN  6                                           CSE028
746300200529     C                     ENDIF                                                              CSE028
746400200529      *                                                                                       CSE028
746500200529     C                     ENDIF                                                              CSE028
746600200529      *                                                                                       CSE028
746700200529     C                     ENDIF                                                              CSE028
746800200529      *
746900200529      ** If Enquiry Mode, Retrieve Customer Shortnames
747000200529     C           PACTN     IFEQ 'E'
747100200529      *
747200200529     C           T2AP1N    IFNE *BLANKS
747300200529     C                     CALL 'AOCUSTR0'
747400200529     C                     PARM '*DBERR ' WRTCD
747500200529     C                     PARM '*KEY   ' WOPTN
747600200529     C                     PARM T2AP1N    WKEY1  10
747700200529     C                     PARM *BLANKS   WKYST   7
747800200529     C           SDCUST    PARM SDCUST    DSSDY
747900200529     C           WRTCD     IFEQ *BLANK
748000200529     C           WKYST     ANDNE'*ERROR'
748100200529     C                     MOVE BBCSSN    SAP1N
748200200529     C                     END
748300200529     C                     END
748400200529      *
748500200529     C           T2AFPN    IFNE *BLANKS
748600200529     C                     CALL 'AOCUSTR0'
748700200529     C                     PARM '*DBERR ' WRTCD
748800200529     C                     PARM '*KEY   ' WOPTN
748900200529     C                     PARM T2AFPN    WKEY1  10
749000200529     C                     PARM *BLANKS   WKYST   7
749100200529     C           SDCUST    PARM SDCUST    DSSDY
749200200529     C           WRTCD     IFEQ *BLANK
749300200529     C                     MOVE BBCSSN    SAFPN
749400200529     C                     END
749500200529     C                     END
749600200529      *
749700200529     C           T2AWIN    IFNE *BLANKS
749800200529     C                     CALL 'AOCUSTR0'
749900200529     C                     PARM '*DBERR ' WRTCD
750000200529     C                     PARM '*KEY   ' WOPTN
750100200529     C                     PARM T2AWIN    WKEY1  10
750200200529     C                     PARM *BLANKS   WKYST   7
750300200529     C           SDCUST    PARM SDCUST    DSSDY
750400200529     C           WRTCD     IFEQ *BLANK
750500200529     C                     MOVE BBCSSN    SAWIN
750600200529     C                     END
750700200529     C                     END
750800200529      *
750900200529     C           T2BOFN    IFNE *BLANKS
751000200529     C                     CALL 'AOCUSTR0'
751100200529     C                     PARM '*DBERR ' WRTCD
751200200529     C                     PARM '*KEY   ' WOPTN
751300200529     C                     PARM T2BOFN    WKEY1  10
751400200529     C                     PARM *BLANKS   WKYST   7
751500200529     C           SDCUST    PARM SDCUST    DSSDY
751600200529     C           WRTCD     IFEQ *BLANK
751700200529     C                     MOVE BBCSSN    SBOFN
751800200529     C                     END
751900200529     C                     END
752000200529      *
752100200529     C           T2IPYN    IFNE *BLANKS
752200200529     C                     CALL 'AOCUSTR0'
752300200529     C                     PARM '*DBERR ' WRTCD
752400200529     C                     PARM '*KEY   ' WOPTN
752500200529     C                     PARM T2IPYN    WKEY1  10
752600200529     C                     PARM *BLANKS   WKYST   7
752700200529     C           SDCUST    PARM SDCUST    DSSDY
752800200529     C           WRTCD     IFEQ *BLANK
752900200529     C                     MOVE BBCSSN    SIPYN
753000200529     C                     END
753100200529     C                     END
753200200529      *
753300200529     C           SWRTN     IFNE 'CSW098 '                                 CSW098
753400200529      *                                                                   CSW098
753500200529     C           T2CTYN    IFNE *BLANKS
753600200529     C                     CALL 'AOCUSTR0'
753700200529     C                     PARM '*DBERR ' WRTCD
753800200529     C                     PARM '*KEY   ' WOPTN
753900200529     C                     PARM T2CTYN    WKEY1  10
754000200529     C                     PARM *BLANKS   WKYST   7
754100200529     C           SDCUST    PARM SDCUST    DSSDY
754200200529     C           WRTCD     IFEQ *BLANK
754300200529     C                     MOVE BBCSSN    SCTYN
754400200529     C                     END
754500200529     C                     END
754600200529     C                     ELSE                                           CSW098
754700200529      *                                                                   CSW098
754800200529     C********** T2INVE    IFNE *BLANKS                                                CSW098 CSW210
754900200529     C**********           CALL 'AOCUSTR0'                                             CSW098 CSW210
755000200529     C**********           PARM '*DBERR ' WRTCD                                        CSW098 CSW210
755100200529     C**********           PARM '*KEY   ' WOPTN                                        CSW098 CSW210
755200200529     C**********           PARM T2INVE    WKEY1  10                                    CSW098 CSW210
755300200529     C**********           PARM *BLANKS   WKYST   7                                    CSW098 CSW210
755400200529     C********** SDCUST    PARM SDCUST    DSSDY                                        CSW098 CSW210
755500200529     C********** WRTCD     IFEQ *BLANK                                                 CSW098 CSW210
755600200529     C**********           MOVE BBCSSN    SINVE                                        CSW098 CSW210
755700200529     C**********           ENDIF                                                       CSW098 CSW210
755800200529     C**********           ENDIF                                                       CSW098 CSW210
755900200529      *                                                                   CSW098
756000200529     C           T2INVE    IFNE *BLANKS                                                       CSW210
756100200529     C                     MOVE T2INVE    WWCUST                                              CSW210
756200200529     C                     EXSR SRCUST                                                        CSW210
756300200529     C           WWCUSS    IFEQ 'C'                                                           CSW210
756400200529     C           WWCUSS    OREQ 'S'                                                           CSW210
756500200529     C                     MOVELBBCSSN    PINVE                                               CSW210
756600200529     C                     ENDIF                                                              CSW210
756700200529     C           WWCUSS    IFEQ 'N'                                                           CSW210
756800200529     C                     MOVELAWCPNC    PINVE                                               CSW210
756900200529     C                     ENDIF                                                              CSW210
757000200529     C                     ENDIF                                                              CSW210
757100200529     C                     ENDIF                                          CSW098
757200200529      *
757300200529     C           T2SA1N    IFNE *BLANKS
757400200529     C                     CALL 'AOCUSTR0'
757500200529     C                     PARM '*DBERR ' WRTCD
757600200529     C                     PARM '*KEY   ' WOPTN
757700200529     C                     PARM T2SA1N    WKEY1  10
757800200529     C                     PARM *BLANKS   WKYST   7
757900200529     C           SDCUST    PARM SDCUST    DSSDY
758000200529     C           WRTCD     IFEQ *BLANK
758100200529     C                     MOVE BBCSSN    SSA1N
758200200529     C                     END
758300200529     C                     END
758400200529      *
758500200529     C           T2SKAN    IFNE *BLANKS
758600200529     C                     CALL 'AOCUSTR0'
758700200529     C                     PARM '*DBERR ' WRTCD
758800200529     C                     PARM '*KEY   ' WOPTN
758900200529     C                     PARM T2SKAN    WKEY1  10
759000200529     C                     PARM *BLANKS   WKYST   7
759100200529     C           SDCUST    PARM SDCUST    DSSDY
759200200529     C           WRTCD     IFEQ *BLANK
759300200529     C                     MOVE BBCSSN    SSKAN
759400200529     C                     END
759500200529     C                     END
759600200529      *
759700200529     C           T2RSSN    IFNE *BLANKS
759800200529     C                     CALL 'AOCUSTR0'
759900200529     C                     PARM '*DBERR ' WRTCD
760000200529     C                     PARM '*KEY   ' WOPTN
760100200529     C                     PARM T2RSSN    WKEY1  10
760200200529     C                     PARM *BLANKS   WKYST   7
760300200529     C           SDCUST    PARM SDCUST    DSSDY
760400200529     C           WRTCD     IFEQ *BLANK
760500200529     C                     MOVE BBCSSN    SRSSN
760600200529     C                     END
760700200529     C                     END
760800200529      *
760900200529     C           T2DSSN    IFNE *BLANKS
761000200529     C                     CALL 'AOCUSTR0'
761100200529     C                     PARM '*DBERR ' WRTCD
761200200529     C                     PARM '*KEY   ' WOPTN
761300200529     C                     PARM T2DSSN    WKEY1  10
761400200529     C                     PARM *BLANKS   WKYST   7
761500200529     C           SDCUST    PARM SDCUST    DSSDY
761600200529     C           WRTCD     IFEQ *BLANK
761700200529     C                     MOVE BBCSSN    SDSSN
761800200529     C                     END
761900200529     C                     END
762000200529      *
762100200529     C           T2BSSN    IFNE *BLANKS
762200200529     C                     CALL 'AOCUSTR0'
762300200529     C                     PARM '*DBERR ' WRTCD
762400200529     C                     PARM '*KEY   ' WOPTN
762500200529     C                     PARM T2BSSN    WKEY1  10
762600200529     C                     PARM *BLANKS   WKYST   7
762700200529     C           SDCUST    PARM SDCUST    DSSDY
762800200529     C           WRTCD     IFEQ *BLANK
762900200529     C                     MOVE BBCSSN    SBSSN
763000200529     C                     END
763100200529     C                     END
763200200529      *
763300200529     C           T2DIDN    IFNE *BLANKS                                                       CSW210
763400200529     C                     MOVE T2DIDN    WWCUST                                              CSW210
763500200529     C                     EXSR SRCUST                                                        CSW210
763600200529     C           WWCUSS    IFEQ 'C'                                                           CSW210
763700200529     C           WWCUSS    OREQ 'S'                                                           CSW210
763800200529     C                     MOVELBBCSSN    SDIDN                                               CSW210
763900200529     C                     ENDIF                                                              CSW210
764000200529     C           WWCUSS    IFEQ 'N'                                                           CSW210
764100200529     C                     MOVELAWCPNC    SDIDN                                               CSW210
764200200529     C                     ENDIF                                                              CSW210
764300200529     C                     ENDIF                                                              CSW210
764400200529      *                                                                                       CSW210
764500200529     C           T2QFIN    IFNE *BLANKS                                                       CSW210
764600200529     C                     MOVE T2QFIN    WWCUST                                              CSW210
764700200529     C                     EXSR SRCUST                                                        CSW210
764800200529     C           WWCUSS    IFEQ 'C'                                                           CSW210
764900200529     C           WWCUSS    OREQ 'S'                                                           CSW210
765000200529     C                     MOVELBBCSSN    PQFIN                                               CSW210
765100200529     C                     ENDIF                                                              CSW210
765200200529     C           WWCUSS    IFEQ 'N'                                                           CSW210
765300200529     C                     MOVELAWCPNC    PQFIN                                               CSW210
765400200529     C                     ENDIF                                                              CSW210
765500200529     C                     END                                                                CSW210
765600200529      *                                                                                       CSW210
765700200529     C           T2PCLR    IFNE *BLANKS                                                       CSW210
765800200529     C                     MOVE T2PCLR    WWCUST                                              CSW210
765900200529     C                     EXSR SRCUST                                                        CSW210
766000200529     C           WWCUSS    IFEQ 'C'                                                           CSW210
766100200529     C           WWCUSS    OREQ 'S'                                                           CSW210
766200200529     C                     MOVELBBCSSN    PPCLR                                               CSW210
766300200529     C                     ENDIF                                                              CSW210
766400200529     C           WWCUSS    IFEQ 'N'                                                           CSW210
766500200529     C                     MOVELAWCPNC    PPCLR                                               CSW210
766600200529     C                     ENDIF                                                              CSW210
766700200529     C                     ENDIF                                                              CSW210
766800200529      *                                                                                       CSW210
766900200529     C                     END
767000200529      *
767100200529     C                     ENDSR
767200200529      *
767300200529     C/COPY WNCPYSRC,SE1806C057
767400200529      *****************************************************************
767500200529      /EJECT
767600200529      *****************************************************************
767700200529      **                                                              *
767800200529      **  SRSTOF    - To Move Screen Fields to File Fields            *
767900200529      **                                                              *
768000200529      **  Calls     -                                                 *
768100200529      **  Called By -                                                 *
768200200529      **                                                              *
768300200529      *****************************************************************
768400200529      *
768500200529     C           SRSTOF    BEGSR
768600200529      *
768700200529      ** Move key fields to file fields
768800200529     C***********          MOVELKEY001    T2TDRF                          CSW003
768900200529     C                     MOVELPTDRF     T2TDRF                          CSW003
769000200529     C                     MOVE PWHEN     T2WHEN                          CSW003
769100200529      *
769200200529     C                     MOVE WWAP1N    T2AP1N
769300200529     C                     MOVE SAP1L     T2AP1L
769400200529     C                     MOVE WWAFPN    T2AFPN
769500200529     C                     MOVE SAFPL     T2AFPL
769600200529      *
769700200529     C           SBOFN     IFNE *BLANKS
769800200529     C           SBOF1     ORNE *BLANKS
769900200529     C                     MOVE SAWIA     T2AWIA
770000200529     C                     MOVE WWAWIN    T2AWIN
770100200529     C                     MOVE SAWIL     T2AWIL
770200200529     C                     ELSE
770300200529     C                     MOVE *BLANKS   T2AWIA
770400200529     C                     MOVE *BLANKS   T2AWIN
770500200529     C                     MOVE *BLANKS   T2AWIL
770600200529     C                     END
770700200529      *
770800200529     C           SAWIN     IFNE *BLANKS
770900200529     C           SAWIL     ORNE *BLANKS
771000200529     C           *IN78     OREQ *ON                                                           201429
771100200529     C                     MOVE SBOFA     T2BOFA
771200200529     C                     MOVE WWBOFN    T2BOFN
771300200529     C                     MOVE SBOF1     T2BOF1
771400200529     C           CSW210    IFNE 'Y'                                                           CSW210
771500200529     C                     MOVE SBOF2     T2BOF2
771600200529     C                     ENDIF                                                              CSW210
771700200529     C                     ELSE
771800200529     C                     MOVE *BLANKS   T2BOFA
771900200529     C                     MOVE *BLANKS   T2BOFN
772000200529     C                     MOVE *BLANKS   T2BOF1
772100200529     C                     MOVE *BLANKS   T2BOF2
772200200529     C                     END
772300200529      *
772400200529     C                     MOVE SACL1     T2ACL1
772500200529     C                     MOVE SACL2     T2ACL2
772600200529     C                     MOVE SSRL1     T2SRL1
772700200529     C                     MOVE SSRL2     T2SRL2
772800200529     C                     MOVE SSRL3     T2SRL3
772900200529     C                     MOVE SFIN1     T2FIN1
773000200529     C                     MOVE SFIN2     T2FIN2
773100200529     C**********           MOVE SRED1     T2RED1                                              CSW210
773200200529     C**********           MOVE SRED2     T2RED2                                              CSW210
773300200529     C                     MOVE SNAL1     T2NAL1
773400200529     C                     MOVE SNAL2     T2NAL2
773500200529     C                     MOVE WWIPYN    T2IPYN
773600200529     C                     MOVE SIPYL     T2IPYL
773700200529     C                     MOVE WWCTYN    T2CTYN
773800200529     C                     MOVE SCTYL     T2CTYL
773900200529     C                     MOVE WWSA1N    T2SA1N
774000200529     C                     MOVE SSA1L     T2SA1L
774100200529     C                     MOVE WWSKAN    T2SKAN
774200200529     C                     MOVE SSKAL     T2SKAL
774300200529     C                     MOVE SCCTN     T2CCTN
774400200529     C                     MOVE SDCTL     T2DCTL
774500200529     C                     MOVE SRSSA     T2RSSA
774600200529     C                     MOVE WWRSSN    T2RSSN
774700200529     C                     MOVE SRSS1     T2RSS1
774800200529     C                     MOVE SRSS2     T2RSS2
774900200529     C                     MOVE SRSS3     T2RSS3
775000200529     C                     MOVE SRSS4     T2RSS4
775100200529     C                     MOVE SDSSA     T2DSSA
775200200529     C                     MOVE WWDSSN    T2DSSN
775300200529     C                     MOVE SDSS1     T2DSS1
775400200529     C                     MOVE SDSS2     T2DSS2
775500200529     C                     MOVE SDSS3     T2DSS3
775600200529     C                     MOVE SDSS4     T2DSS4
775700200529     C                     MOVE SBSSA     T2BSSA
775800200529     C                     MOVE WWBSSN    T2BSSN
775900200529     C                     MOVE SBSS1     T2BSS1
776000200529     C                     MOVE SBSS2     T2BSS2
776100200529     C**********           MOVE WWINVE    T2INVE                                       CSW098 CSW210
776200200529     C                     MOVE PREGD1    T2RED1                                              CSW210
776300200529     C                     MOVE PREGD2    T2RED2                                              CSW210
776400200529     C                     MOVE PINVE     T2INVE                                              CSW210
776500200529      *                                                                                       CSW210
776600200529     C           CSW210    IFEQ 'Y'                                                           CSW210
776700200529     C                     MOVE WWDIDN    T2DIDN                                              CSW210
776800200529     C                     MOVE SDLIN     T2DLIN                                              CSW210
776900200529     C                     MOVE SDAD1     T2DAD1                                              CSW210
777000200529     C                     MOVE SDAD2     T2DAD2                                              CSW210
777100200529     C                     MOVE SDAD3     T2DAD3                                              CSW210
777200200529     C                     MOVE SDAD4     T2DAD4                                              CSW210
777300200529     C                     MOVE PQFIN     T2QFIN                                              CSW210
777400200529     C                     MOVE PPCLR     T2PCLR                                              CSW210
777500200529      *                                                                                       CSW210
777600200529     C           CFT004    IFEQ 'Y'                                                           CSW210
777700200529     C                     MOVE WWFAP1    T2FAP1                                              CSW210
777800200529     C                     MOVE WWFAP2    T2FAP2                                              CSW210
777900200529     C                     MOVE WWFDBT    T2FDBT                                              CSW210
778000200529     C           T2AWIL    IFNE *BLANKS                                                       CSW210
778100200529     C                     MOVE WWFAI1    T2FAI1                                              CSW210
778200200529     C                     ELSE                                                               CSW210
778300200529     C                     MOVE 'N'       T2FAI1                                              CSW210
778400200529     C                     ENDIF                                                              CSW210
778500200529     C           T2BOF1    IFNE *BLANKS                                                       CSW210
778600200529     C                     MOVE WWFBF1    T2FBF1                                              CSW210
778700200529     C                     ELSE                                                               CSW210
778800200529     C                     MOVE 'N'       T2FBF1                                              CSW210
778900200529     C                     ENDIF                                                              CSW210
779000200529     C                     ENDIF                                                              CSW210
779100200529     C                     ENDIF                                                              CSW210
779200200529      *                                                                                       CSE028
779300200529     C           CSE028    IFEQ 'Y'                                                           CSE028
779400200529      *                                                                                       CSE028
779500200529     C                     MOVE PIMMD1    T2IMD1                                              CSE028
779600200529     C                     MOVE PIMMD2    T2IMD2                                              CSE028
779700200529     C                     MOVE PIMMD3    T2IMD3                                              CSE028
779800200529     C                     MOVE PIMMD4    T2IMD4                                              CSE028
779900200529     C                     MOVE PIMMD5    T2IMD5                                              CSE028
780000200529     C                     MOVE PIMMD6    T2IMD6                                              CSE028
780100200529     C                     MOVE PIMMD7    T2IMD7                                              CSE028
780200200529     C                     MOVE PIMMD8    T2IMD8                                              CSE028
780300200529     C                     MOVE PIMMD9    T2IMD9                                              CSE028
780400200529     C                     MOVE PIMSA1    T2IMS1                                              CSE028
780500200529     C                     MOVE PIMSA2    T2IMS2                                              CSE028
780600200529     C                     MOVE PIMSA3    T2IMS3                                              CSE028
780700200529     C                     MOVE PIMSA4    T2IMS4                                              CSE028
780800200529     C                     MOVE PIMSA5    T2IMS5                                              CSE028
780900200529     C                     MOVE PIMSA6    T2IMS6                                              CSE028
781000200529     C                     MOVE PIMSA7    T2IMS7                                              CSE028
781100200529     C                     MOVE PIMSA8    T2IMS8                                              CSE028
781200200529     C                     MOVE PIMSA9    T2IMS9                                              CSE028
781300200529     C                     MOVE PPSET     T2PSET                                              CSE028
781400200529     C                     MOVE PNARR1    T2NAC1                                              CSE028
781500200529     C                     MOVE PNARR2    T2NAC2                                              CSE028
781600200529      *                                                                                       CSE045
781700200529     C***********CSE045    IFEQ 'Y'                                                   CSE045  222331
781800200529     C                     MOVE *BLANKS   T2FRNT                                              CSE045
781900200529     C                     MOVE *BLANKS   T2AFRT                                              CSE045
782000200529     C                     MOVE *BLANKS   T2REPA                                              CSE045
782100200529     C                     MOVEASTAMP,1   T2TMST                                              CSE045
782200200529     C***********          ENDIF                                                       CSE045 222331
782300200529      *                                                                                       CSE028
782400200529     C                     ENDIF
782500200529      *
782600200529     C                     ENDSR
782700200529      *
782800200529     C/COPY WNCPYSRC,SE1806C058
782900200529      *****************************************************************
783000200529      /EJECT
783100200529      *****************************************************************
783200200529      **                                                              *
783300200529      **  SRINIT    - To Handle Initial Processing                    *
783400200529      **                                                              *
783500200529      **  Calls     -                                                 *
783600200529      **  Called By -                                                 *
783700200529      **                                                              *
783800200529      *****************************************************************
783900200529      *
784000200529     C           SRINIT    BEGSR
784100200529      *
784200200529      **  Copyright Statement
784300200529     C                     MOVEACPY@      BIS@   80
784400200529      *
784500200529      * Get parameters from calling program
784600200529     C           *ENTRY    PLIST
784700200529     C                     PARM           PCMD    2
784800200529     C                     PARM           PERR    1
784900200529     C                     PARM           PDATA
785000200529     C                     PARM           PSMCC                                               205667
785100200529     C                     PARM           DFTFLG  1                                           CSE034
785200200529      *
785300200529      **  Extra parameter needed to pass detail from TRADSDX2 to SE1806
785400200529      **  for reference trade.
785500200529     C                     PARM           TRADX2
785600200529     C                     PARM           PWHEN   1                       CSW003
785700200529     C                     PARM           PMODE   1                       CSE028
785800200529     C                     PARM           PSAFA   6                                           201429
785900200529      **  Extra parameter needed to pass detail for Midas Compliance                          CSD015
786000200529      **  Watch Enhancement.                                                                  CSD015
786100200529     C                     PARM           PMCWL                                               CSD015
786200200529      *
786300200529     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
786400200529      * Setup keys values using transaction data*passed from caller       CSW003
786500200529     C************LIKE     DEFN T2TDRF    KEY001                          CSW003
786600200529     C***********          MOVELPTDRF     KEY001                          CSW003
786700200529     C           KEY001    KLIST                                          CSW003
786800200529     C                     KFLD           PTDRF                           CSW003
786900200529     C                     KFLD           PWHEN                           CSW003
787000200529      *                                                                                       CSD015
787100200529      **  Used for Compliance Watch                                                           CSD015
787200200529      *                                                                                       CSD015
787300200529     C           CWHTKY    KLIST                                                              CSD015
787400200529     C                     KFLD           WFUNT   8                                           CSD015
787500200529     C                     KFLD           WIDEN  40                                           CSD015
787600200529     C                     KFLD           WBRCH   3                                           CSD015
787700200529      *
787800200529      * Set up display/non-display indicator for MT5xx Messages
787900200529     C                     SETOF                     3940
788000200529      *
788100200529      * Initialise error indicators
788200200529     C                     SETOF                     303132
788300200529     C                     SETOF                     333435
788400200529     C                     SETOF                     3637
788500200529     C                     SETOF                     75
788600200529     C                     SETOF                     111214                                   CSW210
788700200529     C                     SETOF                     151718                                   CSW210
788800200529      *
788900200529      * Define work fields
789000200529     C           *LIKE     DEFN BBCABA    WWCABA
789100200529     C           *LIKE     DEFN BBCSID    WWCSID
789200200529     C           *LIKE     DEFN BBBLCD    WWBLCD
789300200529     C           *LIKE     DEFN BBCHID    WWCHID
789400200529     C           *LIKE     DEFN BBCHSC    WWCHSC
789500200529     C           *LIKE     DEFN BBBNBI    WWBNBI
789600200529     C           *LIKE     DEFN T2AFPN    WWAFPN
789700200529     C           *LIKE     DEFN T2AP1N    WWAP1N
789800200529     C           *LIKE     DEFN T2AWIN    WWAWIN
789900200529     C           *LIKE     DEFN T2AWIN    WAWIN                    CSW098
790000200529     C           *LIKE     DEFN T2BOFN    WWBOFN
790100200529     C           *LIKE     DEFN T2BOFN    WBOFN                    CSW098
790200200529     C           *LIKE     DEFN T2IPYN    WWIPYN
790300200529     C           *LIKE     DEFN T2CTYN    WWCTYN
790400200529     C           *LIKE     DEFN T2SKAN    WWSKAN
790500200529     C           *LIKE     DEFN T2SA1N    WWSA1N
790600200529     C           *LIKE     DEFN T2RSSN    WWRSSN
790700200529     C           *LIKE     DEFN T2DSSN    WWDSSN
790800200529     C           *LIKE     DEFN T2BSSN    WWBSSN
790900200529     C           *LIKE     DEFN T2DIDN    WWDIDN                                              CSW210
791000200529     C           *LIKE     DEFN T2DLIN    WWCOMP                                              CSW210
791100200529     C           *LIKE     DEFN T2AP1L    WWAP1L                                              CSW210
791200200529     C           *LIKE     DEFN T2AFPL    WWAP2L                                              CSW210
791300200529     C           *LIKE     DEFN T2AWIL    WWAIL                                               CSW210
791400200529     C           *LIKE     DEFN T2BOF1    WWSBOF                                              CSW210
791500200529      *                                                                                       CSW210
791600200529      ** IBAN Flag work fields                                                                CSW210
791700200529     C           *LIKE     DEFN T2FAP1    WWFAP1                                              CSW210
791800200529     C           *LIKE     DEFN T2FAP2    WWFAP2                                              CSW210
791900200529     C           *LIKE     DEFN T2FDBT    WWFDBT                                              CSW210
792000200529     C           *LIKE     DEFN T2FAI1    WWFAI1                                              CSW210
792100200529     C           *LIKE     DEFN T2FBF1    WWFBF1                                              CSW210
792200200529      *
792300200529      * Initialise work fields
792400200529     C                     MOVE *BLANKS   WWRITE  1
792500200529     C                     MOVE *BLANKS   WACLN  35                       CSW098
792600200529     C                     MOVE *BLANKS   WBENF  35                       CSW098
792700200529     C                     MOVE *BLANKS   WAWBK  35                       CSW098
792800200529     C                     MOVE *BLANKS   WICNIL  1                       CSW098
792900200529     C                     MOVE *BLANKS   IAWBK   1                       CSW098
793000200529     C                     MOVE *BLANKS   IBENF   1                       CSW098
793100200529     C                     MOVE *BLANKS   WWADD   1                                           CSW210
793200200529     C                     MOVE *BLANKS   WDACT  35                                           CSW210
793300200529     C                     MOVE 'N'       WSDLIN  1                                           CSW210
793400200529     C                     MOVE 'N'       WSAP1L  1                                           CSW210
793500200529     C                     MOVE 'N'       WSAP2L  1                                           CSW210
793600200529     C                     MOVE 'N'       WSAWIL  1                                           CSW210
793700200529     C                     MOVE 'N'       WSBOF1  1                                           CSW210
793800200529      *
793900200529      ** Access Bank Details
794000200529     C                     CALL 'AOBANKR0'
794100200529     C                     PARM '*DBERR ' WRTCD   7
794200200529     C                     PARM '*FIRST ' WOPTN   7
794300200529     C           SDBANK    PARM SDBANK    DSFDY
794400200529      *
794500200529     C                     MOVE BJMRDT    SDATE
794600200529      *
794700200529      ** Access Branch Details using Branch Code from TRADSD
794800200529     C                     MOVE PTDBR     WDSNB
794900200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
795000200529     C                     CALL 'AOBRCHR1'                                                    CGL029
795100200529     C                     PARM '*DBERR ' WRTCD   7
795200200529     C                     PARM '*KEY   ' WOPTN   7
795300200529     C                     PARM           WDSNB   3
795400200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
795500200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
795600200529      *                                                                   CSW098
795700200529      ** Check to see if switchable feature CSW098 is on or if date is    CSW098
795800200529      ** greater than 16 October 1998.                                    CSW098
795900200529     C                     CALL 'SWIFT98'              20                 CSW098
796000200529     C                     PARM           SWRTN   7                       CSW098
796100200529      *                                                                   CSW098
796200200529     C           *IN20     IFEQ *ON                        ***************CSW098
796300200529     C                     MOVEL'01'      DBASE            **DB ERROR 001*CSW098
796400200529     C                     MOVEL'SE1806'  DBPGM            ***************CSW098
796500200529     C                     MOVEL'ERR CALL'DBFILE                          CSW098
796600200529     C                     MOVEL'SWIFT98' DBKEY                           CSW098
796700200529     C                     EXSR *PSSR                                     CSW098
796800200529     C                     ENDIF                                          CSW098
796900200529      *                                                                   CSW098
797000200529     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
797100200529     C                     MOVE *ON       *IN20                           CSW098
797200200529     C                     ELSE                                           CSW098
797300200529     C                     MOVE *OFF      *IN20                           CSW098
797400200529     C                     ENDIF                                          CSW098
797500200529      *                                                                   CSW014
797600200529      ** Check if CSW014 feature is installed                             CSW014
797700200529      *                                                                   CSW014
797800200529     C                     MOVE 'N'       CSW014  1                       CSW014
797900200529     C                     CALL 'AOSARDR0'                                CSW014
798000200529     C                     PARM '       ' @RTCD   7                       CSW014
798100200529     C                     PARM '*VERIFY' @OPTN   7                       CSW014
798200200529     C                     PARM 'CSW014'  @SARD   6                       CSW014
798300200529      *                                                                   CSW014
798400200529     C           @RTCD     IFEQ *BLANK                                    CSW014
798500200529     C                     MOVE 'Y'       CSW014                          CSW014
798600200529     C                     ENDIF                                          CSW014
798700200529      *                                                                                       CSW201
798800200529      ** Call SWIF2001 to check if CSW201 is switched on                                      CSW201
798900200529      *                                                                                       CSW201
799000200529     C                     CALL 'SWIF2001'             8383                                   CSW201
799100200529     C                     PARM *BLANKS   @RTCD                                               CSW201
799200200529      *                                                                                       CSW201
799300200529     C           *IN83     IFEQ *ON                                                           CSW201
799400200529     C                     Z-ADD2         DBASE                                               CSW201
799500200529     C                     MOVEL'SWIF2001'DBFILE                                              CSW201
799600200529     C                     MOVEL'*CALL'   DBKEY                                               CSW201
799700200529     C                     EXSR *PSSR                                                         CSW201
799800200529     C                     ELSE                                                               CSW201
799900200529      *                                                                                       CSW201
800000200529     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
800100200529     C                     MOVE 'Y'       CSW201  1                                           CSW201
800200200529     C                     ELSE                                                               CSW201
800300200529     C                     MOVE 'N'       CSW201                                              CSW201
800400200529     C                     ENDIF                                                              CSW201
800500200529      *                                                                                       CSW201
800600200529     C                     ENDIF                                                              CSW201
800700200529      *                                                                                       CSE028
800800200529      ** Check if CSE028 feature is installed                                                 CSE028
800900200529      *                                                                                       CSE028
801000200529     C                     MOVE 'N'       CSE028  1                                           CSE028
801100200529     C                     MOVE *OFF      *IN76                                               CSE028
801200200529     C                     CALL 'AOSARDR0'                                                    CSE028
801300200529     C                     PARM '       ' @RTCD                                               CSE028
801400200529     C                     PARM '*VERIFY' @OPTN                                               CSE028
801500200529     C                     PARM 'CSE028'  @SARD                                               CSE028
801600200529      *                                                                                       CSE028
801700200529     C           @RTCD     IFNE *BLANKS                                                       CSE028
801800200529     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
801900200529     C                     MOVEL@SARD     DBKEY                                               CSE028
802000200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
802100200529     C                     Z-ADD002       DBASE                                               CSE028
802200200529     C                     EXSR *PSSR                                                         CSE028
802300200529     C                     ENDIF                                                              CSE028
802400200529      *                                                                                       CSE028
802500200529     C           @RTCD     IFEQ *BLANK                                                        CSE028
802600200529     C                     MOVE 'Y'       CSE028                                              CSE028
802700200529     C                     MOVE *ON       *IN76                                               CSE028
802800200529     C                     ENDIF                                                              CSE028
802900200529      *                                                                                       CSE028
803000200529      ** Check if CSE029 feature is installed                                                 209247
803100200529      *                                                                                       209247
803200200529     C                     MOVE 'N'       CSE029  1                                           209247
803300200529     C                     CALL 'AOSARDR0'                                                    209247
803400200529     C                     PARM '       ' @RTCD                                               209247
803500200529     C                     PARM '*VERIFY' @OPTN                                               209247
803600200529     C                     PARM 'CSE029'  @SARD                                               209247
803700200529      *                                                                                       209247
803800200529     C           @RTCD     IFNE *BLANKS                                                       209247
803900200529     C           @RTCD     ANDNE'*NRF   '                                                     209247
804000200529     C                     MOVEL@SARD     DBKEY                                               209247
804100200529     C                     MOVEL'SCSARDPD'DBFILE                                              209247
804200200529     C                     Z-ADD004       DBASE                                               209247
804300200529     C                     EXSR *PSSR                                                         209247
804400200529     C                     ENDIF                                                              209247
804500200529      *                                                                                       209247
804600200529     C           @RTCD     IFEQ *BLANK                                                        209247
804700200529     C                     MOVE 'Y'       CSE029                                              209247
804800200529     C                     ENDIF                                                              209247
804900200529      *                                                                                       209247
805000200529      ** Check if CSE022 feature is installed                                                 CSE028
805100200529      *                                                                                       CSE028
805200200529     C                     MOVE 'N'       CSE022  1                                           CSE028
805300200529     C                     CALL 'AOSARDR0'                                                    CSE028
805400200529     C                     PARM '       ' @RTCD                                               CSE028
805500200529     C                     PARM '*VERIFY' @OPTN                                               CSE028
805600200529     C                     PARM 'CSE022'  @SARD                                               CSE028
805700200529      *                                                                                       CSE028
805800200529     C           @RTCD     IFNE *BLANKS                                                       CSE028
805900200529     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
806000200529     C                     MOVEL@SARD     DBKEY                                               CSE028
806100200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
806200200529     C                     Z-ADD003       DBASE                                               CSE028
806300200529     C                     EXSR *PSSR                                                         CSE028
806400200529     C                     ENDIF                                                              CSE028
806500200529      *                                                                                       CSE028
806600200529     C           @RTCD     IFEQ *BLANK                                                        CSE028
806700200529     C                     MOVE 'Y'       CSE022                                              CSE028
806800200529     C                     MOVEL'SEDORF'  PGMNAM  9                                           CSE028
806900200529     C                     MOVE 'RTV'     PGMNAM                                              CSE028
807000200529     C                     ENDIF                                                              CSE028
807100200529      *                                                                                       209247
807200200529      ** Check if CSE033 is present.                                                          209247
807300200529      *                                                                                       209247
807400200529     C                     MOVE 'N'       CSE033  1                                           209247
807500200529     C                     CALL 'AOSARDR0'                                                    209247
807600200529     C                     PARM '       ' @RTCD                                               209247
807700200529     C                     PARM '*VERIFY' @OPTN                                               209247
807800200529     C                     PARM 'CSE033'  @SARD                                               209247
807900200529      *                                                                                       209247
808000200529     C           @RTCD     IFNE *BLANKS                                                       209247
808100200529     C           @RTCD     ANDNE'*NRF   '                                                     209247
808200200529     C                     Z-ADD5         DBASE                                               209247
808300200529     C                     MOVEL'SE1806'  DBPGM                                               209247
808400200529     C                     MOVEL'SCSARDPD'DBFILE                                              209247
808500200529     C                     MOVEL@SARD     DBKEY                                               209247
808600200529     C                     EXSR *PSSR                                                         209247
808700200529     C                     ENDIF                                                              209247
808800200529      *                                                                                       209247
808900200529     C           @RTCD     IFEQ *BLANK                                                        209247
809000200529     C                     MOVE 'Y'       CSE033                                              209247
809100200529     C                     ENDIF                                                              209247
809200200529      *                                                                                       209247
809300200529     C           CSE033    IFEQ 'Y'                                                           209247
809400200529     C           CSE029    ANDEQ'N'                                                           209247
809500200529     C                     MOVE 'Y'       CSE029                                              209247
809600200529     C                     ENDIF                                                              209247
809700200529      *                                                                                       CSE028
809800200529      ** Determine if Compliance Watch Enhancement - CSD015                                   CSD015
809900200529      ** feature is installed.                                                                CSD015
810000200529      *                                                                                       CSD015
810100200529     C                     CALL 'AOSARDR0'                                                    CSD015
810200200529     C                     PARM *BLANKS   PRTCD                                               CSD015
810300200529     C                     PARM '*VERIFY 'POPTN   7                                           CSD015
810400200529     C                     PARM 'CSD015'  PSARD   6                                           CSD015
810500200529     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
810600200529      *                                                                                       CSD015
810700200529     C           PRTCD     IFNE *BLANKS                                                       CSD015
810800200529     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
810900200529     C                     MOVEL'SCSARDPD'DBFILE           ************                       CSD015
811000200529     C                     Z-ADD9         DBASE            * DBERR 09 *                       CSD015
811100200529     C                     MOVEL'CSD015'  DBKEY            ************                       CSD015
811200200529     C                     EXSR *PSSR                                                         CSD015
811300200529     C                     ENDIF                                                              CSD015
811400200529      *                                                                                       CSD015
811500200529     C           PRTCD     IFEQ *BLANKS                                                       CSD015
811600200529     C                     MOVE 'Y'       CSD015  1                                           CSD015
811700200529     C                     ELSE                                                               CSD015
811800200529     C                     MOVE 'N'       CSD015                                              CSD015
811900200529     C                     ENDIF                                                              CSD015
812000200529      *                                                                                       CSD015
812100200529      ** Determine if Function Code is being monitored by                                     CSD015
812200200529      ** Compliance Watch.                                                                    CSD015
812300200529      *                                                                                       CSD015
812400200529     C           CSD015    IFEQ 'Y'                                                           CSD015
812500200529      *                                                                                       CSD015
812600200529     C                     CALL 'AOWLCCR0'                                                    CSD015
812700200529     C                     PARM *BLANKS   PRTCD                                               CSD015
812800200529     C                     PARM '*KEY    'POPTN                                               CSD015
812900200529     C                     PARM 'SECTTRAD'PFUNC   8                                           CSD015
813000200529     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
813100200529      *                                                                                       CSD015
813200200529     C           PRTCD     IFNE *BLANKS                                                       CSD015
813300200529     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
813400200529     C                     MOVEL'SDWLCCPD'DBFILE           ************                       CSD015
813500200529     C                     Z-ADD10        DBASE            * DBERR 10 *                       CSD015
813600200529     C                     MOVELPFUNC     DBKEY            ************                       CSD015
813700200529     C                     EXSR *PSSR                                                         CSD015
813800200529     C                     ENDIF                                                              CSD015
813900200529      *                                                                                       CSD015
814000200529     C                     CLEARPMCWL                                                         CSD015
814100200529      *                                                                                       CSD015
814200200529     C                     ELSE                                                               CSD015
814300200529     C                     MOVE *BLANK    W1EWLC                                              CSD015
814400200529     C                     ENDIF                                                              CSD015
814500200529      *                                                                                       CSD015
814600200529      ** Determine if 24x7 Midas Availability active?                                         CSD015
814700200529      *                                                                                       CSD015
814800200529     C                     CALL 'AOSARDR0'                                                    CSD015
814900200529     C                     PARM *BLANKS   PRTCD                                               CSD015
815000200529     C                     PARM '*VERIFY' POPTN                                               CSD015
815100200529     C                     PARM 'CSC011'  PSARD                                               CSD015
815200200529     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
815300200529      *                                                                                       CSD015
815400200529     C           PRTCD     IFEQ *BLANKS                                                       CSD015
815500200529     C           *NAMVAR   DEFN           SC24X7                                              CSD015
815600200529     C                     IN   SC24X7                                                        CSD015
815700200529     C                     MOVE 'Y'       CSC011  1                                           CSD015
815800200529     C                     ELSE                                                               CSD015
815900200529     C                     MOVE 'N'       CSC011                                              CSD015
816000200529     C                     ENDIF                                                              CSD015
816100200529      *                                                                                       CSD015
816200200529     C           PRTCD     IFNE *BLANKS                                                       CSD015
816300200529     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
816400200529     C                     MOVEL'SCSARDPD'DBFILE           ************                       CSD015
816500200529     C                     Z-ADD17        DBASE            * DBERR 17 *                       CSD015
816600200529     C                     MOVEL'CSC011'  DBKEY            ************                       CSD015
816700200529     C                     EXSR *PSSR                                                         CSD015
816800200529     C                     ENDIF                                                              CSD015
816900200529      *                                                                                       CSD015
817000200529     C                     IN   SDSTAT                                                        CSD015
817100200529      *                                                                                       CSE045
817200200529      ** Check if CSE045 feature is installed                                                 CSE045
817300200529      *                                                                                       CSE045
817400200529     C                     MOVE 'N'       CSE045  1                                           CSE045
817500200529     C                     CALL 'AOSARDR0'                                                    CSE045
817600200529     C                     PARM '       ' @RTCD                                               CSE045
817700200529     C                     PARM '*VERIFY' @OPTN                                               CSE045
817800200529     C                     PARM 'CSE045'  @SARD                                               CSE045
817900200529      *                                                                                       CSE045
818000200529     C           @RTCD     IFNE *BLANKS                                                       CSE045
818100200529     C           @RTCD     ANDNE'*NRF   '                                                     CSE045
818200200529     C                     MOVEL@SARD     DBKEY                                               CSE045
818300200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSE045
818400200529     C                     Z-ADD005       DBASE                                               CSE045
818500200529     C                     EXSR *PSSR                                                         CSE045
818600200529     C                     ENDIF                                                              CSE045
818700200529      *                                                                                       CSE045
818800200529     C           @RTCD     IFEQ *BLANK                                                        CSE045
818900200529     C                     MOVE 'Y'       CSE045                                              CSE045
819000200529     C                     ENDIF                                                              CSE045
819100200529      *                                                                                       CSW210
819200200529      ** Call SWIF2010 to check if CSW210 is switched on                                      CSW210
819300200529      *                                                                                       CSW210
819400200529     C                     CALL 'SWIF2010'             7373                                   CSW210
819500200529     C                     PARM *BLANKS   @RTCD                                               CSW210
819600200529      *                                                                                       CSW210
819700200529     C           @RTCD     IFEQ 'CSW2010'                                                     CSW210
819800200529     C                     MOVE 'Y'       CSW210  1                                           CSW210
819900200529     C                     MOVE *ON       *IN72                                               CSW210
820000200529     C                     ELSE                                                               CSW210
820100200529     C                     MOVE 'N'       CSW210                                              CSW210
820200200529     C                     MOVE *OFF      *IN72                                               CSW210
820300200529     C                     ENDIF                                                              CSW210
820400200529      *                                                                                       CSW210
820500200529      ** Check if CFT004 is ON for IBAN validation                                            CSW210
820600200529     C                     MOVE 'N'       CFT004  1                                           CSW210
820700200529     C                     CALL 'AOSARDR0'                                                    CSW210
820800200529     C                     PARM '       ' @RTCD                                               CSW210
820900200529     C                     PARM '*VERIFY' @OPTN                                               CSW210
821000200529     C                     PARM 'CFT004'  @SARD                                               CSW210
821100200529      *                                                                                       CSW210
821200200529     C           @RTCD     IFNE *BLANKS                                                       CSW210
821300200529     C           @RTCD     ANDNE'*NRF   '                                                     CSW210
821400200529     C                     MOVEL@SARD     DBKEY                                               CSW210
821500200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSW210
821600200529     C                     Z-ADD07        DBASE                                               CSW210
821700200529     C                     EXSR *PSSR                                                         CSW210
821800200529     C                     ENDIF                                                              CSW210
821900200529      *                                                                                       CSW210
822000200529     C           @RTCD     IFEQ *BLANK                                                        CSW210
822100200529     C                     MOVE 'Y'       CFT004                                              CSW210
822200200529     C                     ENDIF                                                              CSW210
822300200529      *                                                                                       CSD015
822400200529     C/COPY WNCPYSRC,SE1806C059
822500200529      *
822600200529      ** Save Branch Internal Customer in workfield
822700200529     C**********           MOVE A8BICN    WWBICN  60                                          CSD027
822800200529     C                     MOVE A8BICN    WWBICN  6                                           CSD027
822900200529      *
823000200529      ** Allow Safekeeping Account Fields to be Input capable
823100200529     C                     SETOF                     10
823200200529      *
823300200529      ** Initialise Clearance Type (1 to 4 is MT580 for Settlements)
823400200529     C           PWHEN     IFNE 'B'                                       CSW003
823500200529     C           PCLTY     OREQ '1'                                       CSW003
823600200529     C           PCLTY     OREQ '3'                                       CSW003
823700200529      *                                                                   CSW003
823800200529     C           PCLTY     IFEQ '1'
823900200529     C           PCLTY     OREQ '2'
824000200529     C           PCLTY     OREQ '3'
824100200529     C           PCLTY     OREQ '4'
824200200529     C                     MOVE '14'      WWCLTY  2
824300200529     C                     END
824400200529      *                                                                   CSW003
824500200529     C                     ELSE                                           CSW003
824600200529     C           PTDTP     IFEQ 'TP'                                      CSW003
824700200529     C                     MOVE PDELF     WCUST                           CSW003
824800200529     C                     ELSE                                           CSW003
824900200529     C                     MOVE PDELT     WCUST                           CSW003
825000200529     C                     END                                            CSW003
825100200529      *                                                                   CSW003
825200200529     C                     CALL 'AOSECSR0'                                CSW003
825300200529     C                     PARM '*DBERR ' WRTCD   7                       CSW003
825400200529     C                     PARM '*KEY   ' WOPTN   7                       CSW003
825500200529     C                     PARM           WCUST   6                       CSW003
825600200529     C           SDSECS    PARM SDSECS    DSSDY                           CSW003
825700200529      *                                                                   CSW003
825800200529     C           BFCLAS    IFEQ 'E'                                       CSW003
825900200529     C           PCLTY     ANDEQ'4'                                       CSW003
826000200529     C           BFCLAS    OREQ 'E'                                       CSW003
826100200529     C           PCLTY     ANDEQ'5'                                       CSW003
826200200529     C           BFCLAS    OREQ 'C'                                       CSW003
826300200529     C           PCLTY     ANDEQ'2'                                       CSW003
826400200529     C           BFCLAS    OREQ 'C'                                       CSW003
826500200529     C           PCLTY     ANDEQ'5'                                       CSW003
826600200529     C                     MOVE '14'      WWCLTY                          CSW003
826700200529     C                     END                                            CSW003
826800200529      *                                                                   CSW003
826900200529     C                     END                                            CSW003
827000200529      *                                                                   CSW003
827100200529      *  Set up trade type as opposite, if second record                  CSW003
827200200529     C           PWHEN     IFEQ 'B'                                       CSW003
827300200529     C           PTDTP     IFEQ 'TP'                                      CSW003
827400200529     C                     MOVE 'TS'      WTDTP                           CSW003
827500200529     C                     ELSE                                           CSW003
827600200529     C                     MOVE 'TP'      WTDTP                           CSW003
827700200529     C                     END                                            CSW003
827800200529      *                                                                   CSW003
827900200529     C                     ELSE                                           CSW003
828000200529     C                     MOVE PTDTP     WTDTP   2                       CSW003
828100200529     C                     END                                            CSW003
828200200529      *
828300200529      ** Set up non-input capable screen fields from parm received.
828400200529     C           PACTN     IFEQ 'B'
828500200529     C                     MOVEL'I'       SACTN
828600200529     C                     ELSE
828700200529     C                     MOVE PACTN     SACTN
828800200529     C                     ENDIF
828900200529     C                     MOVE PTDRF     STDRF
829000200529     C                     MOVE PBLKR     SBLKR
829100200529     C                     MOVE PSESN     SSESN
829200200529     C                     MOVE PSRPN     SSRPN
829300200529      *                                                                   CSW003
829400200529      * Set up screen title for destination depot                         CSW003
829500200529      *                                                                   CSW003
829600200529     C           PWHEN     IFNE *BLANKS                                   CSW003
829700200529     C           PDELF     IFNE PDELT                                     CSW003
829800200529     C                     MOVE PTCNR     WCUST                           CSW003
829900200529     C                     CALL 'AOSECSR0'                                CSW003
830000200529     C                     PARM '*DBERR ' WRTCD   7                       CSW003
830100200529     C                     PARM '*KEY   ' WOPTN   7                       CSW003
830200200529     C                     PARM           WCUST   6                       CSW003
830300200529     C           SDSECS    PARM SDSECS    DSSDY                           CSW003
830400200529      *                                                                   CSW003
830500200529     C           BFCLAS    IFEQ 'S'                                       CSW003
830600200529     C           BFCLAS    OREQ 'D'                                       CSW003
830700200529      *                                                                   CSW003
830800200529     C           PWHEN     IFEQ 'A'                                       CSW003
830900200529     C           PTDTP     IFEQ 'TP'                                      CSW003
831000200529     C                     SETON                     04                   CSW003
831100200529     C                     ELSE                                           CSW003
831200200529     C                     SETON                     03                   CSW003
831300200529     C                     END                                            CSW003
831400200529     C                     ELSE                                           CSW003
831500200529     C           PTDTP     IFEQ 'TP'                                      CSW003
831600200529     C                     SETON                     03                   CSW003
831700200529     C                     ELSE                                           CSW003
831800200529     C                     SETON                     04                   CSW003
831900200529     C                     END                                            CSW003
832000200529     C                     END                                            CSW003
832100200529     C                     END                                            CSW003
832200200529     C                     END                                            CSW003
832300200529      *                                                                   CSW003
832400200529      *  Non-display A/c for payment & Safe-keeping a/c if destination    CSW003
832500200529      *  Euroclear or Cedel                                               CSW003
832600200529     C           WWCLTY    IFEQ '14'                                      CSW003
832700200529     C/COPY WNCPYSRC,SE1806C061
832800200529     C                     SETON                     05                   CSW003
832900200529     C/COPY WNCPYSRC,SE1806C062
833000200529     C                     ELSE                                           CSW003
833100200529      *                                                                   CSW003
833200200529      * Non-display Clearing Correspondent if Destination is neither      CSW003
833300200529      * Cedel nor Euroclear                                               CSW003
833400200529      *                                                                   CSW003
833500200529     C                     SETON                     06                   CSW003
833600200529     C                     END                                            CSW003
833700200529      *                                                                   CSW003
833800200529      * Non-display either Receiver or Deliverer of Securities depending  CSW003
833900200529      * on the type                                                       CSW003
834000200529      *                                                                   CSW003
834100200529     C           WTDTP     IFEQ 'TP'                                      CSW003
834200200529     C                     SETON                     08                   CSW003
834300200529     C                     ELSE                                           CSW003
834400200529     C                     SETON                     07                   CSW003
834500200529     C                     END                                            CSW003
834600200529     C                     END                                            CSW003
834700200529     C*                                                                                       209247
834800200529      * Display narrative for Receiver's Custodian and Safe A/C                               209247
834900200529     C*                                                                                       209247
835000200529     C           *IN08     IFEQ *OFF                                                          209247
835100200529     C           CSE029    ANDEQ'Y'                                                           209247
835200200529     C                     MOVE *ON       *IN70                                               209247
835300200529     C                     ENDIF                                                              209247
835400200529     C*                                                                                       209247
835500200529      * Display narrative for Deliverer's Custodian and Safe A/C                              209247
835600200529     C*                                                                                       209247
835700200529     C           *IN07     IFEQ *OFF                                                          209247
835800200529     C           CSE029    ANDEQ'Y'                                                           209247
835900200529     C                     MOVE *ON       *IN71                                               209247
836000200529     C                     ENDIF                                                              209247
836100200529      *                                                                                       201429
836200200529      ** Enable display of counterparty safekeeping a/c if                                    201429
836300200529      ** CSE028 is on and ISO15022 is on.                                                     201429
836400200529      *                                                                                       201429
836500200529     C           CSE028    IFEQ 'Y'                                                           201429
836600200529     C           PSNEW     ANDEQ'Y'                                                           201429
836700200529     C           PGMES     ANDEQ'Y'                                                           201429
836800200529     C                     MOVE *ON       *IN78                                               201429
836900200529     C                     ELSE                                                               201429
837000200529     C                     MOVE *OFF      *IN78                                               201429
837100200529     C                     ENDIF                                                              201429
837200200529      *
837300200529     C/COPY WNCPYSRC,SE1806C002
837400200529     C                     ENDSR
837500200529      *
837600200529      *****************************************************************
837700200529      /EJECT
837800200529     C/COPY WNCPYSRC,SE1806C019
837900200529      *****************************************************************
838000200529      **                                                              *
838100200529      **  *PSSR     - To Handle Database Errors                       *
838200200529      **                                                              *
838300200529      **  Calls     -                                                 *
838400200529      **  Called By -                                                 *
838500200529      **                                                              *
838600200529      *****************************************************************
838700200529      *
838800200529     C           *PSSR     BEGSR
838900200529      *
839000200529     C           WRUN      IFEQ *BLANK
839100200529     C/COPY WNCPYSRC,SE1806C060
839200200529     C                     MOVE 'Y'       WRUN    1
839300200529     C                     MOVEL'SE1806'  DBPGM
839400200529     C           *NAMVAR   DEFN LDA       WLDA  256
839500200529     C           *LOCK     IN   WLDA
839600200529     C                     MOVE DBERR     WLDA
839700200529     C                     OUT  WLDA
839800200529     C                     SETON                     U7U8LR
839900200529     C                     DUMP
840000200529     C                     END
840100200529      *
840200200529      ** Call standard DB error handler
840300200529     C                     CALL 'DBERRCTL'             81
840400200529      *
840500200529     C                     ENDSR
840600200529      *
840700200529      *****************************************************************
840800200529      **/EJECT*********************************************************                CSW098 CSW210
840900200529      *****************************************************************   CSW098
841000200529      *****************************************************************                CSW098 CSW210
841100200529      ****SRINVE****-*To*Validate*Investor*****************************                CSW098 CSW210
841200200529      *****************************************************************                CSW098 CSW210
841300200529      ****Calls*****-*SRCUST*******************************************                CSW098 CSW210
841400200529      ****Called*By*-*SRVAL********************************************                CSW098 CSW210
841500200529      *****************************************************************                CSW098 CSW210
841600200529      *****************************************************************                CSW098 CSW210
841700200529      **********                                                                       CSW098 CSW210
841800200529     C********** SRINVE    BEGSR                                                       CSW098 CSW210
841900200529      **********                                                                       CSW098 CSW210
842000200529     C********** SINVE     IFNE *BLANKS                                                CSW098 CSW210
842100200529     C**********           MOVELSINVE     WWCUST                                       CSW098 CSW210
842200200529     C**********           EXSR SRCUST                                                 CSW098 CSW210
842300200529      **********                                                                       CSW098 CSW210
842400200529     C**********           SELEC                                                       CSW098 CSW210
842500200529     C********** WWCUSS    WHEQ 'C'                                                    CSW098 CSW210
842600200529     C********** WWCUSS    OREQ 'S'                                                    CSW098 CSW210
842700200529     C**********           MOVELBBCUST    WWINVE 10                                    CSW098 CSW210
842800200529     C********** WWCUSS    WHEQ 'N'                                                    CSW098 CSW210
842900200529     C**********           MOVELAWCPNC    WWINVE                                       CSW098 CSW210
843000200529      **********                                                                       CSW098 CSW210
843100200529      ***Set*on*error indicator for Investor.                                          CSW098 CSW210
843200200529     C**********           OTHER                                                       CSW098 CSW210
843300200529     C**********           MOVE *ON       *IN19                                        CSW098 CSW210
843400200529     C**********           ENDSL                                                       CSW098 CSW210
843500200529      **********                                                                       CSW098 CSW210
843600200529     C**********           ELSE                                                        CSW098 CSW210
843700200529     C**********           MOVE *BLANKS   WWINVE                                       CSW098 CSW210
843800200529     C**********           ENDIF                                                       CSW098 CSW210
843900200529      **********                                                                       CSW098 CSW210
844000200529     C**********           ENDSR                                                       CSW098 CSW210
844100200529      *                                                                   CSW098
844200200529      *****************************************************************   CSW098
844300200529      /EJECT                                                              CSW098
844400200529      *****************************************************************   CSW098
844500200529      **                                                              *   CSW098
844600200529      **  SRME99    - To Validate Account with Line via ME9940        *   CSW098
844700200529      **                                                              *   CSW098
844800200529      **  Calls     -                                                 *   CSW098
844900200529      **  Called By - SRAWIL, SRBOF1                                  *   CSW098
845000200529      **                                                              *   CSW098
845100200529      *****************************************************************   CSW098
845200200529      *                                                                   CSW098
845300200529     C           SRME99    BEGSR                                          CSW098
845400200529      *                                                                   CSW098
845500200529     C                     CALL 'ME9940'                                  CSW098
845600200529     C                     PARM           W0RTN   7                       CSW098
845700200529     C                     PARM           I#PARM                          CSW098
845800200529     C                     PARM           O#PARM                          CSW098
845900200529     C                     PARM           E#PARM                          CSW098
846000200529     C                     PARM           Z#PARM256                       CSW098
846100200529      *                                                                   CSW098
846200200529     C                     MOVELO#ACLN    WWLI35                          CSW098
846300200529     C           E#ERRM    IFNE *BLANKS                                   CSW098
846400200529     C                     MOVEL'Y'       WWER35                          CSW098
846500200529     C                     MOVE *ON       *IN75                           CSW098
846600200529     C                     ELSE                                           CSW098
846700200529      *                                                                   CSW098
846800200529      ** Check whether Issuer Code has been defined for the currency      CSW098
846900200529      ** clearing system. If not, set flag on to issue warning message    CSW098
847000200529      ** for later display (SEW5176).                                     CSW098
847100200529     C                     MOVELZ#PARM    W#ISCD  4                       CSW098
847200200529     C           WWLI02    IFEQ '//'                                      CSW098
847300200529     C           W#ISCD    ANDEQ*BLANKS                                   CSW098
847400200529     C           O#ACLN    ANDNEWACLN                                     CSW098
847500200529     C                     MOVEL'Y'       WICNIL  1                       CSW098
847600200529     C                     ENDIF                                          CSW098
847700200529      *                                                                   CSW098
847800200529     C                     ENDIF                                          CSW098
847900200529      *                                                                   CSW098
848000200529     C                     ENDSR                                          CSW098
848100200529      *****************************************************************                       CSW201
848200200529      **                                                              *                       CSW201
848300200529      **  SR2001    - To Validate Swift2001 Codewords                 *                       CSW201
848400200529      **                                                              *                       CSW201
848500200529      **  Calls     - None                                            *                       CSW201
848600200529      **  Called By - SRSRL1, SRSRL2, SRSRL3                          *                       CSW201
848700200529      **                                                              *                       CSW201
848800200529      *****************************************************************                       CSW201
848900200529      *                                                                                       CSW201
849000200529     C           SR2001    BEGSR                                                              CSW201
849100200529      *                                                                                       CSW201
849200200529     C                     MOVEAWWSR10    WARY                                                CSW201
849300200529     C                     MOVE 'N'       WERR    1                                           CSW201
849400200529     C                     Z-ADD1         X       30                                          CSW201
849500200529      *                                                                                       CSW201
849600200529     C           X         DOWLT10                                                            CSW201
849700200529     C           WERR      ANDEQ'N'                                                           CSW201
849800200529     C                     ADD  1         X                                                   CSW201
849900200529     C           WARY,X    LOKUPVA0                      90                                   CSW201
850000200529      *                                                                                       CSW201
850100200529     C           WARY,X    IFEQ '/'                                                           CSW201
850200200529     C                     LEAVE                                                              CSW201
850300200529     C                     ENDIF                                                              CSW201
850400200529      *                                                                                       CSW201
850500200529     C           *IN90     IFEQ *OFF                                                          CSW201
850600200529     C           X         OREQ 10                                                            CSW201
850700200529     C           WARY,X    ANDNE'/'                                                           CSW201
850800200529     C                     MOVE 'Y'       WERR                                                CSW201
850900200529     C                     ENDIF                                                              CSW201
851000200529      *                                                                                       CSW201
851100200529     C                     ENDDO                                                              CSW201
851200200529      *                                                                                       CSW201
851300200529     C           WARY,2    IFNE '/'                                                           CSW201
851400200529     C           WERR      ANDEQ'N'                                                           CSW201
851500200529     C                     MOVE 'Y'       WWVALI                                              CSW201
851600200529     C                     ENDIF                                                              CSW201
851700200529      *                                                                                       CSW201
851800200529     C                     ENDSR                                                              CSW201
851900200529      *                                                                                       CSW201
852000200529      *****************************************************************   CSW098
852100200529      /EJECT
852200200529     C/COPY ZSRSRC,ZALIGNZ2
852300200529      /EJECT
852400200529     C/COPY ZSRSRC,ZSEDITZ3
852500200529      /EJECT
852600200529      ***
852700200529**  CPY@
852800200529(c) Finastra International Limited 2001
852900200529**  VA0  - All Numeric Chars
853000200529ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
853100200529** CWA - Array for watch list fields                                                          CSD015
853200200529<MT510 A/C for Payment>                                                                       CSD015
853300200529</MT510 A/C for Payment>                                                                      CSD015
853400200529<Account for Payment>                                                                         CSD015
853500200529</Account for Payment>                                                                        CSD015
853600200529<A/C with Institution>                                                                        CSD015
853700200529</A/C with Institution>                                                                       CSD015
853800200529<Beneficiary>                                                                                 CSD015
853900200529</Beneficiary>                                                                                CSD015
854000200529<Instructing Party>                                                                           CSD015
854100200529</Instructing Party>                                                                          CSD015
854200200529<Counterparty>                                                                                CSD015
854300200529</Counterparty>                                                                               CSD015
854400200529<MT510 Safekeeping A/C>                                                                       CSD015
854500200529</MT510 Safekeeping A/C>                                                                      CSD015
854600200529<Safekeeping Account>                                                                         CSD015
854700200529</Safekeeping Account>                                                                        CSD015
854800200529<Deliverr Instrctg Prty>                                                                      CSD015
854900200529</Deliverr Instrctg Prty>                                                                     CSD015
855000200529<Receivers of Securties>                                                                      CSD015
855100200529</Receivers of Securties>                                                                     CSD015
855200200529<Deliverrs of Securties>                                                                      CSD015
855300200529</Deliverrs of Securties>                                                                     CSD015
855400200529<Benfciary of Securties>                                                                      CSD015
855500200529</Benfciary of Securties>                                                                     CSD015
855600200529<Investor>                                                                                    CSD015
855700200529</Investor>                                                                                   CSD015
855800200529<Debtor>                                                                                      CSW210
855900200529</Debtor>                                                                                     CSW210
856000200529<Qualified Foreign Intermediary>                                                              CSW210
856100200529</Qualified Foreign Intermediary>                                                             CSW210
856200200529<Sttlmnt Prty Intmdiary>                                                                      CSD015
856300200529</Sttlmnt Prty Intmdiary>                                                                     CSD015
856400200529<Safkeepg A/C Intmdiary>                                                                      CSD015
856500200529</Safkeepg A/C Intmdiary>                                                                     CSD015
856600200529**  STAMP - Dummy Timestamp                                                                   CSE045
8567002005290001-01-01-00.00.00.000000                                                                    CSE045
856800200529** S210W                                                                                      CSW210
856900200529A/c for Payment Account Line                                                                  CSW210
857000200529Debtor Account Line                                                                           CSW210
857100200529A/c with Institution Account Line                                                             CSW210
857200200529Beneficiary of Money Account Line                                                             CSW210
