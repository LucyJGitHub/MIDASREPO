     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Trades extended settlements maint')           *
/*XBIA*  OVRDBF FILE(TRADSDZ2) TOFILE(TRADSDY2) SHARE(*NO)            *
     F/COPY WNCPYSRC,SE1806F002
      *****************************************************************
      *                                                               *
      *  Midas - Securities Trading Module                            *
      *                                                               *
      *  SE1806 - Trades Extended Settlements for MT5xxs              *
      *                                                               *
      *  Function: This program allows input of the fields needed     *
      *   (I/C)    to produce the SWIFT Messages - MT5XX.             *
      *                                                               *
      *  Called By: SE1805 - Trades Input - Extension File for MT5xx  *
      *                                                               *
      *         NB. ANY CHANGE MADE TO THIS PGM WILL ALMOST           *
      *             DEFINITELY NEED TO BE APPLIED TO SE1808           *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 248683             Date 22May20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 AR573194           Date 19Aug14               *
      *                 212937             Date 09Jul10               *
      *                 AR642262           Date 14Sep10               *
      *                 AR640699           Date 09Sep10               *
      *                 AR635017           Date 28Aug10               *
      *                 AR632000           Date 24Aug10               *
      *                 AR589193           Date 09Aug10               *
      *                 CSW210             Date 04May10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSE071             Date 19Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 215783             Date 25MAR03               *
      *                 215058             Date 21FEB03               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 218770             Date 13Jun03               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3122            Date 17Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222331             Date 21Oct03               *
      *                 218770             Date 13Jun03               *
      *                 CSE045             Date 24Mar03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 209945             Date 13Nov02               *
      *                 211823             Date 11NOV02               *
      *                 209247             Date 08Oct02               *
      *                 209949             Date 08Oct02               *
      *                 209890             Date 01Oct02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 205689             Date 13May02               *
      *                 205667             Date 09May02               *
      *                 205665             Date 08May02               *
      *                 CSE034             Date 22Apr02               *
      *                 204960             Date 17Apr02               *
      *                 204917             Date 17Apr02               *
      *                 204804             Date 15Apr02               *
      *                 204592             Date 10Apr02               *
      *                 204550             Date 04Apr02               *
      *                 204464             Date 02Apr02               *
      *                 204151             Date 21Mar02               *
      *                 201429             Date 24Dec01               *
      *                 178484             Date 25Oct01               *
      *                 199797             Date 01Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE028             Date 06Jun01               *
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSW014             Date 22Jun98               *
      *                 CSW098             Date 06Apr98               *
      *                 056348             DATE 08MAY96               *
      *                 061028             DATE 08MAY96               *
      *                 086910             DATE 08MAY96               *
      *                 CSW003             DATE 08FEB96               *
      *                 084735             DATE 23MAY95               *
      *                 S01401             DATE 16JUN93               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  248683 - Write 'Y' to SE1806 Data Area Flag.                 *
      *  MD046248 - Finastra Rebranding                               *
      *  AR573194 - TRDN screen does not continue on deal cannot be   *
      *           saved. Applied fix 212937.                          *
      *  212937 - Validation of fields should not be conditioned on   *
      *           the clearance type                                  *
      *  AR642262 - Error in IBAN validation                          *
      *  AR640699 - Debtor Address - DSS/Account test                 *
      *  AR635017 - Account with institution and Beneficiary of money *
      *             was not displayed in MT541, MT518 and MT545       *
      *  AR632000 - BULK- Error Message appear" In Deliver instruc-   *
      *             tions, this field can only be used for a trade    *
      *             confirmation."                                    *
      *  AR589193 - Error on ? in Extended settlement field           *
      *  CSW210 - SWIFT 2010 Changes                                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  215783 - Place of settlement not defaulted if no SSI exist.  *
      *           Fix is to default value from market center details  *
      *           if no SSi exist.                                    *
      *  215058 - RESET PARM TO BLANK WHE CALLING SEDORFRTV           *
      *  218770 - Defaulting of counterparty safekeeping a/c incorrect*
      *           Fix is to default value of 'For a/c of' in SSI if   *
      *           not blanks, otherwise take normal defaulting.       *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222321 - Initialise field for CSE045 should be done          *
      *           uncondition to the switchable feature               *
      *  218770 - Defaulting of counterparty safekeeping a/c incorrect*
      *           Fix is to default value of 'For a/c of' in SSI if   *
      *           not blanks, otherwise take normal defaulting.       *
      *  CSE045 - API for Extended Settlement for Trade Input and     *
      *           Depot Movement                                      *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  209945 - When enquiring a Trade, when rollup is taken from   *
      *           the 3rd screen of the Extended Settlements, program *
      *           goes to the first screen                            *
      *  211823 - SAFEKEEPING A/C SHOULD DEFAULT BASED ON DEPOT IF NOT*
      *           BY BICN                                             *
      *  209247 - Add Custodian and Safe A/c narrative                *
      *  209949 - Deliverer of field is not being defaulted           *
      *  209890 - SWIFT ISO 15022. Defaulting of the Counterparty     *
      *           Safekeeping Account                                 *
      *  205689 - Removed core fix 178484.                            *
      *  205667 - Incorrect SSI defaulting when Market Centre used.   *
      *  205665 - Incorrect Counterparty Safekeeping account.         *
      *  CSE034 - Standard Settlement Instruction improvements        *
      *  204960 - Default Reg Details from Book SSI for Trade Purch.  *
      *  204917 - Incorrect validation in Instructing Party field.    *
      *  204804 - Clearing Correspondent validation incorrect.        *
      *  204592 - Safekeeping account defaulting.                     *
      *  204550 - Receiver/Deliverer of securities defaulting.        *
      *  204464 - Receiver/Deliverer of securities should only be     *
      *           defaulted for confirmation requests.                *
      *  204151 - Amendments to trade extended settlements not done.  *
      *           Problem was caused by indicator 84 not being reset. *
      *  201429 - New validation needed for ISO15022 in               *
      *           extended settlement screen.                         *
      *  178484 - Re introduced fields for validation purposes.       *
      *           Compile Only.                                       *
      *  199797 - Additional changes and fixes for CSE028 (SSIs).     *
      *  CSE028 - Standing Settlement Instructions Enhancement.       *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  CSW014 - ERI information for non-EMU users.                  *
      *         - Allow '/OCMT/' codeword on the "Sender to Receiver" *
      *           field.                                              *
      *  CSW098 - SWIFT 98 changes. New fields added.                 *
      *  056348 - FIELD 72 DOES NOT ACCEPT CODE WORK /TRADECP/        *        *
      *  061028 - Second and third part of field 72 does not accept   *
      *           blank                                               *
      *  086910 - If account line used for field 87 --> deliverer of  *
      *           securities should be inserted also.                 *
      *  CSW003 - MT5xx Message Generation - Phase 2                  *
      *  084735 - Recompile over changed file SE50DT.                 *
      *  S01401 - The generation of MT5xx SWIFT Messages if the option*
      *           is available.  NEW PROGRAM.                         *
      *                                                               *
      *****************************************************************
      *
     FTRADSDY2UF  E           K        DISK         KCOMIT       A
     F            TRADSDD2                          KRENAMEUPDIDX
     FTRADSDZ2IF  E           K        DISK
     F            TRADSDD2                          KRENAMERTVIDX
     FSECTY   IF  E           K        DISK                                                   199797
     F*
     FSEMKC   IF  E           K        DISK                                                   215783
     F*                                                                                       215783
     FSDCUSTL7IF  E           K        DISK                                                   204804
     F            @CUSTGE                           KRENAMESDCUSTSW                           204804
      *                                                                                       CSD015
      **  Compliance Watch Hit List File                                                      CSD015
     FSDCWHTL1IF  E           K        DISK                                                   CSD015
      *                                                                                       CSD015
     FSE1806DFCF  E                    WORKSTN
     F/COPY WNCPYSRC,SE1806F001
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*    02  - Off=no errors on second screen                       *
     F*    03  - Destination From Depot                               *   CSW003
     F*    04  - Destination To Depot                                 *   CSW003
     F*    05  - Euroclear/Cedel destination                          *   CSW003
     F*    06  - Non Euroclear/Cedel destination                      *   CSW003
     F*    07  - Deliver message                                      *   CSW003
     F*    08  - Receive message                                      *   CSW003
     F*    09  - Protect Input Fields                                 *
     F*    10  - Protect Input Fields                                 *
     F*    11  - Not Found(SDCWHTL1)                                  *                       CSD015
     F*    11  - Debtor Identification                                *                       CSW210
     F*    12  - Debtor Account Line                                  *                       CSW210
     F*    14  - Debtor Address Line                                  *                       CSW210
     F*    15  - Debtor Address Line                                  *                       CSW210
     F*    16  - Debtor Address Line                                  *                       CSW210
     F*    17  - Debtor Address Line                                  *                       CSW210
     F*    19  - Investor                                             *   CSW098
     F*    20  - Switchable feature CSW098 is on or date is greater   *   CSW098
     F*          than 16 October 1998. Can also be error on call to   *   CSW098
     F*          SWIFT98.                                             *   CSW098
     F*    21  - A/c for Payment (MT510)                              *
     F*    22  -   "                                                  *
     F*    23  - A/c for Payment                                      *
     F*    24  -   "                                                  *
     F*    25  - A/c with Institution                                 *
     F*    26  -   "                                                  *
     F*    27  -   "                                                  *
     F*    28  - Beneficiary of Money                                 *
     F*    29  -   "                                                  *
     F*    30  -   "                                                  *
     F*    31  -   "                                                  *
     F*    32  - A/c for Charges                                      *
     F*    33  -   "                                                  *
     F*    34  - Sender to Receiver Information                       *
     F*    35  -   "                                                  *
     F*    36  -   "                                                  *
     F*    37  - Further Information                                  *
     F*    38  -   "                                                  *
     F*    39  - Registration Details                                 *
     F*    40  -   "                                                  *
     F*    41  - Narrative                                            *
     F*    42  -   "                                                  *
     F*    43  - Instructing Party                                    *
     F*    44  -   "                                                  *
     F*    45  - Counterparty (MT512)                                 *
     F*    46  -   "                                                  *
     F*    47  - Safekeeping A/c (MT510)                              *
     F*    48  -   "                                                  *
     F*    49  - Safekeeping A/c                                      *
     F*    50  -   "                                                  *
     F*    51  - Clearing Correspondent                               *
     F*    52  - Deliverer's Instructing Party                        *
     F*    53  - Receiver of Securities                               *
     F*    54  -   "                                                  *
     F*    55  -   "                                                  *
     F*    56  -   "                                                  *
     F*    57  -   "                                                  *
     F*    58  -   "                                                  *
     F*    59  - Deliverer of Securities                              *
     F*    60  -   "                                                  *
     F*    61  -   "                                                  *
     F*    62  -   "                                                  *
     F*    63  -   "                                                  *
     F*    64  -   "                                                  *
     F*    65  - Beneficiary Securities                               *
     F*    66  -   "                                                  *
     F*    67  -   "                                                  *
     F*    68  -   "                                                  *
     F*    69  - Indicator for SFLEND in SE1806DF                     *
     F*    70  - Receive message and CSE029 is on                     *                       209247
     F*    71  - Deliver message and CSE029 is on                     *                       209247
     F*    75  - General error in validation                          *
      *    76  - CSE028 is switched on                                *                       CSE028
      *    77  - ISO15022 is 'Y'                                      *                       CSE028
      *    79  - CHAIN in file SEMKCD                                 *                       215783
     F*    80  - No record found on chain                             *
     F*    81  - Work indicator                                       *
     F*    82  - Work indicator                                       *
      *    83  - CHAIN Indicator                                      *                       CSE028
      *    84  - Rollup on second screen                              *                       CSE028
     F*    85  - Rollup on first screen                               *
     F*    86  - Rolldown on second screen                            *
     F*    87  - Rolldown on first screen                             *
     F*    88  - Error on file update                                 *
     F*    89  - Error on file update                                 *
     F*                                                               *
     F*  90-99 - Used by Standard Subroutines                         *
     F*                                                               *
     F*  U7+U8 - Database Error                                       *
     F*                                                               *
     F*    KL  - Previous screen requested                            *
     F*    KS  - F18 - Override requested                             *
     F*    KT  - F19 - Reset Requested                                *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  SRINS  - Process Insert                                      *
     F*  SRAMD  - Process Amend                                       *
     F*  SRENQ  - Process Enquiry                                     *
     F*  SRSMSG - Routine to send messages to message subfile.        *
     F*  SRALOC - Routine to access record via update index           *
     F*  SRRTRN - Routine to set up return code for calling program   *
     F*  SRSCR1 - Routine to output messages and first screen         *
     F*  SRSCR2 - Routine to output messages and second screen        *
      *  SRSCR3 - Routine to output third screen                      *                       CSE028
     F*  SRVAL  - Routine to control validation of each field.        *
     F*  SRAP1N - Validate A/c for Payment :53: (MT510)               *
     F*  SRAP1L - Validate A/c for Payment A/c Line :53: (MT510)      *
     F*  SRAFPN - Validate A/c for Payment :53:                       *
     F*  SRAFPL - Validate A/c for Payment A/c Line :53:              *
     F*  SRAWIA - Validate A/c with Institution TAG :57:              *
     F*  SRAWIN - Validate A/c with Institution :57:                  *
     F*  SRAWIL - Validate A/c with Institution A/c Line :57:         *
     F*  SRDIDN - Validate Debtor Identification                      *                       CSW210
     F*  SRDADD - Validate Debtor Address                             *                       CSW210
     F*  SRDLIN - Validate Debtor Account Line                        *                       CSW210
     F*  SRSWFT - SWIFT Address validation                            *                       CSW210
     F*  SRACHK - Validate Address Fields                             *                       CSW210
     F*  SRSWST - Check for valid Swift character used                *                       CSW210
     F*  SRVCDE - Checks the syntax of code word                      *                       CSW210
     F*  SRIBAN - IBAN Validation                                     *                       CSW210
     F*  SREMSG - To Send Messages to Message Subfile with            *                       CSW210
     F*           Message Data                                        *                       CSW210
     F*  SRBOFA - Validate Beneficiary of Money TAG :58:              *
     F*  SRBOFN - Validate Beneficiary of Money :58:                  *
     F*  SRBOF1 - Validate Beneficiary of Money A/c Line :58:         *
     F*  SRBOF2 - Validate Beneficiary of Money A/c Line :58:         *
     F*  SRACL1 - Validate A/c Charges Line 1 :71:                    *
     F*  SRACL2 - Validate A/c Charges Line 2 :71:                    *
     F*  SRSRL1 - Validate Sender to Receiver Info Line 1 :72:        *
     F*  SRSRL2 - Validate Sender to Receiver Info Line 2 :72:        *
     F*  SRSRL3 - Validate Sender TO Receiver INFO Line 3 :72:        *
     F*  SRFIN1 - Validate Further Information Line 1 :77:            *
     F*  SRFIN2 - Validate Further Information Line 2 :77:            *
     F*  SRRED1 - Validate Registration Details Line 1 :77:           *
     F*  SRRED2 - Validate Registration Details Line 1 :77:           *
     F*  SRNAL1 - Validate Narrative 1 :79:                           *
     F*  SRNAL2 - Validate Narrative 2 :79:                           *
     F*  SRIPYN - Validate Instructing Party :82:                     *
     F*  SRIPYL - Validate Instructing Party A/c Line :82:            *
     F*  SRCTYN - Validate Counterparty :82:                          *
     F*  SRCTYL - Validate Counterparty A/c Line :82:                 *
     F*  SRSA1N - Validate Safekeeping Account :83: (MT510)           *
     F*  SRSA1L - Validate Safekeeping Account A/c Line :83: (MT510)  *
     F*  SRSKAN - Validate Safekeeping Account :83:                   *
     F*  SRSKAL - Validate Safekeeping Account A/c Line :83:          *
     F*  SRCCTN - Validate Clearing Correspondent :84:                *
     F*  SRDCTL - Validate Deliver's Instructing Party :85:           *
     F*  SRRSSA - Validate Receiver of Securities TAG :87:            *
     F*  SRRSSN - Validate Receiver of Securities :87:                *
     F*  SRRSS1 - Validate Receiver of Securities A/c Line 1 :87:     *
     F*  SRRSS2 - Validate Receiver of Securities A/c Line 2 :87:     *
     F*  SRRSS3 - Validate Receiver of Securities A/c Line 3 :87:     *
     F*  SRRSS4 - Validate Receiver of Securities A/c Line 4 :87:     *
     F*  SRDSSA - Validate Deliverer of Securities TAG :87:           *
     F*  SRDSSN - Validate Deliverer of Securities :87:               *
     F*  SRDSS1 - Validate Deliverer of Securities A/c Line 1 :87:    *
     F*  SRDSS2 - Validate Deliverer of Securities A/c Line 2 :87:    *
     F*  SRDSS3 - Validate Deliverer of Securities A/c Line 3 :87:    *
     F*  SRDSS4 - Validate Deliverer of Securities A/c Line 4 :87:    *
     F*  SRBSSA - Validate Beneficiary of Securities TAG :88:         *
     F*  SRBSSN - Validate Beneficiary of Securities :88:             *
     F*  SRBSS1 - Validate Beneficiary of Securities A/c Line :88:    *
     F*  SRBSS2 - Validate Beneficiary of Securities A/c Line :88:    *
     F*  SRCUST - Validate Customer Number/Shortname/Nostro           *
     F*  SRLI35 - Validate A 35 Alpha Input Field                     *
     F*  SRME99 - Validate a 35 Alpha Input Field via ME9940          *   CSW098
     F*  SRINVE - Validate Investor.                                  *   CSW098
     F*  SRFMT  - Format watch list fields                            *                       CSD015
     F*  SRCWV1 - Validate if watch list field is not blanks.         *                       CSD015
     F*  SRCWV2 - Validate if watch list field has been changed.      *                       CSD015
     F*  SRCLS2 - To Clear Fields on Second Screen                    *
     F*  SRRTS2 - To Reset Fields on Second Screen to File Values     *
     F*  SRFTOS - To Move File Fields to Screen Fields                *
     F*  SRSTOF - To Move Screen Fields to File Fields                *
     F*  SRINIT - Routine to handle initial processing                *
     F*  *PSSR  - Routine to handle database errors                   *
     F*                                                               *
     F*  ZALIGN - Validate and right-align Numeric Fields             *
     F*  ZSEDIT - Insert dec. point and sign into numeric field and   *
     F*           blank out leading zeros, optionally inserting commas*
     F*                                                               *
     F*  ZA0340 - Send a message to the program message queue         *
     F*  ZA0250 - Clear program message queue                         *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E                    CPY@    1   1 80
     E                    CCO        12  1               Clearing Correspondent
     E                    VA0    36  36  1               Validations Alpha
     E**********          CWA     1  30 25               Midas Compliance Watch Tags   CSD015 CSW210
     E                    CWA     1  34 25               Midas Compliance Watch Tags          CSW210
     E                    WARY       10  1                                                    CSW201
      ** Work Array                                                                           CSW201
      *                                                                                       CSD015
     E**********          WLF        13 35                                             CSD015 CSW210
     E                    WLF        15 35                                                    CSW210
     E                    MMD         9 35                                                    CSD015
     E                    MSA         9 35                                                    CSD015
      **  Watch List Fields Work Arrays.                                                      CSD015
      *                                                                                       CSD015
     E                    STAMP   1   1 26                                                    CSE045
      ** Array containing Dummy Timestamp for Initialisation                                  CSE045
     E                    S210W   1   4 45                                                    CSW210
      * IBAN warning array                                                                    CSW210
     E*
     E/COPY ZSRSRC,ZALIGNZ1
     E*
     E/COPY ZSRSRC,ZSEDITZ1
     E*
     I/EJECT
     I/COPY ZSRSRC,ZSEDITZ2
      ** ZSEDIT data structure
      *
     IWWDS1       DS                             35
     I                                        1  35 WWLI35
     I                                        5   7 WW0507
     I                                        5  10 WW0510
     I                                        5  12 WW0512
     I                                        5  13 WW0513
     I                                        5  35 WW0535
     I                                        8  35 WW0835
     I                                       11  35 WW1135
     I                                       13  35 WW1335
     I                                       14  35 WW1435
      *
     I           SDS
      ** Get program name and window id from PSDS
     I                                     *PROGRAM WWPGM
     I                                      244 253 SJOB
     I                                      254 263 SUSER
      *
     I/COPY WNCPYSRC,SE1806I001
     IDSFDY     E DSDSFDY
      ** First Data Structure for Access Objects
      *
     IDSSDY     E DSDSSDY
      ** Second Data Structure for Access Objects
      *
     ISC24X7    E DSSC24X7                                                                    CSD015
      * 24X7 Data Structure                                                                   CSD015
      *                                                                                       CSD015
     ISDSTAT    E DSSDSTAT                                                                    CSD015
      * SDSTAT Data Structure                                                                 CSD015
      *                                                                                       CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      ** Midas Functions for Watch List Checking Deatils File                                 CSD015
      *                                                                                       CSD015
     ISCSARD    E DSSCSARDPD                                                                  CSD015
     I              LCD                             SARLCD                                    CSD015
      ** External DS for SAR details                                                          CSD015
      *                                                                                       CSD015
     ISDBANK    E DSSDBANKPD
      ** Bank details
      *
     ISDBRCH    E DSSDBRCHPD
      ** Branch details
      *
     ISDCUST    E DSSDCUSTPD
     I              QQDFAC                          QQDFAX                                    CGL029
      ** Customer details
      *
     ISDCNST    E DSSDCNSTPD
      ** Counterparty Nostro details
      *                                                                   CSW003
     ISDSECS    E DSSDSECSPD                                              CSW003
      ** Security Customer details                                        CSW003
      *
     IMEBICD    E DSMEBICDPD                                                                  CSW210
      ** Bank details                                                                         CSW210
      *                                                                                       CSW210
      ** DS for Trade Purchase                                                                CSE028
      *                                                                                       CSE028
     IPRTPCS    E DSSTDADSED                                                                  CSE028
     I              SARECI                          W4RECI                                    CSE028
     I              SABCH                           W4BCH                                     CSE028
     I              SACUST                          W4CUST                                    CSE028
     I              SABK                            W4BK                                      CSE028
     I              SACCY                           W4CCY                                     CSE028
     I              SAINV                           W4INV                                     CSE028
     I              SAPREF                          W4PREF                                    CSE028
     I              SATYPE                          W4TYPE                                    CSE028
     I              SAGMES                          W4GMES                                    CSE028
     I              SACONG                          W4CONG                                    CSE028
     I              SAINST                          W4INST                                    CSE028
     I              SAINSS                          W4INSS                                    CSE028
     I              SARPTY                          W4RPTY                                    CSE028
     I              SAGDEL                          W4GDEL                                    CSE028
     I              SASROL                          W4SROL                                    CSE028
     I              SAFIND                          W4FIND                                    CSE028
     I              SACCTN                          W4CCTN                                    CSE028
     I              SADRSN                          W4DRSN                                    CSE028
     I              SADRS1                          W4DRS1                                    CSE028
     I              SADRS2                          W4DRS2                                    CSE028
     I              SADRS3                          W4DRS3                                    CSE028
     I              SADRS4                          W4DRS4                                    CSE028
     I              SABSSN                          W4BSSN                                    CSE028
     I              SABSS1                          W4BSS1                                    CSE028
     I              SABSS2                          W4BSS2                                    CSE028
     I              SAFIN1                          W4FIN1                                    CSE028
     I              SAFIN2                          W4FIN2                                    CSE028
     I              SARED1                          W4RED1                                    CSE028
     I              SARED2                          W4RED2                                    CSE028
     I              SANAS1                          W4NAS1                                    CSE028
     I              SANAS2                          W4NAS2                                    CSE028
     I              SAIMD1                          W4IMD1                                    CSE028
     I              SAIMD2                          W4IMD2                                    CSE028
     I              SAIMD3                          W4IMD3                                    CSE028
     I              SAIMD4                          W4IMD4                                    CSE028
     I              SAIMD5                          W4IMD5                                    CSE028
     I              SAIMD6                          W4IMD6                                    CSE028
     I              SAIMD7                          W4IMD7                                    CSE028
     I              SAIMD8                          W4IMD8                                    CSE028
     I              SAIMD9                          W4IMD9                                    CSE028
     I              SAIMS1                          W4IMS1                                    CSE028
     I              SAIMS2                          W4IMS2                                    CSE028
     I              SAIMS3                          W4IMS3                                    CSE028
     I              SAIMS4                          W4IMS4                                    CSE028
     I              SAIMS5                          W4IMS5                                    CSE028
     I              SAIMS6                          W4IMS6                                    CSE028
     I              SAIMS7                          W4IMS7                                    CSE028
     I              SAIMS8                          W4IMS8                                    CSE028
     I              SAIMS9                          W4IMS9                                    CSE028
     I              SAPSET                          W4PSET                                    CSE028
     I              SAAWIN                          W4AWIN                                    CSE028
     I              SAAWIL                          W4AWIL                                    CSE028
     I              SAAFPN                          W4AFPN                                    CSE028
     I              SAAFPL                          W4AFPL                                    CSE028
     I              SABOFN                          W4BOFN                                    CSE028
     I              SABOF1                          W4BOF1                                    CSE028
     I              SABOF2                          W4BOF2                                    CSE028
     I              SASRL1                          W4SRL1                                    CSE028
     I              SASRL2                          W4SRL2                                    CSE028
     I              SASRL3                          W4SRL3                                    CSE028
     I              SANAC1                          W4NAC1                                    CSE028
     I              SANAC2                          W4NAC2                                    CSE028
     I              SASTMP                          W4STMP                                    CSE028
     I              SACHID                          W4CHID                                    CSE028
     I              SATRRM                          W4TRRM                                    CSE028
     I              SAMKT                           W4SMKT                                    CSE034
     I              SADIDN                          W4DIDN                                    CSW210
     I              SADAD1                          W4DAD1                                    CSW210
     I              SADAD2                          W4DAD2                                    CSW210
     I              SADAD3                          W4DAD3                                    CSW210
     I              SADAD4                          W4DAD4                                    CSW210
     I              SADLIN                          W4DLIN                                    CSW210
     I              SAQFIN                          W4QFIN                                    CSW210
     I              SAPCLR                          W4PCLR                                    CSW210
      *                                                                                       CSE028
      ** DS for Trade Sale                                                                    CSE028
      *                                                                                       CSE028
     IPRTSCS    E DSSTDADSED                                                                  CSE028
     I              SARECI                          W5RECI                                    CSE028
     I              SABCH                           W5BCH                                     CSE028
     I              SACUST                          W5CUST                                    CSE028
     I              SABK                            W5BK                                      CSE028
     I              SACCY                           W5CCY                                     CSE028
     I              SAINV                           W5INV                                     CSE028
     I              SAPREF                          W5PREF                                    CSE028
     I              SATYPE                          W5TYPE                                    CSE028
     I              SAGMES                          W5GMES                                    CSE028
     I              SACONG                          W5CONG                                    CSE028
     I              SAINST                          W5INST                                    CSE028
     I              SAINSS                          W5INSS                                    CSE028
     I              SARPTY                          W5RPTY                                    CSE028
     I              SAGDEL                          W5GDEL                                    CSE028
     I              SASROL                          W5SROL                                    CSE028
     I              SAFIND                          W5FIND                                    CSE028
     I              SACCTN                          W5CCTN                                    CSE028
     I              SADRSN                          W5DRSN                                    CSE028
     I              SADRS1                          W5DRS1                                    CSE028
     I              SADRS2                          W5DRS2                                    CSE028
     I              SADRS3                          W5DRS3                                    CSE028
     I              SADRS4                          W5DRS4                                    CSE028
     I              SABSSN                          W5BSSN                                    CSE028
     I              SABSS1                          W5BSS1                                    CSE028
     I              SABSS2                          W5BSS2                                    CSE028
     I              SAFIN1                          W5FIN1                                    CSE028
     I              SAFIN2                          W5FIN2                                    CSE028
     I              SARED1                          W5RED1                                    CSE028
     I              SARED2                          W5RED2                                    CSE028
     I              SANAS1                          W5NAS1                                    CSE028
     I              SANAS2                          W5NAS2                                    CSE028
     I              SAIMD1                          W5IMD1                                    CSE028
     I              SAIMD2                          W5IMD2                                    CSE028
     I              SAIMD3                          W5IMD3                                    CSE028
     I              SAIMD4                          W5IMD4                                    CSE028
     I              SAIMD5                          W5IMD5                                    CSE028
     I              SAIMD6                          W5IMD6                                    CSE028
     I              SAIMD7                          W5IMD7                                    CSE028
     I              SAIMD8                          W5IMD8                                    CSE028
     I              SAIMD9                          W5IMD9                                    CSE028
     I              SAIMS1                          W5IMS1                                    CSE028
     I              SAIMS2                          W5IMS2                                    CSE028
     I              SAIMS3                          W5IMS3                                    CSE028
     I              SAIMS4                          W5IMS4                                    CSE028
     I              SAIMS5                          W5IMS5                                    CSE028
     I              SAIMS6                          W5IMS6                                    CSE028
     I              SAIMS7                          W5IMS7                                    CSE028
     I              SAIMS8                          W5IMS8                                    CSE028
     I              SAIMS9                          W5IMS9                                    CSE028
     I              SAPSET                          W5PSET                                    CSE028
     I              SAAWIN                          W5AWIN                                    CSE028
     I              SAAWIL                          W5AWIL                                    CSE028
     I              SAAFPN                          W5AFPN                                    CSE028
     I              SAAFPL                          W5AFPL                                    CSE028
     I              SABOFN                          W5BOFN                                    CSE028
     I              SABOF1                          W5BOF1                                    CSE028
     I              SABOF2                          W5BOF2                                    CSE028
     I              SASRL1                          W5SRL1                                    CSE028
     I              SASRL2                          W5SRL2                                    CSE028
     I              SASRL3                          W5SRL3                                    CSE028
     I              SANAC1                          W5NAC1                                    CSE028
     I              SANAC2                          W5NAC2                                    CSE028
     I              SASTMP                          W5STMP                                    CSE028
     I              SACHID                          W5CHID                                    CSE028
     I              SATRRM                          W5TRRM                                    CSE028
     I              SAMKT                           W5SMKT                                    CSE034
     I              SADIDN                          W5DIDN                                    CSW210
     I              SADAD1                          W5DAD1                                    CSW210
     I              SADAD2                          W5DAD2                                    CSW210
     I              SADAD3                          W5DAD3                                    CSW210
     I              SADAD4                          W5DAD4                                    CSW210
     I              SADLIN                          W5DLIN                                    CSW210
     I              SAQFIN                          W5QFIN                                    CSW210
     I              SAPCLR                          W5PCLR                                    CSW210
      *                                                                                       CSW210
     IDADDRS      DS                            140                                           CSW210
      ** Data structure for Debtor Address Line                                               CSW210
     I                                        1  35 DSDAD1                                    CSW210
     I                                       36  70 DSDAD2                                    CSW210
     I                                       70  70 DSDA34                                  AR640699
     I                                       71 105 DSDAD3                                    CSW210
     I                                      106 140 DSDAD4                                    CSW210
      *                                                                                       CSE028
      ** DS for customer/book standard settlement instruction                                 CSE028
      **  to be passed to SESSIR0                                                             CSE028
      *                                                                                       CSE028
     IPCBSTD    E DSSTDSED                    2                                               CSE028
      *                                                                                       CSE028
      ** Data structure for standard additional settlement details                            CSE028
      ** for customer/book to be passed to SESSIR0                                            CSE028
      *                                                                                       CSE028
     IPCBSAD    E DSSTDADSED                  8                                               CSE028
      *                                                                                       CSE028
     IPMCWL       DS                           9999                                           CSD015
     ITEMPDS      DS                           3000                                           CSD015
      ** Additional entry parameter for Midas Compliance Watch                                CSD015
      *                                                                                       CSD015
     IDBERR       DS                            256
      ** Data structure for data-base error processing.
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      *
     IPDATA     E DSSE50DT
      ** Data structure to receive parameters from SE1805 for MT5xxs
     ITRADX2    E DSTRADSDX2
      **  Data structure for breaking up details of TRADSDX2 into
      **  renamed fields
      *
     I              T2TDRF                          W2TDRF
     I              T2AP1N                          W2AP1N
     I              T2AP1L                          W2AP1L
     I              T2AFPN                          W2AFPN
     I              T2AFPL                          W2AFPL
     I              T2AWIA                          W2AWIA
     I              T2AWIN                          W2AWIN
     I              T2AWIL                          W2AWIL
     I              T2BOFA                          W2BOFA
     I              T2BOFN                          W2BOFN
     I              T2BOF1                          W2BOF1
     I              T2BOF2                          W2BOF2
     I              T2ACL1                          W2ACL1
     I              T2ACL2                          W2ACL2
     I              T2SRL1                          W2SRL1
     I              T2SRL2                          W2SRL2
     I              T2SRL3                          W2SRL3
     I              T2FIN1                          W2FIN1
     I              T2FIN2                          W2FIN2
     I              T2RED1                          W2RED1
     I              T2RED2                          W2RED2
     I              T2NAL1                          W2NAL1
     I              T2NAL2                          W2NAL2
     I              T2IPYN                          W2IPYN
     I              T2IPYL                          W2IPYL
     I              T2CTYN                          W2CTYN
     I              T2CTYL                          W2CTYL
     I              T2SA1N                          W2SA1N
     I              T2SA1L                          W2SA1L
     I              T2SKAN                          W2SKAN
     I              T2SKAL                          W2SKAL
     I              T2CCTN                          W2CCTN
     I              T2DCTL                          W2DCTL
     I              T2RSSA                          W2RSSA
     I              T2RSSN                          W2RSSN
     I              T2RSS1                          W2RSS1
     I              T2RSS2                          W2RSS2
     I              T2RSS3                          W2RSS3
     I              T2RSS4                          W2RSS4
     I              T2DSSA                          W2DSSA
     I              T2DSSN                          W2DSSN
     I              T2DSS1                          W2DSS1
     I              T2DSS2                          W2DSS2
     I              T2DSS3                          W2DSS3
     I              T2DSS4                          W2DSS4
     I              T2BSSA                          W2BSSA
     I              T2BSSN                          W2BSSN
     I              T2BSS1                          W2BSS1
     I              T2BSS2                          W2BSS2
     I              T2INVE                          W2INVE                CSW098
     I              T2DIDN                          W2DIDN                                    CSW210
     I              T2DAD1                          W2DAD1                                    CSW210
     I              T2DAD2                          W2DAD2                                    CSW210
     I              T2DAD3                          W2DAD3                                    CSW210
     I              T2DAD4                          W2DAD4                                    CSW210
     I              T2DLIN                          W2DLIN                                    CSW210
     I              T2QFIN                          W2QFIN                                    CSW210
     I              T2PCLR                          W2PCLR                                    CSW210
      *                                                                   CSW098
      * Input Parameters                                                  CSW098
      *                                                                   CSW098
     I***I#PARM*     DS                            512                                 CSW098 CGL029
     II#PARM      DS                            514                                           CGL029
      * Field to be validated                                             CSW098
     I                                        1   5 I#VFLD                CSW098
      * Pay/Receive Settlement (PAY/REC)                                  CSW098
     I                                        6   8 I#PR                  CSW098
      * Customer/Counterparty Nostro /BIC indentified type                CSW098
      *    C           X              S  X-> C'party Nostro or Customer   CSW098
      * Customer/Counterparty/BIC indentified                             CSW098
     I                                        9   9 I#PRTT                CSW098
     I                                       10  20 I#PRTY                CSW098
      * Pay Currency                                                      CSW098
     I                                       21  23 I#PCCY                CSW098
      * Receive Currency                                                  CSW098
     I                                       24  26 I#RCCY                CSW098
      * Account Line                                                      CSW098
     I                                       27  61 I#ACLN                CSW098
      * Account Line Character 1                                          CSW098
     I                                       27  27 I#ACC1                CSW098
      * Account Line Character 2                                          CSW098
     I                                       28  28 I#ACC2                CSW098
      * Account Line Character 3                                          CSW098
     I                                       29  29 I#ACC3                CSW098
      * Account Line first 4 characters                                   CSW098
     I                                       27  30 I#ACCL                CSW098
      * Account Line Clearing System                                      CSW098
     I                                       29  30 I#ACCS                CSW098
      * Account Line No account data                                      CSW098
     I                                       31  61 I#SPC1                CSW098
      * Message Type                                                      CSW098
     I                                       62  64 I#MTYP                CSW098
      * Intermediary Institution for Bank to Bank validation              CSW098
     I                                       65  65 I#INBT                CSW098
     I                                       66  76 I#INBK                CSW098
      * Account with Institution for Bank to Bank validation              CSW098
     I                                       77  77 I#AWBT                CSW098
     I                                       78  88 I#AWBK                CSW098
      * Beneficiary for Bank to Bank validation                           CSW098
     I                                       89  89 I#BENT                CSW098
     I                                       90 100 I#BENF                CSW098
      * Pay and Receive Settlement Methods                                CSW098
     I                                      101 102 I#RSTM                CSW098
     I                                      103 104 I#PSTM                CSW098
      * Field 53 and 54 Entered                                           CSW098
     I                                      105 105 I#5354                CSW098
      * Midas Module                                                      CSW098
     I                                      106 107 I#MMOD                CSW098
      * Pay and Receive Settlement Accounts                               CSW098
     I**********                            108 125 I#PYAC                             CSW098 CGL029
     I**********                            126 143 I#RCAC                             CSW098 CGL029
     I                                      108 125 QQPYAC                                    CGL029
     I                                      126 143 QQRCAC                                    CGL029
      * Transaction Type                                                  CSW098
     I                                      144 145 I#TTYP                CSW098
      * Cover required                                                    CSW098
     I                                      146 146 I#COVR                CSW098
      * Bank to Bank Information                                          CSW098
     I                                      257 466 I#BTB                 CSW098
     I                                      257 291 I#BTB1                CSW098
     I                                      292 326 I#BTB2                CSW098
     I                                      327 361 I#BTB3                CSW098
     I                                      362 396 I#BTB4                CSW098
     I                                      397 431 I#BTB5                CSW098
     I                                      432 466 I#BTB6                CSW098
     I                                      467 490 I#PYAC                                    CGL029
     I                                      491 514 I#RCAC                                    CGL029
      *                                                                   CSW098
      * Output Parameters                                                 CSW098
      *                                                                   CSW098
     I***O#PARM*     DS                            512                                 CSW098 CGL029
     IO#PARM      DS                            514                                           CGL029
      * Account Line modified                                             CSW098
     I                                        1  35 O#ACLN                CSW098
      * Bank to Bank Information                                          CSW098
     I                                      257 466 O#BTB                 CSW098
     I                                      257 291 O#BTB1                CSW098
     I                                      292 326 O#BTB2                CSW098
     I                                      327 361 O#BTB3                CSW098
     I                                      362 396 O#BTB4                CSW098
     I                                      397 431 O#BTB5                CSW098
     I                                      432 466 O#BTB6                CSW098
      *                                                                   CSW098
      * Error Parameters                                                  CSW098
      *                                                                   CSW098
     IE#PARM      DS                            256                       CSW098
      * Calling Program                                                   CSW098
     I                                        1  10 E#CPGM                CSW098
      * Error message sent                                                CSW098
     I                                       12  12 E#ERRM                CSW098
      * Warning message sent                                              CSW098
     I                                       13  13 E#WARN                CSW098
      * Error index                                                       CSW098
     I                                       14  180E#INDX                CSW098
      * Message text to prefix error message                              CSW098
     I                                       19  25 E#MSGD                CSW098
     I                                       26  35 E#MSGF                CSW098
      * Error codes array                                                 CSW098
     I                                       51 200 E#ERCD                CSW098
     I                                       51 200 O#E                   CSW098
      *                                                                                       CSE028
     IPNARR       DS                                                                          CSE028
     I                                        1  35 PNARR1                                    CSE028
     I                                       36  70 PNARR2                                    CSE028
      *                                                                                       CSE028
     IPINTRM      DS                                                                          CSE028
     I                                        1  12 PIMMD1                                    CSE028
     I                                       13  24 PIMMD2                                    CSE028
     I                                       25  36 PIMMD3                                    CSE028
     I                                       37  48 PIMMD4                                    CSE028
     I                                       49  60 PIMMD5                                    CSE028
     I                                       61  72 PIMMD6                                    CSE028
     I                                       73  84 PIMMD7                                    CSE028
     I                                       85  96 PIMMD8                                    CSE028
     I                                       97 108 PIMMD9                                    CSE028
      *                                                                                       CSE028
     IPSAFEA      DS                                                                          CSE028
     I                                        1  20 PIMSA1                                    CSE028
     I                                       21  40 PIMSA2                                    CSE028
     I                                       41  60 PIMSA3                                    CSE028
     I                                       61  80 PIMSA4                                    CSE028
     I                                       81 100 PIMSA5                                    CSE028
     I                                      101 120 PIMSA6                                    CSE028
     I                                      121 140 PIMSA7                                    CSE028
     I                                      141 160 PIMSA8                                    CSE028
     I                                      161 180 PIMSA9                                    CSE028
      *
     I            DS                                                                          CSW210
      *                                                                                       CSW210
      ** Data Structure redefining Address fields                                             CSW210
     I                                        1 140 ADDRSS                                    CSW210
     I                                        1  35 ADCHK1                                    CSW210
     I                                       36  70 ADCHK2                                    CSW210
     I                                       71 105 ADCHK3                                    CSW210
     I                                      106 140 ADCHK4                                    CSW210
      *                                                                                       CSW210
      ** Blank Line Analysis data structure                                                   CSW210
     I                                       36 140 ADCH26                                    CSW210
     I                                       71 140 ADCH36                                    CSW210
      *                                                                                       CSW210
      ** SWIFT Address Analysis data structure                                                CSW210
     I                                        1   1 ADSLSH                                    CSW210
     I                                       12  35 ADEXSW                                    CSW210
      *                                                                                       CSW210
      ** Registration Details data structure                                                  CSW210
     IPREGD       DS                                                                          CSW210
     I                                        1  35 PREGD1                                    CSW210
     I                                       36  70 PREGD2                                    CSW210
      *                                                                                       CSW210
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHAN                                    CSW210
     I              'UVWXYZ0123456789'                                                        CSW210
     I              'ABCDEFGHIJKLMNOPQRST-C         ISO                                       CSW210
     I              'UVWXYZ 1234567890/-?-                                                    CSW210
     I              '?:().,''+'                                                               CSW210
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHA                                     CSW210
     I              'UVWXYZ'                                                                  CSW210
     I              '0123456789'          C         NMBRS                                     CSW210
      *                                                                                       CSW210
      ** IBAN DS                                                                              CSW210
     IDSIBAN      DS                                                                          CSW210
     I                                        1   1 DSISLH                                    CSW210
     I                                        2  35 DSIBN2                                    CSW210
     C/EJECT
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      *  Initialisation routine
     C                     EXSR SRINIT
      *
      ** Execute specific routine depending on action
     C           PACTN     CASEQ'I'       SRINS
     C           PACTN     CASEQ'B'       SRINS
     C           PACTN     CASEQ'A'       SRAMD
     C           PACTN     CASEQ'Y'       SRAMD
     C           PACTN     CASEQ'E'       SRENQ
     C                     END
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
      *                                                               *
      ** Execute routine to setup return code and exit program
     C                     EXSR SRRTRN
      *                                                               *
      *================================================================
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRINS     - To Process Insert Action                        *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRINS     BEGSR
      *
      ** Check whether record exists
      ** (it would already exist if F14 for Extended Settlements has
      **  been taken more than once during the same insert)
      *
      **  Because SE1806 can be called from the Bulk input programs,
      **  a decision needs to be made - what file do we check ?. If
      **  SE1806 was called from the Bulk input programs then the
      **  BULKSDX2 needs to be checked to find out whether the record
      **  exist or not. If SE1806 was called from Trades input then
      **  the TRADSDX2 needs to be checked to find out whether the
      **  record exist or not. Overrides issued in SEC3000 gives a
      **  broader view of the situation.
      *
     C           PACTN     IFEQ 'B'
     C           KEY001    CHAINUPDIDX               89
     C                     ELSE
     C           KEY001    CHAINRTVIDX               89
     C                     ENDIF
      *
      ** If record found then set up screen fields from file;
      ** else initialize screen fields and file fields.
     C           *IN89     IFEQ *OFF
     C                     EXSR SRFTOS
     C                     ELSE
      *                                                                                       CSE028
      ** If CSE028 is on, call SESSIR0 for default of MT5xx information                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C           DFTFLG    ANDEQ'Y'                                                           CSE034
      *                                                                                       CSE028
     C           PSESN     CHAINSECTYDF              99                                       199797
     C                     MOVELSITP      PINVT                                               199797
     C**********           MOVELSMCC      PSMCC                                        CSE034 205667
      *                                                                                       199797
     C                     CALL 'SESSIR0'                                                     CSE028
     C                     PARM 'D'       POTYP   1                                           CSE028
     C                     PARM           PTDBR                                               CSE028
     C                     PARM           PTCNR                                               CSE028
     C                     PARM           PPBKC                                               CSE028
     C                     PARM           PTNMC                                               CSE028
     C                     PARM           PSMCC   2                                           CSE034
     C                     PARM           PINVT   3                                           CSE028
     C                     PARM           PPTFR                                               CSE028
     C                     PARM           PCBSTD                                              CSE028
     C                     PARM           PCBSAD                                              CSE028
     C                     PARM *BLANKS   PRTCDE  5                                           CSE028
      *                                                                                       CSE028
     C           *LIKE     DEFN SFAT      WSFAT                                               218770
     C           *LIKE     DEFN SFAF      WSFAF                                               218770
     C                     MOVE SFAT      WSFAT                                               218770
     C                     MOVE SFAF      WSFAF                                               218770
     C                     SELEC                                                              CSE028
      *                                                                                       CSE028
     C           PTDTP     WHEQ 'TP'                                                          CSE028
     C                     DO                                                                 CSE028
      *                                                                                       204960
      ** For Trade Purchase, Reg Details should be defaulted                                  204960
      ** from the book SSI and not from the Counterparty SSI.                                 204960
      *                                                                                       204960
     C           *LIKE     DEFN SARED1    WKRD1                                               204960
     C           *LIKE     DEFN SARED2    WKRD2                                               204960
     C           1         OCUR PCBSAD                                                        204960
     C                     MOVE PCBSAD    PRTPCS                                              204960
     C                     MOVE W4RED1    WKRD1                                               204960
     C                     MOVE W4RED2    WKRD2                                               204960
     C           5         OCUR PCBSAD                                                        CSE028
     C                     MOVE PCBSAD    PRTPCS                                              CSE028
     C                     MOVE WKRD1     W4RED1                                              204960
     C                     MOVE WKRD2     W4RED2                                              204960
     C                     ENDDO                                                              CSE028
      *                                                                                       CSE028
     C           PTDTP     WHEQ 'TS'                                                          CSE028
     C                     DO                                                                 CSE028
     C           6         OCUR PCBSAD                                                        CSE028
     C                     MOVE PCBSAD    PRTSCS                                              CSE028
     C                     ENDDO                                                              CSE028
      *                                                                                       CSE028
     C                     ENDSL                                                              CSE028
      *                                                                                       CSE028
     C                     EXSR SRMOFS                                                        CSE028
      *                                                                                       CSE028
     C                     ELSE                                                               CSE028
     C                     CLEARUPDIDX
     C                     MOVE PTDSI     SSRL1
     C/COPY WNCPYSRC,SE1806C001
     C           PACTN     IFEQ 'B'
     C                     EXSR SRINB
     C                     ENDIF
     C/COPY WNCPYSRC,SE1806C020
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     END
     C/COPY WNCPYSRC,SE1806C029
      *
      ** Handle screens until F3, F5 or F12 taken
      ** or until no errors but not rolldown
      ** No screen processing for mode = 'Y'                              CSE028
     C           PMODE     IFNE 'Y'                                       CSE028
     C           *INKC     DOUEQ*ON
     C           *INKE     OREQ *ON
     C           *INKL     OREQ *ON
     C           *IN75     OREQ *OFF
     C           *IN86     ANDEQ*OFF
      *
      ** If there are no errors on the second screen or if Rolldown
      ** taken then display the first screen; reset the Rolldown Ind.
      ** New field mode must equal 'N' for normal screen processing.      CSE028
     C           *IN02     IFEQ *OFF
     C           *IN86     OREQ *ON
     C           PMODE     IFEQ 'N'                                       CSE028
     C                     EXSR SRSCR1
     C                     SETOF                     86
     C                     ENDIF                                          CSE028
     C                     END
      *
      ** If F3, F5, F12 and Rolldown not taken continue
      ** (else repeat 'do until').
     C           *INKC     IFEQ *OFF
     C           *INKE     ANDEQ*OFF
     C           *INKL     ANDEQ*OFF
     C           *IN86     ANDEQ*OFF
      *
      ** If there are errors on the second screen or if Rollup taken
      ** then display the second screen; reset screen 2 error indicator
     C           *IN02     IFEQ *ON
     C           *IN85     OREQ *ON
     C/COPY WNCPYSRC,SE1806C030
      *                                                                                       CSE028
      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
      *
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C           PSNEW     IFEQ 'Y'                                                           CSE028
     C                     MOVE *ON       *IN84                                               CSE028
     C                     MOVE *ON       *IN77                                               CSE028
     C                     MOVE 'N'       W3RDFL  1                                           CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** Default Counterparty Safekeeping Account                                             209890
      *                                                                                       209890
     C           *IN75     IFEQ *OFF                                                          209890
     C           SSA1N     IFEQ *BLANK                                                        218770
     C           PTDTP     IFEQ 'TP'                                                          209890
     C********** PDELF     ANDNE0                                                      209890 CSD027
     C           PDELF     ANDNE*BLANKS                                                       CSD027
     C                     MOVELPDELF     SSA1N                                               209890
     C                     ENDIF                                                              209890
     C           PTDTP     IFEQ 'TS'                                                          209890
     C********** PDELT     ANDNE0                                                      209890 CSD027
     C           PDELT     ANDNE*BLANKS                                                       CSD027
     C                     MOVELPDELT     SSA1N                                               209890
     C                     ENDIF                                                              209890
     C                     ENDIF                                                              218770
      *                                                                                       209949
      ** Default for Deliverer of Securities field                                            209949
      *                                                                                       209949
     C           PTDTP     IFEQ 'TP'                                                          209949
     C********** PDELF     ANDNE0                                                      209949 CSD027
     C           PDELF     ANDNE*BLANKS                                                       CSD027
     C           SDSSN     ANDEQ*BLANKS                                                       209949
     C           *IN07     ANDEQ*OFF                                                        AR632000
     C                     MOVELPDELF     SDSSN                                               209949
     C                     ENDIF                                                              209949
      *                                                                                       209949
     C           PTDTP     IFEQ 'TS'                                                          209949
     C********** PDELT     ANDNE0                                                      209949 CSD027
     C           PDELT     ANDNE*BLANKS                                                       CSD027
     C           SRSSN     ANDEQ*BLANKS                                                       209949
     C           *IN08     ANDEQ*OFF                                                        AR632000
     C                     MOVELPDELT     SRSSN                                               209949
     C                     ENDIF                                                              209949
      *                                                                                       209949
     C                     ENDIF                                                              209890
      *                                                                                       209890
     C                     EXSR SRSCR2
     C/COPY WNCPYSRC,SE1806C031
     C                     SETOF                     02
     C                     END
      *                                                                                       201429
      ** If Rollup was taken on second screen, call SE001810                                  201429
      *                                                                                       201429
     C           CSE028    IFEQ 'Y'                                                           201429
     C           *IN84     ANDEQ*ON                                                           201429
     C                     EXSR SRSCR3                                                        201429
     C                     ENDIF                                                              201429
      *
      ** Clear messages for redisplay
     C                     CALL 'ZA0250'
      *
      ** Validate input, only if F3, F5, F12 and Rolldown not taken
     C           *INKC     IFEQ *OFF
     C           *INKE     ANDEQ*OFF
     C           *INKL     ANDEQ*OFF
     C           *IN86     ANDEQ*OFF
     C           *IN84     ANDEQ*OFF                                                          201429
     C                     EXSR SRVAL
      *                                                                                       CSE028
      ***If*Rollup was taken on second screen, call SE001810                           CSE028 201429
      *                                                                                       CSE028
     C********** CSE028    IFEQ 'Y'                                                    CSE028 201429
     C********** *IN84     ANDEQ*ON                                                    CSE028 201429
     C********** *IN75     ANDEQ*OFF                                                   CSE028 201429
      *                                                                                       CSE028
     C**********           EXSR SRSCR3                                                 CSE028 201429
      *                                                                                       CSE028
     C**********           ENDIF                                                       CSE028 201429
      *                                                                                       CSE028
     C           *INKC     IFEQ *OFF                                                          CSE028
     C           *INKL     ANDEQ*OFF                                                          CSE028
     C********** *IN85     ANDEQ*OFF                                                   CSE028 199797
      *
      ** If no errors on validation update/write to the file and drop
      ** out of subroutine (and program).
     C           *IN75     IFEQ *OFF
      *                                                                                       CSD015
      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If 24X7 is not installed or the support system is off.                               CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV1                                                        CSD015
      *                                                                                       CSD015
     C           WDIFFI    IFEQ 'Y'                                                           CSD015
     C           WIMDI     OREQ 'Y'                                                           CSD015
     C           WIMSI     OREQ 'Y'                                                           CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *
      ** If record previously existed then allocate the record via the
      ** update index
     C           *IN89     IFEQ *OFF
     C                     EXSR SRALOC
      *
      ** If record on file and allocated then move screen values to
      ** file fields and update record;
      ** (else screen will be redisplayed)
     C           *IN80     IFEQ *OFF
     C           *IN81     ANDEQ*OFF
     C                     EXSR SRSTOF
     C                     UPDATUPDIDX                 88
     C                     END
      *
      ** Else (record does not already exist) move screen fields to
      ** file fields; write new record.
     C                     ELSE
     C                     EXSR SRSTOF
      *                                                                                       248683
      *  Write 'Y' to SE1806 Data Area Flag                                                   248683
      *                                                                                       248683
     C                     CALL 'SECDTARA'                                                    248683
     C                     PARM 'SE1806'  PRGNAM 10                                           248683
     C                     PARM 'Y'       WRTFLG  1                                           248683
      *                                                                                       248683
     C                     WRITEUPDIDX                 88
     C                     END
     C/COPY WNCPYSRC,SE1806C032
      *
     C                     END
      *
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     END
      *
      ** If F12 taken from second screen then set Rolldown Ind (*IN86);
      ** set F12 off; and clear fields on 2nd screen.
     C           *INKL     IFEQ *ON
     C           W3RDFL    ANDEQ'N'                                                           CSE028
     C                     SETON                     86
     C                     MOVE *OFF      *INKL
     C                     EXSR SRCLS2
     C/COPY WNCPYSRC,SE1806C033
     C                     END
      *
     C                     END
      *
     C                     END
      *                                                                   CSE028
      ** MODE = 'Y' after missing screen processing                       CSE028
     C                     ELSE                                           CSE028
      ** MODE = 'Y' just do file updates                                  CSE028
      *                                                                   CSE028
      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If 24X7 is not installed or the suport system is off.                                CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV1                                                        CSD015
      *                                                                                       CSD015
     C           WDIFFI    IFEQ 'Y'                                                           CSD015
     C           WIMDI     OREQ 'Y'                                                           CSD015
     C           WIMSI     OREQ 'Y'                                                           CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If record previously existed then allocate the record via the    CSE028
      ** update index                                                     CSE028
     C           *IN89     IFEQ '0'                                       CSE028
     C                     EXSR SRALOC                                    CSE028
      *                                                                   CSE028
      ** If record on file and allocated then move screen values to       CSE028
      ** file fields and update record;                                   CSE028
      ** (else screen will be redisplayed)                                CSE028
     C           *IN80     IFEQ '0'                                       CSE028
     C           *IN81     ANDEQ'0'                                       CSE028
     C                     EXSR SRSTOF                                    CSE028
     C                     UPDATUPDIDX                 88                 CSE028
     C                     ENDIF                                          CSE028
      *                                                                   CSE028
      ** Else (record does not already exist) move screen fields to       CSE028
      ** file fields; write new record.                                   CSE028
     C                     ELSE                                           CSE028
     C                     EXSR SRSTOF                                    CSE028
      *                                                                                       248683
      *  Write 'Y' to SE1806 Data Area Flag                                                   248683
      *                                                                                       248683
     C                     CALL 'SECDTARA'                                                    248683
     C                     PARM 'SE1806'  PRGNAM 10                                           248683
     C                     PARM 'Y'       WRTFLG  1                                           248683
      *                                                                                       248683
     C                     WRITEUPDIDX                 88                 CSE028
     C                     ENDIF                                          CSE028
     C                     ENDIF                                          CSE028
      *
      ** Reset override indicators
     C                     MOVE *BLANK    OVER2   1
     C                     MOVE *BLANK    OVER3   1
     C                     MOVE *BLANK    OVER6   1
     C                     MOVE *BLANK    OVER7   1
     C                     MOVE *BLANK    OVER8   1
     C                     MOVE *BLANK    OVER9   1
      *
     C                     ENDSR
      *
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      **                                                              *                       CSD015
      **  SRCWV1    - Validate if watch list field has been entered.  *                       CSD015
      **                                                              *                       CSD015
      **  Calls     - None.                                           *                       CSD015
      **  Called By - SRINS, SAMD                                     *                       CSD015
      **                                                              *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRCWV1    BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       WDIFFI  1                                           CSD015
     C                     MOVEL'N'       WIMDI   1                                           CSD015
     C                     MOVEL'N'       WIMSI   1                                           CSD015
     C                     MOVEA*BLANKS   WLF,1                                               CSD015
     C                     MOVEA*BLANKS   MMD,1                                               CSD015
     C                     MOVEA*BLANKS   MSA,1                                               CSD015
      *                                                                                       CSD015
     C           WWAP1N    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWAP1N    WLF,1                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWAFPN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWAFPN    WLF,2                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWAWIN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWAWIN    WLF,3                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBOFN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWBOFN    WLF,4                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWIPYN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWIPYN    WLF,5                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWCTYN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWCTYN    WLF,6                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWSA1N    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWSA1N    WLF,7                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWSKAN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWSKAN    WLF,8                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           SDCTL     IFNE *BLANKS                                                       CSD015
     C                     MOVELSDCTL     WLF,9                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWRSSN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWRSSN    WLF,10                                              CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWDSSN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWDSSN    WLF,11                                              CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBSSN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWBSSN    WLF,12                                              CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C********** WWINVE    IFNE *BLANKS                                                CSD015 CSW210
     C**********           MOVELWWINVE    WLF,13                                       CSD015 CSW210
     C**********           MOVEL'Y'       WDIFFI                                       CSD015 CSW210
     C**********           ENDIF                                                       CSD015 CSW210
     C           PINVE     IFNE *BLANKS                                                       CSW210
     C                     MOVELPINVE     WLF,13                                              CSW210
     C                     MOVEL'Y'       WDIFFI                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           WWDIDN    IFNE *BLANKS                                                       CSW210
     C                     MOVELWWDIDN    WLF,14                                              CSW210
     C                     MOVEL'Y'       WDIFFI                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           PQFIN     IFNE *BLANKS                                                       CSW210
     C                     MOVELPQFIN     WLF,15                                              CSW210
     C                     MOVEL'Y'       WDIFFI                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSD015
      **  Settlement Party Intermediary                                                       CSD015
      *                                                                                       CSD015
     C           PIMMD1    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD1    MMD,1                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD2    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD2    MMD,2                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD3    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD3    MMD,3                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD4    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD4    MMD,4                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD5    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD5    MMD,5                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD6    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD6    MMD,6                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD7    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD7    MMD,7                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD8    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD8    MMD,8                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD9    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD9    MMD,9                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      **  Safekeeping Account Intermediary                                                    CSD015
      *                                                                                       CSD015
     C           PIMSA1    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA1    MSA,1                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA2    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA2    MSA,2                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA3    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA3    MSA,3                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA4    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA4    MSA,4                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA5    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA5    MSA,5                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA6    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA6    MSA,6                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA7    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA7    MSA,7                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA8    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA8    MSA,8                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA9    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA9    MSA,9                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAMD     - To Handle Amend Action                          *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRAMD     BEGSR
      *
      ** Check whether record exists
     C           KEY001    CHAINRTVIDX               89
     C/COPY WNCPYSRC,SE1806C034
      *
      ** If record not found then treat as insert because screen not
      ** mandatory (displayed by pressing F14)
     C           *IN89     IFEQ *ON
     C                     EXSR SRINS
     C                     ELSE
      *
      ** Else, record found, set file fields to screen fields
     C                     EXSR SRFTOS
      *
      ** Handle screens until F3, F5 or F12 taken
      ** or until no errors but not rolldown
     C           *INKC     DOUEQ*ON
     C           *INKE     OREQ *ON
     C           *INKL     OREQ *ON
     C           *IN75     OREQ *OFF
     C           *IN86     ANDEQ*OFF
      *
      ** If there are no errors on the second screen or if Rolldown
      ** taken then display the first screen; reset the Rolldown Ind.
     C           *IN02     IFEQ *OFF
     C           *IN86     OREQ *ON
     C                     EXSR SRSCR1
     C                     SETOF                     86
     C                     END
      *
      ** If F3, F5, F12 and Rolldown not taken continue
      ** (else repeat 'do until').
     C           *INKC     IFEQ *OFF
     C           *INKE     ANDEQ*OFF
     C           *INKL     ANDEQ*OFF
     C           *IN86     ANDEQ*OFF
      *
      ** If there are errors on the second screen or if Rollup taken
      ** then display the second screen; reset screen 2 error indicator
     C           *IN02     IFEQ *ON
     C           *IN85     OREQ *ON
     C/COPY WNCPYSRC,SE1806C035
      *                                                                                       CSE028
      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C           PSNEW     IFEQ 'Y'                                                           CSE028
     C                     MOVE *ON       *IN84                                               CSE028
     C                     MOVE *ON       *IN77                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     EXSR SRSCR2
     C/COPY WNCPYSRC,SE1806C036
     C                     SETOF                     02
     C                     END
      *                                                                                       201429
      ** If Rollup was taken on second screen, call SE001810                                  201429
      *                                                                                       201429
     C           CSE028    IFEQ 'Y'                                                           201429
     C           *IN84     ANDEQ*ON                                                           201429
     C                     EXSR SRSCR3                                                        201429
     C                     ENDIF                                                              201429
      *
      ** Clear messages for redisplay
     C                     CALL 'ZA0250'
      *
      ** Validate input, only if F3, F5, F12 and Rolldown not taken
     C           *INKC     IFEQ *OFF
     C           *INKE     ANDEQ*OFF
     C           *INKL     ANDEQ*OFF
     C           *IN86     ANDEQ*OFF
     C           *IN84     ANDEQ*OFF                                                          201429
     C                     EXSR SRVAL
      *                                                                                       CSE028
      ***If*Rollup was taken on second screen, call SE001810                           CSE028 201429
      *                                                                                       CSE028
     C********** CSE028    IFEQ 'Y'                                                    CSE028 201429
     C********** *IN84     ANDEQ*ON                                                    CSE028 201429
     C********** *IN75     ANDEQ*OFF                                                   CSE028 201429
      *                                                                                       CSE028
     C**********           EXSR SRSCR3                                                 CSE028 201429
      *                                                                                       CSE028
     C**********           ENDIF                                                       CSE028 201429
      *                                                                                       CSE028
     C           *INKC     IFEQ *OFF                                                          CSE028
     C           *INKL     ANDEQ*OFF                                                          CSE028
     C********** *IN85     ANDEQ*OFF                                                   CSE028 199797
      *
      ** If no errors on validation allocate record via update index
     C           *IN75     IFEQ *OFF
     C                     EXSR SRALOC
      *
      ** If record on file and allocated then move screen values to
      ** file fields and update record.
     C           *IN80     IFEQ *OFF
     C           *IN81     ANDEQ*OFF
      *                                                                                       CSD015
      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If 24X7 is not installed or the suport system is off.                                CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE *OFF      *IN11                                               CSD015
      *                                                                                       CSD015
     C                     MOVEL'TRADSD ' WFUNT                                               CSD015
     C                     MOVELW2TDRF    WIDEN                                               CSD015
     C                     MOVELPTDBR     WBRCH                                               CSD015
     C           CWHTKY    CHAINSDCWHTL1             11                                       CSD015
      *                                                                                       CSD015
     C           *IN11     IFEQ *OFF                                                          CSD015
     C           W3HSTS    ANDEQ*BLANKS                                                       CSD015
     C           W3UNCF    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV1                                                        CSD015
     C                     EXSR SRFMT                                                         CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV2                                                        CSD015
      *                                                                                       CSD015
     C           WDIFFA    IFEQ 'Y'                                                           CSD015
     C           WIMDA     OREQ 'Y'                                                           CSD015
     C           WIMSA     OREQ 'Y'                                                           CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     EXSR SRSTOF
      *                                                                                       248683
      *  Write 'Y' to SE1806 Data Area Flag                                                   248683
      *                                                                                       248683
     C                     CALL 'SECDTARA'                                                    248683
     C                     PARM 'SE1806'  PRGNAM 10                                           248683
     C                     PARM 'Y'       WRTFLG  1                                           248683
      *                                                                                       248683
     C                     UPDATUPDIDX                 88
     C                     END
     C/COPY WNCPYSRC,SE1806C037
      *
     C                     END
      *
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     END
      *
      ** If F12 taken from second screen then set Rolldown Ind (*IN86);
      ** set F12 off; and reset fields on 2nd screen.
     C           *INKL     IFEQ *ON
     C           W3RDFL    ANDEQ'N'                                                           CSE028
     C                     SETON                     86
     C                     MOVE *OFF      *INKL
     C                     EXSR SRRTS2
     C/COPY WNCPYSRC,SE1806C038
     C                     END
      *
     C                     END
      *
     C                     END
      *
     C                     END
      *
      ** Reset override indicators
     C                     MOVE *BLANK    OVER2
     C                     MOVE *BLANK    OVER3
     C                     MOVE *BLANK    OVER6
     C                     MOVE *BLANK    OVER7
     C                     MOVE *BLANK    OVER8
     C                     MOVE *BLANK    OVER9
      *
     C                     ENDSR
      *
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      **                                                              *                       CSD015
      **  SRCWV2    - Validate if watch list field has been changed.  *                       CSD015
      **                                                              *                       CSD015
      **  Calls     - None.                                           *                       CSD015
      **  Called By - SRAMD                                           *                       CSD015
      **                                                              *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRCWV2    BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       WDIFFA  1                                           CSD015
     C                     MOVEL'N'       WIMDA   1                                           CSD015
     C                     MOVEL'N'       WIMSA   1                                           CSD015
     C                     MOVEA*BLANKS   WLF,1                                               CSD015
     C                     MOVEA*BLANKS   MMD,1                                               CSD015
     C                     MOVEA*BLANKS   MSA,1                                               CSD015
      *                                                                                       CSD015
     C           WWAP1N    IFNE T2AP1N                                                        CSD015
     C                     MOVELWWAP1N    WLF,1                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWAFPN    IFNE T2AFPN                                                        CSD015
     C                     MOVELWWAFPN    WLF,2                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWAWIN    IFNE T2AWIN                                                        CSD015
     C                     MOVELWWAWIN    WLF,3                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBOFN    IFNE T2BOFN                                                        CSD015
     C                     MOVELWWBOFN    WLF,4                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWIPYN    IFNE T2IPYN                                                        CSD015
     C                     MOVELWWIPYN    WLF,5                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWCTYN    IFNE T2CTYN                                                        CSD015
     C                     MOVELWWCTYN    WLF,6                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWSA1N    IFNE T2SA1N                                                        CSD015
     C                     MOVELWWSA1N    WLF,7                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWSKAN    IFNE T2SKAN                                                        CSD015
     C                     MOVELWWSKAN    WLF,8                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           SDCTL     IFNE T2DCTL                                                        CSD015
     C                     MOVELSDCTL     WLF,9                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWRSSN    IFNE T2RSSN                                                        CSD015
     C                     MOVELWWRSSN    WLF,10                                              CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWDSSN    IFNE T2DSSN                                                        CSD015
     C                     MOVELWWDSSN    WLF,11                                              CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBSSN    IFNE T2BSSN                                                        CSD015
     C                     MOVELWWBSSN    WLF,12                                              CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C********** WWINVE    IFNE T2INVE                                                 CSD015 CSW210
     C**********           MOVELWWINVE    WLF,13                                       CSD015 CSW210
     C**********           MOVEL'Y'       WDIFFA                                       CSD015 CSW210
     C**********           ENDIF                                                       CSD015 CSW210
     C           PINVE     IFNE T2INVE                                                        CSW210
     C                     MOVELPINVE     WLF,13                                              CSW210
     C                     MOVEL'Y'       WDIFFA                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           WWDIDN    IFNE T2DIDN                                                        CSW210
     C                     MOVELWWDIDN    WLF,14                                              CSW210
     C                     MOVEL'Y'       WDIFFA                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           PQFIN     IFNE T2QFIN                                                        CSW210
     C                     MOVELPQFIN     WLF,15                                              CSW210
     C                     MOVEL'Y'       WDIFFA                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSD015
      **  Settlement Party Intermediary                                                       CSD015
      *                                                                                       CSD015
     C           PIMMD1    IFNE T2IMD1                                                        CSD015
     C                     MOVELPIMMD1    MMD,1                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD2    IFNE T2IMD2                                                        CSD015
     C                     MOVELPIMMD2    MMD,2                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD3    IFNE T2IMD3                                                        CSD015
     C                     MOVELPIMMD3    MMD,3                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD4    IFNE T2IMD4                                                        CSD015
     C                     MOVELPIMMD4    MMD,4                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD5    IFNE T2IMD5                                                        CSD015
     C                     MOVELPIMMD5    MMD,5                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD6    IFNE T2IMD6                                                        CSD015
     C                     MOVELPIMMD6    MMD,6                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD7    IFNE T2IMD7                                                        CSD015
     C                     MOVELPIMMD7    MMD,7                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD8    IFNE T2IMD8                                                        CSD015
     C                     MOVELPIMMD8    MMD,8                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD9    IFNE T2IMD9                                                        CSD015
     C                     MOVELPIMMD9    MMD,9                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      **  Safekeeping Account Intermediary                                                    CSD015
      *                                                                                       CSD015
     C           PIMSA1    IFNE T2IMS1                                                        CSD015
     C                     MOVELPIMSA1    MSA,1                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA2    IFNE T2IMS2                                                        CSD015
     C                     MOVELPIMSA2    MSA,2                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA3    IFNE T2IMS3                                                        CSD015
     C                     MOVELPIMSA3    MSA,3                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA4    IFNE T2IMS4                                                        CSD015
     C                     MOVELPIMSA4    MSA,4                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA5    IFNE T2IMS5                                                        CSD015
     C                     MOVELPIMSA5    MSA,5                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA6    IFNE T2IMS6                                                        CSD015
     C                     MOVELPIMSA6    MSA,6                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA7    IFNE T2IMS7                                                        CSD015
     C                     MOVELPIMSA7    MSA,7                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA8    IFNE T2IMS8                                                        CSD015
     C                     MOVELPIMSA8    MSA,8                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA9    IFNE T2IMS9                                                        CSD015
     C                     MOVELPIMSA9    MSA,9                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      **                                                              *                       CSD015
      **  SRFMT     - Format watch list fields                        *                       CSD015
      **                                                              *                       CSD015
      **  Calls     - None.                                           *                       CSD015
      **  Called By - SRINS, SRAMD                                    *                       CSD015
      **                                                              *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRFMT     BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     CLEARPMCWL                                                         CSD015
      *                                                                                       CSD015
     C           WDIFFI    IFEQ 'Y'                                                           CSD015
     C           WDIFFA    OREQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     Z-ADD0         WID     20                                          CSD015
     C********** WID       DOUEQ13                                                     CSD015 CSW210
     C           WID       DOUEQ15                                                            CSW210
     C                     ADD  1         WID                                                 CSD015
     C                     MOVELWLF,WID   PINP1                                               CSD015
      *                                                                                       CSD015
     C           WLF,WID   IFNE *BLANKS                                                       CSD015
     C           WLF,WID   ANDNE'000000'                                                      CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD   7                                           CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM *BLANKS   PINP2  35                                           CSD015
     C                     PARM *BLANKS   PINP3  35                                           CSD015
     C                     PARM *BLANKS   PINP4  35                                           CSD015
     C                     PARM *BLANKS   PINP5  35                                           CSD015
     C                     PARM *BLANKS   PINP6  35                                           CSD015
     C                     PARM           PCCY    3                                           CSD015
     C                     PARM           POUT  216                                           CSD015
     C                     PARM           PCNUM   6                                           CSD015
      *                                                                                       CSD015
     C           WID       MULT 2         CLS     20                                          CSD015
     C           CLS       SUB  1         OPN     20                                          CSD015
      *                                                                                       CSD015
     C                     MOVELCWA,OPN   WOPN   25                                           CSD015
     C                     MOVELCWA,CLS   WCLS   25                                           CSD015
      *                                                                                       CSD015
     C           PMCWL     CAT  WOPN:0    PMCWL                                               CSD015
     C                     CAT  POUT:0    PMCWL                                               CSD015
      *                                                                                       CSD015
     C                     SELEC                                                              CSD015
     C           WID       WHEQ 1                                                             CSD015
     C                     CAT  SAP1L:0   PMCWL                                               CSD015
     C           WID       WHEQ 2                                                             CSD015
     C                     CAT  SAFPL:0   PMCWL                                               CSD015
     C           WID       WHEQ 3                                                             CSD015
     C                     CAT  SAWIL:0   PMCWL                                               CSD015
     C           WID       WHEQ 4                                                             CSD015
     C                     CAT  SBOF1:0   PMCWL                                               CSD015
     C                     CAT  SBOF2:0   PMCWL                                               CSD015
     C           WID       WHEQ 5                                                             CSD015
     C                     CAT  SIPYL:0   PMCWL                                               CSD015
     C           WID       WHEQ 6                                                             CSD015
     C                     CAT  SCTYL:0   PMCWL                                               CSD015
     C           WID       WHEQ 7                                                             CSD015
     C                     CAT  SSA1L:0   PMCWL                                               CSD015
     C           WID       WHEQ 8                                                             CSD015
     C                     CAT  SSKAL:0   PMCWL                                               CSD015
     C           WID       WHEQ 14                                                            CSW210
     C                     CAT  SDIDN:0   PMCWL                                               CSW210
     C           WID       WHEQ 15                                                            CSW210
     C                     CAT  PQFIN:0   PMCWL                                               CSW210
     C                     ENDSL                                                              CSD015
      *                                                                                       CSD015
     C                     CAT  WCLS:0    PMCWL                                               CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDDO                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Add the Settlement Party Intermediary                                                CSD015
      *                                                                                       CSD015
     C           WIMDI     IFEQ 'Y'                                                           CSD015
     C           WIMDA     OREQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     CLEARTEMPDS                                                        CSD015
     C                     Z-ADD0         WID     20                                          CSD015
      *                                                                                       CSD015
     C           WID       DOUEQ9                                                             CSD015
     C                     ADD  1         WID                                                 CSD015
     C                     MOVELMMD,WID   PINP1                                               CSD015
      *                                                                                       CSD015
     C           MMD,WID   IFNE *BLANKS                                                       CSD015
     C           MMD,WID   ANDNE'000000'                                                      CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD   7                                           CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM *BLANKS   PINP2  35                                           CSD015
     C                     PARM *BLANKS   PINP3  35                                           CSD015
     C                     PARM *BLANKS   PINP4  35                                           CSD015
     C                     PARM *BLANKS   PINP5  35                                           CSD015
     C                     PARM *BLANKS   PINP6  35                                           CSD015
     C                     PARM           PCCY    3                                           CSD015
     C                     PARM           POUT  216                                           CSD015
     C                     PARM           PCNUM   6                                           CSD015
      *                                                                                       CSD015
     C                     CAT  POUT:0    TEMPDS                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
     C           TEMPDS    IFNE *BLANKS                                                       CSD015
     C**********           CAT  CWA,27:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,31:0  PMCWL                                               CSW210
     C                     CAT  TEMPDS:0  PMCWL                                               CSD015
     C**********           CAT  CWA,28:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,32:0  PMCWL                                               CSW210
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Add the Safekeeping Account Intermediary                                             CSD015
      *                                                                                       CSD015
     C           WIMSI     IFEQ 'Y'                                                           CSD015
     C           WIMSA     OREQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     CLEARTEMPDS                                                        CSD015
     C                     Z-ADD0         WID     20                                          CSD015
      *                                                                                       CSD015
     C           WID       DOUEQ9                                                             CSD015
     C                     ADD  1         WID                                                 CSD015
     C                     MOVELMSA,WID   PINP1                                               CSD015
      *                                                                                       CSD015
     C           MSA,WID   IFNE *BLANKS                                                       CSD015
     C           MSA,WID   ANDNE'000000'                                                      CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD   7                                           CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM *BLANKS   PINP2  35                                           CSD015
     C                     PARM *BLANKS   PINP3  35                                           CSD015
     C                     PARM *BLANKS   PINP4  35                                           CSD015
     C                     PARM *BLANKS   PINP5  35                                           CSD015
     C                     PARM *BLANKS   PINP6  35                                           CSD015
     C                     PARM           PCCY    3                                           CSD015
     C                     PARM           POUT  216                                           CSD015
     C                     PARM           PCNUM   6                                           CSD015
      *                                                                                       CSD015
     C                     CAT  POUT:0    TEMPDS                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
     C           TEMPDS    IFNE *BLANKS                                                       CSD015
     C**********           CAT  CWA,29:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,33:0  PMCWL                                               CSW210
     C                     CAT  TEMPDS:0  PMCWL                                               CSD015
     C**********           CAT  CWA,30:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,34:0  PMCWL                                               CSW210
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRENQ     - To Process Enquiry Action                       *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRENQ     BEGSR
      *
      ** Set indicators to protect fields
     C                     SETON                     0910
      *
      ** Check whether record exists
     C           KEY001    CHAINRTVIDX               89
     C/COPY WNCPYSRC,SE1806C039
      *
      ** If record found then set file fields to screen fields
     C           *IN89     IFEQ *OFF
     C                     EXSR SRFTOS
      *
      ** Redisplay first screen until rolldown on 2nd screen NOT taken
      ** or F3 (to End) or F5 (to Refresh) taken
     C           *IN86     DOUEQ*OFF
     C           *INKC     OREQ *ON
     C           *INKE     OREQ *ON
     C                     SETOF                     86
      *
      ** Display first screen; if rollup taken display second screen;
     C                     EXSR SRSCR1
     C********** *IN85     IFEQ *ON                                                           209945
     C           *IN85     DOWEQ*ON                                                           209945
     C           *IN86     ANDEQ*OFF                                                          209945
     C           *INKC     ANDEQ*OFF                                                          209945
     C           *INKE     ANDEQ*OFF                                                          209945
     C/COPY WNCPYSRC,SE1806C040
      *                                                                                       CSE028
      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C           PSNEW     IFEQ 'Y'                                                           CSE028
     C                     MOVE *ON       *IN84                                               CSE028
     C                     MOVE *ON       *IN77                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     EXSR SRSCR2
      *                                                                                       CSE028
      ** If Rollup was taken on second screen, call SE001810                                  CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C           *IN84     ANDEQ*ON                                                           CSE028
      *                                                                                       CSE028
     C                     EXSR SRSCR3                                                        CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C/COPY WNCPYSRC,SE1806C041
     C                     END
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      *  SRINB  - Routine to initialize screen fields with defaults.  *
      *                                                               *
      *****************************************************************
      *
     C           SRINB     BEGSR
      *
      **  Screen fields are initialized from the parameter TRADX2,
      **  which has the same layout as the file TRADSDX2
      **  Note positions (1 6) Trade reference have been replaced by
      **  the bulk reference number generated in SE3000.
     C                     MOVELW2TDRF    SBLKR
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     MOVELW2AP1N    SAP1N
     C                     ELSE                                           CSW098
     C                     MOVEL*BLANKS   SAP1N                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELW2AP1L    SAP1L
     C                     MOVELW2AFPN    SAFPN
     C                     MOVELW2AFPL    SAFPL
     C                     MOVELW2AWIA    SAWIA
     C                     MOVELW2AWIN    SAWIN
     C                     MOVELW2AWIL    SAWIL
     C                     MOVELW2BOFA    SBOFA
     C                     MOVELW2BOFN    SBOFN
     C                     MOVELW2BOF1    SBOF1
     C           CSW210    IFNE 'Y'                                                           CSW210
     C                     MOVELW2BOF2    SBOF2
     C                     ENDIF                                                              CSW210
     C                     MOVELW2ACL1    SACL1
     C                     MOVELW2ACL2    SACL2
     C                     MOVELW2SRL1    SSRL1
     C                     MOVELW2SRL2    SSRL2
     C                     MOVELW2SRL3    SSRL3
     C                     MOVELW2FIN1    SFIN1
     C                     MOVELW2FIN2    SFIN2
     C**********           MOVELW2RED1    SRED1                                               CSW210
     C**********           MOVELW2RED2    SRED2                                               CSW210
     C                     MOVELW2NAL1    SNAL1
     C                     MOVELW2NAL2    SNAL2
     C                     MOVELW2IPYN    SIPYN
     C                     MOVELW2IPYL    SIPYL
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     MOVELW2CTYN    SCTYN
     C                     ELSE                                           CSW098
     C                     MOVEL*BLANKS   SCTYN                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     MOVELW2CTYL    SCTYL
     C**********           MOVEL*BLANKS   SINVE                                        CSW098 CSW210
     C                     MOVEL*BLANKS   PINVE                                               CSW210
     C                     ELSE                                           CSW098
     C                     MOVEL*BLANKS   SCTYL                           CSW098
     C**********           MOVELW2INVE    SINVE                                        CSW098 CSW210
     C                     MOVELW2INVE    PINVE                                               CSW210
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C           *IN78     OREQ *ON                                                           201429
     C                     MOVELW2SA1N    SSA1N
     C                     ELSE                                           CSW098
     C                     MOVEL*BLANKS   SSA1N                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELW2SA1L    SSA1L
     C                     MOVELW2SKAN    SSKAN
     C                     MOVELW2SKAL    SSKAL
     C                     MOVELW2CCTN    SCCTN
     C                     MOVELW2DCTL    SDCTL
     C                     MOVELW2RSSA    SRSSA
     C                     MOVELW2RSSN    SRSSN
     C                     MOVELW2RSS1    SRSS1
     C                     MOVELW2RSS2    SRSS2
     C                     MOVELW2RSS3    SRSS3
     C                     MOVELW2RSS4    SRSS4
     C                     MOVELW2DSSA    SDSSA
     C                     MOVELW2DSSN    SDSSN
     C                     MOVELW2DSS1    SDSS1
      *
     C                     MOVELW2DSS2    SDSS2
     C                     MOVELW2DSS3    SDSS3
     C                     MOVELW2DSS4    SDSS4
     C                     MOVELW2BSSA    SBSSA
     C                     MOVELW2BSSN    SBSSN
     C                     MOVELW2BSS1    SBSS1
     C                     MOVELW2BSS2    SBSS2
      *
     C                     ENDSR
     C/COPY WNCPYSRC,SE1806C021
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSMSG    - To Send Messages to Message Subfile             *
      **                                                              *
      *****************************************************************
      *
     C           SRSMSG    BEGSR
      *
      ** Send specified message from specified message file to program
      ** message queue; then clear message id and message file
     C                     CALL 'ZA0340'
     C                     PARM 'SEUSRMSG'ZAMSGF 10
     C                     PARM           ZAMSID 10
      *
     C                     MOVEL*BLANK    ZAMSID
      *
     C                     ENDSR
      *
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SREMSG    - To Send Messages to Message Subfile             *                       CSW210
      **              with Message Data                               *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SREMSG    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Send specified message from specified message file to program                        CSW210
      ** message queue; then clear message id and message file                                CSW210
     C                     CALL 'ZA0350'                                                      CSW210
     C                     PARM 'SEUSRMSG'ZAMSGF                                              CSW210
     C                     PARM           ZAMSID                                              CSW210
     C                     PARM           ZAMSDT 45                                           CSW210
      *                                                                                       CSW210
     C                     MOVEL*BLANK    ZAMSID                                              CSW210
     C                     MOVEL*BLANK    ZAMSDT                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRALOC    - To Access Record via Update Index               *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRALOC    BEGSR
      *
     C           KEY001    CHAINUPDIDX               8081
      *
      ** If record not on file, setup message 'Record deleted'
     C           *IN80     IFEQ *ON
     C                     MOVEL'SEW9998' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1806C042
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRTRN    - To set up return code and exit program          *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRRTRN    BEGSR
      *
     C                     MOVE 'N'       PERR
     C                     MOVE '00'      PCMD
      *
      ** If error on updating file set Return Error Code to 'U'
     C           *IN88     IFEQ *ON
     C                     MOVE 'U'       PERR
     C                     ELSE
      *
      ** If Rolldown or F12 (for Previous) set Return Command to '12'
     C           *IN87     IFEQ *ON
     C           *INKL     OREQ *ON
     C                     MOVE '12'      PCMD
     C                     ELSE
      *
      ** If no record retrieved for enquiry set Return Err Comm to 'R'
     C           PACTN     IFEQ 'E'
     C           *IN89     ANDEQ*ON
     C                     MOVE 'R'       PERR
     C                     ELSE
      *
      ** If F3 (to End) taken set Return Command to '03'
     C           *INKC     IFEQ *ON
     C                     MOVE '03'      PCMD
     C                     ELSE
      *
      ** If F5 (to Refresh) set Return Command to '05'
     C           *INKE     IFEQ *ON
     C                     MOVE '05'      PCMD
     C                     ELSE
      *
      ** If F14 (to Exit Extended Settlements) set Return Comm to '14'
     C           *INKN     IFEQ *ON
     C                     MOVE '14'      PCMD
     C                     END
      *
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE1806C043
      *
      ** Seton *INLR to exit program
     C                     SETON                     LR
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSCR1    - To Output Messages and First Screen             *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRSCR1    BEGSR
      *
      ** Display message format; display first screen
     C                     WRITESE1806C1
     C                     EXFMTSE1806F1
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSCR2    - To Output Messages and Second Screen            *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRSCR2    BEGSR
      *
      ** Display message format; display second screen
     C                     WRITESE1806C1
     C                     EXFMTSE1806F2
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1806C044
      *****************************************************************
      /EJECT                                                                                  CSE028
      *****************************************************************                       CSE028
      *                                                               *                       CSE028
      *  SRSCR3    - Call SE001810 to display and process third screen*                       CSE028
      *                                                               *                       CSE028
      *  Calls     - SE001810                                         *                       CSE028
      *  Called By - SRINS, SRAMD & SRENQ                             *                       CSE028
      *                                                               *                       CSE028
      *****************************************************************                       CSE028
      *                                                                                       CSE028
     C           SRSCR3    BEGSR                                                              CSE028
      *                                                                                       CSE028
      ** Check if Place of settlement from STDADSED is blanks or no SSI                       215783
      ** exist. If so, get default from Market Center file.                                   215783
      *                                                                                       215783
     C           PACTN     IFEQ 'I'                                                           215783
     C           PPSET     ANDEQ*BLANKS                                                       215783
     C           PACTN     OREQ 'B'                                                           215783
     C           PPSET     ANDEQ*BLANKS                                                       215783
     C           PSMCC     CHAINSEMKC                79                                       215783
     C           *IN79     IFEQ '0'                                                           215783
     C                     MOVE PSETL     PPSET                                               215783
     C                     END                                                                215783
     C                     END                                                                215783
      *                                                                                       215783
     C                     CALL 'SE001810'                                                    CSE028
     C                     PARM           PACTN   1                                           CSE028
     C                     PARM           PINTRM                                              CSE028
     C                     PARM           PSAFEA                                              CSE028
     C                     PARM           PPSET  12                                           CSE028
     C                     PARM           PNARR                                               CSE028
     C                     PARM *BLANKS   PRTCD   7                                           CSE028
     C                     PARM           PREGD                                               CSW210
     C                     PARM           PINVE  10                                           CSW210
     C                     PARM           PQFIN  10                                           CSW210
     C                     PARM           PPCLR  10                                           CSW210
      *                                                                                       CSE028
      ** Check Return Code                                                                    CSE028
      *                                                                                       CSE028
     C           PRTCD     IFEQ 'SE10000'                                                     CSE028
     C                     MOVE *ON       *INKC                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           PRTCD     IFEQ 'SE10001'                                                     CSE028
     C                     MOVE *ON       *INKL                                               CSE028
     C                     MOVE 'Y'       W3RDFL  1                                           CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           PRTCD     IFEQ 'SE10029'                                                     CSE028
     C                     MOVE *ON       *IN85                                               CSE028
     C                     MOVE *ON       *IN02                                               201429
     C                     MOVE *ON       *IN75                                               201429
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           PRTCD     IFEQ *BLANKS                                                       CSE028
     C                     MOVE *OFF      *IN75                                               CSE028
     C                     MOVE *OFF      *IN85                                               CSE028
     C                     MOVE *OFF      *IN84                                               201429
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDSR                                                              CSE028
      *****************************************************************                       CSE028
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRVAL     - To Control Validation of each Field             *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRVAL     BEGSR
      *
      ** Initialize error condition indicators
     C                     SETOF                     0275
     C                     SETOF                     111214                                   CSW210
     C                     SETOF                     151617                                   CSW210
      *
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000000'*IN,29
     C                     MOVEA'00000000'*IN,37
     C                     MOVEA'00000000'*IN,45
     C                     MOVEA'00000000'*IN,53
     C                     MOVEA'00000000'*IN,61
     C/COPY WNCPYSRC,SE1806C045
     C                     MOVE *OFF      *IN19                           CSW098
      *
      ** Reset validations by F19
     C           *INKT     IFEQ *ON
     C                     MOVE *BLANK    OVER2
     C                     MOVE *BLANK    OVER3
     C                     MOVE *BLANK    OVER6
     C                     MOVE *BLANK    OVER7
     C                     MOVE *BLANK    OVER8
     C                     MOVE *BLANK    OVER9
     C                     END
      *
      ** Validate A/c for Payment fields (MT510)
     C                     EXSR SRAP1N
     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
     C                     EXSR SRAP1L
     C**********           ENDIF                                                       199797 CSW210
      *
      ** Validate Account For Payment fields
     C                     EXSR SRAFPN
     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
     C                     EXSR SRAFPL
     C**********           ENDIF                                                       199797 CSW210
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
      *                                                                                       CSW210
      ** Validate Validate Debtor (Identification)                                            CSW210
     C                     EXSR SRDIDN                                                        CSW210
      *                                                                                       CSW210
      ** Validate Validate Debtor (Address)                                                   CSW210
     C                     EXSR SRDADD                                                        CSW210
      *                                                                                       CSW210
      ** Validate Validate Debtor (Account Line)                                              CSW210
     C                     EXSR SRDLIN                                                        CSW210
     C                     ENDIF                                                              CSW210
      *
      ** Validate Account With Institution fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRAWIA
     C                     ENDIF                                                              212937
     C                     EXSR SRAWIN
     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
     C                     EXSR SRAWIL
     C**********           ENDIF                                                       199797 CSW210
      *
      ** Validate Beneficiary of Money fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRBOFA
     C                     ENDIF                                                              212937
     C                     EXSR SRBOFN
     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
     C********** CSE028    ORNE 'Y'                                                    199797 CSW210
     C                     EXSR SRBOF1
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    ORNE 'Y'                                                           CSW210
     C           CSW210    IFNE 'Y'                                                           CSW210
     C                     EXSR SRBOF2
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              199797
      *
      ** Validate Account For Charges fields
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRACL1
     C                     EXSR SRACL2
     C                     ENDIF                                                              199797
      *
      ** Validate Sender to Receiver Information
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRSRL1
     C                     EXSR SRSRL2
     C                     EXSR SRSRL3
     C                     ENDIF                                                              199797
      *
      ** Validate Further Information field
     C/COPY WNCPYSRC,SE1806C046
     C                     EXSR SRFIN1
     C                     EXSR SRFIN2
     C/COPY WNCPYSRC,SE1806C047
      *
      ** Validate Registration Details field
     C/COPY WNCPYSRC,SE1806C048
     C**********           EXSR SRRED1                                                        CSW210
     C**********           EXSR SRRED2                                                        CSW210
     C/COPY WNCPYSRC,SE1806C049
      *
      ** Validate Narrative field
     C                     EXSR SRNAL1
     C                     EXSR SRNAL2
      *                                                                   CSW098
      ** If ccy clearing code entered for a/c w/ bank or beneficiary,     CSW098
      ** check whether Issuer Code has been defined for the currency      CSW098
      ** clearing system and output warning message if not defined.       CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C           *IN75     ANDEQ*OFF                                      CSW098
     C           IAWBK     IFEQ 'Y'                                       CSW098
     C                     MOVE *ON       *IN75                           CSW098
     C                     MOVE *ON       *IN27                           CSW098
     C                     MOVEL'SEW5176' ZAMSID                          CSW098
     C                     EXSR SRSMSG                                    CSW098
     C                     MOVEL*BLANKS   IAWBK                           CSW098
     C                     ENDIF                                          CSW098
     C           IBENF     IFEQ 'Y'                                       CSW098
     C                     MOVE *ON       *IN75                           CSW098
     C                     MOVE *ON       *IN30                           CSW098
     C                     MOVEL'SEW5176' ZAMSID                          CSW098
     C                     EXSR SRSMSG                                    CSW098
     C                     MOVEL*BLANKS   IBENF                           CSW098
     C                     ENDIF                                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                                       CSW210
      ** Issue Warning Message for BIC error                                                  CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WWADD     IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     MOVE 'N'       WWADD                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Issue Warning Message for IBAN-SDLIN error                                           CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WSDLIN    IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Issue Warning Message for IBAN-SAP1L error                                           CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WSAP1L    IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Issue Warning Message for IBAN-SAP2L error                                           CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WSAP2L    IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Issue Warning Message for IBAN-SAWIL error                                           CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WSAWIL    IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Issue Warning Message for IBAN-SBOF1 error                                           CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WSBOF1    IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *
      ** No errors found on first screen
     C           *IN75     IFEQ *OFF
     C                     SETON                     02
     C                     END
      *
      ** Validate Instructing Party fields
     C                     EXSR SRIPYN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRIPYL
     C                     ENDIF                                                              199797
      *                                                                   CSW098
      ** Validate Investor                                                CSW098
     C**********           EXSR SRINVE                                                 CSW098 CSW210
      *
      ** Validate Counterparty fields
     C                     EXSR SRCTYN
     C                     EXSR SRCTYL
      *
      ** Validate Safekeeping Account fields (MT510)
     C                     EXSR SRSA1N
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRSA1L
     C                     ENDIF                                                              199797
      *
      ** Validate Safekeeping Account fields
     C           *IN05     IFEQ *OFF                                                          201429
     C                     EXSR SRSKAN
      *                                                                                       201429
     C           SSKAL     IFEQ *BLANKS                                                       201429
     C           PSAFA     ANDEQ*BLANKS                                                       201429
     C           *IN78     ANDEQ*ON                                                           201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN50                                               201429
     C                     MOVEL'SEW9004' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *                                                                                       201429
     C           SSKAL     IFNE *BLANKS                                                       201429
     C           PSAFA     ANDNE*BLANKS                                                       201429
     C           *IN78     ANDEQ*ON                                                           201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN50                                               201429
     C                     MOVEL'SEW9007' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *                                                                                       201429
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRSKAL
     C                     ENDIF                                                              199797
     C                     ENDIF                                                              201429
      *
      ** Validate Clearing Correspondent fields
     C           *IN06     IFEQ '0'                                                           199797
     C                     EXSR SRCCTN
     C                     ENDIF                                                              199797
      *
      ** Validate Deliverer's Instructing Party field
     C/COPY WNCPYSRC,SE1806C050
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRDCTL
     C                     ENDIF                                                              199797
     C/COPY WNCPYSRC,SE1806C051
      *
      ** Validate Receiver of Securities fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRRSSA
     C                     ENDIF                                                              212937
     C                     EXSR SRRSSN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRRSS1
     C                     EXSR SRRSS2
     C                     EXSR SRRSS3
     C                     EXSR SRRSS4
     C                     ENDIF                                                              199797
      *
      ** Validate Deliverer of Securities fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRDSSA
     C                     ENDIF                                                              212937
     C                     EXSR SRDSSN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRDSS1
     C                     EXSR SRDSS2
     C                     EXSR SRDSS3
     C                     EXSR SRDSS4
     C                     ENDIF                                                              199797
      *
      ** Validate Beneficiary of Securities fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRBSSA
     C                     ENDIF                                                              212937
     C                     EXSR SRBSSN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    ORNE 'Y'                                                           199797
     C                     EXSR SRBSS1
     C                     EXSR SRBSS2
     C                     ENDIF                                                              199797
      *
      ** No errors found on second screen
     C           *IN75     IFEQ *OFF
     C                     SETOF                     02
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAP1N    - Validate A/c for Payment :53: (MT510)           *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAP1N    BEGSR
      *
      ** Validate if not Blank.
     C           SAP1N     IFNE *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
      *
      ** This Field may only be used to generate a MT510
     C           PGMEC     IFNE 'Y'
     C           PCCID     ORNE 'C'
     C                     SETON                     2175
     C                     MOVEL'SEW5206' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Set Error Indicator ON this field Before Validation.
     C           *IN21     IFEQ *OFF
     C                     SETON                     21
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SAP1N     WWCUST 10
     C                     EXSR SRCUST
      *
      ** Reset Error Indicator IF field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     21
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWAP1N
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWAP1N
     C                     END
     C                     END
      *
     C                     ELSE
      *
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWAP1N
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAP1L    - Validate A/c for Payment A/c Line :53: (MT510)  *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAP1L    BEGSR
      *
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    ORNE 'Y'                                                           CSW210
      ** Validate If not Blank
     C           SAP1L     IFNE *BLANKS
      *
     C           PGMEC     IFNE 'Y'
     C           PCCID     ORNE 'C'
     C                     SETON                     2275
     C           SAP1N     IFEQ *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
     C                     MOVEL'SEW5206' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVEL'SEW5177' ZAMSID                          CSW098
     C                     EXSR SRSMSG                                    CSW098
     C                     ENDIF                                          CSW098
     C                     END
      *
     C                     MOVELSAP1L     WWLI01  1
     C           WWLI01    IFNE '/'
     C                     SETON                     2275
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSAP1L     WWLI02  2
     C           WWLI02    IFEQ '//'
     C                     SETON                     2275
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SAP1L     WWLI34 34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     2275
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** Either SWIFT Field 53 or (57 AND 58) can be Entered
     C           SAP1N     IFNE *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
     C           SAP1L     ORNE *BLANKS
      *
     C           SAWIN     IFNE *BLANKS
     C           SAWIL     ORNE *BLANKS
     C           SBOFN     ORNE *BLANKS
     C           SBOF1     ORNE *BLANKS
     C           SBOF2     ORNE *BLANKS
     C                     SETON                     2275
     C                     MOVEL'SEW5215' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if value inserted is an IBAN                                                   CSW210
     C           SAP1L     IFNE *BLANKS                                                       CSW210
     C           CSW210    ANDEQ'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVELSAP1L     DSIBAN                                              CSW210
     C           SAP1L     IFNE WWAP1L                                                        CSW210
     C                     EXSR SRIBAN                                                        CSW210
     C                     MOVE WVIBAN    WWFAP1                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVE WIBNWR    WSAP1L                                              CSW210
      *                                                                                       CSW210
      ** Replace field value if validated as an IBAN input                                    CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WSAP1L                                              CSW210
     C                     MOVELWIBRTN    SAP1L                                               CSW210
     C                     MOVE *BLANKS   WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If not IBAN, throw corresponding warning messages                                    CSW210
     C           WSAP1L    IFEQ 'Y'                                                           CSW210
     C           SAP1L     ANDEQWWAP1L                                                        CSW210
     C                     MOVE 'N'       WSAP1L                                              CSW210
     C                     ELSE                                                               CSW210
     C           WIBNWR    IFEQ 'Y'                                                           CSW210
     C           SAP1L     ANDNEWWAP1L                                                        CSW210
     C                     MOVELWTIBAN    SAP1L                                               CSW210
     C                     SETON                     22                                       CSW210
     C                     MOVE 'Y'       WSAP1L                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     MOVELS210W,1   ZAMSDT                                              CSW210
     C                     EXSR SREMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSAP1L     WWAP1L                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WWFAP1                                              CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAFPN    - Validate A/c for Payment :53:                   *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAFPN    BEGSR
      *
      ** Validate If not Blank
     C           SAFPN     IFNE *BLANKS
      *
      ** Account for Payment must be left Blank for Clearance 1 to 4
     C           WWCLTY    IFEQ '14'
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     SETON                     2375
     C                     MOVEL'SEW5216' ZAMSID
     C                     EXSR SRSMSG
     C                     ENDIF                                                              212937
      *
     C                     ELSE
      ** Account for Payment must be left Blank for Instructions Free
     C           PPCOD     IFNE '1'
     C           PPCOD     ANDNE'5'
     C                     SETON                     2375
     C                     MOVEL'SEW5217' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
      ** Set Error Indicator ON this Field before Validation.
     C           *IN23     IFEQ *OFF
     C                     SETON                     23
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SAFPN     WWCUST 10
     C                     EXSR SRCUST
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     23
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWAFPN
     C                     END
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWAFPN
     C                     END
      *
     C                     ELSE
      *
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWAFPN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAFPL    - Validate A/c for Payment A/c Line :53:          *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAFPL    BEGSR
      *
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    ORNE 'Y'                                                           CSW210
      ** Validate If not Blank
     C                     MOVELSAFPL     WWAFPL  1
     C           SAFPL     IFNE *BLANKS
     C           WWAFPL    ANDNE'#'
      *
     C           WWCLTY    IFEQ '14'
     C                     SETON                     2475
     C           SAFPN     IFEQ *BLANKS
     C                     MOVEL'SEW5216' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** Account for Payment must be left Blank for Instructions Free
     C           PPCOD     IFNE '1'
     C           PPCOD     ANDNE'5'
     C                     SETON                     2475
     C           SAFPN     IFEQ *BLANKS
     C                     MOVEL'SEW5217' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
     C                     END
      *
     C                     MOVELSAFPL     WWLI01
     C           WWLI01    IFNE '/'
     C                     SETON                     2475
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSAFPL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     SETON                     2475
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SAFPL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     2475
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** Either SWIFT Field 53 or (57 AND 58) can be Entered
     C***********PTDTP     IFEQ 'TS'                                      CSW003
     C           WTDTP     IFEQ 'TS'                                      CSW003
     C           SAFPN     ANDNE*BLANKS
     C***********PTDTP     OREQ 'TS'                                      CSW003
     C           WTDTP     OREQ 'TS'                                      CSW003
     C           SAFPL     ANDNE*BLANKS
      *
     C           SAWIN     IFNE *BLANKS
     C           SAWIL     ORNE *BLANKS
     C           SBOFN     ORNE *BLANKS
     C           SBOF1     ORNE *BLANKS
     C           SBOF2     ORNE *BLANKS
     C                     SETON                     2475
     C                     MOVEL'SEW5215' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if value inserted is an IBAN                                                   CSW210
     C           SAFPL     IFNE *BLANKS                                                       CSW210
     C           CSW210    ANDEQ'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVELSAFPL     DSIBAN                                              CSW210
     C           SAFPL     IFNE WWAP2L                                                        CSW210
     C                     EXSR SRIBAN                                                        CSW210
     C                     MOVE WVIBAN    WWFAP2                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Replace field value if validated as an IBAN input                                    CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WSAP2L                                              CSW210
     C                     MOVELWIBRTN    SAFPL                                               CSW210
     C                     MOVE *BLANKS   WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If not IBAN, throw corresponding warning messages                                    CSW210
     C           WSAP2L    IFEQ 'Y'                                                           CSW210
     C           SAFPL     ANDEQWWAP2L                                                        CSW210
     C                     MOVE 'N'       WSAP2L                                              CSW210
     C                     ELSE                                                               CSW210
     C           WIBNWR    IFEQ 'Y'                                                           CSW210
     C           SAFPL     ANDNEWWAP2L                                                        CSW210
     C                     MOVELWTIBAN    SAFPL                                               CSW210
     C                     SETON                     24                                       CSW210
     C                     MOVE 'Y'       WSAP2L                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     MOVELS210W,1   ZAMSDT                                              CSW210
     C                     EXSR SREMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSAFPL     WWAP2L                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WWFAP2                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     ENDSR
      *
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRDIDN    - Validate Debtor Identification                  *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - SRCUST                                          *                       CSW210
      **  Called By - SRVAL                                           *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRDIDN    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Validate If not Blank                                                                CSW210
     C           SDIDN     IFNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
      ** Debtor must be left blank when instructions free of payment                          CSW210
     C           PPCOD     IFNE '1'                                                           CSW210
     C           PPCOD     ANDNE'5'                                                           CSW210
     C                     SETON                     1175                                     CSW210
     C                     MOVEL'ST00112' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
      ** Either Debtor Identification or Debtor Address lines may be                          CSW210
      *  entered, but not both                                                                CSW210
     C           SDAD1     IFNE *BLANKS                                                       CSW210
     C           SDAD2     ORNE *BLANKS                                                       CSW210
     C           SDAD3     ORNE *BLANKS                                                       CSW210
     C           SDAD4     ORNE *BLANKS                                                       CSW210
     C                     SETON                     1175                                     CSW210
     C                     MOVEL'ST00113' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Set Error Indicator ON this Field before Validation.                                 CSW210
     C           *IN11     IFEQ *OFF                                                          CSW210
     C                     SETON                     11                                       CSW210
      *                                                                                       CSW210
      ** Validate Customer Number/Shortname/Nostro                                            CSW210
     C                     MOVE SDIDN     WWCUST 10                                           CSW210
     C                     EXSR SRCUST                                                        CSW210
      *                                                                                       CSW210
      ** Reset Error Indicator If field is Valid                                              CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C           WWCUSS    OREQ 'N'                                                           CSW210
     C                     SETOF                     11                                       CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
      ** Customer Number/Shortname                                                            CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCUST    WWDIDN                                              CSW210
     C                     END                                                                CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
      ** Nostro                                                                               CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    WWDIDN                                              CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C                     MOVELSDIDN     SDIDN1  1                                           CSW210
     C           SDIDN1    IFEQ '?'                                                           CSW210
     C                     MOVELWWDIDN    SDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** Else If Screen Field is Blank, ensure workfield is also Blank                        CSW210
     C                     MOVE *BLANKS   WWDIDN                                              CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRDLIN    - Validate Debtor Account Line                    *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - SRSMSG                                          *                       CSW210
      **  Called By - SRVAL                                           *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRDLIN    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Validate If not Blank                                                                CSW210
     C           SDLIN     IFNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
      ** Debtor must be left blank when instructions free of payment                          CSW210
     C           PPCOD     IFNE '1'                                                           CSW210
     C           PPCOD     ANDNE'5'                                                           CSW210
     C                     SETON                     1275                                     CSW210
     C                     MOVEL'ST00112' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Debtor Identification and Debtor Address lines are blanks                            CSW210
     C           SDIDN     IFEQ *BLANKS                                                       CSW210
     C           SDAD1     ANDEQ*BLANKS                                                       CSW210
     C           SDAD2     ANDEQ*BLANKS                                                       CSW210
     C           SDAD3     ANDEQ*BLANKS                                                       CSW210
     C           SDAD4     ANDEQ*BLANKS                                                       CSW210
     C                     SETON                     1275                                     CSW210
     C                     MOVEL'ST00082' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if value inserted is an IBAN                                                   CSW210
     C           CFT004    IFEQ 'Y'                                                           CSW210
     C                     MOVELSDLIN     DSIBAN                                              CSW210
     C           SDLIN     IFNE WWCOMP                                                        CSW210
     C                     EXSR SRIBAN                                                        CSW210
     C                     MOVE WVIBAN    WWFDBT                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Replace field value if validated as an IBAN input                                    CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WSDLIN                                              CSW210
     C                     MOVELWIBRTN    SDLIN                                               CSW210
     C                     MOVE *BLANKS   WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
     C           WSDLIN    IFEQ 'Y'                                                           CSW210
     C           SDLIN     ANDEQWWCOMP                                                        CSW210
     C                     MOVE 'N'       WSDLIN                                              CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If not IBAN, throw corresponding warning messages                                    CSW210
     C           WIBNWR    IFEQ 'Y'                                                           CSW210
     C           SDLIN     ANDNEWWCOMP                                                        CSW210
     C                     MOVELWTIBAN    SDLIN                                               CSW210
     C                     SETON                     12                                       CSW210
     C                     MOVE 'Y'       WSDLIN                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     MOVELS210W,2   ZAMSDT                                              CSW210
     C                     EXSR SREMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSDLIN     WWCOMP                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WWFDBT                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRDADD    - Validate Debtor Address                         *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - SRSMSG                                          *                       CSW210
      **  Called By - SRVAL                                           *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRDADD    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Populate work fields                                                                 CSW210
     C                     MOVE *BLANKS   ACTFLG  1                                           CSW210
     C                     MOVELSDAD1     DSDAD1                                              CSW210
     C                     MOVELSDAD2     DSDAD2                                              CSW210
     C                     MOVELSDAD3     DSDAD3                                              CSW210
     C                     MOVELSDAD4     DSDAD4                                              CSW210
      *                                                                                       CSW210
      ** Validate If not Blank                                                                CSW210
     C           DADDRS    IFNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
      ** Debtor Identification and Debtor Address lines are blanks                            CSW210
     C           PPCOD     IFNE '1'                                                           CSW210
     C           PPCOD     ANDNE'5'                                                           CSW210
     C                     SETON                     1475                                     CSW210
     C                     MOVEL'ST00112' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Debtor Identification and Debtor Address lines are blanks                            CSW210
     C           SDIDN     IFNE *BLANKS                                                       CSW210
     C                     SETON                     1475                                     CSW210
     C                     MOVEL'ST00113' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVELDADDRS    ADDRSS                                              CSW210
      *                                                                                       CSW210
      ** Validate SWIFT Address                                                               CSW210
     C           ACTFLG    IFEQ *BLANKS                                                       CSW210
      *                                                                                       CSW210
     C           ADCH26    IFEQ *BLANKS                                                       CSW210
     C           ADEXSW    ANDEQ*BLANKS                                                       CSW210
     C           ADSLSH    ANDNE'/'                                                           CSW210
      *                                                                                       CSW210
      ** First 11 characters should be key for CLSWT                                          CSW210
     C                     MOVELADCHK1    CLSWTK 35                                           CSW210
      *                                                                                       CSW210
     C                     EXSR SRSWFT                                                        CSW210
      *                                                                                       CSW210
     C           ##CSID    IFEQ 'Y'                                                           CSW210
      *                                                                                       CSW210
      ** SWIFT Identifier was not found                                                       CSW210
     C           *IN91     IFEQ *ON                                                           CSW210
     C                     SETON                     1475                                     CSW210
     C                     MOVEL'ST00078' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'S'       ACTFLG                                              CSW210
      *                                                                                       CSW210
      ** The BIC directory is not loaded and the code is defined in the                       CSW210
      ** Customer detail file                                                                 CSW210
     C           *IN92     IFEQ *ON                                                           CSW210
     C           *IN91     ANDEQ*OFF                                                          CSW210
      *                                                                                       CSW210
     C           WWADD     IFNE *BLANK                                                        CSW210
     C           CLSWTK    ANDEQWDACT                                                         CSW210
     C                     MOVE 'N'       WWADD                                               CSW210
     C                     ELSE                                                               CSW210
     C           CLSWTK    IFNE WDACT                                                         CSW210
     C                     SETON                     14                                       CSW210
     C                     MOVE 'Y'       WWADD                                               CSW210
     C                     MOVEL'ST00079' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Validate as codeword                                                                 CSW210
     C           ACTFLG    IFEQ *BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADSLSH    IFEQ '/'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVE 'R'       ACTFLG                                              CSW210
     C                     MOVELSDAD1     PASWCD 35                                           CSW210
     C                     EXSR SRVCDE                                                        CSW210
      *                                                                                       CSW210
     C           WMEMID    IFEQ *BLANKS                                                       CSW210
      *                                                                                       CSW210
      ** Line 2 is mandatory                                                                  CSW210
     C           SDAD2     IFEQ *BLANKS                                                       CSW210
     C                     SETON                     1575                                     CSW210
     C                     MOVEL'ST00122' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
     C                     MOVELSDAD2     I#FLD                                               CSW210
     C                     EXSR SRSWST                                                        CSW210
     C           INSET     IFEQ 'Y'                                                           CSW210
     C                     SETON                     1575                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                     AR640699
      ** CODEWORD is valid and second line is more than 34 characters                       AR640699
      *                                                                                     AR640699
     C           DSDA34    IFNE *BLANKS                                                     AR640699
     C                     SETON                     1575                                   AR640699
     C                     MOVEL'ST00124' ZAMSID                                            AR640699
     C                     MOVEL'SEUSRMSG'ZAMSGF                                            AR640699
     C                     EXSR SRSMSG                                                      AR640699
     C                     ENDIF                                                            AR640699
      *                                                                                       CSW210
      ** Linse 3 and 4 should be blanks                                                       CSW210
     C           SDAD3     IFNE *BLANKS                                                       CSW210
     C           SDAD4     ORNE *BLANKS                                                       CSW210
     C                     SETON                     161775                                   CSW210
     C                     MOVEL'ST00123' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** Error on SWIFT Code                                                                  CSW210
     C                     SETON                     1475                                     CSW210
     C                     MOVELWMEMID    ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Validate as an Address                                                               CSW210
     C           ACTFLG    IFEQ *BLANKS                                                       CSW210
     C                     EXSR SRACHK                                                        CSW210
      *                                                                                       CSW210
      ** Embedded blank lines exist in the Debtor address fields                              CSW210
     C           INVAL1    IFEQ 'Y'                                                           CSW210
     C                     MOVEA'1111'    *IN,14                                              CSW210
     C                     SETON                       75                                     CSW210
     C                     MOVEL'ST00080' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Non-valid SWIFT character is found                                                   CSW210
     C           INVAL2    IFEQ 'Y'                                                           CSW210
     C           AD#1      IFEQ 'Y'                                                           CSW210
     C                     SETON                     14                                       CSW210
     C                     ENDIF                                                              CSW210
     C           AD#2      IFEQ 'Y'                                                           CSW210
     C                     SETON                     15                                       CSW210
     C                     ENDIF                                                              CSW210
     C           AD#3      IFEQ 'Y'                                                           CSW210
     C                     SETON                     16                                       CSW210
     C                     ENDIF                                                              CSW210
     C           AD#4      IFEQ 'Y'                                                           CSW210
     C                     SETON                     17                                       CSW210
     C                     ENDIF                                                              CSW210
     C                     SETON                       75                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Consider as Address if valid                                                         CSW210
     C           *IN14     IFEQ *OFF                                                          CSW210
     C           *IN15     ANDEQ*OFF                                                          CSW210
     C           *IN16     ANDEQ*OFF                                                          CSW210
     C           *IN17     ANDEQ*OFF                                                          CSW210
     C                     MOVE 'A'       ACTFLG                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELCLSWTK    WDACT                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRSWFT    - SWIFT Address validation                        *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - ME1400                                          *                       CSW210
      **  Called By - SRDADD                                          *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRSWFT    BEGSR                                                              CSW210
     C                     SETOF                     909192                                   CSW210
      *                                                                                       CSW210
      ** Test positions 1-8 for valid SWIFT Characters                                        CSW210
      ** Check how many characters are alphanumeric                                           CSW210
     C                     MOVEL*BLANKS   FLD    35                                           CSW210
     C                     MOVELCLSWTK    FLD                                                 CSW210
     C           ALPHAN    CHECKFLD       X#      30     90                                   CSW210
      *                                                                                       CSW210
      ** If the first 8 or 11 are ok proceed                                                  CSW210
     C           *IN90     IFEQ *ON                                                           CSW210
     C           X#        ANDEQ9                                                             CSW210
     C           *IN90     OREQ *ON                                                           CSW210
     C           X#        ANDEQ12                                                            CSW210
     C           ' '       CHECKFLD:X#    ##001   10     90                                   CSW210
      *                                                                                       CSW210
      ** Check for blanks if before 8 or 11 then assume address                               CSW210
     C           *IN90     IFEQ *ON                                                           CSW210
     C           X#        ANDEQ11                                                            CSW210
     C                     SETON                     91                                       CSW210
     C                     MOVE 'Y'       ##CSID  1                                           CSW210
     C                     GOTO ENDSWT                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Invalid format - Not a S.W.I.F.T.                                                    CSW210
     C           *IN90     IFEQ *ON                                                           CSW210
     C                     MOVE 'N'       ##CSID                                              CSW210
     C                     GOTO ENDSWT                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Call Access object to validate identifier                                            CSW210
     C                     MOVELFLD       W9BICC                                              CSW210
     C           3         SUBSTFLD:9     W9BICB                                              CSW210
      *                                                                                       CSW210
     C                     CALL 'ME1400'                                                      CSW210
     C                     PARM *BLANKS   W9RTN   7                                           CSW210
     C                     PARM           W9BICC  8                                           CSW210
     C                     PARM           W9BICB  3                                           CSW210
     C                     PARM           SDCUST                                              CSW210
     C                     PARM           SDCNST                                              CSW210
     C                     PARM           MEBICD                                              CSW210
     C                     PARM *BLANKS   W9CUST  1                                           CSW210
     C                     PARM *BLANKS   W9CNST  1                                           CSW210
     C                     PARM *BLANKS   W9BICD  1                                           CSW210
      *                                                                                       CSW210
     C                     SELEC                                                              CSW210
      *                                                                                       CSW210
      ** Record not found on directory but found on others                                    CSW210
      ** BIC directory has data so error                                                      CSW210
     C           W9RTN     WHEQ 'MIN0244'                                                     CSW210
     C           W9RTN     OREQ 'MIN0245'                                                     CSW210
     C           W9RTN     OREQ 'MIN0246'                                                     CSW210
     C                     SETON                     91                                       CSW210
     C                     MOVE 'Y'       ##CSID                                              CSW210
      *                                                                                       CSW210
      ** Record not found - S.W.I.F.T does not exist                                          CSW210
     C           W9RTN     WHEQ 'Y2U0005'                                                     CSW210
     C                     SETON                     92                                       CSW210
     C                     MOVE 'Y'       ##CSID                                              CSW210
      *                                                                                       CSW210
      ** Record found - BIC exists                                                            CSW210
     C           W9RTN     WHEQ *BLANKS                                                       CSW210
     C                     MOVE 'Y'       ##CSID                                              CSW210
     C                     ENDSL                                                              CSW210
      *                                                                                       CSW210
     C           ENDSWT    TAG                                                                CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRACHK    - Validate Address Fields                         *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - SRSWST                                          *                       CSW210
      **  Called By - SRDADD                                          *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRACHK    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Set off indicators                                                                   CSW210
      *                                                                                       CSW210
     C                     SETOF                     1718                                     CSW210
      *                                                                                       CSW210
      ** Define error code texts                                                              CSW210
      *                                                                                       CSW210
     C                     MOVEL*BLANKS   AD#1                                                CSW210
     C                     MOVEL*BLANKS   AD#2                                                CSW210
     C                     MOVEL*BLANKS   AD#3                                                CSW210
     C                     MOVEL*BLANKS   AD#4                                                CSW210
     C                     MOVEL*BLANKS   INVAL1                                              CSW210
     C                     MOVEL*BLANKS   INVAL2                                              CSW210
      *                                                                                       CSW210
      ** There should be no embedded spaces                                                   CSW210
      *                                                                                       CSW210
     C           ADCHK1    IFEQ *BLANK                                                        CSW210
     C           ADCHK2    ANDNE*BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADCHK1    OREQ *BLANK                                                        CSW210
     C           ADCHK3    ANDNE*BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADCHK1    OREQ *BLANK                                                        CSW210
     C           ADCHK4    ANDNE*BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADCHK2    OREQ *BLANK                                                        CSW210
     C           ADCHK3    ANDNE*BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADCHK2    OREQ *BLANK                                                        CSW210
     C           ADCHK4    ANDNE*BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADCHK3    OREQ *BLANK                                                        CSW210
     C           ADCHK4    ANDNE*BLANK                                                        CSW210
      *                                                                                       CSW210
     C                     MOVE 'Y'       INVAL1  1                                           CSW210
      *                                                                                       CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
      ** Check for non-valid SWIFT characters                                                 CSW210
      *                                                                                       CSW210
     C           ADCHK1    IFNE *BLANKS                                                       CSW210
     C                     MOVEL*BLANKS   I#FLD  35                                           CSW210
     C                     MOVELADCHK1    I#FLD                                               CSW210
     C                     EXSR SRSWST                                                        CSW210
      *                                                                                       CSW210
     C           INSET     IFEQ 'Y'                                                           CSW210
     C                     MOVEL'Y'       AD#1    1                                           CSW210
     C                     MOVE 'Y'       INVAL2  1                                           CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           ADCHK2    IFNE *BLANKS                                                       CSW210
     C                     MOVEL*BLANKS   I#FLD                                               CSW210
     C                     MOVELADCHK2    I#FLD                                               CSW210
     C                     EXSR SRSWST                                                        CSW210
      *                                                                                       CSW210
     C           INSET     IFEQ 'Y'                                                           CSW210
     C                     MOVEL'Y'       AD#2    1                                           CSW210
     C                     MOVE 'Y'       INVAL2  1                                           CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           ADCHK3    IFNE *BLANKS                                                       CSW210
     C                     MOVEL*BLANKS   I#FLD                                               CSW210
     C                     MOVELADCHK3    I#FLD                                               CSW210
     C                     EXSR SRSWST                                                        CSW210
      *                                                                                       CSW210
     C           INSET     IFEQ 'Y'                                                           CSW210
     C                     MOVEL'Y'       AD#3    1                                           CSW210
     C                     MOVE 'Y'       INVAL2  1                                           CSW210
     C                     END                                                                CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           ADCHK4    IFNE *BLANKS                                                       CSW210
     C                     MOVEL*BLANKS   I#FLD                                               CSW210
     C                     MOVELADCHK4    I#FLD                                               CSW210
     C                     EXSR SRSWST                                                        CSW210
      *                                                                                       CSW210
     C           INSET     IFEQ 'Y'                                                           CSW210
     C                     MOVEL'Y'       AD#4    1                                           CSW210
     C                     MOVE 'Y'       INVAL2  1                                           CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           EXADCK    TAG                                                                CSW210
     *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRSWST    - Check for valid Swift character used            *                       CSW210
      **                                                              *                       CSW210
      **  Calls     -                                                 *                       CSW210
      **  Called By - SRACHK                                          *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRSWST    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVEL*BLANKS   INSET   1                                           CSW210
      *                                                                                       CSW210
     C           ISO       CHECKI#FLD     X#      30     90                                   CSW210
      *                                                                                       CSW210
      ** If invalid then get character and format number                                      CSW210
      *                                                                                       CSW210
     C           *IN90     IFEQ *ON                                                           CSW210
     C           1         SUBSTI#FLD:X#  ##004   1                                           CSW210
     C                     MOVEL'Y'       INSET                                               CSW210
     C                     MOVE X#        ##005   2                                           CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           EXSWST    TAG                                                                CSW210
     *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *                                                                                       CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRIBAN    - IBAN Validation                                 *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - None                                            *                       CSW210
      **  Called By -                                                 *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRIBAN    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Temporary work variable for IBAN                                                     CSW210
     C                     MOVEL*BLANKS   WIBRTN 35                                           CSW210
     C                     MOVEL*BLANKS   WTIBAN 34                                           CSW210
     C                     MOVEL*BLANKS   WTIBA1 47                                           CSW210
     C                     MOVEL'N'       WVIBAN  1                                           CSW210
     C                     MOVE 'N'       WIBNWR  1                                           CSW210
      *                                                                                       CSW210
     C           DSISLH    IFEQ '/'                                                           CSW210
     C                     MOVELDSIBN2    WTIBA1                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVELDSIBAN    WTIBA1                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     CALL 'AOIBANR3'                                                    CSW210
     C                     PARM *BLANKS   @RTCD                                               CSW210
     C                     PARM           WTIBA1                                              CSW210
     C                     PARM           WIBLNK 47                                           CSW210
     C                     PARM           WOBLNK 34                                           CSW210
      *                                                                                       CSW210
     C           2         SUBSTWOBLNK:1  WOBCH   2                                           CSW210
     C           2         SUBSTWOBLNK:3  WOBNB   2                                           CSW210
      *                                                                                       CSW210
     C           ALPHA     CHECKWOBCH                    81                                   CSW210
     C           NMBRS     CHECKWOBNB                    82                                   CSW210
      *                                                                                       CSW210
      ** IBAN starts with 'AANN'                                                              CSW210
     C           *IN81     IFEQ *OFF                                                          CSW210
     C           *IN82     ANDEQ*OFF                                                          CSW210
     C                     MOVELWOBLNK    WTIBAN                                              CSW210
      *                                                                                       CSW210
     C                     CALL 'AOIBANR5'             82                                     CSW210
     C                     PARM *BLANKS   @RTCD                                               CSW210
     C                     PARM           WTIBAN                                              CSW210
      *                                                                                       CSW210
     C           @RTCD     IFEQ *BLANKS                                                       CSW210
     C           *IN82     ANDEQ*OFF                                                          CSW210
     C                     MOVE 'Y'       WVIBAN                                              CSW210
     C                     MOVELWTIBAN    WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WVIBAN                                              CSW210
     C                     SELEC                                                              CSW210
     C           @RTCD     WHEQ '      1'                                                     CSW210
     C                     MOVEL'ST00102' ZAMSID                                              CSW210
     C           @RTCD     WHEQ '      2'                                                     CSW210
     C                     MOVEL'ST00103' ZAMSID                                              CSW210
     C           @RTCD     WHEQ '      3'                                                     CSW210
     C                     MOVEL'ST00104' ZAMSID                                              CSW210
     C           @RTCD     WHEQ '      4'                                                     CSW210
     C                     MOVEL'ST00105' ZAMSID                                              CSW210
     C           @RTCD     WHEQ '      5'                                                     CSW210
     C                     MOVEL'ST00106' ZAMSID                                              CSW210
     C                     OTHER                                                              CSW210
     C                     MOVEL'ST00107' ZAMSID                                              CSW210
     C                     ENDSL                                                              CSW210
     C                     MOVE 'Y'       WIBNWR                                              CSW210
     C********** DSISLH    IFEQ '/'                                                  CSW210 AR642262
     C********** '/'       CAT  WTIBAN    WTIBAN                                     CSW210 AR642262
     C**********           ENDIF                                                     CSW210 AR642262
     C                     MOVELDSIBAN    WTIBAN                                            AR642262
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WVIBAN                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      *                                                               *                       CSW210
      * SRVCDE  - Checks the syntax of code word                      *                       CSW210
      *                                                               *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRVCDE    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE *BLANKS   WMEMID  7                                           CSW210
      *                                                                                       CSW210
      ** check for presence and position of terminating '/'; W@ is                            CSW210
      ** position of second '/'                                                               CSW210
     C           '/'       SCAN PASWCD:2  W@      50     82                                   CSW210
      *                                                                                       CSW210
      ** If second '/' not found - error: codeword must end '/'                               CSW210
     C           *IN82     IFEQ '0'                                                           CSW210
     C                     MOVEL'ST00115' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If '/' is in posn. 2 - error: '//' invalid for codeword                              CSW210
     C           W@        IFEQ 2                                                             CSW210
     C                     MOVEL'ST00116' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If '/' is in posn. 11 or greater - error: codeword should be                         CSW210
      ** 8 characters or fewer.                                                               CSW210
     C           W@        IFGT 10                                                            CSW210
      *                                                                                       CSW210
     C           CSW201    IFEQ 'Y'                                                           CSW210
     C                     MOVEL'ST00120' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ELSE                                                               CSW210
     C                     MOVEL'ST00117' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If any characters after second '/' - error: should be blank                          CSW210
     C           35        SUB  W@        W@L     50                                          CSW210
     C           W@        ADD  1         W@P     50                                          CSW210
     C           W@L       SUBSTPASWCD:W@PW@SBBL 32 P                                         CSW210
     C           W@SBBL    IFNE *BLANKS                                                       CSW210
     C                     MOVEL'ST00118' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If codeword contains non-upper case or non-numeric characters                        CSW210
      *                                                                                       CSW210
     C           CSW201    IFEQ 'Y'                                                           CSW210
      *                                                                                       CSW210
     C           ALPHAN    CHECKPASWCD:2  W@L                                                 CSW210
     C           W@L       IFLT W@                                                            CSW210
     C                     MOVEL'ST00121' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If codeword contains non-upper case alpha characters - error:                        CSW210
      ** codeword should be SWIFT 8a.                                                         CSW210
     C           ALPHA     CHECKPASWCD:2  W@L                                                 CSW210
     C           W@L       IFLT W@                                                            CSW210
     C                     MOVEL'ST00119' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           EXVLC     ENDSR                                                              CSW210
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAWIA    - Validate A/c with Institution TAG :57:          *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAWIA    BEGSR
      *
      ** this Field can only be Entered for Clearance Type 1 to 4
     C           WWCLTY    IFEQ '14'
      *
     C           SAWIA     IFNE 'A'
     C           SAWIA     ANDNE'D'
     C           SAWIA     ANDNE*BLANK
     C                     SETON                     2575
     C                     MOVEL'SEW5220' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** The A/c Lines may not be left Blank when Entering the TAG Field
     C           SAWIA     IFNE *BLANK
     C           SAWIL     ANDEQ*BLANK
     C                     SETON                     2775
     C                     MOVEL'SEW5227' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** This Field must be left Blank If Clearance Type not 1 to 4
     C           SAWIA     IFNE *BLANK
     C                     SETON                     2575
     C                     MOVEL'SEW5221' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAWIN    - Validate A/c with Institution :57:              *
      **                                                              *
      **  Calls     - SRCUST, SRSMSG                                  *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAWIN    BEGSR
      *
     C                     MOVEL*BLANKS   WAWIN                           CSW098
     C*                                                                   CSW098
      ** Validate If not Blank
     C           SAWIN     IFNE *BLANKS
      *
      ** TAG Field must be left Blank
     C           SAWIA     IFNE *BLANKS
     C                     SETON                     2675
     C                     MOVEL'SEW5228' ZAMSID
     C                     EXSR SRSMSG
     C                     ELSE
      *
      ** Set Error Indicator ON this Field before Validation
     C                     SETON                     26
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SAWIN     WWCUST
     C                     EXSR SRCUST
     C                     MOVELBBCUST    SAWIN                                             AR589193
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     26
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
      *
      ** A/c must be a Bank
     C           WWBNBI    IFNE 'Y'
     C                     SETON                     2675
     C                     MOVEL'SEW5225' ZAMSID
     C                     EXSR SRSMSG
     C                     ELSE
     C                     MOVELBBCUST    WWAWIN
     C                     END
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWAWIN
     C                     END
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVELWWAWIN    WAWIN                           CSW098
     C                     ENDIF                                          CSW098
      *
      ** Either SBOFN or SBOF1 must not be left Blank
      ** (SWIFT Field 58 must be Entered If 57 is Entered)
     C           SBOFN     IFEQ *BLANKS
     C           SBOF1     ANDEQ*BLANKS
     C                     MOVE *BLANKS   WWAWIN
     C                     SETON                     293075
     C                     MOVEL'SEW5226' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ELSE
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWAWIN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRAWIL    - Validate A/c with Institution A/c Line :57:     *
      **                                                              *
      ****Calls*****-*SRSMSG,*SRLI35                                  *   CSW098
      **  Calls     - SRSMSG, SRLI35, SRME99                          *   CSW098
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRAWIL    BEGSR
      *
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    ORNE 'Y'                                                           CSW210
      ** Validate If not Blank
     C                     MOVELSAWIL     WWAWIL  1
     C           SAWIL     IFNE *BLANKS
     C           WWAWIL    ANDNE'#'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER2     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER2
     C                     END
      *
      ** If not Overridden
     C           OVER2     IFNE 'Y'
      *
     C           SAWIN     IFEQ *BLANKS
     C           SAWIA     ANDEQ*BLANKS
     C                     SETON                     2675
     C                     MOVE '1'       OVER2
     C                     MOVEL'SEW5230' ZAMSID
     C                     EXSR SRSMSG
      *
     C                     ELSE
     C                     MOVELSAWIL     WWLI01
     C                     MOVELSAWIL     WWLI02
     C                     MOVELSAWIL     WWLI04  4
     C                     MOVELSAWIL     WWLI05  5
     C                     MOVELSAWIL     WWLI35
     C                     SETON                     27
     C                     MOVE '1'       OVER2
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     EXSR SRLI35
     C                     ELSE                                           CSW098
      *                                                                   CSW098
      ** Set up parameters for call to ME9940                             CSW098
     C                     MOVE *BLANKS   W0RTN                           CSW098
     C                     CLEARI#PARM                                    CSW098
     C                     MOVEL'AWBK '   I#VFLD                          CSW098
     C                     MOVEL'PAY'     I#PR                            CSW098
      *                                                                   CSW098
     C           WWCUSS    IFEQ 'N'                                       CSW098
     C                     MOVEL'X'       I#PRTT                          CSW098
     C                     ELSE                                           CSW098
     C                     MOVELWWCUSS    I#PRTT                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWAWIN     I#PRTY                          CSW098
     C                     MOVELPTNMC     I#PCCY                          CSW098
     C                     MOVELPTNMC     I#RCCY                          CSW098
     C                     MOVELWWLI35    I#ACLN                          CSW098
     C                     CLEARO#PARM                                    CSW098
     C                     CLEARE#PARM                                    CSW098
     C                     MOVEL'SE1806'  E#CPGM                          CSW098
     C                     MOVEL'MEC0017' E#MSGD                          CSW098
     C                     MOVEL'MEMSG'   E#MSGF                          CSW098
      *                                                                   CSW098
     C                     MOVELWAWBK     WACLN                           CSW098
      *                                                                   CSW098
     C                     EXSR SRME99                                    CSW098
      *                                                                   CSW098
      ** If no issuer code defined for the currency clearing system,      CSW098
      ** set flag to display warning message for later display.           CSW098
      *                                                                   CSW098
     C           WICNIL    IFEQ 'Y'                                       CSW098
     C                     MOVEL'Y'       IAWBK                           CSW098
     C                     MOVEL*BLANKS   WICNIL                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWWLI35    WAWBK                           CSW098
      *                                                                   CSW098
     C                     ENDIF                                          CSW098
      *
     C           WWER35    IFNE 'Y'
     C                     SETOF                     27
     C                     MOVE '0'       OVER2
     C                     MOVELWWLI35    SAWIL
     C                     END
      *
     C                     END
     C                     END
     C                     END
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if value inserted is an IBAN                                                   CSW210
     C           SAWIL     IFNE *BLANKS                                                       CSW210
     C           CSW210    ANDEQ'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVELSAWIL     DSIBAN                                              CSW210
     C           SAWIL     IFNE WWAIL                                                         CSW210
     C                     EXSR SRIBAN                                                        CSW210
     C                     MOVE WVIBAN    WWFAI1                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Replace field value if validated as an IBAN input                                    CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WSAWIL                                              CSW210
     C                     MOVELWIBRTN    SAWIL                                               CSW210
     C                     MOVE *BLANKS   WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If not IBAN, throw corresponding warning messages                                    CSW210
     C           WSAWIL    IFEQ 'Y'                                                           CSW210
     C           SAWIL     ANDEQWWAIL                                                         CSW210
     C                     MOVE 'N'       WSAWIL                                              CSW210
     C                     ELSE                                                               CSW210
     C           WIBNWR    IFEQ 'Y'                                                           CSW210
     C           SAWIL     ANDNEWWAIL                                                         CSW210
     C                     MOVELWTIBAN    SAWIL                                               CSW210
     C                     SETON                     27                                       CSW210
     C                     MOVE 'Y'       WSAWIL                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     MOVELS210W,3   ZAMSDT                                              CSW210
     C                     EXSR SREMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSAWIL     WWAIL                                               CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WWFAI1                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBOFA    - Validate Beneficiary of Money TAG :58:          *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBOFA    BEGSR
      *
      ** this Field can only be Entered for Clearance Type 1 to 4
     C           WWCLTY    IFEQ '14'
      *
     C           SBOFA     IFNE 'D'
     C           SBOFA     ANDNE*BLANK
     C                     SETON                     2875
     C                     MOVEL'SEW5222' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** The A/c Lines may not be left Blank when Entering the TAG Field
     C           SBOFA     IFNE *BLANK
     C           SBOF1     ANDEQ*BLANK
     C                     SETON                     3075
     C                     MOVEL'SEW5227' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** this Field must be left Blank If Clearance Type not 1 to 4
     C           SBOFA     IFNE *BLANK
     C                     SETON                     2875
     C                     MOVEL'SEW5221' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBOFN    - Validate Beneficiary of Money :58:              *
      **                                                              *
      **  Calls     - SRCUST, SRSMSG                                  *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBOFN    BEGSR
      *                                                                   CSW098
     C                     MOVEL*BLANKS   WBOFN                           CSW098
      *
      ** Validate If not Blank
     C           SBOFN     IFNE *BLANKS
      *
      ** TAG Field must be left Blank
     C           SBOFA     IFNE *BLANKS
     C                     SETON                     2975
     C                     MOVEL'SEW5228' ZAMSID
     C                     EXSR SRSMSG
     C                     ELSE
      *
      ** Set Error Indicator ON this Field before Validation
     C                     SETON                     29
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SBOFN     WWCUST
     C                     EXSR SRCUST
     C                     MOVELBBCUST    SBOFN                                             AR589193
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     29
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWBOFN
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWBOFN
     C                     END
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVELWWBOFN    WBOFN                           CSW098
     C                     ENDIF                                          CSW098
      *
      ** Either SAWIN or SAWIL must be Non-Blank
      ** (SWIFT Field 57 must be Entered If 58 is Entered)
     C           SAWIN     IFEQ *BLANKS
     C           SAWIL     ANDEQ*BLANKS
     C           *IN78     ANDEQ*OFF                                                          201429
     C                     MOVE *BLANKS   WWBOFN
     C                     SETON                     262775
     C                     MOVEL'SEW5245' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ELSE
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWBOFN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBOF1    - Validate Beneficiary of Money A/c Line :58:     *
      **                                                              *
      ****Calls*****-*SRSMSG,*SRLI35***********************************   CSW098
      **  Calls     - SRSMSG, SRLI35, SRME99                          *   CSW098
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBOF1    BEGSR
      *
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    ORNE 'Y'                                                           CSW210
      ** Validate If not Blank
     C                     MOVELSBOF1     WWBOF1  1
     C           SBOF1     IFNE *BLANKS
     C           WWBOF1    ANDNE'#'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER3     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER3
     C                     END
      *
      ** If not Overridden
     C           OVER3     IFNE 'Y'
      *
     C           SBOFN     IFEQ *BLANKS
     C           SBOFA     ANDEQ*BLANKS
     C                     SETON                     2975
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5230' ZAMSID
     C                     EXSR SRSMSG
      *
     C                     ELSE
     C                     MOVELSBOF1     WWLI01
     C                     MOVELSBOF1     WWLI02
     C                     MOVELSBOF1     WWLI04
     C                     MOVELSBOF1     WWLI05
     C                     MOVELSBOF1     WWLI35
      *
     C           WWLI02    IFEQ '//'
     C           WWCUSS    ANDEQ'C'
     C           WWBNBI    ANDEQ'N'
     C           WWLI02    OREQ '//'
     C           WWCUSS    ANDEQ'S'
     C           WWBNBI    ANDEQ'N'
     C                     SETON                     3075
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5250' ZAMSID
     C                     EXSR SRSMSG
      *
     C                     ELSE
     C                     SETON                     30
     C                     MOVE '1'       OVER3
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     EXSR SRLI35
     C                     ELSE                                           CSW098
      *                                                                   CSW098
      ** Set up parameters for call to ME9940                             CSW098
     C                     MOVE *BLANKS   W0RTN                           CSW098
     C                     CLEARI#PARM                                    CSW098
     C                     MOVEL'BENF '   I#VFLD                          CSW098
     C                     MOVEL'PAY'     I#PR                            CSW098
      *                                                                   CSW098
     C           WWCUSS    IFEQ 'N'                                       CSW098
     C                     MOVEL'X'       I#PRTT                          CSW098
     C                     ELSE                                           CSW098
     C                     MOVELWWCUSS    I#PRTT                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWBOFN     I#PRTY                          CSW098
     C                     MOVELPTNMC     I#PCCY                          CSW098
     C                     MOVELPTNMC     I#RCCY                          CSW098
     C                     MOVELWWLI35    I#ACLN                          CSW098
     C                     CLEARO#PARM                                    CSW098
     C                     CLEARE#PARM                                    CSW098
     C                     MOVEL'SE1806'  E#CPGM                          CSW098
     C                     MOVEL'MEC0018' E#MSGD                          CSW098
     C                     MOVEL'MEMSG'   E#MSGF                          CSW098
      *                                                                   CSW098
     C                     MOVELWBENF     WACLN                           CSW098
      *                                                                   CSW098
     C                     EXSR SRME99                                    CSW098
      *                                                                   CSW098
      ** If no issuer code defined for the currency clearing system,      CSW098
      ** set flag to display warning message for later display.           CSW098
      *                                                                   CSW098
     C           WICNIL    IFEQ 'Y'                                       CSW098
     C                     MOVEL'Y'       IBENF   1                       CSW098
     C                     MOVEL*BLANKS   WICNIL                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWWLI35    WBENF                           CSW098
      *                                                                   CSW098
     C                     ENDIF                                          CSW098
      *
     C           WWER35    IFNE 'Y'
     C                     SETOF                     30
     C                     MOVE '0'       OVER3
     C                     MOVELWWLI35    SBOF1
     C                     END
      *
     C                     END
     C                     END
     C                     END
     C                     END
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if value inserted is an IBAN                                                   CSW210
     C           SBOF1     IFNE *BLANKS                                                       CSW210
     C           CSW210    ANDEQ'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVELSBOF1     DSIBAN                                              CSW210
     C           SBOF1     IFNE WWSBOF                                                        CSW210
     C                     EXSR SRIBAN                                                        CSW210
     C                     MOVE WVIBAN    WWFBF1                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Replace field value if validated as an IBAN input                                    CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WSBOF1                                              CSW210
     C                     MOVELWIBRTN    SBOF1                                               CSW210
     C                     MOVE *BLANKS   WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If not IBAN, throw corresponding warning messages                                    CSW210
     C           WSBOF1    IFEQ 'Y'                                                           CSW210
     C           SBOF1     ANDEQWWSBOF                                                        CSW210
     C                     MOVE 'N'       WSBOF1                                              CSW210
     C                     ELSE                                                               CSW210
     C           WIBNWR    IFEQ 'Y'                                                           CSW210
     C           SBOF1     ANDNEWWSBOF                                                        CSW210
     C                     MOVELWTIBAN    SBOF1                                               CSW210
     C                     SETON                     30                                       CSW210
     C                     MOVE 'Y'       WSBOF1                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     MOVELS210W,4   ZAMSDT                                              CSW210
     C                     EXSR SREMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSBOF1     WWSBOF                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       WWFBF1                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBOF2    - Validate Beneficiary of Money A/c Line :58:     *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBOF2    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSBOF2     WWBOF2  1
     C           SBOF2     IFNE *BLANKS
     C           WWBOF2    ANDNE'#'
     C           OVER3     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER3     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER3
     C                     END
      *
      ** If not Overridden
     C           OVER3     IFNE 'Y'
      *
     C           SBOF1     IFEQ *BLANKS
     C                     SETON                     3075
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWBOF1    IFNE '/'
     C           WWBOF2    ANDEQ'/'
     C                     SETON                     3175
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5256' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSBOF2     WWLI02
     C           WWBOF2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     3175
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5257' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SBOF2     IFEQ SBOF1
     C                     SETON                     3175
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRACL1    - Validate A/c Charges Line 1 :71:                *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRACL1    BEGSR
      *
      ** Validate If not Blank
     C                     MOVE *BLANKS   WWACL1  1
     C                     MOVE *BLANKS   WWVALI  1
     C           SACL1     IFNE *BLANKS
     C                     MOVELSACL1     WWACL1
      *
     C           WWACL1    IFEQ '/'
     C                     MOVELSACL1     WWLI08  8
     C           WWLI08    IFNE '/ACCCAP/'
     C           WWLI08    ANDNE'/ACCCHG/'
     C           WWLI08    ANDNE'/ACCFEE/'
     C           WWLI08    ANDNE'/ACCREV/'
     C                     MOVE 'N'       WWVALI
     C                     END
      *
     C           WWVALI    IFEQ 'N'
     C                     SETON                     3275
     C                     MOVEL'SEW5260' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRACL2    - Validate A/c Charges Line 2 :71:                *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRACL2    BEGSR
      *
      ** Validate If not Blank
     C           SACL2     IFNE *BLANKS
      *
     C           SACL1     IFEQ *BLANKS
     C                     SETON                     3275
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSACL2     WWACL2  1
     C           WWACL1    IFNE '/'
     C           WWACL2    ANDEQ'/'
     C                     SETON                     3375
     C                     MOVEL'SEW5256' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSACL2     WWLI02
     C           WWACL1    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     3375
     C                     MOVEL'SEW5214' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWACL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     3375
     C                     MOVEL'SEW5257' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SACL2     WWLI33 33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     SETON                     3375
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SACL2     IFEQ SACL1
     C                     SETON                     3375
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** May not be Blank as a Continuation Line
     C                     MOVELSACL2     WWLI02
     C           WWACL1    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     3375
     C                     MOVEL'SEW5214' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSRL1    - Validate Sender to Receiver Info Line 1 :72:    *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSRL1    BEGSR
      *
     C/COPY WNCPYSRC,SE1806C017
      ** Validate If not Blank
     C                     MOVE *BLANK    WKSRL1  1                       056348
     C                     MOVE *BLANKS   WWSRL1  1
     C                     MOVE *BLANKS   WWVALI
     C           SSRL1     IFNE *BLANKS
      *
     C                     MOVELSSRL1     WWSRL1
     C           WWSRL1    IFEQ '/'
      *
     C***********PTDTP     IFEQ 'TS'                                      CSW003
     C***********PCLTY     ANDEQ'5'                                       CSW003
     C           WTDTP     IFEQ 'TS'                                      CSW003
     C           WWCLTY    ANDNE'14'                                      CSW003
     C                     MOVELSSRL1     WWSR10 10
     C                     MOVELWWSR10    WWSR06  6
     C                     MOVE WWSR10    WWSR04  4
     C           WWSR06    IFEQ '/PRIOR'
     C           WWSR04    ANDEQ'REQ/'
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1                          056348
     C                     END
     C                     END
     C           WTDTP     IFEQ 'TP'                                      056348
     C           WWCLTY    ANDNE'14'                                      056348
     C                     MOVELSSRL1     WWSR10                          056348
     C                     MOVELWWSR10    WWSR06                          056348
     C                     MOVE WWSR10    WWSR04                          056348
     C           WWSR06    IFEQ '/TRADE'                                  056348
     C           WWSR04    ANDEQ'CP/ '                                    056348
     C                     MOVE 'Y'       WWVALI                          056348
     C                     MOVE 'Y'       WKSRL1                          056348
     C                     END                                            056348
     C                     END                                            056348
     C           WTDTP     IFEQ 'TP'                                      056348
     C           WWCLTY    ANDEQ'5'                                       056348
     C                     MOVELSSRL1     WWSR10                          056348
     C                     MOVELWWSR10    WWSR06                          056348
     C                     MOVE WWSR10    WWSR04                          056348
     C                     MOVELWWSR04    WWSR03  3                       056348
     C           WWSR06    IFEQ '/TRADE'                                  056348
     C           WWSR03    ANDEQ'CP/'                                     056348
     C                     MOVE 'Y'       WWVALI                          056348
     C                     MOVE 'Y'       WKSRL1                          056348
     C                     END                                            056348
     C                     END                                            056348
      *
     C                     MOVELSSRL1     WWSR06
     C                     MOVELSSRL1     WWSR07  7
     C                     MOVELSSRL1     WWSR08  8
     C           WWSR06    IFEQ '/AGEN/'
     C           WWSR06    OREQ '/PRIN/'
     C           WWSR06    OREQ '/PHON/'
     C                     MOVE 'Y'       WWVALI
     C                     END
     C           WWSR07    IFEQ '/TELEX/'
     C                     MOVE 'Y'       WWVALI
     C                     END
     C           WWSR08    IFEQ '/BROKER/'
     C                     MOVE 'Y'       WWVALI
     C                     END
      *
     C***********          MOVE *BLANK    WKSRL1  1                       056348
     C           WWCLTY    IFEQ '14'
     C                     MOVELSSRL1     WWSR10
     C                     MOVELWWSR10    WWSR06
     C                     MOVE WWSR10    WWSR04
     C                     MOVE SSRL1     WWSR25 25
     C           WWSR06    IFEQ '/ADDPR'
     C           WWSR04    ANDEQ'TY/ '
     C           WWSR25    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1
     C                     END
     C           WWSR06    IFEQ '/CANCE'
     C           WWSR04    ANDEQ'L/  '
     C           WWSR25    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1
     C                     END
     C           WWSR06    IFEQ '/CONFI'
     C           WWSR04    ANDEQ'RM/ '
     C           WWSR25    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1
     C                     END
     C                     END
      *                                                                   CSW014
     C           CSW014    IFEQ 'Y'                                       CSW014
     C                     MOVELSSRL1     WWSR06  6                       CSW014
     C           WWSR06    IFEQ '/OCMT/'                                  CSW014
     C                     MOVE 'Y'       WWVALI                          CSW014
     C                     ENDIF                                          CSW014
     C                     ENDIF                                          CSW014
      *
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVELSSRL1     WWSR10                                              CSW201
     C                     EXSR SR2001                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C/COPY WNCPYSRC,SE1806C022
     C           WWVALI    IFNE 'Y'
     C                     SETON                     3475
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVEL'SEW5265' ZAMSID
     C                     ENDIF                                                              CSW201
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE1806C018
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSRL2    - Validate Sender to Receiver Info Line 2 :72:    *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSRL2    BEGSR
      *
      ** Validate If not Blank
     C                     MOVE *BLANKS   WWSRL2  1
     C                     MOVE *BLANKS   WWVALI
     C           SSRL2     IFNE *BLANKS
      *
     C           SSRL1     IFEQ *BLANKS
     C                     SETON                     3475
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL2     WWSRL2
     C           WWSRL1    IFNE '/'
     C           WWSRL2    ANDEQ'/'
     C/COPY WNCPYSRC,SE1806C023
     C                     SETON                     3575
     C                     MOVEL'SEW5256' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL2     WWLI02
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           WWLI02    ANDNE'//'                                                          CSW201
     C                     MOVELSSRL2     WWSR10                                              CSW201
     C                     EXSR SR2001                                                        CSW201
      *                                                                                       CSW201
     C           WWVALI    IFNE 'Y'                                                           CSW201
     C                     MOVE *ON       *IN35                                               CSW201
     C                     MOVE *ON       *IN75                                               CSW201
     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
     C                     EXSR SRSMSG                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'N'                                                           CSW201
      *                                                                                       CSW201
     C           WKSRL1    IFEQ *BLANK
     C           WWSRL1    ANDEQ'/'
     C           WWLI02    ANDNE'//'
     C/COPY WNCPYSRC,SE1806C024
     C                     SETON                     3575
     C                     MOVEL'SEW5214' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWSRL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C/COPY WNCPYSRC,SE1806C025
     C                     SETON                     3575
     C                     MOVEL'SEW5257' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     ENDIF                                                              CSW201
      *
     C                     MOVE SSRL2     WWLI33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     SETON                     3575
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SSRL2     IFEQ SSRL1
     C                     SETON                     3575
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           CSW201    IFEQ 'N'                                                           CSW201
     C           WKSRL1    IFNE *BLANK
     C           SSRL2     ANDNE*BLANKS
     C                     SETON                     3575
     C                     MOVEL'SEW5259' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ELSE
      ** may not be Blank as a Continuation Line
     C                     MOVELSSRL2     WWLI02
      *--   AT THIS LEVEL LINE 2 IS EMPTY   --*                           061028
     C***********WKSRL1    IFEQ *BLANK                                    061028
     C***********WWSRL1    ANDEQ'/'                                       061028
     C***********WWLI02    ANDNE'//'                                      061028
     C***********          SETON                     3575                 061028
     C***********          MOVEL'SEW5214' ZAMSID                          061028
     C***********          EXSR SRSMSG                                    061028
     C***********          END                                            061028
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSRL3    - Validate Sender to Receiver Info Line 3 :72:    *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSRL3    BEGSR
      *
      ** Validate If not Blank
     C                     MOVE *BLANKS   WWVALI                                              CSW201
     C           SSRL3     IFNE *BLANKS
      *
     C           SSRL2     IFEQ *BLANKS
     C                     SETON                     3575
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL3     WWSRL3  1
     C           WWSRL2    IFNE '/'
     C           WWSRL3    ANDEQ'/'
     C/COPY WNCPYSRC,SE1806C026
     C                     SETON                     3675
     C                     MOVEL'SEW5256' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL3     WWLI02
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           WWLI02    ANDNE'//'                                                          CSW201
     C                     MOVELSSRL3     WWSR10                                              CSW201
     C                     EXSR SR2001                                                        CSW201
      *                                                                                       CSW201
     C           WWVALI    IFNE 'Y'                                                           CSW201
     C                     MOVE *ON       *IN36                                               CSW201
     C                     MOVE *ON       *IN75                                               CSW201
     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
     C                     EXSR SRSMSG                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'N'                                                           CSW201
      *                                                                                       CSW201
     C           WWSRL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C/COPY WNCPYSRC,SE1806C027
     C                     SETON                     3675
     C                     MOVEL'SEW5214' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWSRL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C/COPY WNCPYSRC,SE1806C028
     C                     SETON                     3675
     C                     MOVEL'SEW5257' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     ENDIF                                                              CSW201
      *
     C                     MOVE SSRL3     WWLI33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     SETON                     3675
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SSRL3     IFEQ SSRL2
     C                     SETON                     3675
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** may not be Blank as a Continuation Line
     C                     MOVELSSRL3     WWLI02
      *--   AT THIS LEVEL LINE 3 IS EMPTY   --*                           061028
     C***********WWSRL2    IFEQ '/'                                       061028
     C***********WWLI02    ANDNE'//'                                      061028
     C***********          SETON                     3675                 061028
     C***********          MOVEL'SEW5214' ZAMSID                          061028
     C***********          EXSR SRSMSG                                    061028
     C***********          END                                            061028
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRFIN1    - Validate Further Information Line 1 :77:        *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRFIN1    BEGSR
      *
      ** Validate If not Blank
     C           SFIN1     IFNE *BLANKS
      *
     C                     MOVELSFIN1     WWLI01
     C           WWLI01    IFEQ '/'
     C                     SETON                     3775
     C                     MOVEL'SEW5285' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRFIN2    - Validate Further Information Line 2 :77:        *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRFIN2    BEGSR
      *
      ** Validate If not Blank
     C           SFIN2     IFNE *BLANKS
      *
     C           SFIN1     IFEQ *BLANKS
     C                     SETON                     3775
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SFIN2     IFEQ SFIN1
     C                     SETON                     3875
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSFIN2     WWLI01
     C           WWLI01    IFEQ '/'
     C                     SETON                     3875
     C                     MOVEL'SEW5285' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
     C/COPY WNCPYSRC,SE1806C052
      *
      *****************************************************************
      ***/EJECT********************************************************                       CSW210
      *****************************************************************
      *****************************************************************                       CSW210
      ****SRRED1****-*Validate*Registration*Details*Line*1*:77:********                       CSW210
      *****************************************************************                       CSW210
      ****Calls*****-*SRSMSG*******************************************                       CSW210
      ****Called*By*-*SRVAL********************************************                       CSW210
      *****************************************************************                       CSW210
      *****************************************************************
      *****************************************************************                       CSW210
     C********** SRRED1    BEGSR                                                              CSW210
      *****************************************************************                       CSW210
     C***/COPY*WNCPYSRC,SE1806C005                                                            CSW210
      ***Validate*Field*If*not*Blank***********************************                       CSW210
     C********** SRED1     IFNE *BLANKS                                                       CSW210
     C***/COPY*WNCPYSRC,SE1806C006                                                            CSW210
      *****************************************************************                       CSW210
     C**********           MOVELSRED1     WWLI01                                              CSW210
     C********** WWLI01    IFEQ '/'                                                           CSW210
     C***/COPY*WNCPYSRC,SE1806C003                                                            CSW210
     C**********           SETON                     3975                                     CSW210
     C**********           MOVEL'SEW5285' ZAMSID                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      *****************************************************************                       CSW210
     C**********           END                                                                CSW210
      *****************************************************************                       CSW210
     C**********           ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      *****************************************************************
      ***/EJECT********************************************************                       CSW210
      *****************************************************************
      *****************************************************************                       CSW210
      ****SRRED2****-*Validate*Registration*Details*Line*1*:77:********                       CSW210
      *****************************************************************                       CSW210
      ****Calls*****-*SRSMSG*******************************************                       CSW210
      ****Called*By*-*SRVAL********************************************                       CSW210
      *****************************************************************                       CSW210
      *****************************************************************
      *****************************************************************                       CSW210
     C********** SRRED2    BEGSR                                                              CSW210
      *****************************************************************                       CSW210
      ***Validate*If*not*Blank*****************************************                       CSW210
     C********** SRED2     IFNE *BLANKS                                                       CSW210
     C***/COPY*WNCPYSRC,SE1806C007                                                            CSW210
      *****************************************************************                       CSW210
     C********** SRED1     IFEQ *BLANKS                                                       CSW210
     C**********           SETON                     4075                                     CSW210
     C**********           MOVEL'SEW5255' ZAMSID                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      *****************************************************************                       CSW210
     C********** SRED2     IFEQ SRED1                                                         CSW210
     C**********           SETON                     4075                                     CSW210
     C**********           MOVEL'SEW5258' ZAMSID                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      *****************************************************************                       CSW210
     C**********           MOVELSRED2     WWLI01                                              CSW210
     C********** WWLI01    IFEQ '/'                                                           CSW210
     C***/COPY*WNCPYSRC,SE1806C004                                                            CSW210
     C**********           SETON                     4075                                     CSW210
     C**********           MOVEL'SEW5285' ZAMSID                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      *****************************************************************                       CSW210
     C***/COPY*WNCPYSRC,SE1806C008                                                            CSW210
     C**********           END                                                                CSW210
      *****************************************************************                       CSW210
     C**********           ENDSR                                                              CSW210
      *****************************************************************                       CSW210
     C/COPY WNCPYSRC,SE1806C053
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRNAL1    - Validate Narrative 1 :79:                       *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRNAL1    BEGSR
      *
      ** Validate Field If not Blank
     C                     MOVE *BLANKS   WWNAL1  1
     C           SNAL1     IFNE *BLANKS
      *
     C                     MOVELSNAL1     WWNAL1
     C                     MOVE SNAL1     WWLI34
     C           WWNAL1    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     4175
     C                     MOVEL'SEW5263' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRNAL2    - Validate Narrative 2 :79:                       *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRNAL2    BEGSR
      *
      ** Validate If not Blank
     C           SNAL2     IFNE *BLANKS
      *
     C           SNAL1     IFEQ *BLANKS
     C                     SETON                     4175
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSNAL2     WWNAL2  1
     C           WWNAL1    IFNE '/'
     C           WWNAL2    ANDEQ'/'
     C                     SETON                     4275
     C                     MOVEL'SEW5256' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSNAL2     WWLI02
     C           WWNAL1    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     4275
     C                     MOVEL'SEW5214' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWNAL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     4275
     C                     MOVEL'SEW5257' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SNAL2     WWLI33 33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     SETON                     4275
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SNAL2     IFEQ SNAL1
     C                     SETON                     4275
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** May not be Blank as a Continuation Line
     C                     MOVELSNAL2     WWLI02
     C           WWNAL1    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     SETON                     4275
     C                     MOVEL'SEW5214' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRIPYN    - Validate Instructing Party :82:                 *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRIPYN    BEGSR
      *
      ** Validate If not Blank
     C           SIPYN     IFNE *BLANKS
      *
      ** This Field may not be used when Clearance Type is 1 to 4
      ** and MT510 is not required
     C           WWCLTY    IFEQ '14'
     C********** PGMEC     ANDNE'Y'                                                           212937
     C           PSNEW     ANDNE'Y'                                                           212937
     C********** WWCLTY    OREQ '14'                                                          204917
     C********** PCCID     ANDNE'C'                                                           204917
     C                     SETON                     4375
     C                     MOVEL'SEW5267' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Set Error Indicator ON this Field before Validation.
     C           *IN43     IFEQ *OFF
     C                     SETON                     43
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SIPYN     WWCUST
     C                     EXSR SRCUST
     C                     MOVELBBCUST    SIPYN                                             AR589193
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     43
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWIPYN
     C                     END
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWIPYN
     C                     END
      *
     C                     ELSE
      *
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWIPYN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRIPYL    - Validate Instructing Party A/c Line :82:        *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRIPYL    BEGSR
      *
      ** Validate If not Blank
     C                     MOVELSIPYL     WWIPYL  1
     C           SIPYL     IFNE *BLANKS
     C           WWIPYL    ANDNE'#'
      *
     C           WWCLTY    IFEQ '14'
     C           PGMEC     ANDNE'Y'
     C           WWCLTY    OREQ '14'
     C           PCCID     ANDNE'C'
     C                     SETON                     4475
     C           SIPYN     IFEQ *BLANKS
     C                     MOVEL'SEW5267' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C           WWIPYL    IFNE '/'
     C                     SETON                     4475
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSIPYL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     SETON                     4475
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SIPYL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     4475
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRCTYN    - Validate Counterparty :82:                      *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRCTYN    BEGSR
      *
      ** Validate If not Blank
     C           SCTYN     IFNE *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
      *
      ** this Field may only be used to generate a MT512
     C           PGMEC     IFNE 'Y'
     C           PCCID     ORNE 'P'
     C                     SETON                     4575
     C                     MOVEL'SEW5207' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Set Error Indicator ON this Field before Validation.
     C           *IN45     IFEQ *OFF
     C                     SETON                     45
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SCTYN     WWCUST
     C                     EXSR SRCUST
     C                     MOVELBBCUST    SCTYN                                             AR589193
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     45
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWCTYN
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWCTYN
     C                     END
     C                     END
      *
     C                     ELSE
      *
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWCTYN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRCTYL    - Validate Counterparty A/c Line :82:             *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRCTYL    BEGSR
      *
      ** Validate If not Blank
     C                     MOVELSCTYL     WWCTYL  1
     C           SCTYL     IFNE *BLANKS
     C           WWCTYL    ANDNE'#'
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
      *
     C           PGMEC     IFNE 'Y'
     C           PCCID     ORNE 'P'
     C                     SETON                     4675
     C           SCTYN     IFEQ *BLANKS
     C                     MOVEL'SEW5207' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C           WWCTYL    IFNE '/'
     C                     SETON                     4675
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSCTYL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     SETON                     4675
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SCTYL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     4675
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVE *BLANKS   SCTYL                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSA1N    - Validate Safekeeping Account :83: (MT510)       *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSA1N    BEGSR
      **********                                                                       201429 209890
      ***Counterparty*is*mandatory*if*first*intermediary*is*entered***                 201429 209890
      **********                                                                       201429 209890
     C********** SSA1N     IFEQ *BLANKS                                                201429 209890
     C********** *IN78     ANDEQ*ON                                                    201429 209890
     C********** PIMMD1    ANDNE*BLANKS                                                201429 204592
     C********** PTDTP     IFEQ 'TP'                                                   204592 209890
     C********** PDELF     ANDNE0                                                      204592 209890
     C**********           MOVELPDELF     SSA1N                                        204592 209890
     C**********           ELSE                                                        204592 209890
     C********** PTDTP     IFEQ 'TS'                                                   204592 209890
     C********** PDELT     ANDNE0                                                      204592 209890
     C**********           MOVELPDELT     SSA1N                                        204592 209890
     C**********           ELSE                                                        204592 209890
     C**********           MOVE '1'       *IN75                                        201429 209890
     C**********           MOVE '1'       *IN47                                        201429 209890
     C**********           MOVEL'SEW9008' ZAMSID                                       201429 209890
     C**********           MOVEL'SEUSRMSG'ZAMSGF                                       201429 209890
     C**********           EXSR SRSMSG                                                 201429 209890
     C**********           ENDIF                                                       204592 209890
     C**********           ENDIF                                                       204592 209890
     C**********           ENDIF                                                       201429 209890
      *
      ** Validate If not Blank
     C           SSA1N     IFNE *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
      *                                                                                       201429
     C           SSA1N     ORNE *BLANKS                                                       201429
     C           *IN78     ANDEQ*ON                                                           201429
      *
      ** This Field may only be used to generate a MT510
     C           PGMEC     IFNE 'Y'
     C           SWRTN     ANDNE'CSW098'                                                      201429
     C           PCCID     ORNE 'C'
     C           SWRTN     ANDNE'CSW098'                                                      201429
     C                     SETON                     4775
     C                     MOVEL'SEW5206' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Set Error Indicator ON this Field before Validation.
     C           *IN47     IFEQ *OFF
     C                     SETON                     47
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SSA1N     WWCUST
     C                     EXSR SRCUST
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     47
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWSA1N
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWSA1N
     C                     END
     C                     END
      *
     C                     ELSE
      *
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWSA1N
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSA1L    - Validate Safekeeping Account A/c Line :83:      *
      **              (MT510)                                         *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSA1L    BEGSR
      *
      ** SSA1L If not Blank
     C           SSA1L     IFNE *BLANKS
      *
     C           PGMEC     IFNE 'Y'
     C           *IN78     ANDEQ*OFF                                                          201429
     C           PCCID     ORNE 'C'
     C           *IN78     ANDEQ*OFF                                                          201429
     C                     SETON                     4875
     C           SSA1N     IFEQ *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
     C                     MOVEL'SEW5206' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVEL'SEW5177' ZAMSID                          CSW098
     C                     EXSR SRSMSG                                    CSW098
     C                     ENDIF                                          CSW098
     C                     END
      *
     C                     MOVELSSA1L     WWSA1L  1
     C           WWSA1L    IFNE '/'
     C                     SETON                     4675
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSA1L     WWLI02
     C           WWLI02    IFEQ '//'
     C                     SETON                     4875
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** For a Confirmation of Purchase, Either Field 83 or 87 may
      ** be present.
     C***********PTDTP     IFEQ 'TP'                                      CSW003
     C           WTDTP     IFEQ 'TP'                                      CSW003
     C           SSA1N     ANDNE*BLANKS
     C           SWRTN     ANDNE'CSW098  '                                CSW098
     C***********PTDTP     OREQ 'TP'                                      CSW003
     C           WTDTP     OREQ 'TP'                                      CSW003
     C           SSA1L     ANDNE*BLANKS
      *
     C           SRSSN     IFNE *BLANKS
     C           SRSS1     ORNE *BLANKS
     C           SDSSN     ORNE *BLANKS
     C           SDSS1     ORNE *BLANKS
     C                     SETON                     474875
     C                     MOVEL'SEW5270' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSKAN    - Validate Safekeeping Account :83:               *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSKAN    BEGSR
      *                                                                                       204592
     C           PTDTP     IFEQ 'TP'                                                          204592
     C********** PDELT     ANDNE0                                                      204592 CSD027
     C           PDELT     ANDNE*BLANKS                                                       CSD027
     C                     MOVELPDELT     SSKAN                                               204592
     C                     ELSE                                                               204592
     C           PTDTP     IFEQ 'TS'                                                          204592
     C********** PDELF     ANDNE0                                                      204592 CSD027
     C           PDELF     ANDNE*BLANKS                                                       CSD027
     C                     MOVELPDELF     SSKAN                                               204592
     C                     ENDIF                                                              204592
     C                     ENDIF                                                              204592
      *
      ** Validate If not Blank
     C           SSKAN     IFNE *BLANKS
      *
      ** Safekeeping Account must be left Blank for Clearance 1 to 4
      ** (Safekeeping Account must be Entered on first Screen)
     C           WWCLTY    IFEQ '14'
     C                     SETON                     4975
     C                     MOVEL'SEW5272' ZAMSID
     C                     EXSR SRSMSG
      *
     C                     ELSE
      ** Set Error Indicator ON this Field before Validation
     C                     SETON                     49
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SSKAN     WWCUST
     C                     EXSR SRCUST
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     49
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWSKAN
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWSKAN
     C                     END
      *
     C                     END
      *
     C                     ELSE
      *
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWSKAN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSKAL    - Validate Safekeeping Account A/c Line :83:      *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRSKAL    BEGSR
     C/COPY WNCPYSRC,SE1806C009
      *
      ** Validate If not Blank
     C                     MOVELSSKAL     WWSKAL  1
     C           SSKAL     IFNE *BLANKS
     C           WWSKAL    ANDNE'#'
      *
      ** Safekeeping Account must be left Blank for Clearance 1 to 4
      ** (Safekeeping Account must be Entered on First Screen)
     C           WWCLTY    IFEQ '14'
     C                     SETON                     5075
     C                     MOVEL'SEW5272' ZAMSID
     C/COPY WNCPYSRC,SE1806C010
     C                     EXSR SRSMSG
     C/COPY WNCPYSRC,SE1806C011
      *
     C                     ELSE
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER6     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER6
     C                     END
      *
      ** If not Overridden
     C           OVER6     IFNE 'Y'
      *
     C           WWSKAL    IFNE '/'
     C                     SETON                     5075
     C                     MOVE '1'       OVER6
     C                     MOVEL'SEW5210' ZAMSID
     C/COPY WNCPYSRC,SE1806C012
     C                     EXSR SRSMSG
     C/COPY WNCPYSRC,SE1806C013
     C                     END
      *
     C                     MOVELSSKAL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     SETON                     5075
     C                     MOVE '1'       OVER6
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SSKAL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     5075
     C                     MOVE '1'       OVER6
     C                     MOVEL'SEW5212' ZAMSID
     C/COPY WNCPYSRC,SE1806C014
     C                     EXSR SRSMSG
     C/COPY WNCPYSRC,SE1806C015
     C                     END
      *
     C                     END
     C                     END
     C                     END
      *
     C/COPY WNCPYSRC,SE1806C016
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRCCTN    - Validate Clearing Correspondent :84:            *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRCCTN    BEGSR
      *
      ** Validate If not Blank
     C           SCCTN     IFNE *BLANKS
      *
      ** Clearance Type must be 1, 2, 3 or 4
     C           WWCLTY    IFNE '14'
     C           PSNEW     ANDNE'Y'                                                           212937
     C                     SETON                     5175
     C                     MOVEL'SEW5275' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      ***********                                                                             204804
      ***Check*Entry*is*Alphanumeric*with*no*embedded*Blanks***********                       204804
     C***********          MOVEASCCTN     CCO                                                 204804
     C***********          SETOF                     82                                       204804
     C***********          Z-ADD0         I       20                                          204804
     C***********I         DOWLE7                                                             204804
     C************IN51     ANDEQ*OFF                                                          204804
     C***********          ADD  1         I                                                   204804
     C***********CCO,I     IFEQ ' '                                                           204804
     C***********          SETON                     51                                       204804
     C***********          ELSE                                                               204804
     C***********CCO,I     LOKUPVA0                      82                                   204804
     C************IN82     IFEQ *OFF                                                          204804
     C***********          SETON                     51                                       204804
     C***********          END                                                                204804
     C***********          END                                                                204804
     C***********          END                                                                204804
      *
     C                     MOVELSCCTN     WKVAR  10                                           204804
     C                     CALL 'AOCUSTR0'                                                    204804
     C                     PARM *BLANKS   WKRTCD  7                                           204804
     C                     PARM '*KEY   ' WKOPTN  7                                           204804
     C                     PARM           WKVAR                                               204804
     C                     PARM           WKYSTS  7                                           204804
     C           SDCUST    PARM SDCUST    DSSDY                                               204804
      *                                                                                       204804
     C           WKRTCD    IFEQ *BLANK                                                        204804
     C           WKYSTS    ANDNE'*ERROR'                                                      204804
     C                     MOVELBBCSID    SCCTN                                               204804
      *                                                                                       204804
     C                     ELSE                                                               204804
      *                                                                                       204804
     C           *LOVAL    SETLLSDCUSTSW                                                      204804
     C           SCCTN     CHAINSDCUSTSW             99                                       204804
     C           *IN99     IFEQ *ON                                                           204804
      *                                                                                       204804
      ** Check if SWIFT Address exist in BIC file                                             204804
      *                                                                                       204804
     C                     CALL 'AOBICDV0'                                                    204804
     C                     PARM *BLANKS   @CRTCD  7                                           204804
     C                     PARM           SCCTN                                               204804
     C                     PARM           @CTYPE  7                                           204804
     C                     PARM           DSSDY                                               204804
     C           @CRTCD    IFNE '*BICFND'                                                     204804
     C           @CTYPE    ANDNE'*BIC'                                                        204804
     C                     MOVE '1'       *IN51                                               204804
     C                     ENDIF                                                              204804
     C                     ENDIF                                                              204804
     C                     ENDIF                                                              204804
      *                                                                                       204804
     C           *IN51     IFEQ *ON
     C                     SETON                     75
     C                     MOVEL'SEW5276' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDCTL    - Validate Deliver's Instructing Party :85:       *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDCTL    BEGSR
      *
      ** Validate If not Blank
     C           SDCTL     IFNE *BLANKS
      *
      ***Clearance*Type*must*be*1,*2,*3*or*4************                  CSW003
     C***********WWCLTY    IFNE '14'                                      CSW003
     C***********          SETON                     5275                 CSW003
     C***********          MOVEL'SEW5280' ZAMSID                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      *
      ** SDCTL must start with a Slash "/" followed by 5 Digits
     C                     MOVELSDCTL     WWLI01
     C                     MOVE SDCTL     WWLI05
     C                     MOVELWWLI05    WWNUM6  60
     C                     MOVELWWNUM6    WWALF5  5
     C           WWLI05    IFNE WWALF5
     C           WWLI01    ORNE '/'
     C                     SETON                     5275
     C                     MOVEL'SEW5281' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1806C054
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRSSA    - Validate Receiver of Securities TAG :87:        *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRRSSA    BEGSR
      *
      ** this Field can only be Entered for Clearance Type 1 to 4
     C           WWCLTY    IFEQ '14'
      *
     C           SRSSA     IFNE 'C'
     C           SRSSA     ANDNE'D'
     C           SRSSA     ANDNE*BLANK
     C                     SETON                     5375
     C                     MOVEL'SEW5223' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** The A/c Lines may not be left Blank when Entering the TAG Field
     C           SRSSA     IFNE *BLANK
     C           SRSS1     ANDEQ*BLANK
     C                     SETON                     5575
     C                     MOVEL'SEW5227' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** This Field must be left Blank If Clearance Type not 1 to 4
     C           SRSSA     IFNE *BLANK
     C                     SETON                     5375
     C                     MOVEL'SEW5221' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRSSN    - Validate Receiver of Securities :87:            *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRRSSN    BEGSR
      **********                                                                       201429 209949
      ***Receiver*of*securities*is*mandatory*is*ISO15022*is*'Y'********                201429 209949
      ***and*trade*type*is*'Trade*Sell'.*******************************                201429 209949
      **********                                                                       201429 209949
     C********** *IN78     IFEQ *ON                                                    201429 209949
     C********** PTDTP     ANDEQ'TS'                                                   201429 209949
     C********** SRSSN     ANDEQ*BLANKS                                                201429 209949
     C********** *IN08     ANDEQ*OFF                                                   201429 209949
     C********** PDELT     IFNE 0                                                      204550 209949
     C**********           MOVELPDELT     SRSSN                                        204550 209949
     C**********           ELSE                                                        204550 209949
     C**********           MOVE '1'       *IN75                                        201429 209949
     C**********           MOVE '1'       *IN54                                        201429 209949
     C**********           MOVEL'SEW9006' ZAMSID                                       201429 209949
     C**********           EXSR SRSMSG                                                 201429 209949
     C**********           ENDIF                                                       204550 209949
     C**********           ENDIF                                                       201429 209949
      *
      ** Validate If not Blank
     C           SRSSN     IFNE *BLANKS
      *
      ** TAG Field must be left Blank
     C           SRSSA     IFNE *BLANKS
     C                     SETON                     5475
     C                     MOVEL'SEW5228' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** This Field may only be Entered for Receipt Instructions
      ** Or when a MT512 is required
     C***********PTDTP     IFEQ 'TP'                                      CSW003
     C           WTDTP     IFEQ 'TP'                                      CSW003
     C           PGMEC     ANDNE'Y'
     C***********PTDTP     OREQ 'TP'                                      CSW003
     C           WTDTP     OREQ 'TP'                                      CSW003
     C           PCCID     ANDNE'P'
     C                     SETON                     5475
     C                     MOVEL'SEW5291' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Set On Error Indicator for this Field before Validation
     C           *IN54     IFEQ *OFF
     C                     SETON                     54
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SRSSN     WWCUST
     C                     EXSR SRCUST
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     54
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWRSSN
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWRSSN
     C                     END
     C                     END
      *
     C                     ELSE
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWRSSN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRSS1    - Validate Receiver of Securities A/c Line 1 :87: *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRRSS1    BEGSR
      *
      ** Validate If not Blank
     C                     MOVELSRSS1     WWRSS1  1
     C           SRSS1     IFNE *BLANKS
     C           WWRSS1    ANDNE'#'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER7     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** If not Overridden
     C           OVER7     IFNE 'Y'
      *
     C***********PTDTP     IFEQ 'TP'                                      CSW003
     C           WTDTP     IFEQ 'TP'                                      CSW003
     C           PGMEC     ANDNE'Y'
     C***********PTDTP     OREQ 'TP'                                      CSW003
     C           WTDTP     OREQ 'TP'                                      CSW003
     C           PCCID     ANDNE'P'
     C                     SETON                     5575
     C                     MOVEL'SEW5291' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWRSS1    IFNE '/'
     C                     SETON                     5575
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS1     WWLI02
     C           WWRSS1    IFEQ '//'
     C                     SETON                     5575
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SRSS1     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     5575
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRSS2    - Validate Receiver of Securities A/c Line 2 :87: *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRRSS2    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSRSS2     WWRSS2  1
     C           SRSS2     IFNE *BLANKS
     C           WWRSS2    ANDNE'#'
     C           OVER7     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER7     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** If not Overridden
     C           OVER7     IFNE 'Y'
      *
     C           SRSS1     IFEQ *BLANKS
     C                     SETON                     5675
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SRSS2     IFEQ SRSS1
     C                     SETON                     5675
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS2     WWLI02
     C                     MOVE SRSS2     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     5675
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRSS3    - Validate Receiver of Securities A/c Line 3 :87: *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRRSS3    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSRSS3     WWRSS3  1
     C           SRSS3     IFNE *BLANKS
     C           WWRSS3    ANDNE'#'
     C           OVER7     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER7     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** If not Overridden
     C           OVER7     IFNE 'Y'
      *
     C           SRSS2     IFEQ *BLANKS
     C                     SETON                     5775
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SRSS3     IFEQ SRSS2
     C                     SETON                     5775
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS3     WWLI02
     C                     MOVE SRSS3     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     5775
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRSS4    - Validate Receiver of Securities A/c Line 4 :87: *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRRSS4    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSRSS4     WWRSS4  1
     C           SRSS4     IFNE *BLANKS
     C           WWRSS4    ANDNE'#'
     C           OVER7     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER7     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** If not Overridden
     C           OVER7     IFNE 'Y'
      *
     C           SRSS3     IFEQ *BLANKS
     C                     SETON                     5875
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SRSS4     IFEQ SRSS3
     C                     SETON                     5875
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS4     WWLI02
     C                     MOVE SRSS4     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     5875
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDSSA    - Validate Deliverer of Securities TAG :87:       *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDSSA    BEGSR
      *
      ** this Field can only be Entered for Clearance Type 1 to 4
     C           WWCLTY    IFEQ '14'
      *
     C           SDSSA     IFNE 'C'
     C           SDSSA     ANDNE'D'
     C           SDSSA     ANDNE*BLANK
     C                     SETON                     5975
     C                     MOVEL'SEW5223' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** The A/c Lines may not be left Blank when Entering the TAG Field
     C           SDSSA     IFNE *BLANK
     C           SDSS1     ANDEQ*BLANK
     C                     SETON                     6175
     C                     MOVEL'SEW5227' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** this Field must be left Blank If Clearance Type Not 1 to 4
     C           SDSSA     IFNE *BLANK
     C                     SETON                     5975
     C                     MOVEL'SEW5221' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDSSN    - Validate Deliverer of Securities :87:           *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDSSN    BEGSR
      **********                                                                       201429 209949
      ***Deliverer*of*securities*is*mandatory*if*ISO15022*is*'Y'*******                201429 209949
      ***and*type*is*Trade*Purchase.***********************************                201429 209949
      **********                                                                       201429 209949
     C********** *IN78     IFEQ *ON                                                    201429 209949
     C********** PTDTP     ANDEQ'TP'                                                   201429 209949
     C********** SDSSN     ANDEQ*BLANKS                                                201429 209949
     C********** *IN07     ANDEQ*OFF                                                   201429 209949
     C********** PDELF     IFNE 0                                                      204550 209949
     C**********           MOVELPDELF     SDSSN                                        204550 209949
     C**********           ELSE                                                        204550 209949
     C**********           MOVE '1'       *IN75                                        201429 209949
     C**********           MOVE '1'       *IN60                                        201429 209949
     C**********           MOVEL'SEW9003' ZAMSID                                       201429 209949
     C**********           EXSR SRSMSG                                                 201429 209949
     C**********           ENDIF                                                       204550 209949
     C**********           ENDIF                                                       201429 209949
      *
      ** Validate If not Blank
     C           SDSSN     IFNE *BLANKS
      *
      ** TAG Field must be left Blank
     C           SDSSA     IFNE *BLANKS
     C                     SETON                     6075
     C                     MOVEL'SEW5228' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** This Field may only be Entered for Deliver Instructions
      ** Or when a MT512 is required
     C***********PTDTP     IFEQ 'TS'                                      CSW003
     C           WTDTP     IFEQ 'TS'                                      CSW003
     C           PGMEC     ANDNE'Y'
     C***********PTDTP     OREQ 'TS'                                      CSW003
     C           WTDTP     OREQ 'TS'                                      CSW003
     C           PCCID     ANDNE'P'
     C                     SETON                     6075
     C                     MOVEL'SEW5290' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Set On Error Indicator for this Field before Validation
     C           *IN60     IFEQ *OFF
     C                     SETON                     60
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SDSSN     WWCUST
     C                     EXSR SRCUST
     C                     MOVELBBCUST    SDSSN                                             AR589193
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     60
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWDSSN
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWDSSN
     C                     END
     C                     END
      *
     C                     ELSE
     C** ELSE if screen field is blank but account line 1 is not blank    086910
     C** THEN it is an error.                                             086910
     C           SDSSN     IFEQ *BLANKS                                   086910
     C           SDSS1     ANDNE*BLANKS                                   086910
     C           PSNEW     ANDNE'Y'                                                           209949
     C                     MOVE '1'       *IN75                           086910
     C                     MOVE '1'       *IN61                           086910
     C                     MOVE '1'       OVER8                           086910
     C                     MOVEL'SEW5208' ZAMSID                          086910
     C                     MOVEL'SE500MSG'ZAMSGF                          086910
     C                     EXSR SRSMSG                                    086910
     C                     ENDIF                                          086910
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWDSSN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDSS1   - Validate Deliverer of Securities A/c Line 1 :87: *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDSS1    BEGSR
      *
      ** Validate If not Blank
     C                     MOVELSDSS1     WWDSS1  1
     C           SDSS1     IFNE *BLANKS
     C           WWDSS1    ANDNE'#'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER8     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** If not Overridden
     C           OVER8     IFNE 'Y'
      *
     C***********PTDTP     IFEQ 'TS'                                      CSW003
     C           WTDTP     IFEQ 'TS'                                      CSW003
     C           PGMEC     ANDNE'Y'
     C***********PTDTP     OREQ 'TS'                                      CSW003
     C           WTDTP     OREQ 'TS'                                      CSW003
     C           PCCID     ANDNE'P'
     C                     SETON                     6175
     C                     MOVEL'SEW5290' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWDSS1    IFNE '/'
     C                     SETON                     6175
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS1     WWLI02
     C           WWDSS1    IFEQ '//'
     C                     SETON                     6175
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SDSS1     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     6175
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDSS2   - Validate Deliverer of Securities A/c Line 2 :87: *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDSS2    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSDSS2     WWDSS2  1
     C           SDSS2     IFNE *BLANKS
     C           WWDSS2    ANDNE'#'
     C           OVER8     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER8     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** If not Overridden
     C           OVER8     IFNE 'Y'
      *
     C           SDSS1     IFEQ *BLANKS
     C                     SETON                     6275
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SDSS2     IFEQ SDSS1
     C                     SETON                     6275
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS2     WWLI02
     C                     MOVE SDSS2     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     6275
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDSS3   - Validate Deliverer of Securities A/c Line 3 :87: *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDSS3    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSDSS3     WWDSS3  1
     C           SDSS3     IFNE *BLANKS
     C           WWDSS3    ANDNE'#'
     C           OVER8     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER8     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** If not Overridden
     C           OVER8     IFNE 'Y'
      *
     C           SDSS2     IFEQ *BLANKS
     C                     SETON                     6375
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SDSS3     IFEQ SDSS2
     C                     SETON                     6375
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS3     WWLI02
     C                     MOVE SDSS3     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     6375
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRDSS4   - Validate Deliverer of Securities A/c Line 4 :87: *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRDSS4    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSDSS4     WWDSS4  1
     C           SDSS4     IFNE *BLANKS
     C           WWDSS4    ANDNE'#'
     C           OVER8     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER8     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** If not Overridden
     C           OVER8     IFNE 'Y'
      *
     C           SDSS3     IFEQ *BLANKS
     C                     SETON                     6475
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SDSS4     IFEQ SDSS3
     C                     SETON                     6475
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS4     WWLI02
     C                     MOVE SDSS4     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     6475
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBSSA    - Validate Beneficiary of Securities TAG :88:     *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBSSA    BEGSR
      *
      ** this Field can only be Entered for Clearance Type 1 to 4
     C           WWCLTY    IFEQ '14'
      *
     C           SBSSA     IFNE 'C'
     C           SBSSA     ANDNE'D'
     C           SBSSA     ANDNE*BLANK
     C                     SETON                     6575
     C                     MOVEL'SEW5223' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** The A/c Lines may not be left Blank when Entering the TAG Field
     C           SBSSA     IFNE *BLANK
     C           SBSS1     ANDEQ*BLANK
     C                     SETON                     6775
     C                     MOVEL'SEW5227' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** this Field must be left Blank If Clearance Type not 1 to 4
     C           SBSSA     IFNE *BLANK
     C                     SETON                     6575
     C                     MOVEL'SEW5221' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBSSN    - Validate Beneficiary of Securities :88:         *
      **                                                              *
      **  Calls     - SRCUST                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBSSN    BEGSR
      *
      ** Validate If not Blank
     C           SBSSN     IFNE *BLANKS
      *
      ** TAG Field must be left Blank
     C           SBSSA     IFNE *BLANKS
     C                     SETON                     6675
     C                     MOVEL'SEW5228' ZAMSID
     C                     EXSR SRSMSG
     C                     ELSE
      *
      ** Set On Error Indicator for this Field before Validation
     C                     SETON                     66
      *
      ** Validate Customer Number/Shortname/Nostro
     C                     MOVE SBSSN     WWCUST
     C                     EXSR SRCUST
     C                     MOVELBBCUST    SBSSN                                             AR589193
      *
      ** Reset Error Indicator If field is Valid
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     SETOF                     66
     C                     END
      *
      ** Customer Number/Shortname
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWBSSN
     C                     END
      *
      ** Nostro
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWBSSN
     C                     END
     C                     END
      *
     C                     ELSE
      ** Else If Screen Field is Blank, ensure workfield is also Blank
     C                     MOVE *BLANKS   WWBSSN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBSS1    - Validate Beneficiary of Securities A/c Line :88:*
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBSS1    BEGSR
      *
      ** Validate If not Blank
     C                     MOVELSBSS1     WWBSS1  1
     C           SBSS1     IFNE *BLANKS
     C           WWBSS1    ANDNE'#'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER9     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER9
     C                     END
      *
      ** If not Overridden
     C           OVER9     IFNE 'Y'
      *
     C           WWBSS1    IFNE '/'
     C                     SETON                     6775
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5210' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSBSS1     WWLI02
     C           WWBSS1    IFEQ '//'
     C                     SETON                     6775
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5211' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SBSS1     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     SETON                     6775
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5212' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRBSS2    - Validate Beneficiary of Securities A/c Line :88:*
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By - SRVAL                                           *
      **                                                              *
      *****************************************************************
      *
     C           SRBSS2    BEGSR
      *
      ** Validate If not Blank and not Overridden
     C                     MOVELSBSS2     WWBSS2  1
     C           SBSS2     IFNE *BLANKS
     C           WWBSS2    ANDNE'#'
     C           OVER9     ANDNE'Y'
      *
      ** Override by F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ*ON
     C           OVER9     ANDEQ'1'
     C                     MOVE *OFF      *INKS
     C                     MOVE 'Y'       OVER9
     C                     END
      *
      ** If not Overridden
     C           OVER9     IFNE 'Y'
      *
     C           SBSS1     IFEQ *BLANKS
     C                     SETON                     6875
     C                     MOVEL'SEW5255' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C           SBSS2     IFEQ SBSS1
     C                     SETON                     6875
     C                     MOVEL'SEW5258' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSBSS2     WWLI02
     C                     MOVE SBSS2     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     SETON                     6875
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5213' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRCUST    - Validate Customer Number/Shortname/Nostro       *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRCUST    BEGSR
      *
     C                     MOVE *BLANKS   WWCUSS  1
      *
      ** Call Access Program for Customer Details using the Customer
      ** Number or the Customer Shortname.
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM WWCUST    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
      *
      ** If Return code is blank then set WWCUSS to 'C' if Customer
      ** Number; to 'S' if Customer Shortname.
     C           WRTCD     IFEQ *BLANK
     C           WKYST     ANDNE'*ERROR'
      *
     C           WKYST     IFEQ '*CNUM'
     C                     MOVE 'C'       WWCUSS
     C                     ELSE
     C                     MOVE 'S'       WWCUSS
     C                     END
      *
      ** If Customer Number or Shortname then save file fields.
     C                     MOVE BBCABA    WWCABA
     C                     MOVE BBCSID    WWCSID
     C                     MOVE BBBLCD    WWBLCD
     C                     MOVE BBFWCD    WWFWCD
     C                     MOVE BBCHID    WWCHID
     C                     MOVE BBCHSC    WWCHSC
     C                     MOVE BBBNBI    WWBNBI
      *
      ** Else (error on Customer file) may be a Counterparty Nostro
     C                     ELSE
     C                     MOVELWWCUST    WWNOST  8
     C                     CALL 'AOCNSTR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM WWNOST    WKEY2   8
     C           SDCNST    PARM SDCNST    DSFDY
      *
      ** If Counterparty Nostro found set WWCUSS to 'N'.
     C           WRTCD     IFEQ *BLANK
     C                     MOVE 'N'       WWCUSS
     C                     MOVE AWSWID    WWCSID
     C                     MOVE AWFWCD    WWFWCD  9
     C                     MOVE 'Y'       WWBNBI
     C                     END
     C                     END
      *
      ** If no record found on either file then send error message
     C           WWCUSS    IFNE 'C'
     C           WWCUSS    ANDNE'S'
     C           WWCUSS    ANDNE'N'
     C                     SETON                     75
     C                     MOVEL'SEW5205' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRLI35    - Validate A 35 Alpha Input Field                 *
      **                                                              *
      **  Calls     - SRSMSG                                          *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRLI35    BEGSR
      *
      ** Initialise Flag to Send Error Message If 35A Fields not
      ** correctly Formatted.
     C                     MOVE *BLANKS   WWER35
      *
      ** Validate First Character
     C           WWLI01    IFNE '/'
     C                     MOVE 'Y'       WWER35  1
     C                     END
      *
      ** Validate First 2 Characters
     C           WWLI02    IFEQ '//'
     C           WWLI04    ANDNE'//BL'
     C           WWLI04    ANDNE'//CH'
     C           WWLI04    ANDNE'//CP'
     C           WWLI04    ANDNE'//FW'
     C           WWLI04    ANDNE'//SC'
     C                     MOVE 'Y'       WWER35
     C                     END
      *
      ** Validate First 4 Characters
     C           PTNMC     IFNE 'USD'
     C           WWLI04    IFEQ '//CH'
     C           WWLI04    OREQ '//CP'
     C           WWLI04    OREQ '//FW'
     C                     MOVE 'Y'       WWER35
     C                     END
     C                     END
      *
     C           PTNMC     IFNE 'DEM'
     C           WWLI04    ANDEQ'//BL'
     C                     MOVE 'Y'       WWER35
     C                     END
      *
      ** Invalid Entry
     C           WWER35    IFEQ 'Y'
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5235' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Validate First 5 Characters
     C           WWLI05    IFEQ '//CP '
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
      ** If //CP is followed by Blanks then Default this to the
      ** Customer CHIPS Participant
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWCABA    WW0507
     C                     END
     C                     END
      *
      ** Error If ' //CP' is not followed by a 3 Digit Number
      ** followed by Blanks
     C                     MOVELWW0507    WWNUM4  40
     C                     MOVELWWNUM4    WWALP3  3
     C           WW0507    IFNE WWALP3
     C           WW0835    ORNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5236' ZAMSID
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
      ** If Leftmost 4 Chars are '//FW' followed by Blanks and
      ** Customer SWIFT Id is Blank then Set Up Fedwire Account
     C           WWLI04    IFEQ '//FW'
      *
     C           WW0535    IFEQ *BLANKS
     C           WWCSID    ANDEQ*BLANKS
     C                     MOVELWWFWCD    WW0513
     C                     END
      *
      ** Error If Positions 14 -35 of WWLI35 are not Blank
     C           WW1435    IFNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5237' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
      ** Fedwire Account may only be Blank for a Bank with a Valid
      ** SWIFT Address
     C           WW0513    IFEQ *BLANKS
      *
     C           WWCUSS    IFNE 'C'
     C           WWCUSS    ANDNE'S'
     C           WWBNBI    OREQ 'N'
     C           WWCSID    OREQ *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5238' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** Else, must be A 9 Digit Number
     C                     MOVELWW0513    WWNU10 100
     C                     MOVELWWNU10    WWALP9  9
     C           WW0513    IFNE WWALP9
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5239' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** Customer or Bank must have a SWIFT Address or a Fedwire A/c
     C           WWCSID    IFEQ *BLANKS
     C           WWFWCD    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5240' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** If Leftmost 4 Chars of WWLI35 are '//BL' followed by Blanks
      ** Set Up the Bankleitzahl Code
     C           WWLI04    IFEQ '//BL'
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWBLCD    WW0512
     C                     END
     C                     END
      *
      ** Error If '//BL' not followed by 8 Digits Number followed by
      ** Blanks
     C                     MOVELWW0512    WWNUM9  90
     C                     MOVELWWNUM9    WWALP8  8
     C           WW0512    IFNE WWALP8
     C           WW1335    ORNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5241' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** If Leftmost 4 Chars of WWLI35 are '//CH' followed by Blanks
      ** Set Up Customer CHIPS Universal Id
     C           WWLI04    IFEQ '//CH'
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWCHID    WW0510
     C                     END
     C                     END
      *
     C                     END
      *
      ** If Leftmost 4 Chars of WWLI35 are '//SC' followed by Blanks
      ** Set Up CHAPS Sort Code
     C           WWLI04    IFEQ '//SC'
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWCHSC    WW0510
     C                     END
     C                     END
     C                     END
      *
      ** Error If '//CH' or '//SC' are not followed by a 6 Digit Number
     C           WWLI04    IFEQ '//CH'
     C           WWLI04    OREQ '//SC'
      *
     C                     MOVELWW0510    WWNUM7  70
     C                     MOVELWWNUM7    WWALP6  6
     C           WW0510    IFNE WWALP6
     C           WW1135    ORNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     SETON                     75
     C                     MOVEL'SEW5242' ZAMSID
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRCLS2    - To Clear Fields on Second Screen                *
      **              and Reset Error Indicators                      *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRCLS2    BEGSR
      *
     C                     MOVE *BLANKS   SIPYN
     C                     MOVE *BLANKS   SIPYL
     C                     MOVE *BLANKS   SCTYN
     C                     MOVE *BLANKS   SCTYL
     C                     MOVE *BLANKS   SSA1L
     C                     MOVE *BLANKS   SSA1N
     C                     MOVE *BLANKS   SSKAN
     C                     MOVE *BLANKS   SSKAL
     C                     MOVE *BLANKS   SCCTN
     C                     MOVE *BLANKS   SDCTL
     C                     MOVE *BLANKS   SRSSA
     C                     MOVE *BLANKS   SRSSN
     C                     MOVE *BLANKS   SRSS1
     C                     MOVE *BLANKS   SRSS2
     C                     MOVE *BLANKS   SRSS3
     C                     MOVE *BLANKS   SRSS4
     C                     MOVE *BLANKS   SDSSA
     C                     MOVE *BLANKS   SDSSN
     C                     MOVE *BLANKS   SDSS1
     C                     MOVE *BLANKS   SDSS2
     C                     MOVE *BLANKS   SDSS3
     C                     MOVE *BLANKS   SDSS4
     C                     MOVE *BLANKS   SBSSA
     C                     MOVE *BLANKS   SBSSN
     C                     MOVE *BLANKS   SBSS1
     C                     MOVE *BLANKS   SBSS2
     C**********           MOVE *BLANKS   SINVE                                        CSW098 CSW210
      *
     C                     SETOF                       4344
     C                     SETOF                     454647
     C                     SETOF                     484950
     C                     SETOF                     515253
     C                     SETOF                     545556
     C                     SETOF                     575859
     C                     SETOF                     606162
     C                     SETOF                     636465
     C                     SETOF                     666768
     C                     SETOF                     19                   CSW098
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1806C055
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRRTS2    - To reset Fields on Second Screen to File Values *
      **              and Reset Error Indicators                      *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRRTS2    BEGSR
      *
     C                     MOVE T2IPYN    SIPYN
     C                     MOVE T2IPYL    SIPYL
     C                     MOVE T2CTYN    SCTYN
     C                     MOVE T2CTYL    SCTYL
     C                     MOVE T2SA1L    SSA1L
     C                     MOVE T2SA1N    SSA1N
     C                     MOVE T2SKAN    SSKAN
     C                     MOVE T2SKAL    SSKAL
     C                     MOVE T2CCTN    SCCTN
     C                     MOVE T2DCTL    SDCTL
     C                     MOVE T2RSSA    SRSSA
     C                     MOVE T2RSSN    SRSSN
     C                     MOVE T2RSS1    SRSS1
     C                     MOVE T2RSS2    SRSS2
     C                     MOVE T2RSS3    SRSS3
     C                     MOVE T2RSS4    SRSS4
     C                     MOVE T2DSSA    SDSSA
     C                     MOVE T2DSSN    SDSSN
     C                     MOVE T2DSS1    SDSS1
     C                     MOVE T2DSS2    SDSS2
     C                     MOVE T2DSS3    SDSS3
     C                     MOVE T2DSS4    SDSS4
     C                     MOVE T2BSSA    SBSSA
     C                     MOVE T2BSSN    SBSSN
     C                     MOVE T2BSS1    SBSS1
     C                     MOVE T2BSS2    SBSS2
     C**********           MOVE T2INVE    SINVE                                        CSW098 CSW210
     C                     MOVE T2INVE    PINVE                                               CSW210
      *
     C                     SETOF                       4344
     C                     SETOF                     454647
     C                     SETOF                     484950
     C                     SETOF                     515253
     C                     SETOF                     545556
     C                     SETOF                     575859
     C                     SETOF                     606162
     C                     SETOF                     636465
     C                     SETOF                     666768
     C                     SETOF                     19                   CSW098
      *
     C                     ENDSR
     C/COPY WNCPYSRC,SE1806C056
      *
      *****************************************************************                       CSE028
      /EJECT                                                                                  CSE028
      *****************************************************************                       CSE028
      *                                                               *                       CSE028
      *  SRMOFS    - Default Retrieved File Fields to Screen Fields   *                       CSE028
      *                                                               *                       CSE028
      *  Calls     - None.                                            *                       CSE028
      *                                                               *                       CSE028
      *  Called By - SRINS - Process Insert                           *                       CSE028
      *                                                               *                       CSE028
      *****************************************************************                       CSE028
      *                                                                                       CSE028
     C           SRMOFS    BEGSR                                                              CSE028
      *                                                                                       CSE028
     C           WCTPCN    IFEQ *BLANKS                                                       CSE028
     C                     MOVELPTCNR     WCTPCN                                              CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** Retrieve classification of counterparty                                              CSE028
      *                                                                                       CSE028
     C                     CALL 'AOSECSR0'                                                    CSE028
     C                     PARM '*DBERR ' WRTCD                                               CSE028
     C                     PARM '*KEY   ' WOPTN                                               CSE028
     C                     PARM WCTPCN    WCUST                                               CSE028
     C           SDSECS    PARM SDSECS    DSSDY                                               CSE028
      *                                                                                       CSE028
     C           PTDTP     IFEQ 'TP'                                                          CSE028
      *                                                                                       CSE028
     C                     MOVE W4AFPN    SAFPN                                               CSE028
     C                     MOVE W4AFPL    SAFPL                                               CSE028
     C                     MOVE W4AWIN    SAWIN                                               CSE028
     C                     MOVE W4AWIL    SAWIL                                               CSE028
     C                     MOVE W4BOFN    SBOFN                                               CSE028
     C                     MOVE W4BOF1    SBOF1                                               CSE028
     C           CSW210    IFNE 'Y'                                                           CSW210
     C                     MOVE W4BOF2    SBOF2                                               CSE028
     C                     ENDIF                                                              CSW210
     C                     MOVE W4SRL1    SSRL1                                               CSE028
     C                     MOVE W4SRL2    SSRL2                                               CSE028
     C                     MOVE W4SRL3    SSRL3                                               CSE028
     C                     MOVE W4FIN1    SFIN1                                               CSE028
     C                     MOVE W4FIN2    SFIN2                                               CSE028
     C**********           MOVE W4RED1    SRED1                                        CSE028 CSW210
     C**********           MOVE W4RED2    SRED2                                        CSE028 CSW210
     C                     MOVE W4NAS1    SNAL1                                               CSE028
     C                     MOVE W4NAS2    SNAL2                                               CSE028
     C                     MOVE W4CCTN    SCCTN                                               CSE028
     C********** *IN08     IFEQ '1'                                                    204464 209949
     C********** PGMEC     ANDEQ'Y'                                                    204464 209949
     C                     MOVE W4DRSN    SDSSN                                               CSE028
     C                     MOVE W4DRS1    SDSS1                                               CSE028
     C                     MOVE W4DRS2    SDSS2                                               CSE028
     C                     MOVE W4DRS3    SDSS3                                               CSE028
     C                     MOVE W4DRS4    SDSS4                                               CSE028
     C**********           ENDIF                                                       204464 209949
     C                     MOVE W4BSSN    SBSSN                                               CSE028
     C                     MOVE W4BSS1    SBSS1                                               CSE028
     C                     MOVE W4BSS2    SBSS2                                               CSE028
     C                     MOVELW4IMD1    PIMMD1                                              CSE028
     C                     MOVELW4IMD2    PIMMD2                                              CSE028
     C                     MOVELW4IMD3    PIMMD3                                              CSE028
     C                     MOVELW4IMD4    PIMMD4                                              CSE028
     C                     MOVELW4IMD5    PIMMD5                                              CSE028
     C                     MOVELW4IMD6    PIMMD6                                              CSE028
     C                     MOVELW4IMD7    PIMMD7                                              CSE028
     C                     MOVELW4IMD8    PIMMD8                                              CSE028
     C                     MOVELW4IMD9    PIMMD9                                              CSE028
     C                     MOVELW4IMS1    PIMSA1                                              CSE028
     C                     MOVELW4IMS2    PIMSA2                                              CSE028
     C                     MOVELW4IMS3    PIMSA3                                              CSE028
     C                     MOVELW4IMS4    PIMSA4                                              CSE028
     C                     MOVELW4IMS5    PIMSA5                                              CSE028
     C                     MOVELW4IMS6    PIMSA6                                              CSE028
     C                     MOVELW4IMS7    PIMSA7                                              CSE028
     C                     MOVELW4IMS8    PIMSA8                                              CSE028
     C                     MOVELW4IMS9    PIMSA9                                              CSE028
     C                     MOVELW4PSET    PPSET                                               CSE028
     C                     MOVELW4NAC1    PNARR1                                              CSE028
     C                     MOVELW4NAC2    PNARR2                                              CSE028
     C                     MOVE W4RED1    PREGD1                                              CSW210
     C                     MOVE W4RED2    PREGD2                                              CSW210
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVELW4DIDN    SDIDN                                               CSW210
     C                     MOVELW4DLIN    SDLIN                                               CSW210
     C                     MOVELW4DAD1    SDAD1                                               CSW210
     C                     MOVELW4DAD2    SDAD2                                               CSW210
     C                     MOVELW4DAD3    SDAD3                                               CSW210
     C                     MOVELW4DAD4    SDAD4                                               CSW210
     C                     MOVELW4QFIN    PQFIN                                               CSW210
     C                     MOVELW4PCLR    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSE028
      ** Setup parameters to call module SEDORFRTV                                            CSE028
      *                                                                                       CSE028
     C           BFCLAS    IFEQ 'M'                                                           CSE028
     C                     MOVELPDELT     PDEPO                                               CSE028
     C                     MOVELWWBICN    PCUST                                               CSE028
     C                     MOVELPDELF     PDEPO2                                              204592
     C                     ELSE                                                               CSE028
     C                     MOVELPDELT     PDEPO                                               CSE028
     C                     MOVELWCTPCN    PCUST                                               CSE028
     C                     MOVELPDELF     PDEPO2                                              204592
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ELSE                                                               CSE028
      *                                                                                       CSE028
     C                     MOVE W5AFPN    SAFPN                                               CSE028
     C                     MOVE W5AFPL    SAFPL                                               CSE028
     C                     MOVE W5AWIN    SAWIN                                               CSE028
     C                     MOVE W5AWIL    SAWIL                                               CSE028
     C                     MOVE W5BOFN    SBOFN                                               CSE028
     C                     MOVE W5BOF1    SBOF1                                               CSE028
     C           CSW210    IFNE 'Y'                                                           CSW210
     C                     MOVE W5BOF2    SBOF2                                               CSE028
     C                     ENDIF                                                              CSW210
     C                     MOVE W5SRL1    SSRL1                                               CSE028
     C                     MOVE W5SRL2    SSRL2                                               CSE028
     C                     MOVE W5SRL3    SSRL3                                               CSE028
     C                     MOVE W5FIN1    SFIN1                                               CSE028
     C                     MOVE W5FIN2    SFIN2                                               CSE028
     C**********           MOVE W5RED1    SRED1                                        CSE028 CSW210
     C**********           MOVE W5RED2    SRED2                                        CSE028 CSW210
     C                     MOVE W5NAS1    SNAL1                                               CSE028
     C                     MOVE W5NAS2    SNAL2                                               CSE028
     C                     MOVE W5CCTN    SCCTN                                               CSE028
     C********** *IN07     IFEQ '1'                                                    204464 209949
     C********** PGMEC     ANDEQ'Y'                                                    204464 209949
     C                     MOVE W5DRSN    SRSSN                                               CSE028
     C                     MOVE W5DRS1    SRSS1                                               CSE028
     C                     MOVE W5DRS2    SRSS2                                               CSE028
     C                     MOVE W5DRS3    SRSS3                                               CSE028
     C                     MOVE W5DRS4    SRSS4                                               CSE028
     C**********           ENDIF                                                       204464 209949
     C                     MOVE W5BSSN    SBSSN                                               CSE028
     C                     MOVE W5BSS1    SBSS1                                               CSE028
     C                     MOVE W5BSS2    SBSS2                                               CSE028
     C                     MOVELW5IMD1    PIMMD1                                              CSE028
     C                     MOVELW5IMD2    PIMMD2                                              CSE028
     C                     MOVELW5IMD3    PIMMD3                                              CSE028
     C                     MOVELW5IMD4    PIMMD4                                              CSE028
     C                     MOVELW5IMD5    PIMMD5                                              CSE028
     C                     MOVELW5IMD6    PIMMD6                                              CSE028
     C                     MOVELW5IMD7    PIMMD7                                              CSE028
     C                     MOVELW5IMD8    PIMMD8                                              CSE028
     C                     MOVELW5IMD9    PIMMD9                                              CSE028
     C                     MOVELW5IMS1    PIMSA1                                              CSE028
     C                     MOVELW5IMS2    PIMSA2                                              CSE028
     C                     MOVELW5IMS3    PIMSA3                                              CSE028
     C                     MOVELW5IMS4    PIMSA4                                              CSE028
     C                     MOVELW5IMS5    PIMSA5                                              CSE028
     C                     MOVELW5IMS6    PIMSA6                                              CSE028
     C                     MOVELW5IMS7    PIMSA7                                              CSE028
     C                     MOVELW5IMS8    PIMSA8                                              CSE028
     C                     MOVELW5IMS9    PIMSA9                                              CSE028
     C                     MOVELW5PSET    PPSET                                               CSE028
     C                     MOVELW5NAC1    PNARR1                                              CSE028
     C                     MOVELW5NAC2    PNARR2                                              CSE028
     C                     MOVE W5RED1    PREGD1                                              CSW210
     C                     MOVE W5RED2    PREGD2                                              CSW210
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVELW5DIDN    SDIDN                                               CSW210
     C                     MOVELW5DLIN    SDLIN                                               CSW210
     C                     MOVELW5DAD1    SDAD1                                               CSW210
     C                     MOVELW5DAD2    SDAD2                                               CSW210
     C                     MOVELW5DAD3    SDAD3                                               CSW210
     C                     MOVELW5DAD4    SDAD4                                               CSW210
     C                     MOVELW5QFIN    PQFIN                                               CSW210
     C                     MOVELW5PCLR    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSE028
      ** Setup parameters to call module SEDORFRTV                                            CSE028
      *                                                                                       CSE028
     C           BFCLAS    IFEQ 'M'                                                           CSE028
     C                     MOVELPDELF     PDEPO                                               CSE028
     C                     MOVELWWBICN    PCUST                                               CSE028
     C                     MOVELPDELT     PDEPO2                                              204592
     C                     ELSE                                                               CSE028
     C                     MOVELPDELF     PDEPO                                               CSE028
     C                     MOVELWCTPCN    PCUST                                               CSE028
     C                     MOVELPDELT     PDEPO2                                              204592
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** If CSE022 is installed then setup Safekeeping A/C Line by using module SEDORFRTV     CSE028
      *                                                                                       CSE028
     C           CSE022    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C                     CALL PGMNAM                                                        CSE028
     C                     PARM *BLANKS   PRETC  10                                           CSE028
     C                     PARM           PDEPO   6                                           CSE028
     C                     PARM           PCUST   6                                           CSE028
     C**********           PARM           PSKAL  20                                    CSE028 215058
     C                     PARM *BLANKS   PSKAL  20                                           215058
      *                                                                                       211823
     C           PSKAL     IFEQ *BLANKS                                                       211823
     C                     CALL PGMNAM                                                        211823
     C                     PARM *BLANKS   PRETC  10                                           211823
     C                     PARM           PDEPO   6                                           211823
     C                     PARM           PDEPO   6                                           211823
     C                     PARM           PSKAL  20                                           211823
     C                     ENDIF                                                              211823
      *                                                                                       CSE028
     C                     MOVELPDEPO     SSKAN                                               204592
     C                     MOVELPSKAL     SSKAL                                               CSE028
      *                                                                                       204592
     C                     CALL PGMNAM                                                        204592
     C                     PARM *BLANKS   PRETC  10                                           204592
     C                     PARM           PDEPO2  6                                           204592
     C**********           PARM           PCUST   6                                    204592 205665
     C                     PARM           PTCNR                                               205665
     C**********           PARM           PSKAL  20                                    204592 215058
     C                     PARM *BLANKS   PSKAL  20                                           215058
      *                                                                                       204592
     C           PTDTP     IFEQ 'TP'                                                          218770
     C           WSFAF     ANDNE*BLANKS                                                       218770
     C                     MOVELWSFAF     SSA1N                                               218770
     C                     ELSE                                                               218770
     C           PTDTP     IFEQ 'TS'                                                          218770
     C           WSFAT     ANDNE*BLANKS                                                       218770
     C                     MOVELWSFAT     SSA1N                                               218770
     C                     ELSE                                                               218770
     C                     MOVELPDEPO2    SSA1N                                               204592
     C                     ENDIF                                                              218770
     C                     ENDIF                                                              218770
      *                                                                                       218770
     C                     MOVELPSKAL     SSA1L                                               CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDSR                                                              CSE028
      *                                                                                       CSE028
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRFTOS    - To Move File Fields To Screen Fields            *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRFTOS    BEGSR
      *
     C                     MOVE T2AP1N    SAP1N
     C                     MOVE T2AP1L    SAP1L
     C                     MOVE T2AFPN    SAFPN
     C                     MOVE T2AFPL    SAFPL
     C                     MOVE T2AWIA    SAWIA
     C                     MOVE T2AWIN    SAWIN
     C                     MOVE T2AWIN    WWAWIN                                            AR635017
     C                     MOVE T2AWIL    SAWIL
     C                     MOVE T2BOFA    SBOFA
     C                     MOVE T2BOFN    SBOFN
     C                     MOVE T2BOFN    WWBOFN                                            AR635017
     C                     MOVE T2BOF1    SBOF1
     C           CSW210    IFNE 'Y'                                                           CSW210
     C                     MOVE T2BOF2    SBOF2
     C                     ENDIF                                                              CSW210
     C                     MOVE T2ACL1    SACL1
     C                     MOVE T2ACL2    SACL2
     C                     MOVE T2SRL1    SSRL1
     C                     MOVE T2SRL2    SSRL2
     C                     MOVE T2SRL3    SSRL3
     C                     MOVE T2FIN1    SFIN1
     C                     MOVE T2FIN2    SFIN2
     C**********           MOVE T2RED1    SRED1                                               CSW210
     C**********           MOVE T2RED2    SRED2                                               CSW210
     C                     MOVE T2NAL1    SNAL1
     C                     MOVE T2NAL2    SNAL2
     C                     MOVE T2IPYN    SIPYN
     C                     MOVE T2IPYL    SIPYL
     C                     MOVE T2CTYN    SCTYN
     C                     MOVE T2CTYL    SCTYL
     C                     MOVE T2SA1L    SSA1L
     C                     MOVE T2SA1N    SSA1N
     C                     MOVE T2SKAN    SSKAN
     C                     MOVE T2SKAL    SSKAL
     C                     MOVE T2CCTN    SCCTN
     C                     MOVE T2DCTL    SDCTL
     C                     MOVE T2RSSA    SRSSA
     C                     MOVE T2RSSN    SRSSN
     C                     MOVE T2RSS1    SRSS1
     C                     MOVE T2RSS2    SRSS2
     C                     MOVE T2RSS3    SRSS3
     C                     MOVE T2RSS4    SRSS4
     C                     MOVE T2DSSA    SDSSA
     C                     MOVE T2DSSN    SDSSN
     C                     MOVE T2DSS1    SDSS1
     C                     MOVE T2DSS2    SDSS2
     C                     MOVE T2DSS3    SDSS3
     C                     MOVE T2DSS4    SDSS4
     C                     MOVE T2BSSA    SBSSA
     C                     MOVE T2BSSN    SBSSN
     C                     MOVE T2BSS1    SBSS1
     C                     MOVE T2BSS2    SBSS2
     C**********           MOVE T2INVE    SINVE                                        CSW098 CSW210
     C                     MOVE T2RED1    PREGD1                                              CSW210
     C                     MOVE T2RED2    PREGD2                                              CSW210
     C                     MOVE T2INVE    PINVE                                               CSW210
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVELT2DIDN    SDIDN                                               CSW210
     C                     MOVELT2DLIN    SDLIN                                               CSW210
     C                     MOVELT2DAD1    SDAD1                                               CSW210
     C                     MOVELT2DAD2    SDAD2                                               CSW210
     C                     MOVELT2DAD3    SDAD3                                               CSW210
     C                     MOVELT2DAD4    SDAD4                                               CSW210
     C                     MOVELT2QFIN    PQFIN                                               CSW210
     C                     MOVELT2PCLR    PPCLR                                               CSW210
     C           CFT004    IFEQ 'Y'                                                           CSW210
     C                     MOVE T2FAP1    WWFAP1                                              CSW210
     C                     MOVE T2FAP2    WWFAP2                                              CSW210
     C                     MOVE T2FDBT    WWFDBT                                              CSW210
     C                     MOVE T2FAI1    WWFAI1                                              CSW210
     C                     MOVE T2FBF1    WWFBF1                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C                     MOVELT2IMD1    PIMMD1                                              CSE028
     C                     MOVELT2IMD2    PIMMD2                                              CSE028
     C                     MOVELT2IMD3    PIMMD3                                              CSE028
     C                     MOVELT2IMD4    PIMMD4                                              CSE028
     C                     MOVELT2IMD5    PIMMD5                                              CSE028
     C                     MOVELT2IMD6    PIMMD6                                              CSE028
     C                     MOVELT2IMD7    PIMMD7                                              CSE028
     C                     MOVELT2IMD8    PIMMD8                                              CSE028
     C                     MOVELT2IMD9    PIMMD9                                              CSE028
     C                     MOVELT2IMS1    PIMSA1                                              CSE028
     C                     MOVELT2IMS2    PIMSA2                                              CSE028
     C                     MOVELT2IMS3    PIMSA3                                              CSE028
     C                     MOVELT2IMS4    PIMSA4                                              CSE028
     C                     MOVELT2IMS5    PIMSA5                                              CSE028
     C                     MOVELT2IMS6    PIMSA6                                              CSE028
     C                     MOVELT2IMS7    PIMSA7                                              CSE028
     C                     MOVELT2IMS8    PIMSA8                                              CSE028
     C                     MOVELT2IMS9    PIMSA9                                              CSE028
     C                     MOVELT2PSET    PPSET                                               CSE028
     C                     MOVELT2NAC1    PNARR1                                              CSE028
     C                     MOVELT2NAC2    PNARR2                                              CSE028
      *                                                                                       CSE028
     C           T2CTYN    IFNE *BLANKS                                                       CSE028
     C                     CALL 'AOCUSTR0'                                                    CSE028
     C                     PARM '*DBERR ' WRTCD                                               CSE028
     C                     PARM '*KEY   ' WOPTN                                               CSE028
     C                     PARM T2CTYN    WKEY1  10                                           CSE028
     C                     PARM *BLANKS   WKYST   7                                           CSE028
     C           SDCUST    PARM SDCUST    DSSDY                                               CSE028
      *                                                                                       CSE028
     C           WRTCD     IFEQ *BLANK                                                        CSE028
     C                     MOVELBBCUST    WCTPCN  6                                           CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *
      ** If Enquiry Mode, Retrieve Customer Shortnames
     C           PACTN     IFEQ 'E'
      *
     C           T2AP1N    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2AP1N    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C           WKYST     ANDNE'*ERROR'
     C                     MOVE BBCSSN    SAP1N
     C                     END
     C                     END
      *
     C           T2AFPN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2AFPN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SAFPN
     C                     END
     C                     END
      *
     C           T2AWIN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2AWIN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SAWIN
     C                     END
     C                     END
      *
     C           T2BOFN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2BOFN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SBOFN
     C                     END
     C                     END
      *
     C           T2IPYN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2IPYN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SIPYN
     C                     END
     C                     END
      *
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
      *                                                                   CSW098
     C           T2CTYN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2CTYN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SCTYN
     C                     END
     C                     END
     C                     ELSE                                           CSW098
      *                                                                   CSW098
     C********** T2INVE    IFNE *BLANKS                                                CSW098 CSW210
     C**********           CALL 'AOCUSTR0'                                             CSW098 CSW210
     C**********           PARM '*DBERR ' WRTCD                                        CSW098 CSW210
     C**********           PARM '*KEY   ' WOPTN                                        CSW098 CSW210
     C**********           PARM T2INVE    WKEY1  10                                    CSW098 CSW210
     C**********           PARM *BLANKS   WKYST   7                                    CSW098 CSW210
     C********** SDCUST    PARM SDCUST    DSSDY                                        CSW098 CSW210
     C********** WRTCD     IFEQ *BLANK                                                 CSW098 CSW210
     C**********           MOVE BBCSSN    SINVE                                        CSW098 CSW210
     C**********           ENDIF                                                       CSW098 CSW210
     C**********           ENDIF                                                       CSW098 CSW210
      *                                                                   CSW098
     C           T2INVE    IFNE *BLANKS                                                       CSW210
     C                     MOVE T2INVE    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    PINVE                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    PINVE                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                          CSW098
      *
     C           T2SA1N    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2SA1N    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SSA1N
     C                     END
     C                     END
      *
     C           T2SKAN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2SKAN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SSKAN
     C                     END
     C                     END
      *
     C           T2RSSN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2RSSN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SRSSN
     C                     END
     C                     END
      *
     C           T2DSSN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2DSSN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SDSSN
     C                     END
     C                     END
      *
     C           T2BSSN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM T2BSSN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SBSSN
     C                     END
     C                     END
      *
     C           T2DIDN    IFNE *BLANKS                                                       CSW210
     C                     MOVE T2DIDN    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    SDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    SDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           T2QFIN    IFNE *BLANKS                                                       CSW210
     C                     MOVE T2QFIN    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    PQFIN                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    PQFIN                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           T2PCLR    IFNE *BLANKS                                                       CSW210
     C                     MOVE T2PCLR    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1806C057
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRSTOF    - To Move Screen Fields to File Fields            *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRSTOF    BEGSR
      *
      ** Move key fields to file fields
     C***********          MOVELKEY001    T2TDRF                          CSW003
     C                     MOVELPTDRF     T2TDRF                          CSW003
     C                     MOVE PWHEN     T2WHEN                          CSW003
      *
     C                     MOVE WWAP1N    T2AP1N
     C                     MOVE SAP1L     T2AP1L
     C                     MOVE WWAFPN    T2AFPN
     C                     MOVE SAFPL     T2AFPL
      *
     C           SBOFN     IFNE *BLANKS
     C           SBOF1     ORNE *BLANKS
     C                     MOVE SAWIA     T2AWIA
     C                     MOVE WWAWIN    T2AWIN
     C                     MOVE SAWIL     T2AWIL
     C                     ELSE
     C                     MOVE *BLANKS   T2AWIA
     C                     MOVE *BLANKS   T2AWIN
     C                     MOVE *BLANKS   T2AWIL
     C                     END
      *
     C           SAWIN     IFNE *BLANKS
     C           SAWIL     ORNE *BLANKS
     C           *IN78     OREQ *ON                                                           201429
     C                     MOVE SBOFA     T2BOFA
     C                     MOVE WWBOFN    T2BOFN
     C                     MOVE SBOF1     T2BOF1
     C           CSW210    IFNE 'Y'                                                           CSW210
     C                     MOVE SBOF2     T2BOF2
     C                     ENDIF                                                              CSW210
     C                     ELSE
     C                     MOVE *BLANKS   T2BOFA
     C                     MOVE *BLANKS   T2BOFN
     C                     MOVE *BLANKS   T2BOF1
     C                     MOVE *BLANKS   T2BOF2
     C                     END
      *
     C                     MOVE SACL1     T2ACL1
     C                     MOVE SACL2     T2ACL2
     C                     MOVE SSRL1     T2SRL1
     C                     MOVE SSRL2     T2SRL2
     C                     MOVE SSRL3     T2SRL3
     C                     MOVE SFIN1     T2FIN1
     C                     MOVE SFIN2     T2FIN2
     C**********           MOVE SRED1     T2RED1                                              CSW210
     C**********           MOVE SRED2     T2RED2                                              CSW210
     C                     MOVE SNAL1     T2NAL1
     C                     MOVE SNAL2     T2NAL2
     C                     MOVE WWIPYN    T2IPYN
     C                     MOVE SIPYL     T2IPYL
     C                     MOVE WWCTYN    T2CTYN
     C                     MOVE SCTYL     T2CTYL
     C                     MOVE WWSA1N    T2SA1N
     C                     MOVE SSA1L     T2SA1L
     C                     MOVE WWSKAN    T2SKAN
     C                     MOVE SSKAL     T2SKAL
     C                     MOVE SCCTN     T2CCTN
     C                     MOVE SDCTL     T2DCTL
     C                     MOVE SRSSA     T2RSSA
     C                     MOVE WWRSSN    T2RSSN
     C                     MOVE SRSS1     T2RSS1
     C                     MOVE SRSS2     T2RSS2
     C                     MOVE SRSS3     T2RSS3
     C                     MOVE SRSS4     T2RSS4
     C                     MOVE SDSSA     T2DSSA
     C                     MOVE WWDSSN    T2DSSN
     C                     MOVE SDSS1     T2DSS1
     C                     MOVE SDSS2     T2DSS2
     C                     MOVE SDSS3     T2DSS3
     C                     MOVE SDSS4     T2DSS4
     C                     MOVE SBSSA     T2BSSA
     C                     MOVE WWBSSN    T2BSSN
     C                     MOVE SBSS1     T2BSS1
     C                     MOVE SBSS2     T2BSS2
     C**********           MOVE WWINVE    T2INVE                                       CSW098 CSW210
     C                     MOVE PREGD1    T2RED1                                              CSW210
     C                     MOVE PREGD2    T2RED2                                              CSW210
     C                     MOVE PINVE     T2INVE                                              CSW210
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVE WWDIDN    T2DIDN                                              CSW210
     C                     MOVE SDLIN     T2DLIN                                              CSW210
     C                     MOVE SDAD1     T2DAD1                                              CSW210
     C                     MOVE SDAD2     T2DAD2                                              CSW210
     C                     MOVE SDAD3     T2DAD3                                              CSW210
     C                     MOVE SDAD4     T2DAD4                                              CSW210
     C                     MOVE PQFIN     T2QFIN                                              CSW210
     C                     MOVE PPCLR     T2PCLR                                              CSW210
      *                                                                                       CSW210
     C           CFT004    IFEQ 'Y'                                                           CSW210
     C                     MOVE WWFAP1    T2FAP1                                              CSW210
     C                     MOVE WWFAP2    T2FAP2                                              CSW210
     C                     MOVE WWFDBT    T2FDBT                                              CSW210
     C           T2AWIL    IFNE *BLANKS                                                       CSW210
     C                     MOVE WWFAI1    T2FAI1                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       T2FAI1                                              CSW210
     C                     ENDIF                                                              CSW210
     C           T2BOF1    IFNE *BLANKS                                                       CSW210
     C                     MOVE WWFBF1    T2FBF1                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       T2FBF1                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C                     MOVE PIMMD1    T2IMD1                                              CSE028
     C                     MOVE PIMMD2    T2IMD2                                              CSE028
     C                     MOVE PIMMD3    T2IMD3                                              CSE028
     C                     MOVE PIMMD4    T2IMD4                                              CSE028
     C                     MOVE PIMMD5    T2IMD5                                              CSE028
     C                     MOVE PIMMD6    T2IMD6                                              CSE028
     C                     MOVE PIMMD7    T2IMD7                                              CSE028
     C                     MOVE PIMMD8    T2IMD8                                              CSE028
     C                     MOVE PIMMD9    T2IMD9                                              CSE028
     C                     MOVE PIMSA1    T2IMS1                                              CSE028
     C                     MOVE PIMSA2    T2IMS2                                              CSE028
     C                     MOVE PIMSA3    T2IMS3                                              CSE028
     C                     MOVE PIMSA4    T2IMS4                                              CSE028
     C                     MOVE PIMSA5    T2IMS5                                              CSE028
     C                     MOVE PIMSA6    T2IMS6                                              CSE028
     C                     MOVE PIMSA7    T2IMS7                                              CSE028
     C                     MOVE PIMSA8    T2IMS8                                              CSE028
     C                     MOVE PIMSA9    T2IMS9                                              CSE028
     C                     MOVE PPSET     T2PSET                                              CSE028
     C                     MOVE PNARR1    T2NAC1                                              CSE028
     C                     MOVE PNARR2    T2NAC2                                              CSE028
      *                                                                                       CSE045
     C***********CSE045    IFEQ 'Y'                                                   CSE045  222331
     C                     MOVE *BLANKS   T2FRNT                                              CSE045
     C                     MOVE *BLANKS   T2AFRT                                              CSE045
     C                     MOVE *BLANKS   T2REPA                                              CSE045
     C                     MOVEASTAMP,1   T2TMST                                              CSE045
     C***********          ENDIF                                                       CSE045 222331
      *                                                                                       CSE028
     C                     ENDIF
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1806C058
      *****************************************************************
      /EJECT
      *****************************************************************
      **                                                              *
      **  SRINIT    - To Handle Initial Processing                    *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           SRINIT    BEGSR
      *
      **  Copyright Statement
     C                     MOVEACPY@      BIS@   80
      *
      * Get parameters from calling program
     C           *ENTRY    PLIST
     C                     PARM           PCMD    2
     C                     PARM           PERR    1
     C                     PARM           PDATA
     C                     PARM           PSMCC                                               205667
     C                     PARM           DFTFLG  1                                           CSE034
      *
      **  Extra parameter needed to pass detail from TRADSDX2 to SE1806
      **  for reference trade.
     C                     PARM           TRADX2
     C                     PARM           PWHEN   1                       CSW003
     C                     PARM           PMODE   1                       CSE028
     C                     PARM           PSAFA   6                                           201429
      **  Extra parameter needed to pass detail for Midas Compliance                          CSD015
      **  Watch Enhancement.                                                                  CSD015
     C                     PARM           PMCWL                                               CSD015
      *
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
      * Setup keys values using transaction data*passed from caller       CSW003
     C************LIKE     DEFN T2TDRF    KEY001                          CSW003
     C***********          MOVELPTDRF     KEY001                          CSW003
     C           KEY001    KLIST                                          CSW003
     C                     KFLD           PTDRF                           CSW003
     C                     KFLD           PWHEN                           CSW003
      *                                                                                       CSD015
      **  Used for Compliance Watch                                                           CSD015
      *                                                                                       CSD015
     C           CWHTKY    KLIST                                                              CSD015
     C                     KFLD           WFUNT   8                                           CSD015
     C                     KFLD           WIDEN  40                                           CSD015
     C                     KFLD           WBRCH   3                                           CSD015
      *
      * Set up display/non-display indicator for MT5xx Messages
     C                     SETOF                     3940
      *
      * Initialise error indicators
     C                     SETOF                     303132
     C                     SETOF                     333435
     C                     SETOF                     3637
     C                     SETOF                     75
     C                     SETOF                     111214                                   CSW210
     C                     SETOF                     151718                                   CSW210
      *
      * Define work fields
     C           *LIKE     DEFN BBCABA    WWCABA
     C           *LIKE     DEFN BBCSID    WWCSID
     C           *LIKE     DEFN BBBLCD    WWBLCD
     C           *LIKE     DEFN BBCHID    WWCHID
     C           *LIKE     DEFN BBCHSC    WWCHSC
     C           *LIKE     DEFN BBBNBI    WWBNBI
     C           *LIKE     DEFN T2AFPN    WWAFPN
     C           *LIKE     DEFN T2AP1N    WWAP1N
     C           *LIKE     DEFN T2AWIN    WWAWIN
     C           *LIKE     DEFN T2AWIN    WAWIN                    CSW098
     C           *LIKE     DEFN T2BOFN    WWBOFN
     C           *LIKE     DEFN T2BOFN    WBOFN                    CSW098
     C           *LIKE     DEFN T2IPYN    WWIPYN
     C           *LIKE     DEFN T2CTYN    WWCTYN
     C           *LIKE     DEFN T2SKAN    WWSKAN
     C           *LIKE     DEFN T2SA1N    WWSA1N
     C           *LIKE     DEFN T2RSSN    WWRSSN
     C           *LIKE     DEFN T2DSSN    WWDSSN
     C           *LIKE     DEFN T2BSSN    WWBSSN
     C           *LIKE     DEFN T2DIDN    WWDIDN                                              CSW210
     C           *LIKE     DEFN T2DLIN    WWCOMP                                              CSW210
     C           *LIKE     DEFN T2AP1L    WWAP1L                                              CSW210
     C           *LIKE     DEFN T2AFPL    WWAP2L                                              CSW210
     C           *LIKE     DEFN T2AWIL    WWAIL                                               CSW210
     C           *LIKE     DEFN T2BOF1    WWSBOF                                              CSW210
      *                                                                                       CSW210
      ** IBAN Flag work fields                                                                CSW210
     C           *LIKE     DEFN T2FAP1    WWFAP1                                              CSW210
     C           *LIKE     DEFN T2FAP2    WWFAP2                                              CSW210
     C           *LIKE     DEFN T2FDBT    WWFDBT                                              CSW210
     C           *LIKE     DEFN T2FAI1    WWFAI1                                              CSW210
     C           *LIKE     DEFN T2FBF1    WWFBF1                                              CSW210
      *
      * Initialise work fields
     C                     MOVE *BLANKS   WWRITE  1
     C                     MOVE *BLANKS   WACLN  35                       CSW098
     C                     MOVE *BLANKS   WBENF  35                       CSW098
     C                     MOVE *BLANKS   WAWBK  35                       CSW098
     C                     MOVE *BLANKS   WICNIL  1                       CSW098
     C                     MOVE *BLANKS   IAWBK   1                       CSW098
     C                     MOVE *BLANKS   IBENF   1                       CSW098
     C                     MOVE *BLANKS   WWADD   1                                           CSW210
     C                     MOVE *BLANKS   WDACT  35                                           CSW210
     C                     MOVE 'N'       WSDLIN  1                                           CSW210
     C                     MOVE 'N'       WSAP1L  1                                           CSW210
     C                     MOVE 'N'       WSAP2L  1                                           CSW210
     C                     MOVE 'N'       WSAWIL  1                                           CSW210
     C                     MOVE 'N'       WSBOF1  1                                           CSW210
      *
      ** Access Bank Details
     C                     CALL 'AOBANKR0'
     C                     PARM '*DBERR ' WRTCD   7
     C                     PARM '*FIRST ' WOPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
     C                     MOVE BJMRDT    SDATE
      *
      ** Access Branch Details using Branch Code from TRADSD
     C                     MOVE PTDBR     WDSNB
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*DBERR ' WRTCD   7
     C                     PARM '*KEY   ' WOPTN   7
     C                     PARM           WDSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   CSW098
      ** Check to see if switchable feature CSW098 is on or if date is    CSW098
      ** greater than 16 October 1998.                                    CSW098
     C                     CALL 'SWIFT98'              20                 CSW098
     C                     PARM           SWRTN   7                       CSW098
      *                                                                   CSW098
     C           *IN20     IFEQ *ON                        ***************CSW098
     C                     MOVEL'01'      DBASE            **DB ERROR 001*CSW098
     C                     MOVEL'SE1806'  DBPGM            ***************CSW098
     C                     MOVEL'ERR CALL'DBFILE                          CSW098
     C                     MOVEL'SWIFT98' DBKEY                           CSW098
     C                     EXSR *PSSR                                     CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVE *ON       *IN20                           CSW098
     C                     ELSE                                           CSW098
     C                     MOVE *OFF      *IN20                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW014
      ** Check if CSW014 feature is installed                             CSW014
      *                                                                   CSW014
     C                     MOVE 'N'       CSW014  1                       CSW014
     C                     CALL 'AOSARDR0'                                CSW014
     C                     PARM '       ' @RTCD   7                       CSW014
     C                     PARM '*VERIFY' @OPTN   7                       CSW014
     C                     PARM 'CSW014'  @SARD   6                       CSW014
      *                                                                   CSW014
     C           @RTCD     IFEQ *BLANK                                    CSW014
     C                     MOVE 'Y'       CSW014                          CSW014
     C                     ENDIF                                          CSW014
      *                                                                                       CSW201
      ** Call SWIF2001 to check if CSW201 is switched on                                      CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'             8383                                   CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
      *                                                                                       CSW201
     C           *IN83     IFEQ *ON                                                           CSW201
     C                     Z-ADD2         DBASE                                               CSW201
     C                     MOVEL'SWIF2001'DBFILE                                              CSW201
     C                     MOVEL'*CALL'   DBKEY                                               CSW201
     C                     EXSR *PSSR                                                         CSW201
     C                     ELSE                                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSE028
      ** Check if CSE028 feature is installed                                                 CSE028
      *                                                                                       CSE028
     C                     MOVE 'N'       CSE028  1                                           CSE028
     C                     MOVE *OFF      *IN76                                               CSE028
     C                     CALL 'AOSARDR0'                                                    CSE028
     C                     PARM '       ' @RTCD                                               CSE028
     C                     PARM '*VERIFY' @OPTN                                               CSE028
     C                     PARM 'CSE028'  @SARD                                               CSE028
      *                                                                                       CSE028
     C           @RTCD     IFNE *BLANKS                                                       CSE028
     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
     C                     MOVEL@SARD     DBKEY                                               CSE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
     C                     Z-ADD002       DBASE                                               CSE028
     C                     EXSR *PSSR                                                         CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           @RTCD     IFEQ *BLANK                                                        CSE028
     C                     MOVE 'Y'       CSE028                                              CSE028
     C                     MOVE *ON       *IN76                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** Check if CSE029 feature is installed                                                 209247
      *                                                                                       209247
     C                     MOVE 'N'       CSE029  1                                           209247
     C                     CALL 'AOSARDR0'                                                    209247
     C                     PARM '       ' @RTCD                                               209247
     C                     PARM '*VERIFY' @OPTN                                               209247
     C                     PARM 'CSE029'  @SARD                                               209247
      *                                                                                       209247
     C           @RTCD     IFNE *BLANKS                                                       209247
     C           @RTCD     ANDNE'*NRF   '                                                     209247
     C                     MOVEL@SARD     DBKEY                                               209247
     C                     MOVEL'SCSARDPD'DBFILE                                              209247
     C                     Z-ADD004       DBASE                                               209247
     C                     EXSR *PSSR                                                         209247
     C                     ENDIF                                                              209247
      *                                                                                       209247
     C           @RTCD     IFEQ *BLANK                                                        209247
     C                     MOVE 'Y'       CSE029                                              209247
     C                     ENDIF                                                              209247
      *                                                                                       209247
      ** Check if CSE022 feature is installed                                                 CSE028
      *                                                                                       CSE028
     C                     MOVE 'N'       CSE022  1                                           CSE028
     C                     CALL 'AOSARDR0'                                                    CSE028
     C                     PARM '       ' @RTCD                                               CSE028
     C                     PARM '*VERIFY' @OPTN                                               CSE028
     C                     PARM 'CSE022'  @SARD                                               CSE028
      *                                                                                       CSE028
     C           @RTCD     IFNE *BLANKS                                                       CSE028
     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
     C                     MOVEL@SARD     DBKEY                                               CSE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
     C                     Z-ADD003       DBASE                                               CSE028
     C                     EXSR *PSSR                                                         CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           @RTCD     IFEQ *BLANK                                                        CSE028
     C                     MOVE 'Y'       CSE022                                              CSE028
     C                     MOVEL'SEDORF'  PGMNAM  9                                           CSE028
     C                     MOVE 'RTV'     PGMNAM                                              CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       209247
      ** Check if CSE033 is present.                                                          209247
      *                                                                                       209247
     C                     MOVE 'N'       CSE033  1                                           209247
     C                     CALL 'AOSARDR0'                                                    209247
     C                     PARM '       ' @RTCD                                               209247
     C                     PARM '*VERIFY' @OPTN                                               209247
     C                     PARM 'CSE033'  @SARD                                               209247
      *                                                                                       209247
     C           @RTCD     IFNE *BLANKS                                                       209247
     C           @RTCD     ANDNE'*NRF   '                                                     209247
     C                     Z-ADD5         DBASE                                               209247
     C                     MOVEL'SE1806'  DBPGM                                               209247
     C                     MOVEL'SCSARDPD'DBFILE                                              209247
     C                     MOVEL@SARD     DBKEY                                               209247
     C                     EXSR *PSSR                                                         209247
     C                     ENDIF                                                              209247
      *                                                                                       209247
     C           @RTCD     IFEQ *BLANK                                                        209247
     C                     MOVE 'Y'       CSE033                                              209247
     C                     ENDIF                                                              209247
      *                                                                                       209247
     C           CSE033    IFEQ 'Y'                                                           209247
     C           CSE029    ANDEQ'N'                                                           209247
     C                     MOVE 'Y'       CSE029                                              209247
     C                     ENDIF                                                              209247
      *                                                                                       CSE028
      ** Determine if Compliance Watch Enhancement - CSD015                                   CSD015
      ** feature is installed.                                                                CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY 'POPTN   7                                           CSD015
     C                     PARM 'CSD015'  PSARD   6                                           CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CSD015
     C                     Z-ADD9         DBASE            * DBERR 09 *                       CSD015
     C                     MOVEL'CSD015'  DBKEY            ************                       CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CSD015                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Determine if Function Code is being monitored by                                     CSD015
      ** Compliance Watch.                                                                    CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY    'POPTN                                               CSD015
     C                     PARM 'SECTTRAD'PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SDWLCCPD'DBFILE           ************                       CSD015
     C                     Z-ADD10        DBASE            * DBERR 10 *                       CSD015
     C                     MOVELPFUNC     DBKEY            ************                       CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     CLEARPMCWL                                                         CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE *BLANK    W1EWLC                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Determine if 24x7 Midas Availability active?                                         CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSC011'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     MOVE 'Y'       CSC011  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CSC011                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CSD015
     C                     Z-ADD17        DBASE            * DBERR 17 *                       CSD015
     C                     MOVEL'CSC011'  DBKEY            ************                       CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSE045
      ** Check if CSE045 feature is installed                                                 CSE045
      *                                                                                       CSE045
     C                     MOVE 'N'       CSE045  1                                           CSE045
     C                     CALL 'AOSARDR0'                                                    CSE045
     C                     PARM '       ' @RTCD                                               CSE045
     C                     PARM '*VERIFY' @OPTN                                               CSE045
     C                     PARM 'CSE045'  @SARD                                               CSE045
      *                                                                                       CSE045
     C           @RTCD     IFNE *BLANKS                                                       CSE045
     C           @RTCD     ANDNE'*NRF   '                                                     CSE045
     C                     MOVEL@SARD     DBKEY                                               CSE045
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE045
     C                     Z-ADD005       DBASE                                               CSE045
     C                     EXSR *PSSR                                                         CSE045
     C                     ENDIF                                                              CSE045
      *                                                                                       CSE045
     C           @RTCD     IFEQ *BLANK                                                        CSE045
     C                     MOVE 'Y'       CSE045                                              CSE045
     C                     ENDIF                                                              CSE045
      *                                                                                       CSW210
      ** Call SWIF2010 to check if CSW210 is switched on                                      CSW210
      *                                                                                       CSW210
     C                     CALL 'SWIF2010'             7373                                   CSW210
     C                     PARM *BLANKS   @RTCD                                               CSW210
      *                                                                                       CSW210
     C           @RTCD     IFEQ 'CSW2010'                                                     CSW210
     C                     MOVE 'Y'       CSW210  1                                           CSW210
     C                     MOVE *ON       *IN72                                               CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       CSW210                                              CSW210
     C                     MOVE *OFF      *IN72                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if CFT004 is ON for IBAN validation                                            CSW210
     C                     MOVE 'N'       CFT004  1                                           CSW210
     C                     CALL 'AOSARDR0'                                                    CSW210
     C                     PARM '       ' @RTCD                                               CSW210
     C                     PARM '*VERIFY' @OPTN                                               CSW210
     C                     PARM 'CFT004'  @SARD                                               CSW210
      *                                                                                       CSW210
     C           @RTCD     IFNE *BLANKS                                                       CSW210
     C           @RTCD     ANDNE'*NRF   '                                                     CSW210
     C                     MOVEL@SARD     DBKEY                                               CSW210
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW210
     C                     Z-ADD07        DBASE                                               CSW210
     C                     EXSR *PSSR                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           @RTCD     IFEQ *BLANK                                                        CSW210
     C                     MOVE 'Y'       CFT004                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSD015
     C/COPY WNCPYSRC,SE1806C059
      *
      ** Save Branch Internal Customer in workfield
     C**********           MOVE A8BICN    WWBICN  60                                          CSD027
     C                     MOVE A8BICN    WWBICN  6                                           CSD027
      *
      ** Allow Safekeeping Account Fields to be Input capable
     C                     SETOF                     10
      *
      ** Initialise Clearance Type (1 to 4 is MT580 for Settlements)
     C           PWHEN     IFNE 'B'                                       CSW003
     C           PCLTY     OREQ '1'                                       CSW003
     C           PCLTY     OREQ '3'                                       CSW003
      *                                                                   CSW003
     C           PCLTY     IFEQ '1'
     C           PCLTY     OREQ '2'
     C           PCLTY     OREQ '3'
     C           PCLTY     OREQ '4'
     C                     MOVE '14'      WWCLTY  2
     C                     END
      *                                                                   CSW003
     C                     ELSE                                           CSW003
     C           PTDTP     IFEQ 'TP'                                      CSW003
     C                     MOVE PDELF     WCUST                           CSW003
     C                     ELSE                                           CSW003
     C                     MOVE PDELT     WCUST                           CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
     C                     CALL 'AOSECSR0'                                CSW003
     C                     PARM '*DBERR ' WRTCD   7                       CSW003
     C                     PARM '*KEY   ' WOPTN   7                       CSW003
     C                     PARM           WCUST   6                       CSW003
     C           SDSECS    PARM SDSECS    DSSDY                           CSW003
      *                                                                   CSW003
     C           BFCLAS    IFEQ 'E'                                       CSW003
     C           PCLTY     ANDEQ'4'                                       CSW003
     C           BFCLAS    OREQ 'E'                                       CSW003
     C           PCLTY     ANDEQ'5'                                       CSW003
     C           BFCLAS    OREQ 'C'                                       CSW003
     C           PCLTY     ANDEQ'2'                                       CSW003
     C           BFCLAS    OREQ 'C'                                       CSW003
     C           PCLTY     ANDEQ'5'                                       CSW003
     C                     MOVE '14'      WWCLTY                          CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
      *  Set up trade type as opposite, if second record                  CSW003
     C           PWHEN     IFEQ 'B'                                       CSW003
     C           PTDTP     IFEQ 'TP'                                      CSW003
     C                     MOVE 'TS'      WTDTP                           CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'TP'      WTDTP                           CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
     C                     ELSE                                           CSW003
     C                     MOVE PTDTP     WTDTP   2                       CSW003
     C                     END                                            CSW003
      *
      ** Set up non-input capable screen fields from parm received.
     C           PACTN     IFEQ 'B'
     C                     MOVEL'I'       SACTN
     C                     ELSE
     C                     MOVE PACTN     SACTN
     C                     ENDIF
     C                     MOVE PTDRF     STDRF
     C                     MOVE PBLKR     SBLKR
     C                     MOVE PSESN     SSESN
     C                     MOVE PSRPN     SSRPN
      *                                                                   CSW003
      * Set up screen title for destination depot                         CSW003
      *                                                                   CSW003
     C           PWHEN     IFNE *BLANKS                                   CSW003
     C           PDELF     IFNE PDELT                                     CSW003
     C                     MOVE PTCNR     WCUST                           CSW003
     C                     CALL 'AOSECSR0'                                CSW003
     C                     PARM '*DBERR ' WRTCD   7                       CSW003
     C                     PARM '*KEY   ' WOPTN   7                       CSW003
     C                     PARM           WCUST   6                       CSW003
     C           SDSECS    PARM SDSECS    DSSDY                           CSW003
      *                                                                   CSW003
     C           BFCLAS    IFEQ 'S'                                       CSW003
     C           BFCLAS    OREQ 'D'                                       CSW003
      *                                                                   CSW003
     C           PWHEN     IFEQ 'A'                                       CSW003
     C           PTDTP     IFEQ 'TP'                                      CSW003
     C                     SETON                     04                   CSW003
     C                     ELSE                                           CSW003
     C                     SETON                     03                   CSW003
     C                     END                                            CSW003
     C                     ELSE                                           CSW003
     C           PTDTP     IFEQ 'TP'                                      CSW003
     C                     SETON                     03                   CSW003
     C                     ELSE                                           CSW003
     C                     SETON                     04                   CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
      *  Non-display A/c for payment & Safe-keeping a/c if destination    CSW003
      *  Euroclear or Cedel                                               CSW003
     C           WWCLTY    IFEQ '14'                                      CSW003
     C/COPY WNCPYSRC,SE1806C061
     C                     SETON                     05                   CSW003
     C/COPY WNCPYSRC,SE1806C062
     C                     ELSE                                           CSW003
      *                                                                   CSW003
      * Non-display Clearing Correspondent if Destination is neither      CSW003
      * Cedel nor Euroclear                                               CSW003
      *                                                                   CSW003
     C                     SETON                     06                   CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
      * Non-display either Receiver or Deliverer of Securities depending  CSW003
      * on the type                                                       CSW003
      *                                                                   CSW003
     C           WTDTP     IFEQ 'TP'                                      CSW003
     C                     SETON                     08                   CSW003
     C                     ELSE                                           CSW003
     C                     SETON                     07                   CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
     C*                                                                                       209247
      * Display narrative for Receiver's Custodian and Safe A/C                               209247
     C*                                                                                       209247
     C           *IN08     IFEQ *OFF                                                          209247
     C           CSE029    ANDEQ'Y'                                                           209247
     C                     MOVE *ON       *IN70                                               209247
     C                     ENDIF                                                              209247
     C*                                                                                       209247
      * Display narrative for Deliverer's Custodian and Safe A/C                              209247
     C*                                                                                       209247
     C           *IN07     IFEQ *OFF                                                          209247
     C           CSE029    ANDEQ'Y'                                                           209247
     C                     MOVE *ON       *IN71                                               209247
     C                     ENDIF                                                              209247
      *                                                                                       201429
      ** Enable display of counterparty safekeeping a/c if                                    201429
      ** CSE028 is on and ISO15022 is on.                                                     201429
      *                                                                                       201429
     C           CSE028    IFEQ 'Y'                                                           201429
     C           PSNEW     ANDEQ'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C                     MOVE *ON       *IN78                                               201429
     C                     ELSE                                                               201429
     C                     MOVE *OFF      *IN78                                               201429
     C                     ENDIF                                                              201429
      *
     C/COPY WNCPYSRC,SE1806C002
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
     C/COPY WNCPYSRC,SE1806C019
      *****************************************************************
      **                                                              *
      **  *PSSR     - To Handle Database Errors                       *
      **                                                              *
      **  Calls     -                                                 *
      **  Called By -                                                 *
      **                                                              *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C           WRUN      IFEQ *BLANK
     C/COPY WNCPYSRC,SE1806C060
     C                     MOVE 'Y'       WRUN    1
     C                     MOVEL'SE1806'  DBPGM
     C           *NAMVAR   DEFN LDA       WLDA  256
     C           *LOCK     IN   WLDA
     C                     MOVE DBERR     WLDA
     C                     OUT  WLDA
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     END
      *
      ** Call standard DB error handler
     C                     CALL 'DBERRCTL'             81
      *
     C                     ENDSR
      *
      *****************************************************************
      **/EJECT*********************************************************                CSW098 CSW210
      *****************************************************************   CSW098
      *****************************************************************                CSW098 CSW210
      ****SRINVE****-*To*Validate*Investor*****************************                CSW098 CSW210
      *****************************************************************                CSW098 CSW210
      ****Calls*****-*SRCUST*******************************************                CSW098 CSW210
      ****Called*By*-*SRVAL********************************************                CSW098 CSW210
      *****************************************************************                CSW098 CSW210
      *****************************************************************                CSW098 CSW210
      **********                                                                       CSW098 CSW210
     C********** SRINVE    BEGSR                                                       CSW098 CSW210
      **********                                                                       CSW098 CSW210
     C********** SINVE     IFNE *BLANKS                                                CSW098 CSW210
     C**********           MOVELSINVE     WWCUST                                       CSW098 CSW210
     C**********           EXSR SRCUST                                                 CSW098 CSW210
      **********                                                                       CSW098 CSW210
     C**********           SELEC                                                       CSW098 CSW210
     C********** WWCUSS    WHEQ 'C'                                                    CSW098 CSW210
     C********** WWCUSS    OREQ 'S'                                                    CSW098 CSW210
     C**********           MOVELBBCUST    WWINVE 10                                    CSW098 CSW210
     C********** WWCUSS    WHEQ 'N'                                                    CSW098 CSW210
     C**********           MOVELAWCPNC    WWINVE                                       CSW098 CSW210
      **********                                                                       CSW098 CSW210
      ***Set*on*error indicator for Investor.                                          CSW098 CSW210
     C**********           OTHER                                                       CSW098 CSW210
     C**********           MOVE *ON       *IN19                                        CSW098 CSW210
     C**********           ENDSL                                                       CSW098 CSW210
      **********                                                                       CSW098 CSW210
     C**********           ELSE                                                        CSW098 CSW210
     C**********           MOVE *BLANKS   WWINVE                                       CSW098 CSW210
     C**********           ENDIF                                                       CSW098 CSW210
      **********                                                                       CSW098 CSW210
     C**********           ENDSR                                                       CSW098 CSW210
      *                                                                   CSW098
      *****************************************************************   CSW098
      /EJECT                                                              CSW098
      *****************************************************************   CSW098
      **                                                              *   CSW098
      **  SRME99    - To Validate Account with Line via ME9940        *   CSW098
      **                                                              *   CSW098
      **  Calls     -                                                 *   CSW098
      **  Called By - SRAWIL, SRBOF1                                  *   CSW098
      **                                                              *   CSW098
      *****************************************************************   CSW098
      *                                                                   CSW098
     C           SRME99    BEGSR                                          CSW098
      *                                                                   CSW098
     C                     CALL 'ME9940'                                  CSW098
     C                     PARM           W0RTN   7                       CSW098
     C                     PARM           I#PARM                          CSW098
     C                     PARM           O#PARM                          CSW098
     C                     PARM           E#PARM                          CSW098
     C                     PARM           Z#PARM256                       CSW098
      *                                                                   CSW098
     C                     MOVELO#ACLN    WWLI35                          CSW098
     C           E#ERRM    IFNE *BLANKS                                   CSW098
     C                     MOVEL'Y'       WWER35                          CSW098
     C                     MOVE *ON       *IN75                           CSW098
     C                     ELSE                                           CSW098
      *                                                                   CSW098
      ** Check whether Issuer Code has been defined for the currency      CSW098
      ** clearing system. If not, set flag on to issue warning message    CSW098
      ** for later display (SEW5176).                                     CSW098
     C                     MOVELZ#PARM    W#ISCD  4                       CSW098
     C           WWLI02    IFEQ '//'                                      CSW098
     C           W#ISCD    ANDEQ*BLANKS                                   CSW098
     C           O#ACLN    ANDNEWACLN                                     CSW098
     C                     MOVEL'Y'       WICNIL  1                       CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ENDSR                                          CSW098
      *****************************************************************                       CSW201
      **                                                              *                       CSW201
      **  SR2001    - To Validate Swift2001 Codewords                 *                       CSW201
      **                                                              *                       CSW201
      **  Calls     - None                                            *                       CSW201
      **  Called By - SRSRL1, SRSRL2, SRSRL3                          *                       CSW201
      **                                                              *                       CSW201
      *****************************************************************                       CSW201
      *                                                                                       CSW201
     C           SR2001    BEGSR                                                              CSW201
      *                                                                                       CSW201
     C                     MOVEAWWSR10    WARY                                                CSW201
     C                     MOVE 'N'       WERR    1                                           CSW201
     C                     Z-ADD1         X       30                                          CSW201
      *                                                                                       CSW201
     C           X         DOWLT10                                                            CSW201
     C           WERR      ANDEQ'N'                                                           CSW201
     C                     ADD  1         X                                                   CSW201
     C           WARY,X    LOKUPVA0                      90                                   CSW201
      *                                                                                       CSW201
     C           WARY,X    IFEQ '/'                                                           CSW201
     C                     LEAVE                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           *IN90     IFEQ *OFF                                                          CSW201
     C           X         OREQ 10                                                            CSW201
     C           WARY,X    ANDNE'/'                                                           CSW201
     C                     MOVE 'Y'       WERR                                                CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDDO                                                              CSW201
      *                                                                                       CSW201
     C           WARY,2    IFNE '/'                                                           CSW201
     C           WERR      ANDEQ'N'                                                           CSW201
     C                     MOVE 'Y'       WWVALI                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDSR                                                              CSW201
      *                                                                                       CSW201
      *****************************************************************   CSW098
      /EJECT
     C/COPY ZSRSRC,ZALIGNZ2
      /EJECT
     C/COPY ZSRSRC,ZSEDITZ3
      /EJECT
      ***
**  CPY@
(c) Finastra International Limited 2001
**  VA0  - All Numeric Chars
ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
** CWA - Array for watch list fields                                                          CSD015
<MT510 A/C for Payment>                                                                       CSD015
</MT510 A/C for Payment>                                                                      CSD015
<Account for Payment>                                                                         CSD015
</Account for Payment>                                                                        CSD015
<A/C with Institution>                                                                        CSD015
</A/C with Institution>                                                                       CSD015
<Beneficiary>                                                                                 CSD015
</Beneficiary>                                                                                CSD015
<Instructing Party>                                                                           CSD015
</Instructing Party>                                                                          CSD015
<Counterparty>                                                                                CSD015
</Counterparty>                                                                               CSD015
<MT510 Safekeeping A/C>                                                                       CSD015
</MT510 Safekeeping A/C>                                                                      CSD015
<Safekeeping Account>                                                                         CSD015
</Safekeeping Account>                                                                        CSD015
<Deliverr Instrctg Prty>                                                                      CSD015
</Deliverr Instrctg Prty>                                                                     CSD015
<Receivers of Securties>                                                                      CSD015
</Receivers of Securties>                                                                     CSD015
<Deliverrs of Securties>                                                                      CSD015
</Deliverrs of Securties>                                                                     CSD015
<Benfciary of Securties>                                                                      CSD015
</Benfciary of Securties>                                                                     CSD015
<Investor>                                                                                    CSD015
</Investor>                                                                                   CSD015
<Debtor>                                                                                      CSW210
</Debtor>                                                                                     CSW210
<Qualified Foreign Intermediary>                                                              CSW210
</Qualified Foreign Intermediary>                                                             CSW210
<Sttlmnt Prty Intmdiary>                                                                      CSD015
</Sttlmnt Prty Intmdiary>                                                                     CSD015
<Safkeepg A/C Intmdiary>                                                                      CSD015
</Safkeepg A/C Intmdiary>                                                                     CSD015
**  STAMP - Dummy Timestamp                                                                   CSE045
0001-01-01-00.00.00.000000                                                                    CSE045
** S210W                                                                                      CSW210
A/c for Payment Account Line                                                                  CSW210
Debtor Account Line                                                                           CSW210
A/c with Institution Account Line                                                             CSW210
Beneficiary of Money Account Line                                                             CSW210
