     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SE Depot movements extended settle maint')       *
/*XBIA*: OVRDBF FILE(DPTMVDZ2) TOFILE(DPTMVDY2) SHARE(*NO)          : *
     F/COPY WNCPYSRC,SE1808F002
      *****************************************************************
      *                                                               *
      *  Midas - Securities Trading Module
      *                                                               *
      *  SE1808 - Depot Movements - Extended Settlement Details       *
      *                                                               *
      *  Function: This program allows input of the fields needed     *
      *   (I/C)    to produce the SWIFT Messages - MT5XX.             *
      *                                                               *
      *  Called By: SE1807 - Depot Movements - Extension File Update  *
      *                                                               *
      *         NB. ANY CHANGE MADE TO THIS PGM WILL ALMOST           *
      *             DEFINITELY NEED TO BE APPLIED TO SE1806           *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 AR642262           Date 14Sep10               *
      *                 AR579005           Date 16Jul10               *
      *                 AR578310           Date 14Jul10               *
      *                 CSW210             Date 04May10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSE071             Date 19Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6308            Date 13Apr05               *
      *                 BUG6198            Date 04Apr05               *
      *                 215783             Date 25MAR03               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 212937             Date 04Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 211823             Date 11NOV02               *
      *                 210637             Date 25Oct02               *
      *                 212094             Date 15Nov02               *
      *                 212326             Date 13Nov02               *
      *                 209988             Date 10Oct02               *
      *                 209247             Date 08Oct02               *
      *                 209777             Date 04Oct02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 207483             Date 16Jul02               *
      *                 207255             Date 09Jul02               *
      *                 207006             Date 18Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 205670             Date 09May02               *
      *                 205689             Date 13May02               *
      *                 205666             Date 09May02               *
      *                 CSE034             Date 18Apr02               *
      *                 204804             Date 08Apr02               *
      *                 204589             Date 08Apr02               *
      *                 204550             Date 04Apr02               *
      *                 204364             Date 27Mar02               *
      *                 CSE033             Date 20Mar02               *
      *                 201429             Date 24Dec01               *
      *                 201409             Date 21Dec01               *
      *                 201366             Date 20Dec01               *
      *                 178484             Date 25Oct01               *
      *                 199797             Date 01Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE028             Date 06Jun01               *
      *                 CSW201             Date 01May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE015             Date 06Dec99               *
      *                 CSE017             Date 20Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSW014             Date 22Jun98               *
      *                 CSW098             Date 22Apr98               *
      *                 056348             DATE 08MAY96               *
      *                 061028             DATE 08MAY96               *
      *                 086910             DATE 08MAY96               *
      *                 094415             DATE 06FEB96               *
      *                 CSW003             DATE 09NOV95               *
      *                 S01445             DATE 04NOV93               *
      *                 S01401             DATE 16JUN93               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  AR642262 - Error in IBAN validation                          *
      *  AR579005 - Values defined on SEST is not defaulted           *
      *  AR578310 - Debtor id set up in SEST is not defaulted         *
      *  CSW210 - SWIFT 2010 Changes                                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6308- 207255 incorrecty condition setup of default        *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  215783 - Place of settlement not defaulted if no SSI exist.  *
      *           Fix is to default value from market center details  *
      *           if no SSi exist.                                    *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  212937 - Validation of fields should not be conditioned on   *
      *  211823 - Option to Suppress Buyer/Seller for Walk In/Out     *
      *           SWIFT Messages as system value SWIFTSuppBSForWalkIO.*
      *           Safekeeping Account Should be defaulted based upon  *
      *           the Depot.                                          *
      *  210637 - Safekeepint Account not defaulted                   *
      *  212094 - Remove validation of '/' for Counterparty Safe-     *
      *           keeping Account Line and remove the validation for  *
      *           safekeeping account for clearance type 1 to 4       *
      *  212326 - Option to Suppress Buyer/Seller for Walk In/Out     *
      *           SWIFT Messages                                      *
      *  209988 - Allow Clearing Correspondent to be shown            *
      *  209247 - Add Custodian and Safe A/c narrative                *
      *  209777 - MMM Missing field in depot movement                 *
      *  207483 - Depot Movement walk in walk out new change control  *
      *  207255 - Depot movememt walk out new change control          *
      *  207006 - Add Counterparty & Market Centre to SSI             *
      *         - Allow correct retrieval of SSI for RP, RR, BL and BB*
      *  205670 - Instructing Party to Counterparty when ISO15022.    *
      *           (recompile)                                         *
      *  205689 - Remove core fix 178484.                             *
      *  205666 - Instructing Party to Counterparty when ISO15022.    *
      *           Beneficiary of Securities Defaulting.               *
      *  CSE034 - Standard Settlement Instruction improvements        *
      *  204804 - Clearing Correspondent validation incorrect.        *
      *  204589 - Default Deliverer's Instructing field to            *
      *           counterparty.                                       *
      *  204550 - Receiver/Deliverer of securities defaulting.        *
      *  204364 - Clearing correspondent should only be validated if  *
      *           destination is Cedel/Euroclear. Receiver/Deliverer  *
      *           of securities should only be defaulted for          *
      *           confirmation requests.                              *
      *  CSE033 - ISO15022 message generation (Using ME module)       *
      *  201429 - New validation needed for ISO15022 in               *
      *           extended settlement screen.                         *
      *  201409 - Page up while on Extended Settlement details        *
      *           (for Walk in/ Walk out) should not go back to       *
      *           main screen.                                        *
      *  201366 - Ext. Settlement screen displays an input field      *
      *           without title. (Recompile)                          *
      *  178484 - Re introduced fields for validation purposes.       *
      *           Recompile Only.                                     *
      *  199797 - Additional changes and fixes for CSE028 (SSIs).     *
      *  CSE028 - Standing Settlement Instructions Enhancement.       *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  CSE015 - Forward Valued Depot Movements (Recompile)          *
      *  CSE017 - Cum/Ex Indicator on Depot Movements (Recompile)     *
      *  CSW014 - ERI information for non-EMU users.                  *
      *         - Allow '/OCMT/' codeword on the "Sender to Receiver" *
      *           field.                                              *
      *  CSW098 - SWIFT 98 changes. New fields added.                 *
      *  056348 - FIELD 72 DOES NOT ACCEPT CODE WORK /TRADECP/        *        *
      *  061028 - Second and third part of field 72 does not accept   *
      *           blank                                               *
      *  086910 - If account line used for field 87 --> deliverer of  *
      *           securities should be inserted also.                 *
      *  094415 - Wrong destination on messages.                      *
      *  CSW003 - MT5xx Message Generation - Phase 2                  *
      *  S01445 - DEPOT MOVEMENT CHARGES ENHANCEMENT.                 *
      *           Recompiled due to changes in PF/DPTMVD.             *
      *  S01401 - The generation of MT5xx SWIFT Messages if the option*
      *           is available.  NEW PROGRAM.                         *
      *                                                               *
      *****************************************************************
      *
     FDPTMVDY2UF  E           K        DISK         KCOMIT       A
     F            DPTMVDD2                          KRENAMEUPDIDX
     FDPTMVDZ2IF  E           K        DISK
     F            DPTMVDD2                          KRENAMERTVIDX
     FDPTMVDY1IF  E           K        DISK         KCOMIT                                    CSE028
     FSE1808DFCF  E                    WORKSTN
     FSECTY   IF  E           K        DISK                                                   CSE028
     FSEMKC   IF  E           K        DISK                                                   215783
     F*                                                                                       215783
      *                                                                                       CSD015
      **  Compliance Watch Hit List File                                                      CSD015
     FSDCWHTL1IF  E           K        DISK                                                   CSD015
      *                                                                                       CSD015
     FSDCUSTL7IF  E           K        DISK                                                   204804
     F            @CUSTGE                           KRENAMESDCUSTSW                           204804
     F/COPY WNCPYSRC,SE1808F001
      /TITLE FUNCTION OF INCICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*    01  - Start Date Record                                    *   CSW003
     F*    02  - Maturity Date Record                                 *   CSW003
     F*    03  - From Depot Record                                    *   CSW003
     F*    04  - To Depot Record                                      *   CSW003
     F*    05  - Euroclear/Cedel destination                          *   CSW003
     F*    06  - Non Euroclear/Cedel destination                      *   CSW003
     F*    07  - Receive message                                      *   CSW003
     F*    08  - Deliver message                                      *   CSW003
     F*    09  - Protect Input Fields                                 *
     F*    10  - Protect Input Fields                                 *
     F*    19  - Investor                                             *   CSW098
     F*    20  - Switchable feature CSW098 is on or date is greater   *   CSW098
     F*          than 16 October 1998. Can also be error on call to   *   CSW098
     F*          SWIFT98.                                             *   CSW098
     F*    23  - A/c for Payment                                      *
     F*    24  -   "                                                  *
     F*    25  - A/c with Institution                                 *
     F*    26  -   "                                                  *
     F*    27  -   "                                                  *
     F*    28  - Beneficiary of Money                                 *
     F*    29  -   "                                                  *
     F*    30  -   "                                                  *
     F*    31  -   "                                                  *
     F*****32**-*A/c*for*Charges*******************                   *   CSW003
     F*****33**-***"*******************************                   *   CSW003
     F*    34  - Sender to Receiver Information                       *
     F*    35  -   "                                                  *
     F*    36  -   "                                                  *
     F*    37  - Further Information                                  *
     F*    38  -   "                                                  *
     F*    39  - Registration Details                                 *
     F*    40  -   "                                                  *
     F*    41  - Narrative                                            *
     F*    42  -   "                                                  *
     F*    43  - Instructing Party                                    *
     F*    44  -   "                                                  *
     F*    45  - Counterparty (MT512)                                 *
     F*    46  -   "                                                  *
     F*    49  - Safekeeping A/c                                      *
     F*    50  -   "                                                  *
     F*    51  - Clearing Correspondent                               *
     F*    52  - Deliverer's Instructing Party                        *
     F*    53  - Receiver of Securities                               *
     F*    54  -   "                                                  *
     F*    55  -   "                                                  *
     F*    56  -   "                                                  *
     F*    57  -   "                                                  *
     F*    58  -   "                                                  *
     F*    59  - Deliverer of Securities                              *
     F*    60  -   "                                                  *
     F*    61  -   "                                                  *
     F*    62  -   "                                                  *
     F*    63  -   "                                                  *
     F*    64  -   "                                                  *
     F*    65  - Beneficiary Securities                               *
     F*    66  -   "                                                  *
     F*    67  -   "                                                  *
     F*    68  -   "                                                  *
     F*    69  - Indicator for SFLEND in SE1808DF                     *
     F*    71  - Receive message and CSE029 is on                     *                       209247
     F*    72  - Deliver message and CSE029 is on                     *                       209247
     F*    75  - General error in validation                          *
      *    76  - CSE028 is switched on                                *                       CSE028
      *    77  - CSE029 is switched on                                *                       CSE028
      *    79  - CHAIN in file SEMKCD                                 *                       215783
     F*    80  - No record found on chain                             *
     F*    81  - Work indicator                                       *
     F*    82  - Work indicator                                       *
      *    83  - CHAIN Indicator                                      *                       CSE028
      *    84  - Rollup on second screen                              *                       CSE028
     F*    85  - Rollup on first screen                               *
     F*    86  - Rolldown on second screen                            *
     F*    87  - Rolldown on first screen                             *
     F*    88  - Error on file update                                 *
     F*    89  - Error on file update                                 *
     F*    92  - Off=no errors on second screen                       *
     F*                                                               *
     F*    98  - Date Format: DDMMYY (off); MMDDYY (on)               *
     F*  90-99 - Used by Standard Subroutines                         *
     F*                                                               *
     F*  U7+U8 - Database Error                                       *
     F*                                                               *
     F*    KC  - Exit to menu requested                               *
     F*    KE  - Refresh requested                                    *
     F*    KL  - Previous screen requested                            *
     F*    KS  - F18 - Override requested                             *
     F*    KT  - F19 - Reset Requested                                *
     F*                                                               *
     F*****************************************************************
      /TITLE SUBROUTINE INDEX
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  SRINIT - TO HANDLE INITIAL PROCESSING                        *
     F*  SRINS  - Process Insert                                      *
     F*  SRAMD  - Process Amend                                       *
     F*  SRENQ  - Process Enquiry                                     *
     F*  SRSMSG - Routine to send messages to message subfile.        *
     F*  SRALOC - Routine to access record via update index           *
     F*  SRRTRN - Routine to set up return code for calling program   *
     F*  SRSCR1 - Routine to output messages and first screen         *
     F*  SRSCR2 - Routine to output messages and second screen        *
     F*  SRVAL  - Routine to control validation of each field.        *
     F*  SRAFPN - VALIDATE A/C FOR PAYMENT :53:                       *
     F*  SRAFPL - VALIDATE A/C FOR PAYMENT A/C LINE :53:              *
     F*  SRAWIA - VALIDATE A/C WITH INSTITUTION TAG :57:              *
     F*  SRAWIN - VALIDATE A/C WITH INSTITUTION :57:                  *
     F*  SRAWIL - VALIDATE A/C WITH INSTITUTION A/C LINE :57:         *
     F*  SRDIDN - VALIDATE DEBTOR IDENTIFICATION                      *                       CSW210
     F*  SRDADD - VALIDATE DEBTOR ADDRESS                             *                       CSW210
     F*  SRDLIN - VALIDATE DEBTOR ACCOUNT LINE                        *                       CSW210
     F*  SRVLDS - VALIDATE SWIFT                                      *                       CSW210
     F*  SRVLDC - CHECK FOR SWIFT INVALID CHARACTERS                  *                       CSW210
     F*  SRVCDE - CHECKS THE SYNTAX OF CODE WORD                      *                       CSW210
     F*  SRIBAN - TO CHECK IBAN                                       *                       CSW210
     F*  SRMSG1 - Routine to send messages to message subfile.        *                       CSW210
     F*  SRBOFA - VALIDATE BENEFICIARY OF MONEY TAG :58:              *
     F*  SRBOFN - VALIDATE BENEFICIARY OF MONEY :58:                  *
     F*  SRBOF1 - VALIDATE BENEFICIARY OF MONEY A/C LINE :58:         *
     F*  SRBOF2 - VALIDATE BENEFICIARY OF MONEY A/C LINE :58:         *
     F***SRACL1*-*VALIDATE*A/C*CHARGES*LINE*1*:71:*********************   CSW003
     F***SRACL2*-*VALIDATE*A/C*CHARGES*LINE*2*:71:*********************   CSW003
     F*  SRSRL1 - VALIDATE SENDER TO RECEIVER INFO LINE 1 :72:        *
     F*  SRSRL2 - VALIDATE SENDER TO RECEIVER INFO LINE 2 :72:        *
     F*  SRSRL3 - VALIDATE SENDER TO RECEIVER INFO LINE 3 :72:        *
     F*  SRFIN1 - VALIDATE FURTHER INFORMATION LINE 1 :77:            *
     F*  SRFIN2 - VALIDATE FURTHER INFORMATION LINE 2 :77:            *
     F*  SRRED1 - VALIDATE REGISTRATION DERAILS LINE 1 :77:           *
     F*  SRRED2 - VALIDATE REGISTRATION DERAILS LINE 1 :77:           *
     F*  SRNAL1 - VALIDATE NARRATIVE 1 :79:                           *
     F*  SRNAL2 - VALIDATE NARRATIVE 2 :79:                           *
     F*  SRIPYN - VALIDATE INSTRUCTING PARTY :82:                     *
     F*  SRIPYL - VALIDATE INSTRUCTING PARTY A/C LINE :82:            *
     F*  SRCTYN - VALIDATE COUNTERPARTY :82:                          *
     F*  SRCTYL - VALIDATE COUNTERPARTY A/C LINE :82:                 *
     F*  SRSKAN - VALIDATE SAFEKEEPING ACCOUNT :83:                   *
     F*  SRSKAL - VALIDATE SAFEKEEPING ACCOUNT A/C LINE :83:          *
     F*  SRCCTN - VALIDATE CLEARING CORRESPONDENT :84:                *
     F*  SRDCTL - VALIDATE DELIVER'S INSTRUCTING PARTY :85:           *
     F*  SRRSSA - VALIDATE RECEIVER OF SECURITIES TAG :87:            *
     F*  SRRSSN - VALIDATE RECEIVER OF SECURITIES :87:                *
     F*  SRRSS1 - VALIDATE RECEIVER OF SECURITIES A/C LINE 1 :87:     *
     F*  SRRSS2 - VALIDATE RECEIVER OF SECURITIES A/C LINE 2 :87:     *
     F*  SRRSS3 - VALIDATE RECEIVER OF SECURITIES A/C LINE 3 :87:     *
     F*  SRRSS4 - VALIDATE RECEIVER OF SECURITIES A/C LINE 4 :87:     *
     F*  SRDSSA - VALIDATE DELIVERER OF SECURITIES TAG :87:           *
     F*  SRDSSN - VALIDATE DELIVERER OF SECURITIES :87:               *
     F*  SRDSS1 - VALIDATE DELIVERER OF SECURITES A/C LINE 1 :87:     *
     F*  SRDSS2 - VALIDATE DELIVERER OF SECURITES A/C LINE 2 :87:     *
     F*  SRDSS3 - VALIDATE DELIVERER OF SECURITES A/C LINE 3 :87:     *
     F*  SRDSS4 - VALIDATE DELIVERER OF SECURITES A/C LINE 4 :87:     *
     F*  SRBSSA - VALIDATE BENEFICIARY OF SECURITIES TAG :88:         *
     F*  SRBSSN - VALIDATE BENEFICIARY OF SECURITIES :88:             *
     F*  SRBSS1 - VALIDATE BENEFICIARY OF SECURITIES A/C LINE :88:    *
     F*  SRBSS2 - VALIDATE BENEFICIARY OF SECURITIES A/C LINE :88:    *
     F*  SRCUST - VALIDATE CUSTOMER NUMBER/SHORTNAME/NOSTRO           *
     F*  SRLI35 - VALIDATE A 35 ALPHA INPUT FIELD                     *
     F*  SRME99 - Validate a 35 Alpha Input Field via ME9940          *   CSW098
     F*  SRINVE - Validate Investor.                                  *   CSW098
     F*  SRCLS2 - TO CLEAR FIELDS ON SECOND SCREEN                    *
     F*  SRRTS2 - TO RESET FIELDS ON SECOND SCREEN TO FILE VALUES     *
     F*  SRFTOS - TO MOVE FILE FIELDS TO SCREEN FIELDS                *
     F*  SRSTOF - TO MOVE SCREEN FIELDS TO FILE FIELDS                *
     F*  *PSSR  - Routine to handle database errors                   *
     F*                                                               *
     F*  ZA0340 - Send a message to the program message queue         *
     F*  ZA0250 - Clear program message queue                         *
     F*                                                               *
     F*****************************************************************
     E/TITLE E-SPECIFICATIONS
     E                    CPY@    1   1 80
      ***  Array for Object Copyright Statement.
      *
     E/COPY ZSRSRC,ZDATE1Z1
      * ZDATE array
      *
     E                    CCO        12  1               CLEARING CORRESPONDENT
     E                    VA0    36  36  1               VALIDATIONS ALPHA
     E                    WARY       10  1                                                    CSW201
      ** Work Array                                                                           CSW201
      *
     E**********          WLF        11 35                                             CSD015 CSW210
     E                    WLF        13 35                                                    CSW210
     E                    MMD         9 35                                                    CSD015
     E                    MSA         9 35                                                    CSD015
      **  Watch List Fields Work Array.                                                       CSD015
      *                                                                                       CSD015
     E/COPY ZSRSRC,ZALIGNZ1
      * ZALIGN array
      *
     E/COPY ZSRSRC,ZSEDITZ1
      * ZSEDIT array
     E                    SVAL    1   1 20               System values                        212326
     E**********          CWA     1  26 25               Midas Compliance Watch Tags   CSD015 CSW210
     E                    CWA     1  30 25               Midas Compliance Watch Tags          CSW210
      * IBAN warning array                                                                    CSW210
     E                    S210W   1   4 45               IBAN warning data message            CSW210
      *
     I/TITLE I-SPECIFICATIONS
     I/COPY ZSRSRC,ZSEDITZ2
      * ZSEDIT data structure
      *
     IWWDS1       DS                             35
     I                                        1  35 WWLI35
     I                                        5   7 WW0507
     I                                        5  10 WW0510
     I                                        5  12 WW0512
     I                                        5  13 WW0513
     I                                        5  35 WW0535
     I                                        8  35 WW0835
     I                                       11  35 WW1135
     I                                       13  35 WW1335
     I                                       14  35 WW1435
      *
     I           SDS
      * Get program name and window id from PSDS
     I                                     *PROGRAM WWPGM
     I                                      244 253 SJOB
     I                                      254 263 SUSER
     I/COPY WNCPYSRC,SE1808I001
      *
     IDSFDY     E DSDSFDY
      ** First Data Structure for Access Objects
      *
     IDSSDY     E DSDSSDY
      ** Second Data Structure for Access Objects
      *
     ISC24X7    E DSSC24X7                                                                    CSD015
      * 24X7 Data Structure                                                                   CSD015
      *                                                                                       CSD015
     ISDSTAT    E DSSDSTAT                                                                    CSD015
      * SDSTAT Data Structure                                                                 CSD015
      *                                                                                       CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      ** Midas Functions for Watch List Checking Deatils File                                 CSD015
      *                                                                                       CSD015
     ISCSARD    E DSSCSARDPD                                                                  CSD015
      ** External DS for SAR details                                                          CSD015
      *                                                                                       CSD015
     ISDBANK    E DSSDBANKPD
      ** Bank details
      *
     ISDBRCH    E DSSDBRCHPD
      ** Branch details
      *
     ISDCUST    E DSSDCUSTPD
      ** Customer details
     I              QQDFAC                          QQDFAX                                    CGL029
      *
     ISDCNST    E DSSDCNSTPD
      ** Counterparty Nostro details
      *                                                                                       CSW210
     IMEBICD    E DSMEBICDPD                                                                  CSW210
      ** Midas BIC Directory                                                                  CSW210
      *                                                                   094415
     ISDSECS    E DSSDSECSPD                                              094415
      ** Security Customer details                                        094415
      *
     IPMCWL       DS                           9999                                           CSD015
     ITEMPDS      DS                           3000                                           CSD015
      ** Additional entry parameter for Midas Compliance Watch                                CSD015
      *                                                                                       CSD015
     IDBERR       DS                            256
      * Data structure for data-base error processing.
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     IDSSTD     E DSSTDSED                    2                                               CSE028
      * Data structure for standard settlement instructions                                   CSE028
      * Renames for fields already defined                                                    CSE028
     I              LCD                             STDLCD                                    CSE028
      *                                                                                       CSE028
     IDSADD     E DSSTDADSED                  8                                               CSE028
      * Data structure for standard additional settlement details                             CSE028
      *
     IPDATA     E DSSE70DT
      ** Data structure to receive parameters from SE1807 for MT5xxs
      *                                                                   CSW098
     I***I#PARM*     DS                            512                                 CSW098 CGL029
     II#PARM      DS                            514                                           CGL029
      * Field to be validated                                             CSW098
     I                                        1   5 I#VFLD                CSW098
      * Pay/Receive Settlement (PAY/REC)                                  CSW098
     I                                        6   8 I#PR                  CSW098
      * Customer/Counterparty Nostro /BIC indentified type                CSW098
      *    C           X              S  X-> C'party Nostro or Customer   CSW098
      * Customer/Counterparty/BIC indentified                             CSW098
     I                                        9   9 I#PRTT                CSW098
     I                                       10  20 I#PRTY                CSW098
      * Pay Currency                                                      CSW098
     I                                       21  23 I#PCCY                CSW098
      * Receive Currency                                                  CSW098
     I                                       24  26 I#RCCY                CSW098
      * Account Line                                                      CSW098
     I                                       27  61 I#ACLN                CSW098
      * Account Line Character 1                                          CSW098
     I                                       27  27 I#ACC1                CSW098
      * Account Line Character 2                                          CSW098
     I                                       28  28 I#ACC2                CSW098
      * Account Line Character 3                                          CSW098
     I                                       29  29 I#ACC3                CSW098
      * Account Line first 4 characters                                   CSW098
     I                                       27  30 I#ACCL                CSW098
      * Account Line Clearing System                                      CSW098
     I                                       29  30 I#ACCS                CSW098
      * Account Line No account data                                      CSW098
     I                                       31  61 I#SPC1                CSW098
      * Message Type                                                      CSW098
     I                                       62  64 I#MTYP                CSW098
      * Intermediary Institution for Bank to Bank validation              CSW098
     I                                       65  65 I#INBT                CSW098
     I                                       66  76 I#INBK                CSW098
      * Account with Institution for Bank to Bank validation              CSW098
     I                                       77  77 I#AWBT                CSW098
     I                                       78  88 I#AWBK                CSW098
      * Beneficiary for Bank to Bank validation                           CSW098
     I                                       89  89 I#BENT                CSW098
     I                                       90 100 I#BENF                CSW098
      * Pay and Receive Settlement Methods                                CSW098
     I                                      101 102 I#RSTM                CSW098
     I                                      103 104 I#PSTM                CSW098
      * Field 53 and 54 Entered                                           CSW098
     I                                      105 105 I#5354                CSW098
      * Midas Module                                                      CSW098
     I                                      106 107 I#MMOD                CSW098
      * Pay and Receive Settlement Accounts                               CSW098
     I**********                            108 125 I#PYAC                             CSW098 CGL029
     I**********                            126 143 I#RCAC                             CSW098 CGL029
     I                                      108 125 QQPYAC                                    CGL029
     I                                      126 143 QQRCAC                                    CGL029
      * Transaction Type                                                  CSW098
     I                                      144 145 I#TTYP                CSW098
      * Cover required                                                    CSW098
     I                                      146 146 I#COVR                CSW098
      * Bank to Bank Information                                          CSW098
     I                                      257 466 I#BTB                 CSW098
     I                                      257 291 I#BTB1                CSW098
     I                                      292 326 I#BTB2                CSW098
     I                                      327 361 I#BTB3                CSW098
     I                                      362 396 I#BTB4                CSW098
     I                                      397 431 I#BTB5                CSW098
     I                                      432 466 I#BTB6                CSW098
     I                                      467 490 I#PYAC                                    CGL029
     I                                      491 514 I#RCAC                                    CGL029
      *                                                                   CSW098
      * Output Parameters                                                 CSW098
      *                                                                   CSW098
     I***O#PARM*     DS                            512                                 CSW098 CGL029
     IO#PARM      DS                            514                                           CGL029
      * Account Line modified                                             CSW098
     I                                        1  35 O#ACLN                CSW098
      * Bank to Bank Information                                          CSW098
     I                                      257 466 O#BTB                 CSW098
     I                                      257 291 O#BTB1                CSW098
     I                                      292 326 O#BTB2                CSW098
     I                                      327 361 O#BTB3                CSW098
     I                                      362 396 O#BTB4                CSW098
     I                                      397 431 O#BTB5                CSW098
     I                                      432 466 O#BTB6                CSW098
      *                                                                   CSW098
      * Error Parameters                                                  CSW098
      *                                                                   CSW098
     IE#PARM      DS                            256                       CSW098
      * Calling Program                                                   CSW098
     I                                        1  10 E#CPGM                CSW098
      * Error message sent                                                CSW098
     I                                       12  12 E#ERRM                CSW098
      * Warning message sent                                              CSW098
     I                                       13  13 E#WARN                CSW098
      * Error index                                                       CSW098
     I                                       14  180E#INDX                CSW098
      * Message text to prefix error message                              CSW098
     I                                       19  25 E#MSGD                CSW098
     I                                       26  35 E#MSGF                CSW098
      * Error codes array                                                 CSW098
     I                                       51 200 E#ERCD                CSW098
     I                                       51 200 O#E                   CSW098
      *                                                                                       CSE028
     IDSINTM      DS                                                                          CSE028
     I                                        1  12 PIMMD1                                    CSE028
     I                                       13  24 PIMMD2                                    CSE028
     I                                       25  36 PIMMD3                                    CSE028
     I                                       37  48 PIMMD4                                    CSE028
     I                                       49  60 PIMMD5                                    CSE028
     I                                       61  72 PIMMD6                                    CSE028
     I                                       73  84 PIMMD7                                    CSE028
     I                                       85  96 PIMMD8                                    CSE028
     I                                       97 108 PIMMD9                                    CSE028
      *                                                                                       CSE028
     IDSSAFE      DS                                                                          CSE028
     I                                        1  20 PIMSA1                                    CSE028
     I                                       21  40 PIMSA2                                    CSE028
     I                                       41  60 PIMSA3                                    CSE028
     I                                       61  80 PIMSA4                                    CSE028
     I                                       81 100 PIMSA5                                    CSE028
     I                                      101 120 PIMSA6                                    CSE028
     I                                      121 140 PIMSA7                                    CSE028
     I                                      141 160 PIMSA8                                    CSE028
     I                                      161 180 PIMSA9                                    CSE028
      *                                                                                       CSE028
     IPNARR       DS                                                                          CSE028
     I                                        1  35 PNARR1                                    CSE028
     I                                       36  70 PNARR2                                    CSE028
     I            DS                                                                          CSE028
      ** Work data structures for date reversals movement date in                             CSE028
     I                                        1   60@WKIN                                     CSE028
     I                                        1   20@WKIN1                                    CSE028
     I                                        3   40@WKIN2                                    CSE028
     I                                        5   60@WKIN3                                    CSE028
     I            DS                                                                          CSE028
      ** Work data structures for date reversals movement date in                             CSE028
     I                                        1   60@MVIN                                     CSE028
     I                                        1   20@MVIN1                                    CSE028
     I                                        3   40@MVIN2                                    CSE028
     I                                        5   60@MVIN3                                    CSE028
     I            DS                                                                          CSE028
      ** Work data structures for date reversals movement date out                            CSE028
     I                                        1   60@WKOT                                     CSE028
     I                                        1   20@WKOT1                                    CSE028
     I                                        3   40@WKOT2                                    CSE028
     I                                        5   60@WKOT3                                    CSE028
     I            DS                                                                          CSE028
      ** Work data structures for date reversals movement date out                            CSE028
     I                                        1   60@MVOT                                     CSE028
     I                                        1   20@MVOT1                                    CSE028
     I                                        3   40@MVOT2                                    CSE028
     I                                        5   60@MVOT3                                    CSE028
      *                                                                                       CSW210
      ** Registration Details                                                                 CSW210
     IPRDET       DS                                                                          CSW210
     I                                        1  35 SRED1                                     CSW210
     I                                       36  70 SRED2                                     CSW210
      *                                                                                       CSW210
      ** Data Structure redefining Address fields                                             CSW210
     IADDRSS      DS                                                                          CSW210
     I                                        1  35 SDAD1                                     CSW210
     I                                       36  70 SDAD2                                     CSW210
     I                                       71 105 SDAD3                                     CSW210
     I                                      106 140 SDAD4                                     CSW210
      *                                                                                       CSW210
      ** Blank Line Analysis data structure                                                   CSW210
     I                                       36 140 ADCH26                                    CSW210
     I                                       71 140 ADCH36                                    CSW210
      *                                                                                       CSW210
      ** SWIFT Address Analysis data structure                                                CSW210
     I                                        1   1 ADSLSH                                    CSW210
     I                                       12  35 ADEXSW                                    CSW210
      *                                                                                       CSW210
      ** SWIFT validation constants                                                           CSW210
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHAN                                    CSW210
     I              'UVWXYZ0123456789'                                                        CSW210
     I              'ABCDEFGHIJKLMNOPQRST-C         ISO                                       CSW210
     I              'UVWXYZ 1234567890/-?-                                                    CSW210
     I              ':().,''+'                                                                CSW210
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHA                                     CSW210
     I              'UVWXYZ'                                                                  CSW210
     I              '0123456789'          C         NMBRS                                     CSW210
      *                                                                                       CSW210
      ** IBAN DS                                                                              CSW210
     IDSIBAN      DS                                                                          CSW210
     I                                        1   1 DSISLH                                    CSW210
     I                                        2  35 DSIBN2                                    CSW210
      *
      * Datastructure to hold output parameter for AOSVALR0.                                  212326
     I            DS                                                                          212326
     I                                        1 200 SVAL1                                     212326
     I                                        1   1 SVAL01                                    212326
      /TITLE Main Processing
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      ***  Perform Initialisation.
     C                     EXSR SRINIT
      *
      ** Execute specific routine depending on action
     C           PACTN     CASEQ'I'       SRINS
     C           PACTN     CASEQ'D'       SRINS                                               207006
     C           PACTN     CASEQ'A'       SRAMD
     C           PACTN     CASEQ'E'       SRENQ
     C                     END
     C/COPY WNCPYSRC,SE1808C004
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
      *                                                               *
      ** Execute routine to setup return code and exit program
     C                     EXSR SRRTRN
      *                                                               *
      *================================================================
      /TITLE SR/SRINIT
      *****************************************************************
      *                                                               *
      * SRINIT - Routine to handle initial processing                 *
      *                                                               *
      *****************************************************************
      *
     C           SRINIT    BEGSR
      *
      **  Copyright Statement
     C                     MOVEACPY@      BIS@   80
      *
      * Get parameters from calling program
     C           *ENTRY    PLIST
     C                     PARM           PCMD    2
     C                     PARM           PERR    1
     C                     PARM           PDATA
     C                     PARM           PWHEN   1                       CSW003
     C                     PARM           PMODE   1                                           CSE028
     C                     PARM           PSAFA   5                                           201429
      **  Extra parameter needed to pass detail for Midas Compliance                          CSD015
      **  Watch Enhancement.                                                                  CSD015
     C                     PARM           PMCWL                                               CSD015
      *
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSD015
      * Setup keys values using transaction data passed from caller
     C           KEY001    KLIST
     C                     KFLD           PDPSS
     C                     KFLD           PDPRN
     C                     KFLD           PWHEN                           CSW003
      *                                                                                       CSD015
      **  Compliance Watch Hit List Key List                                                  CSD015
      *                                                                                       CSD015
     C           CWHTKY    KLIST                                                              CSD015
     C                     KFLD           WFUNT   8                                           CSD015
     C                     KFLD           WIDEN  40                                           CSD015
     C                     KFLD           WBRCH   3                                           CSD015
      *                                                                                       CSE028
      ** Define Key List for Chaining to file SECTY                                           CSE028
     C           KSECTY    KLIST                                                              CSE028
     C                     KFLD           KSESN                                               CSE028
      *                                                                                       CSE028
     C           *LIKE     DEFN SESN      KSESN                                               CSE028
      *
      * Set up display/non-display indicator for MT5xx Messages
     C                     MOVE '0'       *IN39
     C                     MOVE '0'       *IN40
      *
      * Initialise error indicators
     C                     SETOF                     303132
     C                     SETOF                     333435
     C                     SETOF                     3637
     C                     SETOF                     75
      *
      * Define work fields
     C           *LIKE     DEFN BBCABA    WWCABA
     C           *LIKE     DEFN BBCSID    WWCSID
     C           *LIKE     DEFN BBBLCD    WWBLCD
     C           *LIKE     DEFN BBCHID    WWCHID
     C           *LIKE     DEFN BBCHSC    WWCHSC
     C           *LIKE     DEFN BBBNBI    WWBNBI
     C           *LIKE     DEFN D2AFPN    WWAFPN
     C           *LIKE     DEFN D2AWIN    WWAWIN
     C           *LIKE     DEFN D2AWIN    WAWIN                    CSW098
     C           *LIKE     DEFN D2BOFN    WWBOFN
     C           *LIKE     DEFN D2BOFN    WBOFN                    CSW098
     C           *LIKE     DEFN D2IPYN    WWIPYN
     C           *LIKE     DEFN D2CTYN    WWCTYN
     C           *LIKE     DEFN D2SKAN    WWSKAN
     C           *LIKE     DEFN D2RSSN    WWRSSN
     C           *LIKE     DEFN D2DSSN    WWDSSN
     C           *LIKE     DEFN D2BSSN    WWBSSN
     C           *LIKE     DEFN D2DIDN    WDIDN                                               CSW210
     C           *LIKE     DEFN D2DAD1    WDACT                                               CSW210
     C           *LIKE     DEFN D2FAP1    WFAP1                                               CSW210
     C           *LIKE     DEFN D2FDBT    WFDBT                                               CSW210
     C           *LIKE     DEFN D2FAI1    WFAI1                                               CSW210
     C           *LIKE     DEFN D2FBF1    WFBF1                                               CSW210
     C           *LIKE     DEFN D2AFPL    WAFPL                                               CSW210
     C           *LIKE     DEFN D2AWIL    WAWIL                                               CSW210
     C           *LIKE     DEFN D2DLIN    WDLIN                                               CSW210
     C           *LIKE     DEFN D2BOF1    WBOF1                                               CSW210
      *
      * Initialise work fields
     C                     MOVE *BLANKS   WWRITE  1
     C                     MOVE *BLANKS   WACLN  35                       CSW098
     C                     MOVE *BLANKS   WBENF  35                       CSW098
     C                     MOVE *BLANKS   WAWBK  35                       CSW098
     C                     MOVE *BLANKS   WICNIL  1                       CSW098
     C                     MOVE *BLANKS   IAWBK   1                       CSW098
     C                     MOVE *BLANKS   IBENF   1                       CSW098
     C                     MOVE 'N'       WWADD   1                                           CSW210
     C                     MOVE 'N'       WWAPL   1                                           CSW210
     C                     MOVE 'N'       WWAWL   1                                           CSW210
     C                     MOVE 'N'       WWDLN   1                                           CSW210
     C                     MOVE 'N'       WWBF1   1                                           CSW210
      *
      ** Access Bank Details
     C                     CALL 'AOBANKR0'
     C                     PARM '*DBERR ' WRTCD   7
     C                     PARM '*FIRST ' WOPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
     C                     MOVE BJMRDT    SDATE
      *
      * Date format indicator
     C           BJDFIN    IFEQ 'M'
     C                     SETON                     98
     C                     END
      *                                                                   CSW098
      ** Check to see if switchable feature CSW098 is on or if date is    CSW098
      ** greater than 16 October 1998.                                    CSW098
     C                     CALL 'SWIFT98'              20                 CSW098
     C                     PARM           SWRTN   7                       CSW098
      *                                                                   CSW098
     C           *IN20     IFEQ *ON                        ***************CSW098
     C                     MOVEL'01'      DBASE            **DB ERROR 001*CSW098
     C                     MOVEL'SE1808'  DBPGM            ***************CSW098
     C                     MOVEL'ERR CALL'DBFILE                          CSW098
     C                     MOVEL'SWIFT98' DBKEY                           CSW098
     C                     EXSR *PSSR                                     CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVE *ON       *IN20                           CSW098
     C                     ELSE                                           CSW098
     C                     MOVE *OFF      *IN20                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW014
      ** Check if CSW014 feature is installed                             CSW014
      *                                                                   CSW014
     C                     MOVE 'N'       CSW014  1                       CSW014
     C                     CALL 'AOSARDR0'                                CSW014
     C                     PARM '       ' @RTCD   7                       CSW014
     C                     PARM '*VERIFY' @OPTN   7                       CSW014
     C                     PARM 'CSW014'  @SARD   6                       CSW014
      *                                                                   CSW014
     C           @RTCD     IFEQ *BLANK                                    CSW014
     C                     MOVE 'Y'       CSW014                          CSW014
     C                     ENDIF                                          CSW014
      *                                                                                       CSW201
      ** Call SWIF2001 to check if CSW201 is switched on                                      CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'             7070                                   CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
      *                                                                                       CSW201
     C           *IN70     IFEQ *ON                                                           CSW201
     C                     MOVE '02'      DBASE                                               CSW201
     C                     MOVEL'SWIF2001'DBFILE                                              CSW201
     C                     MOVEL'*CALL'   DBKEY                                               CSW201
     C                     EXSR *PSSR                                                         CSW201
     C                     ELSE                                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSE028
      ** Check if CSE028 feature is installed                                                 CSE028
      *                                                                                       CSE028
     C                     MOVE 'N'       CSE028  1                                           CSE028
     C                     MOVE *OFF      *IN76                                               CSE028
     C                     CALL 'AOSARDR0'                                                    CSE028
     C                     PARM '       ' @RTCD                                               CSE028
     C                     PARM '*VERIFY' @OPTN                                               CSE028
     C                     PARM 'CSE028'  @SARD                                               CSE028
      *                                                                                       CSE028
     C           @RTCD     IFNE *BLANKS                                                       CSE028
     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
     C                     MOVEL@SARD     DBKEY                                               CSE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
     C                     MOVEL'02'      DBASE                                               CSE028
     C                     EXSR *PSSR                                                         CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           @RTCD     IFEQ *BLANK                                                        CSE028
     C                     MOVE 'Y'       CSE028                                              CSE028
     C                     MOVE *ON       *IN76                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** Check if CSE029 feature is installed                                                 CSE028
      *                                                                                       CSE028
     C                     MOVE 'N'       CSE029  1                                           CSE028
     C                     MOVE *OFF      *IN77                                               CSE028
     C                     CALL 'AOSARDR0'                                                    CSE028
     C                     PARM '       ' @RTCD                                               CSE028
     C                     PARM '*VERIFY' @OPTN                                               CSE028
     C                     PARM 'CSE029'  @SARD                                               CSE028
      *                                                                                       CSE028
     C           @RTCD     IFNE *BLANKS                                                       CSE028
     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
     C                     MOVEL@SARD     DBKEY                                               CSE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
     C                     MOVEL'03'      DBASE                                               CSE028
     C                     EXSR *PSSR                                                         CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           @RTCD     IFEQ *BLANK                                                        CSE028
     C                     MOVE 'Y'       CSE029                                              CSE028
     C                     MOVE *ON       *IN77                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE033
      ** Check if CSE033 is present.                                                          CSE033
      *                                                                                       CSE033
     C                     MOVE 'N'       CSE033  1                                           CSE033
     C                     CALL 'AOSARDR0'                                                    CSE033
     C                     PARM '       ' @RTCD                                               CSE033
     C                     PARM '*VERIFY' @OPTN                                               CSE033
     C                     PARM 'CSE033'  @SARD                                               CSE033
      *                                                                                       CSE033
     C           @RTCD     IFNE *BLANKS                                                       CSE033
     C           @RTCD     ANDNE'*NRF   '                                                     CSE033
     C                     MOVEL'10'      DBASE                                               CSE033
     C                     MOVEL'SE1807'  DBPGM                                               CSE033
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE033
     C                     MOVEL@SARD     DBKEY                                               CSE033
     C                     EXSR *PSSR                                                         CSE033
     C                     ENDIF                                                              CSE033
      *                                                                                       CSE033
     C           @RTCD     IFEQ *BLANK                                                        CSE033
     C                     MOVE 'Y'       CSE033                                              CSE033
     C                     ENDIF                                                              CSE033
      *                                                                                       CSE033
     C           CSE033    IFEQ 'Y'                                                           CSE033
     C           CSE029    ANDEQ'N'                                                           CSE033
     C                     MOVE 'Y'       CSE029                                              CSE033
     C                     MOVE *ON       *IN77                                               CSE033
     C                     ENDIF                                                              CSE033
      *                                                                                       CSE028
      ** Check if CSE022 feature is installed                                                 CSE028
      *                                                                                       CSE028
     C                     MOVE 'N'       CSE022  1                                           CSE028
     C                     CALL 'AOSARDR0'                                                    CSE028
     C                     PARM '       ' @RTCD                                               CSE028
     C                     PARM '*VERIFY' @OPTN                                               CSE028
     C                     PARM 'CSE022'  @SARD                                               CSE028
      *                                                                                       CSE028
     C           @RTCD     IFNE *BLANKS                                                       CSE028
     C           @RTCD     ANDNE'*NRF   '                                                     CSE028
     C                     MOVEL@SARD     DBKEY                                               CSE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CSE028
     C                     MOVEL'04'      DBASE                                               CSE028
     C                     EXSR *PSSR                                                         CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           @RTCD     IFEQ *BLANK                                                        CSE028
     C                     MOVE 'Y'       CSE022                                              CSE028
     C                     MOVEL'SEDORF'  PGMNAM  9                                           CSE028
     C                     MOVE 'RTV'     PGMNAM                                              CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** Check if Buyer/Seller should be suppressed for Walk In/Out                           212326
      *                                                                                       212326
      ** Set up parameter so access object checks System Value SWIFTSuppBSForWalkIO           212326
     C                     MOVEASVAL,1    SVALK1                                              212326
      * Call Access object:                                                                   212326
     C                     CALL 'AOSVALR0'                                                    212326
     C                     PARM           RTNCDE  7                                           212326
     C                     PARM           SVALK1 20                                           212326
     C                     PARM           SVAL1 200                                           212326
     C                     PARM           SVALK2 20                                           212326
     C                     PARM           SVAL2 200                                           212326
     C                     PARM           SVALK3 20                                           212326
     C                     PARM           SVAL3 200                                           212326
     C                     PARM           SVALK4 20                                           212326
     C                     PARM           SVAL4 200                                           212326
     C                     PARM           SVALK5 20                                           212326
     C                     PARM           SVAL5 200                                           212326
     C                     PARM           SVALK6 20                                           212326
     C                     PARM           SVAL6 200                                           212326
     C                     PARM           SVALK7 20                                           212326
     C                     PARM           SVAL7 200                                           212326
     C                     PARM           SVALK8 20                                           212326
     C                     PARM           SVAL8 200                                           212326
     C                     PARM           SVALK9 20                                           212326
     C                     PARM           SVAL9 200                                           212326
     C                     PARM           SVALK0 20                                           212326
     C                     PARM           SVAL10200                                           212326
      *                                                                                       212326
      * If the system value is not found then issue a database error                          212326
     C           RTNCDE    IFNE '        '                                                    212326
     C                     MOVEL'SE1808'  DBPGM            ***************                    212326
     C                     MOVEL'SDSVALPD'DBFILE           * DB ERROR 05 *                    212326
     C                     Z-ADD05        DBASE            ***************                    212326
     C                     MOVEL'SVALK1'  DBKEY                                               212326
     C                     EXSR *PSSR                                                         212326
     C                     ELSE                                                               212326
      * Save SVAL1 into Suppress Buyer/Seller for Walk In/Out work field                      212326
     C                     MOVE SVAL01    BENSEC  1                                           212326
     C                     END                                                                212326
      *                                                                                       212326
      ** Determine if Compliance Watch Enhancement - CSD015                                   CSD015
      ** feature is installed.                                                                CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY 'POPTN   7                                           CSD015
     C                     PARM 'CSD015'  PSARD   6                                           CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CSD015
     C                     Z-ADD8         DBASE            * DBERR 08 *                       CSD015
     C                     MOVEL'CSD015'  DBKEY            ************                       CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015  1                                           CSD015
      *                                                                                       CSD015
      ** Determine if Function Code is being monitored by                                     CSD015
      ** Compliance Watch.                                                                    CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY    'POPTN                                               CSD015
     C                     PARM 'SECTTRAD'PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SDWLCCPD'DBFILE           ************                       CSD015
     C                     Z-ADD9         DBASE            * DBERR 09 *                       CSD015
     C                     MOVELPFUNC     DBKEY            ************                       CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     CLEARPMCWL                                                         CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CSD015                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Determine if 24x7 Midas Availability is active                                       CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSC011'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CSD015
     C                     Z-ADD6         DBASE            * DBERR 06 *                       CSD015
     C                     MOVEL'CSC011'  DBKEY            ************                       CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSC011  1                                           CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CSC011                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C/COPY WNCPYSRC,SE1808C005
      *
      ** Access Branch Details using Branch Code from DPTMVD
     C                     MOVE PDPBA     WDSNB
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*DBERR ' WRTCD   7
     C                     PARM '*KEY   ' WOPTN   7
     C                     PARM           WDSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** SAVE BRANCH INTERNAL CUSTOMER IN WORKFIELD
     C                     MOVE A8BICN    WWBICN  60
      *
      ** ALLOW SAFEKEEPING ACCOUNT FIELDS TO BE INPUT CAPABLE
     C                     MOVE '0'       *IN10
      *
      ** INITIALIZE CLEARANCE TYPE (1 TO 4 IS MT580 FOR SETTLEMENTS)
      ***Depot*In*or*Out*is*Euroclear*or*Cedel********************        094415
     C***********PDPID     IFEQ PDC01                                     094415
     C***********PDPID     OREQ PDC02                                     094415
     C***********PDPOD     OREQ PDC01                                     094415
     C***********PDPOD     OREQ PDC02                                     094415
     C***********          MOVE '14'      WWCLTY  2                       094415
     C***********          END                                            094415
     C           PDPMV     IFEQ 'BB'                                      094415
     C           PDPMV     OREQ 'BL'                                      094415
     C           PDPMV     OREQ 'RR'                                      094415
     C           PDPMV     OREQ 'RP'                                      094415
     C           PDPMV     OREQ 'PD'                                      094415
     C           PDPMV     OREQ 'PL'                                      094415
     C           PDPMV     OREQ 'WI'                                      094415
     C           PDPMV     OREQ 'DT'                                      094415
     C           PWHEN     ANDEQ'M'                                       094415
     C                     MOVE PDPID     WCUST   6                       094415
     C                     ELSE                                           094415
     C                     MOVE PDPOD     WCUST   6                       094415
     C                     END                                            094415
     C                     CALL 'AOSECSR0'                                094415
     C                     PARM '*DBERR ' WRTCD   7                       094415
     C                     PARM '*KEY   ' WOPTN   7                       094415
     C                     PARM           WCUST                           094415
     C           SDSECS    PARM SDSECS    DSSDY                           094415
     C           BFCLAS    IFEQ 'E'                                       094415
     C           BFCLAS    OREQ 'C'                                       094415
     C                     MOVE '14'      WWCLTY  2                       094415
     C                     END                                            094415
      *                                                                   CSW003
      *  If CSW003 if off                                                 CSW003
     C           PWHEN     IFEQ *BLANKS                                   CSW003
      *
      ** Determine Receive Free of Payment
     C                     MOVE *BLANKS   WWINST  7
     C           PFIND     IFEQ 'F'
     C           PTNTP     IFEQ 'RR'
     C           PTNTP     OREQ 'BB'
     C           PTNTP     OREQ 'PL'
     C           PTNTP     OREQ 'WI'
     C           PTNTP     OREQ 'RP'
     C           PTNTP     OREQ 'PD'
     C           PTNTP     OREQ 'BL'
     C                     MOVE PDPMD     ZDATE   60
     C                     EXSR ZDATE1
     C           ZDAYNO    IFLE BJDNWD
     C                     MOVE 'RECFREE' WWINST
     C                     MOVE 'TP'      WWREDE  2
     C                     END
     C                     END
      *
      ** Determine Deliver Free of Payment
     C           PTNTP     IFEQ 'RP'
     C           PTNTP     OREQ 'BL'
     C           PTNTP     OREQ 'PD'
     C           PTNTP     OREQ 'WO'
     C           PTNTP     OREQ 'RR'
     C           PTNTP     OREQ 'BB'
     C           PTNTP     OREQ 'PL'
     C           PTNTP     OREQ 'DT'
     C                     MOVE PDPDO     ZDATE
     C                     EXSR ZDATE1
     C           ZDAYNO    IFLE BJDNWD
     C                     MOVE 'DELFREE' WWINST
     C                     MOVE 'TS'      WWREDE
     C                     END
     C                     END
     C                     END
      *
      ** Determine Receive Against Payment
     C           PFIND     IFEQ 'A'
     C           PTNTP     IFEQ 'RR'
     C           PTNTP     OREQ 'BB'
     C           PTNTP     OREQ 'PL'
     C           PTNTP     OREQ 'WI'
     C           PTNTP     OREQ 'RP'
     C           PTNTP     OREQ 'PD'
     C           PTNTP     OREQ 'BL'
     C                     MOVE PDPMD     ZDATE
     C                     EXSR ZDATE1
     C           ZDAYNO    IFLE BJDNWD
     C                     MOVE 'RECAPMT' WWINST
     C                     MOVE 'TP'      WWREDE
     C                     END
     C                     END
      *
      ** Determine Deliver Against Payment
     C           PTNTP     IFEQ 'RP'
     C           PTNTP     OREQ 'BL'
     C           PTNTP     OREQ 'PD'
     C           PTNTP     OREQ 'WO'
     C           PTNTP     OREQ 'RR'
     C           PTNTP     OREQ 'BB'
     C           PTNTP     OREQ 'PL'
     C           PTNTP     OREQ 'DT'
     C                     MOVE PDPDO     ZDATE
     C                     EXSR ZDATE1
     C           ZDAYNO    IFLE BJDNWD
     C                     MOVE 'DELAPMT' WWINST
     C                     MOVE 'TS'      WWREDE
     C                     END
     C                     END
     C                     END
      * CSW003 is on                                                      CSW003
     C                     ELSE                                           CSW003
      *                                                                   CSW003
      ** Determine Receive or Deliver, Free or Against Payment            CSW003
      *                                                                   CSW003
     C           PWHEN     IFEQ 'S'                                       CSW003
      *                                                                   CSW003
     C           PDPMV     IFEQ 'BB'                                      CSW003
     C           PDPMV     OREQ 'RR'                                      CSW003
     C           PDPMV     OREQ 'PD'                                      CSW003
     C           PDPMV     OREQ 'WI'                                      CSW003
     C                     MOVE 'TP'      WWREDE                          CSW003
     C           PFIND     IFEQ 'A'                                       CSW003
     C                     MOVE 'RECAPMT' WWINST                          CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'RECFREE' WWINST                          CSW003
     C                     END                                            CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'TS'      WWREDE                          CSW003
     C           PFIND     IFEQ 'A'                                       CSW003
     C                     MOVE 'DELAPMT' WWINST                          CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'DELFREE' WWINST                          CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
     C           PWHEN     IFEQ 'M'                                       CSW003
      *                                                                   CSW003
     C           PDPMV     IFEQ 'BB'                                      CSW003
     C           PDPMV     OREQ 'RR'                                      CSW003
     C           PDPMV     OREQ 'PD'                                      CSW003
     C                     MOVE 'TS'      WWREDE                          CSW003
     C           PFIND     IFEQ 'A'                                       CSW003
     C                     MOVE 'DELAPMT' WWINST                          CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'DELFREE' WWINST                          CSW003
     C                     END                                            CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'TP'      WWREDE                          CSW003
     C           PFIND     IFEQ 'A'                                       CSW003
     C                     MOVE 'RECAPMT' WWINST                          CSW003
     C                     ELSE                                           CSW003
     C                     MOVE 'RECFREE' WWINST                          CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
     C                     END                                            CSW003
      *                                                                   CSW003
      * Non-display Account for charges and Safekeeping account if Dest   CSW003
      * if Destination is Cedel or Euroclear                              CSW003
      *                                                                   CSW003
     C           WWCLTY    IFEQ '14'                                      CSW003
     C                     SETON                     05                   CSW003
     C                     ELSE                                           CSW003
      *                                                                   CSW003
      **Non-display*Clearing*Correspondent*if*Destination*is*neither      CSW003              209988
      **Cedel*nor*Euroclear*****************************************      CSW003              209988
      *********************                                               CSW003              209988
     C*********************SETON                     06                   CSW003              209988
     C                     END                                            CSW003
      *                                                                   CSW003
      * Non-display either Receiver or Deliverer of Securities depending  CSW003
      * on the type                                                       CSW003
      *                                                                   CSW003
     C           WWREDE    IFEQ 'TP'                                      CSW003
     C                     SETON                     07                   CSW003
     C                     ELSE                                           CSW003
     C                     SETON                     08                   CSW003
     C                     END                                            CSW003
     C*                                                                                       209247
      * Display narrative for Receiver's Custodian and Safe A/C                               209247
     C           *IN07     IFEQ *OFF                                                          209247
     C           CSE029    ANDEQ'Y'                                                           209247
     C                     MOVE *ON       *IN71                                               209247
     C                     ENDIF                                                              209247
     C*                                                                                       209247
      * Display narrative for Deliverer's Custodian and Safe A/C                              209247
     C           *IN08     IFEQ *OFF                                                          209247
     C           CSE029    ANDEQ'Y'                                                           209247
     C                     MOVE *ON       *IN72                                               209247
     C                     ENDIF                                                              209247
     C*                                                                                       209247
      *                                                                   CSW003
     C                     END                                            CSW003
      *
      ** Set up non-input capable screen fields from parm received.
     C                     MOVE PACTN     SACTN
     C                     MOVE PDPSS     SDPSS
     C                     MOVE PDPRN     SDPRN
      *                                                                   CSW003
      ** Set up screen title                                              CSW003
     C           PWHEN     IFEQ 'S'                                       CSW003
     C           PDPMV     IFNE 'DT'                                      CSW003
     C           PDPMV     ANDNE'WI'                                      CSW003
     C           PDPMV     ANDNE'WO'                                      CSW003
     C                     SETON                     01                   CSW003
     C                     END                                            CSW003
     C           PDPMV     IFEQ 'DT'                                      CSW003
     C                     SETON                     03                   CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
     C           PWHEN     IFEQ 'M'                                       CSW003
     C           PDPMV     IFNE 'DT'                                      CSW003
     C           PDPMV     ANDNE'WI'                                      CSW003
     C           PDPMV     ANDNE'WO'                                      CSW003
     C                     SETON                     02                   CSW003
     C                     END                                            CSW003
     C           PDPMV     IFEQ 'DT'                                      CSW003
     C                     SETON                     04                   CSW003
     C                     END                                            CSW003
     C                     END                                            CSW003
      *                                                                                       201429
      ** Enable display of counterparty safekeeping a/c if                                    201429
      ** CSE028 is on and ISO15022 is on.                                                     201429
      *                                                                                       201429
     C           CSE028    IFEQ 'Y'                                                           201429
     C           PSNEW     ANDEQ'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C           PDPMV     ANDEQ'WI'                                                          201429
      *                                                                                       201429
     C           CSE028    OREQ 'Y'                                                           201429
     C           PSNEW     ANDEQ'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C           PDPMV     ANDEQ'WO'                                                          201429
     C                     MOVE *ON       *IN78                                               201429
     C                     ELSE                                                               201429
     C                     MOVE *OFF      *IN78                                               201429
     C                     ENDIF                                                              201429
      *                                                                                       205666
     C********** PSNEW     IFEQ 'Y'                                                    205666 209777
     C**********           MOVE *ON       *IN48                                        205666 209777
     C**********           ELSE                                                        205666 209777
     C**********           MOVE *OFF      *IN48                                        205666 209777
     C**********           ENDIF                                                       205666 209777
      *                                                                                       205666
     C                     CALL 'SWIF2010'                                                    CSW210
     C                     PARM *BLANKS   WRTCD                                               CSW210
      *                                                                                       CSW210
     C           WRTCD     IFEQ 'CSW2010'                                                     CSW210
     C                     MOVE 'Y'       CSW210  1                                           CSW210
     C                     SETON                     79                                       CSW210
     C                     ELSE                                                               CSW210
     C                     MOVE 'N'       CSW210                                              CSW210
     C                     SETOF                     79                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Check if CFT004 feature is installed                                                 CSW210
      *                                                                                       CSW210
     C                     MOVE 'N'       CFT004  1                                           CSW210
     C                     CALL 'AOSARDR0'                                                    CSW210
     C                     PARM '       ' @RTCD                                               CSW210
     C                     PARM '*VERIFY' @OPTN                                               CSW210
     C                     PARM 'CFT004'  @SARD                                               CSW210
      *                                                                                       CSW210
     C           @RTCD     IFNE *BLANKS                                                       CSW210
     C           @RTCD     ANDNE'*NRF   '                                                     CSW210
     C                     MOVEL@SARD     DBKEY                                               CSW210
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW210
     C                     Z-ADD07        DBASE                                               CSW210
     C                     EXSR *PSSR                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           @RTCD     IFEQ *BLANK                                                        CSW210
     C                     MOVE 'Y'       CFT004                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C/COPY WNCPYSRC,SE1808C001
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRINS
      *****************************************************************
      *                                                               *
      * SRINS - Routine to handle 'INSERT' action                     *
      *                                                               *
      *****************************************************************
      *
     C           SRINS     BEGSR
      *
      ** Check whether record exists
      ** (it would already exist if F14 for Extended Settlements has
      **  been taken more than once during the same insert)
     C           KEY001    CHAINRTVIDX               89
      *
      ** If record found then set up screen fields from file;
      ** else initialize screen fields and file fields.
     C           *IN89     IFEQ '0'
     C                     EXSR SRFTOS
     C                     ELSE
      *                                                                                       CSE028
      ** If CSE028 is on, call SESSIR0 for default of MT5xx information                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
      ** First need to settup input parms for SESSIR0                                         CSE028
      *  Access securities file to get investment type                                        CSE028
     C                     MOVE PDPSS     KSESN                                               CSE028
     C           KSECTY    CHAINSECTY                83                                       CSE028
      *                                                                                       CSE028
     C                     MOVE 'D'       POPTYP  1                                           CSE028
     C                     MOVE PDPBA     PBRCH   3                                           CSE028
     C                     MOVE PDPBN     PCUST   6                                           CSE028
     C                     MOVE PBKC      PBOOK   2                                           CSE028
     C                     MOVE PNMCY     PCCY    3                                           CSE028
     C                     MOVE SITP      PINTYP  3                                           CSE028
     C                     MOVE PTFR      PPOREF  4                                           CSE028
      *                                                                                       207006
     C           CSE029    IFNE 'Y'                                                           207006
     C           PDPMV     ORNE 'WI'                                                         BUG6308
     C           PDPMV     ANDNE'WO'                                                         BUG6308
     C                     MOVE SMCC      PMRKT   2                                           CSE034
     C                     ENDIF                                                              207006
      *                                                                                       CSE028
     C                     CALL 'SESSIR0'                                                     CSE028
      *                                                                                       CSE028
      * INPUT PARAMETERS                                                                      CSE028
      *                                                                                       CSE028
      * Operation type                                                                        CSE028
     C                     PARM           POPTYP                                              CSE028
      *                                                                                       CSE028
      * Branch                                                                                CSE028
     C                     PARM           PBRCH                                               CSE028
      *                                                                                       CSE028
      * Customer                                                                              CSE028
     C                     PARM           PCUST                                               CSE028
      *                                                                                       CSE028
      * Book                                                                                  CSE028
     C                     PARM           PBOOK                                               CSE028
      *                                                                                       CSE028
      * Currency                                                                              CSE028
     C                     PARM           PCCY                                                CSE028
      *                                                                                       CSE034
      ** Market Centre                                                                        CSE034
     C                     PARM           PMRKT                                               CSE034
      *                                                                                       CSE028
      * Investment type                                                                       CSE028
     C                     PARM           PINTYP                                              CSE028
      *                                                                                       CSE028
      * Portfolio reference                                                                   CSE028
     C                     PARM           PPOREF                                              CSE028
      *                                                                                       CSE028
      * OUTPUT PARAMETERS                                                                     CSE028
      *                                                                                       CSE028
      * Data structure for STDSED (Book and Customer)                                         CSE028
     C                     PARM           DSSTD                                               CSE028
      *                                                                                       CSE028
      * Data structure for STDADSED (Book and Customer)                                       CSE028
      * (For trade Purchase)                                                                  CSE028
      * (For trade Sale)                                                                      CSE028
      * (For physical Depot IN)                                                               CSE028
      * (For physical Depot OUT)                                                              CSE028
     C                     PARM           DSADD                                               CSE028
      *                                                                                       CSE028
      * Return code                                                                           CSE028
     C                     PARM           PTRCD   5                                           CSE028
      *                                                                                       CSE028
      ** Move file fields to screen fields                                                    CSE028
      *                                                                                       CSE028
     C           PRTCD     IFEQ *BLANKS                                                       CSE028
     C                     EXSR SRMOFS                                                        CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ELSE                                                               CSE028
     C                     CLEARUPDIDX
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     END
      *                                                                                       212326
      ** Default to *NDC the Beneficary of Security for Walk In and                           212326
      ** Instructing Party for Walk Out                                                       212326
      *                                                                                       212326
     C           BENSEC    IFEQ 'Y'                                                           212326
     C           PDPMV     IFEQ 'WI'                                                          212326
     C                     MOVEL'*NDC'    SBSS1                                               212326
     C                     ENDIF                                                              212326
     C           PDPMV     IFEQ 'WO'                                                          212326
     C                     MOVEL'*NDC'    SIPYL                                               212326
     C                     ENDIF                                                              212326
     C                     ENDIF                                                              212326
      *                                                                                       212326
     C/COPY WNCPYSRC,SE1808C002
      *
      ** Handle screens until F3, F5 or F12 taken
      ** or until no errors but not rolldown
      ** No screen processing for mode = 'Y'                                                  CSE028
     C           PMODE     IFNE 'Y'                                                           CSE028
     C           *INKC     DOUEQ'1'
     C           *INKE     OREQ '1'
     C           *INKL     OREQ '1'
     C           *IN75     OREQ '0'
     C           *IN86     ANDEQ'0'
      *
      ** If there are no errors on the second screen or if Rolldown
      ** taken then display the first screen; reset the Rolldown Ind.
      ** New field mode must equal 'N' for normal screen processing.                          CSE028
     C           *IN92     IFEQ '0'
     C           *IN86     OREQ '1'
     C           PMODE     IFEQ 'N'                                                           CSE028
     C                     EXSR SRSCR1
     C                     MOVE '0'       *IN86
     C                     ENDIF                                                              CSE028
     C                     END
      *
      ** If F3, F5, F12 and Rolldown not taken continue
      ** (else repeat 'do until').
     C           *INKC     IFEQ '0'
     C           *INKE     ANDEQ'0'
     C           *INKL     ANDEQ'0'
     C           *IN86     ANDEQ'0'
      *
      ** If there are errors on the second screen or if Rollup taken
      ** then display the second screen; reset screen 2 error indicator
     C           *IN92     IFEQ '1'
     C           *IN85     OREQ '1'
     C/COPY WNCPYSRC,SE1808C006
      *                                                                                       CSE028
      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C           KEY001    CHAINDPTMVDY1             83                                       CSE028
      *                                                                                       CSE028
     C           *IN83     IFEQ *OFF                                                          CSE028
     C           CSE029    ANDEQ'Y'                                                           CSE028
     C                     MOVE *ON       *IN84                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     EXSR SRSCR2
     C                     MOVE *OFF      *IN92                                               201429
      *                                                                                       CSE028
      ** If Rollup was taken on second screen, call SE001810                                  CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C           *IN84     ANDEQ*ON                                                           CSE028
      *                                                                                       CSE028
      ** Check if Place of settlement from STDADSED is blanks or no SSI                       215783
      ** exist. If so, get default from Market Center file.                                   215783
      *                                                                                       215783
     C           PPSET     IFEQ *BLANKS                                                       215783
     C           PMRKT     CHAINSEMKC                79                                       215783
     C           *IN79     IFEQ '0'                                                           215783
     C                     MOVE PSETL     PPSET                                               215783
     C                     END                                                                215783
     C                     END                                                                215783
      *                                                                                       215783
     C                     CALL 'SE001810'                                                    CSE028
     C                     PARM           PACTN   1                                           CSE028
     C                     PARM           DSINTM                                              CSE028
     C                     PARM           DSSAFE                                              CSE028
     C                     PARM           PPSET  12                                           CSE028
     C                     PARM           PNARR                                               CSE028
     C                     PARM           PRTCD   7                                           CSE028
     C                     PARM           PRDET                                               CSW210
     C                     PARM           SINVE                                               CSW210
     C                     PARM           PQFIN                                               CSW210
     C                     PARM           PPCLR                                               CSW210
      *                                                                                       CSE028
      ** Check Return Code                                                                    CSE028
      *                                                                                       CSE028
     C********** PRTCD     IFEQ 'F3'                                                   CSE028 201409
     C           PRTCD     IFEQ 'SE10000'                                                     201409
     C                     MOVE *ON       *INKC                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C********** PRTCD     IFEQ 'F12'                                                  CSE028 201409
     C           PRTCD     IFEQ 'SE10001'                                                     201409
     C           PRTCD     OREQ 'ROLL'                                                        CSE028
     C           PRTCD     OREQ *BLANKS                                                       CSE028
     C                     MOVE *OFF      *IN84                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       201409
      ** If Rolldown taken, then redisplay previous screen.                                   201409
     C           PRTCD     IFEQ 'SE10029'                                                     201409
     C                     MOVE *ON       *IN92                                               201409
     C                     MOVE *ON       *IN75                                               201409
     C                     ENDIF                                                              201409
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C/COPY WNCPYSRC,SE1808C007
     C           PRTCD     IFNE 'SE10029'                                                     201409
     C                     MOVE '0'       *IN92
     C                     ENDIF                                                              201409
     C                     END
      *
      ** Clear messages for redisplay
     C                     CALL 'ZA0250'
      *
      ** Validate input, only if F3, F5, F12 and Rolldown not taken
     C           *INKC     IFEQ '0'
     C           *INKE     ANDEQ'0'
     C           *INKL     ANDEQ'0'
     C           *IN86     ANDEQ'0'
     C           *IN84     ANDEQ'0'                                                           CSE028
     C           *IN92     ANDEQ'0'                                                           201409
     C                     EXSR SRVAL
      *
      ** If no errors on validation update/write to the file and drop
      ** out of subroutine (and program).
     C           *IN75     IFEQ '0'
      *                                                                                       CSD015
      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If 24X7 is not installed or the suport system is off.                                CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV1                                                        CSD015
      *                                                                                       CSD015
     C           WDIFFI    IFEQ 'Y'                                                           CSD015
     C           WIMDI     OREQ 'Y'                                                           CSD015
     C           WIMSI     OREQ 'Y'                                                           CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *
      ** If record previously existed then allocate the record via the
      ** update index
     C           *IN89     IFEQ '0'
     C                     EXSR SRALOC
      *
      ** If record on file and allocated then move screen values to
      ** file fields and update record;
      ** (else screen will be redisplayed)
     C           *IN80     IFEQ '0'
     C           *IN81     ANDEQ'0'
     C                     EXSR SRSTOF
     C                     UPDATUPDIDX                 88
     C                     END
      *
      ** Else (record does not already exist) move screen fields to
      ** file fields; write new record.
     C                     ELSE
     C                     EXSR SRSTOF
     C                     WRITEUPDIDX                 88
     C                     END
      *
     C/COPY WNCPYSRC,SE1808C008
     C                     END
      *
     C                     END
      *
      ** If F12 taken from second screen then set Rolldown Ind (*IN86);
      ** set F12 off; and clear fields on 2nd screen.
     C           *INKL     IFEQ '1'
     C                     MOVE '1'       *IN86
     C                     MOVE *OFF      *IN84                                               CSE028
     C                     MOVE '0'       *INKL
     C                     EXSR SRCLS2
     C/COPY WNCPYSRC,SE1808C009
     C                     END
      *
     C                     END
      *
     C                     END
      *                                                                                       CSE028
      ** MODE = 'Y' after missing screen processing                                           CSE028
     C                     ELSE                                                               CSE028
      ** MODE = 'Y' just do file updates                                                      CSE028
      *                                                                                       CSE028
      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If 24X7 is not installed or the suport system is off.                                CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV1                                                        CSD015
      *                                                                                       CSD015
     C           WDIFFI    IFEQ 'Y'                                                           CSD015
     C           WIMDI     OREQ 'Y'                                                           CSD015
     C           WIMSI     OREQ 'Y'                                                           CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      ** If record previously existed then allocate the record via the                        CSE028
      ** update index                                                                         CSE028
     C           *IN89     IFEQ '0'                                                           CSE028
     C                     EXSR SRALOC                                                        CSE028
      *                                                                                       CSE028
      ** If record on file and allocated then move screen values to                           CSE028
      ** file fields and update record;                                                       CSE028
      ** (else screen will be redisplayed)                                                    CSE028
     C           *IN80     IFEQ '0'                                                           CSE028
     C           *IN81     ANDEQ'0'                                                           CSE028
     C                     EXSR SRSTOF                                                        CSE028
     C                     UPDATUPDIDX                 88                                     CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      ** Else (record does not already exist) move screen fields to                           CSE028
      ** file fields; write new record.                                                       CSE028
     C                     ELSE                                                               CSE028
     C                     EXSR SRSTOF                                                        CSE028
     C                     WRITEUPDIDX                 88                                     CSE028
     C                     ENDIF                                                              CSE028
     C                     ENDIF                                                              CSE028
      *
      ** Reset override indicators
     C                     MOVE *BLANK    OVER2   1
     C                     MOVE *BLANK    OVER3   1
     C                     MOVE *BLANK    OVER6   1
     C                     MOVE *BLANK    OVER7   1
     C                     MOVE *BLANK    OVER8   1
     C                     MOVE *BLANK    OVER9   1
      *
     C                     ENDSR
      *
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRCWV1    - Validate if watch list field has been entered.   *                       CSD015
      *                                                               *                       CSD015
      *  Calls     - None.                                            *                       CSD015
      *  Called By - SRINS, SAMD                                      *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRCWV1    BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       WDIFFI  1                                           CSD015
     C                     MOVEL'N'       WIMDI   1                                           CSD015
     C                     MOVEL'N'       WIMSI   1                                           CSD015
     C                     MOVEA*BLANKS   WLF,1                                               CSD015
     C                     MOVEA*BLANKS   MMD,1                                               CSD015
     C                     MOVEA*BLANKS   MSA,1                                               CSD015
      *                                                                                       CSD015
     C           WWAFPN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWAFPN    WLF,1                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWAWIN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWAWIN    WLF,2                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBOFN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWBOFN    WLF,3                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWIPYN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWIPYN    WLF,4                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWCTYN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWCTYN    WLF,5                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWSKAN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWSKAN    WLF,6                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           SDCTL     IFNE *BLANKS                                                       CSD015
     C                     MOVELSDCTL     WLF,7                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWRSSN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWRSSN    WLF,8                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWDSSN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWDSSN    WLF,9                                               CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBSSN    IFNE *BLANKS                                                       CSD015
     C                     MOVELWWBSSN    WLF,10                                              CSD015
     C                     MOVEL'Y'       WDIFFI                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C********** WWINVE    IFNE *BLANKS                                                CSD015 CSW210
     C**********           MOVELWWINVE    WLF,11                                       CSD015 CSW210
     C**********           MOVEL'Y'       WDIFFI                                       CSD015 CSW210
     C**********           ENDIF                                                       CSD015 CSW210
      *                                                                                       CSW210
     C           WDIDN     IFNE *BLANKS                                                       CSW210
     C                     MOVELWDIDN     WLF,12                                              CSW210
     C                     MOVEL'Y'       WDIFFI                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           PQFIN     IFNE *BLANKS                                                       CSW210
     C                     MOVELPQFIN     WLF,13                                              CSW210
     C                     MOVEL'Y'       WDIFFI                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSD015
      **  Settlement Party Intermediary                                                       CSD015
      *                                                                                       CSD015
     C           PIMMD1    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD1    MMD,1                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD2    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD2    MMD,2                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD3    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD3    MMD,3                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD4    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD4    MMD,4                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD5    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD5    MMD,5                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD6    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD6    MMD,6                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD7    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD7    MMD,7                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD8    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD8    MMD,8                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD9    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMMD9    MMD,9                                               CSD015
     C                     MOVEL'Y'       WIMDI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      **  Safekeeping Account Intermediary                                                    CSD015
      *                                                                                       CSD015
     C           PIMSA1    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA1    MSA,1                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA2    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA2    MSA,2                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA3    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA3    MSA,3                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA4    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA4    MSA,4                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA5    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA5    MSA,5                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA6    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA6    MSA,6                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA7    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA7    MSA,7                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA8    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA8    MSA,8                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA9    IFNE *BLANKS                                                       CSD015
     C                     MOVELPIMSA9    MSA,9                                               CSD015
     C                     MOVEL'Y'       WIMSI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************
      /TITLE SR/SRAMD
      *****************************************************************
      *                                                               *
      * SRAMD - Routine to handle 'AMEND' action                      *
      *                                                               *
      *****************************************************************
      *
     C           SRAMD     BEGSR
      *
      ** Check whether record exists
     C           KEY001    CHAINRTVIDX               89
     C/COPY WNCPYSRC,SE1808C010
      *
      ** If record not found then treat as insert because screen not
      ** mandatory (displayed by pressing F14)
     C           *IN89     IFEQ '1'
     C                     EXSR SRINS
     C                     ELSE
      *
      ** Else, record found, set file fields to screen fields
     C                     EXSR SRFTOS
      *
      ** Handle screens until F3, F5 or F12 taken
      ** or until no errors but not rolldown
     C           *INKC     DOUEQ'1'
     C           *INKE     OREQ '1'
     C           *INKL     OREQ '1'
     C           *IN75     OREQ '0'
     C           *IN86     ANDEQ'0'
      *
      ** If there are no errors on the second screen or if Rolldown
      ** taken then display the first screen; reset the Rolldown Ind.
     C           *IN92     IFEQ '0'
     C           *IN86     OREQ '1'
     C                     EXSR SRSCR1
     C                     MOVE '0'       *IN86
     C                     END
      *
      ** If F3, F5, F12 and Rolldown not taken continue
      ** (else repeat 'do until').
     C           *INKC     IFEQ '0'
     C           *INKE     ANDEQ'0'
     C           *INKL     ANDEQ'0'
     C           *IN86     ANDEQ'0'
      *
      ** If there are errors on the second screen or if Rollup taken
      ** then display the second screen; reset screen 2 error indicator
     C           *IN92     IFEQ '1'
     C           *IN85     OREQ '1'
     C/COPY WNCPYSRC,SE1808C011
      *                                                                                       CSE028
      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C           KEY001    CHAINDPTMVDY1             83                                       CSE028
      *                                                                                       CSE028
     C           *IN83     IFEQ *OFF                                                          CSE028
     C           CSE029    ANDEQ'Y'                                                           CSE028
     C                     MOVE *ON       *IN84                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     EXSR SRSCR2
     C/COPY WNCPYSRC,SE1808C012
      *                                                                                       201409
     C                     MOVEL*BLANKS   PRTCD                                               201409
      *                                                                                       CSE028
      ** If Rollup was taken on second screen, call SE001810                                  CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C           *IN84     ANDEQ*ON                                                           CSE028
      *                                                                                       CSE028
     C                     CALL 'SE001810'                                                    CSE028
     C                     PARM           PACTN                                               CSE028
     C                     PARM           DSINTM                                              CSE028
     C                     PARM           DSSAFE                                              CSE028
     C                     PARM           PPSET                                               CSE028
     C                     PARM           PNARR                                               CSE028
     C                     PARM           PRTCD                                               CSE028
     C                     PARM           PRDET                                               CSW210
     C                     PARM           SINVE  10                                           CSW210
     C                     PARM           PQFIN  10                                           CSW210
     C                     PARM           PPCLR  10                                           CSW210
      *                                                                                       CSE028
      ** Check Return Code                                                                    CSE028
      *                                                                                       CSE028
     C********** PRTCD     IFEQ 'F3'                                                   CSE028 201409
     C           PRTCD     IFEQ 'SE10000'                                                     201409
     C                     MOVE *ON       *INKC                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C********** PRTCD     IFEQ 'F12'                                                  CSE028 201409
     C           PRTCD     IFEQ 'SE10001'                                                     201409
     C           PRTCD     OREQ 'ROLL'                                                        CSE028
     C           PRTCD     OREQ *BLANKS                                                       CSE028
     C                     MOVE *OFF      *IN84                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       201409
      ** If Rolldown taken, then redisplay previous screen.                                   201409
     C           PRTCD     IFEQ 'SE10029'                                                     201409
     C                     MOVE *ON       *IN92                                               201409
     C                     MOVE *ON       *IN75                                               201409
     C                     ENDIF                                                              201409
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           PRTCD     IFNE 'SE10029'                                                     201409
     C                     MOVE '0'       *IN92
     C                     ENDIF                                                              201409
     C                     END
      *
      ** Clear messages for redisplay
     C                     CALL 'ZA0250'
      *
      ** Validate input, only if F3, F5, F12 and Rolldown not taken
     C           *INKC     IFEQ '0'
     C           *INKE     ANDEQ'0'
     C           *INKL     ANDEQ'0'
     C           *IN86     ANDEQ'0'
     C           *IN84     ANDEQ'0'                                                           201409
     C           *IN92     ANDEQ'0'                                                           201409
     C                     EXSR SRVAL
      *
      ** If no errors on validation allocate record via update index
     C           *IN75     IFEQ '0'
     C                     EXSR SRALOC
      *
      ** If record on file and allocated then move screen values to
      ** file fields and update record.
     C           *IN80     IFEQ '0'
     C           *IN81     ANDEQ'0'
      *                                                                                       CSD015
      ** Call  SRFMT if watch list checking is apllied.                                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If 24X7 is not installed or the suport system is off.                                CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE *OFF      *IN12                                               CSD015
      *                                                                                       CSD015
     C                     MOVEL'DPTMVD ' WFUNT                                               CSD015
     C                     MOVELPDPRN     WIDEN                                               CSD015
     C                     MOVELPDPBA     WBRCH                                               CSD015
     C           CWHTKY    CHAINSDCWHTL1             12                                       CSD015
      *                                                                                       CSD015
     C           *IN12     IFEQ *OFF                                                          CSD015
     C           W3HSTS    ANDEQ*BLANKS                                                       CSD015
     C           W3UNCF    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV1                                                        CSD015
     C                     EXSR SRFMT                                                         CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C                     EXSR SRCWV2                                                        CSD015
      *                                                                                       CSD015
     C           WDIFFA    IFEQ 'Y'                                                           CSD015
     C           WIMDA     OREQ 'Y'                                                           CSD015
     C           WIMSA     OREQ 'Y'                                                           CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     EXSR SRSTOF
     C                     UPDATUPDIDX                 88
     C                     END
     C/COPY WNCPYSRC,SE1808C013
      *
     C                     END
      *
     C                     END
      *
      ** If F12 taken from second screen then set Rolldown Ind (*IN86);
      ** set F12 off; and reset fields on 2nd screen.
     C           *INKL     IFEQ '1'
     C                     MOVE '1'       *IN86
     C                     MOVE '0'       *INKL
     C                     EXSR SRRTS2
     C/COPY WNCPYSRC,SE1808C014
     C                     END
      *
     C                     END
      *
     C                     END
      *
     C                     END
      *
      ** Reset override indicators
     C                     MOVE *BLANK    OVER2
     C                     MOVE *BLANK    OVER3
     C                     MOVE *BLANK    OVER6
     C                     MOVE *BLANK    OVER7
     C                     MOVE *BLANK    OVER8
     C                     MOVE *BLANK    OVER9
      *
     C                     ENDSR
      *
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRCWV2    - Validate if watch list field has been changed.   *                       CSD015
      *                                                               *                       CSD015
      *  Calls     - None.                                            *                       CSD015
      *  Called By - SRAMD                                            *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRCWV2    BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       WDIFFA  1                                           CSD015
     C                     MOVEL'N'       WIMDA   1                                           CSD015
     C                     MOVEL'N'       WIMSA   1                                           CSD015
     C                     MOVEA*BLANKS   WLF,1                                               CSD015
     C                     MOVEA*BLANKS   MMD,1                                               CSD015
     C                     MOVEA*BLANKS   MSA,1                                               CSD015
      *                                                                                       CSD015
     C           WWAFPN    IFNE D2AFPN                                                        CSD015
     C                     MOVELWWAFPN    WLF,1                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWAWIN    IFNE D2AWIN                                                        CSD015
     C                     MOVELWWAWIN    WLF,2                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBOFN    IFNE D2BOFN                                                        CSD015
     C                     MOVELWWBOFN    WLF,3                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWIPYN    IFNE D2IPYN                                                        CSD015
     C                     MOVELWWIPYN    WLF,4                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWCTYN    IFNE D2CTYN                                                        CSD015
     C                     MOVELWWCTYN    WLF,5                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWSKAN    IFNE D2SKAN                                                        CSD015
     C                     MOVELWWSKAN    WLF,6                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           SDCTL     IFNE D2DCTL                                                        CSD015
     C                     MOVELSDCTL     WLF,7                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWRSSN    IFNE D2RSSN                                                        CSD015
     C                     MOVELWWRSSN    WLF,8                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWDSSN    IFNE D2DSSN                                                        CSD015
     C                     MOVELWWDSSN    WLF,9                                               CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           WWBSSN    IFNE D2BSSN                                                        CSD015
     C                     MOVELWWBSSN    WLF,10                                              CSD015
     C                     MOVEL'Y'       WDIFFA                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C********** WWINVE    IFNE D2INVE                                                 CSD015 CSW210
     C**********           MOVELWWINVE    WLF,11                                       CSD015 CSW210
     C**********           MOVEL'Y'       WDIFFA                                       CSD015 CSW210
     C**********           ENDIF                                                       CSD015 CSW210
      *                                                                                       CSW210
     C           WDIDN     IFNE D2DIDN                                                        CSW210
     C                     MOVELWDIDN     WLF,12                                              CSW210
     C                     MOVEL'Y'       WDIFFA                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           PQFIN     IFNE D2QFIN                                                        CSW210
     C                     MOVELPQFIN     WLF,13                                              CSW210
     C                     MOVEL'Y'       WDIFFA                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSD015
      **  Settlement Party Intermediary                                                       CSD015
      *                                                                                       CSD015
     C           PIMMD1    IFNE D2IMD1                                                        CSD015
     C                     MOVELPIMMD1    MMD,1                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD2    IFNE D2IMD2                                                        CSD015
     C                     MOVELPIMMD2    MMD,2                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD3    IFNE D2IMD3                                                        CSD015
     C                     MOVELPIMMD3    MMD,3                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD4    IFNE D2IMD4                                                        CSD015
     C                     MOVELPIMMD4    MMD,4                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD5    IFNE D2IMD5                                                        CSD015
     C                     MOVELPIMMD5    MMD,5                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD6    IFNE D2IMD6                                                        CSD015
     C                     MOVELPIMMD6    MMD,6                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD7    IFNE D2IMD7                                                        CSD015
     C                     MOVELPIMMD7    MMD,7                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD8    IFNE D2IMD8                                                        CSD015
     C                     MOVELPIMMD8    MMD,8                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMMD9    IFNE D2IMD9                                                        CSD015
     C                     MOVELPIMMD9    MMD,9                                               CSD015
     C                     MOVEL'Y'       WIMDA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      **  Safekeeping Account Intermediary                                                    CSD015
      *                                                                                       CSD015
     C           PIMSA1    IFNE D2IMS1                                                        CSD015
     C                     MOVELPIMSA1    MSA,1                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA2    IFNE D2IMS2                                                        CSD015
     C                     MOVELPIMSA2    MSA,2                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA3    IFNE D2IMS3                                                        CSD015
     C                     MOVELPIMSA3    MSA,3                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA4    IFNE D2IMS4                                                        CSD015
     C                     MOVELPIMSA4    MSA,4                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA5    IFNE D2IMS5                                                        CSD015
     C                     MOVELPIMSA5    MSA,5                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA6    IFNE D2IMS6                                                        CSD015
     C                     MOVELPIMSA6    MSA,6                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA7    IFNE D2IMS7                                                        CSD015
     C                     MOVELPIMSA7    MSA,7                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA8    IFNE D2IMS8                                                        CSD015
     C                     MOVELPIMSA8    MSA,8                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PIMSA9    IFNE D2IMS9                                                        CSD015
     C                     MOVELPIMSA9    MSA,9                                               CSD015
     C                     MOVEL'Y'       WIMSA                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRFMT     - Format watch list fields                         *                       CSD015
      *                                                               *                       CSD015
      *  Calls     - None.                                            *                       CSD015
      *  Called By - SRINS, SRAMD                                     *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRFMT     BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     CLEARPMCWL                                                         CSD015
     C                     Z-ADD0         WID     20                                          CSD015
      *                                                                                       CSD015
     C********** WID       DOUEQ11                                                     CSD015 CSW210
     C           WID       DOUEQ13                                                            CSW210
     C                     ADD  1         WID                                                 CSD015
     C                     MOVELWLF,WID   PINP1                                               CSD015
      *                                                                                       CSD015
     C           WLF,WID   IFNE *BLANKS                                                       CSD015
     C           WLF,WID   ANDNE*ZERO                                                         CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD   7                                           CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM *BLANKS   PINP2  35                                           CSD015
     C                     PARM *BLANKS   PINP3  35                                           CSD015
     C                     PARM *BLANKS   PINP4  35                                           CSD015
     C                     PARM *BLANKS   PINP5  35                                           CSD015
     C                     PARM *BLANKS   PINP6  35                                           CSD015
     C                     PARM           PCCY    3                                           CSD015
     C                     PARM           POUT  216                                           CSD015
     C                     PARM           PCNUM   6                                           CSD015
      *                                                                                       CSD015
     C           WID       MULT 2         CLS     20                                          CSD015
     C           CLS       SUB  1         OPN     20                                          CSD015
      *                                                                                       CSD015
     C                     MOVELCWA,OPN   WOPN   25                                           CSD015
     C                     MOVELCWA,CLS   WCLS   25                                           CSD015
      *                                                                                       CSD015
     C           PMCWL     CAT  WOPN:0    PMCWL                                               CSD015
     C                     CAT  POUT:0    PMCWL                                               CSD015
      *                                                                                       CSD015
     C                     SELEC                                                              CSD015
     C           WID       WHEQ 1                                                             CSD015
     C                     CAT  SAFPL:0   PMCWL                                               CSD015
     C           WID       WHEQ 2                                                             CSD015
     C                     CAT  SAWIL:0   PMCWL                                               CSD015
     C           WID       WHEQ 3                                                             CSD015
     C                     CAT  SBOF1:0   PMCWL                                               CSD015
     C                     CAT  SBOF2:0   PMCWL                                               CSD015
     C           WID       WHEQ 4                                                             CSD015
     C                     CAT  SIPYL:0   PMCWL                                               CSD015
     C           WID       WHEQ 5                                                             CSD015
     C                     CAT  SCTYL:0   PMCWL                                               CSD015
     C           WID       WHEQ 6                                                             CSD015
     C                     CAT  SSKAL:0   PMCWL                                               CSD015
     C           WID       WHEQ 12                                                            CSW210
     C                     CAT  SDIDN:0   PMCWL                                               CSW210
     C           WID       WHEQ 13                                                            CSW210
     C                     CAT  PQFIN:0   PMCWL                                               CSW210
     C                     ENDSL                                                              CSD015
      *                                                                                       CSD015
     C                     CAT  WCLS:0    PMCWL                                               CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
      ** Add the Settlement Party Intermediary                                                CSD015
      *                                                                                       CSD015
     C           WIMDI     IFEQ 'Y'                                                           CSD015
     C           WIMDA     OREQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     CLEARTEMPDS                                                        CSD015
     C                     Z-ADD0         WID     20                                          CSD015
      *                                                                                       CSD015
     C           WID       DOUEQ9                                                             CSD015
     C                     ADD  1         WID                                                 CSD015
     C                     MOVELMMD,WID   PINP1                                               CSD015
      *                                                                                       CSD015
     C           MMD,WID   IFNE *BLANKS                                                       CSD015
     C           MMD,WID   ANDNE'000000'                                                      CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD   7                                           CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM *BLANKS   PINP2  35                                           CSD015
     C                     PARM *BLANKS   PINP3  35                                           CSD015
     C                     PARM *BLANKS   PINP4  35                                           CSD015
     C                     PARM *BLANKS   PINP5  35                                           CSD015
     C                     PARM *BLANKS   PINP6  35                                           CSD015
     C                     PARM           PCCY    3                                           CSD015
     C                     PARM           POUT  216                                           CSD015
     C                     PARM           PCNUM   6                                           CSD015
      *                                                                                       CSD015
     C                     CAT  POUT:0    TEMPDS                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
     C           TEMPDS    IFNE *BLANKS                                                       CSD015
     C**********           CAT  CWA,23:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,27:0  PMCWL                                               CSW210
     C                     CAT  TEMPDS:0  PMCWL                                               CSD015
     C**********           CAT  CWA,24:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,28:0  PMCWL                                               CSW210
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Add the Safekeeping Account Intermediary                                             CSD015
      *                                                                                       CSD015
     C           WIMSI     IFEQ 'Y'                                                           CSD015
     C           WIMSA     OREQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     CLEARTEMPDS                                                        CSD015
     C                     Z-ADD0         WID     20                                          CSD015
      *                                                                                       CSD015
     C           WID       DOUEQ9                                                             CSD015
     C                     ADD  1         WID                                                 CSD015
     C                     MOVELMSA,WID   PINP1                                               CSD015
      *                                                                                       CSD015
     C           MSA,WID   IFNE *BLANKS                                                       CSD015
     C           MSA,WID   ANDNE'000000'                                                      CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD   7                                           CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM *BLANKS   PINP2  35                                           CSD015
     C                     PARM *BLANKS   PINP3  35                                           CSD015
     C                     PARM *BLANKS   PINP4  35                                           CSD015
     C                     PARM *BLANKS   PINP5  35                                           CSD015
     C                     PARM *BLANKS   PINP6  35                                           CSD015
     C                     PARM           PCCY    3                                           CSD015
     C                     PARM           POUT  216                                           CSD015
     C                     PARM           PCNUM   6                                           CSD015
      *                                                                                       CSD015
     C                     CAT  POUT:0    TEMPDS                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
     C           TEMPDS    IFNE *BLANKS                                                       CSD015
     C**********           CAT  CWA,25:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,29:0  PMCWL                                               CSW210
     C                     CAT  TEMPDS:0  PMCWL                                               CSD015
     C**********           CAT  CWA,26:0  PMCWL                                        CSD015 CSW210
     C                     CAT  CWA,30:0  PMCWL                                               CSW210
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************
      /TITLE SR/SRENQ
      *****************************************************************
      *                                                               *
      * SRENQ - Routine to handle 'ENQUIRY' action                    *
      *                                                               *
      *****************************************************************
      *
     C           SRENQ     BEGSR
      *
      ** Set indicators to protect fields
     C                     MOVE '1'       *IN09
     C                     MOVE '1'       *IN10
     C                     MOVE '1'       *IN11                                               201409
      *
      ** Check whether record exists
     C           KEY001    CHAINRTVIDX               89
     C/COPY WNCPYSRC,SE1808C015
      *
      ** If record found then set file fields to screen fields
     C           *IN89     IFEQ '0'
     C                     EXSR SRFTOS
      *
      ** Redisplay first screen until rolldown on 2nd screen NOT taken
      ** or F3 (to End) or F5 (to Refresh) taken
     C           *IN86     DOUEQ'0'
     C           *IN75     ANDEQ'0'                                                           201409
     C           *INKC     OREQ '1'
     C           *INKE     OREQ '1'
     C           *INKL     OREQ '1'                                                           201409
      *                                                                                       201409
     C           *IN75     IFEQ '0'                                                           201409
     C           *IN86     OREQ '1'                                                           201409
      *                                                                                       201409
     C                     MOVE '0'       *IN86
      *
      ** Display first screen; if rollup taken display second screen;
     C                     EXSR SRSCR1
     C                     ENDIF                                                              201409
      *                                                                                       201409
      ** If F3, F5, F12 and Rolldown not taken continue                                       201409
      ** (else repeat 'do until').                                                            201409
     C           *INKC     IFEQ '0'                                                           201409
     C           *INKE     ANDEQ'0'                                                           201409
     C           *INKL     ANDEQ'0'                                                           201409
     C           *IN86     ANDEQ'0'                                                           201409
      *                                                                                       201409
     C           *IN85     IFEQ '1'
     C/COPY WNCPYSRC,SE1808C016
      *                                                                                       CSE028
      ** If ISO15022 is equal to 'Y', enable Rollup key                                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C           KEY001    CHAINDPTMVDY1             83                                       CSE028
      *                                                                                       CSE028
     C           *IN83     IFEQ *OFF                                                          CSE028
     C           CSE029    ANDEQ'Y'                                                           CSE028
     C                     MOVE *ON       *IN84                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     EXSR SRSCR2
      *                                                                                       201409
     C                     MOVEL*BLANKS   PRTCD                                               201409
      *                                                                                       CSE028
      ** If Rollup was taken on second screen, call SE001810                                  CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C           *IN84     ANDEQ*ON                                                           CSE028
      *                                                                                       CSE028
     C                     CALL 'SE001810'                                                    CSE028
     C                     PARM           PACTN                                               CSE028
     C                     PARM           DSINTM                                              CSE028
     C                     PARM           DSSAFE                                              CSE028
     C                     PARM           PPSET                                               CSE028
     C                     PARM           PNARR                                               CSE028
     C                     PARM           PRTCD                                               CSE028
     C                     PARM           PRDET                                               CSW210
     C                     PARM           SINVE                                               CSW210
     C                     PARM           PQFIN                                               CSW210
     C                     PARM           PPCLR                                               CSW210
      *                                                                                       CSE028
      ** Check Return Code                                                                    CSE028
      *                                                                                       CSE028
     C********** PRTCD     IFEQ 'F3'                                                   CSE028 201409
     C           PRTCD     IFEQ 'SE10000'                                                     201409
     C                     MOVE *ON       *INKC                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C********** PRTCD     IFEQ 'F12'                                                  CSE028 201409
     C           PRTCD     IFEQ 'SE10001'                                                     201409
     C           PRTCD     OREQ 'ROLL'                                                        CSE028
     C           PRTCD     OREQ *BLANKS                                                       CSE028
     C                     MOVE *OFF      *IN84                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       201409
      ** If Rolldown taken, then redisplay previous screen.                                   201409
     C           PRTCD     IFEQ 'SE10029'                                                     201409
     C                     MOVE *ON       *IN75                                               201409
     C                     ENDIF                                                              201409
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C/COPY WNCPYSRC,SE1808C017
     C           PRTCD     IFNE 'SE10029'                                                     201409
     C                     MOVE *OFF      *IN75                                               201409
     C                     ENDIF                                                              201409
     C                     END
     C                     ENDIF                                                              201409
      *                                                                                       201409
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C018
      *****************************************************************
      /TITLE SR/SRSMSG
      *****************************************************************
      *                                                               *
      * SRSMSG - Routine to send messages to message subfile.         *
      *                                                               *
      *****************************************************************
      *
     C           SRSMSG    BEGSR
      *
      ** Send specified message from specified message file to program
      ** message queue; then clear message id and message file
     C                     CALL 'ZA0340'
     C***********          PARM           ZAMSGF 10
     C                     PARM 'SEUSRMSG'ZAMSGF 10                       CSW098
     C                     PARM           ZAMSID 10
      *
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSID
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRALOC
      *****************************************************************
      *                                                               *
      * SRALOC - Routine to access record via update index            *
      *                                                               *
      *****************************************************************
      *
     C           SRALOC    BEGSR
      *
     C           KEY001    CHAINUPDIDX               8081
      *
      ** If record not on file, setup message 'Record deleted'
     C           *IN80     IFEQ '1'
     C                     MOVEL'SEW9998' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C019
      *****************************************************************
      /TITLE SR/SRRTRN
      *****************************************************************
      *                                                               *
      * SRRTRN - Routine to set up return code for calling program    *
      *                                                               *
      *****************************************************************
      *
     C           SRRTRN    BEGSR
      *
     C                     MOVE 'N'       PERR
     C                     MOVE '00'      PCMD
      *
      ** If error on updating file set Return Error Code to 'U'
     C           *IN88     IFEQ '1'
     C                     MOVE 'U'       PERR
     C                     ELSE
      *
      ** If Rolldown or F12 (for Previous) set Return Command to '12'
     C           *IN87     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     MOVE '12'      PCMD
     C                     ELSE
      *
      ** If no record retrieved for enquiry set Return Err Comm to 'R'
     C           PACTN     IFEQ 'E'
     C           *IN89     ANDEQ'1'
     C                     MOVE 'R'       PERR
     C                     ELSE
      *
      ** If F3 (to End) taken set Return Command to '03'
     C           *INKC     IFEQ '1'
     C                     MOVE '03'      PCMD
     C                     ELSE
      *
      ** If F5 (to Refresh) set Return Command to '05'
     C           *INKE     IFEQ '1'
     C                     MOVE '05'      PCMD
     C                     ELSE
      *
      ** If F14 (to Exit Extended Settlements) set Return Comm to '14'
     C           *INKN     IFEQ '1'
     C                     MOVE '14'      PCMD
     C                     END
      *
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,SE1808C020
      *
      ** Seton *INLR to exit program
     C                     MOVE '1'       *INLR
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSCR1
      *****************************************************************
      *                                                               *
      * SRSCR1 - Routine to handle first screen                       *
      *                                                               *
      *****************************************************************
      *
     C           SRSCR1    BEGSR
      *
      ** Display message format; display first screen
     C                     WRITESE1808C1
     C                     EXFMTSE1808F1
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSCR2
      *****************************************************************
      *                                                               *
      * SRSCR2 - Routine to handle second screen                      *
      *                                                               *
      *****************************************************************
      *
     C           SRSCR2    BEGSR
      *
      ** Display message format; display second screen
     C                     WRITESE1808C1
     C                     EXFMTSE1808F2
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C021
      *****************************************************************
      /TITLE SR/SRVAL
      *****************************************************************
      *                                                               *
      * SRVAL - Routine to control validation of each field.          *
      *                                                               *
      *****************************************************************
      *
     C           SRVAL     BEGSR
      *
      ** Initialize error condition indicators
     C                     MOVE '0'       *IN75
     C                     MOVE '0'       *IN92
      *
     C                     SETOF                     232425
     C                     SETOF                     262728
     C                     SETOF                     293031
     C                     SETOF                     323334
     C                     SETOF                     353637
     C                     SETOF                     383940
     C                     SETOF                     414243
     C                     SETOF                     444546
     C                     SETOF                       4950
     C                     SETOF                     515253
     C                     SETOF                     545556
     C                     SETOF                     575859
     C                     SETOF                     606162
     C                     SETOF                     636465
     C                     SETOF                     666768
     C                     SETOF                     939495                                   CSW210
     C                     SETOF                     969798                                   CSW210
     C/COPY WNCPYSRC,SE1808C022
     C                     MOVE *OFF      *IN19                           CSW098
      *
      ** Reset validations by F19
     C           *INKT     IFEQ '1'
     C                     MOVE *BLANK    OVER2
     C                     MOVE *BLANK    OVER3
     C                     MOVE *BLANK    OVER6
     C                     MOVE *BLANK    OVER7
     C                     MOVE *BLANK    OVER8
     C                     MOVE *BLANK    OVER9
     C                     END
      *
      ** Validate Account For Payment fields
     C                     EXSR SRAFPN
     C                     EXSR SRAFPL
      *
      ** Validate Account With Institution fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRAWIA
     C                     ENDIF                                                              212937
     C                     EXSR SRAWIN
      *                                                                                       199797
     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
     C********** CSE028    OREQ 'N'                                                    199797 CSW210
     C                     EXSR SRAWIL
     C**********           ENDIF                                                       199797 CSW210
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
      *                                                                                       CSW210
      ** Validate Validate Debtor (Identification)                                            CSW210
     C                     EXSR SRDIDN                                                        CSW210
      *                                                                                       CSW210
      ** Validate Validate Debtor (Address)                                                   CSW210
     C                     EXSR SRDADD                                                        CSW210
      *                                                                                       CSW210
      ** Validate Validate Debtor (Account Line)                                              CSW210
     C                     EXSR SRDLIN                                                        CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *
      ** Validate Beneficiary of Money fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRBOFA
     C                     ENDIF                                                              212937
     C                     EXSR SRBOFN
     C********** PSNEW     IFNE 'Y'                                                    199797 CSW210
     C********** CSE028    OREQ 'N'                                                    199797 CSW210
     C                     EXSR SRBOF1
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    OREQ 'N'                                                           CSW210
     C           CSW210    IFEQ 'N'                                                           CSW210
     C                     EXSR SRBOF2
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              199797
      *
      ***Validate*Account*For*Charges*fields*********************         CSW003
     C************         EXSR SRACL1                                    CSW003
     C************         EXSR SRACL2                                    CSW003
      *
      ** Validate Sender to Receiver Information
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRSRL1
     C                     EXSR SRSRL2
     C                     EXSR SRSRL3
     C                     ENDIF                                                              199797
      *
      ** Validate Further Information field
     C/COPY WNCPYSRC,SE1808C023
     C                     EXSR SRFIN1
     C                     EXSR SRFIN2
     C/COPY WNCPYSRC,SE1808C024
      *
      ** Validate Registration Details field
     C/COPY WNCPYSRC,SE1808C025
     C**********           EXSR SRRED1                                                        CSW210
     C**********           EXSR SRRED2                                                        CSW210
     C/COPY WNCPYSRC,SE1808C026
      *
      ** Validate Narrative field
     C                     EXSR SRNAL1
     C                     EXSR SRNAL2
      *                                                                   CSW098
      ** If ccy clearing code entered for a/c w/ bank or beneficiary,     CSW098
      ** check whether Issuer Code has been defined for the currency      CSW098
      ** clearing system and output warning message if not defined.       CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C           *IN75     ANDEQ*OFF                                      CSW098
     C           IAWBK     IFEQ 'Y'                                       CSW098
     C                     MOVE *ON       *IN75                           CSW098
     C                     MOVE *ON       *IN27                           CSW098
     C                     MOVEL'SEW5176' ZAMSID                          CSW098
     C                     EXSR SRSMSG                                    CSW098
     C                     MOVEL*BLANKS   IAWBK                           CSW098
     C                     ENDIF                                          CSW098
     C           IBENF     IFEQ 'Y'                                       CSW098
     C                     MOVE *ON       *IN75                           CSW098
     C                     MOVE *ON       *IN30                           CSW098
     C                     MOVEL'SEW5176' ZAMSID                          CSW098
     C                     EXSR SRSMSG                                    CSW098
     C                     MOVEL*BLANKS   IBENF                           CSW098
     C                     ENDIF                                          CSW098
     C                     ENDIF                                          CSW098
      * Issue Warning Message for BIC error                                                   CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           WWADD     IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           CFT004    IFEQ 'Y'                                                           CSW210
      * Issue Warning Message for IBAN-SAFPL error                                            CSW210
     C           WWAPL     IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      * Issue Warning Message for IBAN-SAWIL error                                            CSW210
     C           WWAWL     IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
      * Issue Warning Message for IBAN-SDLIN error                                            CSW210
     C           WWDLN     IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
      * Issue Warning Message for IBAN-SBOF1 error                                            CSW210
     C           WWBF1     IFEQ 'Y'                                                           CSW210
     C           *IN75     ANDEQ*OFF                                                          CSW210
     C                     MOVE *ON       *IN75                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *
      ** No errors found on first screen
     C           *IN75     IFEQ '0'
     C                     MOVE '1'       *IN92
     C                     END
      *
      ** Validate Instructing Party fields
      *                                                                                       207006
     C********** CSE029    IFNE 'Y'                                                    207006 209777
     C                     EXSR SRIPYN
     C**********           ELSE                                                        207006 209777
     C**********           MOVELPDPBN     WWIPYN                                       207006 209777
     C**********           ENDIF                                                       207006 209777
      *                                                                                       207006
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRIPYL
     C                     ENDIF                                                              199797
      *                                                                   CSW098
      ***Validate*Investor*********************************************                CSW098 CSW210
     C********** *IN20     IFEQ '1'                                                    199797 CSW210
     C**********           EXSR SRINVE                                                 CSW098 CSW210
     C**********           ENDIF                                                       199797 CSW210
      *
      ** Validate Counterparty fields
     C                     EXSR SRCTYN
     C                     EXSR SRCTYL
      *
      ** Validate Safekeeping Account fields
     C                     EXSR SRSKAN
      *                                                                                       201429
      ** Safekeeping A/C is mandatory if ISO15022 is 'Y'                                      201429
      ** and movement type is Walk-In/Walk-Out.                                               201429
      *                                                                                       201429
     C           *IN78     IFEQ *ON                                                           201429
     C           *IN05     ANDEQ*OFF                                                          201429
      *                                                                                       201429
     C           SSKAL     IFEQ *BLANKS                                                       201429
     C           PSAFA     ANDEQ*BLANKS                                                       201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN50                                               201429
     C                     MOVEL'SEW9004' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *                                                                                       201429
     C           SSKAL     IFNE *BLANKS                                                       201429
     C           PSAFA     ANDNE*BLANKS                                                       201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN50                                               201429
     C                     MOVEL'SEW9007' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *                                                                                       201429
     C                     ENDIF                                                              201429
      *                                                                                       201429
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRSKAL
     C                     ENDIF                                                              199797
      *
      ** Validate Clearing Correspondent fields
     C           *IN06     IFEQ '0'                                                           204364
     C                     EXSR SRCCTN
     C                     ENDIF                                                              204364
      *
      ** Validate Deliverer's Instructing Party field
     C/COPY WNCPYSRC,SE1808C027
      *                                                                                       201429
      ** Deliverer Instruction Party is mandatory if ISO15022 is 'Y'                          201429
      ** and movement type is Walk-In.                                                        201429
      *                                                                                       201429
     C           PSNEW     IFEQ 'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C           CSE028    ANDEQ'Y'                                                           201429
     C           PDPMV     ANDEQ'WI'                                                          201429
     C           SDCTL     ANDEQ*BLANKS                                                       201429
     C********** PDPBN     IFNE 0                                                      204589 CSD027
     C           PDPBN     IFNE *BLANKS                                                       CSD027
     C                     MOVE PDPBN     SDCTL                                               204589
     C                     ELSE                                                               204589
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN52                                               201429
     C                     MOVEL'SEW9002' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              204589
     C                     ENDIF                                                              201429
      *                                                                                       201429
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRDCTL
     C                     ENDIF                                                              199797
     C/COPY WNCPYSRC,SE1808C028
      *
      ** Validate Receiver of Securities fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRRSSA
     C                     ENDIF                                                              212937
     C                     EXSR SRRSSN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRRSS1
     C                     EXSR SRRSS2
     C                     EXSR SRRSS3
     C                     EXSR SRRSS4
     C                     ENDIF                                                              199797
      *
      ** Validate Deliverer of Securities fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRDSSA
     C                     ENDIF                                                              212937
     C                     EXSR SRDSSN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRDSS1
     C                     EXSR SRDSS2
     C                     EXSR SRDSS3
     C                     EXSR SRDSS4
     C                     ENDIF                                                              199797
     C/COPY WNCPYSRC,SE1808C036
      *
      ** Validate Beneficiary of Securities fields
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     EXSR SRBSSA
     C                     ENDIF                                                              212937
     C                     EXSR SRBSSN
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
     C                     EXSR SRBSS1
     C                     EXSR SRBSS2
     C                     ENDIF                                                              199797
      *
      ** No errors found on second screen
     C           *IN75     IFEQ '0'
     C                     MOVE '0'       *IN92
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRAFPN
      *****************************************************************
      *                                                               *
      **  SRAFPN    - VALIDATE A/C FOR PAYMENT :53:                   *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRAFPN    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SAFPN     IFNE *BLANKS
      *
      ** ACCOUNT FOR PAYMENT MUST BE LEFT BLANK FOR CLEARANCE 1 TO 4
     C           WWCLTY    IFEQ '14'
     C           PSNEW     IFNE 'Y'                                                           212937
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN23
     C                     MOVEL'SEW5216' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     ENDIF                                                              212937
      *
     C                     ELSE
      ** ACCOUNT FOR PAYMENT MUST BE LEFT BLANK FOR INSTRUCTIONS FREE
     C           WWINST    IFEQ 'RECFREE'
     C           WWINST    OREQ 'DELFREE'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN23
     C                     MOVEL'SEW5217' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
      ** SET ERROR INDICATOR ON THIS FIELD BEFORE VALIDATION.
     C           *IN23     IFEQ '0'
     C                     MOVE '1'       *IN23
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SAFPN     WWCUST 10
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN23
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWAFPN
     C                     END
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWAFPN
     C                     END
      *
     C                     ELSE
      *
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWAFPN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRAFPL
      *****************************************************************
      *                                                               *
      **  SRAFPL    - VALIDATE A/C FOR PAYMENT A/C LINE :53:          *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRAFPL    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSAFPL     WWAFPL  1
     C                     MOVE 'N'       WFAP1                                               CSW210
     C           SAFPL     IFNE *BLANKS
     C           WWAFPL    ANDNE'#'
      *
     C           WWCLTY    IFEQ '14'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN24
     C           SAFPN     IFEQ *BLANKS
     C           PSNEW     ANDNE'Y'                                                           212937
     C                     MOVEL'SEW5216' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** ACCOUNT FOR PAYMENT MUST BE LEFT BLANK FOR INSTRUCTIONS FREE
     C********** WWINST    IFNE 'RECFREE'                                                     CSW210
     C********** WWINST    ANDNE'DELFREE'                                                     CSW210
     C           WWINST    IFEQ 'RECFREE'                                                     CSW210
     C           WWINST    OREQ 'DELFREE'                                                     CSW210
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN24
     C           SAFPN     IFEQ *BLANKS
     C                     MOVEL'SEW5217' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
     C                     END
      *                                                                                       199797
     C           PSNEW     IFNE 'Y'                                                           199797
     C           CSE028    OREQ 'N'                                                           199797
      *
     C                     MOVELSAFPL     WWLI01  1
     C           WWLI01    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN24
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSAFPL     WWLI02  2
     C           WWLI02    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN24
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SAFPL     WWLI34 34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN24
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDIF                                                              199797
      *                                                                                       199797
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
     C                     MOVELSAFPL     DSIBAN                                              CSW210
     C                     EXSR SRIBAN                                                        CSW210
      *                                                                                       CSW210
     C                     MOVE WVIBAN    WFAP1                                               CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WWAPL                                               CSW210
     C                     MOVELWIBRTN    SAFPL                                               CSW210
     C                     ELSE                                                               CSW210
     C           WWAPL     IFNE 'N'                                                           CSW210
     C           SAFPL     ANDEQWAFPL                                                         CSW210
     C                     MOVE 'N'       WWAPL                                               CSW210
     C                     ELSE                                                               CSW210
     C  N24      SAFPL     IFNE WAFPL                                                         CSW210
     C           WIBNWR    ANDEQ'Y'                                                           CSW210
     C                     MOVELWTIBAN    SAFPL                                               CSW210
     C                     SETON                     24                                       CSW210
     C                     MOVE 'Y'       WWAPL                                               CSW210
     C                     MOVELS210W,1   ZAMDT1                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSG1                                              CSW210
     C                     EXSR SRMSG1                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSAFPL     WAFPL                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     END
      *
      ** EITHER SWIFT FIELD 53 OR (57 AND 58) CAN BE ENTERED
     C           WWREDE    IFEQ 'TS'
     C           SAFPN     ANDNE*BLANKS
     C           WWREDE    OREQ 'TS'
     C           SAFPL     ANDNE*BLANKS
      *
     C           SAWIN     IFNE *BLANKS
     C           SAWIL     ORNE *BLANKS
     C           SBOFN     ORNE *BLANKS
     C           SBOF1     ORNE *BLANKS
     C           SBOF2     ORNE *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN24
     C                     MOVEL'SEW5215' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRAWIA
      *****************************************************************
      *                                                               *
      **  SRAWIA    - VALIDATE A/C WITH INSTITUTION TAG :57:          *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRAWIA    BEGSR
      *
      ** THIS FIELD CAN ONLY BE ENTERED FOR CLEARANCE TYPE 1 TO 4      *
     C           WWCLTY    IFEQ '14'
      *
     C           SAWIA     IFNE 'A'
     C           SAWIA     ANDNE'D'
     C           SAWIA     ANDNE*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN25
     C                     MOVEL'SEW5220' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THE A/C LINES MAY NOT BE LEFT BLANK WHEN ENTERING THE TAG FIELD
     C           SAWIA     IFNE *BLANK
     C           SAWIL     ANDEQ*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN27
     C                     MOVEL'SEW5227' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** THIS FIELD MUST BE LEFT BLANK IF CLEARANCE TYPE NOT 1 TO 4    **
     C           SAWIA     IFNE *BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN25
     C                     MOVEL'SEW5221' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRAWIN
      *****************************************************************
      *                                                               *
      **  SRAWIN    - VALIDATE A/C WITH INSTITUTION :57:              *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST, SRSMSG                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRAWIN    BEGSR
      *                                                                   CSW098
     C                     MOVEL*BLANKS   WAWIN                           CSW098
      *
      ** VALIDATE IF NOT BLANK
     C           SAWIN     IFNE *BLANKS
      *
      ** TAG FIELD MUST BE LEFT BLANK
     C           SAWIA     IFNE *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN26
     C                     MOVEL'SEW5228' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     ELSE
      *
      ** SET ERROR INDICATOR ON THIS FIELD BEFORE VALIDATION
     C                     MOVE '1'       *IN26
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SAWIN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN26
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
      *
      ** A/C MUST BE A BANK
     C           WWBNBI    IFNE 'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN26
     C                     MOVEL'SEW5225' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     ELSE
     C                     MOVELBBCUST    WWAWIN
     C                     END
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWAWIN
     C                     END
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVELWWAWIN    WAWIN                           CSW098
     C                     ENDIF                                          CSW098
      *
      ** EITHER SBOFN OR SBOF1 MUST NOT BE LEFT BLANK
      ** (SWIFT FIELD 58 MUST BE ENTERED IF 57 IS ENTERED)
     C           SBOFN     IFEQ *BLANKS
     C           SBOF1     ANDEQ*BLANKS
     C                     MOVE *BLANKS   WWAWIN
     C                     MOVE '1'       *IN75
     C                     MOVEA'11'      *IN,29
     C                     MOVEL'SEW5226' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ELSE
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWAWIN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRAWIL
      *****************************************************************
      *                                                               *
      **  SRAWIL    - VALIDATE A/C WITH INSTITUTION A/C LINE :57:     *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG, SRLI35                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRAWIL    BEGSR
      *
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    OREQ 'N'                                                           CSW210
      *                                                                                       CSW210
      ** VALIDATE IF NOT BLANK
     C                     MOVELSAWIL     WWAWIL  1
     C           SAWIL     IFNE *BLANKS
     C           WWAWIL    ANDNE'#'
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER2     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER2
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER2     IFNE 'Y'
      *
     C           SAWIN     IFEQ *BLANKS
     C           SAWIA     ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN26
     C                     MOVE '1'       OVER2
     C                     MOVEL'SEW5230' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
      *
     C                     ELSE
     C                     MOVELSAWIL     WWLI01
     C                     MOVELSAWIL     WWLI02
     C                     MOVELSAWIL     WWLI04  4
     C                     MOVELSAWIL     WWLI05  5
     C                     MOVELSAWIL     WWLI35
     C                     MOVE '1'       *IN27
     C                     MOVE '1'       OVER2
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     EXSR SRLI35
     C                     ELSE                                           CSW098
      *                                                                   CSW098
      ** Set up parameters for call to ME9940                             CSW098
     C                     MOVE *BLANKS   W0RTN                           CSW098
     C                     CLEARI#PARM                                    CSW098
     C                     MOVEL'AWBK '   I#VFLD                          CSW098
     C                     MOVEL'PAY'     I#PR                            CSW098
      *                                                                   CSW098
     C           WWCUSS    IFEQ 'N'                                       CSW098
     C                     MOVEL'X'       I#PRTT                          CSW098
     C                     ELSE                                           CSW098
     C                     MOVELWWCUSS    I#PRTT                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWAWIN     I#PRTY                          CSW098
     C                     MOVELPNMCY     I#PCCY                          CSW098
     C                     MOVELPNMCY     I#RCCY                          CSW098
     C                     MOVELWWLI35    I#ACLN                          CSW098
     C                     CLEARO#PARM                                    CSW098
     C                     CLEARE#PARM                                    CSW098
     C                     MOVEL'SE1808'  E#CPGM                          CSW098
     C                     MOVEL'MEC0017' E#MSGD                          CSW098
     C                     MOVEL'MEMSG'   E#MSGF                          CSW098
      *                                                                   CSW098
     C                     MOVELWAWBK     WACLN                           CSW098
      *                                                                   CSW098
     C                     EXSR SRME99                                    CSW098
      *                                                                   CSW098
      ** If no issuer code defined for the currency clearing system,      CSW098
      ** set flag to display warning message for later display.           CSW098
      *                                                                   CSW098
     C           WICNIL    IFEQ 'Y'                                       CSW098
     C                     MOVEL'Y'       IAWBK                           CSW098
     C                     MOVEL*BLANKS   WICNIL                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWWLI35    WAWBK                           CSW098
      *                                                                   CSW098
     C                     ENDIF                                          CSW098
      *
     C           WWER35    IFNE 'Y'
     C                     MOVE '0'       *IN27
     C                     MOVE '0'       OVER2
     C                     MOVELWWLI35    SAWIL
     C                     END
      *
     C                     END
     C                     END
     C                     END
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE 'N'       WFAI1                                               CSW210
     C           SAWIL     IFNE *BLANKS                                                       CSW210
     C           CSW210    ANDEQ'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
     C                     MOVELSAWIL     DSIBAN                                              CSW210
     C                     EXSR SRIBAN                                                        CSW210
      *                                                                                       CSW210
     C                     MOVE WVIBAN    WFAI1                                               CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WWAWL                                               CSW210
     C                     MOVELWIBRTN    SAWIL                                               CSW210
     C                     ELSE                                                               CSW210
     C           WWAWL     IFNE 'N'                                                           CSW210
     C           SAWIL     ANDEQWAWIL                                                         CSW210
     C                     MOVE 'N'       WWAWL                                               CSW210
     C                     ELSE                                                               CSW210
     C  N27      SAWIL     IFNE WAWIL                                                         CSW210
     C           WIBNWR    ANDEQ'Y'                                                           CSW210
     C                     MOVELWTIBAN    SAWIL                                               CSW210
     C                     SETON                     27                                       CSW210
     C                     MOVE 'Y'       WWAWL                                               CSW210
     C                     MOVELS210W,2   ZAMDT1                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSG1                                              CSW210
     C                     EXSR SRMSG1                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSAWIL     WAWIL                                               CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBOFA
      *****************************************************************
      *                                                               *
      **  SRBOFA    - VALIDATE BENEFICIARY OF MONEY TAG :58:          *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRBOFA    BEGSR
      *
      ** THIS FIELD CAN ONLY BE ENTERED FOR CLEARANCE TYPE 1 TO 4
     C           WWCLTY    IFEQ '14'
      *
     C           SBOFA     IFNE 'D'
     C           SBOFA     ANDNE*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN28
     C                     MOVEL'SEW5222' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THE A/C LINES MAY NOT BE LEFT BLANK WHEN ENTERING THE TAG FIELD
     C           SBOFA     IFNE *BLANK
     C           SBOF1     ANDEQ*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN30
     C                     MOVEL'SEW5227' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** THIS FIELD MUST BE LEFT BLANK IF CLEARANCE TYPE NOT 1 TO 4
     C           SBOFA     IFNE *BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN28
     C                     MOVEL'SEW5221' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBOFN
      *****************************************************************
      *                                                               *
      **  SRBOFN    - VALIDATE BENEFICIARY OF MONEY :58:              *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST, SRSMSG                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRBOFN    BEGSR
      *                                                                   CSW098
     C                     MOVEL*BLANKS   WBOFN                           CSW098
      *
      ** VALIDATE IF NOT BLANK
     C           SBOFN     IFNE *BLANKS
      *
      ** TAG FIELD MUST BE LEFT BLANK
     C           SBOFA     IFNE *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN29
     C                     MOVEL'SEW5228' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     ELSE
      *
      ** SET ERROR INDICATOR ON THIS FIELD BEFORE VALIDATION
     C                     MOVE '1'       *IN29
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SBOFN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN29
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWBOFN
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWBOFN
     C                     END
      *                                                                   CSW098
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C                     MOVELWWBOFN    WBOFN                           CSW098
     C                     ENDIF                                          CSW098
      *
      ** EITHER SAWIN OR SAWIL MUST BE NON BLANK
      ** (SWIFT FIELD 57 MUST BE ENTERED IF 58 IS ENTERED)
     C           SAWIN     IFEQ *BLANKS
     C           SAWIL     ANDEQ*BLANKS
     C           *IN78     ANDEQ*OFF                                                          201429
     C                     MOVE *BLANKS   WWBOFN
     C                     MOVE '1'       *IN75
     C                     MOVEA'11'      *IN,26
     C                     MOVEL'SEW5245' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ELSE
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWBOFN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBOF1
      *****************************************************************
      *                                                               *
      **  SRBOF1    - VALIDATE BENEFICIARY OF MONEY A/C LINE :58:     *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG, SRLI35                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRBOF1    BEGSR
      *                                                                                       CSW210
     C           PSNEW     IFNE 'Y'                                                           CSW210
     C           CSE028    OREQ 'N'                                                           CSW210
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSBOF1     WWBOF1  1
     C           SBOF1     IFNE *BLANKS
     C           WWBOF1    ANDNE'#'
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER3     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER3
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER3     IFNE 'Y'
      *
     C           SBOFN     IFEQ *BLANKS
     C           SBOFA     ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN29
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5230' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
      *
     C                     ELSE
     C                     MOVELSBOF1     WWLI01
     C                     MOVELSBOF1     WWLI02
     C                     MOVELSBOF1     WWLI04
     C                     MOVELSBOF1     WWLI05
     C                     MOVELSBOF1     WWLI35
      *
     C           WWLI02    IFEQ '//'
     C           WWCUSS    ANDEQ'C'
     C           WWBNBI    ANDEQ'N'
     C           WWLI02    OREQ '//'
     C           WWCUSS    ANDEQ'S'
     C           WWBNBI    ANDEQ'N'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN30
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5250' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
      *
     C                     ELSE
     C                     MOVE '1'       *IN30
     C                     MOVE '1'       OVER3
      *                                                                   CSW098
     C           SWRTN     IFNE 'CSW098 '                                 CSW098
     C                     EXSR SRLI35
     C                     ELSE                                           CSW098
      *                                                                   CSW098
      ** Set up parameters for call to ME9940                             CSW098
     C                     MOVE *BLANKS   W0RTN                           CSW098
     C                     CLEARI#PARM                                    CSW098
     C                     MOVEL'BENF '   I#VFLD                          CSW098
     C                     MOVEL'PAY'     I#PR                            CSW098
      *                                                                   CSW098
     C           WWCUSS    IFEQ 'N'                                       CSW098
     C                     MOVEL'X'       I#PRTT                          CSW098
     C                     ELSE                                           CSW098
     C                     MOVELWWCUSS    I#PRTT                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWBOFN     I#PRTY                          CSW098
     C                     MOVELPNMCY     I#PCCY                          CSW098
     C                     MOVELPNMCY     I#RCCY                          CSW098
     C                     MOVELWWLI35    I#ACLN                          CSW098
     C                     CLEARO#PARM                                    CSW098
     C                     CLEARE#PARM                                    CSW098
     C                     MOVEL'SE1808'  E#CPGM                          CSW098
     C                     MOVEL'MEC0018' E#MSGD                          CSW098
     C                     MOVEL'MEMSG'   E#MSGF                          CSW098
      *                                                                   CSW098
     C                     MOVELWBENF     WACLN                           CSW098
      *                                                                   CSW098
     C                     EXSR SRME99                                    CSW098
      *                                                                   CSW098
      ** If no issuer code defined for the currency clearing system,      CSW098
      ** set flag to display warning message for later display.           CSW098
      *                                                                   CSW098
     C           WICNIL    IFEQ 'Y'                                       CSW098
     C                     MOVEL'Y'       IBENF   1                       CSW098
     C                     MOVEL*BLANKS   WICNIL                          CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     MOVELWWLI35    WBENF                           CSW098
      *                                                                   CSW098
     C                     ENDIF                                          CSW098
      *
     C           WWER35    IFNE 'Y'
     C                     MOVE '0'       *IN30
     C                     MOVE '0'       OVER3
     C                     MOVELWWLI35    SBOF1
     C                     END
      *
     C                     END
     C                     END
     C                     END
     C                     END
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE 'N'       WFBF1                                               CSW210
     C           SBOF1     IFNE *BLANKS                                                       CSW210
     C           CSW210    ANDEQ'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
     C                     MOVELSBOF1     DSIBAN                                              CSW210
     C                     EXSR SRIBAN                                                        CSW210
      *                                                                                       CSW210
     C                     MOVE WVIBAN    WFBF1                                               CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WWBF1                                               CSW210
     C                     MOVELWIBRTN    SBOF1                                               CSW210
     C                     ELSE                                                               CSW210
     C           WWBF1     IFNE 'N'                                                           CSW210
     C           SBOF1     ANDEQWBOF1                                                         CSW210
     C                     MOVE 'N'       WWBF1                                               CSW210
     C                     ELSE                                                               CSW210
     C  N30      SBOF1     IFNE WBOF1                                                         CSW210
     C           WIBNWR    ANDEQ'Y'                                                           CSW210
     C                     MOVELWTIBAN    SBOF1                                               CSW210
     C                     SETON                     30                                       CSW210
     C                     MOVE 'Y'       WWBF1                                               CSW210
     C                     MOVELS210W,4   ZAMDT1                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSG1                                              CSW210
     C                     EXSR SRMSG1                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSBOF1     WBOF1                                               CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBOF2
      *****************************************************************
      *                                                               *
      **  SRBOF2    - VALIDATE BENEFICIARY OF MONEY A/C LINE :58:     *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRBOF2    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSBOF2     WWBOF2  1
     C           SBOF2     IFNE *BLANKS
     C           WWBOF2    ANDNE'#'
     C           OVER3     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER3     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER3
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER3     IFNE 'Y'
      *
     C           SBOF1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN30
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWBOF1    IFNE '/'
     C           WWBOF2    ANDEQ'/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN31
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5256' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSBOF2     WWLI02
     C           WWBOF2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN31
     C                     MOVE '1'       OVER3
     C                     MOVEL'SEW5257' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SBOF2     IFEQ SBOF1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN31
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      *TITLE*SR/SRACL1*****************                                   CSW003
      *****************************************************************   CSW003
      ***********                                                     *   CSW003
      ****SRACL1****-*VALIDATE*A/C*CHARGES*LINE*1*:71:*****************   CSW003
      ***********                                                     *   CSW003
      ****CALLED*BY*-*SRVAL**********                                 *   CSW003
      ****CALLS*****-*SRSMSG*********                                 *   CSW003
      ***********                                                     *   CSW003
      *****************************************************************   CSW003
      ***********                                                         CSW003
     C***********SRACL1    BEGSR                                          CSW003
      ***********                                                         CSW003
      ***VALIDATE*IF*NOT*BLANK**********                                  CSW003
     C***********          MOVE *BLANKS   WWACL1  1                       CSW003
     C***********          MOVE *BLANKS   WWVALI  1                       CSW003
     C***********SACL1     IFNE *BLANKS                                   CSW003
     C***********          MOVELSACL1     WWACL1                          CSW003
      ***********                                                         CSW003
     C***********WWACL1    IFEQ '/'                                       CSW003
     C***********          MOVELSACL1     WWLI08  8                       CSW003
     C***********WWLI08    IFNE '/ACCCAP/'                                CSW003
     C***********WWLI08    ANDNE'/ACCCHG/'                                CSW003
     C***********WWLI08    ANDNE'/ACCFEE/'                                CSW003
     C***********WWLI08    ANDNE'/ACCREV/'                                CSW003
     C***********          MOVE 'N'       WWVALI                          CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********WWVALI    IFEQ 'N'                                       CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN32                           CSW003
     C***********          MOVEL'SEW5260' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
     C***********                                                         CSW003
     C***********          END                                            CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********          ENDSR                                          CSW003
      ***********                                                         CSW003
      *****************************************************************   CSW003
      *TITLE*SR/SRACL2***************                                     CSW003
      *****************************************************************   CSW003
      ***********                                                     *   CSW003
      ****SRACL2****-*VALIDATE*A/C*CHARGES*LINE*2*:71:*****************   CSW003
      ***********                                                     *   CSW003
      ****CALLED*BY*-*SRVAL***************                            *   CSW003
      ****CALLS*****-*SRSMSG**************                            *   CSW003
      ***********                                                     *   CSW003
      *****************************************************************   CSW003
      ***********                                                         CSW003
     C***********SRACL2    BEGSR                                          CSW003
      ***********                                                         CSW003
      ***VALIDATE*IF*NOT*BLANK***************                             CSW003
     C***********SACL2     IFNE *BLANKS                                   CSW003
      ***********                                                         CSW003
     C***********SACL1     IFEQ *BLANKS                                   CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN32                           CSW003
     C***********          MOVEL'SEW5255' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********          MOVELSACL2     WWACL2  1                       CSW003
     C***********WWACL1    IFNE '/'                                       CSW003
     C***********WWACL2    ANDEQ'/'                                       CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN33                           CSW003
     C***********          MOVEL'SEW5256' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********          MOVELSACL2     WWLI02                          CSW003
     C***********WWACL1    IFEQ '/'                                       CSW003
     C***********WWLI02    ANDNE'//'                                      CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN33                           CSW003
     C***********          MOVEL'SEW5214' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********WWACL2    IFEQ '/'                                       CSW003
     C***********WWLI02    ANDNE'//'                                      CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN33                           CSW003
     C***********          MOVEL'SEW5257' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********          MOVE SACL2     WWLI33 33                       CSW003
     C***********WWLI02    IFEQ '//'                                      CSW003
     C***********WWLI33    ANDEQ*BLANKS                                   CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN33                           CSW003
     C***********          MOVEL'SEW5213' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********SACL2     IFEQ SACL1                                     CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN33                           CSW003
     C***********          MOVEL'SEW5258' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********          ELSE                                           CSW003
      ***MAY*NOT*BE*BLANK*AS*A*CONTINUATION*LINE***********               CSW003
     C***********          MOVELSACL2     WWLI02                          CSW003
     C***********WWACL1    IFEQ '/'                                       CSW003
     C***********WWLI02    ANDNE'//'                                      CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN33                           CSW003
     C***********          MOVEL'SEW5214' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
     C***********          END                                            CSW003
      ***********                                                         CSW003
     C***********          ENDSR                                          CSW003
      ***********                                                         CSW003
      *****************************************************************
      /TITLE SR/SRSRL1
      *****************************************************************
      *                                                               *
      **  SRSRL1    - VALIDATE SENDER TO RECEIVER INFO LINE 1 :72:    *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRSRL1    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVE *BLANK    WKSRL1  1                       056348
     C                     MOVE *BLANKS   WWSRL1  1
     C                     MOVE *BLANKS   WWVALI
     C           SSRL1     IFNE *BLANKS
      *
     C                     MOVELSSRL1     WWSRL1
     C           WWSRL1    IFEQ '/'
      *
     C           WWREDE    IFEQ 'TS'
     C           WWCLTY    ANDNE'14'
     C                     MOVELSSRL1     WWSR10 10
     C                     MOVELWWSR10    WWSR06  6
     C                     MOVE WWSR10    WWSR04  4
     C           WWSR06    IFEQ '/PRIOR'
     C           WWSR04    ANDEQ'REQ/'
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1                          056348
     C                     END
     C                     END
     C           WWREDE    IFEQ 'TP'                                      056348
     C           WWCLTY    ANDNE'14'                                      056348
     C                     MOVELSSRL1     WWSR10                          056348
     C                     MOVELWWSR10    WWSR06                          056348
     C                     MOVE WWSR10    WWSR04                          056348
     C           WWSR06    IFEQ '/TRADE'                                  056348
     C           WWSR04    ANDEQ'CP/ '                                    056348
     C                     MOVE 'Y'       WWVALI                          056348
     C                     MOVE 'Y'       WKSRL1                          056348
     C                     END                                            056348
     C                     END                                            056348
     C           WWREDE    IFEQ 'TP'                                      056348
     C           WWCLTY    ANDEQ'5'                                       056348
     C                     MOVELSSRL1     WWSR10                          056348
     C                     MOVELWWSR10    WWSR06                          056348
     C                     MOVE WWSR10    WWSR04                          056348
     C                     MOVELWWSR04    WWSR03  3                       056348
     C           WWSR06    IFEQ '/TRADE'                                  056348
     C           WWSR03    ANDEQ'CP/'                                     056348
     C                     MOVE 'Y'       WWVALI                          056348
     C                     MOVE 'Y'       WKSRL1                          056348
     C                     END                                            056348
     C                     END                                            056348
      *
     C                     MOVELSSRL1     WWSR06
     C                     MOVELSSRL1     WWSR07  7
     C                     MOVELSSRL1     WWSR08  8
     C           WWSR06    IFEQ '/AGEN/'
     C           WWSR06    OREQ '/PRIN/'
     C           WWSR06    OREQ '/PHON/'
     C                     MOVE 'Y'       WWVALI
     C                     END
     C           WWSR07    IFEQ '/TELEX/'
     C                     MOVE 'Y'       WWVALI
     C                     END
     C           WWSR08    IFEQ '/BROKER/'
     C                     MOVE 'Y'       WWVALI
     C                     END
      *
     C***********          MOVE *BLANK    WKSRL1  1                       056348
     C           WWCLTY    IFEQ '14'
     C                     MOVELSSRL1     WWSR10
     C                     MOVELWWSR10    WWSR06
     C                     MOVE WWSR10    WWSR04
     C                     MOVE SSRL1     WWSR25 25
     C           WWSR06    IFEQ '/ADDPR'
     C           WWSR04    ANDEQ'TY/ '
     C           WWSR25    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1
     C                     END
     C           WWSR06    IFEQ '/CANCE'
     C           WWSR04    ANDEQ'L/  '
     C           WWSR25    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1
     C                     END
     C           WWSR06    IFEQ '/CONFI'
     C           WWSR04    ANDEQ'RM/ '
     C           WWSR25    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWVALI
     C                     MOVE 'Y'       WKSRL1
     C                     END
     C                     END
      *                                                                   CSW014
     C           CSW014    IFEQ 'Y'                                       CSW014
     C                     MOVELSSRL1     WWSR06  6                       CSW014
     C           WWSR06    IFEQ '/OCMT/'                                  CSW014
     C                     MOVE 'Y'       WWVALI                          CSW014
     C                     ENDIF                                          CSW014
     C                     ENDIF                                          CSW014
      *
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVELSSRL1     WWSR10                                              CSW201
     C                     EXSR SR2001                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           WWVALI    IFNE 'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN34
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVEL'SEW5265' ZAMSID
     C                     ENDIF                                                              CSW201
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSRL2
      *****************************************************************
      *                                                               *
      **  SRSRL2    - VALIDATE SENDER TO RECEIVER INFO LINE 2 :72:    *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRSRL2    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVE *BLANKS   WWSRL2  1
     C***********          MOVE *BLANKS   WWVALI                          CSW003
     C                     MOVE *BLANKS   WWVALI  1                       CSW003
     C           SSRL2     IFNE *BLANKS
      *
     C           SSRL1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN34
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL2     WWSRL2
     C           WWSRL1    IFNE '/'
     C           WWSRL2    ANDEQ'/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5256' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL2     WWLI02
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           WWLI02    ANDNE'//'                                                          CSW201
     C                     MOVELSSRL2     WWSR10                                              CSW201
     C                     EXSR SR2001                                                        CSW201
      *                                                                                       CSW201
     C           WWVALI    IFNE 'Y'                                                           CSW201
     C                     MOVE *ON       *IN35                                               CSW201
     C                     MOVE *ON       *IN75                                               CSW201
     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
     C                     EXSR SRSMSG                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'N'                                                           CSW201
      *                                                                                       CSW201
     C           WKSRL1    IFEQ *BLANK
     C           WWSRL1    ANDEQ'/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5214' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWSRL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5257' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     ENDIF                                                              CSW201
      *
     C                     MOVE SSRL2     WWLI33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SSRL2     IFEQ SSRL1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           CSW201    IFEQ 'N'                                                           CSW201
     C           WKSRL1    IFNE *BLANK
     C           SSRL2     ANDNE*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5259' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ELSE
      ** MAY NOT BE BLANK AS A CONTINUATION LINE
     C                     MOVELSSRL2     WWLI02
      *--   AT THIS LEVEL LINE 2 IS EMPTY   --*                           061028
     C***********WKSRL1    IFEQ *BLANK                                    061028
     C***********WWSRL1    ANDEQ'/'                                       061028
     C***********WWLI02    ANDNE'//'                                      061028
     C***********          MOVE '1'       *IN75                           061028
     C***********          MOVE '1'       *IN35                           061028
     C***********          MOVEL'SEW5214' ZAMSID                          061028
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          061028
     C***********          EXSR SRSMSG                                    061028
     C***********          END                                            061028
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSRL3
      *****************************************************************
      *                                                               *
      **  SRSRL3    - VALIDATE SENDER TO RECEIVER INFO LINE 3 :72:    *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRSRL3    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVE *BLANKS   WWVALI                                              CSW201
     C           SSRL3     IFNE *BLANKS
      *
     C           SSRL2     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN35
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL3     WWSRL3  1
     C           WWSRL2    IFNE '/'
     C           WWSRL3    ANDEQ'/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN36
     C                     MOVEL'SEW5256' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSRL3     WWLI02
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           WWLI02    ANDNE'//'                                                          CSW201
     C                     MOVELSSRL3     WWSR10                                              CSW201
     C                     EXSR SR2001                                                        CSW201
      *                                                                                       CSW201
     C           WWVALI    IFNE 'Y'                                                           CSW201
     C                     MOVE *ON       *IN36                                               CSW201
     C                     MOVE *ON       *IN75                                               CSW201
     C                     MOVEL'SEW5293' ZAMSID                                              CSW201
     C                     EXSR SRSMSG                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'N'                                                           CSW201
      *                                                                                       CSW201
     C           WWSRL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN36
     C                     MOVEL'SEW5214' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWSRL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN36
     C                     MOVEL'SEW5257' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     ENDIF                                                              CSW201
      *
     C                     MOVE SSRL3     WWLI33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN36
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SSRL3     IFEQ SSRL2
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN36
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** MAY NOT BE BLANK AS A CONTINUATION LINE
     C                     MOVELSSRL3     WWLI02
      *--   AT THIS LEVEL LINE 3 IS EMPTY   --*                           061028
     C***********WWSRL2    IFEQ '/'                                       061028
     C***********WWLI02    ANDNE'//'                                      061028
     C***********          MOVE '1'       *IN75                           061028
     C***********          MOVE '1'       *IN36                           061028
     C***********          MOVEL'SEW5214' ZAMSID                          061028
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          061028
     C***********          EXSR SRSMSG                                    061028
     C***********          END                                            061028
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRFIN1
      *****************************************************************
      *                                                               *
      **  SRFIN1    - VALIDATE FURTHER INFORMATION LINE 1 :77:        *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRFIN1    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SFIN1     IFNE *BLANKS
      *
     C                     MOVELSFIN1     WWLI01
     C           WWLI01    IFEQ '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN37
     C                     MOVEL'SEW5285' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRFIN2
      *****************************************************************
      *                                                               *
      **  SRFIN2    - VALIDATE FURTHER INFORMATION LINE 2 :77:        *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRFIN2    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SFIN2     IFNE *BLANKS
      *
     C           SFIN1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN37
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SFIN2     IFEQ SFIN1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN38
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSFIN2     WWLI01
     C           WWLI01    IFEQ '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN38
     C                     MOVEL'SEW5285' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C029
      *****************************************************************
      **/TITLE*SR/SRRED1***********************************************                       CSW210
      *****************************************************************
      *****************************************************************                       CSW210
      ****SRRED1****-*VALIDATE*REGISTRATION*DERAILS*LINE*1*:77:********                       CSW210
      *****************************************************************                       CSW210
      ****CALLED*BY*-*SRVAL********************************************                       CSW210
      ****CALLS*****-*SRSMSG*******************************************                       CSW210
      *****************************************************************                       CSW210
      *****************************************************************
      **********                                                                              CSW210
     C********** SRRED1    BEGSR                                                              CSW210
      **********                                                                              CSW210
      ***VALIDATE FIELD IF NOT BLANK                                                          CSW210
     C********** SRED1     IFNE *BLANKS                                                       CSW210
      **********                                                                              CSW210
     C**********           MOVELSRED1     WWLI01                                              CSW210
     C********** WWLI01    IFEQ '/'                                                           CSW210
     C**********           MOVE '1'       *IN75                                               CSW210
     C**********           MOVE '1'       *IN39                                               CSW210
     C**********           MOVEL'SEW5285' ZAMSID                                              CSW210
     C**********           MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      **********                                                                              CSW210
     C**********           END                                                                CSW210
      **********                                                                              CSW210
     C**********           ENDSR                                                              CSW210
      **********                                                                              CSW210
      *****************************************************************
      **/TITLE*SR/SRRED2***********************************************                       CSW210
      *****************************************************************
      *****************************************************************                       CSW210
      ****SRRED2****-*VALIDATE*REGISTRATION*DERAILS*LINE*1*:77:********                       CSW210
      *****************************************************************                       CSW210
      ****CALLED*BY*-*SRVAL********************************************                       CSW210
      ****CALLS*****-*SRSMSG*******************************************                       CSW210
      *****************************************************************                       CSW210
      *****************************************************************
      **********                                                                              CSW210
     C********** SRRED2    BEGSR                                                              CSW210
      **********                                                                              CSW210
      ***VALIDATE IF NOT BLANK                                                                CSW210
     C********** SRED2     IFNE *BLANKS                                                       CSW210
      **********                                                                              CSW210
     C********** SRED1     IFEQ *BLANKS                                                       CSW210
     C**********           MOVE '1'       *IN75                                               CSW210
     C**********           MOVE '1'       *IN40                                               CSW210
     C**********           MOVEL'SEW5255' ZAMSID                                              CSW210
     C**********           MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      **********                                                                              CSW210
     C********** SRED2     IFEQ SRED1                                                         CSW210
     C**********           MOVE '1'       *IN75                                               CSW210
     C**********           MOVE '1'       *IN40                                               CSW210
     C**********           MOVEL'SEW5258' ZAMSID                                              CSW210
     C**********           MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      **********                                                                              CSW210
     C**********           MOVELSRED2     WWLI01                                              CSW210
     C********** WWLI01    IFEQ '/'                                                           CSW210
     C**********           MOVE '1'       *IN75                                               CSW210
     C**********           MOVE '1'       *IN40                                               CSW210
     C**********           MOVEL'SEW5285' ZAMSID                                              CSW210
     C**********           MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C**********           EXSR SRSMSG                                                        CSW210
     C**********           END                                                                CSW210
      **********                                                                              CSW210
     C**********           END                                                                CSW210
      **********                                                                              CSW210
     C**********           ENDSR                                                              CSW210
      *
     C/COPY WNCPYSRC,SE1808C030
      *****************************************************************
      /TITLE SR/SRNAL1
      *****************************************************************
      *                                                               *
      **  SRNAL1    - VALIDATE NARRATIVE 1 :79:                       *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRNAL1    BEGSR
      *
      ** VALIDATE FIELD IF NOT BLANK
     C                     MOVE *BLANKS   WWNAL1  1
     C           SNAL1     IFNE *BLANKS
      *
     C                     MOVELSNAL1     WWNAL1
     C                     MOVE SNAL1     WWLI34
     C           WWNAL1    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN41
     C                     MOVEL'SEW5263' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRNAL2
      *****************************************************************
      *                                                               *
      **  SRNAL2    - VALIDATE NARRATIVE 2 :79:                       *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRNAL2    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SNAL2     IFNE *BLANKS
      *
     C           SNAL1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN41
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSNAL2     WWNAL2  1
     C           WWNAL1    IFNE '/'
     C           WWNAL2    ANDEQ'/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN42
     C                     MOVEL'SEW5256' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSNAL2     WWLI02
     C           WWNAL1    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN42
     C                     MOVEL'SEW5214' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWNAL2    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN42
     C                     MOVEL'SEW5257' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SNAL2     WWLI33 33
     C           WWLI02    IFEQ '//'
     C           WWLI33    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN42
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SNAL2     IFEQ SNAL1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN42
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** MAY NOT BE BLANK AS A CONTINUATION LINE
     C                     MOVELSNAL2     WWLI02
     C           WWNAL1    IFEQ '/'
     C           WWLI02    ANDNE'//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN42
     C                     MOVEL'SEW5214' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRIPYN
      *****************************************************************
      *                                                               *
      **  SRIPYN    - VALIDATE INSTRUCTING PARTY :82:                 *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRIPYN    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SIPYN     IFNE *BLANKS
      *
      ** THIS FIELD MAY NOT BE USED WHEN CLEARANCE TYPE IS 1 TO 4
     C           WWCLTY    IFEQ '14'
     C********** PGMEC     ANDNE'Y'                                                           212937
     C           PSNEW     ANDNE'Y'                                                           212937
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN43
     C                     MOVEL'SEW5267' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** SET ERROR INDICATOR ON THIS FIELD BEFORE VALIDATION.
     C           *IN43     IFEQ '0'
     C                     MOVE '1'       *IN43
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SIPYN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN43
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWIPYN
     C                     END
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWIPYN
     C                     END
      *
     C                     ELSE
      *
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWIPYN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRIPYL
      *****************************************************************
      *                                                               *
      **  SRIPYL    - VALIDATE INSTRUCTING PARTY A/C LINE :82:        *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRIPYL    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSIPYL     WWIPYL  1
     C           SIPYL     IFNE *BLANKS
     C           WWIPYL    ANDNE'#'
      *
     C           WWCLTY    IFEQ '14'
     C           PGMEC     ANDNE'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN44
     C           SIPYN     IFEQ *BLANKS
     C                     MOVEL'SEW5267' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C           WWIPYL    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN44
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSIPYL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN44
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SIPYL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN44
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCTYN
      *****************************************************************
      *                                                               *
      **  SRCTYN    - VALIDATE COUNTERPARTY :82:                      *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRCTYN    BEGSR
      *                                                                                       201429
      ** Counterparty is mandatory if first intermediary is entered                           201429
      *                                                                                       201429
     C           SCTYN     IFEQ *BLANKS                                                       201429
     C           *IN78     ANDEQ*ON                                                           201429
     C           PIMMD1    ANDNE*BLANKS                                                       201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN45                                               201429
     C                     MOVEL'SEW9008' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *
      ** VALIDATE IF NOT BLANK
     C           SCTYN     IFNE *BLANKS
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
      *                                                                                       201429
     C           SCTYN     ORNE *BLANKS                                                       201429
     C           *IN78     ANDEQ*ON                                                           201429
      *
      ** THIS FIELD MAY ONLY BE USED TO GENERATE A MT512
     C           PGMEC     IFNE 'Y'
     C           SWRTN     ANDNE'CSW098'                                                      201429
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN45
     C                     MOVEL'SEW5207' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** SET ERROR INDICATOR ON THIS FIELD BEFORE VALIDATION.
     C           *IN45     IFEQ '0'
     C                     MOVE '1'       *IN45
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SCTYN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN45
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWCTYN
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWCTYN
     C                     END
     C                     END
      *
     C                     ELSE
      *
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWCTYN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCTYL
      *****************************************************************
      *                                                               *
      **  SRCTYL    - VALIDATE COUNTERPARTY A/C LINE :82:             *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRCTYL    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSCTYL     WWCTYL  1
     C           SCTYL     IFNE *BLANKS
     C           WWCTYL    ANDNE'#'
     C           SWRTN     ANDNE'CSW098 '                                 CSW098
      *                                                                                       201429
     C           SCTYL     ORNE *BLANKS                                                       201429
     C           WWCTYL    ANDNE'#'                                                           201429
     C           *IN78     ANDEQ*ON                                                           201429
      *
     C           PGMEC     IFNE 'Y'
     C           SWRTN     ANDNE'CSW098'                                                      201429
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN46
     C           SCTYN     IFEQ *BLANKS
     C                     MOVEL'SEW5207' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C           PSNEW     IFNE 'Y'                                                           212094
     C           WWCTYL    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN46
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSCTYL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN46
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SCTYL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN46
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     ENDIF                                                              212094
      *
     C                     END
      *
     C           SWRTN     IFEQ 'CSW098 '                                 CSW098
     C           *IN78     ANDEQ*OFF                                                          201429
     C                     MOVE *BLANKS   SCTYL                           CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSKAN
      *****************************************************************
      *                                                               *
      **  SRSKAN    - VALIDATE SAFEKEEPING ACCOUNT :83:               *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRSKAN    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SSKAN     IFNE *BLANKS
      *
      ** SAFEKEEPING ACCOUNT MUST BE LEFT BLANK FOR CLEARANCE 1 TO 4
      ** (SAFEKEEPING ACCOUNT MUST BE ENTERED ON FIRST WINDOW)
     C********** WWCLTY    IFEQ '14'                                                          212094
     C**********           MOVE '1'       *IN75                                               212094
     C**********           MOVE '1'       *IN49                                               212094
     C**********           MOVEL'SEW5272' ZAMSID                                              212094
     C**********           MOVEL'SEUSRMSG'ZAMSGF                                              212094
     C**********           EXSR SRSMSG                                                        212094
      **********                                                                              212094
     C**********           ELSE                                                               212094
      ** SET ERROR INDICATOR ON THIS FIELD BEFORE VALIDATION
     C                     MOVE '1'       *IN49
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SSKAN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN49
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWSKAN
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWSKAN
     C                     END
      *
     C**********           END                                                                212094
      *
     C                     ELSE
      *
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWSKAN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSKAL
      *****************************************************************
      *                                                               *
      **  SRSKAL    - VALIDATE SAFEKEEPING ACCOUNT A/C LINE :83:      *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRSKAL    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSSKAL     WWSKAL  1
     C           SSKAL     IFNE *BLANKS
     C           WWSKAL    ANDNE'#'
      *
      ** SAFEKEEPING ACCOUNT MUST BE LEFT BLANK FOR CLEARANCE 1 TO 4
      ** (SAFEKEEPING ACCOUNT MUST BE ENTERED ON FIRST WINDOW)
     C           WWCLTY    IFEQ '14'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN50
     C                     MOVEL'SEW5272' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
      *
     C                     ELSE
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER6     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER6
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER6     IFNE 'Y'
      *
     C           WWSKAL    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       OVER6
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSSKAL     WWLI02
     C           WWLI02    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       OVER6
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SSKAL     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       OVER6
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCCTN
      *****************************************************************
      *                                                               *
      **  SRCCTN    - VALIDATE CLEARING CORRESPONDENT :84:            *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRCCTN    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SCCTN     IFNE *BLANKS
      *
      ** CLEARANCE TYPE MUST BE 1, 2, 3 or 4
     C           WWCLTY    IFNE '14'
     C           PSNEW     ANDNE'Y'                                                           212937
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN51
     C                     MOVEL'SEW5275' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      **********                                                                              204804
      ***CHECK*ENTRY*IS*ALPHANUMERIC*WITH*NO*EMBEDDED*BLANKS***********                       204804
     C**********           MOVEASCCTN     CCO                                                 204804
     C**********           MOVE '0'       *IN82                                               204804
     C**********           Z-ADD0         I       20                                          204804
     C********** I         DOWLE7                                                             204804
     C********** *IN51     ANDEQ'0'                                                           204804
     C**********           ADD  1         I                                                   204804
     C********** CCO,I     IFEQ ' '                                                           204804
     C**********           MOVE '1'       *IN51                                               204804
     C**********           ELSE                                                               204804
     C********** CCO,I     LOKUPVA0                      82                                   204804
     C********** *IN82     IFEQ '0'                        not found.                         204804
     C**********           MOVE '1'       *IN51                                               204804
     C**********           END                                                                204804
     C**********           END                                                                204804
     C**********           END                                                                204804
      *
     C                     MOVELSCCTN     WKVAR  10                                           204804
     C                     CALL 'AOCUSTR0'                                                    204804
     C                     PARM *BLANKS   WKRTCD  7                                           204804
     C                     PARM '*KEY   ' WKOPTN  7                                           204804
     C                     PARM           WKVAR                                               204804
     C                     PARM           WKYSTS  7                                           204804
     C           SDCUST    PARM SDCUST    DSSDY                                               204804
      *                                                                                       204804
     C           WKRTCD    IFEQ *BLANK                                                        204804
     C           WKYSTS    ANDNE'*ERROR'                                                      204804
     C                     MOVELBBCSID    SCCTN                                               204804
      *                                                                                       204804
     C                     ELSE                                                               204804
      *                                                                                       204804
     C           *LOVAL    SETLLSDCUSTSW                                                      204804
     C           SCCTN     CHAINSDCUSTSW             99                                       204804
     C           *IN99     IFEQ *ON                                                           204804
      *                                                                                       204804
      ** Check if SWIFT Address exist in BIC file                                             204804
      *                                                                                       204804
     C                     CALL 'AOBICDV0'                                                    204804
     C                     PARM *BLANKS   @CRTCD  7                                           204804
     C                     PARM           SCCTN                                               204804
     C                     PARM           @CTYPE  7                                           204804
     C                     PARM           DSSDY                                               204804
     C           @CRTCD    IFNE '*BICFND'                                                     204804
     C           @CTYPE    ANDNE'*BIC'                                                        204804
     C                     MOVE '1'       *IN51                                               204804
     C                     ENDIF                                                              204804
     C                     ENDIF                                                              204804
     C                     ENDIF                                                              204804
      *                                                                                       204804
     C           *IN51     IFEQ '1'
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5276' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDCTL
      *****************************************************************
      *                                                               *
      **  SRDCTL    - VALIDATE DELIVER'S INSTRUCTING PARTY :85:       *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRDCTL    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C           SDCTL     IFNE *BLANKS
      *
      ***CLEARANCE*TYPE*MUST*BE*1,*2,*3*or*4************:                 CSW003
     C***********WWCLTY    IFNE '14'                                      CSW003
     C***********          MOVE '1'       *IN75                           CSW003
     C***********          MOVE '1'       *IN52                           CSW003
     C***********          MOVEL'SEW5280' ZAMSID                          CSW003
     C***********          MOVEL'SEUSRMSG'ZAMSGF                          CSW003
     C***********          EXSR SRSMSG                                    CSW003
     C***********          END                                            CSW003
      *
      ** SDCTL MUST START BY A SLASH "/" FOLLOWED BY 5 DIGITS
     C                     MOVELSDCTL     WWLI01
     C                     MOVE SDCTL     WWLI05
     C                     MOVELWWLI05    WWNUM6  60
     C                     MOVELWWNUM6    WWALF5  5
     C           WWLI05    IFNE WWALF5
     C           WWLI01    ORNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN52
     C                     MOVEL'SEW5281' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C031
      *****************************************************************
      /TITLE SR/SRRSSA
      *****************************************************************
      *                                                               *
      **  SRRSSA    - VALIDATE RECEIVER OF SECURITIES TAG :87:        *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRRSSA    BEGSR
      *
      ** THIS FIELD CAN ONLY BE ENTERED FOR CLEARANCE TYPE 1 TO 4
     C           WWCLTY    IFEQ '14'
      *
     C           SRSSA     IFNE 'C'
     C           SRSSA     ANDNE'D'
     C           SRSSA     ANDNE*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN53
     C                     MOVEL'SEW5223' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THE A/C LINES MAY NOT BE LEFT BLANK WHEN ENTERING THE TAG FIELD
     C           SRSSA     IFNE *BLANK
     C           SRSS1     ANDEQ*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN55
     C                     MOVEL'SEW5227' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** THIS FIELD MUST BE LEFT BLANK IF CLEARANCE TYPE NOT 1 TO 4
     C           SRSSA     IFNE *BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN53
     C                     MOVEL'SEW5221' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRRSSN
      *****************************************************************
      *                                                               *
      **  SRRSSN    - VALIDATE RECEIVER OF SECURITIES :87:            *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRRSSN    BEGSR
      *                                                                                       201429
      ** Receiver of securities is mandatory is ISO15022 is 'Y'                               201429
      ** and movement type is Walk-Out.                                                       201429
      *                                                                                       201429
     C           SRSSN     IFEQ *BLANKS                                                       204550
     C********** PDPBN     ANDNE0                                                      204550 CSD027
     C           PDPBN     ANDNE*BLANKS                                                       CSD027
     C           PDPMV     ANDEQ'WO'                                                          201429
     C                     MOVE PDPBN     SRSSN                                               204550
     C                     ENDIF                                                              204550
      *                                                                                       204550
     C           PSNEW     IFEQ 'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C           CSE028    ANDEQ'Y'                                                           201429
     C           PDPMV     ANDEQ'WO'                                                          201429
     C           SRSSN     ANDEQ*BLANKS                                                       201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN54                                               201429
     C                     MOVEL'SEW9006' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *
      ** VALIDATE IF NOT BLANK
     C           SRSSN     IFNE *BLANKS
      *
      ** TAG FIELD MUST BE LEFT BLANK
     C           SRSSA     IFNE *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN54
     C                     MOVEL'SEW5228' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THIS FIELD MAY ONLY BE ENTERED FOR RECEIPT INSTRUCTIONS
     C           WWREDE    IFEQ 'TP'
     C           PGMEC     ANDNE'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN54
     C                     MOVEL'SEW5291' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** SET ON ERROR INDICATOR FOR THIS FIELD BEFORE VALIDATION
     C           *IN54     IFEQ '0'
     C                     MOVE '1'       *IN54
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SRSSN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWRSSN
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWRSSN
     C                     END
     C                     END
      *
     C                     ELSE
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWRSSN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRRSS1
      *****************************************************************
      *                                                               *
      **  SRRSS1    - VALIDATE RECEIVER OF SECURITIES A/C LINE 1 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRRSS1    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSRSS1     WWRSS1  1
     C           SRSS1     IFNE *BLANKS
     C           WWRSS1    ANDNE'#'
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER7     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER7     IFNE 'Y'
      *
     C           WWREDE    IFEQ 'TP'
     C           PGMEC     ANDNE'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN55
     C                     MOVEL'SEW5291' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWRSS1    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN55
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS1     WWLI02
     C           WWRSS1    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN55
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SRSS1     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN55
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRVAL
      *****************************************************************
      *                                                               *
      **  SRRSS2    - VALIDATE RECEIVER OF SECURITIES A/C LINE 2 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRRSS2    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSRSS2     WWRSS2  1
     C           SRSS2     IFNE *BLANKS
     C           WWRSS2    ANDNE'#'
     C           OVER7     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER7     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER7     IFNE 'Y'
      *
     C           SRSS1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN56
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SRSS2     IFEQ SRSS1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN56
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS2     WWLI02
     C                     MOVE SRSS2     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN56
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRRSS3
      *****************************************************************
      *                                                               *
      **  SRRSS3    - VALIDATE RECEIVER OF SECURITIES A/C LINE 3 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRRSS3    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSRSS3     WWRSS3  1
     C           SRSS3     IFNE *BLANKS
     C           WWRSS3    ANDNE'#'
     C           OVER7     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER7     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER7     IFNE 'Y'
      *
     C           SRSS2     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN57
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SRSS3     IFEQ SRSS2
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN57
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS3     WWLI02
     C                     MOVE SRSS3     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN57
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRRSS4
      *****************************************************************
      *                                                               *
      **  SRRSS4    - VALIDATE RECEIVER OF SECURITIES A/C LINE 4 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRRSS4    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSRSS4     WWRSS4  1
     C           SRSS4     IFNE *BLANKS
     C           WWRSS4    ANDNE'#'
     C           OVER7     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER7     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER7
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER7     IFNE 'Y'
      *
     C           SRSS3     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN58
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SRSS4     IFEQ SRSS3
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN58
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSRSS4     WWLI02
     C                     MOVE SRSS4     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN58
     C                     MOVE '1'       OVER7
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDSSA
      *****************************************************************
      *                                                               *
      **  SRDSSA    - VALIDATE DELIVERER OF SECURITIES TAG :87:       *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRDSSA    BEGSR
      *
      ** THIS FIELD CAN ONLY BE ENTERED FOR CLEARANCE TYPE 1 TO 4
     C           WWCLTY    IFEQ '14'
      *
     C           SDSSA     IFNE 'C'
     C           SDSSA     ANDNE'D'
     C           SDSSA     ANDNE*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN59
     C                     MOVEL'SEW5223' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THE A/C LINES MAY NOT BE LEFT BLANK WHEN ENTERING THE TAG FIELD
     C           SDSSA     IFNE *BLANK
     C           SDSS1     ANDEQ*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN61
     C                     MOVEL'SEW5227' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** THIS FIELD MUST BE LEFT BLANK IF CLEARANCE TYPE NOT 1 TO 4
     C           SDSSA     IFNE *BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN59
     C                     MOVEL'SEW5221' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDSSN
      *****************************************************************
      *                                                               *
      **  SRDSSN    - VALIDATE DELIVERER OF SECURITIES :87:           *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRDSSN    BEGSR
      *                                                                                       201429
      ** Deliverer of securities is mandatory if ISO15022 is 'Y'                              201429
      ** and movement type is Walk-In.                                                        201429
      *                                                                                       201429
     C           SDSSN     IFEQ *BLANKS                                                       204550
     C********** PDPBN     ANDNE0                                                      204550 CSD027
     C           PDPBN     ANDNE*BLANKS                                                       CSD027
     C           PDPMV     ANDEQ'WI'                                                          201429
     C                     MOVE PDPBN     SDSSN                                               204550
     C                     ENDIF                                                              204550
      *                                                                                       204550
     C           PSNEW     IFEQ 'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C           CSE028    ANDEQ'Y'                                                           201429
     C           PDPMV     ANDEQ'WI'                                                          201429
     C           SDSSN     ANDEQ*BLANKS                                                       201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN60                                               201429
     C                     MOVEL'SEW9003' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *
      ** VALIDATE IF NOT BLANK
     C           SDSSN     IFNE *BLANKS
      *
      ** TAG FIELD MUST BE LEFT BLANK
     C           SDSSA     IFNE *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN60
     C                     MOVEL'SEW5228' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THIS FIELD MAY ONLY BE ENTERED FOR DELIVER INSTRUCTIONS
     C           WWREDE    IFEQ 'TS'
     C           PGMEC     ANDNE'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN60
     C                     MOVEL'SEW5290' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** SET ON ERROR INDICATOR FOR THIS FIELD BEFORE VALIDATION
     C           *IN60     IFEQ '0'
     C                     MOVE '1'       *IN60
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SDSSN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN60
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWDSSN
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWDSSN
     C                     END
     C                     END
      *
     C                     ELSE
     C** ELSE if screen field is blank but account line 1 is not blank    086910
     C** THEN it is an error.                                             086910
     C           SDSSN     IFEQ *BLANKS                                   086910
     C           SDSS1     ANDNE*BLANKS                                   086910
     C                     MOVE '1'       *IN75                           086910
     C                     MOVE '1'       *IN61                           086910
     C                     MOVE '1'       OVER8                           086910
     C                     MOVEL'SEW5208' ZAMSID                          086910
     C                     MOVEL'SE500MSG'ZAMSGF                          086910
     C                     EXSR SRSMSG                                    086910
     C                     ENDIF                                          086910
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWDSSN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDSS1
      *****************************************************************
      *                                                               *
      **  SRDSS1    - VALIDATE DELIVERER OF SECURITES A/C LINE 1 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRDSS1    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSDSS1     WWDSS1  1
     C           SDSS1     IFNE *BLANKS
     C           WWDSS1    ANDNE'#'
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER8     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER8     IFNE 'Y'
      *
     C           WWREDE    IFEQ 'TS'
     C           PGMEC     ANDNE'Y'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN61
     C                     MOVEL'SEW5290' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           WWDSS1    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN61
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS1     WWLI02
     C           WWDSS1    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN61
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SDSS1     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN61
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDSS2
      *****************************************************************
      *                                                               *
      **  SRDSS2    - VALIDATE DELIVERER OF SECURITES A/C LINE 2 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRDSS2    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSDSS2     WWDSS2  1
     C           SDSS2     IFNE *BLANKS
     C           WWDSS2    ANDNE'#'
     C           OVER8     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER8     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER8     IFNE 'Y'
      *
     C           SDSS1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN62
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SDSS2     IFEQ SDSS1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN62
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS2     WWLI02
     C                     MOVE SDSS2     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN62
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDSS3
      *****************************************************************
      *                                                               *
      **  SRDSS3    - VALIDATE DELIVERER OF SECURITES A/C LINE 3 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRDSS3    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSDSS3     WWDSS3  1
     C           SDSS3     IFNE *BLANKS
     C           WWDSS3    ANDNE'#'
     C           OVER8     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER8     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER8     IFNE 'Y'
      *
     C           SDSS2     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN63
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SDSS3     IFEQ SDSS2
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN63
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS3     WWLI02
     C                     MOVE SDSS3     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN63
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDSS4
      *****************************************************************
      *                                                               *
      **  SRDSS4    - VALIDATE DELIVERER OF SECURITES A/C LINE 4 :87: *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRDSS4    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSDSS4     WWDSS4  1
     C           SDSS4     IFNE *BLANKS
     C           WWDSS4    ANDNE'#'
     C           OVER8     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER8     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER8
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER8     IFNE 'Y'
      *
     C           SDSS3     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN64
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SDSS4     IFEQ SDSS3
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN64
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSDSS4     WWLI02
     C                     MOVE SDSS4     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN64
     C                     MOVE '1'       OVER8
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBSSA
      *****************************************************************
      *                                                               *
      **  SRBSSA    - VALIDATE BENEFICIARY OF SECURITIES TAG :88:     *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRBSSA    BEGSR
      *
      ** THIS FIELD CAN ONLY BE ENTERED FOR CLEARANCE TYPE 1 TO 4
     C           WWCLTY    IFEQ '14'
      *
     C           SBSSA     IFNE 'C'
     C           SBSSA     ANDNE'D'
     C           SBSSA     ANDNE*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN65
     C                     MOVEL'SEW5223' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** THE A/C LINES MAY NOT BE LEFT BLANK WHEN ENTERING THE TAG FIELD
     C           SBSSA     IFNE *BLANK
     C           SBSS1     ANDEQ*BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN67
     C                     MOVEL'SEW5227' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** THIS FIELD MUST BE LEFT BLANK IF CLEARANCE TYPE NOT 1 TO 4
     C           SBSSA     IFNE *BLANK
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN65
     C                     MOVEL'SEW5221' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBSSN
      *****************************************************************
      *                                                               *
      **  SRBSSN    - VALIDATE BENEFICIARY OF SECURITIES :88:         *
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRCUST                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRBSSN    BEGSR
      *                                                                                       201429
      ** Beneficiary is mandatory if ISO15022 is 'Y'                                          201429
      ** and movement type is Walk-Out.                                                       201429
      *                                                                                       201429
     C           PSNEW     IFEQ 'Y'                                                           201429
     C           PGMES     ANDEQ'Y'                                                           201429
     C           CSE028    ANDEQ'Y'                                                           201429
     C           PDPMV     ANDEQ'WO'                                                          201429
     C           SBSSN     ANDEQ*BLANKS                                                       201429
     C                     MOVE '1'       *IN75                                               201429
     C                     MOVE '1'       *IN66                                               201429
     C                     MOVEL'SEW9005' ZAMSID                                              201429
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              201429
     C                     EXSR SRSMSG                                                        201429
     C                     ENDIF                                                              201429
      *
      ** VALIDATE IF NOT BLANK
     C           SBSSN     IFNE *BLANKS
      *
      ** TAG FIELD MUST BE LEFT BLANK
     C           SBSSA     IFNE *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN66
     C                     MOVEL'SEW5228' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     ELSE
      *
      ** SET ON ERROR INDICATOR FOR THIS FIELD BEFORE VALIDATION
     C                     MOVE '1'       *IN66
      *
      ** VALIDATE CUSTOMER NO/SHORTNAME/NOSTRO
     C                     MOVE SBSSN     WWCUST
     C                     EXSR SRCUST
      *
      ** RESET ERROR INDICATOR IF FIELD IS VALID
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWCUSS    OREQ 'N'
     C                     MOVE '0'       *IN66
     C                     END
      *
      ** CUSTOMER NO/SHORTNAME
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C                     MOVELBBCUST    WWBSSN
     C                     END
      *
      ** NOSTRO
     C           WWCUSS    IFEQ 'N'
     C                     MOVELAWCPNC    WWBSSN
     C                     END
     C                     END
      *
     C                     ELSE
      ** ELSE IF SCREEN FIELD IS BLANK, ENSURE WORKFIELD IS ALSO BLANK
     C                     MOVE *BLANKS   WWBSSN
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBSS1
      *****************************************************************
      *                                                               *
      **  SRBSS1    - VALIDATE BENEFICIARY OF SECURITIES A/C LINE :88:*
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRBSS1    BEGSR
      *
      ** VALIDATE IF NOT BLANK
     C                     MOVELSBSS1     WWBSS1  1
     C           SBSS1     IFNE *BLANKS
     C           WWBSS1    ANDNE'#'
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER9     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER9
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER9     IFNE 'Y'
      *
     C           WWBSS1    IFNE '/'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN67
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5210' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSBSS1     WWLI02
     C           WWBSS1    IFEQ '//'
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN67
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5211' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVE SBSS1     WWLI34
     C           WWLI01    IFEQ '/'
     C           WWLI34    ANDEQ*BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN67
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5212' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRBSS2
      *****************************************************************
      *                                                               *
      **  SRBSS2    - VALIDATE BENEFICIARY OF SECURITIES A/C LINE :88:*
      **                                                              *
      **  CALLED BY - SRVAL                                           *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRBSS2    BEGSR
      *
      ** VALIDATE IF NOT BLANK AND NOT OVERRIDDEN
     C                     MOVELSBSS2     WWBSS2  1
     C           SBSS2     IFNE *BLANKS
     C           WWBSS2    ANDNE'#'
     C           OVER9     ANDNE'Y'                        1st line overr.
      *
      ** OVERRIDE BY F18
     C           PSENT     IFEQ 'CEDEL'
     C           *INKS     ANDEQ'1'
     C           OVER9     ANDEQ'1'
     C                     MOVE '0'       *INKS
     C                     MOVE 'Y'       OVER9
     C                     END
      *
      ** IF NOT OVERRIDDEN
     C           OVER9     IFNE 'Y'
      *
     C           SBSS1     IFEQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN68
     C                     MOVEL'SEW5255' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C           SBSS2     IFEQ SBSS1
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN68
     C                     MOVEL'SEW5258' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     MOVELSBSS2     WWLI02
     C                     MOVE SBSS2     WWLI33
     C           WWLI02    IFNE '//'
     C           WWLI33    OREQ *BLANKS
     C                     MOVE '1'       *IN75
     C                     MOVE '1'       *IN68
     C                     MOVE '1'       OVER9
     C                     MOVEL'SEW5213' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCUST
      *****************************************************************
      *                                                               *
      **  SRCUST    - VALIDATE CUSTOMER NUMBER/SHORTNAME/NOSTRO       *
      **                                                              *
      **  CALLED BY -                                                 *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRCUST    BEGSR
      *
     C                     MOVE *BLANKS   WWCUSS  1
      *
      ** Call Access Program for Customer Details using the Customer
      ** No. or the Customer Shortname.
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM WWCUST    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
      *
      ** If Return code is blank then set WWCUSS to 'C' if Customer
      ** Number; to 'S' if Customer Shortname.
     C           WRTCD     IFEQ *BLANK
     C           WKYST     ANDNE'*ERROR'
      *
     C           WKYST     IFEQ '*CNUM'
     C                     MOVE 'C'       WWCUSS
     C                     ELSE
     C                     MOVE 'S'       WWCUSS
     C                     END
      *
      ** If Customer Number or Shortname then save file fields.
     C                     MOVE BBCABA    WWCABA
     C                     MOVE BBCSID    WWCSID
     C                     MOVE BBBLCD    WWBLCD
     C                     MOVE BBFWCD    WWFWCD
     C                     MOVE BBCHID    WWCHID
     C                     MOVE BBCHSC    WWCHSC
     C                     MOVE BBBNBI    WWBNBI
      *
      ** else (error on Customer file) may be a Counterparty Nostro
     C                     ELSE
     C                     MOVELWWCUST    WWNOST  8
     C                     CALL 'AOCNSTR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM WWNOST    WKEY2   8
     C           SDCNST    PARM SDCNST    DSFDY
      *
      ** If Counterparty Nostro found set WWCUSS to 'N'.
     C           WRTCD     IFEQ *BLANK
     C                     MOVE 'N'       WWCUSS
     C                     MOVE AWSWID    WWCSID
     C                     MOVE AWFWCD    WWFWCD  9
     C                     MOVE 'Y'       WWBNBI
     C                     END
     C                     END
      *
      ** If no record found on either file then send error message
     C           WWCUSS    IFNE 'C'
     C           WWCUSS    ANDNE'S'
     C           WWCUSS    ANDNE'N'
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5205' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRLI35
      *****************************************************************
      *                                                               *
      **  SRLI35    - VALIDATE A 35 ALPHA INPUT FIELD                 *
      **                                                              *
      **  CALLED BY -                                                 *
      **  CALLS     - SRSMSG                                          *
      *                                                               *
      *****************************************************************
      *
     C           SRLI35    BEGSR
      *
      ** INIT FLAG TO SEND ERROR MESSAGE IF 35A FIELDS NOT CORRECTLY FORMATTED
     C                     MOVE *BLANKS   WWER35
      *
      ** VALIDATE FIRST CHARACTER
     C           WWLI01    IFNE '/'
     C                     MOVE 'Y'       WWER35  1
     C                     END
      *
      ** VALIDATE FIRST 2 CHARACTERS
     C           WWLI02    IFEQ '//'
     C           WWLI04    ANDNE'//BL'
     C           WWLI04    ANDNE'//CH'
     C           WWLI04    ANDNE'//CP'
     C           WWLI04    ANDNE'//FW'
     C           WWLI04    ANDNE'//SC'
     C                     MOVE 'Y'       WWER35
     C                     END
      *
      ** VALIDATE FIRST 4 CHARACTERS
     C           PNMCY     IFNE 'USD'
     C           WWLI04    IFEQ '//CH'
     C           WWLI04    OREQ '//CP'
     C           WWLI04    OREQ '//FW'
     C                     MOVE 'Y'       WWER35
     C                     END
     C                     END
      *
     C           PNMCY     IFNE 'DEM'
     C           WWLI04    ANDEQ'//BL'
     C                     MOVE 'Y'       WWER35
     C                     END
      *
      ** INVALID ENTRY
     C           WWER35    IFEQ 'Y'
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5235' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** VALIDATE FIRST 5 CHARACTERS
     C           WWLI05    IFEQ '//CP '
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
      ** IF //CP IS FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE
      ** CUSTOMER CHIPS PARTICIPANT
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWCABA    WW0507
     C                     END
     C                     END
      *
      ** ERROR IF ' //CP' IS NOT FOLLOWED BY A 3 DIGIT NUMBER
      ** FOLLOWED BY BLANKS
     C                     MOVELWW0507    WWNUM4  40
     C                     MOVELWWNUM4    WWALP3  3
     C           WW0507    IFNE WWALP3
     C           WW0835    ORNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5236' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
     C                     END
      *
      ** IF LEFTMOST 4 CHARS ARE '//FW' FOLLOWED BY BLANKS AND
      ** CUSTOMER SWIFT ID IS BLANK THEN SET UP FEDWIRE ACCOUNT
     C           WWLI04    IFEQ '//FW'
      *
     C           WW0535    IFEQ *BLANKS
     C           WWCSID    ANDEQ*BLANKS
     C                     MOVELWWFWCD    WW0513
     C                     END
      *
      ** ERROR IF POSITIONS 14 -35 OF WWLI35 ARE NOT BLANK
     C           WW1435    IFNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5237' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
      ** FEDWIRE ACCOUNT MAY ONLY BE BLANK FOR A BANK WITH A VALID SWIFT ADDRESS
     C           WW0513    IFEQ *BLANKS
      *
     C           WWCUSS    IFNE 'C'
     C           WWCUSS    ANDNE'S'
     C           WWBNBI    OREQ 'N'
     C           WWCSID    OREQ *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5238' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     ELSE
      ** ELSE, MUST BE A 9 DIGIT NUMBER
     C                     MOVELWW0513    WWNU10 100
     C                     MOVELWWNU10    WWALP9  9
     C           WW0513    IFNE WWALP9
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5239' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** CUSTOMER OR BANK MUST HAVE A SWIFT ADDRESS OR A FEDWIRE A/C
     C           WWCSID    IFEQ *BLANKS
     C           WWFWCD    ANDEQ*BLANKS
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5240' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** IF LEFTMOST 4 CHARS OF WWLI35 ARE '//BL' FOLLOWED BY BLANKS
      ** SET UP THE BANKLEITZAHL CODE
     C           WWLI04    IFEQ '//BL'
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWBLCD    WW0512
     C                     END
     C                     END
      *
      ** ERROR IF '//BL' NOT FOLLOWED BY 8 DIGITS NUMBER FOLLOWED BY BLANKS
     C                     MOVELWW0512    WWNUM9  90
     C                     MOVELWWNUM9    WWALP8  8
     C           WW0512    IFNE WWALP8
     C           WW1335    ORNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5241' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
      ** IF LEFTMOST 4 CHARS OF WWLI35 ARE '//CH' FOLLOWED BY BLANKS
      ** SET UP CUSTOMER CHIPS UNIVERSAL ID
     C           WWLI04    IFEQ '//CH'
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWCHID    WW0510
     C                     END
     C                     END
      *
     C                     END
      *
      ** IF LEFTMOST 4 CHARS OF WWLI35 ARE '//SC' FOLLOWED BY BLANKS
      ** SET UP CHAPS SORT CODE
     C           WWLI04    IFEQ '//SC'
      *
     C           WWCUSS    IFEQ 'C'
     C           WWCUSS    OREQ 'S'
     C           WWBNBI    IFEQ 'Y'
     C           WW0535    ANDEQ*BLANKS
     C                     MOVELWWCHSC    WW0510
     C                     END
     C                     END
     C                     END
      *
      ** ERROR IF '//CH' OR '//SC' ARE NOT FOLLOWED BY A 6 DIGITS NUMBER
     C           WWLI04    IFEQ '//CH'
     C           WWLI04    OREQ '//SC'
      *
     C                     MOVELWW0510    WWNUM7  70
     C                     MOVELWWNUM7    WWALP6  6
     C           WW0510    IFNE WWALP6
     C           WW1135    ORNE *BLANKS
     C                     MOVE 'Y'       WWER35
     C                     MOVE '1'       *IN75
     C                     MOVEL'SEW5242' ZAMSID
     C                     MOVEL'SEUSRMSG'ZAMSGF
     C                     EXSR SRSMSG
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCLS2
      *****************************************************************
      *                                                               *
      **  SRCLS2    - TO CLEAR FIELDS ON SECOND SCREEN                *
      **              AND RESET ERROR INDICATORS                      *
      **                                                              *
      **  CALLED BY -                                                 *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRCLS2    BEGSR
      *
     C                     MOVE *BLANKS   SIPYN
     C                     MOVE *BLANKS   SIPYL
     C                     MOVE *BLANKS   SCTYN
     C                     MOVE *BLANKS   SCTYL
     C                     MOVE *BLANKS   SSKAN
     C                     MOVE *BLANKS   SSKAL
     C                     MOVE *BLANKS   SCCTN
     C                     MOVE *BLANKS   SDCTL
     C                     MOVE *BLANKS   SRSSA
     C                     MOVE *BLANKS   SRSSN
     C                     MOVE *BLANKS   SRSS1
     C                     MOVE *BLANKS   SRSS2
     C                     MOVE *BLANKS   SRSS3
     C                     MOVE *BLANKS   SRSS4
     C                     MOVE *BLANKS   SDSSA
     C                     MOVE *BLANKS   SDSSN
     C                     MOVE *BLANKS   SDSS1
     C                     MOVE *BLANKS   SDSS2
     C                     MOVE *BLANKS   SDSS3
     C                     MOVE *BLANKS   SDSS4
     C                     MOVE *BLANKS   SBSSA
     C                     MOVE *BLANKS   SBSSN
     C                     MOVE *BLANKS   SBSS1
     C                     MOVE *BLANKS   SBSS2
     C**********           MOVE *BLANKS   SINVE                                        CSW098 CSW210
      *
     C                     SETOF                     434445
     C                     SETOF                     464950
     C                     SETOF                     515253
     C                     SETOF                     545556
     C                     SETOF                     575859
     C                     SETOF                     606162
     C                     SETOF                     636465
     C                     SETOF                     666768
     C                     SETOF                     19                   CSW098
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C032
      *****************************************************************
      /TITLE SR/SRRTS2
      *****************************************************************
      *                                                               *
      **  SRRTS2    - TO RESET FIELDS ON SECOND SCREEN TO FILE VALUES *
      **              AND RESET ERROR INDICATORS                      *
      **                                                              *
      **  CALLED BY -                                                 *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRRTS2    BEGSR
      *
     C                     MOVE D2IPYN    SIPYN
     C                     MOVE D2IPYL    SIPYL
     C                     MOVE D2CTYN    SCTYN
     C                     MOVE D2CTYL    SCTYL
     C                     MOVE D2SKAN    SSKAN
     C                     MOVE D2SKAL    SSKAL
     C                     MOVE D2CCTN    SCCTN
     C                     MOVE D2DCTL    SDCTL
     C                     MOVE D2RSSA    SRSSA
     C                     MOVE D2RSSN    SRSSN
     C                     MOVE D2RSS1    SRSS1
     C                     MOVE D2RSS2    SRSS2
     C                     MOVE D2RSS3    SRSS3
     C                     MOVE D2RSS4    SRSS4
     C                     MOVE D2DSSA    SDSSA
     C                     MOVE D2DSSN    SDSSN
     C                     MOVE D2DSS1    SDSS1
     C                     MOVE D2DSS2    SDSS2
     C                     MOVE D2DSS3    SDSS3
     C                     MOVE D2DSS4    SDSS4
     C                     MOVE D2BSSA    SBSSA
     C                     MOVE D2BSSN    SBSSN
     C                     MOVE D2BSS1    SBSS1
     C                     MOVE D2BSS2    SBSS2
     C                     MOVE D2INVE    SINVE                           CSW098
      *
     C                     SETOF                     434445
     C                     SETOF                     464950
     C                     SETOF                     515253
     C                     SETOF                     545556
     C                     SETOF                     575859
     C                     SETOF                     606162
     C                     SETOF                     636465
     C                     SETOF                     666768
     C                     SETOF                     19                   CSW098
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C033
      *****************************************************************
      /TITLE SR/SRMOFS                                                                        CSE028
      *****************************************************************                       CSE028
      *                                                               *                       CSE028
      *  SRMOFS    - Move File Fields to Screen Fields                *                       CSE028
      *                                                               *                       CSE028
      *  Called By - SRINS                                            *                       CSE028
      *                                                               *                       CSE028
      *  Calls     - None                                             *                       CSE028
      *                                                               *                       CSE028
      *****************************************************************                       CSE028
      *                                                                                       CSE028
     C           SRMOFS    BEGSR                                                              CSE028
      *                                                                                       CSE028
      ** If occurence 1 of data structure DSSTD is filled then we                             CSE028
      ** have book data so we need to look at occurencs 1-4 of data                           CSE028
      ** structure DSADD.                                                                     CSE028
      ** If occurence 2 of data structure DSSTD is filled then we                             CSE028
      ** have customer data so we need to look at occurencs 5-8 of                            CSE028
      ** structure DSADD.                                                                     CSE028
      *                                                                                       CSE028
     C                     MOVE ' '       @BOOK   1                                           CSE028
     C                     MOVE ' '       @CUST   1                                           CSE028
      *                                                                                       CSE028
      *  Check if book data                                                                   CSE028
     C           1         OCUR DSSTD                                                         CSE028
     C           SIBK      IFNE *BLANKS                                                       CSE028
     C                     MOVE 'Y'       @BOOK                                               CSE028
     C                     MOVE 'N'       @CUST                                               CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      *  Check if customer data                                                               CSE028
     C           @BOOK     IFNE 'Y'                                                           CSE028
     C           2         OCUR DSSTD                                                         CSE028
     C********** CSTM      IFNE 0                                                      CSE028 CSD027
     C           CSTM      IFNE *BLANKS                                                       CSD027
     C                     MOVE 'N'       @BOOK                                               CSE028
     C                     MOVE 'Y'       @CUST                                               CSE028
     C                     ENDIF                                                              CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      *  Now work out which occurence of data structure DSADD                                 CSE028
      *                                                                                       CSE028
     C                     Z-ADD0         Z       20                                          CSE028
      *                                                                                       CSE028
     C                     SELEC                                                              CSE028
     C           PDPMV     WHEQ 'WI'                                                          CSE028
     C           PDPMV     OREQ 'WO'                                                          CSE028
     C           PDPMV     OREQ 'RP'                                                          207006
     C           PDPMV     OREQ 'RR'                                                          207006
     C           PDPMV     OREQ 'BB'                                                          207006
     C           PDPMV     OREQ 'BL'                                                          207006
      *                                                                                       CSE028
     C           STFDM     IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C                     SELEC                                                              CSE028
     C           PDPMV     WHEQ 'WI'                                                          CSE028
     C           PDPMV     OREQ 'RP'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
     C           PDPMV     OREQ 'RR'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
     C           PDPMV     OREQ 'BL'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
     C           PDPMV     OREQ 'BB'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
      * Trade purchase                                                                        CSE028
     C                     Z-ADD1         Z       20                                          CSE028
     C           PDPMV     WHEQ 'WO'                                                          CSE028
     C           PDPMV     OREQ 'RP'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
     C           PDPMV     OREQ 'RR'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
     C           PDPMV     OREQ 'BL'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
     C           PDPMV     OREQ 'BB'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
      * Trade sale                                                                            CSE028
     C                     Z-ADD2         Z                                                   CSE028
     C                     ENDSL                                                              CSE028
      *                                                                                       CSE028
     C                     ELSE                                                               CSE028
      *                                                                                       CSE028
     C                     SELEC                                                              CSE028
     C           PDPMV     WHEQ 'WI'                                                          CSE028
     C           PDPMV     OREQ 'RP'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
     C           PDPMV     OREQ 'RR'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
     C           PDPMV     OREQ 'BL'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
     C           PDPMV     OREQ 'BB'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
      * Depot in                                                                              CSE028
     C                     Z-ADD3         Z                                                   CSE028
     C           PDPMV     WHEQ 'WO'                                                          CSE028
     C           PDPMV     OREQ 'RP'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
     C           PDPMV     OREQ 'RR'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
     C           PDPMV     OREQ 'BL'                                                          207006
     C           PWHEN     ANDEQ'S'                                                           207006
     C           PDPMV     OREQ 'BB'                                                          207006
     C           PWHEN     ANDEQ'M'                                                           207006
      * Depot out                                                                             CSE028
     C                     Z-ADD4         Z                                                   CSE028
     C                     ENDSL                                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C                     OTHER                                                              CSE028
      *                                                                                       CSE028
      * First need to reverse movement dates in and out for                                   CSE028
      * comparisons.                                                                          CSE028
      *                                                                                       CSE028
     C                     MOVE PDPMD     @WKIN                                               CSE028
     C                     MOVE PDPDO     @WKOT                                               CSE028
     C                     Z-ADD@WKIN1    @MVIN3                                              CSE028
     C                     Z-ADD@WKIN2    @MVIN2                                              CSE028
     C                     Z-ADD@WKIN3    @MVIN1                                              CSE028
     C                     Z-ADD@WKOT1    @MVOT3                                              CSE028
     C                     Z-ADD@WKOT2    @MVOT2                                              CSE028
     C                     Z-ADD@WKOT3    @MVOT1                                              CSE028
      *                                                                                       CSE028
     C                     SELEC                                                              CSE028
     C           @MVIN     WHGT @MVOT                                                         CSE028
      * Depot out first screen                                                                CSE028
     C                     Z-ADD4         Z                                                   CSE028
     C           @MVIN     WHLT @MVOT                                                         CSE028
      * Depot in  first screen                                                                CSE028
     C                     Z-ADD3         Z                                                   CSE028
     C                     ENDSL                                                              CSE028
      *                                                                                       CSE028
     C                     ENDSL                                                              CSE028
      *                                                                                       CSE028
      * For book data then Z set for occurence 1,2,3 or 4 is fine.                            CSE028
      * For customer data we need Z set to 5,6,7 or 8 so add 4 to                             CSE028
      * Z after previously setting.                                                           CSE028
      *                                                                                       CSE028
     C           @CUST     IFEQ 'Y'                                                           CSE028
     C                     ADD  4         Z                                                   CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
      * Now we can fill screen fields.                                                        CSE028
      * If *IN01 - At start date                                                              CSE028
      * If *IN02 - At maturity date                                                           CSE028
      * If *IN03 - From depot                                                                 CSE028
      * If *IN04 - To depot                                                                   CSE028
      *                                                                                       CSE028
     C           Z         OCUR DSADD                                                         CSE028
      * SE1808F1                                                                              CSE028
      * A/C for payment                                                                       CSE028
     C                     MOVE SAAFPN    SAFPN                                               CSE028
     C                     MOVE SAAFPN    WWAFPN                                            AR579005
     C                     MOVE SAAFPL    SAFPL                                               CSE028
      * A/C with institution                                                                  CSE028
     C                     MOVE SAAWIN    SAWIN                                               CSE028
     C                     MOVE SAAWIN    WWAWIN                                            AR579005
     C                     MOVE SAAWIL    SAWIL                                               CSE028
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVE SADIDN    SDIDN                                               CSW210
     C                     MOVE SADIDN    WDIDN                                             AR578310
     C                     MOVE SADLIN    SDLIN                                               CSW210
     C                     MOVE SADAD1    SDAD1                                               CSW210
     C                     MOVE SADAD2    SDAD2                                               CSW210
     C                     MOVE SADAD3    SDAD3                                               CSW210
     C                     MOVE SADAD4    SDAD4                                               CSW210
      ** Other fields                                                                         CSW210
     C                     MOVE SAQFIN    PQFIN                                               CSW210
     C                     MOVE SAPCLR    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
      * Benificiary of money                                                                  CSE028
     C                     MOVE SABOFN    SBOFN                                               CSE028
     C                     MOVE SABOFN    WWBOFN                                            AR579005
     C                     MOVE SABOF1    SBOF1                                               CSE028
     C           CSW210    IFEQ 'N'                                                           CSW210
     C                     MOVE SABOF2    SBOF2                                               CSE028
     C                     ENDIF                                                              CSW210
      * Sender to receiver info                                                               CSE028
     C                     MOVE SASRL1    SSRL1                                               CSE028
     C                     MOVE SASRL2    SSRL2                                               CSE028
     C                     MOVE SASRL3    SSRL3                                               CSE028
      * Further information                                                                   CSE028
     C                     MOVE SAFIN1    SFIN1                                               CSE028
     C                     MOVE SAFIN2    SFIN2                                               CSE028
      * Registration details                                                                  CSE028
     C                     MOVE SARED1    SRED1                                               CSE028
     C                     MOVE SARED2    SRED2                                               CSE028
      * Narrative                                                                             CSE028
     C                     MOVE SANAS1    SNAL1                                               CSE028
     C                     MOVE SANAS2    SNAL2                                               CSE028
      * SE1808F2                                                                              CSE028
      * Clearing correspondent                                                                CSE028
     C                     MOVE SACCTN    SCCTN                                               CSE028
      *                                                                                       CSE028
     C                     SELEC                                                              CSE028
     C           Z         WHEQ 2                                                             CSE028
     C           Z         OREQ 4                                                             CSE028
     C           Z         OREQ 6                                                             CSE028
     C           Z         OREQ 8                                                             CSE028
      * Outgoing                                                                              CSE028
      * Receiver of securities                                                                CSE028
     C********** *IN07     IFEQ '1'                                                    204364 207255
     C********** PGMEC     ANDEQ'Y'                                                    204364 207255
     C           *IN08     IFEQ *ON                                                           207255
     C                     MOVE SADRSN    SRSSN  10                                           CSE028
     C                     MOVE SADRSN    WWRSSN                                            AR579005
     C                     MOVE SADRS1    SRSS1  35                                           CSE028
     C                     MOVE SADRS2    SRSS2  35                                           CSE028
     C                     MOVE SADRS3    SRSS3  35                                           CSE028
     C                     MOVE SADRS4    SRSS4  35                                           CSE028
     C                     ENDIF                                                              204364
      *                                                                                       CSE028
     C           Z         WHEQ 1                                                             CSE028
     C           Z         OREQ 3                                                             CSE028
     C           Z         OREQ 5                                                             CSE028
     C           Z         OREQ 7                                                             CSE028
      * Incoming                                                                              CSE028
      * Deliver of securities                                                                 CSE028
     C********** *IN08     IFEQ '1'                                                    204364 207255
     C********** PGMEC     ANDEQ'Y'                                                    204364 207255
     C           *IN07     IFEQ *ON                                                           207255
     C                     MOVE SADRSN    SDSSN  10                                           CSE028
     C                     MOVE SADRSN    WWDSSN                                            AR579005
     C                     MOVE SADRS1    SDSS1  35                                           CSE028
     C                     MOVE SADRS2    SDSS2  35                                           CSE028
     C                     MOVE SADRS3    SDSS3  35                                           CSE028
     C                     MOVE SADRS4    SDSS4  35                                           CSE028
     C                     ENDIF                                                              204364
     C                     ENDSL                                                              CSE028
      * Benificiary securities                                                                CSE028
     C                     MOVE SABSSN    SBSSN  10                                           CSE028
     C                     MOVE SABSSN    WWBSSN                                            AR579005
     C                     MOVE SABSS1    SBSS1  35                                           CSE028
     C                     MOVE SABSS2    SBSS2  35                                           CSE028
     C           SBSSN     IFEQ *BLANKS                                                       205666
     C           PDPMV     ANDEQ'WO'                                                          205666
     C                     MOVE PDPBN     SBSSN                                               205666
     C                     MOVE PDPBN     WWBSSN                                            AR579005
     C                     ENDIF                                                              205666
      *                                                                                       CSE028
     C                     MOVELSAIMD1    PIMMD1                                              CSE028
     C                     MOVELSAIMD2    PIMMD2                                              CSE028
     C                     MOVELSAIMD3    PIMMD3                                              CSE028
     C                     MOVELSAIMD4    PIMMD4                                              CSE028
     C                     MOVELSAIMD5    PIMMD5                                              CSE028
     C                     MOVELSAIMD6    PIMMD6                                              CSE028
     C                     MOVELSAIMD7    PIMMD7                                              CSE028
     C                     MOVELSAIMD8    PIMMD8                                              CSE028
     C                     MOVELSAIMD9    PIMMD9                                              CSE028
     C                     MOVELSAIMS1    PIMSA1                                              CSE028
     C                     MOVELSAIMS2    PIMSA2                                              CSE028
     C                     MOVELSAIMS3    PIMSA3                                              CSE028
     C                     MOVELSAIMS4    PIMSA4                                              CSE028
     C                     MOVELSAIMS5    PIMSA5                                              CSE028
     C                     MOVELSAIMS6    PIMSA6                                              CSE028
     C                     MOVELSAIMS7    PIMSA7                                              CSE028
     C                     MOVELSAIMS8    PIMSA8                                              CSE028
     C                     MOVELSAIMS9    PIMSA9                                              CSE028
     C                     MOVELSAPSET    PPSET                                               CSE028
     C                     MOVELSANAC1    PNARR1                                              CSE028
     C                     MOVELSANAC2    PNARR2                                              CSE028
      *                                                                                       CSE028
     C                     SELEC                                                              CSE028
     C           PDPMV     WHEQ 'WI'                                                          CSE028
     C                     MOVELPDPID     PDEPO                                               CSE028
     C           PDPMV     WHEQ 'WO'                                                          CSE028
     C                     MOVELPDPOD     PDEPO                                               CSE028
     C                     OTHER                                                              CSE028
     C                     MOVELPDPID     PDEPO                                               CSE028
     C                     ENDSL                                                              CSE028
      *                                                                                       CSE028
     C                     MOVELPDPBN     PCUSTN                                              CSE028
      *                                                                                       CSE028
      ** If CSE022 is installed then setup Safekeeping A/C Line by using module SEDORFRTV     CSE028
      *                                                                                       CSE028
     C           CSE022    IFEQ 'Y'                                                           CSE028
      *                                                                                       CSE028
     C                     CALL PGMNAM                                                        CSE028
     C                     PARM *BLANKS   PRETC  10                                           CSE028
     C                     PARM           PDEPO   6                                           CSE028
     C                     PARM           PCUSTN  6                                           CSE028
     C                     PARM           PSKAL  20                                           CSE028
      *                                                                                       CSE028
     C           PSKAL     IFEQ *BLANKS                                                       207483
      *                                                                                       207483
     C                     MOVELA8BICN    PCUSTN                                              207483
      *                                                                                       207483
     C                     CALL PGMNAM                                                        207483
     C                     PARM *BLANKS   PRETC                                               207483
     C                     PARM           PDEPO                                               207483
     C                     PARM           PCUSTN                                              207483
     C                     PARM           PSKAL                                               207483
      *                                                                                       207483
     C           PSKAL     IFEQ *BLANKS                                                       211823
     C                     MOVELPDEPO     PCUSTN                                              211823
     C                     CALL PGMNAM                                                        211823
     C                     PARM *BLANKS   PRETC  10                                           211823
     C                     PARM           PDEPO   6                                           211823
     C                     PARM           PCUSTN  6                                           211823
     C                     PARM           PSKAL  20                                           211823
     C                     ENDIF                                                              211823
      *                                                                                       211823
     C                     ENDIF                                                              207483
      *                                                                                       207483
     C                     MOVELPSKAL     SSKAL                                               CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       210637
      ** Set up default for the Safekeeping Account                                           210637
      *                                                                                       210637
     C           WWCLTY    IFNE '14'                                                          210637
     C                     SELEC                                                              210637
     C           PDPMV     WHEQ 'WI'                                                          210637
     C                     MOVELPDPID     SSKAN                                               210637
     C           PDPMV     WHEQ 'WO'                                                          210637
     C                     MOVELPDPOD     SSKAN                                               210637
     C                     ENDSL                                                              210637
     C                     ENDIF                                                              210637
      *                                                                                       CSE028
     C********** CSE029    IFEQ 'Y'                                                    207006 209777
     C********** *IN48     ANDEQ*ON                                                    207006 209777
     C**********           MOVELPDPBN     SIPYN                                        207006 209777
     C**********           ENDIF                                                       207006 209777
      *                                                                                       207006
     C                     ENDSR                                                              CSE028
      *                                                                                       CSE028
      *****************************************************************
      /TITLE SR/SRFTOS
      *****************************************************************
      *                                                               *
      **  SRFTOS    - TO MOVE FILE FIELDS TO SCREEN FIELDS            *
      **                                                              *
      **  CALLED BY -                                                 *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRFTOS    BEGSR
      *
     C                     MOVE D2AFPN    SAFPN
     C                     MOVE D2AFPL    SAFPL
      *                                                                                       CSW210
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVE D2DIDN    SDIDN                                               CSW210
     C                     MOVE D2DLIN    SDLIN                                               CSW210
     C                     MOVE D2DAD1    SDAD1                                               CSW210
     C                     MOVE D2DAD2    SDAD2                                               CSW210
     C                     MOVE D2DAD3    SDAD3                                               CSW210
     C                     MOVE D2DAD4    SDAD4                                               CSW210
      ** Other fields                                                                         CSW210
     C                     MOVE D2QFIN    PQFIN                                               CSW210
     C                     MOVE D2PCLR    PPCLR                                               CSW210
     C           CFT004    IFEQ 'Y'                                                           CSW210
     C                     MOVE D2FAP1    WFAP1                                               CSW210
     C                     MOVE D2FDBT    WFDBT                                               CSW210
     C                     MOVE D2FAI1    WFAI1                                               CSW210
     C                     MOVE D2FBF1    WFBF1                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE D2AWIA    SAWIA
     C                     MOVE D2AWIN    SAWIN
     C                     MOVE D2AWIL    SAWIL
     C                     MOVE D2BOFA    SBOFA
     C                     MOVE D2BOFN    SBOFN
     C                     MOVE D2BOF1    SBOF1
     C                     MOVE D2BOF2    SBOF2
     C***********          MOVE D2ACL1    SACL1                           CSW003
     C***********          MOVE D2ACL2    SACL2                           CSW003
     C                     MOVE D2SRL1    SSRL1
     C                     MOVE D2SRL2    SSRL2
     C                     MOVE D2SRL3    SSRL3
     C                     MOVE D2FIN1    SFIN1
     C                     MOVE D2FIN2    SFIN2
     C                     MOVE D2RED1    SRED1
     C                     MOVE D2RED2    SRED2
     C                     MOVE D2NAL1    SNAL1
     C                     MOVE D2NAL2    SNAL2
      *                                                                                       207006
     C********** CSE029    IFNE 'Y'                                                    207006 209777
     C                     MOVE D2IPYN    SIPYN
     C**********           ELSE                                                        207006 209777
     C**********           MOVELPDPBN     SIPYN                                        207006 209777
     C**********           ENDIF                                                       207006 209777
      *                                                                                       207006
     C                     MOVE D2IPYL    SIPYL
     C           *IN78     IFEQ *ON                                                           201429
     C                     MOVE D2CTYN    SCTYN
     C                     MOVE D2CTYL    SCTYL
     C                     ENDIF                                                              201429
     C                     MOVE D2SKAN    SSKAN
     C                     MOVE D2SKAL    SSKAL
     C                     MOVE D2CCTN    SCCTN
     C                     MOVE D2DCTL    SDCTL
     C                     MOVE D2RSSA    SRSSA
     C                     MOVE D2RSSN    SRSSN
     C                     MOVE D2RSS1    SRSS1
     C                     MOVE D2RSS2    SRSS2
     C                     MOVE D2RSS3    SRSS3
     C                     MOVE D2RSS4    SRSS4
     C                     MOVE D2DSSA    SDSSA
     C                     MOVE D2DSSN    SDSSN
     C                     MOVE D2DSS1    SDSS1
     C                     MOVE D2DSS2    SDSS2
     C                     MOVE D2DSS3    SDSS3
     C                     MOVE D2DSS4    SDSS4
     C                     MOVE D2BSSA    SBSSA
     C                     MOVE D2BSSN    SBSSN
     C                     MOVE D2BSS1    SBSS1
     C                     MOVE D2BSS2    SBSS2
     C                     MOVE D2INVE    SINVE                           CSW098
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C                     MOVELD2IMD1    PIMMD1                                              CSE028
     C                     MOVELD2IMD2    PIMMD2                                              CSE028
     C                     MOVELD2IMD3    PIMMD3                                              CSE028
     C                     MOVELD2IMD4    PIMMD4                                              CSE028
     C                     MOVELD2IMD5    PIMMD5                                              CSE028
     C                     MOVELD2IMD6    PIMMD6                                              CSE028
     C                     MOVELD2IMD7    PIMMD7                                              CSE028
     C                     MOVELD2IMD8    PIMMD8                                              CSE028
     C                     MOVELD2IMD9    PIMMD9                                              CSE028
     C                     MOVELD2IMS1    PIMSA1                                              CSE028
     C                     MOVELD2IMS2    PIMSA2                                              CSE028
     C                     MOVELD2IMS3    PIMSA3                                              CSE028
     C                     MOVELD2IMS4    PIMSA4                                              CSE028
     C                     MOVELD2IMS5    PIMSA5                                              CSE028
     C                     MOVELD2IMS6    PIMSA6                                              CSE028
     C                     MOVELD2IMS7    PIMSA7                                              CSE028
     C                     MOVELD2IMS8    PIMSA8                                              CSE028
     C                     MOVELD2IMS9    PIMSA9                                              CSE028
     C                     MOVELD2PSET    PPSET                                               CSE028
     C                     MOVELD2NAC1    PNARR1                                              CSE028
     C                     MOVELD2NAC2    PNARR2                                              CSE028
      *                                                                                       CSE028
     C                     ENDIF                                                              CSE028
      *
      ** IF ENQUIRY MODE, RETRIEVE CUSTOMER SHORTNAMES
     C           PACTN     IFEQ 'E'
      *
     C           D2AFPN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2AFPN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SAFPN
     C                     END
     C                     END
      *
     C           D2AWIN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2AWIN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SAWIN
     C                     END
     C                     END
      *
     C           D2BOFN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2BOFN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SBOFN
     C                     END
     C                     END
      *
     C           D2IPYN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2IPYN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SIPYN
     C                     END
     C                     END
      *
     C********** SWRTN     IFNE 'CSW098 '                                              CSW098 201429
      *                                                                   CSW098
     C           D2CTYN    IFNE *BLANKS
     C           *IN78     ANDEQ*ON                                                           201429
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2CTYN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SCTYN
     C                     END
     C                     END
     C**********           ELSE                                                        CSW098 201429
      *                                                                   CSW098
     C           D2INVE    IFNE *BLANKS                                   CSW098
     C**********           CALL 'AOCUSTR0'                                             CSW098 CSW210
     C**********           PARM '*DBERR ' WRTCD                                        CSW098 CSW210
     C**********           PARM '*KEY   ' WOPTN                                        CSW098 CSW210
     C**********           PARM D2INVE    WKEY1  10                                    CSW098 CSW210
     C**********           PARM *BLANKS   WKYST   7                                    CSW098 CSW210
     C********** SDCUST    PARM SDCUST    DSSDY                                        CSW098 CSW210
     C********** WRTCD     IFEQ *BLANK                                                 CSW098 CSW210
     C**********           MOVE BBCSSN    SINVE                                        CSW098 CSW210
     C**********           ENDIF                                                       CSW098 CSW210
     C                     MOVE D2INVE    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    SINVE                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    SINVE                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C**********           ENDIF                                                       CSW098 201429
      *
     C           D2SKAN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2SKAN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SSKAN
     C                     END
     C                     END
      *
     C           D2RSSN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2RSSN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SRSSN
     C                     END
     C                     END
      *
     C           D2DSSN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2DSSN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SDSSN
     C                     END
     C                     END
      *
     C           D2BSSN    IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM '*DBERR ' WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM D2BSSN    WKEY1  10
     C                     PARM *BLANKS   WKYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           WRTCD     IFEQ *BLANK
     C                     MOVE BBCSSN    SBSSN
     C                     END
     C                     END
      *                                                                                       CSW210
     C           D2DIDN    IFNE *BLANKS                                                       CSW210
     C                     MOVE D2DIDN    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    SDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    SDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           D2QFIN    IFNE *BLANKS                                                       CSW210
     C                     MOVE D2QFIN    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    PQFIN                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    PQFIN                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     END                                                                CSW210
      *                                                                                       CSW210
     C           D2PCLR    IFNE *BLANKS                                                       CSW210
     C                     MOVE D2PCLR    WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCSSN    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    PPCLR                                               CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *
     C                     END
      *
     C                     ENDSR
      *
     C/COPY WNCPYSRC,SE1808C034
      *****************************************************************
      /TITLE SR/SRSTOF
      *****************************************************************
      *                                                               *
      **  SRSTOF    - TO MOVE SCREEN FIELDS TO FILE FIELDS            *
      **                                                              *
      **  CALLED BY -                                                 *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRSTOF    BEGSR
      *
      ** Move key fields to file fields
     C                     MOVE PDPSS     D2DPSS
     C                     MOVE PDPRN     D2DPRN
     C                     MOVE PWHEN     D2WHEN                          CSW003
      *
     C                     MOVE WWAFPN    D2AFPN
     C                     MOVE SAFPL     D2AFPL
      *
     C           SBOFN     IFNE *BLANKS
     C           SBOF1     ORNE *BLANKS
     C                     MOVE SAWIA     D2AWIA
     C                     MOVE WWAWIN    D2AWIN
     C                     MOVE SAWIL     D2AWIL
     C                     ELSE
     C                     MOVE *BLANKS   D2AWIA
     C                     MOVE *BLANKS   D2AWIN
     C                     MOVE *BLANKS   D2AWIL
     C                     END
      *
     C           SAWIN     IFNE *BLANKS
     C           SAWIL     ORNE *BLANKS
     C           *IN78     OREQ *ON                                                           201429
     C                     MOVE SBOFA     D2BOFA
     C                     MOVE WWBOFN    D2BOFN
     C                     MOVE SBOF1     D2BOF1
     C           CSW210    IFEQ 'N'                                                           CSW210
     C                     MOVE SBOF2     D2BOF2
     C                     ENDIF                                                              CSW210
     C                     ELSE
     C                     MOVE *BLANKS   D2BOFA
     C                     MOVE *BLANKS   D2BOFN
     C                     MOVE *BLANKS   D2BOF1
     C                     MOVE *BLANKS   D2BOF2
     C                     END
      *
     C***********          MOVE SACL1     D2ACL1                          CSW003
     C***********          MOVE SACL2     D2ACL2                          CSW003
     C                     MOVE SSRL1     D2SRL1
     C                     MOVE SSRL2     D2SRL2
     C                     MOVE SSRL3     D2SRL3
     C                     MOVE SFIN1     D2FIN1
     C                     MOVE SFIN2     D2FIN2
     C                     MOVE SRED1     D2RED1
     C                     MOVE SRED2     D2RED2
     C                     MOVE SNAL1     D2NAL1
     C                     MOVE SNAL2     D2NAL2
     C                     MOVE WWIPYN    D2IPYN
     C                     MOVE SIPYL     D2IPYL
     C                     MOVE WWCTYN    D2CTYN
     C                     MOVE SCTYL     D2CTYL
     C                     MOVE WWSKAN    D2SKAN
     C                     MOVE SSKAL     D2SKAL
     C                     MOVE SCCTN     D2CCTN
     C                     MOVE SDCTL     D2DCTL
     C                     MOVE SRSSA     D2RSSA
     C                     MOVE WWRSSN    D2RSSN
     C                     MOVE SRSS1     D2RSS1
     C                     MOVE SRSS2     D2RSS2
     C                     MOVE SRSS3     D2RSS3
     C                     MOVE SRSS4     D2RSS4
     C                     MOVE SDSSA     D2DSSA
     C                     MOVE WWDSSN    D2DSSN
     C                     MOVE SDSS1     D2DSS1
     C                     MOVE SDSS2     D2DSS2
     C                     MOVE SDSS3     D2DSS3
     C                     MOVE SDSS4     D2DSS4
     C           SRSSN     IFNE *BLANKS
     C           SRSS1     ORNE *BLANKS
     C           SDSSN     ORNE *BLANKS
     C           SDSS1     ORNE *BLANKS
     C                     MOVE SBSSA     D2BSSA
     C                     MOVE WWBSSN    D2BSSN
     C                     MOVE SBSS1     D2BSS1
     C                     MOVE SBSS2     D2BSS2
     C                     ELSE
     C                     MOVE *BLANKS   D2BSSA
     C                     MOVE *BLANKS   D2BSSN
     C                     MOVE *BLANKS   D2BSS1
     C                     MOVE *BLANKS   D2BSS2
     C                     END
     C**********           MOVE WWINVE    D2INVE                                       CSW098 CSW210
     C                     MOVE SINVE     D2INVE                                              CSW210
      *
      ** Move new fields from new screen to file fields                                       CSE028
      *                                                                                       CSE028
     C           CSE028    IFEQ 'Y'                                                           CSE028
     C                     MOVE PIMMD1    D2IMD1                                              CSE028
     C                     MOVE PIMMD2    D2IMD2                                              CSE028
     C                     MOVE PIMMD3    D2IMD3                                              CSE028
     C                     MOVE PIMMD4    D2IMD4                                              CSE028
     C                     MOVE PIMMD5    D2IMD5                                              CSE028
     C                     MOVE PIMMD6    D2IMD6                                              CSE028
     C                     MOVE PIMMD7    D2IMD7                                              CSE028
     C                     MOVE PIMMD8    D2IMD8                                              CSE028
     C                     MOVE PIMMD9    D2IMD9                                              CSE028
     C                     MOVE PIMSA1    D2IMS1                                              CSE028
     C                     MOVE PIMSA2    D2IMS2                                              CSE028
     C                     MOVE PIMSA3    D2IMS3                                              CSE028
     C                     MOVE PIMSA4    D2IMS4                                              CSE028
     C                     MOVE PIMSA5    D2IMS5                                              CSE028
     C                     MOVE PIMSA6    D2IMS6                                              CSE028
     C                     MOVE PIMSA7    D2IMS7                                              CSE028
     C                     MOVE PIMSA8    D2IMS8                                              CSE028
     C                     MOVE PIMSA9    D2IMS9                                              CSE028
     C                     MOVE PPSET     D2PSET                                              CSE028
     C                     MOVE PNARR1    D2NAC1                                              CSE028
     C                     MOVE PNARR2    D2NAC2                                              CSE028
     C                     ENDIF                                                              CSE028
      *                                                                                       CSE028
     C           CSW210    IFEQ 'Y'                                                           CSW210
     C                     MOVELWDIDN     D2DIDN                                              CSW210
     C                     MOVE SDLIN     D2DLIN                                              CSW210
     C                     MOVE SDAD1     D2DAD1                                              CSW210
     C                     MOVE SDAD2     D2DAD2                                              CSW210
     C                     MOVE SDAD3     D2DAD3                                              CSW210
     C                     MOVE SDAD4     D2DAD4                                              CSW210
      *Other fields                                                                           CSW210
     C                     MOVE PQFIN     D2QFIN                                              CSW210
     C                     MOVE PPCLR     D2PCLR                                              CSW210
     C           CFT004    IFEQ 'Y'                                                           CSW210
     C                     MOVE WFAP1     D2FAP1                                              CSW210
     C                     MOVE WFDBT     D2FDBT                                              CSW210
     C                     MOVE WFAI1     D2FAI1                                              CSW210
     C                     MOVE WFBF1     D2FBF1                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR
      *
      *****************************************************************
     C/COPY WNCPYSRC,SE1808C003
      /TITLE SR/*PSSR
      *****************************************************************
      *                                                               *
      **  *PSSR     - TO HANDLE DATABASE ERRORS                       *
      *                                                               *
      **  CALLED BY -                                                 *
      **  CALLS     -                                                 *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C           WRUN      IFEQ *BLANK
     C/COPY WNCPYSRC,SE1808C035
     C                     MOVE 'Y'       WRUN    1
     C                     MOVEL'SE1808'  DBPGM
     C           *NAMVAR   DEFN LDA       WLDA  256
     C           *LOCK     IN   WLDA
     C                     MOVE DBERR     WLDA
     C                     OUT  WLDA
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     END
      *
      ** Call standard DB error handler
     C                     CALL 'DBERRCTL'             81
      *
     C                     ENDSR
      *
      /EJECT                                                              CSW098
      *****************************************************************   CSW098
      *****************************************************************                CSW098 CSW210
      ****SRINVE****-*To*Validate*Investor*****************************                CSW098 CSW210
      *****************************************************************                CSW098 CSW210
      ****Calls*****-*SRCUST*******************************************                CSW098 CSW210
      ****Called*By*-*SRVAL********************************************                CSW098 CSW210
      *****************************************************************                CSW098 CSW210
      *****************************************************************   CSW098
      *********                                                                        CSW098 CSW210
     C*********  SRINVE    BEGSR                                                       CSW098 CSW210
      *********                                                                        CSW098 CSW210
     C*********  SINVE     IFNE *BLANKS                                                CSW098 CSW210
      *********                                                                        CSW098 CSW210
     C*********  *IN19     IFEQ *OFF                                                   CSW098 CSW210
     C*********            MOVELSINVE     WWCUST                                       CSW098 CSW210
     C*********            EXSR SRCUST                                                 CSW098 CSW210
      *********                                                                        CSW098 CSW210
     C*********            SELEC                                                       CSW098 CSW210
     C*********  WWCUSS    WHEQ 'C'                                                    CSW098 CSW210
     C*********  WWCUSS    OREQ 'S'                                                    CSW098 CSW210
     C*********            MOVELBBCUST    WWINVE 10                                    CSW098 CSW210
     C*********  WWCUSS    WHEQ 'N'                                                    CSW098 CSW210
     C*********            MOVELAWCPNC    WWINVE                                       CSW098 CSW210
      *********                                                                        CSW098 CSW210
      ***Set*on error indicator for Investor.                                          CSW098 CSW210
     C*********            OTHER                                                       CSW098 CSW210
     C*********            MOVE *ON       *IN19                                        CSW098 CSW210
     C*********            ENDSL                                                       CSW098 CSW210
      *********                                                                        CSW098 CSW210
     C*********            ENDIF                                                       CSW098 CSW210
      *********                                                                        CSW098 CSW210
     C*********            ELSE                                                        CSW098 CSW210
     C*********            MOVE *BLANKS   WWINVE                                       CSW098 CSW210
     C*********            ENDIF                                                       CSW098 CSW210
      *********                                                                        CSW098 CSW210
     C*********            ENDSR                                                       CSW098 CSW210
      *********                                                                        CSW098 CSW210
      *****************************************************************   CSW098
      /EJECT                                                              CSW098
      *****************************************************************   CSW098
      **                                                              *   CSW098
      **  SRME99    - To Validate Account with Line via ME9940        *   CSW098
      **                                                              *   CSW098
      **  Calls     -                                                 *   CSW098
      **  Called By - SRAWIL, SRBOF1                                  *   CSW098
      **                                                              *   CSW098
      *****************************************************************   CSW098
      *                                                                   CSW098
     C           SRME99    BEGSR                                          CSW098
      *                                                                   CSW098
     C                     CALL 'ME9940'                                  CSW098
     C                     PARM           W0RTN   7                       CSW098
     C                     PARM           I#PARM                          CSW098
     C                     PARM           O#PARM                          CSW098
     C                     PARM           E#PARM                          CSW098
     C                     PARM           Z#PARM256                       CSW098
      *                                                                   CSW098
     C                     MOVELO#ACLN    WWLI35                          CSW098
     C           E#ERRM    IFNE *BLANKS                                   CSW098
     C                     MOVEL'Y'       WWER35                          CSW098
     C                     MOVE *ON       *IN75                           CSW098
     C                     ELSE                                           CSW098
      *                                                                   CSW098
      ** Check whether Issuer Code has been defined for the currency      CSW098
      ** clearing system. If not, set flag on to issue warning message    CSW098
      ** for later display (SEW5176).                                     CSW098
     C                     MOVELZ#PARM    W#ISCD  4                       CSW098
     C           WWLI02    IFEQ '//'                                      CSW098
     C           W#ISCD    ANDEQ*BLANKS                                   CSW098
     C           O#ACLN    ANDNEWACLN                                     CSW098
     C                     MOVEL'Y'       WICNIL  1                       CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ENDSR                                          CSW098
      *****************************************************************   CSW098
      /EJECT                                                                                  CSW201
      *****************************************************************                       CSW201
      **                                                              *                       CSW201
      **  SR2001    - To Validate Swift2001 Codewords                 *                       CSW201
      **                                                              *                       CSW201
      **  Calls     - None                                            *                       CSW201
      **  Called By - SRSRL1, SRSRL2, SRSRL3                          *                       CSW201
      **                                                              *                       CSW201
      *****************************************************************                       CSW201
      *                                                                                       CSW201
     C           SR2001    BEGSR                                                              CSW201
      *                                                                                       CSW201
     C                     MOVEAWWSR10    WARY                                                CSW201
     C                     MOVE 'N'       WERR    1                                           CSW201
     C                     Z-ADD1         X       30                                          CSW201
      *                                                                                       CSW201
     C           X         DOWLT10                                                            CSW201
     C           WERR      ANDEQ'N'                                                           CSW201
     C                     ADD  1         X                                                   CSW201
     C           WARY,X    LOKUPVA0                      90                                   CSW201
      *                                                                                       CSW201
     C           WARY,X    IFEQ '/'                                                           CSW201
     C                     LEAVE                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           *IN90     IFEQ *OFF                                                          CSW201
     C           X         OREQ 10                                                            CSW201
     C           WARY,X    ANDNE'/'                                                           CSW201
     C                     MOVE 'Y'       WERR                                                CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDDO                                                              CSW201
      *                                                                                       CSW201
     C           WARY,2    IFNE '/'                                                           CSW201
     C           WERR      ANDEQ'N'                                                           CSW201
     C                     MOVE 'Y'       WWVALI                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDSR                                                              CSW201
      *                                                                                       CSW201
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRDIDN    - To Validate Debtor Identification               *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - None                                            *                       CSW210
      **  Called By - SRVAL                                           *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRDIDN    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVEL*BLANKS   WDIDN                                               CSW210
      *                                                                                       CSW210
      ** Validate if not blank                                                                CSW210
     C           SDIDN     IFNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
     C           WWINST    IFEQ 'DELFREE'                                                     CSW210
     C           WWINST    OREQ 'RECFREE'                                                     CSW210
     C                     SETON                     9375                                     CSW210
     C                     MOVEL'ST00112' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
     C           SDAD1     IFNE *BLANKS                                                       CSW210
     C           SDAD2     ORNE *BLANKS                                                       CSW210
     C           SDAD3     ORNE *BLANKS                                                       CSW210
     C           SDAD4     ORNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
     C                     SETON                     9375                                     CSW210
     C                     MOVEL'ST00113' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** Set error indicator on this field before validation                                  CSW210
     C                     SETON                     93                                       CSW210
      *                                                                                       CSW210
      ** Validate Customer no/Shortname/Nostro                                                CSW210
     C                     MOVE SDIDN     WWCUST                                              CSW210
     C                     EXSR SRCUST                                                        CSW210
      *                                                                                       CSW210
      ** Reser error indicator if field is valid                                              CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C           WWCUSS    OREQ 'N'                                                           CSW210
     C                     SETOF                     93                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Customer no/Shortname                                                                CSW210
     C           WWCUSS    IFEQ 'C'                                                           CSW210
     C           WWCUSS    OREQ 'S'                                                           CSW210
     C                     MOVELBBCUST    WDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Nostro                                                                               CSW210
     C           WWCUSS    IFEQ 'N'                                                           CSW210
     C                     MOVELAWCPNC    WDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVELSDIDN     SDIDN1  1                                           CSW210
     C           SDIDN1    IFEQ '?'                                                           CSW210
     C                     MOVELWDIDN     SDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      ** Else if screen field is blank, ensure workfield is also blank                        CSW210
     C                     MOVE *BLANKS   WDIDN                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRDADD    - To Validate Debtor Address                      *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - SRVLDS, SRVLDC                                  *                       CSW210
      **  Called By - SRVAL                                           *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRDADD    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVEL*BLANKS   WDACS  35                                           CSW210
      *                                                                                       CSW210
      ** Validate if not blank                                                                CSW210
     C           SDAD1     IFNE *BLANKS                                                       CSW210
     C           SDAD2     ORNE *BLANKS                                                       CSW210
     C           SDAD3     ORNE *BLANKS                                                       CSW210
     C           SDAD4     ORNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
     C           WWINST    IFEQ 'DELFREE'                                                     CSW210
     C           WWINST    OREQ 'RECFREE'                                                     CSW210
     C                     SETON                     959697                                   CSW210
     C                     SETON                     9875                                     CSW210
     C                     MOVEL'ST00112' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
      ** VALIDATION                                                                           CSW210
      ** WWDADC = DEBTOR ADDRESS CATEGORY                                                     CSW210
      ** S = SWIFT                                                                            CSW210
      ** R = code word                                                                        CSW210
      ** A = Address                                                                          CSW210
     C                     MOVE *BLANK    WWDADC  1                                           CSW210
      *                                                                                       CSW210
      * START SWIFT ADDRESS VALIDATION                                                        CSW210
     C           WWDADC    IFEQ *BLANK                                                        CSW210
      ** If first 11 characters used                                                          CSW210
     C           ADCH26    IFEQ *BLANKS                                                       CSW210
     C           ADEXSW    ANDEQ*BLANKS                                                       CSW210
     C           ADSLSH    ANDNE'/'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVELSDAD1     WDACS                                               CSW210
      * Validate SWIFT address                                                                CSW210
     ** check for invalid characters                                                          CSW210
     C                     MOVEL*BLANKS   WFLD                                                CSW210
     C                     MOVELWDACS     WFLD                                                CSW210
     C                     EXSR SRVLDC                                                        CSW210
     C           WINVC     IFEQ 'Y'                                                           CSW210
     C                     SETON                     9575                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
     C                     MOVELWDACS     WSWIFT 12                                           CSW210
     C                     EXSR SRVLDS                                                        CSW210
     C           WCCSID    IFEQ 'Y'                                                           CSW210
      *                                                                                       CSW210
     C           WSWER1    IFEQ 'Y'                                                           CSW210
     C                     SETON                     9575                                     CSW210
     C                     MOVEL'ST00078' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
     C                     MOVE 'S'       WWDADC                                              CSW210
      *                                                                                       CSW210
     C           WSWER2    IFEQ 'Y'                                                           CSW210
     C           WSWER1    ANDEQ'N'                                                           CSW210
      *                                                                                       CSW210
     C           WWADD     IFNE 'N'                                                           CSW210
     C           WDACS     ANDEQWDACT                                                         CSW210
     C                     MOVE 'N'       WWADD                                               CSW210
     C                     ELSE                                                               CSW210
     C           WDACS     IFNE WDACT                                                         CSW210
     C                     SETON                     95                                       CSW210
     C                     MOVE 'Y'       WWADD   1                                           CSW210
     C                     MOVEL'ST00079' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      * END SWIFT ADDRESS VALIDATION                                                          CSW210
      *                                                                                       CSW210
      * START /CODEWORD/ VALIDATION                                                           CSW210
     C           WWDADC    IFEQ *BLANK                                                        CSW210
      *                                                                                       CSW210
     C           ADSLSH    IFEQ '/'                                                           CSW210
      *                                                                                       CSW210
     C                     MOVE 'R'       WWDADC                                              CSW210
     C                     MOVELSDAD1     PASWCD 35                                           CSW210
     C                     EXSR SRVCDE                                                        CSW210
      *                                                                                       CSW210
     C           WMEMID    IFEQ *BLANKS                                                       CSW210
      *                                                                                       CSW210
      * LINE 2 IS MANDATORY                                                                   CSW210
     C           SDAD2     IFEQ *BLANKS                                                       CSW210
     C                     SETON                     9675                                     CSW210
     C                     MOVEL'ST00122' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
     C                     MOVELSDAD2     WFLD                                                CSW210
     C                     EXSR SRVLDC                                                        CSW210
     C           WINVC     IFEQ 'Y'                                                           CSW210
     C                     SETON                     9675                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      * LINES 3 AND 4 SHOULD BE BLANKS                                                        CSW210
     C           SDAD3     IFNE *BLANKS                                                       CSW210
     C           SDAD4     ORNE *BLANKS                                                       CSW210
     C                     SETON                     979875                                   CSW210
     C                     MOVEL'ST00123' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      ** ERROR ON SWIFT CODE                                                                  CSW210
     C                     SETON                     9575                                     CSW210
     C                     MOVELWMEMID    ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      * END /CODEWORD/ VALIDATION                                                             CSW210
      *                                                                                       CSW210
      * START ADDRESS VALIDATION                                                              CSW210
     C           WWDADC    IFEQ *BLANK                                                        CSW210
      * EMBEDDED BLANKS                                                                       CSW210
     C           SDAD1     IFEQ *BLANKS                                                       CSW210
     C           ADCH26    ANDNE*BLANKS                                                       CSW210
     C           SDAD2     OREQ *BLANKS                                                       CSW210
     C           ADCH36    ANDNE*BLANKS                                                       CSW210
     C           SDAD3     OREQ *BLANKS                                                       CSW210
     C           SDAD4     ANDNE*BLANKS                                                       CSW210
     C                     SETON                     959697                                   CSW210
     C                     SETON                     9875                                     CSW210
     C                     MOVEL'ST00080' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
     C                     MOVELSDAD1     WFLD                                                CSW210
     C                     EXSR SRVLDC                                                        CSW210
     C           WINVC     IFEQ 'Y'                                                           CSW210
     C                     SETON                     9575                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVELSDAD2     WFLD                                                CSW210
     C                     EXSR SRVLDC                                                        CSW210
     C           WINVC     IFEQ 'Y'                                                           CSW210
     C                     SETON                     9675                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVELSDAD3     WFLD                                                CSW210
     C                     EXSR SRVLDC                                                        CSW210
     C           WINVC     IFEQ 'Y'                                                           CSW210
     C                     SETON                     9775                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     MOVELSDAD4     WFLD                                                CSW210
     C                     EXSR SRVLDC                                                        CSW210
     C           WINVC     IFEQ 'Y'                                                           CSW210
     C                     SETON                     9875                                     CSW210
     C                     MOVEL'ST00081' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** Consider as Address if valid                                                         CSW210
     C           *IN95     IFEQ *OFF                                                          CSW210
     C           *IN96     ANDEQ*OFF                                                          CSW210
     C           *IN97     ANDEQ*OFF                                                          CSW210
     C           *IN98     ANDEQ*OFF                                                          CSW210
     C                     MOVE 'A'       WWDADC                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      * END ADDRESS VALIDATION                                                                CSW210
     C                     MOVELWDACS     WDACT                                               CSW210
      ** VALIDATION                                                                           CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRVLDS    - To Validate SWIFT                               *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - None                                            *                       CSW210
      **  Called By - SRDADD                                          *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRVLDS    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE 'N'       WSWER1  1                                           CSW210
     C                     MOVE 'N'       WSWER2  1                                           CSW210
      * Test positions 1-8 for valid SWIFT Characters                                         CSW210
      * Check how many characters are alphanumeric                                            CSW210
     C                     MOVEL'N'       WCCSID  1                                           CSW210
     C                     MOVEL*BLANKS   WFLD   35                                           CSW210
     C                     MOVELWSWIFT    WFLD                                                CSW210
      *                                                                                       CSW210
     C           ALPHAN    CHECKWFLD      X#      30     82                                   CSW210
      * If the first 8 or 11 are ok proceed                                                   CSW210
     C           *IN82     IFEQ *ON                                                           CSW210
     C           X#        ANDEQ9                                                             CSW210
     C           *IN82     OREQ *ON                                                           CSW210
     C           X#        ANDEQ12                                                            CSW210
      *                                                                                       CSW210
     C           ' '       CHECKWFLD:X#                  82                                   CSW210
      * Check for blanks if before 8 or 11 then assume address                                CSW210
     C           *IN82     IFEQ *ON                                                           CSW210
     C           X#        ANDEQ11                                                            CSW210
     C                     MOVE 'Y'       WSWER1                                              CSW210
     C                     MOVE 'Y'       WCCSID                                              CSW210
     C                     GOTO EXVLS                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      * Invalid format - Not a SWIFT                                                          CSW210
     C           *IN82     IFEQ *ON                                                           CSW210
     C                     MOVE 'N'       WCCSID                                              CSW210
     C                     GOTO EXVLS                                                         CSW210
     C                     ENDIF                                                              CSW210
      * Validate identifier                                                                   CSW210
     C                     MOVELWFLD      W9BICC  8                                           CSW210
     C           3         SUBSTWFLD:9    W9BICB  3                                           CSW210
      *                                                                                       CSW210
     C                     CALL 'ME1400'                                                      CSW210
     C                     PARM *BLANKS   @RTCD                                               CSW210
     C                     PARM           W9BICC                                              CSW210
     C                     PARM           W9BICB                                              CSW210
     C                     PARM           SDCUST                                              CSW210
     C                     PARM           SDCNST                                              CSW210
     C                     PARM           MEBICD                                              CSW210
     C                     PARM *BLANKS   W9CUST  1                                           CSW210
     C                     PARM *BLANKS   W9CNST  1                                           CSW210
     C                     PARM *BLANKS   W9BICD  1                                           CSW210
      *                                                                                       CSW210
     C                     SELEC                                                              CSW210
      *  Record not found on directory but found on others                                    CSW210
      *  - BIC directory has data so error                                                    CSW210
     C           @RTCD     WHEQ 'MIN0244'                                                     CSW210
     C           @RTCD     OREQ 'MIN0244'                                                     CSW210
     C           @RTCD     OREQ 'MIN0246'                                                     CSW210
     C                     MOVE 'Y'       WSWER1                                              CSW210
     C                     MOVE 'Y'       WCCSID                                              CSW210
      *  Record not found - S.W.I.F.T does not exist                                          CSW210
     C           @RTCD     WHEQ 'Y2U0005'                                                     CSW210
     C                     MOVE 'Y'       WSWER2                                              CSW210
     C                     MOVE 'Y'       WCCSID                                              CSW210
      *  Record found - BIC exists                                                            CSW210
     C           @RTCD     WHEQ *BLANKS                                                       CSW210
     C                     MOVE 'Y'       WCCSID                                              CSW210
     C                     ENDSL                                                              CSW210
      *                                                                                       CSW210
     C           EXVLS     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRVLDC    - To Check for invalid SWIFT Characters           *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - None                                            *                       CSW210
      **  Called By - SRDADD                                          *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRVLDC    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE 'N'       WINVC   1                                           CSW210
     C           ISO       CHECKWFLD                     82                                   CSW210
     C           *IN82     IFEQ *ON                                                           CSW210
     C                     MOVE 'Y'       WINVC                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRDLIN    - To Validate Debtor Account Line                 *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - None                                            *                       CSW210
      **  Called By - SRVAL                                           *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRDLIN    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE 'N'       WFDBT                                               CSW210
     C           SDLIN     IFNE *BLANKS                                                       CSW210
      *                                                                                       CSW210
     C           WWINST    IFEQ 'DELFREE'                                                     CSW210
     C           WWINST    OREQ 'RECFREE'                                                     CSW210
     C                     SETON                     9475                                     CSW210
     C                     MOVEL'ST00112' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
     C           SDIDN     IFEQ *BLANKS                                                       CSW210
     C           SDAD1     ANDEQ*BLANKS                                                       CSW210
     C           SDAD2     ANDEQ*BLANKS                                                       CSW210
     C           SDAD3     ANDEQ*BLANKS                                                       CSW210
     C           SDAD4     ANDEQ*BLANKS                                                       CSW210
     C                     SETON                     9475                                     CSW210
     C                     MOVEL'ST00082' ZAMSID                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSGF                                              CSW210
     C                     EXSR SRSMSG                                                        CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C  N94      CSW210    IFEQ 'Y'                                                           CSW210
     C           CFT004    ANDEQ'Y'                                                           CSW210
     C                     MOVELSDLIN     DSIBAN                                              CSW210
     C                     EXSR SRIBAN                                                        CSW210
      *                                                                                       CSW210
     C                     MOVE WVIBAN    WFDBT                                               CSW210
     C           WIBRTN    IFNE *BLANKS                                                       CSW210
     C                     MOVE 'N'       WWDLN                                               CSW210
     C                     MOVELWIBRTN    SDLIN                                               CSW210
     C                     ELSE                                                               CSW210
     C           WWDLN     IFNE 'N'                                                           CSW210
     C           SDLIN     ANDEQWDLIN                                                         CSW210
     C                     MOVE 'N'       WWDLN                                               CSW210
     C                     ELSE                                                               CSW210
     C  N94      SDLIN     IFNE WDLIN                                                         CSW210
     C           WIBNWR    ANDEQ'Y'                                                           CSW210
     C                     MOVELWTIBAN    SDLIN                                               CSW210
     C                     SETON                     94                                       CSW210
     C                     MOVE 'Y'       WWDLN                                               CSW210
     C                     MOVELS210W,3   ZAMDT1                                              CSW210
     C                     MOVEL'SEUSRMSG'ZAMSG1                                              CSW210
     C                     EXSR SRMSG1                                                        CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
     C                     MOVELSDLIN     WDLIN                                               CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      **                                                              *                       CSW210
      **  SRIBAN    - To Check IBAN                                   *                       CSW210
      **                                                              *                       CSW210
      **  Calls     - None                                            *                       CSW210
      **  Called By -                                                 *                       CSW210
      **                                                              *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRIBAN    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Temporary work variable for IBAN                                                     CSW210
     C                     MOVEL*BLANKS   WIBRTN 35                                           CSW210
     C                     MOVEL*BLANKS   WTIBAN 34                                           CSW210
     C                     MOVEL*BLANKS   WTIBA1 47                                           CSW210
     C                     MOVEL'N'       WVIBAN  1                                           CSW210
     C                     MOVEL'N'       WIBNWR  1                                           CSW210
     C           DSISLH    IFEQ '/'                                                           CSW210
     C                     MOVELDSIBN2    WTIBA1                                              CSW210
     C                     ELSE                                                               CSW210
     C                     MOVELDSIBAN    WTIBA1                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     CALL 'AOIBANR3'                                                    CSW210
     C                     PARM *BLANKS   @RTCD                                               CSW210
     C                     PARM           WTIBA1                                              CSW210
     C                     PARM           WIBLNK 47                                           CSW210
     C                     PARM           WOBLNK 34                                           CSW210
      *                                                                                       CSW210
     C           2         SUBSTWOBLNK:1  WOBCH   2                                           CSW210
     C           2         SUBSTWOBLNK:3  WOBNB   2                                           CSW210
      *                                                                                       CSW210
     C           ALPHA     CHECKWOBCH                    82                                   CSW210
     C  N82      NMBRS     CHECKWOBNB                    82                                   CSW210
      *                                                                                       CSW210
      ** IBAN starts with 'AANN'                                                              CSW210
     C           *IN82     IFEQ *OFF                                                          CSW210
     C                     MOVELWOBLNK    WTIBAN                                              CSW210
      *                                                                                       CSW210
     C                     CALL 'AOIBANR5'             82                                     CSW210
     C                     PARM *BLANKS   @RTCD                                               CSW210
     C                     PARM           WTIBAN                                              CSW210
      *                                                                                       CSW210
     C           @RTCD     IFEQ *BLANKS                                                       CSW210
     C           *IN82     ANDEQ*OFF                                                          CSW210
     C                     MOVEL'Y'       WVIBAN                                              CSW210
     C                     MOVELWTIBAN    WIBRTN                                              CSW210
     C                     ELSE                                                               CSW210
     C                     SELEC                                                              CSW210
     C           @RTCD     WHEQ '      1'                                                     CSW210
     C                     MOVEL'ST00102' ZAMSI1                                              CSW210
     C           @RTCD     WHEQ '      2'                                                     CSW210
     C                     MOVEL'ST00103' ZAMSI1                                              CSW210
     C           @RTCD     WHEQ '      3'                                                     CSW210
     C                     MOVEL'ST00104' ZAMSI1                                              CSW210
     C           @RTCD     WHEQ '      4'                                                     CSW210
     C                     MOVEL'ST00105' ZAMSI1                                              CSW210
     C           @RTCD     WHEQ '      5'                                                     CSW210
     C                     MOVEL'ST00106' ZAMSI1                                              CSW210
     C                     OTHER                                                              CSW210
     C                     MOVEL'ST00107' ZAMSI1                                              CSW210
     C                     ENDSL                                                              CSW210
     C                     MOVEL'Y'       WIBNWR                                              CSW210
     C********** DSISLH    IFEQ '/'                                                  CSW210 AR642262
     C********** '/'       CAT  WTIBAN    WTIBAN                                     CSW210 AR642262
     C**********           ENDIF                                                     CSW210 AR642262
     C                     MOVELDSIBAN    WTIBAN                                            AR642262
     C                     ENDIF                                                              CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      *                                                               *                       CSW210
      * SRMSG1  - Routine to send messages to message subfile.        *                       CSW210
      *                                                               *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRMSG1    BEGSR                                                              CSW210
      *                                                                                       CSW210
      ** Send specified message from specified message file to program                        CSW210
      ** message queue; then clear message id and message file                                CSW210
     C                     CALL 'ZA0350'                                                      CSW210
     C                     PARM           ZAMSG1 10                                           CSW210
     C                     PARM           ZAMSI1 10                                           CSW210
     C                     PARM           ZAMDT1 45                                           CSW210
      *                                                                                       CSW210
     C                     MOVEL*BLANK    ZAMSG1                                              CSW210
     C                     MOVEL*BLANK    ZAMSI1                                              CSW210
     C                     MOVEL*BLANK    ZAMDT1                                              CSW210
      *                                                                                       CSW210
     C                     ENDSR                                                              CSW210
      *****************************************************************                       CSW210
      /EJECT                                                                                  CSW210
      *****************************************************************                       CSW210
      *                                                               *                       CSW210
      * SRVCDE  - Checks the syntax of code word                      *                       CSW210
      *                                                               *                       CSW210
      *****************************************************************                       CSW210
      *                                                                                       CSW210
     C           SRVCDE    BEGSR                                                              CSW210
      *                                                                                       CSW210
     C                     MOVE *BLANKS   WMEMID  7                                           CSW210
      *                                                                                       CSW210
      ** check for presence and position of terminating '/'; W@ is                            CSW210
      ** position of second '/'                                                               CSW210
     C           '/'       SCAN PASWCD:2  W@      50     82                                   CSW210
      *                                                                                       CSW210
      ** If second '/' not found - error: codeword must end '/'                               CSW210
     C           *IN82     IFEQ '0'                                                           CSW210
     C                     MOVEL'ST00115' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If '/' is in posn. 2 - error: '//' invalid for codeword                              CSW210
     C           W@        IFEQ 2                                                             CSW210
     C                     MOVEL'ST00116' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If '/' is in posn. 11 or greater - error: codeword should be                         CSW210
      ** 8 characters or fewer.                                                               CSW210
     C           W@        IFGT 10                                                            CSW210
      *                                                                                       CSW210
     C           CSW201    IFEQ 'Y'                                                           CSW210
     C                     MOVEL'ST00120' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ELSE                                                               CSW210
     C                     MOVEL'ST00117' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If any characters after second '/' - error: should be blank                          CSW210
     C           35        SUB  W@        W@L     50                                          CSW210
     C           W@        ADD  1         W@P     50                                          CSW210
     C           W@L       SUBSTPASWCD:W@PW@SBBL 32 P                                         CSW210
     C           W@SBBL    IFNE *BLANKS                                                       CSW210
     C                     MOVEL'ST00118' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
      ** If codeword contains non-upper case or non-numeric characters                        CSW210
      *                                                                                       CSW210
     C           CSW201    IFEQ 'Y'                                                           CSW210
      *                                                                                       CSW210
     C           ALPHAN    CHECKPASWCD:2  W@L                                                 CSW210
     C           W@L       IFLT W@                                                            CSW210
     C                     MOVEL'ST00121' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ELSE                                                               CSW210
      *                                                                                       CSW210
      ** If codeword contains non-upper case alpha characters - error:                        CSW210
      ** codeword should be SWIFT 8a.                                                         CSW210
     C           ALPHA     CHECKPASWCD:2  W@L                                                 CSW210
     C           W@L       IFLT W@                                                            CSW210
     C                     MOVEL'ST00119' WMEMID                                              CSW210
     C                     GOTO EXVLC                                                         CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C                     ENDIF                                                              CSW210
      *                                                                                       CSW210
     C           EXVLC     ENDSR                                                              CSW210
      *****************************************************************
      /TITLE SR/ZALIGN
     C/COPY ZSRSRC,ZALIGNZ2
      /TITLE SR/ZDATE1
     C/COPY ZSRSRC,ZDATE1Z2
      /TITLE SR/ZSEDIT
     C/COPY ZSRSRC,ZSEDITZ3
      /TITLE COMPILE-TIME ARRAYS
      ***
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**  VA0  - ALL NUMERIC CHARS
ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
** SVAL - Midas System values                                                                 212326
SWIFTSuppBSForWalkIO                                                                          212326
** CWA - Array for watch list fields                                                          CSD015
<Account for Payment>                                                                         CSD015
</Account for Payment>                                                                        CSD015
<A/C with Institution>                                                                        CSD015
</A/C with Institution>                                                                       CSD015
<Beneficiary>                                                                                 CSD015
</Beneficiary>                                                                                CSD015
<Instructing Party>                                                                           CSD015
</Instructing Party>                                                                          CSD015
<Counterparty>                                                                                CSD015
</Counterparty>                                                                               CSD015
<Safekeeping Account>                                                                         CSD015
</Safekeeping Account>                                                                        CSD015
<Deliverr Instrctg Prty>                                                                      CSD015
</Deliverr Instrctg Prty>                                                                     CSD015
<Receivers of Securties>                                                                      CSD015
</Receivers of Securties>                                                                     CSD015
<Deliverrs of Securties>                                                                      CSD015
</Deliverrs of Securties>                                                                     CSD015
<Benfciary of Securties>                                                                      CSD015
</Benfciary of Securties>                                                                     CSD015
<Investor>                                                                                    CSD015
</Investor>                                                                                   CSD015
<Debtor>                                                                                      CSW210
</Debtor>                                                                                     CSW210
<Qual Foreign Intmdiary>                                                                      CSW210
</Qual Foreign Intmdiary>                                                                     CSW210
<Sttlmnt Prty Intmdiary>                                                                      CSD015
</Sttlmnt Prty Intmdiary>                                                                     CSD015
<Safkeepg A/C Intmdiary>                                                                      CSD015
</Safkeepg A/C Intmdiary>                                                                     CSD015
** S210W                                                                                      CSW210
A/c for Payment Account Line                                                                  CSW210
A/c with Institution Account Line                                                             CSW210
Debtor Account Line                                                                           CSW210
Beneficiary of Money Account Line                                                             CSW210
