000100200529     H        1
000200200529      *****************************************************************
000300200529/*STD *  RPGBASE                                                      *
000400200529/*EXI *  TEXT('Midas SE Extract security actions')                    *
000500200529/*OVRF*: OVRDBF FILE(SECTYX) TOFILE(SECTY) SHARE(*NO)               : *
000600200529/*OVRF*: OVRDBF FILE(SEDELX) TOFILE(SEDEL) SHARE(*NO)               : *
000700200529/*OVRF*: OVRDBF FILE(SECEU)  TOFILE(SECET) SHARE(*NO)               : *180385
000800200529     F*****************************************************************
000900200529     F*                                                               *
001000200529     F*  Midas - Securities Trading Module
001100200529     F*                                                               *
001200200529     F*  SE2100 - EXTRACT SECURITY ACTIONS                            *
001300200529     F*                                                               *
001400200529     F*  Function: The Security and Security Diary Files are read.    *
001500200529     F*   (COB)    For each Security, Events are extracted from each  *
001600200529     F*            File, which require action on Positions (Book,     *
001700200529     F*            Customer or Depot). The PFs Security Diary Events  *
001800200529     F*            and Security Non-Diary Events are updated.         *
001900200529     F*            The Security is also updated with information from *
002000200529     F*            the Security Diary, and the Record ID of maturing  *
002100200529     F*            securities is changed to 'M'.                      *
002200200529     F*                                                               *
002300200529     F*            Events requiring action are:                       *
002400200529     F*            1. Security record: Coupon or Maturity Date due.   *
002500200529     F*            2. Security Diary: all other Events:               *
002600200529     F*                  DV - Dividend                                *
002700200529     F*                  PP - PP Call                                 *
002800200529     F*                  MP - Mortgage Payment                        *
002900200529     F*                  IR - Interest Rate Change                    *
003000200529     F*                  RC - Redemption Call                         *
003100200529     F*                  RP - Redemption Put                          *
003200200529     F*                                                               *
003300200529     F*            Events are extracted for generation of Position    *
003400200529     F*            Settlements and flagged: 'Posn Settls reqd' = Y    *
003500200529     F*                                     'A/c Key reqd' = N        *
003600200529     F*                                                               *
003700200529     F*  Called by: SEC0602A - Extract Security Action                *
003800200529     F*                                                               *
003900200529      *  (c) Finastra International Limited 2001                      *
004000200529      *                                                               *
004100200604      *  Last Amend No. 247420             Date 22May20               *
004200200529      *  Prev Amend No. MD049798           Date 09May19               *
004300200529      *                 MD046248           Date 27Oct17               *
004400200529      *                 CRE073             Date 06Dec10               *
004500200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
004600200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
004700200529      * Midas Plus 1.4 Base ------------------------------------------*
004800200529      * Midas Plus 1.3 ----------- Base ------------------------------*
004900200529      *                 CSD027             Date 09Dec05               *
005000200529      *                 CSE075             Date 06Mar06               *
005100200529      *                 CSE075             Date 17Nov05               *
005200200529      *                 CSE065             Date 08Nov04               *
005300200529      *                 CSE071             Date 19Jul05               *
005400200529      *                 CAS008             Date 11May04               *
005500200529      *                 206595             Date 18Jul02               *
005600200529      *                 CAS006             Date 21Jan03               *
005700200529      *                 CSE037             Date 29Apr02               *
005800200529      *                 CSE035             Date 22Apr02               *
005900200529      * Midas Release 4.01.02 ----------------------------------------*
006000200529      *                 211228             Date 11Nov02               *
006100200529      *                 206316             Date 19Jul02               *
006200200529      *                 180385             Date 13Jul00               *
006300200529      * Midas Release 4.01 -------------------------------------------*
006400200529      *                 CSE031             Date 09Nov01               *
006500200529      *                 182505             Date 12Dec01               *
006600200529      *                 180707             Date 12Dec01               *
006700200529      *                 197357             Date 24Nov01               *
006800200529      *                 175977             Date 30May01               *
006900200529      * Midas Release 4 --------------- Base -------------------------*
007000200529      * Midas DBA 3.05 -----------------------------------------------*
007100200529      *                 CSD006             Date 16May01               *
007200200529      *                 183206             Date 23Mar01               *
007300200529      *                 CAP140             Date 17Oct00               *
007400200529      *                 187825             Date 18Dec00               *
007500200529      * Midas DBA 3.04 -----------------------------------------------*
007600200529      *                 185803             Date 02Nov00               *
007700200529      *                 CSE023             Date 14Aug00               *
007800200529      * Midas DBA 3.03 -----------------------------------------------*
007900200529      *                 170949             Date 09Jun00               *
008000200529      *                 143174             Date 03May00               *
008100200529      * Midas DBA 3.02 -----------------------------------------------*
008200200529     F*                 CPB001             Date 01Jun99               *
008300200529      * Midas DBA 3.00 ---------------- Base -------------------------*
008400200529     F*                 CPL002             Date 08Mar99               *
008500200529     F*                 130862             Date 16Oct98               *
008600200529     F*                 137563             Date 13Jul98               *
008700200529     F*                 CSE005             Date 04Feb97               *
008800200529     F*                 S01408             DATE 27SEP96               *
008900200529     F*                 094576             DATE 04JUL96               *
009000200529     F*                 100228             DATE 31MAY96               *
009100200529     F*                 102885             DATE 07MAY96               *
009200200529     F*                 077649             DATE 24OCT95               *
009300200529     F*                 091254             DATE 20OCT95               *
009400200529     F*                 S01510             DATE 10AUG94               *
009500200529     F*                 S01502             DATE 08JUL94               *
009600200529     F*                 066262             DATE 04AUG94               *
009700200529     F*                 048059             DATE 09FEB94               *
009800200529     F*                 054498             DATE 26NOV93               *
009900200529     F*                 054257             DATE 26NOV93               *
010000200529     F*                 052254             DATE 26NOV93               *
010100200529     F*                 S01401             DATE 16JUN93               *
010200200529     F*                 041031             DATE 01FEB93               *
010300200529     F*                 S01397             DATE 10SEP92               *
010400200529     F*                 E37295             DATE 24MAR92               *
010500200529     F*                 E31622             DATE 25FEB92               *
010600200529     F*                 E29170             DATE 05NOV91               *
010700200529     F*                 E27092             DATE 04SEP91               *
010800200529     F*                 S01117             DATE 06JUN91               *
010900200529     F*                 E23802             DATE 04OCT90               *
011000200529     F*                 E23049             DATE 26JUL90               *
011100200529     F*                 E21588             DATE 10APR90               *
011200200529     F*                 E21616             DATE 03APR90               *
011300200529     F*                 E21305             DATE 06MAR90               *
011400200529     F*                 E21307             DATE 06MAR90               *
011500200529     F*                 E20554             DATE 07DEC89               *
011600200529     F*                 E20142             DATE 07NOV89               *
011700200529     F*                 E20125             DATE 07NOV89               *
011800200529     F*                 E20086             DATE 07NOV89               *
011900200529     F*                 E20085             DATE 07NOV89               *
012000200529     F*                 E15930             DATE 24OCT89               *
012100200529     F*                 E18013             DATE 27/06/89              *
012200200529     F*                 E16772             DATE 31/05/89              *
012300200529     F*                 E18009             DATE 21/04/89              *
012400200529     F*                 E17876             DATE 11/04/89              *
012500200529     F*                 E17704             DATE 31/03/89              *
012600200529     F*                 E14674             DATE 07/12/88              *
012700200529     F*                 S01176             DATE 09/11/88              *
012800200529     F*                 E15549             DATE 04/10/88              *
012900200529     F*                 E14235             DATE 23/09/88              *
013000200529     F*                 E13979             DATE 27/06/88              *
013100200529     F*                 E13524             DATE 14/05/88              *
013200200529     F*                 S01158             DATE 06/05/88              *
013300200529     F*                                                               *
013400200529     F*---------------------------------------------------------------*
013500200529      *                                                               *
013600200529      *  247420 - Rename and increase length of field NORE in file    *
013700200529      *           SNDEVA from NORE(5,0) to SNNORE(7,0).               *
013800200529      *  MD049798 - Last Coupon Date not being updated for zero rate  *
013900200529      *             Securities. Fix is to remove the condition on     *
014000200529      *             coupon rate before generation of coupon event.    *
014100200529      *  MD046248 - Finastra Rebranding                               *
014200200529      *  CRE073 - Interest Rate Rounding (Recompile)                  *
014300200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
014400200529      *  CSE075 - CSE075 Change Control. Display Coupon Delay period  *
014500200529      *           for all interest-bearing securities.                *
014600200529      *  CSE075 - US Enhanced Treasury Upgrade to MidasPlus           *
014700200529      *  CSE065 - Const. Yield Amort. on Mortgage backed assets       *
014800200529      *  CSE071 - Multiple Holidays Re Securities                     *
014900200529      *  CAS008 - Delayed Hedge Assessment (Recompile)                *
015000200529      *  206595 - Apply 194841. To send also 'IR' event to Meridian.  *
015100200529      *  CAS006 - Hedge Accounting Phase B                            *
015200200529      *  CSE037 - Bond Pricing - 3 Decimal Places in Trades Input     *
015300200529      *  CSE035 - NX/NNX Coupon Payment Processing.                   *
015400200529      *  211228 - Some A/C keys are not being produced by the system, *
015500200529      *           due to incorrect Last Coupon Date/Next Coupon Date. *
015600200529      *           Reversed part of fix 197357.                        *
015700200529      *  206316 - If CSE031 is ON, update Event Date on Non-Diary     *
015800200529      *           Events file to be the Next Coupon Date on SECTYD.   *
015900200529      *         - If CSE031 is ON, in SR/IRCHCK only need to check    *
016000200529      *           if XSDED equals NCD.                                *
016100200529      *         - Recompiled over changed ZLCDZ1.                     *
016200200529      *  180385 - CPF5032 I/O error detected in file SEDEL, pgm       *
016300200529      *           SE2100 statement 137100.  Fix patterned after       *
016400200529      *           144477 which used a different update file to        *
016500200529      *           prevent locking problem.                            *
016600200529      *  CSE031 - Coupon Fixing for Floating Rate Notes.              *
016700200529      *  182505 - Interest rate change that falls on holiday was not  *
016800200529      *           adjusted in accordance with CSE005 (Business Day    *
016900200529      *           Convention).                                        *
017000200529      *  180707 - No Position Settlements generated due to wrong Last *
017100200529      *           Coupon Date written to PF/SECACD. Fix is to retain  *
017200200529      *           Previous Next Coupon Date before adjusting to new   *
017300200529      *           Next Coupon Date by SE0045 before executing SR ZLCD.*
017400200529      *  197357 - Next coupon date amended but action was still       *
017500200529      *           generated for the old coupon date eventhough the    *
017600200529      *           said date is not existing in the array. Fix is to   *
017700200529      *           only generate coupon action based on the array.     *
017800200529      *         - Incorrect AI was generated after amendment of the   *
017900200529      *           coupon array due to incorrect Last Coupon date used.*
018000200529      *         - Incorrect last coupon date updated on PF/SNDEVD for *
018100200529      *           event type 'CG'.  Fix is to initialise last coupon  *
018200200529      *           date before writing to SNDEVD.                      *
018300200529      *  175977 - Coupon Rate not updated in SECS option during daily *
018400200529      *           IR event. Changed if-then condition to check diary  *
018500200529      *           events only with dates that are less than the next  *
018600200529      *           working date to make sure update to SECTYD is done. *
018700200529      *  CSD006 - Market Data Feed (Recompile)                        *
018800200529      *  183206 - File out of balance in SE0320, file SEDEVD.  Use    *
018900200529      *           field AKDAT instead of ECD.                         *
019000200529      *  CAP140 - Conversion of SE Security Diary Event inputs into   *
019100200529      *           modular structure to use as APIs.                   *
019200200529      *  187825 - Maturity event not generated for security not cover *
019300200529      *           by treaty tax.                                      *
019400200529      *  185803 - Events for some security not generate in advance.   *
019500200529      *  CSE023 - Treaty Withholding Tax                              *
019600200529     F*  170949 - When a diary event type 'IR' is made the day of the *
019700200529     F*           coupon, the coupon was using the new rate.          *
019800200529     F*           Generate coupon event before diary event.Used 165308*
019900200529     F*  143174 - Fix 094576 causes LCPN to be to be updated too      *
020000200529     F*           early resulting in discrepancies in accrual amounts *
020100200529     F*           Apply fix 134337 (or 145770) which removes 094576   *
020200200529     F*  CPB001 - Meridian DBA Middleware Replication Customization.  *
020300200529     F*           Midas/TOF Interface.                                *
020400200529     F*  CPL002 - Midas-Plato Interface (Recomipled)                  *
020500200529     F*  130862 - Recompiled over changed ZLCDZ1.                     *
020600200529     F*  137563 - IR event that does not match IR change date in      *
020700200529     F*           Security resulted to a wrong Coupon Rate. Fix is to *
020800200529     F*           drop IR events with invalid event date.             *
020900200529     F*  CSE005 - Effect of holidays on FRN Coupon Dates              *
021000200529     F*           (recompilation due to change to ZNCD/ZLCD)          *
021100200529     F*  S01408 - Addition of core hook SE2100OOP1                    *
021200200529     F*           Addition of core hook SE2100IIP1                    *
021300200529     F*           Addition of core hook SE2100FFP1                    *
021400200529     F*           Addition of core hook SE2100FFP2                    *
021500200529     F*           Addition of core hook SE2100FFP3                    *
021600200529     F*           Addition of core hook SE2100EEP1                    *
021700200529     F*           Addition of core hook SE2100CCP1                    *
021800200529     F*           Addition of core hook SE2100CCP2                    *
021900200529     F*           Addition of core hook SE2100CCP3                    *
022000200529     F*           Addition of core hook SE2100CCP4                    *
022100200529     F*           Addition of core hook SE2100CCP5                    *
022200200529     F*           Addition of core hook SE2100CCP6                    *
022300200529     F*           Addition of core hook SE2100CCP7                    *
022400200529     F*           Addition of core hook SE2100CCP8                    *
022500200529     F*           Addition of core hook SE2100CCP9                    *
022600200529     F*           Addition of core hook SE2100CP10                    *
022700200529     F*           Addition of core hook SE2100CP11                    *
022800200529     F*  094576 - Last coupon date not being correctly updated when   *
022900200529     F*           a coupon date is reached. Fix is to update Last     *
023000200529     F*           Coupon Date if Next Coupon Date is less than Date   *
023100200529     F*           of Next Working Day.                                *
023200200529     F*  100228 - RECOMPILE OVER CHANGED SR ZLCDZ1 & ZNCDZ3.          *
023300200529     F*  102885 - If Long Term Maturity is 'Y', pgm added 100 years   *
023400200529     F*           to maturity date which has been already calculated  *
023500200529     F*           correctly during input of the security.             *
023600200529     F*  077649 - REDEMPTION CALL AND REDEMPTION PUT DIARY EVENTS     *
023700200529     F*           UPDATED TO RECI 'M' BEFORE THE VALUE DATE           *
023800200529     F*  091254 - RECOMPILE OVER CHANGED ZLCDZ1 & ZNCDZ3              *
023900200529     F*  S01510 - Dividend payments based on ex-date                  *
024000200529     F*  S01502 - BLI Telekurs Processing.  Recompiled due to change  *
024100200529     F*           in length of SESTAT, 133 long.                      *
024200200529     F*  066262 - Dulpicate 'CP' action being generated on Coupon     *
024300200529     F*           date. Check first if coupon already processed.      *
024400200529     F*  048059 - 'OC' diary events are not being processed.          *
024500200529     F*  054498 - SECURITY EVENTS BEING PROCESSED IN ADVANCE WHEN     *
024600200529     F*           ACCRUE INDICATOR REQUIRES PROCESSING IN ARREARS.    *
024700200529     F*           PROCESSING CONDITIONED ON ECD AND ACCRUAL RUN       *
024800200529     F*           INDICATOR HAS BEEN CHANGED TO REFER TO NEW DATES.   *
024900200529     F*           CALCULATION OF NEXT COUPON DATE HAS BEEN CHANGED    *
025000200529     F*  054257 - RECOMPILED as PREV CURRENT FACTOR amended from 9,8  *
025100200529     F*           to 10,9                                             *
025200200529     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
025300200529     F*           to 10,9                                             *
025400200529     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
025500200529     F*          - Recompiled due to changes to files.                *
025600200529     F*  041031 - Some live diary events were not updated to be       *
025700200529     F*           matured causing database errors on SE1440 for       *
025800200529     F*           securities maturing today. Also amended to show the *
025900200529     F*           correct key for database error on file SEDEL.       *
026000200529     F*           (PM FIX FROM VDF)                                   *
026100200529     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
026200200529     F*          - Recompiled due to changes to files.                *
026300200529     F*  E37295 - Last Coupon Date on SECTYD is updated to Next       *
026400200529     F*           Coupon Date.                                        *
026500200529     F*  E31622 - Diary Event record not being updated with ECD when  *
026600200529     F*           action is written for PP DV MP IR. This causes      *
026700200529     F*           duplicate generated position settlements.           *
026800200529     F*  E29170 - Report Control Facility changes                     *
026900200529     F*  E27092 - Recompiled over changed SR/ZLCD                     *
027000200529     F*  S01117 - Multibranching                                      *
027100200529     F*  E23802 - Diary Events updating Security too early            *
027200200529     F*           Last Dividend date was not updated correctly        *
027300200529     F*  E23049 - Diary Events do not updating Security Properly      *
027400200529     F*         - Xrate currency and Mult/Div ind on an XR change     *
027500200529     F*         - Redemptions were not updating Securiry before ECD   *
027600200529     F*         - Cancelled events were not being removed from the    *
027700200529     F*           Security                                            *
027800200529     F*  E21588 - DB Errors caused by processing Maturity Actions for *   E21588
027900200529     F*           Securities cancelled today. In fact, there is no    *   E21588
028000200529     F*           circumstance where this program should process any  *   E21588
028100200529     F*           cancelled Security.                                 *   E21588
028200200529     F*  NOTE:  - A small amount of deleted code for the following    *
028300200529     F*           errors has been removed in an exercise to clarify   *
028400200529     F*           the processing; S01158 E13542 E13979 E15549.        *
028500200529     F*  E21616 - Recompiled over changed SR/ZLCD.                    *   E21616
028600200529     F*  E21305 - No Account Keys produced for Dividend Event on Type *   E21305
028700200529     F*           '3' Accrual Run.                                    *   E21305
028800200529     F*  E21307 - Position Settlement is required for Maturity Coupon.*   E21307
028900200529     F*  E20554 - Trying to read past end of file on SECET .          *   E20554
029000200529     F*  E20142 - With EOM on Saturday, account keys for coupons due  *   E20142
029100200529     F*           Friday were generated twice, and account keys for   *   E20142
029200200529     F*           coupons and maturities due Saturday were generated  *   E20142
029300200529     F*           in the wrong phase (ANWD1 rather than EGEN1).       *   E20142
029400200529     F*  E20125 - Prevent same security actions being produced on both*   E20125
029500200529     F*           runs at end of week                                 *   E20125
029600200529     F*  E20086 - Mortgage-Backs and Current Factor Processing Rewrite*   E20086
029700200529     F*          - Previous Current Factor on MP Actions is updated   *   E20086
029800200529     F*            incorrectly with the prior Previous Current Factor.*   E20086
029900200529     F*  E20085 - Interest and Coupon Calculations Rewrite:           *   E20085
030000200529     F*          - LF/SECEO member SEDEVD changed to omit RECI = 'C'. *   E20085
030100200529     F*          - E15549 change to call SR/ZNCD was incorrect:       *   E20085
030200200529     F*            Firstly, instead of starting at the Last Coupon and*   E20085
030300200529     F*            looping until GT RUND, we can just start at the Run*   E20085
030400200529     F*            Date and get the NCD after that.                   *   E20085
030500200529     F*            Secondly, SR/ZNCD returns NCD = ECD if ECD is a    *   E20085
030600200529     F*            Coupon Date, so to get the Next Coupon AFTER a date*   E20085
030700200529     F*            it is important to start at the right place.       *   E20085
030800200529     F*            This change was done to stop the program looping.  *   E20085
030900200529     F*            (Also removes E18013 which was the same problem).  *   E20085
031000200529     F*          - LCPN from SECTY is unreliable - use SR/ZLCD.       *   E20085
031100200529     F*  E15930 - Partly Paid Processing Corrections:                 *   E15930
031200200529     F*          - Initialise the totals on the Diary with CPDP.      *   E15930
031300200529     F*          - Running Totals, (SDTA and SDTP), from the Security *   E15930
031400200529     F*            Diary should be used to update CPDP on Event Date. *   E15930
031500200529     F*          - Use Call Amount from Diary for Security Action.    *   E15930
031600200529     F*  E18013 - Program loops when the Next Coupon Date is the same *   E18013
031700200529     F*           as the Maturity Date.                               *   E18013
031800200529     F*  E16772 - The Dividend Payment Amount fields have been        *   E16772
031900200529     F*           increased in size from 9,4 to 13,8. Hence the field *   E16772
032000200529     F*           SDDV has been replaced by SDVA and SDAU by SDUN.    *   E16772
032100200529     F*  E18009 - RECOMPILE OVER LATEST URSLIB/ZSRSRC.                *   E18009
032200200529     F*  E17876 - REMOVE E17704, CAUSES SE2100 LOOP IN ALL TEST SYS'S.*   E17876
032300200529     F*  E17704 - RECOMPILE PROGRAM OVER CHANGED ZNCDZ3 SR            *   E17704
032400200529     F*  E14674 - INCORRECT RATE OUTPUT TO INITIAL DIARY RECORDS      *   E14674
032500200529     F*  S01176 - SECURITIES TRADING 3.1                              *   S01176
032600200529     F*  E15549 - REDELIVERY OF SE2100 INVOLVING VARIOUS FIXES FOR    *   E15549
032700200529     F*                POSITION SETTLEMENTS                           *   E15549
032800200529     F*      1.NEXT COUPON DATE PROCESSING NEVER PERFORMED            *   E15549
032900200529     F*      2.NO POSITION EVENTS PROCESSED IF SYSTEM ON DAILY        *   E15549
033000200529     F*        ACCRUALS                                               *   E15549
033100200529     F*      3.POSITION ACTION EVENTS ACTIONED PRIOR TO EVENT DATE    *   E15549
033200200529     F*      4.DUPLICATE INITIAL RECORDS IF ACCRUAL DATE FOLLOWED BY  *   E15549
033300200529     F*        NON WORKING DAY                                        *   E15549
033400200529     F*      5.INITIAL RECORDS NOT UPDATED ON SECURITY COMPLETION DATE*   E15549
033500200529     F*      6.EVENTS FALLING ON HOLIDAYS NOT PROCESSED PROPERLY      *   E15549
033600200529     F*      7.RE-ACTIONING OF DIARY EVENTS NOT DONE CORRECTLY        *   E15549
033700200529     F*      8.'LAST COUPON DATE OF CURRENT COUPON PERIOD' ADDED TO   *   E15549
033800200529     F*        SECURITY ACTIONS FILE FOR SE2210/SE2220/SE2270         *   E15549
033900200529     F*      9.DOUBLING OF POSITION SETTLEMENTS ON ACCRUAL DATE       *   E15549
034000200529     F*        FOLLOWED BY A NON-WORKING DAY                          *   E15549
034100200529     F*     10.SECURITY ACTIONS GENERATED FOR COUPON DATE COINCIDING  *   E15549
034200200529     F*        WITH MATURITY DATE GENERATED POSITION SETTLEMENTS      *   E15549
034300200529     F*   E14235 - ERROR IN SR/ZNCD TO FETCH NEXT COUPON DATE. PROGRAM*   E14235
034400200529     F*            RE-COMPILED TO ALLOW FOR NEW SUB-ROUTINE.          *   E14235
034500200529     F*   E13979 - POST INCORPORATION DEVELOPMENT FIX - OUTPUT COUPON *   E13979
034600200529     F*            ACTION WITH EVENT TYPE CO INSTEAD OF CP.           *   E13979
034700200529     F*   E13524 - SET UP NOMINAL CURRENCY IN SECURITY DIARY EVENTS   *   E13524
034800200529     F*            FILE (SEDEVD)                                      *   E13524
034900200529     F*   S01158 - POST INCORPORATION DEVELOPMENT FIXES               *   S01158
035000200529     F*                                                               *
035100200529     F*****************************************************************
035200200529      *
035300200529     FSECTY   UF  E           K        DISK
035400200529     F                                              KINFDS SECDS
035500200529     F                                              KINFSR SECSR
035600200529     FSECTYX  IF  E           K        DISK
035700200529     F            SECTYDF                           KRENAMESECTYDX
035800200529     FSECTYA  IF  E                    DISK
035900200529     F*SECET***IF**E           K        DISK                              E15549
036000200529     F*SECET**UF **E           K        DISK                       E15549 180385
036100200529     FSECEU   UF  E           K        DISK                               180385
036200200529     F            SEDEVDF                           KRENAMESEDEVDU        180385
036300200529     FSECET   IF  E           K        DISK                               180385
036400200529     F            SEDEVDF                           KRENAMESEDEVDC
036500200529     FINVTP   IF  E           K        DISK
036600200529     FSDWHTTL5IF  E           K        DISK                               CSE023
036700200529     FSEDEL   UF  E           K        DISK                      A
036800200529     F                                              KINFDS DELDS
036900200529     F                                              KINFSR DELSR
037000200529     FSEDELX  IF  E           K        DISK
037100200529     F            SEDEVDF                           KRENAMESEDEVDX
037200200529     FSEDEVA  UF  E                    DISK
037300200529     FSECEO   UF  E           K        DISK                               E15549
037400200529     F            SEDEVDF                           KIGNORE               E15549
037500200529     F*********** SNDEVDF                           KRENAMESNDEVDX E15549 E20085
037600200529     F            SNDEVDF                           KRENAMESNDEVDO        E20085
037700200529     FSNDEVD  O   E           K        DISK                      A
037800200529     F                                              KINFDS SNDDS
037900200529     F                                              KINFSR SNDSR
038000200529     FSNDEVA  UF  E                    DISK
038100200529     F                                              KINFDS SNADS
038200200529     F                                              KINFSR SNASR
038300200529     FSECACD  O   E                    DISK
038400200529     F                                              KINFDS CCDDS
038500200529     F                                              KINFSR CCDSR
038600200529     FSECACA  O   E                    DISK
038700200529     F                                              KINFDS CCADS
038800200529     F                                              KINFSR CCASR
038900200529     FSE2100AUO   E                    PRINTER
039000200529     F*                                                                   S96032
039100200529     F/COPY WNCPYSRC,SE2100FFP1                                           S96032
039200200529     F*                                                                   S96032
039300200529     FTABSE   IF  E           K        DISK
039400200529     F* ICD 1     TABTB10F                          KIGNORE
039500200529     F* ICD 2     TABTB11F                          KIGNORE
039600200529     F            TABTB36F                          KIGNORE
039700200529     F            TABTB40F                          KIGNORE
039800200529     F            TABTG10F                          KIGNORE
039900200529     F            TABTG20F                          KIGNORE
040000200529     F            TABLETHF                          KIGNORE
040100200529     F*********** TABLETJF                          KIGNORE               S01117
040200200529     F            TABLETLF                          KIGNORE
040300200529     F            TABLETRF                          KIGNORE
040400200529     F            TABLET2F                          KIGNORE
040500200529     F            TABTE10F                          KIGNORE
040600200529     F            TABTE20F                          KIGNORE
040700200529      /EJECT
040800200529     F*****************************************************************
040900200529     F*                                                               *
041000200529     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
041100200529     F*                                                               *
041200200529     F*   20  - END OF INPUT - SECURITIES (SECTY)                     *
041300200529     F*   25  - END OF INPUT - SECURITY DIARY (SEDEL)                 *
041400200529     F*   30  - SEDEL NOT FOUND ON UPDATE                             *
041500200529     F*   35  - SECTY NOT FOUND ON UPDATE                             *
041600200529     F*   36  - INVTP NOT FOUND FOR SECTY RECORD                      *
041700200529     F*   37  - SECET NOT FOUND / EOF                                 *
041800200529     F*   40  - SECURITY HAS MATURED                                  *
041900200529     F*   41  - NEW COUPON DATE CALCULATED                            *
042000200529     F*   42  - IR PROCESSED FOR THIS SECURITY                        *
042100200529     F*   43  - MP PROCESSED FOR THIS SECURITY                        *
042200200529     F*   44  - PP PROCESSED FOR THIS SECURITY                        *
042300200529     F*   45  - XR PROCESSED FOR THIS SECURITY                        *
042400200529     F*   46  - RC,RP PROCESSED FOR THIS SECURITY                     *
042500200529      *   47  - Deleted diary event w/c was not yet actioned.         *   183206
042600200529     F*   50  - IR event has a valid event date.                      *   137563
042700200529      *   60  - End of file on SNDEVDO                                *   197357
042800200529     F*   80  - CONTROL TOTALS DISAGREE - SECTYA                      *
042900200529     F*   88  - SHOW STATUS ON DB ERROR REPORT                        *
043000200529     F*                                                               *
043100200529     F* 90-99 - Used in Standard Subroutines                          *
043200200529     F*                                                               *
043300200529     F*   U7  - Database Error                                        *
043400200529     F*   U8  - Database / Control Error                              *
043500200529     F*                                                                   S01408
043600200529     F/COPY WNCPYSRC,SE2100FFP3                                           S01408
043700200529     F*                                                                   S01408
043800200529     F*                                                               *
043900200529     F*****************************************************************
044000200529      /EJECT
044100200529     F*****************************************************************
044200200529     F*                                                               *
044300200529     F*  S U B R O U T I N E   I N D E X                              *
044400200529     F*                                                               *
044500200529     F*  FIRST  - INITIALISATION                                      *
044600200529     F*  NEWSEC - INITIALISATION FOR A NEW SECURITY                   *
044700200529     F*  PROCES - PROCESSES EACH DIARY RECORD ON SEDEL                *
044800200529     F*  UPDDEL - UPDATES SECURITY DIARY - SEDEL                      *
044900200529     F*  ENDSEC - COMPLETES PROCESSING FOR SECURITY                   *
045000200529     F*  AUDIT  - CHECKS & UPDATES AUDIT FILES                        *
045100200529     F*  PRINT  - PRINTS CONTROL TOTALS OR DB ERROR REPORT            *
045200200529     F*  GETSEC - READS NEXT SECURITY FROM SECTYX                     *
045300200529     F*  GETDEL - READS NEXT SECURITY DIARY EVENT FROM SEDELX         *
045400200529     F*  IRCHCK - Check if IR correspond w/ the IR change of Security *   137563
045500200529     F*                                                               *
045600200529     F*  OUTW01 - OUTPUTS SECURITY ACTION (COUPON)    TO SECACD       *
045700200529     F*  OUTW02 - OUTPUTS SECURITY ACTION (MATURITY)  TO SECACD       *
045800200529     F*  OUTW03 - OUTPUTS SECURITY ACTION (SEC DIARY) TO SECACD       *
045900200529     F*  OUTW04 - OUTPUTS INITIAL VALUE RECORD TO SEDEVD              *
046000200529     F*  OUTSND - OUTPUTS NON-DIARY EVENT TO SNDEVD                   *
046100200529     F*                                                               *
046200200529     F*  SECSR  - ERROR SUBROUTINE FOR LF/SECTY                       *
046300200529     F*  DELSR  - ERROR SUBROUTINE FOR LF/SEDEL                       *
046400200529     F*  SNDSR  - ERROR SUBROUTINE FOR PF/SNDEVD                      *
046500200529     F*  SNASR  - ERROR SUBROUTINE FOR PF/SNDEVA                      *
046600200529     F*  CCDSR  - ERROR SUBROUTINE FOR PF/SECACD                      *
046700200529     F*  CCASR  - ERROR SUBROUTINE FOR PF/SECACA                      *
046800200529     F*  *PSSR  - Error handling                                      *   S01117
046900200529     F*                                                               *
047000200529     F*  ZICD2  - ACCESSES ICD 2(TABTB11)                             *
047100200529     F*  ZNCD   - CALCULATES NEXT COUPON DATE                         *
047200200529     F*  ZSYSTM - ACCESSES ICD 1(TABTB10)                             *
047300200529     F*                                                               *
047400200529     F*                                                                   S01408
047500200529     F/COPY WNCPYSRC,SE2100FFP2                                           S01408
047600200529     F*                                                                   S01408
047700200529     F*****************************************************************
047800200529      /EJECT
047900200529     E*                                                                   S96032
048000200529     E/COPY WNCPYSRC,SE2100EEP1                                           S96032
048100200529     E*                                                                   S96032
048200200529     E                    CPY@    1   1 80
048300200529     E/COPY ZSRSRC,ZHOLE                                                  CSE023
048400200529     E/COPY ZSRSRC,ZNCDZ1
048500200529     E/COPY ZSRSRC,ZDATE2Z1
048600200529     E                    NAR     1   3 35
048700200529     E**********          ETP     4   4  2                                             E15549 CSE065
048800200529     E                    ETP     5   5  2                                                    CSE065
048900200529     E                    DAT        12  6 0                              137563
049000200529     E/COPY WNCPYSRC,SE2100E001
049100200529      /EJECT
049200200529     ISEDEVDC
049300200529     I*
049400200529     I*  RENAME FIELDS ON SECET TO ACCESS SEPARATELY
049500200529     I*
049600200529     I              RECI                            CRECI
049700200529     I              SDSN                            CDSN
049800200529     I              SDED                            CDED
049900200529     I              SDET                            CDET
050000200529     I              SDNV                            CDNV
050100200529     I**************SDDV                            CDDV                  E16772
050200200529     I              SDVA                            CDVA                  E16772
050300200529     I              SDCP                            CDCP
050400200529     I              SRPT                            CRPT
050500200529     I              SDTR                            CDTR
050600200529     I              SRMI                            CRMI
050700200529     I              SDPD                            CDPD
050800200529     I              SDNC                            CDNC
050900200529     I              SDPP                            CDPP
051000200529     I              SDPC                            CDPC
051100200529     I              SDTA                            CDTA
051200200529     I              SDTP                            CDTP
051300200529     I              SDRP                            CDRP
051400200529     I              SDCV                            CDCV
051500200529     I              SDCX                            CDCX                  E23049
051600200529     I              SDCE                            CDCE
051700200529     I              SDMD                            CDMD
051800200529     I              NMCY                            CMCY
051900200529     I              SDAD                            CDAD
052000200529     I              SDDT                            CDDT
052100200529     I              LCD                             CLCD
052200200529     I              CHTP                            CCHTP
052300200529     I              TNLU                            CTNLU
052400200529     I              SCRS                            CCRS                                      CAS006
052500200529     I              SLQP                            CLQP                                      CAS006
052600200529     I              SDNN                            CDNN                                      CAS006
052700200529     I/COPY WNCPYSRC,SE2100I002
052800200529     ISEDEVDX
052900200529     I*
053000200529     I*  RENAME FIELDS ON SEDELX TO ACCESS SEPERATELY
053100200529     I*
053200200529     I              RECI                            XRECI
053300200529     I              SDSN                            XSDSN
053400200529     I              SDED                            XSDED
053500200529     I              SDET                            XSDET
053600200529     I              SDNV                            XSDNV
053700200529     I**************SDDV                            XSDDV                 E16772
053800200529     I              SDVA                            XSDVA                 E16772
053900200529     I              SDCP                            XSDCP
054000200529     I              SRPT                            XSRPT
054100200529     I              SDTR                            XSDTR
054200200529     I              SRMI                            XSRMI
054300200529     I              SDPD                            XSDPD
054400200529     I              SDNC                            XSDNC
054500200529     I              SDPP                            XSDPP
054600200529     I              SDPC                            XSDPC
054700200529     I              SDTA                            XSDTA
054800200529     I              SDTP                            XSDTP
054900200529     I              SDRP                            XSDRP
055000200529     I              SDCV                            XSDCV
055100200529     I              SDCX                            XSDCX                 E23049
055200200529     I              SDCE                            XSDCE
055300200529     I              SDMD                            XSDMD
055400200529     I              NMCY                            XSMCY
055500200529     I              SDAD                            XSDAD
055600200529     I              SDDT                            XSDDT
055700200529     I              LCD                             XLCD
055800200529     I              CHTP                            XCHTP
055900200529     I              TNLU                            XTNLU
056000200529     I              SDXD                            XSDXD                 S01510
056100200529     I              FRNT                            XFRNT                 CAP140
056200200529     I              REPA                            XREPA                 CAP140
056300200529     I              SCRS                            XSCRS                                     CAS006
056400200529     I              SLQP                            XSLQP                                     CAS006
056500200529     I              SDNN                            XSDNN                                     CAS006
056600200529     I              SDAL                            XSDAL                                     CSE065
056700200529     ISEDEVDU                                                             180385
056800200529     I*                                                                   180385
056900200529     I*  Rename fields on SECEU to access separately.                     180385
057000200529     I*                                                                   180385
057100200529     I              RECI                            RECIU                 180385
057200200529     I              SDSN                            UDSN                  180385
057300200529     I              SDED                            UDED                  180385
057400200529     I              SDET                            UDET                  180385
057500200529     I              SDNV                            UDNV                  180385
057600200529     I              SDVA                            UDVA                  180385
057700200529     I              SDCP                            UDCP                  180385
057800200529     I              SRPT                            URPT                  180385
057900200529     I              SDTR                            UDTR                  180385
058000200529     I              SRMI                            URMI                  180385
058100200529     I              SDPD                            UDPD                  180385
058200200529     I              SDNC                            UDNC                  180385
058300200529     I              SDPP                            UDPP                  180385
058400200529     I              SDPC                            UDPC                  180385
058500200529     I              SDTA                            UDTA                  180385
058600200529     I              SDTP                            UDTP                  180385
058700200529     I              SDRP                            UDRP                  180385
058800200529     I              SDCV                            UDCV                  180385
058900200529     I              SDCX                            UDCX                  180385
059000200529     I              SDCE                            UDCE                  180385
059100200529     I              SDMD                            UDMD                  180385
059200200529     I              NMCY                            UMCY                  180385
059300200529     I              SDAD                            UDAD                  180385
059400200529     I              SDDT                            UDDT                  180385
059500200529     I              LCD                             ULCD                  180385
059600200529     I              CHTP                            UCHTP                 180385
059700200529     I              TNLU                            UTNLU                 180385
059800200529     I*
059900200529      *                                                                                       CSE037
060000200529     IINVTPDF                                                                                 CSE037
060100200529     I              SFLG                            ISFLG                                     CSE037
060200200529     I*                                                                   S96032
060300200529     I/COPY WNCPYSRC,SE2100IIP1                                           S96032
060400200529     I*                                                                   S96032
060500200529     ITABKEY      DS
060600200529     I*
060700200529     I* DATA STRUCTURE FOR TABLE FILE KEY
060800200529     I*
060900200529     I                                        1  12 TKEY
061000200529     I                                        1   20RECT
061100200529     I                                        3  10 ZZ008
061200200529     I                                       11  120RCDE
061300200529     I*
061400200529     IINVTPK      DS
061500200529     I*
061600200529     I* DATA STRUCTURE FOR INVTP FILE KEY
061700200529     I*
061800200529     I                                        1   3 NMCY
061900200529     I                                        4   6 SITP
062000200529     I*
062100200529     I* DATA STRUCTURES FOR RPG 01021 ERROR HANDLING
062200200529     I*
062300200529     ISECDS       DS
062400200529     I                                     *STATUS  STSSEC
062500200529     IDELDS       DS
062600200529     I                                     *STATUS  STSDEL
062700200529     ISNDDS       DS
062800200529     I                                     *STATUS  STSSND
062900200529     ISNADS       DS
063000200529     I                                     *STATUS  STSSNA
063100200529     ICCDDS       DS
063200200529     I                                     *STATUS  STSCCD
063300200529     ICCADS       DS
063400200529     I                                     *STATUS  STSCCA
063500200529     I*
063600200529     I/COPY ZSRSRC,ZHOLI                                                  CSE023
063700200529     I/COPY ZSRSRC,ZNCDZ2
063800200529      *
063900200529     ILDA         DS                            256                       S01117
064000200529      *
064100200529      ***  Local Data Area for DB Error Information
064200200529      *
064300200529     I                                      134 183 DBLOT                 S01117
064400200529     I                                      134 141 DBFILE                S01117
064500200529     I                                      142 170 DBKEY                 S01117
064600200529     I                                      171 180 DBPGM                 S01117
064700200529     I                                      181 1830DBASE                 S01117
064800200529     I*LDA******* UDS                            256                      S01117
064900200529     I***********                           134 177 DBLOT                 S01117
065000200529     I***********                           134 138 DBFILE                S01117
065100200529     I***********                           139 167 DBKEY                 S01117
065200200529     I***********                           168 175 DBPGM                 S01117
065300200529     I***********                           176 1770DBASE                 S01117
065400200529     I*                                                                   E20142
065500200529     I** SESTAT DATA STRUCTURE - FOR END OF MONTH DATE                    E20142
065600200529     IDTAARA    E DSSESTAT                                                E20142
065700200529     I*                                                                   E20142
065800200529     ICPYR@#      DS                                                      E20142
065900200529     I*
066000200529     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
066100200529     I*
066200200529     I                                        1  80 CPY@
066300200529     I                                        1  20 CPY@##
066400200529      *                                                                   CPB001
066500200529      **  External Data Structure for Midas Modules Details.              CPB001
066600200529     ISDMMOD    E DSSDMMODPD                                              CPB001
066700200529      *                                                                   CPB001
066800200529      **  First Data Structure for Access Programs, short Data Structure. CPB001
066900200529     IDSFDY     E DSDSFDY                                                 CPB001
067000200529      *                                                                   CPB001
067100200529      **  Second Data Structure for Access Programs, long Data Structure. CPB001
067200200529     IDSSDY     E DSDSSDY                                                 CPB001
067300200529      *                                                                   CPB001
067400200529     I/COPY WNCPYSRC,SE2100I001
067500200529      *                                                                                       CSE065
067600200529     I              'END OF AVERAGE LIFE' C         #CONS1                                    CSE065
067700200529      *                                                                                       CSE065
067800200529     C/EJECT
067900200529      *================================================================
068000200529      *  P R O G R A M   S T A R T                                    *
068100200529      *================================================================
068200200529     C*
068300200529     C* DEFINE FIELDS AND KEY LISTS
068400200529     C*
068500200529     C*    UPDATE AREA FOR SECURITY
068600200529     C*
068700200529     C           *LIKE     DEFN RECI      URECI
068800200529     C           *LIKE     DEFN LCPN      ULCPN
068900200529     C*                                                                   S96032
069000200529     C/COPY WNCPYSRC,SE2100CCP1                                           S96032
069100200529     C*                                                                   S96032
069200200529     C           *LIKE     DEFN CPNR      UCPNR
069300200529     C*                                                                   S96032
069400200529     C/COPY WNCPYSRC,SE2100CCP2                                           S96032
069500200529     C*                                                                   S96032
069600200529     C           *LIKE     DEFN CFCT      UCFCT
069700200529     C           *LIKE     DEFN CPDP      UCPDP
069800200529     C           *LIKE     DEFN SLCA      USLCA
069900200529     C           *LIKE     DEFN SEXR      USEXR
070000200529     C           *LIKE     DEFN SPYC      USPYC                           E23049
070100200529     C           *LIKE     DEFN SMDI      USMDI                           E23049
070200200529     C           *LIKE     DEFN SCPD      USCPD
070300200529     C           *LIKE     DEFN SCPP      USCPP
070400200529     C           *LIKE     DEFN SCPI      USCPI
070500200529     C********** *LIKE     DEFN LCCP      WLCCP                                        197357 211228
070600200529     C           *LIKE     DEFN ALDT      UALDT                                               CSE065
070700200529     C*
070800200529     C*    STORE FOR PREVIOUS COUPON RATE
070900200529     C*
071000200529     C           *LIKE     DEFN CFCT      PCFCT
071100200529     C*
071200200529     C*    STORE FOR SECURITY DIARY RECORD ID
071300200529     C*
071400200529     C           *LIKE     DEFN RECI      SRECI
071500200529     C           *LIKE     DEFN CPNN      UCPNN                                               CAS006
071600200529     C           *LIKE     DEFN CCRK      UCCRK                                               CAS006
071700200529     C           *LIKE     DEFN CLQP      UCLQP                                               CAS006
071800200529     C           *LIKE     DEFN CPNN      WCPNN                                               CAS006
071900200529     C*
072000200529     C*  KEY FIELD TO CHAIN TO SEDEL FOR UPDATE
072100200529     C*
072200200529     C           KSEDEL    KLIST
072300200529     C                     KFLD           XSDSN
072400200529     C                     KFLD           KEYDT
072500200529     C                     KFLD           XSDET
072600200529     C*                                                                   E15549
072700200529     C*  PARTIAL KEY TO ACCESS SEDEL FOR INITIAL RECORDS                  E15549
072800200529     C*                                                                   E15549
072900200529     C           PSEDEL    KLIST                                          E15549
073000200529     C                     KFLD           SESN                            E15549
073100200529     C                     KFLD           SDET                            E15549
073200200529     C                     KFLD           KEYDT                           E15549
073300200529     C*                                                                   E15549
073400200529     C*  KEY TO ACCESS SECEO TO CHECK FOR POSN SETTLEMENTS GENERATED      E15549
073500200529     C*                                                                   E15549
073600200529     C           SETGKY    KLIST                                          E15549
073700200529     C                     KFLD           SNSN                            E15549
073800200529     C                     KFLD           SNET                            E15549
073900200529     C                     KFLD           SNDT                            E15549
074000200529     C*                                                                   054498
074100200529     C*  KEY TO ACCESS SECEO TO CHECK FOR COUPON EVENTS                   054498
074200200529     C*                                                                   054498
074300200529     C           SNDVPK    KLIST                                          054498
074400200529     C                     KFLD           SNSN                            054498
074500200529     C                     KFLD           SNET                            054498
074600200529     C*
074700200529     C*  KEY FIELD TO CHAIN TO SECTY FOR UPDATE
074800200529     C*
074900200529     C           KSECTY    KLIST
075000200529     C                     KFLD           SESN
075100200529     C*
075200200529     C*  KEY FIELD TO READE ON SECET
075300200529     C*
075400200529     C           KSECET    KLIST
075500200529     C                     KFLD           XSDSN
075600200529     C                     KFLD           XSDET
075700200529     C*
075800200529     C*  KEY FIELD TO CHAIN TO SECET
075900200529     C*
076000200529     C           KSEC2     KLIST
076100200529     C                     KFLD           XSDSN
076200200529     C                     KFLD           XSDET
076300200529     C                     KFLD           XSDED
076400200529     C*
076500200529     C*  KEY FIELD TO CHAIN TO INVTP
076600200529     C*
076700200529     C           KINVTP    KLIST
076800200529     C                     KFLD           NMCY
076900200529     C                     KFLD           SITP
077000200529      **********                                                                       197357 211228
077100200529      ***Define*the*keylist*for*SNDEVDO*in*SECEO.**********************                197357 211228
077200200529      **********                                                                       197357 211228
077300200529     C********** KESNCP    KLIST                                                       197357 211228
077400200529     C**********           KFLD           SESN                                         197357 211228
077500200529     C**********           KFLD           SNET                                         197357 211228
077600200529     C**********           KFLD           SNDT                                         197357 211228
077700200529      *                                                                   CSE023
077800200529      ** Key list for Withholding Tax Treaty detail                       CSE023
077900200529      *                                                                   CSE023
078000200529     C           WHTKEY    KLIST                                          CSE023
078100200529     C                     KFLD           CRTT                            CSE023
078200200529     C                     KFLD           @INVT   3                       CSE023
078300200529      *
078400200529      *================================================================
078500200529      /EJECT
078600200529      *================================================================
078700200529      *  M A I N   P R O C E S S I N G                                *
078800200529      *================================================================
078900200529     C*                                                                   E15549
079000200529     C           *ENTRY    PLIST                                          E15549
079100200529     C                     PARM           ACRLRN  1                       E15549
079200200529     C*
079300200529     C* INITIALISATION
079400200529     C*
079500200529     C                     EXSR FIRST
079600200529     C*
079700200529     C* READ FIRST RECORD FROM SEDEL UNLESS ERROR
079800200529     C*
079900200529     C           *INU7     IFEQ '0'
080000200529     C                     EXSR GETDEL
080100200529     C                     END
080200200529     C*
080300200529     C* READ FIRST NON-DELETED NON-MATURED REC FROM SECTY UNLESS ERROR
080400200529     C*
080500200529     C           *INU7     IFEQ '0'
080600200529     C                     EXSR GETSEC
080700200529     C                     END
080800200529     C*
080900200529     C* PROCESS EACH SECURITY UNTIL EOF(SECTY) OR DATABASE ERROR
081000200529     C*
081100200529     C           *IN20     DOWEQ'0'
081200200529     C           *INU7     ANDEQ'0'
081300200529     C*
081400200529     C*  NEW SECURITY
081500200529     C*
081600200529     C*************        MOVE '  '      SAAT                     094576 143174
081700200529     C                     EXSR NEWSEC
081800200529     C*
081900200529     C*  PROCESS EACH DIARY RECORD FOR THIS SECURITY UNLESS EOF OR ERROR
082000200529     C*
082100200529     C           XSDSN     DOWEQSESN
082200200529     C           *IN25     ANDEQ'0'
082300200529     C           *INU7     ANDEQ'0'
082400200529     C*
082500200529     C                     EXSR PROCES
082600200529     C*
082700200529     C*  READ NEXT RECORD FROM SEDEL
082800200529     C*
082900200529     C                     EXSR GETDEL
083000200529     C                     END
083100200529     C*
083200200529     C*  END OF RECORDS FOR THIS SECURITY
083300200529     C*
083400200529     C                     EXSR ENDSEC
083500200529     C*
083600200529     C*  READ NEXT SECURITY FROM SECTY
083700200529     C*
083800200529     C                     EXSR GETSEC
083900200529     C                     END
084000200529     C*
084100200529     C* IF NO DATABASE ERRORS .....
084200200529     C*
084300200529     C           *INU7     IFEQ '0'
084400200529     C*
084500200529     C*    CHECK & UPDATE AUDIT FILES (SEDELA,SECTYA,SECACA,SNDEVA)
084600200529     C*
084700200529     C                     EXSR AUDIT
084800200529     C                     END
084900200529     C*
085000200529     C* PRINT CONTROL TOTALS REPORT OR ERROR MESSAGE
085100200529     C*
085200200529     C                     EXSR PRINT
085300200529      *
085400200529      *================================================================
085500200529      *  P R O G R A M   E N D                                        *
085600200529      *                                                               *
085700200529     C                     SETON                     LR
085800200529      *                                                               *
085900200529      *================================================================
086000200529      /EJECT
086100200529      *****************************************************************
086200200529      *                                                               *
086300200529      *  FIRST  - Initialisation Subroutine.                          *
086400200529      *                                                               *
086500200529      *  Called By: Main Processing.                                  *
086600200529      *  Calls: ZSYSTM, ZICD2                                         *   E15549
086700200529      *                                                               *
086800200529      *****************************************************************
086900200529      *
087000200529     C           FIRST     BEGSR                           *** FIRST  ***
087100200529     C*
087200200529     C*  PREPARE LDA
087300200529     C*
087400200529     C           *NAMVAR   DEFN           LDA                             S01117
087500200529     C           *LOCK     IN   LDA                                       S01117
087600200529     C                     MOVEL*BLANK    DBLOT
087700200529     C                     MOVEL'SE2100'  DBPGM
087800200529     C                     OUT  LDA                                       S01117
087900200529     C*
088000200529     C*  ZEROISE ACCUMULATORS
088100200529     C*
088200200529     C                     Z-ADD0         STOTI   50
088300200529     C                     Z-ADD0         STOTU   50
088400200529     C                     Z-ADD0         DTOTI   50
088500200529     C                     Z-ADD0         DTOTU   50
088600200529     C                     Z-ADD0         DTOTD   50
088700200529AW   C                     Z-ADD0         DTOTA   50
088800200529     C                     Z-ADD0         OTOT1   50
088900200529     C                     Z-ADD0         OTOT2   50
089000200529     C                     Z-ADD0         OTOT3   50
089100200529     C                     Z-ADD0         OTOT4   50                      E15549
089200200529     C                     Z-ADD0         OTOT5   50                      E15549
089300200529     C*
089400200529     C*  ACCESS ICD 1 (TABTB10)
089500200529     C*
089600200529     C                     EXSR ZSYSTM
089700200529     C*
089800200529     C*  ERROR IN ZSYSTM
089900200529     C*
090000200529     C           *IN,99    IFEQ '1'
090100200529     C*
090200200529     C           *LOCK     IN   LDA                                       S01117
090300200529     C                     MOVE '1'       *INU7
090400200529     C                     MOVE '1'       *INU8            ***************
090500200529     C***********          MOVEL'01'      DBASE            * DB ERROR 01 *S01117
090600200529     C                     Z-ADD1         DBASE            * DB ERROR 01 *S01117
090700200529     C                     MOVEL'TABSE'   DBFILE           ***************
090800200529     C                     MOVELZTABKY    DBKEY
090900200529     C                     OUT  LDA                                       S01117
091000200529     C                     EXSR *PSSR                                     S01117
091100200529     C*
091200200529     C                     END
091300200529     C*
091400200529     C*  ACCESS ICD 2 (TABTB11)
091500200529     C*
091600200529     C           *INU7     IFNE '1'
091700200529     C*
091800200529     C                     EXSR ZICD2
091900200529     C*
092000200529     C*  ERROR IN ZICD2
092100200529     C*
092200200529     C           *INU8     IFEQ '1'                        ***************
092300200529     C           *LOCK     IN   LDA                                       S01117
092400200529     C***********          MOVEL'02'      DBASE            * DB ERROR 02 *S01117
092500200529     C                     Z-ADD2         DBASE            * DB ERROR 02 *S01117
092600200529     C                     MOVEL'TABSE'   DBFILE           ***************
092700200529     C                     MOVELTKEY      DBKEY
092800200529     C                     OUT  LDA                                       S01117
092900200529     C                     EXSR *PSSR                                     S01117
093000200529     C*
093100200529     C                     ELSE
093200200529     C*
093300200529     C** SET EVENT CONTROL DATE
093400200529     C*
093500200529     C***********APDA      IFLT DNWD                                      E15549
093600200529     C***********                                                         E15549
093700200529     C***********          EXSR ZEVCD                                     E15549
093800200529     C***********                                                         E15549
093900200529     C***********          ELSE                                           E15549
094000200529     C***********                                                         E15549
094100200529     C***********          Z-ADDDNWD      ECD                             E15549
094200200529     C***********                                                         E15549
094300200529     C***********          END                                            E15549
094400200529     C*                                                                   E15549
094500200529     C** ON ACCRUAL DATE FOLLOWED BY A NON WORKING DAY-                   E15549
094600200529     C**     SE2100 IS RUN TWICE:                                         E15549
094700200529     C**         - 1ST TIME PROCESSES EVENTS UP TO APDA                   E15549
094800200529     C**           (ACRLRN SET ACCORDING TO RUN,IE 3)                     E15549
094900200529     C**         - 2ND TIME PROCESSES EVENTS UP TO DNWD                   E15549
095000200529     C**           (ACRLRN SET TO 4)                                      E15549
095100200529     C** OTHERWISE -                                                      E15549
095200200529     C**     SE2100 IS RUN ONCE.PROCESSES EVENTS UP TO DNWD               E15549
095300200529     C**               (ACRLRN SET ACCORDING TO RUN,IE 1 OR 2)            E15549
095400200529     C*                                                                   054498
095500200529     C* DO THE ACCOUNTING OF SECURITIES FOR EVENTS UP TO                  054498
095600200529     C* A DATE 'AKDAT' DEFINED BY THE EVENT CONTROL DATE                  054498
095700200529     C*                                                                   054498
095800200529     C                     Z-ADDAPDA      ZZAPDT                          054498
095900200529     C                     Z-ADDDNWD      ZZDNWD                          054498
096000200529     C                     EXSR ZEVCD                                     054498
096100200529     C                     Z-ADDECD       AKDAT   50                      054498
096200200529     C*                                                                   054498
096300200529     C* DO POSITION SETTLEMENT PROCESSING OF SECURITIES FOR EVENTS        054498
096400200529     C* UP TO A DATE 'PSDAT'. SET THIS DATE TO THE NEXT WORKING DAY       054498
096500200529     C*                                                                   054498
096600200529     C                     Z-ADDDNWD      PSDAT   50                      054498
096700200529     C*                                                                   E15549
096800200529     C***********ACRLRN    IFNE '3'                                E15549 054498
096900200529     C***********          Z-ADDDNWD      ECD     50               E15549 054498
097000200529     C***********          ELSE                                    E15549 054498
097100200529     C***********          Z-ADDAPDA      ECD                      E15549 054498
097200200529     C***********          END                                     E15549 054498
097300200529     C***********                                                  E20142 054498
097400200529     C***Get*Data Area SESTAT and set up end of current month.     E20142 054498
097500200529     C***********                                                  E20142 054498
097600200529     C************NAMVAR   DEFN SESTAT    DTAARA                   E20142 054498
097700200529     C***********          IN   DTAARA                             E20142 054498
097800200529     C***********          MOVELEOPT      EOMDAT  50               E20142 054498
097900200529     C*
098000200529     C*                                                                   S96032
098100200529     C/COPY WNCPYSRC,SE2100CCP3                                           S96032
098200200529     C*                                                                   S96032
098300200529     C                     END
098400200529     C                     END
098500200529      *                                                                   CSE023
098600200529      ** Check if CSE023 - Treaty Withholding Tax present                 CSE023
098700200529      *                                                                   CSE023
098800200529     C                     MOVE 'N'       CSE023  1                       CSE023
098900200529     C                     CALL 'AOSARDR0'                                CSE023
099000200529     C                     PARM *BLANKS   @RTCD   7                       CSE023
099100200529     C                     PARM '*VERIFY' @OPTN   7                       CSE023
099200200529     C                     PARM 'CSE023'  @SARD   6                       CSE023
099300200529      *                                                                   CSE023
099400200529     C           @RTCD     IFEQ *BLANK                                    CSE023
099500200529     C                     MOVE 'Y'       CSE023                          CSE023
099600200529     C                     ENDIF                                          CSE023
099700200529      *                                                                   CPB001
099800200529      **  Call Access Program for Midas Modules Details.                  CPB001
099900200529     C                     CALL 'AOMMODR0'                                CPB001
100000200529     C                     PARM *BLANKS   P@RTCD  7                       CPB001
100100200529     C                     PARM '*FIRST  'P@OPTN  7                       CPB001
100200200529     C           SDMMOD    PARM SDMMOD    DSFDY                           CPB001
100300200529      *                                                                   CPB001
100400200529      **  If Modules Details do not exist, handle Database Error.         CPB001
100500200529     C           P@RTCD    IFNE *BLANK                      Begin P@RTCD  CPB001
100600200529     C           *LOCK     IN   LDA                                       CPB001
100700200529     C                     MOVEL'SDMMODPD'DBFILE           ***************CPB001
100800200529     C                     Z-ADD14        DBASE            * DB ERROR 91 *CPB001
100900200529     C                     MOVELP@OPTN    DBKEY            ***************CPB001
101000200529     C                     OUT  LDA                                       CPB001
101100200529     C                     SETON                     U7U8LR               CPB001
101200200529     C                     EXSR *PSSR                                     CPB001
101300200529      *                                                                   CPB001
101400200529      ** If no error occurred.                                            CPB001
101500200529     C                     ELSE                             Else P@RTCD   CPB001
101600200529      *                                                                   CPB001
101700200529      ** If Private Banking Module is installed.                          CPB001
101800200529      *                                                                   CPB001
101900200529     C           BGN4ST    IFEQ 'Y'                         Begin BGN4ST  CPB001
102000200529      *                                                                   CPB001
102100200529      ** Set up Replication Processing Indicator.                         CPB001
102200200529     C                     MOVE 'Y'       WUREPL  1                       CPB001
102300200529      *                                                                   CPB001
102400200529     C                     ENDIF                            End BGN4ST    CPB001
102500200529      *                                                                   CPB001
102600200529     C                     ENDIF                            End P@RTCD    CPB001
102700200529      *                                                                   CSE031
102800200529      ** Check if CSE031 is switched on.                                  CSE031
102900200529      *                                                                   CSE031
103000200529     C                     CALL 'AOSARDR0'                                CSE031
103100200529     C                     PARM           PRTCD   7                       CSE031
103200200529     C                     PARM '*VERIFY' POPTN   7                       CSE031
103300200529     C                     PARM 'CSE031'  PSARD   6                       CSE031
103400200529      *                                                                   CSE031
103500200529     C           PRTCD     IFEQ *BLANKS                                   CSE031
103600200529     C                     MOVE 'Y'       CSE031  1                       CSE031
103700200529     C                     ELSE                                           CSE031
103800200529     C                     MOVE 'N'       CSE031                          CSE031
103900200529     C                     ENDIF                                          CSE031
104000200529      *                                                                   CSE071
104100200529      ** Check if CSE071 is switched on.                                  CSE071
104200200529      *                                                                   CSE071
104300200529     C                     CALL 'AOSARDR0'                                CSE071
104400200529     C                     PARM           PRTCD                           CSE071
104500200529     C                     PARM '*VERIFY' POPTN                           CSE071
104600200529     C                     PARM 'CSE071'  PSARD                           CSE071
104700200529      *                                                                   CSE071
104800200529     C           PRTCD     IFEQ *BLANKS                                   CSE071
104900200529     C                     MOVE 'Y'       CSE071  1                       CSE071
105000200529     C                     ELSE                                           CSE071
105100200529     C                     MOVE 'N'       CSE071                          CSE071
105200200529     C                     ENDIF                                          CSE071
105300200529      *                                                                                       CSE035
105400200529      ** Access SAR details file to see if CSE035 is installed                                CSE035
105500200529      *                                                                                       CSE035
105600200529     C                     CALL 'AOSARDR0'                                                    CSE035
105700200529     C                     PARM *BLANKS   @RTCD   7                                           CSE035
105800200529     C                     PARM '*VERIFY' @OPTN   7                                           CSE035
105900200529     C                     PARM 'CSE035'  @SARD   6                                           CSE035
106000200529      *                                                                                       CSE035
106100200529     C           @RTCD     IFEQ *BLANK                                                        CSE035
106200200529     C                     MOVE 'Y'       CSE035  1                                           CSE035
106300200529     C                     ELSE                                                               CSE035
106400200529     C                     MOVE 'N'       CSE035                                              CSE035
106500200529     C                     ENDIF                                                              CSE035
106600200529     C*                                                                   S96032
106700200529      ** Determine if CAS006 is installed                                                     CAS006
106800200529      *                                                                                       CAS006
106900200529     C                     CALL 'AOSARDR0'                                                    CAS006
107000200529     C                     PARM *BLANKS   PRTCD                                               CAS006
107100200529     C                     PARM '*VERIFY' POPTN                                               CAS006
107200200529     C                     PARM 'CAS006'  PSARD                                               CAS006
107300200529      *                                                                                       CAS006
107400200529      ** Process database error                                                               CAS006
107500200529      *                                                                                       CAS006
107600200529     C           PRTCD     IFNE *BLANKS                                                       CAS006
107700200529     C           PRTCD     ANDNE'*NRF   '                                                     CAS006
107800200529     C           *LOCK     IN   LDA                                                           CAS006
107900200529     C                     MOVEL'SCSARDPD'DBFILE                                              CAS006
108000200529     C                     MOVEL'CAS006 ' DBKEY                                               CAS006
108100200529     C                     Z-ADD15        DBASE                                               CAS006
108200200529     C                     OUT  LDA                                                           CAS006
108300200529     C                     MOVE *ON       *INU7                                               CAS006
108400200529     C                     MOVE *ON       *INU8                                               CAS006
108500200529     C                     MOVE *ON       *INLR                                               CAS006
108600200529     C                     EXSR *PSSR                                                         CAS006
108700200529     C                     ENDIF                                                              CAS006
108800200529      *                                                                                       CAS006
108900200529     C           PRTCD     IFEQ *BLANK                                                        CAS006
109000200529     C                     MOVE 'Y'       CAS006  1                                           CAS006
109100200529     C                     ELSE                                                               CAS006
109200200529     C                     MOVE 'N'       CAS006                                              CAS006
109300200529     C                     ENDIF                                                              CAS006
109400200529      *                                                                                       CAS006
109500200529      ** Check if CSE065 is switched on.                                                      CSE065
109600200529      *                                                                                       CSE065
109700200529     C                     CALL 'AOSARDR0'                                                    CSE065
109800200529     C                     PARM           PRTCD                                               CSE065
109900200529     C                     PARM '*VERIFY' POPTN                                               CSE065
110000200529     C                     PARM 'CSE065'  PSARD                                               CSE065
110100200529      *                                                                                       CSE065
110200200529      ** Process database error                                                               CSE065
110300200529      *                                                                                       CSE065
110400200529     C           PRTCD     IFNE *BLANKS                                                       CSE065
110500200529     C           PRTCD     ANDNE'*NRF   '                                                     CSE065
110600200529     C           *LOCK     IN   LDA                                                           CSE065
110700200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSE065
110800200529     C                     MOVEL'CSE065 ' DBKEY                                               CSE065
110900200529     C                     Z-ADD16        DBASE                                               CSE065
111000200529     C                     OUT  LDA                                                           CSE065
111100200529     C                     MOVE *ON       *INU7                                               CSE065
111200200529     C                     MOVE *ON       *INU8                                               CSE065
111300200529     C                     MOVE *ON       *INLR                                               CSE065
111400200529     C                     EXSR *PSSR                                                         CSE065
111500200529     C                     ENDIF                                                              CSE065
111600200529      *                                                                                       CSE065
111700200529      *                                                                                       CSE065
111800200529     C           PRTCD     IFEQ *BLANKS                                                       CSE065
111900200529     C                     MOVE 'Y'       CSE065  1                                           CSE065
112000200529     C                     ELSE                                                               CSE065
112100200529     C                     MOVE 'N'       CSE065                                              CSE065
112200200529     C                     ENDIF                                                              CSE065
112300200529      *                                                                                       CSE065
112400200529     C/COPY WNCPYSRC,SE2100CP11                                           S96032
112500200529     C*                                                                   S96032
112600200529      *                                                                                       CSE075
112700200529      ** Check if CSE075 is switched on.                                                      CSE075
112800200529      *                                                                                       CSE075
112900200529     C                     CALL 'AOSARDR0'                                                    CSE075
113000200529     C                     PARM           PRTCD                                               CSE075
113100200529     C                     PARM '*VERIFY' POPTN                                               CSE075
113200200529     C                     PARM 'CSE075'  PSARD                                               CSE075
113300200529      *                                                                                       CSE075
113400200529      ** Process database error                                                               CSE075
113500200529      *                                                                                       CSE075
113600200529     C           PRTCD     IFNE *BLANKS                                                       CSE075
113700200529     C           PRTCD     ANDNE'*NRF   '                                                     CSE075
113800200529     C           *LOCK     IN   LDA                                                           CSE075
113900200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSE075
114000200529     C                     MOVEL'CSE075 ' DBKEY                                               CSE075
114100200529     C                     Z-ADD17        DBASE                                               CSE075
114200200529     C                     OUT  LDA                                                           CSE075
114300200529     C                     MOVE *ON       *INU7                                               CSE075
114400200529     C                     MOVE *ON       *INU8                                               CSE075
114500200529     C                     MOVE *ON       *INLR                                               CSE075
114600200529     C                     EXSR *PSSR                                                         CSE075
114700200529     C                     ENDIF                                                              CSE075
114800200529      *                                                                                       CSE075
114900200529     C           PRTCD     IFEQ *BLANKS                                                       CSE075
115000200529     C                     MOVE 'Y'       CSE075  1                                           CSE075
115100200529     C                     ELSE                                                               CSE075
115200200529     C                     MOVE 'N'       CSE075                                              CSE075
115300200529     C                     ENDIF                                                              CSE075
115400200529      *                                                                                       CSE075
115500200529     C*
115600200529     C                     ENDSR
115700200529      *
115800200529      *****************************************************************
115900200529      /EJECT
116000200529      *****************************************************************
116100200529      *                                                               *
116200200529      *  NEWSEC - Subroutine to process change of Security.           *
116300200529      *                                                               *
116400200529      *  Called By: Main Processing.                                  *
116500200529      *  Calls: ZNCD, OUTW01                                          *
116600200529      *                                                               *
116700200529      *****************************************************************
116800200529      *
116900200529     C           NEWSEC    BEGSR                           *** NEWSEC ***
117000200529     C*
117100200529     C* INITIALISE UPDATE INDICATORS
117200200529     C*
117300200529     C                     MOVEA'0000000' *IN,40
117400200529      *                                                                                       CSE065
117500200529     C                     MOVE '0'       *IN48                                               CSE065
117600200529     C*
117700200529     C                     Z-ADDNCD       WNCD    50                      206316
117800200529     C                     Z-ADD*ZERO     NCD
117900200529     C*
118000200529     C* STORE ORIGINAL VALUES IN UPDATE FIELDS
118100200529     C*
118200200529     C                     MOVELRECI      URECI
118300200529     C                     Z-ADDLCPN      ULCPN
118400200529     C                     Z-ADDCPNR      UCPNR
118500200529      *                                                                                       CAS006
118600200529     C           CAS006    IFEQ 'Y'                                                           CAS006
118700200529     C                     Z-ADDCPNN      UCPNN                                               CAS006
118800200529     C                     Z-ADDCCRK      UCCRK                                               CAS006
118900200529     C                     Z-ADDCLQP      UCLQP                                               CAS006
119000200529     C                     ENDIF                                                              CAS006
119100200529     C*                                                                   S96032
119200200529     C/COPY WNCPYSRC,SE2100CCP4                                           S96032
119300200529     C*                                                                   S96032
119400200529     C                     Z-ADDCFCT      UCFCT
119500200529     C                     Z-ADDCPDP      UCPDP
119600200529     C                     Z-ADDSLCA      USLCA
119700200529     C                     Z-ADDSEXR      USEXR
119800200529     C                     MOVE SPYC      USPYC                           E23049
119900200529     C                     MOVE SMDI      USMDI                           E23049
120000200529     C                     Z-ADDSCPD      USCPD
120100200529     C                     Z-ADDSCPP      USCPP
120200200529     C                     MOVELSCPI      USCPI
120300200529     C*
120400200529     C* STORE PREVIOUS COUPON RATE
120500200529     C*
120600200529     C                     Z-ADDCFCT      PCFCT
120700200529     C*                                                                   E15549
120800200529     C*  DETERMINE TRUE MATURITY DATE                                     E15549
120900200529     C*                                                                   E15549
121000200529     C***        LTMI      IFEQ 'Y'                                 E15549102885
121100200529     C***        MATY      ADD  36525     XMATY   50                E15549102885
121200200529     C***                  ELSE                                     E15549102885
121300200529     C***                  Z-ADDMATY      XMATY                     E15549102885
121400200529     C***                  END                                      E15549102885
121500200529     C                     Z-ADDMATY      XMATY   50                      102885
121600200529     C*
121700200529     C*  ORIGINAL ENTRY DATE = RUN DATE - OUTPUT INITIAL VALUE RECORD
121800200529     C*  (AND IF THIS IS NOT THE 2ND RUN OF SE2100 TODAY)                 E15549
121900200529     C*
122000200529     C           ORED      IFEQ RUND
122100200529     C           ACRLRN    ANDNE'4'                                       E15549
122200200529     C                     EXSR OUTW04
122300200529     C                     END
122400200529     C*
122500200529     C* SEE WHETHER SECURITY IS COMPLETE
122600200529     C*
122700200529     C           INCS      IFEQ 'C'
122800200529      *
122900200529      **  NO COUPON RECORDS FOR PROCESSING TYPE 2,4,OR 7
123000200529      **                     OR DISCOUNTED RECORDS
123100200529      *
123200200529     C           PROT      IFNE '2'
123300200529     C           PROT      ANDNE'4'
123400200529     C           PROT      ANDNE'7'
123500200529     C           STBS      ANDNE'D'
123600200529     C********** CPNR      ANDNE*ZERO                                                054498 MD049798
123700200529     C           CD01      ANDNE*ZERO                                     054498
123800200529      *                                                                   206316
123900200529      ** If CSE031 is ON, and Coupon Due Event on Security Non-Diary      206316
124000200529      ** Events file is present, Set the Event Date on the Non-Diary      206316
124100200529      ** Events file to be the Next Coupon Date on the Securities file.   206316
124200200529      *                                                                   206316
124300200529 B1  C           CSE031    IFEQ 'Y'                                       206316
124400200529     C           BCNV      ANDNE' '                                       206316
124500200529     C           BCNV      ANDNE'N'                                       206316
124600200529     C           CSE071    OREQ 'Y'                                       CSE071
124700200529     C           BCNV      ANDNE' '                                       CSE071
124800200529     C           BCNV      ANDNE'N'                                       CSE071
124900200529     C                     Z-ADDWNCD      NCD                             206316
125000200529      *                                                                   206316
125100200529     C                     MOVELSESN      SNSN                            206316
125200200529     C                     MOVEL'CG'      SNET                            206316
125300200529     C                     Z-ADD*HIVAL    SNDT                            206316
125400200529     C           SETGKY    SETGTSNDEVDO                                   206316
125500200529     C           SNDVPK    READESNDEVDO                  99               206316
125600200529 B2  C           *IN,99    IFEQ '0'                                       206316
125700200529     C           RECI      ANDEQ'D'                                       206316
125800200529      *                                                                   206316
125900200529 B3  C           SNDT      IFGT LCPN                                      206316
126000200529     C           NCD       ANDGTSNDT                                      206316
126100200529     C                     Z-ADDNCD       SNDT                            206316
126200200529     C                     UPDATSNDEVDO                                   206316
126300200529 E3  C                     ENDIF                                          206316
126400200529 E2  C                     ENDIF                                          206316
126500200529      *                                                                   206316
126600200529 E1  C                     ENDIF                                          206316
126700200529     C*
126800200529     C* IF APPLICABLE, CALCULATE NEXT COUPON DATE
126900200529     C*
127000200529     C*                                                                   054498
127100200529     C* IF COUPON DUE EVENT ON SECURITY NON-DIARY EVENTS FILE IS PRESENT  054498
127200200529     C* USE THE DATE ON IT AS THE NEXT COUPON DATE                        054498
127300200529     C*                                                                   054498
127400200529     C                     MOVELSESN      SNSN                            054498
127500200529     C                     MOVEL'CG'      SNET                            054498
127600200529     C                     Z-ADD*HIVAL    SNDT                            054498
127700200529     C           SETGKY    SETGTSNDEVDO                                   054498
127800200529     C           SNDVPK    READESNDEVDO                  99               054498
127900200529     C           *IN,99    IFEQ '0'                                       054498
128000200529     C           RECI      ANDEQ'D'                                       054498
128100200529     C**********           Z-ADDSNDT      NCD                      054498 197357
128200200529     C                     Z-ADDSNDT      NCD                                                 211228
128300200529     C                     Z-ADDSNDT      XNCD    50                      197357
128400200529     C                     Z-ADDXNCD      ZZNCD                           180707
128500200529     C**********           MOVELSESN      SNSN                                         197357 211228
128600200529     C**********           MOVEL'CP'      SNET                                         197357 211228
128700200529     C**********           Z-ADD*HIVAL    SNDT                                         197357 211228
128800200529     C********** SETGKY    SETGTSNDEVDO                                                197357 211228
128900200529     C********** SNDVPK    READESNDEVDO                  99                            197357 211228
129000200529     C********** *IN,99    IFEQ '0'                                                    197357 211228
129100200529     C********** SNDT      ADD  1         ECD                                          197357 211228
129200200529     C**********           ELSE                                                        197357 211228
129300200529     C**********           Z-ADDRUND      ECD                                          197357 211228
129400200529     C**********           ENDIF                                                       197357 211228
129500200529     C**********           EXSR ZNCD                                                   197357 211228
129600200529     C**********           ENDIF                                                       197357 211228
129700200529      **********                                                                       197357 211228
129800200529     C********** XNCD      IFEQ NCD                                                    197357 211228
129900200529     C**********           MOVE XNCD      NCD                                          197357 211228
130000200529     C**********           ELSE                                                        197357 211228
130100200529      **********                                                                       197357 211228
130200200529     C**********           MOVEL*BLANKS   AKRI                                         197357 211228
130300200529     C**********           MOVELSESN      SNSN                                         197357 211228
130400200529     C**********           MOVEL'CG'      SNET                                         197357 211228
130500200529     C**********           Z-ADDXNCD      SNDT                                         197357 211228
130600200529     C********** SETGKY    CHAINSNDEVDO              99                                197357 211228
130700200529     C********** *IN,99    IFEQ '0'                                                    197357 211228
130800200529     C**********           MOVEL*BLANK    PSRI                                         197357 211228
130900200529     C**********           MOVEL'*'       RECI                                         197357 211228
131000200529     C**********           UPDATSNDEVDO                                                197357 211228
131100200529     C**********           SUB  1         OTOT4                                        197357 211228
131200200529     C**********           ENDIF                                                       197357 211228
131300200529     C**********           ENDIF                                                       197357 211228
131400200529      **********                                                                       197357 211228
131500200529     C**********           ELSE                                    054498 197357
131600200529     C                     ELSE                                                               211228
131700200529      **********                                                                       197357 211228
131800200529     C********** *IN,99    IFEQ '1'                                                    197357 211228
131900200529     C********** *IN,99    OREQ '0'                                                    197357 211228
132000200529     C********** RECI      ORNE 'D'                                                    197357 211228
132100200529     C*                                                                   054498
132200200529     C* IF LAST COUPON EVENT ON SECURITY NON-DIARY EVENTS FILE IS PRESENT 054498
132300200529     C* USE THE DATE ON IT TO DETERMINE THE NEXT COUPON DATE              054498
132400200529     C* ELSE USE THE RUN DATE TO DETERMINE THE NEXT COUPON DATE           054498
132500200529     C*                                                                   054498
132600200529     C                     MOVEL'CP'      SNET                            054498
132700200529     C                     Z-ADD*HIVAL    SNDT                            054498
132800200529     C           SETGKY    SETGTSNDEVDO                                   054498
132900200529     C           SNDVPK    READESNDEVDO                  99               054498
133000200529     C           *IN,99    IFEQ '0'                                       054498
133100200529     C*                                                                   182505
133200200529     C           BCNV      IFNE ' '                                       182505
133300200529     C           BCNV      ANDNE'N'                                       CSE031
133400200529     C                     Z-ADDSNDT      ZDAYNO                          182505
133500200529     C                     MOVE NMCY      ZCCY                            182505
133600200529     C                     MOVE *BLANKS   ZLOC                            182505
133700200529     C                     Z-ADD1         ZNRDYS                          182505
133800200529     C                     EXSR ZFWDT                                     182505
133900200529     C                     Z-ADDZDYNBR    ECD                             182505
134000200529     C                     ELSE                                           182505
134100200529     C           SNDT      ADD  1         ECD                             054498
134200200529     C                     ENDIF                                          182505
134300200529     C*                                                                   182505
134400200529     C                     ELSE                                           054498
134500200529     C                     Z-ADDRUND      ECD                             054498
134600200529     C                     END                                            054498
134700200529     C                     EXSR ZNCD                                      054498
134800200529     C                     END                                            054498
134900200529      *****Correct*method for getting Next Coupon Date.            E20085 054498
135000200529      ***********                                                  E20085 054498
135100200529     C***********          Z-ADDECD       SECD    50               E15549 054498
135200200529     C***********          Z-ADDULCPN     ECD                      E15549 E20085
135300200529     C***********NCD       DOWLTRUND                               E15549 E20085
135400200529     C***********CPNR      ANDNE*ZERO                              E15549 E20085
135500200529      ***********                                                  E20085 054498
135600200529      *****To*prevent duplication of entries, type '4' run must useE20142 054498
135700200529      *****tomorrow as Start Date for ZNCD, except when DNWD is in E20142 054498
135800200529      *****next*month, in which case Start Date should be first dayE20142 054498
135900200529      *****next*month since EGEN1 will have handled coupons throughE20142 054498
136000200529      ***********                                                  E20142 054498
136100200529     C***********ACRLRN    IFNE '4'                                E20142 054498
136200200529     C***********          Z-ADDRUND      ECD                      E20085 054498
136300200529     C***********          ELSE                                    E20142 054498
136400200529     C***********DNWD      IFLE EOMDAT                             E20142 054498
136500200529     C***********RUND      ADD  1         ECD                      E20142 054498
136600200529     C***********          ELSE                                    E20142 054498
136700200529     C***********EOMDAT    ADD  1         ECD                      E20142 054498
136800200529     C***********          END                                     E20142 054498
136900200529     C***********          END                                     E20142 054498
137000200529      ***********                                                  E20142 054498
137100200529     C***********CPNR      IFNE *ZERO                              E20085 054498
137200200529     C***********CD01      ANDNE*ZERO                              E15549 054498
137300200529     C***********NCD       ANDLTXMATY                              E18013 E20085
137400200529     C***********          EXSR ZNCD                                      054498
137500200529     C***********          Z-ADDNCD       ECD                      E15549 E20085
137600200529     C***********          END                                     E15549 054498
137700200529     C***********          Z-ADDSECD      ECD                      E15549 054498
137800200529     C                     END
137900200529      *                                                                   CSE023
138000200529      ** If CSE023 is present and Country of Treaty on the Securities     CSE023
138100200529      ** Detail is not equal to Blank, then calculate the Allocation      CSE023
138200200529      ** Date for the Maturity/Coupon Event.                              CSE023
138300200529      *                                                                   CSE023
138400200529     C           CSE023    IFEQ 'Y'                                       CSE023
138500200529     C           CRTT      ANDNE*BLANKS                                   CSE023
138600200529      *                                                                   CSE023
138700200529     C                     MOVE SITP      @INVT                           CSE023
138800200529     C           WHTKEY    CHAINSDWHTTL5             50                   CSE023
138900200529     C           *IN50     IFEQ '1'                                       CSE023
139000200529     C**********           MOVE '  '      @INVT                    CSE023 185803
139100200529     C                     MOVE *BLANKS   @INVT                           185803
139200200529     C           WHTKEY    CHAINSDWHTTL5             50                   CSE023
139300200529     C           *IN50     IFEQ '1'                                       CSE023
139400200529     C                     Z-ADD1         WTALDY                          CSE023
139500200529     C                     ENDIF                                          CSE023
139600200529     C                     ENDIF                                          CSE023
139700200529      *                                                                   CSE023
139800200529      ** If maturity date is not equal to zero then calculate             CSE023
139900200529      ** allocation date.                                                 CSE023
140000200529      *                                                                   CSE023
140100200529     C                     Z-ADD0         MALOCD                          CSE023
140200200529     C           MATY      IFNE 0                                         CSE023
140300200529     C                     Z-ADDMATY      ZDAYNO                          CSE023
140400200529     C                     Z-ADD2         ZNRDYS                          CSE023
140500200529     C                     Z-ADDWTALDY    ZNRDYS                          CSE023
140600200529     C                     MOVE NMCY      ZCCY                            CSE023
140700200529     C                     MOVE *BLANKS   ZLOC                            CSE023
140800200529     C                     EXSR ZBKDT                                     CSE023
140900200529     C                     Z-ADDZDYNBR    MALOCD  50                      CSE023
141000200529     C                     ENDIF                                          CSE023
141100200529      *                                                                   CSE023
141200200529      ** If the Security is interest bearing, then calculate              CSE023
141300200529      ** allocation date for Coupon.                                      CSE023
141400200529      *                                                                   CSE023
141500200529     C                     Z-ADD0         CALOCD                          CSE023
141600200529     C           PROT      IFNE '2'                                       CSE023
141700200529     C           PROT      ANDNE'4'                                       CSE023
141800200529     C           PROT      ANDNE'7'                                       CSE023
141900200529     C           STBS      ANDNE'D'                                       CSE023
142000200529     C           CPNR      ANDNE*ZERO                                     CSE023
142100200529     C           CD01      ANDNE*ZERO                                     CSE023
142200200529     C                     Z-ADDNCD       ZDAYNO                          CSE023
142300200529     C                     Z-ADD2         ZNRDYS                          CSE023
142400200529     C                     Z-ADDWTALDY    ZNRDYS                          CSE023
142500200529     C                     MOVE NMCY      ZCCY                            CSE023
142600200529     C                     MOVE *BLANKS   ZLOC                            CSE023
142700200529     C                     EXSR ZBKDT                                     CSE023
142800200529     C                     Z-ADDZDYNBR    CALOCD  50                      CSE023
142900200529     C                     ENDIF                                          CSE023
143000200529     C                     ENDIF                                          CSE023
143100200529     C*                                                                   CSE023
143200200529     C/COPY WNCPYSRC,SE2100C006
143300200529     C*
143400200529     C*  SECURITY HAS BEEN COMPLETED TODAY
143500200529     C*  (AND IF THIS IS NOT THE 2ND RUN OF SE2100 TODAY)                 E15549
143600200529     C*
143700200529     C           RUND      IFEQ DCOM
143800200529     C           DCOM      ANDNEORED
143900200529     C           ACRLRN    ANDNE'4'                                       E15549
144000200529     C*                                                                   E15549
144100200529     C* UPDATE THE INITIAL RECORDS WITH THE CURRENT DETAILS               E15549
144200200529     C*                                 OFF LF/SECTY                      E15549
144300200529     C*                                                                   E15549
144400200529     C                     Z-ADD*ZERO     KEYDT   50                      E15549
144500200529     C                     Z-ADD1         CNT     20                      E15549
144600200529     C*                                                                   E15549
144700200529     C********** CNT       DOUGT4                                                      E15549 CSE065
144800200529     C           CNT       DOUGT5                                                             CSE065
144900200529     C*                                                                   E15549
145000200529     C                     MOVELETP,CNT   SDET                            E15549
145100200529     C***********PSEDEL    CHAINSECET                30            E15549 180385
145200200529     C           PSEDEL    CHAINSECEU                30                   180385
145300200529     C*                                                                   E15549
145400200529     C           *IN30     IFEQ '0'                                       E15549
145500200529     C*                                                                   E15549
145600200529     C***********CDET      IFEQ 'XR'                               E15549 180385
145700200529     C***********          Z-ADDSEXR      CDCE                     E15549 180385
145800200529     C***********          MOVE SPYC      CDCX                     E23049 180385
145900200529     C***********          MOVE SMDI      CDMD                     E23049 180385
146000200529     C***********          END                                     E15549 180385
146100200529     C***********CDET      IFEQ 'IR'                               E15549 180385
146200200529     C***********          Z-ADDCPNR      CDNC                     E15549 180385
146300200529      *                                                                                       CAS006
146400200529     C           CAS006    IFEQ 'Y'                                                           CAS006
146500200529     C                     Z-ADDCPNN      CDNN                                                CAS006
146600200529     C                     ENDIF                                                              CAS006
146700200529      *                                                                                       CAS006
146800200529     C/COPY WNCPYSRC,SE2100C021
146900200529     C***********          END                                     E15549 180385
147000200529     C***********CDET      IFEQ 'MP'                               E15549 180385
147100200529     C***********          Z-ADDCFCT      CDCP                     E15549 180385
147200200529     C***********          END                                     E15549 180385
147300200529     C***********CDET      IFEQ 'PP'                               E15549 180385
147400200529     C***********CDPC      IFEQ *ZERO                              E15549 E23049
147500200529     C***********PROT      IFEQ '4'                                E23049 180385
147600200529     C***********          MOVE CPDP      CDPP                     E15549 180385
147700200529     C***********          MOVE CPDP      CDTA                     E23049 180385
147800200529     C***********          ELSE                                    E15549 180385
147900200529     C***********          MOVE CPDP      CDPC                     E15549 180385
148000200529     C***********          MOVE CPDP      CDTP                     E23049 180385
148100200529     C***********          END                                     E15549 180385
148200200529     C***********          END                                     E15549 180385
148300200529      *                                                                                       CSE065
148400200529     C           CDET      IFEQ 'AL'                                                          CSE065
148500200529     C           CSE065    ANDEQ'Y'                                                           CSE065
148600200529     C                     Z-ADDALDT      SDAL                                                CSE065
148700200529     C                     END                                                                CSE065
148800200529      *                                                                   180385
148900200529      ** Renamed fields                                                   180385
149000200529      *                                                                   180385
149100200529     C           UDET      IFEQ 'XR'                                      180385
149200200529     C                     Z-ADDSEXR      UDCE                            180385
149300200529     C                     MOVE SPYC      UDCX                            180385
149400200529     C                     MOVE SMDI      UDMD                            180385
149500200529     C                     END                                            180385
149600200529     C           UDET      IFEQ 'IR'                                      180385
149700200529     C                     Z-ADDCPNR      UDNC                            180385
149800200529     C                     END                                            180385
149900200529     C           UDET      IFEQ 'MP'                                      180385
150000200529     C                     Z-ADDCFCT      UDCP                            180385
150100200529     C                     END                                            180385
150200200529     C           UDET      IFEQ 'PP'                                      180385
150300200529     C           PROT      IFEQ '4'                                       180385
150400200529     C                     MOVE CPDP      UDPP                            180385
150500200529     C                     MOVE CPDP      UDTA                            180385
150600200529     C                     ELSE                                           180385
150700200529     C                     MOVE CPDP      UDPC                            180385
150800200529     C                     MOVE CPDP      UDTP                            180385
150900200529     C                     END                                            180385
151000200529     C                     END                                            180385
151100200529     C*                                                                   E15549
151200200529     C***********          UPDATSEDEVDC                            E15549 180385
151300200529     C                     UPDATSEDEVDU                                   180385
151400200529     C                     END                                            E15549
151500200529     C                     ADD  1         CNT                             E15549
151600200529     C                     END                                            E15549
151700200529     C*
151800200529     C                     END
151900200529     C*                                                                   S96032
152000200529     C/COPY WNCPYSRC,SE2100CCP5                                           S96032
152100200529     C*                                                                   S96032
152200200529     C                     END
152300200529     C*
152400200529     C                     ENDSR
152500200529      *
152600200529      *****************************************************************
152700200529      /EJECT
152800200529      *****************************************************************
152900200529      *                                                               *
153000200529      *  PROCES - Subroutine to process each Input Diary Event (SEDEL)*
153100200529      *                                                               *
153200200529      *  Called By: Main Processing.                                  *
153300200529      *  Calls: ZNCD, OUTW01, OUTW03, UPDDEL                          *
153400200529      *                                                               *
153500200529      *****************************************************************
153600200529      *
153700200529     C           PROCES    BEGSR                           *** PROCES ***
153800200529     C***********                                                   E15549E23049
153900200529     C**SEC.*DIARY*EVENTS*NOT*DUE*AND*FLAGGED*FOR*DELETION*-*DELETE*THEM49E23049
154000200529     C***********                                                   E15549E23049
154100200529     C*** SEC. DIARY EVENTS NOT POSTED AND FLAGGED FOR DETETE - DELETE IT E23049
154200200529     C*                                                                   E15549
154300200529     C***********XSDED     IFGT ECD                                E15549 E23049
154400200529     C***********XRECI     ANDEQ'C'                                E15549 E23049
154500200529     C           XRECI     IFEQ 'C'                                       E23049
154600200529     C           XSDAD     ANDEQ*ZERO                                     E23049
154700200529     C           XSDDT     ANDEQ*ZERO                                     E23049
154800200529     C                     MOVE '1'       *IN47                           183206
154900200529     C                     EXSR UPDDEL                                    E15549
155000200529     C                     MOVE '0'       *IN47                           183206
155100200529     C                     GOTO EPROCS                                    E15549
155200200529     C                     END                                            E15549
155300200529     C*
155400200529     C*  CHECK FOR NO POSITION ACTION
155500200529     C*  AND EVENT DATE DUE                                               E15549
155600200529     C*
155700200529     C           XSDET     IFEQ 'XR'                                      054498
155800200529     C           XSDED     ANDLEAKDAT                                     054498
155900200529     C           XSDET     OREQ 'RC'                                      054498
156000200529     C           USCPD     ANDLEAKDAT                                     054498
156100200529     C           XSDET     OREQ 'RP'                                      054498
156200200529     C           USCPD     ANDLEAKDAT                                     054498
156300200529     C           XSDET     OREQ 'RP'                                      054498
156400200529     C           USCPD     ANDGEXSDED                                     054498
156500200529     C           XSDET     OREQ 'RC'                                      054498
156600200529     C           USCPD     ANDGEXSDED                                     054498
156700200529     C           XSDET     OREQ 'OC'                                      048059
156800200529     C           XSDED     ANDLTAKDAT                                     048059
156900200529     C***********XSDET     IFNE 'DV'                                      E23049
157000200529     C***********XSDET     ANDNE'PP'                                      E23049
157100200529     C***********XSDET     ANDNE'MP'                                      E23049
157200200529     C***********XSDET     ANDNE'IR'                                      E23049
157300200529     C***********XSDED     ANDLTECD                                E15549 E23049
157400200529     C***********XSDET     IFEQ 'XR'                               E23049 054498
157500200529     C***********XSDED     ANDLEECD                                E23049 E23802
157600200529     C***********XSDED     ANDLTECD                                E23802 054498
157700200529     C***********XSDET     OREQ 'XR'                               E23802 054498
157800200529     C***********XSDED     ANDLEECD                                E23802 054498
157900200529     C***********ACRLRN    ANDEQ'3'                                E23802 054498
158000200529     C***********                                                  E23049 054498
158100200529     C****Update*Next Redemption Price if Previous price Expired, oE23049 054498
158200200529     C****the*new Redemption price is On or Before the current PricE23049 054498
158300200529     C***********                                                  E23049 054498
158400200529     C***********XSDET     OREQ 'RC'                               E23049 054498
158500200529     C***********USCPD     ANDLTECD                                E23049 054498
158600200529     C***********XSDET     OREQ 'RP'                               E23049 054498
158700200529     C***********USCPD     ANDLTECD                                E23049 054498
158800200529     C***********XSDET     OREQ 'RP'                               E23049 054498
158900200529     C***********USCPD     ANDGEXSDED                              E23049 054498
159000200529     C***********XSDET     OREQ 'RC'                               E23049 054498
159100200529     C***********USCPD     ANDGEXSDED                              E23049 054498
159200200529     C*****************************************************************   E23049
159300200529     C**LIVE*SEC.DIARY*EVENTS**************************************E15549 E23049
159400200529     C*************************************************************E15549 E23049
159500200529     C***********XRECI     IFEQ 'D'                                       E23049
159600200529     C*
159700200529     C*  UPDATE SECURITY FIELDS ACCORDING TO WHETHER SECURITY SHOULD
159800200529     C*  BE UPDATED AND IF SO BY EVENT TYPE
159900200529     C*
160000200529     C           UPDSEC    IFEQ 'Y'
160100200529     C*
160200200529     C           XSDET     IFEQ 'XR'
160300200529     C                     Z-ADDXSDCE     USEXR
160400200529     C                     MOVE XSDCX     USPYC                           E23049
160500200529     C                     MOVE XSDMD     USMDI                           E23049
160600200529     C                     MOVEA'1'       *IN,45
160700200529     C                     END
160800200529     C*
160900200529     C           XSDET     IFEQ 'RC'
161000200529     C***********USCPI     ANDEQ*BLANK                                    E23049
161100200529     C********** XSDED     ANDLEECD                                077649 183206
161200200529     C           XSDED     ANDLEAKDAT                                     183206
161300200529     C                     Z-ADDXSDED     USCPD
161400200529     C                     Z-ADDXSDRP     USCPP
161500200529     C                     MOVEL'C'       USCPI
161600200529     C                     MOVEA'1'       *IN,46
161700200529     C                     END
161800200529     C*
161900200529     C           XSDET     IFEQ 'RP'
162000200529     C***********USCPI     ANDEQ*BLANK                                    E23049
162100200529     C********** XSDED     ANDLEECD                                077649 183206
162200200529     C           XSDED     ANDLEAKDAT                                     183206
162300200529     C                     Z-ADDXSDED     USCPD
162400200529     C                     Z-ADDXSDRP     USCPP
162500200529     C                     MOVEL'P'       USCPI
162600200529     C                     MOVEA'1'       *IN,46
162700200529     C                     END
162800200529     C*
162900200529     C                     ELSE
163000200529     C           UPDSEC    IFEQ 'C'
163100200529     C*
163200200529     C           XSDET     IFEQ 'XR'
163300200529     C                     Z-ADDCDCE      USEXR
163400200529     C                     MOVE CDCX      USPYC                           E23049
163500200529     C                     MOVE CDMD      USMDI                           E23049
163600200529     C                     MOVEA'1'       *IN,45
163700200529     C                     END
163800200529     C*
163900200529     C           XSDET     IFEQ 'RC'
164000200529     C***********USCPI     ANDEQ*BLANK                                    E23049
164100200529     C           XSDED     ANDLEECD                                       077649
164200200529     C                     Z-ADDCDED      USCPD
164300200529     C                     Z-ADDCDRP      USCPP
164400200529     C                     MOVEL'C'       USCPI
164500200529     C                     MOVEA'1'       *IN,46
164600200529     C                     END
164700200529     C*
164800200529     C           XSDET     IFEQ 'RP'
164900200529     C***********USCPI     ANDEQ*BLANK                                    E23049
165000200529     C           XSDED     ANDLEECD                                       077649
165100200529     C                     Z-ADDCDED      USCPD
165200200529     C                     Z-ADDCDRP      USCPP
165300200529     C                     MOVEL'P'       USCPI
165400200529     C                     MOVEA'1'       *IN,46
165500200529     C                     END
165600200529     C*
165700200529     C                     ELSE
165800200529     C           UPDSEC    IFEQ 'Z'
165900200529     C*
166000200529     C           XSDET     IFEQ 'XR'
166100200529     C                     Z-ADD*ZERO     USEXR
166200200529     C                     MOVE *BLANK    USPYC                           E23049
166300200529     C                     MOVE *BLANK    USMDI                           E23049
166400200529     C                     MOVEA'1'       *IN,45
166500200529     C                     END
166600200529     C*
166700200529     C           XSDET     IFEQ 'RC'
166800200529     C***********USCPI     ANDEQ*BLANK                                    E23049
166900200529     C                     Z-ADD*ZERO     USCPD
167000200529     C                     Z-ADD*ZERO     USCPP
167100200529     C***********          MOVEL'C'       USCPI                           E23049
167200200529     C                     MOVE *BLANK    USCPI                           E23049
167300200529     C                     MOVEA'1'       *IN,46
167400200529     C                     END
167500200529     C*
167600200529     C           XSDET     IFEQ 'RP'
167700200529     C***********USCPI     ANDEQ*BLANK                                    E23049
167800200529     C                     Z-ADD*ZERO     USCPD
167900200529     C                     Z-ADD*ZERO     USCPP
168000200529     C***********          MOVEL'P'       USCPI                           E23049
168100200529     C                     MOVE *BLANK    USCPI                           E23049
168200200529     C                     MOVEA'1'       *IN,46
168300200529     C                     END
168400200529     C*
168500200529     C                     END
168600200529     C                     END
168700200529     C                     END
168800200529     C*
168900200529     C*  UPDATE SECURITY DIARY RECORD
169000200529     C*
169100200529     C                     EXSR UPDDEL
169200200529     C*
169300200529     C***********                                                         E23049
169400200529     C***********          END                                      E15549E23049
169500200529     C***********                                                   E15549E23049
169600200529     C**PROCESS*SEC.DIARY*EVENTS*FLAGGED*FOR*DELETION-DELETE*THEM** E15549E23049
169700200529     C***********                                                   E15549E23049
169800200529     C***********XRECI     IFEQ 'C'                                 S01158E23049
169900200529     C***********                                                         E23049
170000200529     C***UPDATE*SECURITY DIARY RECORD                                     E23049
170100200529     C***********                                                         E23049
170200200529     C***********          EXSR UPDDEL                                    E23049
170300200529     C***********          END                                            E23049
170400200529     C*
170500200529     C                     END
170600200529     C*                                                                   E15549
170700200529     C*  CHECK FOR POSITION ACTION                                        E15549
170800200529     C*                                                                   E15549
170900200529     C           XSDET     IFEQ 'DV'                                      E15549
171000200529     C           XSDET     OREQ 'PP'                                      E15549
171100200529     C           XSDET     OREQ 'MP'                                      E15549
171200200529     C           XSDET     OREQ 'IR'                                      E15549
171300200529     C/COPY WNCPYSRC,SE2100C008
171400200529      *                                                                   CSE023
171500200529      ** If CSE023 is present and Country of Treaty on the Securities     CSE023
171600200529      ** Detail is not equal to Blank, then calculate the Allocation      CSE023
171700200529      ** Date for the Dividend Event                                      CSE023
171800200529      *                                                                   CSE023
171900200529     C           CSE023    IFEQ 'Y'                                       CSE023
172000200529     C           CRTT      ANDNE*BLANKS                                   CSE023
172100200529      *                                                                   CSE023
172200200529     C                     Z-ADDXSDED     ZDAYNO                          CSE023
172300200529     C                     Z-ADD2         ZNRDYS                          CSE023
172400200529     C                     Z-ADDWTALDY    ZNRDYS                          CSE023
172500200529     C                     MOVE NMCY      ZCCY                            CSE023
172600200529     C                     MOVE *BLANKS   ZLOC                            CSE023
172700200529     C                     EXSR ZBKDT                                     CSE023
172800200529     C                     Z-ADDZDYNBR    DALOCD  50                      CSE023
172900200529     C                     ENDIF                                          CSE023
173000200529     C*                                                                   E15549
173100200529     C*  AND EVENT DATE DUE                                               E15549
173200200529     C*                                                                   E15549
173300200529     C***********XSDED     CABGTECD       EPROCS                   E15549 054498
173400200529     C           CSE023    IFEQ 'Y'                                       CSE023
173500200529     C           CRTT      ANDNE*BLANKS                                   CSE023
173600200529     C           DALOCD    CABGTPSDAT     EPROCS                          CSE023
173700200529     C                     ELSE                                           CSE023
173800200529     C           XSDED     CABGTPSDAT     EPROCS                          054498
173900200529     C                     ENDIF                                          CSE023
174000200529     C*
174100200529     C           XRECI     IFEQ 'D'
174200200529      *                                                                   E15549
174300200529      * IF COUPON DUE PRIOR TO THIS SEC.DIARY EVENT PROCESS IT NOW        E15549
174400200529      * Generate coupon event before if its the same date.                170949
174500200529      *                                                                   E15549
174600200529     C           NCD       IFNE *ZERO                                     E15549
174700200529     C***********NCD       ANDLTXSDED                              E15549 170949
174800200529     C           NCD       ANDLEXSDED                                     170949
174900200529     C           CSE023    ANDNE'Y'                                       CSE023
175000200529     C*                                                                   CSE023
175100200529     C           CSE023    OREQ 'Y'                                       CSE023
175200200529     C           CRTT      ANDEQ*BLANKS                                   CSE023
175300200529     C           NCD       ANDNE*ZERO                                     CSE023
175400200529     C           NCD       ANDLEXSDED                                     CSE023
175500200529     C*                                                                   CSE023
175600200529     C           CSE023    OREQ 'Y'                                       CSE023
175700200529     C           XSDET     ANDNE'DV'                                      CSE023
175800200529     C           NCD       ANDNE*ZERO                                     CSE023
175900200529     C           NCD       ANDLEXSDED                                     CSE023
176000200529     C*                                                                   CSE023
176100200529     C           CSE023    OREQ 'Y'                                       CSE023
176200200529     C           XSDET     ANDEQ'DV'                                      CSE023
176300200529     C           CRTT      ANDNE*BLANKS                                   CSE023
176400200529     C           CALOCD    ANDNE0                                         CSE023
176500200529     C           CALOCD    ANDLEXSDED                                     CSE023
176600200529     C*                                                                   E15549
176700200529     C*   .... WRITE SECURITY ACTION - COUPON (W01)                       E15549
176800200529     C*                                                                   E15549
176900200529     C/COPY WNCPYSRC,SE2100C009
177000200529     C                     EXSR OUTW01                                    E15549
177100200529     C/COPY WNCPYSRC,SE2100C010
177200200529     C*                                                                   E15549
177300200529      **AND*UPDATE*THE*COUPON*DATE*TO*THE*NEXT*COUPON*DATE******   E15549 E37295
177400200529      ***********                                                  E15549 E37295
177500200529      *****ZNCD*will*return*ECD*if*ECD*is*a*Coupon*Date,*so*it*is**E20085 E37295
177600200529      *****necessary*to*add*1*to*NCD*to*ensure*the*correct*result**E20085 E37295
177700200529      ***********                                                  E20085 E37295
177800200529     C***********          Z-ADDECD       SECD                     E15549 E37295
177900200529     C***********          Z-ADDNCD       ECD                      E15549 E20085
178000200529     C***********NCD       ADD  1         ECD                      E20085 E37295
178100200529     C***********          EXSR ZNCD                               E15549 E37295
178200200529     C***********          Z-ADDSECD      ECD                      E15549 E37295
178300200529     C                     END                                            E15549
178400200529     C                     END                                            E23049
178500200529     C*
178600200529      * WRITE SECURITY ACTION FOR SEC.DIARY EVENT                         E15549
178700200529      *                                                                   E15549
178800200529     C*                                                                   137563
178900200529     C           XRECI     IFEQ 'D'                                       137563
179000200529     C           XSDET     ANDEQ'IR'                                      137563
179100200529     C           RCFQ      ANDEQ' '                                       137563
179200200529     C                     EXSR IRCHCK                                    137563
179300200529     C                     ENDIF                                          137563
179400200529     C*                                                                   137563
179500200529     C           XRECI     IFEQ 'D'                                       137563
179600200529     C           XSDET     ANDEQ'IR'                                      137563
179700200529     C           *IN50     ANDEQ'0'                                       137563
179800200529     C           RCFQ      ANDEQ' '                                       137563
179900200529     C* IR event is invalid, don't generate SE actions                    137563
180000200529     C                     ELSE                                           137563
180100200529     C/COPY WNCPYSRC,SE2100C011
180200200529     C                     EXSR OUTW03
180300200529     C                     ENDIF                                          137563
180400200529     C*                                                                   137563
180500200529     C/COPY WNCPYSRC,SE2100C012
180600200529     C*
180700200529     C*  UPDATE SECURITY FIELDS ACCORDING TO WHETHER SECURITY SHOULD
180800200529     C*  BE UPDATED AND IF SO BY EVENT TYPE
180900200529     C*
181000200529     C** Update Security and Diary only when postings are required        E23802
181100200529     C*                                                                   E23802
181200200529     C***********XSDED     IFLT ECD                                E23802 054498
181300200529     C***********XSDED     ORLE ECD                                E23802 054498
181400200529     C***********ACRLRN    ANDEQ'3'                                E23802 054498
181500200529     C           XSDED     IFLE AKDAT                                     054498
181600200529     C*                                                                   E23802
181700200529     C           UPDSEC    IFEQ 'Y'
181800200529     C*
181900200529     C           XSDET     IFEQ 'DV'                                      E23802
182000200529     C                     Z-ADDXSDED     ULCPN                           E23802
182100200529     C                     MOVEA'1'       *IN,41                          E23802
182200200529     C                     END                                            E23802
182300200529     C*                                                                   E23802
182400200529     C           XSDET     IFEQ 'IR'
182500200529     C           RCFQ      IFEQ ' '                                       137563
182600200529     C           *IN50     ANDEQ'0'                                       137563
182700200529     C           XRECI     ANDEQ'D'                                       137563
182800200529     C                     Z-ADDXSDED     KEYDT                           137563
182900200529     C           KSEDEL    CHAINSEDEVDF              30                   137563
183000200529     C           *IN30     IFEQ '0'                                       137563
183100200529     C                     MOVEL'C'       RECI                            137563
183200200529     C                     UPDATSEDEVDF                                   137563
183300200529     C                     ENDIF                                          137563
183400200529     C                     ELSE                                           137563
183500200529     C                     Z-ADDXSDNC     UCPNR
183600200529      *                                                                                       CAS006
183700200529     C           CAS006    IFEQ 'Y'                                                           CAS006
183800200529     C                     Z-ADDXSDNN     UCPNN                                               CAS006
183900200529     C                     Z-ADDXSCRS     UCCRK                                               CAS006
184000200529     C                     Z-ADDXSLQP     UCLQP                                               CAS006
184100200529     C                     ENDIF                                                              CAS006
184200200529      *                                                                                       CAS006
184300200529     C/COPY WNCPYSRC,SE2100C022
184400200529     C                     MOVEA'1'       *IN,42
184500200529     C                     ENDIF                                          137563
184600200529     C                     END
184700200529     C*
184800200529     C           XSDET     IFEQ 'MP'
184900200529     C                     Z-ADDUCFCT     PCFCT
185000200529     C                     Z-ADDXSDCP     UCFCT
185100200529     C                     MOVEA'1'       *IN,43
185200200529     C                     END
185300200529     C/COPY WNCPYSRC,SE2100C013
185400200529     C*
185500200529     C* UPDATE UCPDP WITH THE RUNNING TOTAL RATHER THAN THE CALL AMT      E15930
185600200529     C* FROM DIARY FOR THE PARTLY PAIDS.                                  E15930
185700200529     C*
185800200529     C           XSDET     IFEQ 'PP'
185900200529     C***********XSDPC     IFEQ *ZERO                                     E15930
186000200529     C***********          MOVE XSDPP     UCPDP                           E15930
186100200529     C           XSDTP     IFEQ *ZERO                                     E15930
186200200529     C                     MOVE XSDTA     UCPDP                           E15930
186300200529     C                     ELSE
186400200529     C***********          MOVE XSDPC     UCPDP                           E15930
186500200529     C                     MOVE XSDTP     UCPDP                           E15930
186600200529     C                     END
186700200529     C                     Z-ADDXSDED     USLCA
186800200529     C                     MOVEA'1'       *IN,44
186900200529     C                     END
187000200529     C*
187100200529     C                     ELSE
187200200529     C           UPDSEC    IFEQ 'C'
187300200529     C*
187400200529     C           XSDET     IFEQ 'DV'                                      E23802
187500200529     C                     Z-ADDCDED      ULCPN                           E23802
187600200529     C                     MOVEA'1'       *IN,41                          E23802
187700200529     C                     END                                            E23802
187800200529     C*                                                                   E23802
187900200529     C           XSDET     IFEQ 'IR'
188000200529     C                     Z-ADDCDNC      UCPNR
188100200529      *                                                                                       CAS006
188200200529     C           CAS006    IFEQ 'Y'                                                           CAS006
188300200529     C                     Z-ADDCDNN      UCPNN                                               CAS006
188400200529     C                     Z-ADDCCRK      UCCRK                                               CAS006
188500200529     C                     Z-ADDCLQP      UCLQP                                               CAS006
188600200529     C                     ENDIF                                                              CAS006
188700200529      *                                                                                       CAS006
188800200529     C/COPY WNCPYSRC,SE2100C023
188900200529     C                     MOVEA'1'       *IN,42
189000200529     C                     END
189100200529     C*
189200200529     C           XSDET     IFEQ 'MP'
189300200529     C                     Z-ADDUCFCT     PCFCT
189400200529     C                     Z-ADDCDCP      UCFCT
189500200529     C                     MOVEA'1'       *IN,43
189600200529     C                     END
189700200529     C*
189800200529     C           XSDET     IFEQ 'PP'
189900200529     C***********XSDPC     IFEQ *ZERO                                     E15930
190000200529     C***********          MOVE CDPP      UCPDP                           E15930
190100200529     C           XSDTP     IFEQ *ZERO                                     E15930
190200200529     C                     MOVE CDTA      UCPDP                           E15930
190300200529     C                     ELSE
190400200529     C***********          MOVE CDPC      UCPDP                           E15930
190500200529     C                     MOVE CDTP      UCPDP                           E15930
190600200529     C                     END
190700200529     C                     Z-ADDCDED      USLCA
190800200529     C                     MOVEA'1'       *IN,44
190900200529     C                     END
191000200529     C*
191100200529     C                     ELSE
191200200529     C           UPDSEC    IFEQ 'Z'
191300200529     C*
191400200529     C           XSDET     IFEQ 'DV'                                      E23802
191500200529     C                     Z-ADD*ZERO     ULCPN                           E23802
191600200529     C                     MOVEA'1'       *IN,41                          E23802
191700200529     C                     END                                            E23802
191800200529     C*                                                                   E23802
191900200529     C           XSDET     IFEQ 'IR'
192000200529     C                     Z-ADD*ZERO     UCPNR
192100200529      *                                                                                       CAS006
192200200529     C           CAS006    IFEQ 'Y'                                                           CAS006
192300200529     C                     Z-ADD*ZERO     UCPNN                                               CAS006
192400200529     C                     Z-ADD*ZERO     UCCRK                                               CAS006
192500200529     C                     Z-ADD*ZERO     UCLQP                                               CAS006
192600200529     C                     ENDIF                                                              CAS006
192700200529      *                                                                                       CAS006
192800200529     C                     MOVEA'1'       *IN,42
192900200529     C                     END
193000200529     C*
193100200529     C           XSDET     IFEQ 'MP'
193200200529     C                     Z-ADDUCFCT     PCFCT
193300200529     C                     Z-ADD*ZERO     UCFCT
193400200529     C                     MOVEA'1'       *IN,43
193500200529     C                     END
193600200529     C*
193700200529     C           XSDET     IFEQ 'PP'
193800200529     C***********CDPC      IFEQ *ZERO                                     E23049
193900200529     C***********          MOVE *ZERO     UCPDP                           E23049
194000200529     C***********          ELSE                                           E23049
194100200529     C                     MOVE *ZERO     UCPDP
194200200529     C***********          END                                            E23049
194300200529     C                     Z-ADD*ZERO     USLCA
194400200529     C                     MOVEA'1'       *IN,44
194500200529     C                     END
194600200529     C*
194700200529     C                     END
194800200529     C                     END
194900200529     C                     END
195000200529     C*
195100200529     C*  UPDATE SECURITY DIARY RECORD
195200200529     C*
195300200529     C                     EXSR UPDDEL
195400200529     C*
195500200529     C***********          END                                            E23049
195600200529     C***********                                                         E23049
195700200529     C***********XRECI     IFEQ 'C'                                 S01158E23049
195800200529     C***********                                                         E23049
195900200529     C**IF*ALREADY*ACTIONED,*WRITE*SECURITY*ACTION*********************   E23049
196000200529     C***********                                                         E23049
196100200529     C***********XSDAD     IFNE *ZERO                                     E23049
196200200529     C***********XSDDT     ORNE *ZERO                                     E23049
196300200529     C***********          EXSR OUTW03                                    E23049
196400200529     C***********          END                                            E23049
196500200529     C***********                                                         E23049
196600200529     C***UPDATE*SECURITY*DIARY*RECORD**********************************   E23049
196700200529     C***********                                                         E23049
196800200529     C***********          EXSR UPDDEL                                    E23049
196900200529     C***********                                                         E23049
197000200529     C***********          END                                            E23049
197100200529     C*
197200200529     C                     ELSE                                           E31622
197300200529     C                     EXSR UPDDEL                                    E31622
197400200529     C                     END                                            E23802
197500200529     C                     END
197600200529      *
197700200529     C* UPDATE OTHER DIARY EVENTS WITH EVENT DATES LESS THAN EVENT        041031
197800200529     C* CONTROL DATE.                                                     041031
197900200529     C           XSDET     IFNE 'XR'                                      041031
198000200529     C           XSDET     ANDNE'RC'                                      041031
198100200529     C           XSDET     ANDNE'RP'                                      041031
198200200529     C           XSDET     ANDNE'DV'                                      041031
198300200529     C           XSDET     ANDNE'PP'                                      041031
198400200529     C           XSDET     ANDNE'MP'                                      041031
198500200529     C/COPY WNCPYSRC,SE2100C014
198600200529     C           XSDET     ANDNE'IR'                                      041031
198700200529     C***********XSDED     ANDLTECD                                041031 054498
198800200529     C           XSDED     ANDLEAKDAT                                     054498
198900200529     C                     EXSR UPDDEL                                    041031
199000200529     C                     END                                            041031
199100200529     C*                                                                   041031
199200200529     C           EPROCS    ENDSR                            *PROCES ENDSR*E15549
199300200529      *
199400200529      *****************************************************************
199500200529      /EJECT
199600200529      *****************************************************************
199700200529      *                                                               *
199800200529      *  UPDDEL - Subroutine to Update the Security Diary.            *
199900200529      *                                                               *
200000200529      *  Called By: PROCES                                            *
200100200529      *  Calls: None.                                                 *
200200200529      *                                                               *
200300200529      *****************************************************************
200400200529      *
200500200529     C           UPDDEL    BEGSR                           **UPDDEL BEGSR**
200600200529     C*
200700200529     C*  CHAIN TO UPDATE FILE
200800200529     C*
200900200529     C           XSDET     IFNE 'RC'                                      077649
201000200529     C           XSDET     ANDNE'RP'                                      077649
201100200529     C           XSDET     OREQ 'RC'                                      077649
201200200529     C********** XSDED     ANDLEECD                                077649 183206
201300200529     C           XSDED     ANDLEAKDAT                                     183206
201400200529     C           XSDET     OREQ 'RP'                                      077649
201500200529     C********** XSDED     ANDLEECD                                077649 183206
201600200529     C           XSDED     ANDLEAKDAT                                     183206
201700200529     C           *IN47     OREQ '1'                                       183206
201800200529     C                     Z-ADDXSDED     KEYDT
201900200529     C           KSEDEL    CHAINSEDEVDF              30
202000200529     C*
202100200529     C           RECI      IFEQ 'C'                                       S01158
202200200529     C*
202300200529     C                     MOVEL'*'       RECI
202400200529     C                     ADD  1         DTOTD
202500200529     C*
202600200529     C                     ELSE
202700200529     C*
202800200529     C           SDET      IFEQ 'DV'
202900200529     C           SDET      OREQ 'PP'
203000200529     C           SDET      OREQ 'MP'
203100200529     C           SDET      OREQ 'IR'
203200200529     C           SDET      OREQ 'AL'                                                          CSE065
203300200529     C           CSE065    ANDEQ'Y'                                                           CSE065
203400200529     C/COPY WNCPYSRC,SE2100C015
203500200529     C*
203600200529     C*  POSITION ACTION
203700200529     C*  ACTIONED DATES SET TO EVENT CONTROL DATE FOR SE2370/80/90/2400   E15549
203800200529     C*
203900200529     C***********SDDT      IFEQ *ZERO                              E15549 054498
204000200529     C***********          Z-ADDECD       SDDT                     E15549 054498
204100200529     C***********          END                                     E15549 054498
204200200529     C***********                                                         054498
204300200529     C***********SDED      IFLT ECD                                E15549 054498
204400200529     C***********SDED      OREQ ECD                                E20125 054498
204500200529     C***********ACRLRN    ANDEQ'3'                                E20125 054498
204600200529     C***********          Z-ADDECD       SDAD                     E15549 054498
204700200529     C***********          MOVEL'M'       RECI                            054498
204800200529     C***********          ADD  1         DTOTU                           054498
204900200529     C***********          END                                            054498
205000200529     C*                                                                   054498
205100200529     C           SDDT      IFEQ *ZERO                                     054498
205200200529     C                     Z-ADDRUND      SDDT                            054498
205300200529     C                     END                                            054498
205400200529     C*                                                                   054498
205500200529     C           SDED      IFLE AKDAT                                     054498
205600200529     C                     Z-ADDRUND      SDAD                            054498
205700200529     C                     MOVEL'M'       RECI                            054498
205800200529     C                     ADD  1         DTOTU                           054498
205900200529     C                     END                                            054498
206000200529      *                                                                                       CSE065
206100200529     C           XSDET     IFEQ 'AL'                                                          CSE065
206200200529     C           CSE065    ANDEQ'Y'                                                           CSE065
206300200529     C           XSDAL     IFNE 0                                                             CSE065
206400200529     C           UALDT     ANDLTXSDAL                                                         CSE065
206500200529     C                     Z-ADDXSDAL     UALDT                                               CSE065
206600200529     C                     MOVE *ON       *IN48                                               CSE065
206700200529     C                     ENDIF                                                              CSE065
206800200529     C                     ENDIF                                                              CSE065
206900200529     C*
207000200529     C                     ELSE
207100200529     C*
207200200529     C*  NOT POSITION ACTION
207300200529     C*
207400200529     C                     MOVEL'M'       RECI
207500200529     C                     Z-ADDRUND      SDAD
207600200529     C                     ADD  1         DTOTU
207700200529     C*
207800200529     C                     END
207900200529     C                     END
208000200529     C*
208100200529     C  N30                UPDATSEDEVDF
208200200529     C                     END                                            077649
208300200529     C*
208400200529     C                     ENDSR
208500200529      *
208600200529      *****************************************************************
208700200529      /EJECT
208800200529      *****************************************************************
208900200529      *                                                               *
209000200529      *  ENDSEC - Subroutine for End of Security Processing.          *
209100200529      *                                                               *
209200200529      *  Called By: Main Processing.                                  *
209300200529      *  Calls: None.                                                 *
209400200529      *                                                               *
209500200529      *****************************************************************
209600200529      *
209700200529     C           ENDSEC    BEGSR                           **ENDSEC BEGSR**
209800200529      *                                                                   E15549
209900200529      * IF COUPON DUE (AND NOT YET DONE IN THE SEC.DIARY EVENT SECTION)   E15549
210000200529     C*                                                                   E15549
210100200529     C***********NCD       IFNE *ZERO                              E15549 054498
210200200529     C***********NCD       ANDLEECD                                E15549 054498
210300200529     C           NCD       IFLE PSDAT                                     054498
210400200529     C           NCD       ANDNE*ZERO                                     054498
210500200529     C           CSE023    ANDNE'Y'                                       CSE023
210600200529     C*                                                                   CSE023
210700200529     C           CSE023    OREQ 'Y'                                       CSE023
210800200529     C           CRTT      ANDEQ*BLANKS                                   CSE023
210900200529     C           NCD       ANDLEPSDAT                                     CSE023
211000200529     C           NCD       ANDNE*ZERO                                     CSE023
211100200529     C*                                                                   CSE023
211200200529     C           CSE023    OREQ 'Y'                                       CSE023
211300200529     C           CRTT      ANDNE*BLANKS                                   CSE023
211400200529     C           CALOCD    ANDLEPSDAT                                     CSE023
211500200529     C           CALOCD    ANDNE*ZERO                                     CSE023
211600200529     C*                                                                   E15549
211700200529     C*   .... WRITE SECURITY ACTION - COUPON (W01)                       E15549
211800200529     C*                                                                   E15549
211900200529     C/COPY WNCPYSRC,SE2100C016
212000200529     C                     EXSR OUTW01                                    E15549
212100200529     C/COPY WNCPYSRC,SE2100C017
212200200529      *                                                                   E15549
212300200529     C                     END                                            E15549
212400200529     C*                                                                   E15549
212500200529     C***IF*MATURITY DATE NOT AFTER ECD AND MATURITY DATE INDICATORS01176 054498
212600200529     C***NOT*EQUAL TO 'A', OUTPUT SECURITY ACTION - MATURITY       S01176 054498
212700200529     C***********                                                  S01176 054498
212800200529     C***********XMATY     IFLE ECD                                       054498
212900200529     C***********MDTI      ANDNE'A'                                S01176 054498
213000200529     C***********XMATY     ANDNE0                                         054498
213100200529     C*
213200200529     C*  IF MATURITY DATE BEFORE ECD, UPDATE SECURITY                     E15549
213300200529     C*     ONLY IF MATURITY DATE NOT ZEROES
213400200529     C*
213500200529     C*          MATY      IFLT DNWD
213600200529     C*          MATY      ANDNE0
213700200529     C***********XMATY     IFLT DNWD                                      E15549
213800200529     C*          XMATY     ANDNE0
213900200529     C***********XMATY     IFLT ECD                                E15549 054498
214000200529      ***********                                                  E20142 054498
214100200529      *****For*accrual run type '3', process Maturities up to AND  E20142 054498
214200200529      *****INCLUDING ECD (APDA), so that if Month-End is a Non-WorkE20142 054498
214300200529      *****day,*EOM balances can reflect all Maturities this month.E20142 054498
214400200529      ***********                                                  E20142 054498
214500200529     C***********XMATY     OREQ ECD                                E20142 054498
214600200529     C***********ACRLRN    ANDEQ'3'                                E20142 054498
214700200529     C*                                                                   054498
214800200529     C*  PROCESS MATURITIES                                               =54498
214900200529     C*                                                                   054498
215000200529     C           XMATY     IFLE PSDAT                                     054498
215100200529     C           XMATY     ANDNE*ZERO                                     054498
215200200529     C           MDTI      ANDNE'A'                                       054498
215300200529     C           CSE023    ANDNE'Y'                                       CSE023
215400200529     C*                                                                   CSE023
215500200529     C           CSE023    OREQ 'Y'                                       CSE023
215600200529     C           CRTT      ANDEQ*BLANKS                                   CSE023
215700200529     C***********XMATY     ANDEQPSDAT                              CSE023 187825
215800200529     C           XMATY     ANDLEPSDAT                                     187825
215900200529     C           XMATY     ANDNE*ZERO                                     CSE023
216000200529     C           MDTI      ANDNE'A'                                       CSE023
216100200529     C*                                                                   CSE023
216200200529     C           CSE023    OREQ 'Y'                                       CSE023
216300200529     C           CRTT      ANDNE*BLANKS                                   CSE023
216400200529     C           MALOCD    ANDLEPSDAT                                     CSE023
216500200529     C           MALOCD    ANDNE*ZERO                                     CSE023
216600200529     C           MDTI      ANDNE'A'                                       CSE023
216700200529     C*                                                                   054498
216800200529     C*  IF MATURITY DATE DUE, UPDATE RECORD ID ON SECURITY               054498
216900200529     C*                                                                   054498
217000200529     C           XMATY     IFLE AKDAT                                     054498
217100200529     C*                                                                   E20142
217200200529     C                     MOVEL'M'       URECI
217300200529     C                     MOVEA'1'       *IN,40
217400200529     C                     END
217500200529     C*
217600200529     C*  OUTPUT SECURITY ACTION - MATURITY                                054498
217700200529     C*                                                                   054498
217800200529     C/COPY WNCPYSRC,SE2100C018
217900200529     C                     EXSR OUTW02
218000200529     C/COPY WNCPYSRC,SE2100C019
218100200529     C*
218200200529     C                     END
218300200529      *                                                                                       CSE065
218400200529     C           CSE065    IFEQ 'Y'                                                           CSE065
218500200529     C           ALDT      ANDLEAKDAT                                                         CSE065
218600200529     C           ALDT      ANDGERUND                                                          CSE065
218700200529     C           ALDT      ANDNE*ZEROS                                                        CSE065
218800200529     C                     EXSR OUTW05                                                        CSE065
218900200529     C                     ENDIF                                                              CSE065
219000200529     C*
219100200529     C*  UPDATE SECURITY IF EVENTS PROCESSED FOR IT
219200200529     C*
219300200529     C***UPDATE*LAST*COUPON*DATE*(*IN41=1)*IF*COUPON*PROCESSED*****094576 143174
219400200529     C***AND*NEXT*COUPON*DATE*ID*LESS*THAN*DATE*OF*NEXT*WORKIND DAY094576 143174
219500200529     C***********SAAT      IFEQ 'CP'                               094576 143174
219600200529     C***********NCD       ANDLTDNWD                               094576 143174
219700200529     C***********          MOVE '1'       *IN41                    094576 143174
219800200529     C***********          END                                     094576 143174
219900200529     C***********                                                  094576 143174
220000200529     C           *IN,40    IFNE *ZERO
220100200529     C           *IN,41    ORNE *ZERO
220200200529     C           *IN,42    ORNE *ZERO
220300200529     C           *IN,43    ORNE *ZERO
220400200529     C           *IN,44    ORNE *ZERO
220500200529     C           *IN,45    ORNE *ZERO
220600200529     C           *IN,46    ORNE *ZERO
220700200529     C           *IN,48    ORNE *ZERO                                                         CSE065
220800200529     C           CSE065    ANDEQ'Y'                                                           CSE065
220900200529     C/COPY WNCPYSRC,SE2100C020
221000200529     C*                                                                   E15549
221100200529     C* UPDATE LAST COUPON/DIVIDEND PAYMENT DATE                          E15549
221200200529     C*                                                                   E15549
221300200529     C           *IN41     IFEQ '1'                                       E15549
221400200529     C           PROT      IFEQ '4'                                       E15549
221500200529     C***********          Z-ADDDIVNDT    ULCPN                    E15549 E23802
221600200529     C                     ELSE                                           E15549
221700200529     C                     Z-ADDNCD       ULCPN                           E15549
221800200529     C                     END                                            E15549
221900200529     C                     END                                            E15549
222000200529     C*
222100200529     C*  CHAIN TO UPDATE FILE
222200200529     C*
222300200529     C           KSECTY    CHAINSECTYDF              35
222400200529     C*
222500200529     C           CAS006    IFEQ 'Y'                                                           CAS006
222600200529     C           *IN42     ANDEQ*ON                                                           CAS006
222700200529     C                     Z-ADDUCPNN     CPNN                                                CAS006
222800200529     C                     Z-ADDUCCRK     CCRK                                                CAS006
222900200529     C                     Z-ADDUCLQP     CLQP                                                CAS006
223000200529     C                     ENDIF                                                              CAS006
223100200529      *                                                                                       CAS006
223200200529     C   40                MOVELURECI     RECI
223300200529     C   41                Z-ADDULCPN     LCPN
223400200529     C   42                Z-ADDUCPNR     CPNR
223500200529     C*                                                                   S96032
223600200529     C/COPY WNCPYSRC,SE2100CCP6                                           S96032
223700200529     C*                                                                   S96032
223800200529     C   43                Z-ADDUCFCT     CFCT
223900200529     C   44                Z-ADDUCPDP     CPDP
224000200529     C   44                Z-ADDUSLCA     SLCA
224100200529     C   45                Z-ADDUSEXR     SEXR
224200200529     C   46                Z-ADDUSCPD     SCPD
224300200529     C   46                Z-ADDUSCPP     SCPP
224400200529     C   46                MOVELUSCPI     SCPI
224500200529      *                                                                                       CSE065
224600200529     C           *IN48     IFEQ '1'                                                           CSE065
224700200529     C           CSE065    ANDEQ'Y'                                                           CSE065
224800200529     C                     MOVELUALDT     ALDT                                                CSE065
224900200529     C                     ENDIF                                                              CSE065
225000200529      *                                                                   CPB001
225100200529      **  If Replication Processing required.                             CPB001
225200200529     C           WUREPL    IFEQ 'Y'                        Begin WUREPL   CPB001
225300200529     C                     MOVE *BLANK    REPI                            CPB001
225400200529      *                                                                   CPB001
225500200529      **  If Security exists and Coupon generated (CP) or Maturity        CPB001
225600200529      **  reached (MA), set up Replication Indicator.                     CPB001
225700200529     C           SAAT      IFEQ 'CP'                       Begin SAAT     CPB001
225800200529     C           SAAT      OREQ 'MA'                                      CPB001
225900200529     C           SAAT      OREQ 'IR'                                                          206595
226000200529     C                     MOVE 'Y'       REPI                            CPB001
226100200529      *                                                                   CPB001
226200200529     C                     ENDIF                           End SAAT       CPB001
226300200529      *                                                                   CPB001
226400200529     C                     ENDIF                           End WUREPL     CPB001
226500200529     C*
226600200529     C  N35                UPDATSECTYDF
226700200529     C*
226800200529     C*  ADD TO CONTROL TOTAL
226900200529     C*
227000200529     C                     ADD  1         STOTU
227100200529     C/COPY WNCPYSRC,SE2100C003
227200200529     C*
227300200529     C                     END
227400200529     C*
227500200529     C                     ENDSR
227600200529      *
227700200529      *****************************************************************
227800200529      /EJECT
227900200529      *****************************************************************
228000200529      *                                                               *
228100200529      *  AUDIT  - Subroutine to check the Audit Files.                *
228200200529      *                                                               *
228300200529      *  Called By: Main Processing.                                  *
228400200529      *  Calls: None.                                                 *
228500200529      *                                                               *
228600200529      *****************************************************************
228700200529      *
228800200529     C           AUDIT     BEGSR                           **AUDIT BEGSR**
228900200529     C*
229000200529     C* CHECK SECTYA AUDIT RECORD
229100200529     C*
229200200529     C           1         CHAINSECTYAF              99
229300200529     C*
229400200529     C           *IN99     IFEQ '1'
229500200529     C           *LOCK     IN   LDA                                       S01117
229600200529     C                     MOVE '1'       *INU7
229700200529     C                     MOVE '1'       *INU8            ***************
229800200529     C***********          MOVEL'04'      DBASE            **DB ERROR 04**S01117
229900200529     C                     Z-ADD4         DBASE            **DB ERROR 04**S01117
230000200529     C                     MOVEL'SECTYA'  DBFILE           ***************
230100200529     C                     MOVEL'AUDIT'   DBKEY
230200200529     C                     OUT  LDA                                       S01117
230300200529     C                     EXSR *PSSR                                     S01117
230400200529     C                     ELSE
230500200529     C*
230600200529     C                     Z-ADDNORE      SNORE
230700200529     C*
230800200529     C* CHECK CONTROL TOTALS AGREE
230900200529     C*
231000200529     C           STOTI     IFNE NORE
231100200529     C                     MOVEA'1'       *IN,80
231200200529     C                     MOVE '1'       *INU8
231300200529     C*
231400200529     C                     END
231500200529     C*
231600200529     C                     END
231700200529     C*
231800200529     C* CHECK SEDEVA AUDIT RECORD
231900200529     C*
232000200529     C           1         CHAINSEDEVAF              99
232100200529     C*
232200200529     C           *IN99     IFEQ '1'
232300200529     C           *LOCK     IN   LDA                                       S01117
232400200529     C                     MOVE '1'       *INU7
232500200529     C                     MOVE '1'       *INU8            ***************
232600200529     C***********          MOVEL'05'      DBASE            **DB ERROR 05**S01117
232700200529     C                     Z-ADD5         DBASE            **DB ERROR 05**S01117
232800200529     C                     MOVEL'SEDEVA'  DBFILE           ***************
232900200529     C                     MOVEL'AUDIT'   DBKEY
233000200529     C                     OUT  LDA                                       S01117
233100200529     C                     EXSR *PSSR                                     S01117
233200200529     C                     ELSE
233300200529     C*
233400200529     C                     Z-ADDNORE      DNORE
233500200529     C           NORE      SUB  DTOTD     DTOTO   50
233600200529     C           DTOTO     ADD  DTOTA     DTOTO
233700200529     C*
233800200529     C           *INU8     IFNE '1'
233900200529     C                     Z-ADDDTOTO     NORE
234000200529     C                     Z-ADDDTOTO     NLRB
234100200529     C                     UPDATSEDEVAF
234200200529     C                     END
234300200529     C*
234400200529     C                     END
234500200529     C*
234600200529     C* UPDATE SNDEVA AUDIT RECORD
234700200529     C*
234800200529     C           OTOT1     ADD  OTOT2     NTOTA   50
234900200529     C                     ADD  OTOT4     NTOTA                           E15549
235000200529     C*
235100200529     C           1         CHAINSNDEVAF              99
235200200529     C*
235300200529     C           *IN99     IFEQ '1'
235400200529     C           *LOCK     IN   LDA                                       S01117
235500200529     C                     MOVE '1'       *INU7
235600200529     C                     MOVE '1'       *INU8            ***************
235700200529     C***********          MOVEL'06'      DBASE            **DB ERROR 06**S01117
235800200529     C                     Z-ADD6         DBASE            **DB ERROR 06**S01117
235900200529     C                     MOVEL'SNDEVA'  DBFILE           ***************
236000200529     C                     MOVEL'AUDIT'   DBKEY
236100200529     C                     OUT  LDA                                       S01117
236200200529     C                     EXSR *PSSR                                     S01117
236300200529     C                     ELSE
236400200529     C*
236500200529     C**********           Z-ADDNORE      NNORE                                               247420
236600200529     C********** NORE      ADD  NTOTA     NTOTO   50                                          247420
236700200529     C                     Z-ADDSNNORE    NNORE                                               247420
236800200529     C           SNNORE    ADD  NTOTA     NTOTO   70                                          247420
236900200529     C*
237000200529     C           *INU8     IFNE '1'
237100200529     C**********           Z-ADDNTOTO     NORE                                                247420
237200200529     C                     Z-ADDNTOTO     SNNORE                                              247420
237300200529     C                     UPDATSNDEVAF
237400200529     C                     END
237500200529     C*
237600200529     C                     END
237700200529     C*
237800200529     C* OUTPUT SECACA AUDIT RECORD
237900200529     C*
238000200529     C                     Z-ADDOTOT5     NORE                            E15549
238100200529     C*
238200200529     C           *INU8     IFNE '1'
238300200529     C                     WRITESECACAF
238400200529     C                     END
238500200529     C*
238600200529     C*                                                                   S96032
238700200529     C/COPY WNCPYSRC,SE2100CCP7                                           S96032
238800200529     C*                                                                   S96032
238900200529     C                     ENDSR
239000200529      *
239100200529      *****************************************************************
239200200529      /EJECT
239300200529      *****************************************************************
239400200529      *                                                               *
239500200529      *  PRINT  - Subroutine to Output the Control Totals Report.     *
239600200529      *                                                               *
239700200529      *  Called By: Main Processing.                                  *
239800200529      *  Calls: None.                                                 *
239900200529      *                                                               *
240000200529      *****************************************************************
240100200529      *
240200200529     C           PRINT     BEGSR                           **PRINT BEGSR**
240300200529     C*
240400200529     C                     WRITEHEADAU
240500200529     C*
240600200529     C           *INU7     IFEQ '0'
240700200529     C                     WRITETOTALS
240800200529     C                     ELSE
240900200529     C                     WRITEERROR
241000200529     C                     END
241100200529     C***********                                                         E29170
241200200529     C***********          WRITETRAILAU                                   E29170
241300200529     C*
241400200529     C                     ENDSR
241500200529      *
241600200529      *****************************************************************
241700200529      /EJECT
241800200529      *****************************************************************
241900200529      *                                                               *
242000200529      *  GETSEC - Subroutine to get next Security Record.             *
242100200529      *                                                               *
242200200529      *  Called By: Main Processing.                                  *
242300200529      *  Calls: None.                                                 *
242400200529      *                                                               *
242500200529      *****************************************************************
242600200529      *
242700200529     C           GETSEC    BEGSR                           **GETSEC  BEGSR**
242800200529     C*
242900200529      **  ALWAYS READ 1, KEEP READING AND ADDING TO COUNTS IF NOT
243000200529      **  ACTIVE.
243100200529      *
243200200529     C           RECI      DOUEQ'D'
243300200529      *                                                                   E21588
243400200529      ***  Cancelled Securities should not be processed.                  E21588
243500200529      *                                                                   E21588
243600200529     C***********RECI      OREQ 'C'                                S01158 E21588
243700200529     C           *IN20     OREQ '1'
243800200529      *
243900200529     C                     READ SECTYX                   20
244000200529     C*                                                                   S96032
244100200529     C/COPY WNCPYSRC,SE2100CCP8                                           S96032
244200200529     C*                                                                   S96032
244300200529     C*
244400200529     C* IF NOT END OF FILE, ADD TO COUNT OF SECURITIES INPUT
244500200529     C*
244600200529     C           *IN,20    IFEQ '0'
244700200529     C           RECI      ANDNE'*'
244800200529     C*
244900200529     C           RECI      IFNE 'C'                                       S01158
245000200529     C                     ADD  1         STOTI
245100200529     C                     END                                            S01158
245200200529     C*
245300200529     C           RECI      IFEQ 'D'
245400200529     C                     ADD  1         STOTL
245500200529     C                     END
245600200529     C*
245700200529     C           RECI      IFEQ 'C'
245800200529     C                     ADD  1         STOTC
245900200529     C                     END
246000200529     C*
246100200529     C           RECI      IFEQ 'M'
246200200529     C                     ADD  1         STOTM
246300200529     C                     END
246400200529     C                     END
246500200529     C*
246600200529     C                     END
246700200529     C*
246800200529     C*  IF EOF, ENSURE UNMATCHED DIARY EVENTS DETECTED
246900200529     C*
247000200529     C           *IN,20    IFEQ '1'
247100200529     C                     MOVEL*HIVAL    SESN
247200200529     C                     END
247300200529     C*
247400200529     C* DB ERROR IF DIARY SHORTNAME BEFORE SECURITY SHORTNAME (IE NO MATCH)
247500200529     C*
247600200529     C           XSDSN     IFLT SESN
247700200529     C*
247800200529     C           *LOCK     IN   LDA                                       S01117
247900200529     C                     MOVE '1'       *INU7
248000200529     C                     MOVE '1'       *INU8            ***************
248100200529     C***********          MOVEL'03'      DBASE            **DB ERROR 03**S01117
248200200529     C                     Z-ADD3         DBASE            **DB ERROR 03**S01117
248300200529     C                     MOVEL'SEDEL'   DBFILE           ***************
248400200529     C***********          MOVELSDSN      DBKEY                           041031
248500200529     C                     MOVELXSDSN     DBKEY                           041031
248600200529     C                     OUT  LDA                                       S01117
248700200529     C                     EXSR *PSSR                                     S01117
248800200529     C*
248900200529     C                     END
249000200529     C*
249100200529     C*  READ INVTP RECORD FOR THIS SECURITY
249200200529     C*
249300200529     C           *IN20     IFNE '1'
249400200529     C           *INU7     ANDNE'1'
249500200529     C           *INU8     ANDNE'1'
249600200529     C*
249700200529     C           KINVTP    CHAININVTP                36
249800200529     C*
249900200529     C           *IN36     IFEQ '1'
250000200529     C*
250100200529     C           *LOCK     IN   LDA                                       S01117
250200200529     C                     MOVE '1'       *INU7
250300200529     C                     MOVE '1'       *INU8            ***************
250400200529     C***********          MOVEL'13'      DBASE            **DB ERROR 13**S01117
250500200529     C                     Z-ADD13        DBASE            **DB ERROR 13**S01117
250600200529     C                     MOVEL'INVTP'   DBFILE           ***************
250700200529     C                     MOVELINVTPK    DBKEY
250800200529     C                     OUT  LDA                                       S01117
250900200529     C                     EXSR *PSSR                                     S01117
251000200529     C*
251100200529     C                     END
251200200529     C                     END
251300200529     C*
251400200529     C                     ENDSR
251500200529      *
251600200529      *****************************************************************
251700200529      /EJECT
251800200529      *****************************************************************
251900200529      *                                                               *
252000200529      *  GETDEL - Subroutine to get next Security Diary record.       *
252100200529      *                                                               *
252200200529      *  Called By: Main Processing.                                  *
252300200529      *  Calls: None.                                                 *
252400200529      *                                                               *
252500200529      *****************************************************************
252600200529      *
252700200529     C           GETDEL    BEGSR                           **GETDEL BEGSR**
252800200529     C/COPY WNCPYSRC,SE2100C001
252900200529     C*
253000200529     C                     READ SEDELX                   25
253100200529     C*
253200200529     C* IF NOT END OF FILE,
253300200529     C* ADD TO COUNT OF DIARY EVENTS INPUT & STORE RECI
253400200529     C*
253500200529     C           *IN,25    IFEQ '0'
253600200529     C*
253700200529     C           DTOTI     ADD  1         DTOTI
253800200529     C/COPY WNCPYSRC,SE2100C002
253900200529     C                     MOVELXRECI     SRECI                           S01158
254000200529     C*
254100200529     C*  DETERMINE WHETHER SECURITY IS TO BE UPDATED
254200200529     C*
254300200529     C           KSEC2     CHAINSECET                37
254400200529     C*                                                                   E15549
254500200529     C***  Future cancellations can be ignored but not Actioned Events    E23049
254600200529     C*                                                                   E23049
254700200529     C***********CRECI     DOUEQ'C'                                E15549 E23049
254800200529     C           CRECI     DOUEQ'M'                                       E23049
254900200529     C           CRECI     OREQ 'D'                                       E15549
255000200529      *                                                                   E20554
255100200529      ***  Check of *IN37 is on, to prevent program loop                  E20554
255200200529      *                                                                   E20554
255300200529     C           *IN37     OREQ '1'                                       E20554
255400200529     C           KSECET    READESECET                    37
255500200529     C                     END                                            E15549
255600200529     C*                                                                   E15549
255700200529     C* NOT THE MOST RECENT - SO DONT UPDATE                              E15549
255800200529     C*** And Not a future Event                                          E23049
255900200529     C*
256000200529     C           *IN37     IFEQ '0'
256100200529     C***********CDED      ANDLEECD                                E23049 054498
256200200529     C***********CDED      ANDLEPSDAT                              054498 175977
256300200529     C           CDED      ANDLTPSDAT                                     175977
256400200529     C                     MOVE 'N'       UPDSEC  1
256500200529     C                     ELSE
256600200529     C*                                                                   E15549
256700200529     C* THE MOST RECENT AND LIVE , SO UPDATE (WITH DETAILS FROM SEDEVDX)  E15549
256800200529     C*                                                                   E15549
256900200529     C***********CRECI     IFEQ 'D'                                       E23049
257000200529     C           XRECI     IFEQ 'D'                                       E23049
257100200529     C                     MOVE 'Y'       UPDSEC
257200200529     C                     ELSE
257300200529     C*                                                                   E15549
257400200529     C* MOST RECENT BUT NOT LIVE,SO GET THE NEXT MOST RECENT              E15549
257500200529     C* (TO UPDATE WITH DETAILS FROM SEDEVDC IF FOUND,                    E15549
257600200529     C*                                  ELSE ZEROIZE/BLANK)              E15549
257700200529     C*
257800200529     C*** If Cancellation followed by a Matured Record                    E23049
257900200529     C*** Use the Next Matured record in preference to the previous       E23049
258000200529     C*                                                                   E23049
258100200529     C           *IN37     IFEQ '0'                                       E23049
258200200529     C           CRECI     ANDEQ'M'                                       E23049
258300200529     C                     MOVE 'C'       UPDSEC                          E23049
258400200529     C                     ELSE                                           E23049
258500200529     C                     MOVE 'Z'       UPDSEC                          E15549
258600200529     C           KSEC2     CHAINSECET                37
258700200529     C                     READPSECET                    37
258800200529     C*
258900200529     C           *IN37     DOWNE'1'
259000200529     C           CDSN      ANDEQXSDSN
259100200529     C           CDET      ANDEQXSDET
259200200529     C*
259300200529     C           CRECI     IFEQ '*'
259400200529     C           CRECI     OREQ 'C'                                       S01158
259500200529     C*** Restore from previosly Actioned record if it exists             E23049
259600200529     C***********CRECI     OREQ 'M'                                E15549 E23049
259700200529     C                     READPSECET                    37
259800200529     C                     ELSE
259900200529     C                     MOVE 'C'       UPDSEC
260000200529     C                     MOVE '1'       *IN37
260100200529     C                     END
260200200529     C*
260300200529     C                     END
260400200529     C*                                                                   E23049
260500200529     C                     END                                            E23049
260600200529     C*
260700200529     C                     END
260800200529     C                     END
260900200529     C*
261000200529     C                     ELSE
261100200529     C                     MOVEL*HIVAL    XSDSN
261200200529     C                     END
261300200529     C*
261400200529     C                     ENDSR
261500200529      *
261600200529      *****************************************************************
261700200529      /EJECT
261800200529      *****************************************************************
261900200529      *                                                               *
262000200529      *  OUTW01 - Subroutine to Output Coupon Action to PF/SECACD.    *
262100200529      *                                                               *
262200200529      *  Called By: PROCES                                            *
262300200529      *  Calls: OUTSND                                                *
262400200529      *                                                               *
262500200529      *****************************************************************
262600200529      *
262700200529     C           OUTW01    BEGSR                           **OUTW01 BEGSR**
262800200529     C*                                                                   066262
262900200529     C** Check to ensure 'CP' action has not already been generated.      066262
263000200529     C*                                                                   066262
263100200529     C                     MOVEL'CP'      SNET                            066262
263200200529     C                     MOVELSESN      SNSN                            066262
263300200529     C                     Z-ADDNCD       SNDT                            066262
263400200529     C           SETGKY    CHAINSNDEVDO              99                   066262
263500200529     C           *IN99     IFEQ '1'                                       066262
263600200529     C*
263700200529     C* NB - USES UPDATED SECURITY FIELDS -THESE CONTAIN ORIGINAL VALUES
263800200529     C*          UNTIL CHANGES PROCESSED
263900200529     C*
264000200529     C                     MOVEL'D'       RECI
264100200529     C                     MOVELSESN      SASN
264200200529     C                     MOVEL'CP'      SAAT                            E15549
264300200529     C                     MOVEL'30'      SAAS
264400200529     C                     Z-ADDNCD       SAED
264500200529     C                     Z-ADD*ZERO     SAOD
264600200529     C*                                                                   S96032
264700200529     C/COPY WNCPYSRC,SE2100CCP9                                           S96032
264800200529     C*                                                                   S96032
264900200529      *                                                                                       CSE075
265000200529      ** If Enhanced Treasury is switched on:                                                 CSE075
265100200529      *                                                                                       CSE075
265200200529     C           CSE075    IFEQ 'Y'                                                           CSE075
265300200529      *                                                                                       CSE075
265400200529      ** If a delay period has been specified, calculate the payment date.                    CSE075
265500200529      *                                                                                       CSE075
265600200529     C********** PROT      IFEQ '8'                                                    CSE075 CSE075
265700200529     C           STBS      IFEQ 'P'                                                           CSE075
265800200529     C           PROT      ANDNE'2'                                                           CSE075
265900200529     C           PROT      ANDNE'4'                                                           CSE075
266000200529     C           PROT      ANDNE'7'                                                           CSE075
266100200529     C           PPDI      ANDNE'Y'                                                           CSE075
266200200529     C           CPDY      ANDNE0                                                             CSE075
266300200529     C           STBS      OREQ 'Y'                                                           CSE075
266400200529     C           PROT      ANDNE'2'                                                           CSE075
266500200529     C           PROT      ANDNE'4'                                                           CSE075
266600200529     C           PROT      ANDNE'7'                                                           CSE075
266700200529     C           PROT      ANDNE'9'                                                           CSE075
266800200529     C           PPDI      ANDNE'Y'                                                           CSE075
266900200529     C           CPDY      ANDNE0                                                             CSE075
267000200529     C           SAED      ADD  CPDY      SAOD                                                CSE075
267100200529     C                     ENDIF                                                              CSE075
267200200529      *                                                                                       CSE075
267300200529     C                     ENDIF                                                              CSE075
267400200529      *                                                                                       CSE075
267500200529     C***********          Z-ADD*ZERO     SDAU                            E16772
267600200529     C                     Z-ADD*ZERO     SDUN                            E16772
267700200529     C                     Z-ADD*ZERO     SDCA
267800200529     C***********          Z-ADD0         STCA                            E23049
267900200529     C                     Z-ADDUCPDP     STCA                            E23049
268000200529     C*
268100200529     C                     Z-ADDUCFCT     SACF
268200200529     C                     Z-ADDUCPNR     SDCR
268300200529      *                                                                                       CAS006
268400200529     C           CAS006    IFEQ 'Y'                                                           CAS006
268500200529     C                     Z-ADDUCPNN     WCPNN                                               CAS006
268600200529     C                     ENDIF                                                              CAS006
268700200529     C*
268800200529     C                     MOVELNAR,1     SDNR
268900200529     C                     Z-ADDRUND      SAAC
269000200529     C*                                                                   E15549
269100200529     C* SET A/C KEYS REQ'D/POSN SETTLE REQ'D IND                          E15549
269200200529     C*                                                                   E15549
269300200529     C***********NCD       IFLT ECD                                E15549 054498
269400200529     C***********                                                  E20142 054498
269500200529     C***For*accrual run type '3', generate entries up to AND INCLUE20142 054498
269600200529     C***ECD*(APDA), so that if month end is a non-working day, EOME20142 054498
269700200529     C***balances can reflect all coupons due this month.          E20142 054498
269800200529     C***********                                                  E20142 054498
269900200529     C***********NCD       OREQ ECD                                E20142 054498
270000200529     C***********ACRLRN    ANDEQ'3'                                E20142 054498
270100200529     C*                                                                   054498
270200200529     C* IF COUPON DATE DUE                                                054498
270300200529     C*                                                                   054498
270400200529     C           NCD       IFLE AKDAT                                     054498
270500200529     C*                                                                   E20142
270600200529     C                     MOVEA'1'       *IN,41                          E15549
270700200529     C                     MOVEL'Y'       AKRI                            E15549
270800200529     C*                                                                   E15549
270900200529     C* CHECK WHETHER POSITION SETTLEMENTS PREVIOUSLY GENERATED           E15549
271000200529     C*                                                                   E15549
271100200529     C                     MOVELSESN      SNSN                            E15549
271200200529     C                     MOVEL'CG'      SNET                            E15549
271300200529     C                     Z-ADDNCD       SNDT                            E15549
271400200529     C***********SETGKY    CHAINSNDEVDX              99            E15549 E20085
271500200529     C           SETGKY    CHAINSNDEVDO              99                   E20085
271600200529     C           *IN,99    IFEQ '0'                                       E15549
271700200529     C                     MOVEL*BLANK    PSRI                            E15549
271800200529     C                     MOVEL'*'       RECI                            E15549
271900200529     C***********          UPDATSNDEVDX                            E15549 E20085
272000200529     C                     UPDATSNDEVDO                                   E20085
272100200529     C                     SUB  1         OTOT4                           E15549
272200200529     C                     ELSE                                           E15549
272300200529     C                     MOVEL'Y'       PSRI                            E15549
272400200529     C                     END                                            E15549
272500200529     C*                                                                   E15549
272600200529     C                     ELSE                                           E15549
272700200529     C                     MOVEL*BLANK    AKRI                            E15549
272800200529     C                     MOVEL*BLANK    PSRI                            E15549
272900200529     C*                                                                   E15549
273000200529     C* WRITE POSITION SETTLEMENT GENERATED RECORD TO PF/SNDEVD           E15549
273100200529     C*                                                                   E15549
273200200529     C                     MOVELSESN      SNSN                            E15549
273300200529     C                     MOVEL'CG'      SNET                            E15549
273400200529     C                     Z-ADDNCD       SNDT                            E15549
273500200529     C***********SETGKY    CHAINSNDEVDX              99            E15549 E20085
273600200529     C           SETGKY    CHAINSNDEVDO              99                   E20085
273700200529     C           *IN,99    IFEQ '1'                                       E15549
273800200529     C                     MOVEL'CG'      SAAT                            E15549
273900200529     C**********           Z-ADDLCPN      LCCP                                         197357 211228
274000200529     C                     EXSR OUTSND                                    E15549
274100200529     C                     ADD  1         OTOT4                           E15549
274200200529     C                     MOVEL'Y'       PSRI                            E15549
274300200529     C                     END                                            E15549
274400200529     C                     END                                            E15549
274500200529     C***********                                                  E15549 E21307
274600200529     C***NO*POSITION*SETTLEMENT*ON*COUPON*IF*MATURITY*ALSO*DUE**** E15549 E21307
274700200529      ***  The Coupon is now separate from the Maturity, so it does       E21307
274800200529      ***  require a Position Settlement.                                 E21307
274900200529     C***********                                                  E15549 E21307
275000200529     C***********NCD       IFEQ XMATY                              E15549 E21307
275100200529     C***********          MOVEL*BLANK    PSRI                     E15549 E21307
275200200529     C***********          END                                     E15549 E21307
275300200529     C*                                                                   E15549
275400200529     C**********           MOVEL'D'       RECI                     E15549 197357
275500200529     C                     MOVEL'D'       RECI                                                211228
275600200529     C                     MOVEL'CP'      SAAT                            E15549
275700200529     C*
275800200529     C           PPDI      IFEQ 'P'
275900200529     C           UCPDP     ANDEQSFPP
276000200529     C*
276100200529     C*** If Partly Paid, Check PP Amount with Fully Paid Price           E23049
276200200529     C**IF*PRICE*BASIS*P,*CHECK*AMOUNT*WITH*FULLY*PAID*PRICE******        E23049
276300200529     C************************************************************        E23049
276400200529     C*
276500200529     C                     Z-ADD100       STCA
276600200529     C                     ELSE
276700200529     C                     MOVE UCPDP     STCA
276800200529     C                     END
276900200529     C*
277000200529     C                     Z-ADD*ZERO     PCFA
277100200529     C                     MOVEL*BLANK    RTMI
277200200529     C                     Z-ADD*ZERO     RTAI
277300200529     C*                                                                   E15549
277400200529     C* SET LAST COUPON DATE OF CURRENT COUPON PERIOD                     E15549
277500200529     C* (WRITTEN TO BOTH SECACD AND SNDEVD)                               E15549
277600200529     C*                                                                   E15549
277700200529     C* For processing types other than 4 (shares),                       W20085
277800200529     C* Use SR/ZLCD to calculate LCCP, else use ULCPN from SECTYD         E20085
277900200529     C*                                                                   E20085
278000200529     C           PROT      IFNE '4'                                       E20085
278100200529     C***********SAED      SUB  1         ZECD                     E20085 180707
278200200529     C           BCNV      IFNE ' '                                       182505
278300200529     C           BCNV      ANDNE'N'                                       CSE031
278400200529     C                     Z-ADDZZNCD     ZDAYNO                          182505
278500200529     C                     MOVE NMCY      ZCCY                            182505
278600200529     C                     MOVE *BLANKS   ZLOC                            182505
278700200529     C                     Z-ADD1         ZNRDYS                          182505
278800200529     C                     EXSR ZBKDT                                     182505
278900200529     C                     Z-ADDZDYNBR    ZECD                            182505
279000200529     C                     ELSE                                           182505
279100200529     C           ZZNCD     SUB  1         ZECD                            180707
279200200529     C                     ENDIF                                          182505
279300200529     C                     EXSR ZLCD                                      E20085
279400200529     C                     Z-ADDZZLCD     LCCP                            E20085
279500200529     C                     ELSE                                           E20085
279600200529     C                     Z-ADDULCPN     LCCP                            E15549
279700200529     C                     END                                            E20085
279800200529     C                     Z-ADD*ZERO     SAEXD                           S01510
279900200529     C**********           Z-ADDLCCP      WLCCP                                        197357 211228
280000200529      **********                                                                       197357 211228
280100200529      ***Check*if*previous*settlement*generated*to*ensure*that*********                197357 211228
280200200529      ***the*correct*LCCP*is*passed*in*case*coupon*date*was************                197357 211228
280300200529      ***amended*after*settlements*had*already*been*generated**********                197357 211228
280400200529      ***for*original*date.********************************************                197357 211228
280500200529      **********                                                                       197357 211228
280600200529     C**********           MOVE 'CP'      SNET                                         197357 211228
280700200529     C**********           MOVE *HIVAL    SNDT                                         197357 211228
280800200529     C********** KESNCP    SETLLSNDEVDO                                                197357 211228
280900200529     C**********           READ SNDEVDO                  60                            197357 211228
281000200529     C********** *IN60     IFEQ '0'                                                    197357 211228
281100200529     C********** SNSN      ANDEQSESN                                                   197357 211228
281200200529     C********** SNET      ANDEQ'CP'                                                   197357 211228
281300200529     C**********           Z-ADDSNDT      LCCP                                         197357 211228
281400200529     C**********           ELSE                                                        197357 211228
281500200529     C**********           Z-ADDWLCCP     LCCP                                         197357 211228
281600200529     C**********           ENDIF                                                       197357 211228
281700200529      **********                                                                       197357 211228
281800200529     C**********           MOVEL'D'       RECI                                         197357 211228
281900200529     C*
282000200529     C                     WRITESECACDF
282100200529     C                     ADD  1         OTOT5                           E15549
282200200529     C*
282300200529     C*  OUTPUT NON-DIARY EVENT RECORD TO SNDEVD
282400200529     C*
282500200529     C           *IN41     IFEQ '1'                                       E15549
282600200529     C                     EXSR OUTSND
282700200529     C*
282800200529     C                     ADD  1         OTOT1
282900200529     C                     END                                            E15549
283000200529     C*
283100200529     C                     END                                            066262
283200200529     C*
283300200529     C                     ENDSR
283400200529      *
283500200529      *****************************************************************
283600200529      /EJECT
283700200529      *****************************************************************
283800200529      *                                                               *
283900200529      *  OUTW02 - Subroutine to Output Maturity Action to PF/SECACD   *
284000200529      *                                                               *
284100200529      *  Called By: PROCES                                            *
284200200529      *  Calls: OUTSND                                                *
284300200529      *                                                               *
284400200529      *****************************************************************
284500200529      *
284600200529     C           OUTW02    BEGSR                           **OUTW02 BEGSR**
284700200529     C*
284800200529     C                     MOVEL'D'       RECI
284900200529     C                     MOVELSESN      SASN
285000200529     C                     MOVEL'MA'      SAAT
285100200529     C                     MOVEL'70'      SAAS
285200200529     C                     Z-ADDXMATY     SAED                            E15549
285300200529     C                     Z-ADD*ZERO     SAOD
285400200529     C***********          Z-ADD*ZERO     SDAU                            E16772
285500200529     C                     Z-ADD*ZERO     SDUN                            E16772
285600200529     C                     Z-ADD*ZERO     SDCA
285700200529     C***********          Z-ADD0         STCA                            E23049
285800200529     C                     Z-ADDUCPDP     STCA                            E23049
285900200529     C*
286000200529     C                     Z-ADDUCFCT     SACF
286100200529     C                     Z-ADDUCPNR     SDCR
286200200529      *                                                                                       CAS006
286300200529     C           CAS006    IFEQ 'Y'                                                           CAS006
286400200529     C                     Z-ADDUCPNN     WCPNN                                               CAS006
286500200529     C                     ENDIF                                                              CAS006
286600200529     C*
286700200529     C                     MOVELNAR,2     SDNR
286800200529     C                     Z-ADDRUND      SAAC
286900200529     C*                                                                   E15549
287000200529     C* SET A/C KEYS REQ'D/POSN SETTLE REQ'D IND                          E15549
287100200529     C*                                                                   E15549
287200200529     C***********XMATY     IFLT ECD                                E15549 054498
287300200529      ***********                                                  E20142 054498
287400200529      *****For*accrual run type '3', generate entries up to AND    E20142 054498
287500200529      *****INCLUDING ECD (APDA), so that if Month-End is a Non-WorkE20142 054498
287600200529      *****day,*EOM balances can reflect all Maturities this month.E20142 054498
287700200529      ***********                                                  E20142 054498
287800200529     C***********XMATY     OREQ ECD                                E20142 054498
287900200529     C***********ACRLRN    ANDEQ'3'                                E20142 054498
288000200529     C*                                                                   054498
288100200529     C* IF MATURITY DATE DUE                                              054498
288200200529     C*                                                                   054498
288300200529     C           XMATY     IFLE AKDAT                                     054498
288400200529     C*                                                                   E20142
288500200529     C                     MOVEL'Y'       AKRI                            E15549
288600200529     C*                                                                   E15549
288700200529     C* CHECK WHETHER POSITION SETTLEMENTS PREVIOUSLY GENERATED           E15549
288800200529     C*                                                                   E15549
288900200529     C                     MOVELSESN      SNSN                            E15549
289000200529     C                     MOVEL'MG'      SNET                            E15549
289100200529     C                     Z-ADDXMATY     SNDT                            E15549
289200200529     C***********SETGKY    CHAINSNDEVDX              99            E15549 E20085
289300200529     C           SETGKY    CHAINSNDEVDO              99                   E20085
289400200529     C           *IN,99    IFEQ '0'                                       E15549
289500200529     C                     MOVEL*BLANK    PSRI                            E15549
289600200529     C                     MOVEL'*'       RECI                            E15549
289700200529     C***********          UPDATSNDEVDX                            E15549 E20085
289800200529     C                     UPDATSNDEVDO                                   E20085
289900200529     C                     SUB  1         OTOT4                           E15549
290000200529     C                     ELSE                                           E15549
290100200529     C                     MOVEL'Y'       PSRI                            E15549
290200200529     C                     END                                            E15549
290300200529     C*                                                                   E15549
290400200529     C                     ELSE                                           E15549
290500200529     C                     MOVEL*BLANK    AKRI                            E15549
290600200529     C                     MOVEL*BLANK    PSRI                            E15549
290700200529     C*                                                                   E15549
290800200529     C* WRITE POSITION SETTLEMENT GENERATED RECORD TO PF/SNDEVD           E15549
290900200529     C*                                                                   E15549
291000200529     C                     MOVELSESN      SNSN                            E15549
291100200529     C                     MOVEL'MG'      SNET                            E15549
291200200529     C                     Z-ADDXMATY     SNDT                            E15549
291300200529     C***********SETGKY    CHAINSNDEVDX              99            E15549 E20085
291400200529     C           SETGKY    CHAINSNDEVDO              99                   E20085
291500200529     C           *IN,99    IFEQ '1'                                       E15549
291600200529     C                     MOVEL'MG'      SAAT                            E15549
291700200529     C                     EXSR OUTSND                                    E15549
291800200529     C                     ADD  1         OTOT4                           E15549
291900200529     C                     MOVEL'Y'       PSRI                            E15549
292000200529     C                     END                                            E15549
292100200529     C                     END                                            E15549
292200200529     C*                                                                   E15549
292300200529     C                     MOVEL'D'       RECI                            E15549
292400200529     C                     MOVEL'MA'      SAAT                            E15549
292500200529     C*
292600200529     C                     MOVE UCPDP     STCA
292700200529     C*
292800200529     C                     Z-ADD*ZERO     PCFA
292900200529     C                     MOVEL*BLANK    RTMI
293000200529     C                     Z-ADD*ZERO     RTAI
293100200529     C*                                                                   E15549
293200200529     C* SET LAST COUPON DATE OF CURRENT COUPON PERIOD                     E15549
293300200529     C* (WRITTEN TO BOTH SECACD AND SNDEVD)                               E15549
293400200529     C*                                                                   E15549
293500200529     C                     Z-ADDULCPN     LCCP                            E15549
293600200529     C                     Z-ADD*ZERO     SAEXD                           S01510
293700200529     C*
293800200529     C                     WRITESECACDF
293900200529     C                     ADD  1         OTOT5                           E15549
294000200529     C*
294100200529     C*  OUTPUT NON-DIARY EVENT RECORD TO SNDEVD
294200200529     C*
294300200529     C***********XMATY     IFLT ECD                                E15549 054498
294400200529     C***********                                                  E20142 054498
294500200529     C***********XMATY     OREQ ECD                                E20142 054498
294600200529     C***********ACRLRN    ANDEQ'3'                                E20142 054498
294700200529     C*                                                                   E20142
294800200529     C           XMATY     IFLE AKDAT                                     054498
294900200529     C                     EXSR OUTSND
295000200529     C*
295100200529     C                     ADD  1         OTOT2
295200200529     C                     END                                            E15549
295300200529     C*
295400200529     C                     ENDSR
295500200529      *
295600200529      *****************************************************************
295700200529      /EJECT
295800200529      *****************************************************************
295900200529      *                                                               *
296000200529      *  OUTW03 - Subroutine to Output Diary Action to PF/SECACD      *
296100200529      *                                                               *
296200200529      *  Called By: PROCES                                            *
296300200529      *  Calls: None.                                                 *
296400200529      *                                                               *
296500200529      *****************************************************************
296600200529      *
296700200529     C           OUTW03    BEGSR                           **OUTW03 BEGSR**
296800200529      *
296900200529     C                     Z-ADD0         SDCA
297000200529     C                     Z-ADD0         STCA
297100200529     C*
297200200529     C           XRECI     IFEQ 'C'                                       S01158
297300200529     C           XRECI     OREQ 'R'                                       S01158
297400200529     C                     MOVEL'R'       RECI
297500200529     C                     ELSE
297600200529     C                     MOVEL'D'       RECI
297700200529     C                     END
297800200529     C*
297900200529     C                     MOVELXSDSN     SASN
298000200529     C                     MOVELXSDET     SAAT
298100200529     C*
298200200529     C           XSDET     IFEQ 'MP'
298300200529     C                     MOVEL'20'      SAAS
298400200529     C                     END
298500200529     C*
298600200529     C           XSDET     IFEQ 'DV'
298700200529     C                     MOVEL'35'      SAAS
298800200529     C                     END
298900200529     C*
299000200529     C           XSDET     IFEQ 'PP'
299100200529     C                     MOVEL'05'      SAAS
299200200529     C                     END
299300200529     C*
299400200529     C           XSDET     IFEQ 'IR'
299500200529     C                     MOVEL'50'      SAAS
299600200529     C                     END
299700200529     C*
299800200529     C                     Z-ADDXSDED     SAED
299900200529     C*
300000200529     C* COMPLETE OTHER DATE - MP,DV ONLY
300100200529     C*
300200200529     C           XSDET     IFEQ 'MP'
300300200529     C           XSDET     OREQ 'DV'
300400200529     C                     Z-ADDXSDPD     SAOD
300500200529     C                     ELSE
300600200529     C                     Z-ADD*ZERO     SAOD
300700200529     C                     END
300800200529     C*
300900200529     C* COMPLETE AMOUNT PER UNIT - DV ONLY
301000200529     C*
301100200529     C           XSDET     IFEQ 'DV'
301200200529     C***********          Z-ADDXSDDV     SDAU                            E16772
301300200529     C                     Z-ADDXSDVA     SDUN                            E16772
301400200529     C                     ELSE
301500200529     C***********          Z-ADD*ZERO     SDAU                            E16772
301600200529     C                     Z-ADD*ZERO     SDUN                            E16772
301700200529     C                     END
301800200529     C*
301900200529     C* COMPLETE CALL AMOUNT/% - PP ONLY
302000200529     C*
302100200529     C           XSDET     IFEQ 'PP'
302200200529     C*
302300200529     C* SDCA AND STCA IN THE SECURITY ACTION FILE SHOULD BE UPDATED       E15930
302400200529     C* WITH THE CALL AMTS FROM THE DIARY RATHER THAN THE TOTAL AMTS      E15930
302500200529     C* FROM IN THE DIARY.                                                E15930
302600200529     C***********XSDTA     IFEQ *ZERO                                     E15930
302700200529     C***********          MOVE XSDTP     SDCA                            E15930
302800200529     C           XSDPP     IFEQ *ZERO                                     E15930
302900200529     C                     MOVE XSDPC     SDCA                            E15930
303000200529     C                     ELSE
303100200529     C***********          MOVE XSDTA     SDCA                            E15930
303200200529     C                     MOVE XSDPP     SDCA                            E15930
303300200529     C                     END
303400200529     C*
303500200529     C                     ELSE
303600200529     C                     Z-ADD*ZERO     SDCA
303700200529     C                     END
303800200529     C*
303900200529     C* COMPLETE TOTAL CALLED AMOUNT/%
304000200529     C*
304100200529     C           PPDI      IFEQ 'Y'
304200200529     C*
304300200529     C           XSDET     IFEQ 'PP'
304400200529     C*
304500200529     C***********XSDTA     IFEQ *ZERO                                     E15930
304600200529     C***********          MOVE XSDTP     STCA                            E15930
304700200529     C           XSDPP     IFEQ *ZERO                                     E15930
304800200529     C                     MOVE XSDPC     STCA                            E15930
304900200529     C                     MOVE XSDTP     STCA                            E23049
305000200529     C                     ELSE
305100200529     C***********          MOVE XSDTA     STCA                            E15930
305200200529     C***********          MOVE XSDPP     STCA                     E15930 E23049
305300200529     C                     MOVE XSDTA     STCA                            E23049
305400200529     C                     END
305500200529     C*
305600200529     C                     ELSE
305700200529     C*
305800200529     C           XSDET     IFEQ 'IR'
305900200529     C           XSDET     OREQ 'MP'
306000200529     C*
306100200529     C                     MOVE UCPDP     STCA
306200200529     C*
306300200529     C                     ELSE
306400200529     C                     Z-ADD*ZERO     STCA
306500200529     C                     END
306600200529     C                     END
306700200529     C*
306800200529     C                     ELSE
306900200529     C                     Z-ADD*ZERO     STCA
307000200529     C*
307100200529     C                     END
307200200529     C*
307300200529     C* COMPLETE CURRENT FACTOR (NEW/CURRENT) - MP,IR,PP ONLY
307400200529     C*
307500200529     C           XSDET     IFEQ 'MP'
307600200529     C                     Z-ADDXSDCP     SACF
307700200529     C                     ELSE
307800200529     C           XSDET     IFEQ 'IR'
307900200529     C           XSDET     OREQ 'PP'
308000200529     C                     Z-ADDUCFCT     SACF
308100200529     C                     ELSE
308200200529     C                     Z-ADD*ZERO     SACF
308300200529     C                     END
308400200529     C                     END
308500200529     C*
308600200529     C* COMPLETE PREVIOUS CURRENT FACTOR
308700200529     C*
308800200529      ***  If not already actioned, PCFCT has not yet been updated - it   E20086
308900200529      ***  still contains the prior value - must use UCFCT instead.       E20086
309000200529      *                                                                   E20086
309100200529     C           XSDAD     IFNE *ZERO                                     E20086
309200200529     C           XSDDT     ORNE *ZERO                                     E20086
309300200529     C                     Z-ADDPCFCT     PCFA
309400200529     C                     ELSE                                           E20086
309500200529     C                     Z-ADDUCFCT     PCFA                            E20086
309600200529     C                     END                                            E20086
309700200529     C*
309800200529     C* COMPLETE COUPON RATE - IR, MP, PP ONLY
309900200529     C*
310000200529     C           XSDET     IFEQ 'IR'
310100200529     C                     Z-ADDXSDNC     SDCR
310200200529     C                     ELSE
310300200529     C           XSDET     IFEQ 'MP'
310400200529     C           XSDET     OREQ 'PP'
310500200529     C                     Z-ADDUCPNR     SDCR
310600200529     C                     ELSE
310700200529     C                     Z-ADD*ZERO     SDCR
310800200529     C                     END
310900200529     C                     END
311000200529      *                                                                                       CAS006
311100200529     C           CAS006    IFEQ 'Y'                                                           CAS006
311200200529     C           XSDET     IFEQ 'IR'                                                          CAS006
311300200529     C                     Z-ADDXSDNN     WCPNN                                               CAS006
311400200529     C                     ELSE                                                               CAS006
311500200529     C           XSDET     IFEQ 'MP'                                                          CAS006
311600200529     C           XSDET     OREQ 'PP'                                                          CAS006
311700200529     C                     Z-ADDUCPNN     WCPNN                                               CAS006
311800200529     C                     ELSE                                                               CAS006
311900200529     C                     Z-ADD*ZERO     WCPNN                                               CAS006
312000200529     C                     ENDIF                                                              CAS006
312100200529     C                     ENDIF                                                              CAS006
312200200529     C                     ENDIF                                                              CAS006
312300200529     C*
312400200529     C* COMPLETE REPAYMENT METHOD IND/AMOUNT - MP ONLY
312500200529     C*
312600200529     C           XSDET     IFEQ 'MP'
312700200529     C                     MOVELXSRMI     RTMI
312800200529     C                     Z-ADDXSRPT     RTAI
312900200529     C                     ELSE
313000200529     C                     MOVEL*BLANK    RTMI
313100200529     C                     Z-ADD*ZERO     RTAI
313200200529     C                     END
313300200529     C*
313400200529     C* COMPLETE POSITION SETTLEMENT REQUIRED INDICATOR
313500200529     C*
313600200529     C           XRECI     IFEQ 'C'                                       S01158
313700200529     C*
313800200529     C           XSDDT     IFNE *ZERO
313900200529     C                     MOVEL'Y'       PSRI
314000200529     C                     ELSE
314100200529     C                     MOVEL*BLANK    PSRI
314200200529     C                     END
314300200529     C*
314400200529     C                     ELSE
314500200529     C*
314600200529     C           XSDDT     IFEQ *ZERO
314700200529     C                     MOVEL'Y'       PSRI
314800200529     C                     ELSE
314900200529     C                     MOVEL*BLANK    PSRI
315000200529     C                     END
315100200529     C*
315200200529     C                     END
315300200529     C*
315400200529     C* COMPLETE ACCOUNT KEYS REQUIRED INDICATOR
315500200529     C*
315600200529     C           XRECI     IFEQ 'C'                                       S01158
315700200529     C*
315800200529     C           XSDAD     IFNE *ZERO
315900200529     C                     MOVEL'Y'       AKRI
316000200529     C                     ELSE
316100200529     C                     MOVEL*BLANK    AKRI
316200200529     C                     END
316300200529     C*
316400200529     C                     ELSE
316500200529     C*
316600200529     C***********XSDED     IFEQ ECD                                E15549 054498
316700200529     C***********ACRLRN    ANDNE'3'                                E21305 054498
316800200529     C***********          MOVEL*BLANK    AKRI                            054498
316900200529     C***********          ELSE                                           054498
317000200529     C***********          MOVEL'Y'       AKRI                            054498
317100200529     C***********                                                  E15549 E23802
317200200529     C***UPDATE*LAST*COUPON/DIVIDEND*DATE*ON*LF/SECTY**************E15549 E23802
317300200529     C***********                                                  E15549 E23802
317400200529     C***********XSDET     IFEQ 'DV'                               E15549 E23802
317500200529     C***********          MOVE '1'       *IN,41                   E15549 E23802
317600200529     C***********          Z-ADDXSDED     DIVNDT  50               E15549 E23802
317700200529     C***********          END                                     E15549 E23802
317800200529     C***********          END                                            054498
317900200529     C*
318000200529     C           XSDED     IFLE AKDAT                                     054498
318100200529     C                     MOVEL'Y'       AKRI                            054498
318200200529     C                     ELSE                                           054498
318300200529     C                     MOVEL*BLANK    AKRI                            054498
318400200529     C                     END                                            054498
318500200529     C                     END
318600200529     C*
318700200529     C* COMPLETE NARRATIVE
318800200529     C*
318900200529     C                     MOVELXSDNV     SDNR
319000200529     C*
319100200529     C* INITIALISE OTHER FIELDS TO BLANK/ZERO
319200200529     C*
319300200529     C                     Z-ADDRUND      SAAC
319400200529     C                     Z-ADDXSDXD     SAEXD                           S01510
319500200529     C*
319600200529     C                     WRITESECACDF
319700200529     C                     ADD  1         OTOT5                           E15549
319800200529     C*
319900200529     C                     ADD  1         OTOT3
320000200529     C*
320100200529     C                     ENDSR
320200200529      *
320300200529      *****************************************************************
320400200529      /EJECT
320500200529      *****************************************************************
320600200529      *                                                               *
320700200529      *  OUTW04 - SR to Output an Initial Diary Event to SEDEVD       *
320800200529      *                                                               *
320900200529      *  Called By: NEWSEC                                            *
321000200529      *  Calls: None.                                                 *
321100200529      *                                                               *
321200200529      *****************************************************************
321300200529      *
321400200529     C           OUTW04    BEGSR                           **OUTW04 BEGSR**
321500200529     C                     MOVE 'M'       RECI
321600200529     C                     MOVE SESN      SDSN
321700200529     C                     Z-ADD*ZERO     SDED
321800200529     C                     MOVE NAR,3     SDNV
321900200529     C***********          Z-ADD*ZERO     SDDV                            E16772
322000200529     C                     Z-ADD*ZERO     SDVA                            E16772
322100200529     C                     Z-ADD*ZERO     SDPD
322200200529     C                     MOVE *BLANKS   SDCV
322300200529     C                     Z-ADD*ZERO     SDAD
322400200529     C                     Z-ADD*ZERO     SDDT
322500200529     C                     Z-ADD*ZERO     LCD
322600200529     C                     MOVE *BLANK    CHTP
322700200529     C                     Z-ADD*ZERO     TNLU
322800200529     C*
322900200529     C*  PAYMENT CURRENCY (SPYC) NE BLANK - OUTPUT TYPE 'XR'
323000200529     C*
323100200529     C           SPYC      IFNE *BLANKS                                   E13524
323200200529     C                     MOVE 'XR'      SDET
323300200529     C                     Z-ADD*ZERO     SDCP
323400200529     C                     Z-ADD*ZERO     SRPT
323500200529     C                     Z-ADD*ZERO     SDTR
323600200529     C                     MOVE *BLANK    SRMI
323700200529     C                     Z-ADD*ZERO     SDPD
323800200529     C                     Z-ADD*ZERO     SDNC
323900200529      *                                                                                       CAS006
324000200529     C           CAS006    IFEQ 'Y'                                                           CAS006
324100200529     C                     Z-ADD*ZERO     SDNN                                                CAS006
324200200529     C                     ENDIF                                                              CAS006
324300200529      *                                                                                       CAS006
324400200529     C                     Z-ADD*ZERO     SDPP
324500200529     C                     Z-ADD*ZERO     SDPC
324600200529     C                     Z-ADD*ZERO     SDTA
324700200529     C                     Z-ADD*ZERO     SDTP
324800200529     C                     Z-ADD*ZERO     SDRP
324900200529     C                     MOVE SPYC      SDCX
325000200529     C                     Z-ADDSEXR      SDCE
325100200529     C                     MOVE SMDI      SDMD
325200200529     C                     Z-ADD*ZERO     SDAL                                                CSE065
325300200529     C*
325400200529     C*  WRITE THE RECORD TO LF/SEDEL
325500200529     C*
325600200529     C                     WRITESEDEVDF
325700200529     C                     ADD  1         DTOTA
325800200529     C                     END
325900200529     C*
326000200529     C*  COUPON RATE NE ZERO - OUTPUT TYPE 'IR'
326100200529     C*
326200200529     C           CPNR      IFNE *ZERO
326300200529     C                     MOVE 'IR'      SDET
326400200529     C                     Z-ADD*ZERO     SDCP
326500200529     C                     Z-ADD*ZERO     SRPT
326600200529     C                     Z-ADD*ZERO     SDTR
326700200529     C                     MOVE *BLANK    SRMI
326800200529     C                     Z-ADD*ZERO     SDPD
326900200529     C                     Z-ADDCPNR      SDNC
327000200529     C                     Z-ADD*ZERO     SDPP
327100200529     C                     Z-ADD*ZERO     SDPC
327200200529     C                     Z-ADD*ZERO     SDTA
327300200529     C                     Z-ADD*ZERO     SDTP
327400200529     C                     Z-ADD*ZERO     SDRP
327500200529     C                     MOVE *BLANK    SDCX
327600200529     C                     Z-ADD*ZERO     SDCE
327700200529     C                     MOVE *BLANK    SDMD
327800200529     C                     Z-ADD*ZERO     SDAL                                                CSE065
327900200529      *                                                                                       CAS006
328000200529     C           CAS006    IFEQ 'Y'                                                           CAS006
328100200529     C           CPNN      IFNE *ZERO                                                         CAS006
328200200529     C                     Z-ADDCPNN      SDNN                                                CAS006
328300200529     C                     ENDIF                                                              CAS006
328400200529     C                     ENDIF                                                              CAS006
328500200529      *                                                                                       CAS006
328600200529     C/COPY WNCPYSRC,SE2100C024
328700200529     C*
328800200529     C*  WRITE THE RECORD TO LF/SEDEL
328900200529     C*
329000200529     C                     WRITESEDEVDF
329100200529     C                     ADD  1         DTOTA
329200200529     C                     END
329300200529     C*
329400200529     C*  PP CALL INDICATOR EQ 'Y' - OUTPUT TYPE 'PP'
329500200529     C*
329600200529     C           PPDI      IFEQ 'Y'
329700200529     C                     MOVE 'PP'      SDET
329800200529     C                     Z-ADD*ZERO     SDCP
329900200529     C                     Z-ADD*ZERO     SRPT
330000200529     C                     Z-ADD*ZERO     SDTR
330100200529     C                     MOVE *BLANK    SRMI
330200200529     C                     Z-ADD*ZERO     SDPD
330300200529     C***********          Z-ADD*ZERO     SDNC                            E14674
330400200529     C                     Z-ADDCPNR      SDNC                            E14674
330500200529     C           PROT      IFEQ '4'
330600200529     C                     Z-ADDCPDP      SDPP
330700200529     C                     Z-ADDCPDP      SDTA                            E15930
330800200529     C                     Z-ADD*ZERO     SDPC
330900200529     C                     Z-ADD*ZERO     SDTP                            E15930
331000200529     C                     ELSE
331100200529     C                     Z-ADD*ZERO     SDPP
331200200529     C***********          Z-ADD*ZERO     SDPC                     E15930 E23049
331300200529     C***********          Z-ADDCPDP      SDPC                            E15930
331400200529     C                     Z-ADD*ZERO     SDPC                            E15930
331500200529     C                     MOVE CPDP      SDPC                            E15930
331600200529     C                     END
331700200529     C*
331800200529     C** UPDATE SDTA AND SDTP WITH CPDP FOR THE INITIAL RECORD            E15930
331900200529     C*
332000200529     C***********          Z-ADD*ZERO     SDTA                            E15930
332100200529     C***********          Z-ADD*ZERO     SDTP                            E15930
332200200529     C                     Z-ADDSDPP      SDTA                            E15930
332300200529     C                     Z-ADDSDPC      SDTP                            E15930
332400200529     C*                                                                   E15930
332500200529     C                     Z-ADD*ZERO     SDRP
332600200529     C                     MOVE *BLANK    SDCX
332700200529     C                     Z-ADD*ZERO     SDCE
332800200529     C                     MOVE *BLANK    SDMD
332900200529     C                     Z-ADD*ZERO     SDAL                                                CSE065
333000200529      *                                                                                       CAS006
333100200529     C           CAS006    IFEQ 'Y'                                                           CAS006
333200200529     C                     Z-ADDCPNN      SDNN                                                CAS006
333300200529     C                     ENDIF                                                              CAS006
333400200529     C*
333500200529     C*  WRITE THE RECORD TO LF/SEDEL
333600200529     C*
333700200529     C                     WRITESEDEVDF
333800200529     C                     ADD  1         DTOTA
333900200529     C                     END
334000200529     C*
334100200529     C*  CURRENT FACTOR NE ZERO - OUTPUT TYPE 'MP'
334200200529     C*
334300200529     C           CFCT      IFNE *ZERO
334400200529     C                     MOVE 'MP'      SDET
334500200529     C                     Z-ADDCFCT      SDCP
334600200529     C                     Z-ADD*ZERO     SRPT
334700200529     C                     Z-ADD*ZERO     SDTR
334800200529     C                     MOVE *BLANK    SRMI
334900200529     C                     Z-ADD*ZERO     SDPD
335000200529     C***********          Z-ADD*ZERO     SDNC                            E14674
335100200529     C                     Z-ADDCPNR      SDNC                            E14674
335200200529     C                     Z-ADD*ZERO     SDPP
335300200529     C                     Z-ADD*ZERO     SDPC
335400200529     C                     Z-ADD*ZERO     SDTA
335500200529     C                     Z-ADD*ZERO     SDTP
335600200529     C                     Z-ADD*ZERO     SDRP
335700200529     C                     MOVE *BLANK    SDCX
335800200529     C                     Z-ADD*ZERO     SDCE
335900200529     C                     MOVE *BLANK    SDMD
336000200529     C                     Z-ADD*ZERO     SDAL                                                CSE065
336100200529      *                                                                                       CAS006
336200200529     C           CAS006    IFEQ 'Y'                                                           CAS006
336300200529     C                     Z-ADDCPNN      SDNN                                                CAS006
336400200529     C                     ENDIF                                                              CAS006
336500200529     C*
336600200529     C*  WRITE THE RECORD TO LF/SEDEL
336700200529     C*
336800200529     C                     WRITESEDEVDF
336900200529     C                     ADD  1         DTOTA
337000200529     C                     END
337100200529      *                                                                                       CSE065
337200200529     C           CSE065    IFEQ 'Y'                                                           CSE065
337300200529     C           PROT      ANDNE'2'                                                           CSE065
337400200529     C           PROT      ANDNE'4'                                                           CSE065
337500200529     C           PROT      ANDNE'7'                                                           CSE065
337600200529     C                     MOVE 'AL'      SDET                                                CSE065
337700200529     C                     MOVE *BLANKS   ZZ005                                               CSE065
337800200529     C                     Z-ADD*ZEROS    SRPT                                                CSE065
337900200529     C                     Z-ADD*ZEROS    SDTR                                                CSE065
338000200529     C                     MOVE *BLANKS   SRMI                                                CSE065
338100200529     C                     Z-ADD*ZEROS    SDNC                                                CSE065
338200200529     C                     Z-ADD*ZEROS    SDPP                                                CSE065
338300200529     C                     Z-ADD*ZEROS    SDPC                                                CSE065
338400200529     C                     Z-ADD*ZEROS    SDTA                                                CSE065
338500200529     C                     Z-ADD*ZEROS    SDTP                                                CSE065
338600200529     C                     Z-ADD*ZEROS    SDRP                                                CSE065
338700200529     C                     MOVE *BLANKS   SDCX                                                CSE065
338800200529     C                     Z-ADD*ZEROS    SDCE                                                CSE065
338900200529     C                     MOVE *BLANK    SDMD                                                CSE065
339000200529     C                     Z-ADD*ZEROS    SDNN                                                CSE065
339100200529     C                     Z-ADDALDT      SDAL                                                CSE065
339200200529      *                                                                                       CSE065
339300200529     C                     WRITESEDEVDF                                                       CSE065
339400200529      *                                                                                       CSE065
339500200529     C                     ADD  1         DTOTA                                               CSE065
339600200529      *                                                                                       CSE065
339700200529     C                     ENDIF                                                              CSE065
339800200529     C*
339900200529     C                     ENDSR
340000200529      *
340100200529      *****************************************************************
340200200529      /EJECT
340300200529      *****************************************************************
340400200529      *                                                               *
340500200529      *  OUTSND - Subroutine to Output Non-Diary Event to PF/SNDEVD   *
340600200529      *                                                               *
340700200529      *  Called By: OUTW01, OUTW02                                    *
340800200529      *  Calls: None.                                                 *
340900200529      *                                                               *
341000200529      *****************************************************************
341100200529      *
341200200529     C           OUTSND    BEGSR                           **OUTSND BEGSR**
341300200529     C*
341400200529     C*  SET UP FIELDS FROM SECACD RECORD
341500200529     C*
341600200529     C                     MOVEL'D'       RECI
341700200529     C                     MOVELSASN      SNSN
341800200529     C                     Z-ADDSAED      SNDT
341900200529     C                     MOVELSAAT      SNET
342000200529     C                     Z-ADDSDCR      SNCR
342100200529     C                     Z-ADDSACF      SNCF
342200200529     C                     Z-ADD*ZERO     SNCA
342300200529     C                     Z-ADDSTCA      SNCP
342400200529     C                     Z-ADD*ZERO     SNPR
342500200529     C                     MOVELSDNR      SNNA
342600200529      *                                                                                       CAS006
342700200529     C           CAS006    IFEQ 'Y'                                                           CAS006
342800200529     C                     Z-ADDWCPNN     SNCN                                                CAS006
342900200529     C                     ENDIF                                                              CAS006
343000200529      *                                                                                       CAS006
343100200529     C/COPY WNCPYSRC,SE2100C007
343200200529     C*
343300200529     C                     WRITESNDEVDF
343400200529     C*
343500200529     C                     ENDSR
343600200529      *
343700200529      *****************************************************************
343800200529     C/EJECT                                                              137563
343900200529     C*****************************************************************   137563
344000200529     C*                                                               *   137563
344100200529     C*  IRCHCK - Subroutine to check whether the IR event correspond *   137563
344200200529     C*           w/ the Interest Rate change of the Security.        *   137563
344300200529     C*                                                               *   137563
344400200529     C*  Called By: PROCES                                            *   137563
344500200529     C*  Calls: None.                                                 *   137563
344600200529     C*                                                               *   137563
344700200529     C*****************************************************************   137563
344800200529     C*                                                                   137563
344900200529     C           IRCHCK    BEGSR                                          137563
345000200529     C*                                                                   137563
345100200529     C                     Z-ADD*ZEROS    DAT                             137563
345200200529     C                     Z-ADD1         X       20                      137563
345300200529     C                     DO   12        X                               137563
345400200529     C           CD,X      IFNE *ZEROS                                    137563
345500200529     C           *IN98     IFEQ '1'                                       137563
345600200529     C                     MOVE CD,X      DAT,X                           137563
345700200529     C                     ELSE                                           137563
345800200529     C                     MOVELCD,X      WK2N    20                      137563
345900200529     C                     MOVE WK2N      WK4N    40                      137563
346000200529     C                     MOVE CD,X      WK2N                            137563
346100200529     C                     MOVELWK2N      WK4N                            137563
346200200529     C                     MOVE WK4N      DAT,X                           137563
346300200529     C                     ENDIF                                          137563
346400200529     C                     ENDIF                                          137563
346500200529     C                     ENDDO                                          137563
346600200529     C*                                                                   137563
346700200529     C** Find the year for the event                                      137563
346800200529     C*                                                                   137563
346900200529     C                     Z-ADDXSDED     ZDAYNO                          137563
347000200529     C                     EXSR ZDATE2                                    137563
347100200529     C                     MOVE ZDATE     IYR     20                      137563
347200200529     C                     MOVE ZDATE     WSDED   6                       137563
347300200529      *                                                                   206316
347400200529      ** If CSE031 is on, Next Coupon Date is amendable . This means      206316
347500200529      ** the NCD may not be found from the coupon array or SE0045.        206316
347600200529      ** If XSDED equals NCD and the correspoing coupon is 'R' or 'C'     206316
347700200529      ** then set on *IN50.                                               206316
347800200529      *                                                                   206316
347900200529     C           CSE031    IFEQ 'Y'                                       206316
348000200529     C           CSE071    OREQ 'Y'                                       CSE071
348100200529     C           BCNV      IFNE ' '                                       206316
348200200529     C           BCNV      ANDNE'N'                                       206316
348300200529      *                                                                   206316
348400200529     C           XSDED     IFEQ NCD                                       206316
348500200529      *                                                                   206316
348600200529      ** Find corresponding coupon.                                       206316
348700200529     C           CHK1      TAG                                            206316
348800200529     C                     MOVE 'N'       WCRI    1                       206316
348900200529     C                     Z-ADD12        X       20                      206316
349000200529      *                                                                   206316
349100200529     C           X         DOWGT0                                         206316
349200200529     C           CD,X      IFNE *ZERO                                     206316
349300200529      *                                                                   206316
349400200529      ** Convert Date to Day number                                       206316
349500200529     C                     MOVELIYR       DAT,X                           206316
349600200529     C                     MOVELDAT,X     WRK2                            206316
349700200529     C                     MOVE WRK2      ZDATE                           206316
349800200529     C                     MOVELDAT,X     WRK4                            206316
349900200529     C                     MOVE DAT,X     WRK2                            206316
350000200529     C                     MOVELWRK2      WRK4                            206316
350100200529     C                     MOVELWRK4      ZDATE                           206316
350200200529     C                     EXSR ZDATE1                                    206316
350300200529      *                                                                   206316
350400200529     C           NCD       IFGE ZDAYNO                                    206316
350500200529     C                     MOVE 'Y'       WCRI                            206316
350600200529     C                     LEAVE                                          206316
350700200529     C                     ENDIF                                          206316
350800200529      *                                                                   206316
350900200529     C                     ENDIF                                          206316
351000200529     C                     SUB  1         X                               206316
351100200529     C                     ENDDO                                          206316
351200200529      *                                                                   206316
351300200529      ** If coupon rate indicator not found check previous year           206316
351400200529     C           WCRI      IFEQ 'N'                                       206316
351500200529     C                     SUB  1         IYR                             206316
351600200529     C                     GOTO CHK1                                      206316
351700200529     C                     ENDIF                                          206316
351800200529      *                                                                   206316
351900200529      ** Check coupon rate indicator                                      206316
352000200529     C           WCRI      IFEQ 'Y'                                       206316
352100200529     C           CR,X      IFEQ 'R'                                       206316
352200200529     C           CR,X      OREQ 'C'                                       206316
352300200529     C                     MOVE '1'       *IN50                           206316
352400200529     C                     GOTO EIRCHK                                    206316
352500200529     C                     ENDIF                                          206316
352600200529     C                     ENDIF                                          206316
352700200529      *                                                                   206316
352800200529     C                     ENDIF                                          206316
352900200529     C                     ENDIF                                          206316
353000200529     C                     ENDIF                                          206316
353100200529     C*                                                                   137563
353200200529     C** Fetch Maturity date year                                         137563
353300200529     C*                                                                   137563
353400200529     C                     Z-ADDMATY      ZDAYNO                          137563
353500200529     C                     EXSR ZDATE2                                    137563
353600200529     C                     MOVE ZDATE     MYR     20                      137563
353700200529     C*                                                                   137563
353800200529     C** Assemble Event date into compatible format                       137563
353900200529     C** (And take date format M into consideration)                      137563
354000200529     C*                                                                   137563
354100200529     C                     MOVE WSDED     WK2N                            137563
354200200529     C                     MOVELWK2N      EVTDAT  60                      137563
354300200529     C           *IN98     IFEQ '1'                                       137563
354400200529     C                     MOVELWSDED     WK4N                            137563
354500200529     C                     ELSE                                           137563
354600200529     C                     MOVE WSDED     WK4N                            137563
354700200529     C                     MOVELWSDED     WK2N                            137563
354800200529     C                     MOVE WK2N      WK4N                            137563
354900200529     C                     ENDIF                                          137563
355000200529     C                     MOVE WK4N      EVTDAT                          137563
355100200529     C*                                                                   137563
355200200529     C           MYR       IFLT 72                                        137563
355300200529     C           MYR       ADD  100       MYRC    30                      137563
355400200529     C                     ELSE                                           137563
355500200529     C                     Z-ADDMYR       MYRC                            137563
355600200529     C                     ENDIF                                          137563
355700200529     C           IYR       IFLT 72                                        137563
355800200529     C           IYR       ADD  100       IYRC    30                      137563
355900200529     C                     ELSE                                           137563
356000200529     C                     Z-ADDIYR       IYRC                            137563
356100200529     C                     ENDIF                                          137563
356200200529     C*                                                                   137563
356300200529     C           IYRC      DOWLEMYRC                                      137563
356400200529     C                     Z-ADD1         X                               137563
356500200529     C                     MOVE '0'       *IN50                           137563
356600200529     C                     DO   12        X                               137563
356700200529     C           DAT,X     IFNE *ZEROS                                    137563
356800200529     C                     MOVELIYR       DAT,X                           137563
356900200529     C***********EVTDAT    CABEQDAT,X     EIRCHK         50        137563 182505
357000200529     C           BCNV      IFNE ' '                                       182505
357100200529     C           BCNV      ANDNE'N'                                       CSE031
357200200529     C*                                                                   182505
357300200529     C                     MOVELDAT,X     WRK2    2                       182505
357400200529     C                     MOVE WRK2      ZDATE                           182505
357500200529     C                     MOVELDAT,X     WRK4    4                       182505
357600200529     C                     MOVE DAT,X     WRK2    2                       182505
357700200529     C                     MOVELWRK2      WRK4                            182505
357800200529     C                     MOVELWRK4      ZDATE                           182505
357900200529     C                     EXSR ZDATE1                                    182505
358000200529     C*                                                                   182505
358100200529     C           BCNV      IFEQ 'C'                                       182505
358200200529     C********** CSE031    OREQ 'Y'                                CSE031 206316
358300200529     C                     MOVE 'N'       NCI     1                       182505
358400200529     C                     ELSE                                           182505
358500200529     C                     MOVE 'L'       NCI                             182505
358600200529     C                     ENDIF                                          182505
358700200529     C                     Z-ADDZDAYNO    WRCHG   50                      182505
358800200529     C                     CALL 'SE0045'                                  182505
358900200529     C                     PARM           SITP                            182505
359000200529     C                     PARM           WRCHG                           182505
359100200529     C                     PARM           ITLD                            182505
359200200529     C                     PARM           FCPN                            182505
359300200529     C                     PARM           CD                              182505
359400200529     C                     PARM           CR                              182505
359500200529     C                     PARM           NMCY                            182505
359600200529     C                     PARM           WRCHG                           182505
359700200529     C                     PARM           NCI                             182505
359800200529     C                     PARM           BCNV                            182505
359900200529     C                     PARM           MATY                            182505
360000200529     C                     PARM           LCPN                            CSE031
360100200529     C                     PARM           HCY1                            CSE071
360200200529     C                     PARM           HCY2                            CSE071
360300200529     C                     PARM           HCY3                            CSE071
360400200529     C                     PARM           HCY4                            CSE071
360500200529     C                     PARM           HCY5                            CSE071
360600200529     C                     PARM           HCY6                            CSE071
360700200529     C                     PARM           HCY7                            CSE071
360800200529     C                     PARM           HCY8                            CSE071
360900200529     C                     PARM           HCY9                            CSE071
361000200529     C*                                                                   182505
361100200529     C           XSDED     IFEQ WRCHG                                     182505
361200200529     C           CR,X      IFEQ 'R'                                       182505
361300200529     C           CR,X      OREQ 'C'                                       182505
361400200529     C                     MOVE '1'       *IN50                           182505
361500200529     C                     GOTO EIRCHK                                    182505
361600200529     C                     ENDIF                                          182505
361700200529     C                     ENDIF                                          182505
361800200529     C*                                                                   182505
361900200529     C                     ENDIF                                          182505
362000200529     C*                                                                   182505
362100200529     C           EVTDAT    IFEQ DAT,X                                     137563
362200200529     C           CR,X      IFEQ 'R'                                       137563
362300200529     C           CR,X      OREQ 'C'                                       137563
362400200529     C                     MOVE '1'       *IN50                           137563
362500200529     C                     ENDIF                                          137563
362600200529     C                     GOTO EIRCHK                                    137563
362700200529     C                     ENDIF                                          137563
362800200529     C                     ENDIF                                          137563
362900200529     C                     ENDDO                                          137563
363000200529     C*                                                                   137563
363100200529     C           IYR       IFEQ 99                                        137563
363200200529     C                     Z-ADD0         IYR                             137563
363300200529     C                     ADD  1         IYRC                            137563
363400200529     C                     ELSE                                           137563
363500200529     C                     ADD  1         IYR                             137563
363600200529     C                     ADD  1         IYRC                            137563
363700200529     C                     ENDIF                                          137563
363800200529     C*                                                                   137563
363900200529     C                     ENDDO                                          137563
364000200529     C*                                                                   137563
364100200529     C           EIRCHK    ENDSR                                          137563
364200200529     C*                                                                   137563
364300200529     C*****************************************************************   137563
364400200529      /EJECT
364500200529     C*                                                                   S96032
364600200529     C/COPY WNCPYSRC,SE2100CP10                                           S96032
364700200529     C*                                                                   S96032
364800200529      *****************************************************************
364900200529      *                                                               *
365000200529      *  SECSR  - Subroutine for SECTY File Exception/Error handling. *
365100200529      *                                                               *
365200200529      *****************************************************************
365300200529      *
365400200529     C           SECSR     BEGSR                           **SECSR BEGSR**
365500200529     C*
365600200529     C           *LOCK     IN   LDA                                       S01117
365700200529     C                     MOVEL'SECTY'   DBFILE           ***************
365800200529     C                     MOVELSESN      DBKEY            * DB ERROR 07 *
365900200529     C                     Z-ADD7         DBASE            ***************
366000200529     C                     OUT  LDA                                       S01117
366100200529     C                     MOVELSTSSEC    DBSTAT
366200200529     C                     MOVEA'1'       *IN,88
366300200529     C                     MOVEL'1'       *INU7
366400200529     C                     MOVEL'1'       *INU8
366500200529     C                     EXSR *PSSR                                     S01117
366600200529     C*
366700200529     C                     ENDSR
366800200529      *
366900200529      *****************************************************************
367000200529      /SPACE 3
367100200529      *****************************************************************
367200200529      *                                                               *
367300200529      *  DELSR  - Subroutine for SEDEL File Exception/Error handling. *
367400200529      *                                                               *
367500200529      *****************************************************************
367600200529      *
367700200529     C           DELSR     BEGSR                           **DELSR BEGSR**
367800200529     C*
367900200529     C           *LOCK     IN   LDA                                       S01117
368000200529     C                     MOVEL'SEDEL'   DBFILE           ***************
368100200529     C                     MOVELSDSN      DBKEY            * DB ERROR 08 *
368200200529     C                     Z-ADD8         DBASE            ***************
368300200529     C                     OUT  LDA                                       S01117
368400200529     C                     MOVELSTSDEL    DBSTAT
368500200529     C                     EXSR *PSSR                                     S01117
368600200529     C                     MOVEA'1'       *IN,88
368700200529     C                     MOVEL'1'       *INU7
368800200529     C                     MOVEL'1'       *INU8
368900200529     C*
369000200529     C                     ENDSR
369100200529      *
369200200529      *****************************************************************
369300200529      /SPACE 3
369400200529      *****************************************************************
369500200529      *                                                               *
369600200529      *  SNDSR  - Subroutine for SNDEVD File Exception/Error handling.*
369700200529      *                                                               *
369800200529      *****************************************************************
369900200529      *
370000200529     C           SNDSR     BEGSR                           **SNDSR BEGSR**
370100200529     C*
370200200529     C           *LOCK     IN   LDA                                       S01117
370300200529     C                     MOVEL'SNDEVD'  DBFILE           ***************
370400200529     C                     MOVELSNSN      DBKEY            * DB ERROR 09 *
370500200529     C                     Z-ADD9         DBASE            ***************
370600200529     C                     MOVELSTSSND    DBSTAT
370700200529     C                     OUT  LDA                                       S01117
370800200529     C                     EXSR *PSSR                                     S01117
370900200529     C                     MOVEA'1'       *IN,88
371000200529     C                     MOVEL'1'       *INU7
371100200529     C                     MOVEL'1'       *INU8
371200200529     C*
371300200529     C                     ENDSR
371400200529      *
371500200529      *****************************************************************
371600200529      /SPACE 3
371700200529      *****************************************************************
371800200529      *                                                               *
371900200529      *  SNASR  - Subroutine for SNDEVA FILE Exception/Error handling.*
372000200529      *                                                               *
372100200529      *****************************************************************
372200200529      *
372300200529     C           SNASR     BEGSR                           **SNASR BEGSR**
372400200529     C*
372500200529     C           *LOCK     IN   LDA                                       S01117
372600200529     C                     MOVEL'SNDEVA'  DBFILE           ***************
372700200529     C                     MOVEL'AUDIT'   DBKEY            * DB ERROR 10 *
372800200529     C                     Z-ADD10        DBASE            ***************
372900200529     C                     MOVELSTSSNA    DBSTAT
373000200529     C                     OUT  LDA                                       S01117
373100200529     C                     EXSR *PSSR                                     S01117
373200200529     C                     MOVEA'1'       *IN,88
373300200529     C                     MOVEL'1'       *INU7
373400200529     C                     MOVEL'1'       *INU8
373500200529     C*
373600200529     C                     ENDSR
373700200529      *
373800200529      *****************************************************************
373900200529      /SPACE 3
374000200529      *****************************************************************
374100200529      *                                                               *
374200200529      *  CCDSR  - Subroutine for SECACD File Exception/Error handling.*
374300200529      *                                                               *
374400200529      *****************************************************************
374500200529      *
374600200529     C           CCDSR     BEGSR                           **CCDSR BEGSR**
374700200529     C*
374800200529     C           *LOCK     IN   LDA                                       S01117
374900200529     C                     MOVEL'SECACD'  DBFILE           ***************
375000200529     C                     MOVELSASN      DBKEY            * DB ERROR 11 *
375100200529     C                     Z-ADD11        DBASE            ***************
375200200529     C                     MOVELSTSCCD    DBSTAT
375300200529     C                     OUT  LDA                                       S01117
375400200529     C                     EXSR *PSSR                                     S01117
375500200529     C                     MOVEA'1'       *IN,88
375600200529     C                     MOVEL'1'       *INU7
375700200529     C                     MOVEL'1'       *INU8
375800200529     C*
375900200529     C                     ENDSR
376000200529      *
376100200529      *****************************************************************
376200200529     C/COPY WNCPYSRC,SE2100C004
376300200529      /SPACE 3
376400200529      *****************************************************************
376500200529      *                                                               *
376600200529      *  CCASR  - Subroutine for SECACA File Exception/Error handling.*
376700200529      *                                                               *
376800200529      *****************************************************************
376900200529      *
377000200529     C           CCASR     BEGSR                           **CCASR BEGSR**
377100200529     C*
377200200529     C           *LOCK     IN   LDA                                       S01117
377300200529     C                     MOVEL'SECACA'  DBFILE           ***************
377400200529     C                     MOVEL'AUDIT'   DBKEY            * DB ERROR 12 *
377500200529     C                     Z-ADD12        DBASE            ***************
377600200529     C                     MOVELSTSCCA    DBSTAT
377700200529     C                     OUT  LDA                                       S01117
377800200529     C                     EXSR *PSSR                                     S01117
377900200529     C                     MOVEA'1'       *IN,88
378000200529     C                     MOVEL'1'       *INU7
378100200529     C                     MOVEL'1'       *INU8
378200200529     C*
378300200529     C                     ENDSR
378400200529      *
378500200529      *****************************************************************                       CSE065
378600200529      /SPACE 3                                                                                CSE065
378700200529      *****************************************************************                       CSE065
378800200529      *                                                               *                       CSE065
378900200529      *  OUTW05 - Subroutine for End of Security Average Life         *                       CSE065
379000200529      *           Date Processing                                     *                       CSE065
379100200529      *                                                               *                       CSE065
379200200529      *****************************************************************                       CSE065
379300200529      *                                                                                       CSE065
379400200529     C           OUTW05    BEGSR                                                              CSE065
379500200529      *                                                                                       CSE065
379600200529     C                     CLEARSECACDF                                                       CSE065
379700200529      *                                                                                       CSE065
379800200529     C                     MOVE 'D'       RECI                                                CSE065
379900200529     C                     MOVELSESN      SASN                                                CSE065
380000200529     C                     MOVE 'ML'      SAAT                                                CSE065
380100200529     C                     MOVE '80'      SAAS                                                CSE065
380200200529     C                     Z-ADDALDT      SAED                                                CSE065
380300200529     C                     MOVEL#CONS1    SDNR                                                CSE065
380400200529     C                     Z-ADDRUND      SAAC                                                CSE065
380500200529     C                     MOVE 'Y'       AKRI                                                CSE065
380600200529     C                     Z-ADDULCPN     LCCP                                                CSE065
380700200529      *                                                                                       CSE065
380800200529     C                     WRITESECACDF                                                       CSE065
380900200529      *                                                                                       CSE065
381000200529     C                     ADD  1         OTOT3                                               CSE065
381100200529     C                     ADD  1         OTOT5                                               CSE065
381200200529      *                                                                                       CSE065
381300200529     C                     ENDSR                                                              CSE065
381400200529      *                                                                                       CSE065
381500200529      *****************************************************************   S01117
381600200529      /EJECT                                                              S01117
381700200529      *****************************************************************   S01117
381800200529      *                                                               *   S01117
381900200529      *  *PSSR  - Error control subroutine                            *   S01117
382000200529      *                                                               *   S01117
382100200529      *****************************************************************   S01117
382200200529      *                                                                   S01117
382300200529     C           *PSSR     BEGSR                           ** *PSSR **    S01117
382400200529     C**                                                                  S01117
382500200529     C           @RUN      IFEQ *BLANKS                                   S01117
382600200529     C                     MOVE 'Y'       @RUN    1                       S01117
382700200529     C                     DUMP                                           S01117
382800200529     C                     END                                            S01117
382900200529     C**                                                                  S01117
383000200529     C                     ENDSR                                          S01117
383100200529      *                                                                   S01117
383200200529      *****************************************************************
383300200529      /EJECT                                                              054498
383400200529     C/COPY ZSRSRC,ZEVCDZ1                                                054498
383500200529      /EJECT
383600200529     C/COPY ZSRSRC,ZDATE1Z2
383700200529      /EJECT
383800200529     C/COPY ZSRSRC,ZDATE2Z4
383900200529      /EJECT
384000200529     C/COPY ZSRSRC,ZICD2Z1
384100200529      /EJECT                                                              E20085
384200200529     C/COPY ZSRSRC,ZLCDZ1                                                 E20085
384300200529      /EJECT
384400200529     C/COPY ZSRSRC,ZNCDZ3
384500200529      /EJECT
384600200529     C/COPY ZSRSRC,ZSYSTMZ1
384700200529     C/COPY ZSRSRC,ZACCH                                                  CSE023
384800200529     C/COPY ZSRSRC,ZBKDT                                                  CSE023
384900200529     C/COPY ZSRSRC,ZFWDT                                                  182505
385000200529     C/COPY WNCPYSRC,SE2100C005
385100200529      /EJECT
385200200529      ***
385300200529     O/COPY WNCPYSRC,SE2100OOP1                                           S96032
385400200529**  CPY@
385500200529(c) Finastra International Limited 2001
385600200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
3857002005290366073110961461
385800200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
385900200529000031059090120151181212243273304334365
386000200529**   ZMNM - MONTHS SHORT NAMES
386100200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
386200200529** NAR
386300200529COUPON DATE
386400200529MATURITY DATE
386500200529INITIAL VALUE
386600200529** ETP                                                                    E15549
386700200529XRIRMPPPAL                                                                             E15549 CSE065
386800200529     X/COPY WNCPYSRC,SE2100X001
