000100200602     H        1
000200200602      *****************************************************************
000300200602/*STD *  RPGBASE                                                      *
000400200602/*EXI *  TEXT('Midas SE Drop off security events')
000500200602     F*****************************************************************
000600200602     F*                                                               *
000700200602     F*  Midas - Securities Trading Module
000800200602     F*                                                               *
000900200602     F*  SE2510  - FLAG SECURITY EVENTS TO DROP OFF                   *
001000200602     F*                                                               *
001100200602     F*  Function: To flag for dropping off any Security events       *
001200200602     F*   (COB)    derived from Security Diary, Market Prices, or     *
001300200602     F*            from a security itself, which are no longer        *
001400200602     F*            required. ie:                                      *
001500200602     F*            1)  past retention period on ICD                   *
001600200602     F*            2)  for events affecting interest calculation      *
001700200602     F*                - prior to Last Coupon Date                    *
001800200602     F*                - not the first event of that type prior       *
001900200602     F*******************to*back*value*period**************************   S11029
002000200602     F*                  to Backvalue period or Beginning of Year.    *   S11029
002100200602     F*            3)  for deleted securities                         *
002200200602     F*                                                               *
002300200602      *  (c) Finastra International Limited 2001                      *
002400200602     F*                                                               *
002500200604     F*  Last Amend No. 247420             Date 22May20               *
002600200602      *  Prev Amend No. MD046248           Date 27Oct17               *
002700200602      * Bank Fusion Midas 1.4 Base -----------------------------------*
002800200602      * Midas Plus 1.4 Base 04 ---------------------------------------*
002900200602      *                 095907             Date 17Jan07               *
003000200602      * Midas Plus 1.4 Base ------------------------------------------*
003100200602      * Midas Plus 1.3 ----------- Base ------------------------------*
003200200602      *                 172190             Date 13Oct06               *
003300200602      *                 CSD027             Date 09Dec05               *
003400200602      *                 BUG9848            Date 12Jan06               *
003500200602      *                 CSE071             Date 19Jul05               *
003600200602      *                 CAS008             Date 11May04               *
003700200602      *                 CAS006             Date 21Jan03               *
003800200602      * Midas Release 4.01.02 ----------------------------------------*
003900200602      *                 197419             Date 06Mar02               *
004000200602      * Midas Release 4 --------------- Base -------------------------*
004100200602      * Midas DBA 3.04 -----------------------------------------------*
004200200602      *                 187084             Date 30Nov00               *
004300200602      * Midas DBA 3.02 -----------------------------------------------*
004400200602      * Midas DBA 3.00 ---------------- Base -------------------------*
004500200602      *                 092129             Date 13Aug96               *
004600200602     F*                 071067             DATE 30JUL96               *
004700200602     F*                 052254             DATE 10JAN94               *
004800200602     F*                 S11029             DATE 19APR93               *
004900200602     F*                 S01401             DATE 16JUN93               *
005000200602     F*                 E44166             DATE 04NOV92               *
005100200602     F*                 S01397             DATE 10SEP92               *
005200200602     F*                 E29170             DATE 07NOV91               *
005300200602     F*                 S01117             DATE 07JUN91               *
005400200602     F*                 S01269             DATE 01AUG90               *
005500200602     F*                 E20651             DATE 30JAN90               *
005600200602     F*                 E16772             DATE 19/06/89              *
005700200602     F*                                                               *
005800200602     F*---------------------------------------------------------------*
005900200602      *  247420 - Non diary events not being dropped due to event date*
006000200602      *           being compared to the last coupon date of the       *
006100200602      *           security though zero.  Rename pf/SECTYD fields RECI *
006200200602      *           and NMCY to RECIS and NMCYS.  Process print before  *
006300200602      *           drop. rename and increase length of field NORE in   *
006400200602      *           SNDEVA from NORE(5,0) to SNNORE(&,0). Increase also *
006500200602      *           all working fields related to field SNNORE. Applied *
006600200602      *           fix 230430.                                         *
006700200602      *  MD046248 - Finastra Rebranding                               *
006800200602     F*  095907 - DELETE SNDEVD RECORDS IF THE SECURITY DOESN'T EXIST *
006900200602     F*           ANYMORE.                                            *
007000200602     F*         - DROP SNDEVD RECORDS IF EVENT DATE LT RETENTION DATE *
007100200602     F*           (RECI NEVER UPDATED TO 'M')                         *
007200200602     F*         - EVENTS 'XR' MUST BE DROPPED IF SECURITY IS DELETED  *
007300200602     F*         - TRAILERS SEDEVA MUST BE UPDATED WITH RECI 'D' AND   *
007400200602     F*           'M' IN LIVE RECORDS                                 *
007500200602     F*         - MODIFICATIONS CALCULATIONS FOR OUTPUT TRAILER       *
007600200602     F*         - UPDATES OF RECI WITH '*' REPLACED BY DELETES        *
007700200602     F*         - STORE NOMINAL CURRENCY FROM SECTYD                  *
007800200602     F*         - ONLY ACCESS SECTYD WHEN CHANGE OF SECURITY          *
007900200602     F*         - USE WORK FILED OF 6,0 TO OUPTPUT DETAILS FOR SNDEVD *
008000200602     F*           ON SE2510AU                                         *
008100200602     F*         - RENAME REC ID OF SECTYD TO AVOID CONFUSION WITH REC.*
008200200602     F*           ID OF THE EVENTS AFTER ACCESS TO THE SECURITY       *
008300200602     F*         - also include 243026                                 *
008400200602     F*  243026 - Use fields with Length of 7.                        *
008500200602      *  172190 - Wrong calculation of Nbr live record for SNDEVA     *
008600200602      *  CSD027 - Conversion Of Customer Number to Alpha              *
008700200602      *  BUG9848- Database error occurred due to 'AL' intial record   *
008800200602      *           abnormally dropped.                                 *
008900200602      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
009000200602      *  CAS008 - Delayed Hedge Assessment (Recompile)                *
009100200602      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
009200200602      *  197419 - Delete all records from PF/PRICED with RECI of '*'  *
009300200602      *           if they were already dropped in PF/SECTYD.          *
009400200602     F*  187084 - When CSE023 Treaty Withholding Tax present, need to *
009500200602     F*           ensure events are not droped before position        *
009600200602     F*           settlement records. (It will cause DB error in      *
009700200602     F*           SE7510)                                             *
009800200602     F*  092129 - NON DIARY EVENTS NOT BEING DROPPED.                 *
009900200602     F*  071067 - Drop 'XR' Events whose securities are already       *
010000200602     F*           matured.                                            *
010100200602     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
010200200602     F*           to 10,9                                             *
010300200602     F*  S11029 - Program changed to not drop Events since Last End   *
010400200602     F*           of Year as they may be required for the Cost of     *
010500200602     F*           Funds Report.                                       *
010600200602     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
010700200602     F*          - Recompiled due to changes to files.                *
010800200602     F*  E44166 - Drop SEDEVD records of any initial event type, that *
010900200602     F*           is, only if security is not valid.                  *
011000200602     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
011100200602     F*          - Recompiled due to changes to files.                *
011200200602     F*  E29170 - Report Control Facility changes                     *
011300200602     F*  S01117 - Multi-branching                                     *
011400200602     F*  S01269 - Trade authorisation: recompiled over changed file   *
011500200602     F*           TABSE.                                              *
011600200602     F*  E20651 - DB ERROR NUMBERS USED IN MORE THAN ONE PLACE.       *   E20651
011700200602     F*           NEW ERROR NUMBERS AS FOLLOWS:                       *   E20651
011800200602     F*           DB ERROR 10 -> 11                                   *   E20651
011900200602     F*           DB ERROR 10 -> 12                                   *   E20651
012000200602     F*  E16772 - Recompiled for the Dividend Payment Amount field    *   E16772
012100200602     F*           changes.                                            *   E16772
012200200602     F*                                                               *   E16772
012300200602     F*****************************************************************
012400200602     F*  C R E A T I O N     P A R A M E T E R S                      *
012500200602     F*                                                               *
012600200602     F*                                                               *
012700200602     F*****************************************************************
012800200602     F*
012900200602     FSECTY   IF  E           K        DISK
013000200602     FINVTP   IF  E           K        DISK
013100200602     FSECEO   UF  E           K        DISK
013200200602     F                                              KINFDS CEDDS
013300200602     F                                              KINFSR CEDSR
013400200602     FSEDEVA  UF  E                    DISK
013500200602     F                                              KINFDS EDADS
013600200602     F                                              KINFSR EDASR
013700200602     FSNDEVA  UF  E                    DISK
013800200602     F                                              KINFDS NDADS
013900200602     F                                              KINFSR NDASR
014000200602     FPRICED  UF  E                    DISK                                                   197419
014100200602     F                                              KINFDS PRCDS                              197419
014200200602     F                                              KINFSR PRCSR                              197419
014300200602     FSE2510P1O   E                    PRINTER                        UC
014400200602     F                                              KINFDS SPOOL          E29170
014500200602     FSE2510AUO   E                    PRINTER
014600200602     F                                              KINFDS SPOOLU         E29170
014700200602     FTABSE   IF  E           K        DISK
014800200602     F* ICD 1     TABTB10F                          KIGNORE
014900200602     F* ICD 2     TABTB11F                          KIGNORE
015000200602     F* ICD SE    TABTB36F                          KIGNORE
015100200602     F*           TABTG10F                          KIGNORE
015200200602     F            TABTG20F                          KIGNORE
015300200602     F            TABLETHF                          KIGNORE
015400200602     F*********** TABLETJF                          KIGNORE               S01117
015500200602     F            TABLETLF                          KIGNORE
015600200602     F            TABLETRF                          KIGNORE
015700200602     F            TABLETXF                          KIGNORE
015800200602     F            TABLET2F                          KIGNORE
015900200602     F            TABLET3F                          KIGNORE
016000200602     F            TABLET5F                          KIGNORE
016100200602     F            TABTE10F                          KIGNORE
016200200602     F            TABTE20F                          KIGNORE
016300200602     F            TABLETNF                          KIGNORE
016400200602     F            TABLETKF                          KIGNORE
016500200602     F            TABLETPF                          KIGNORE
016600200602     F/COPY WNCPYSRC,SE2510F001
016700200602      /EJECT
016800200602     F*****************************************************************
016900200602     F*                                                               *
017000200602     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
017100200602     F*                                                               *
017200200602     F*   20 - RECORD READ- DIARY EVENTS                              *
017300200602     F*   21 - RECORD READ - NON-DIARY EVENTS                         *
017400200602     F*   22 - END OF INPUT - SECEO                                   *
017500200602     F*   25 - ON IF NEW SECURITY / EVENT TYPE                        *
017600200602     F*   30 - IF ON, THIS RECORD TO BE DROPPED                       *
017700200602     F*   31 - IF ON, SECURITY RECORD(SECTYD) NOT FOUND               *
017800200602      *   32 - Used to read PF/PRICED records                         *                       197419
017900200602     F*56&58 - CHAINS IN PR01                                         *
018000200602     F*60-69 - DEFINES EVENT TYPE IN PR01                             *
018100200602     F*   70 - IF ON, CONTROL TOTALS ERROR SEDEVA                     *
018200200602     F*   71 - IF ON, CONTROL TOTALS ERROR SNDEVA                     *
018300200602     F*   80 - PRINT SECURITY SHORT NAME IN PR01                      *
018400200602     F*   99 - GENERAL ERROR                                          *
018500200602     F*   U7 - DATABASE ERROR                                         *
018600200602     F*   U8 - CONTROL OR DATABASE ERROR                              *
018700200602     F*                                                               *
018800200602     F*****************************************************************
018900200602      /EJECT
019000200602     F*****************************************************************
019100200602     F*                                                               *
019200200602     F*  I N D E X   T O   S U B R O U T I N E S                      *
019300200602     F*                                                               *
019400200602     F*   FIRST   - INITIALISATION                                    *
019500200602     F*   PROCES  - PROCESSES EACH RECORD ON SECEO                    *
019600200602     F*   DROP    - FLAGS RECORD FOR DELETION                         *
019700200602     F****AUDIT***-*UPDATES*AUDIT*FILES*(SEDEVA/SNDEVA)****************                       197419
019800200602      *   AUDIT   - Updates audit files (SEDEVA/SNDEVA/PRICEA)        *                       197419
019900200602     F*   PRINT   - PRINTS CONTROL TOTALS REPORT                      *
020000200602     F*   PR01    - PRINTS DETAIL REPORT                              *
020100200602      *   PR02    - Prints detail report for PF/PRICED                *                       197419
020200200602     F*   NEXT    - READS NEXT RECORD FROM SECEO                      *
020300200602     F*   ZSYSTM  - ACCESSES ICD 1(TABTB10)                           *
020400200602     F*   ZICD2   - ACCESSES ICD 2(TABTB11)                           *
020500200602     F*   ZICDSE  - ACCESSES ICD FOR SE(TABTB36)                      *
020600200602     F*   ZDATE2  - FORMAT DATES                                      *
020700200602     F*   ZSEDIT  - EDIT FIELDS                                       *
020800200602     F*   CEDSR   - ERROR SUBROUTINE FOR LF/SECE0                     *
020900200602     F*   EDASR   - ERROR SUBROUTINE FOR PF/SEDEVA                    *
021000200602     F*   NDASR   - ERROR SUBROUTINE FOR PF/SNDEVA                    *
021100200602      *   PRCSR   - Error subroutine for PF/PRICED                    *                       197419
021200200602     F*   *PSSR   - Error handling                                    *   S01117
021300200602     F*   RCFP1   - SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF    *   E29170
021400200602     F*   RCFAU   - SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF    *   E29170
021500200602     F*                                                               *
021600200602     F*****************************************************************
021700200602      /EJECT
021800200602      /COPY ZSRSRC,ZDATE2Z1
021900200602     E                    CPY@    1   1 80
022000200602     E/COPY WNCPYSRC,SE2510E001
022100200602     E                    TABEVT  5  14  2   TABLEG 14   EVENT TABLE
022200200602     E/COPY WNCPYSRC,SE2510E002
022300200602     E/COPY ZSRSRC,ZSEDITZ1
022400200602      /EJECT
022500200602     ISECTYDF                                                                                 095907
022600200602     I              RECI                            RECIS                                     095907
022700200602     I              NMCY                            XNMCY                                     095907
022800200602     E/COPY WNCPYSRC,SE2510E003
022900200602     ISEDEVDF     20
023000200602     ISNDEVDF     21
023100200602      * RENAME SNDEVD FIELDS TO LOOK LIKE SEDEVD
023200200602     I              SNSN                            SDSN
023300200602     I              SNDT                            SDED
023400200602     I              SNET                            SDET
023500200602     IINVTPDF                                                                                 CAS006
023600200602     I              SFLG                            ITSFLG                                    CAS006
023700200602     I/COPY WNCPYSRC,SE2510I002
023800200602     I*
023900200602     IEKEY        DS
024000200602     I*
024100200602     I* DATA STRUCTURE TO STORE SHORT NAME,EVENT TYPE AND DATE
024200200602     I*
024300200602     I                                        1  10 SDSN
024400200602     I                                       11  150SDED
024500200602     I                                       16  17 SDET
024600200602     I*
024700200602     ITABKEY      DS
024800200602     I*
024900200602     I* DATA STRUCTURE FOR TABLE FILE KEY
025000200602     I*
025100200602     I                                        1  12 TKEY
025200200602     I                                        1   20RECT
025300200602     I                                        3  10 ZZ008
025400200602     I                                       11  120RCDE
025500200602     I*
025600200602     I* DATA STRUCTURES FOR RPG 01021 ERROR HANDLING
025700200602     I*
025800200602     ICEDDS       DS
025900200602     I                                     *STATUS  STSCED
026000200602     I*
026100200602     IEDADS       DS
026200200602     I                                     *STATUS  STSEDA
026300200602     I*
026400200602     INDADS       DS
026500200602     I                                     *STATUS  STSNDA
026600200602      *                                                                                       197419
026700200602     IPRCDS       DS                                                                          197419
026800200602     I                                     *STATUS  STSPRC                                    197419
026900200602      *                                                                                       197419
027000200602     I/COPY WNCPYSRC,SE2510I001
027100200602     I*
027200200602     I*LDA******* UDS                            256                      S01117
027300200602     ILDA         DS                            256                       S01117
027400200602     I*
027500200602     I* FILE INFORMATION DATA STRUCTURE USED FOR ERROR PROCESSING
027600200602     I*
027700200602     I***********                           134 177 DBLOT                 S01117
027800200602     I***********                           134 138 DBFILE                S01117
027900200602     I***********                           139 167 DBKEY                 S01117
028000200602     I***********                           168 175 DBPGM                 S01117
028100200602     I***********                           176 1770DBASE                 S01117
028200200602     I                                      134 183 DBLOT                 S01117
028300200602     I                                      134 141 DBFILE                S01117
028400200602     I                                      142 170 DBKEY                 S01117
028500200602     I                                      171 180 DBPGM                 S01117
028600200602     I                                      181 1830DBASE                 S01117
028700200602     I*                                                                   E29170
028800200602     ISPOOL       DS                                                      E29170
028900200602     I*                                                                   E29170
029000200602     I**  DS FOR P1 SPOOL FILE NAME                                       E29170
029100200602     I*                                                                   E29170
029200200602     I                                       83  92 SFILE                 E29170
029300200602     I                                    B 123 1240SFNUM                 E29170
029400200602     I**                                                                  E29170
029500200602     ISPOOLU      DS                                                      E29170
029600200602     I                                       83  92 SFILEU                E29170
029700200602     I                                    B 123 1240SFNUMU                E29170
029800200602     I*
029900200602     ICPYR@#      DS
030000200602     I*
030100200602     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
030200200602     I*
030300200602     I                                        1  80 CPY@
030400200602     I                                        1  20 CPY@##
030500200602     I/COPY ZSRSRC,ZSEDITZ2
030600200602     I*                                                                   187084
030700200602     I**  EXTERNAL DS FOR SECURITIES TRADING DETAILS                      187084
030800200602     I*                                                                   187084
030900200602     ISDSTRD    E DSSDSTRDPD                                              187084
031000200602     I*                                                                   187084
031100200602     I** LONG STRUCTURE FOR ACCESS OBJECTS, LONG DATA STRUCTURE           d87084
031200200602     I*                                                                   187084
031300200602     IDSSDY     E DSDSSDY                                                 187084
031400200602     I*                                                                   187084
031500200602      /EJECT
031600200602     C*================================================================
031700200602     C*  P R O G R A M     S T A R T
031800200602     C*================================================================
031900200602     C*
032000200602     C* INITIALISATION
032100200602     C*
032200200602     C           *LIKE     DEFN SDSN      LASTSE
032300200602     C           *LIKE     DEFN SDET      LASTET
032400200602     C           INVTPK    KLIST
032500200602     C***                  KFLD           NMCY                                                095907
032600200602     C                     KFLD           XNMCY                                               095907
032700200602     C                     KFLD           SITP
032800200602     C/COPY WNCPYSRC,SE2510C001
032900200602     C*
033000200602     C                     EXSR FIRST
033100200602     C*
033200200602     C* READ FIRST RECORD FROM SECEO UNLESS ERROR
033300200602     C*
033400200602     C           *INU7     IFEQ '0'
033500200602     C                     EXSR NEXT
033600200602     C                     END
033700200602     C*
033800200602     C* PROCESS EACH RECORD UNTIL EOF OR DATABASE ERROR
033900200602     C*
034000200602     C           *IN22     DOWEQ'0'
034100200602     C           *INU7     ANDEQ'0'
034200200602     C*
034300200602     C                     EXSR PROCES
034400200602     C*
034500200602     C*    READ NEXT RECORD FROM SECEO
034600200602     C*
034700200602     C                     EXSR NEXT
034800200602     C*
034900200602     C                     END
035000200602     C*
035100200602      ** Delete all records (still existing in PRICED) that have no                           197419
035200200602      ** correspondent in SECTYD (already deleted).                                           197419
035300200602      *                                                                                       197419
035400200602     C           *INU7     IFEQ '0'                                                           197419
035500200602     C                     READ PRICED                   32                                   197419
035600200602     C           *IN32     DOWEQ'0'                                                           197419
035700200602     C           RECI      IFEQ '*'                                                           197419
035800200602     C           PSSN      CHAINSECTYDF              31                                       197419
035900200602     C           *IN31     IFEQ '1'                                                           197419
036000200602     C           PDROP     ADD  1         PDROP                                               197419
036100200602     C                     EXSR PR02                                                          197419
036200200602     C                     DELETPRICEDF                                                       197419
036300200602     C                     ENDIF                                                              197419
036400200602     C                     ENDIF                                                              197419
036500200602     C                     READ PRICED                   32                                   197419
036600200602     C                     ENDDO                                                              197419
036700200602     C                     ENDIF                                                              197419
036800200602      *                                                                                       197419
036900200602     C* IF NO DATABASE ERRORS .....
037000200602     C*
037100200602     C           *INU7     IFEQ '0'
037200200602     C*
037300200602     C*****UPDATE*AUDIT*FILES*(SEDEVA/SNDEVA)**************************                       197419
037400200602      *                                                                                       197419
037500200602      ** Update Audit Files (SEDEVA/SNDEVA/PRICEA)                                            197419
037600200602     C*
037700200602     C                     EXSR AUDIT
037800200602     C*
037900200602     C                     END
038000200602     C*                                                                   E29170
038100200602     C** END OF JOB                                                       E29170
038200200602     C*                                                                   E29170
038300200602     C           ENDPGM    TAG                             *** ENDPGM  ***E29170
038400200602     C/COPY WNCPYSRC,SE2510C010
038500200602     C*
038600200602     C* PRINT CONTROL TOTALS REPORT OR ERROR MESSAGE
038700200602     C*
038800200602     C                     EXSR PRINT
038900200602     C***********                                                         E29170
039000200602     C**END*OF*JOB*****************************************************   E29170
039100200602     C***********                                                         E29170
039200200602     C***********ENDPGM    TAG                             *** ENDPGM  ***E29170
039300200602     C                     SETON                     LR
039400200602     C*
039500200602     C*================================================================
039600200602     C*  P R O G R A M     E N D
039700200602     C*================================================================
039800200602      /EJECT
039900200602     C*****************************************************************
040000200602     C*                                                               *
040100200602     C* F I R S T  - INITIALISATION SUBROUTINE                        *
040200200602     C* ---------                                                     *
040300200602     C*  CALLED BY : MAIN PROCESSING                                  *
040400200602     C*  CALLS     : ZSYSTM; ZICD2; ZICDSE                            *
040500200602     C*                                                               *
040600200602     C*****************************************************************
040700200602     C*
040800200602     C           FIRST     BEGSR                           **FIRST BEGSR**
040900200602     C*
041000200602     C* PREPARE LDA
041100200602     C*
041200200602     C           *NAMVAR   DEFN           LDA                             S01117
041300200602     C           *LOCK     IN   LDA                                       S01117
041400200602     C                     MOVEL*BLANK    DBLOT
041500200602     C                     MOVEL'SE2510'  DBPGM
041600200602     C                     OUT  LDA                                       S01117
041700200602     C*
041800200602     C*  ZEROISE ACCUMULATORS
041900200602     C*
042000200602     C                     Z-ADD0         ETOTI   50
042100200602     C**********           Z-ADD0         NTOTI   50                                          247420
042200200602     C                     Z-ADD0         NTOTI   70                                          247420
042300200602     C                     Z-ADD0         NTOTI7  70                                          243026
042400200602     C                     Z-ADD0         EDROP   50
042500200602     C**********           Z-ADD0         NDROP   50                                          247420
042600200602     C                     Z-ADD0         NDROP   70                                          247420
042700200602     C                     Z-ADD0         NDROP7  70                                          243026
042800200602     C                     Z-ADD0         PDROP   50                                          197419
042900200602     C*
043000200602     C                     MOVEL*HIVAL    SESN
043100200602     C*
043200200602     C*  ACCESS ICD 1 (TABTB10)
043300200602     C*
043400200602     C                     EXSR ZSYSTM
043500200602     C*
043600200602     C* ERROR IN ZSYSTM
043700200602     C*
043800200602     C           *IN,99    IFEQ '1'
043900200602     C           *LOCK     IN   LDA                                       S01117
044000200602     C                     MOVE '1'       *INU7
044100200602     C                     MOVE '1'       *INU8            ***************
044200200602     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
044300200602     C                     Z-ADD1         DBASE            **DB ERROR 01**S01117
044400200602     C                     MOVEL'TABLE'   DBFILE           ***************
044500200602     C                     MOVELZTABKY    DBKEY
044600200602     C                     OUT  LDA                                       S01117
044700200602     C                     EXSR *PSSR                                     S01117
044800200602     C*
044900200602     C                     END
045000200602     C*
045100200602     C*  ACCESS ICD 2 (TABTB11)
045200200602     C*
045300200602     C           *INU8     IFNE '1'
045400200602     C*
045500200602     C                     EXSR ZICD2
045600200602     C*
045700200602     C* ERROR IN ZICD2
045800200602     C*
045900200602     C           *INU8     IFEQ '1'                        ***************
046000200602     C           *LOCK     IN   LDA                        ***************S01117
046100200602     C***********          MOVEL'02'      DBASE            **DB ERROR 02**S01117
046200200602     C                     Z-ADD2         DBASE            **DB ERROR 02**S01117
046300200602     C                     MOVEL'TABLE'   DBFILE           ***************
046400200602     C                     MOVELTKEY      DBKEY
046500200602     C                     OUT  LDA                                       S01117
046600200602     C                     EXSR *PSSR                                     S01117
046700200602     C*
046800200602     C                     END
046900200602     C*
047000200602     C                     END
047100200602     C*
047200200602     C*  ACCESS ICD FOR SE (TABTB36)
047300200602     C*
047400200602     C           *INU8     IFNE '1'
047500200602     C*
047600200602     C                     EXSR ZICDSE
047700200602     C*
047800200602     C* ERROR IN ZICDSE
047900200602     C*
048000200602     C           *INU8     IFEQ '1'                        ***************
048100200602     C           *LOCK     IN   LDA                        ***************S01117
048200200602     C***********          MOVEL'03'      DBASE            **DB ERROR 03**
048300200602     C                     Z-ADD3         DBASE            **DB ERROR 03**
048400200602     C                     MOVEL'TABLE'   DBFILE           ***************
048500200602     C                     MOVELTKEY      DBKEY
048600200602     C                     OUT  LDA                                       S01117
048700200602     C                     EXSR *PSSR                                     S01117
048800200602     C*
048900200602     C                     END
049000200602     C*
049100200602     C                     END
049200200602     C*                                                                   187084
049300200602     C**  Check if Jyske Enhancements is installed                        187084
049400200602     C*                                                                   187084
049500200602     C                     CALL 'AOSARDR0'                                187084
049600200602     C                     PARM *BLANKS   WLRTCD  7                       187084
049700200602     C                     PARM '*VERIFY' WLOPTN  7                       187084
049800200602     C                     PARM 'S01496'  WLSARD  6                       187084
049900200602     C*                                                                   187084
050000200602     C           WLRTCD    IFEQ *BLANK                                    187084
050100200602     C                     MOVE 'Y'       S01496  1                       187084
050200200602     C                     END                                            187084
050300200602     C*                                                                   187084
050400200602     C**  Check if Corporate Action is installed                          187084
050500200602     C*                                                                   187084
050600200602     C                     CALL 'AOSARDR0'                                187084
050700200602     C                     PARM *BLANKS   WLRTCD  7                       187084
050800200602     C                     PARM '*VERIFY' WLOPTN  7                       187084
050900200602     C                     PARM 'CSE007'  WLSARD  6                       187084
051000200602     C*                                                                   187084
051100200602     C           WLRTCD    IFEQ *BLANK                                    187084
051200200602     C                     MOVE 'Y'       CSE007  1                       187084
051300200602     C                     END                                            187084
051400200602      *                                                                   187084
051500200602      **  Check if Securities Redenomination is installed                 187084
051600200602      *                                                                   187084
051700200602     C                     MOVE 'N'       CEU017  1                       187084
051800200602     C                     CALL 'AOSARDR0'                                187084
051900200602     C                     PARM *BLANKS   WLRTCD  7                       187084
052000200602     C                     PARM '*VERIFY' WLOPTN  7                       187084
052100200602     C                     PARM 'CEU017'  WLSARD  6                       187084
052200200602      *                                                                   187084
052300200602     C           WLRTCD    IFEQ *BLANK                                    187084
052400200602     C                     MOVE 'Y'       CEU017                          187084
052500200602     C                     ENDIF                                          187084
052600200602      *                                                                   187084
052700200602      ** Check if CSE023 - Treaty Withholding Tax present                 187084
052800200602      *                                                                   187084
052900200602     C                     MOVE 'N'       CSE023  1                       187084
053000200602     C                     CALL 'AOSARDR0'                                187084
053100200602     C                     PARM *BLANKS   @RTCD   7                       187084
053200200602     C                     PARM '*VERIFY' @OPTN   7                       187084
053300200602     C                     PARM 'CSE023'  @SARD   6                       187084
053400200602      *                                                                   187084
053500200602     C           @RTCD     IFEQ *BLANK                                    187084
053600200602     C                     MOVE 'Y'       CSE023                          187084
053700200602     C           31        MULT 18        @MINR   30                      187084
053800200602     C                     ENDIF                                          187084
053900200602     C*                                                                   187084
054000200602     C**   ACCESS SECURITIES TRADING DETAIL                               187084
054100200602     C*                                                                   187084
054200200602     C                     CALL 'AOSTRDR0'                                187084
054300200602     C                     PARM *BLANKS   @RTCD   7                       187084
054400200602     C                     PARM '*FIRST ' @OPTN   7                       187084
054500200602     C           SDSTRD    PARM SDSTRD    DSSDY                           187084
054600200602     C*                                                                   187084
054700200602     C           @RTCD     IFNE *BLANK                                    187084
054800200602     C           *LOCK     IN   LDA                                       187084
054900200602     C                     MOVEL'SDSTRDPD'DBFILE           ***************187084
055000200602     C                     MOVEL@OPTN     DBKEY            * DB ERROR 08 *187084
055100200602     C                     Z-ADD8         DBASE            ***************187084
055200200602     C                     OUT  LDA                                       187084
055300200602     C                     EXSR *PSSR                                     187084
055400200602     C                     ENDIF                                          187084
055500200602     C*                                                                   187084
055600200602     C* Calculate Retention date for position settlement                  187084
055700200602     C*                                                                   187084
055800200602     C           S01496    IFNE 'Y'                                       187084
055900200602     C           CSE007    ANDNE'Y'                                       187084
056000200602     C           CEU017    ANDNE'Y'                                       187084
056100200602     C           31        MULT RTST      WK3N    50                      187084
056200200602     C                     ELSE                                           187084
056300200602     C           31        MULT BVROPS    WK3N    50                      187084
056400200602     C                     END                                            187084
056500200602     C*
056600200602     C*  CALCULATE RETENTION DATE
056700200602     C*
056800200602     C           *INU8     IFNE '1'
056900200602     C*
057000200602     C           RTDE      MULT 31        WDAYS   50
057100200602     C*                                                                   187084
057200200602     C** If CSE023 is present, then ensure event not being drop before    187084
057300200602     C** position settlement.                                             187084
057400200602     C*                                                                   187084
057500200602     C           CSE023    IFEQ 'Y'                                       187084
057600200602     C           WK3N      IFLT @MINR                                     187084
057700200602     C                     Z-ADD@MINR     WK3N                            187084
057800200602     C                     ENDIF                                          187084
057900200602     C           WK3N      IFGT WDAYS                                     187084
058000200602     C                     Z-ADDWK3N      WDAYS                           187084
058100200602     C                     ENDIF                                          187084
058200200602     C                     ENDIF                                          187084
058300200602     C*                                                                   187084
058400200602     C           RUND      SUB  WDAYS     WDATE   50
058500200602     C*
058600200602     C*  CALCULATE BACK VALUE DATE
058700200602     C*
058800200602     C           RUND      SUB  BKVP      WADATE  50
058900200602      *                                                                   S11029
059000200602      ***  If Backvalue Date is after End of Last Year, then change       S11029
059100200602      ***  it to Beginning of Year, (done for Cost of Funds Report).      S11029
059200200602      *                                                                   S11029
059300200602     C           WADATE    IFGT LEOY                                      S11029
059400200602     C           LEOY      ADD  1         WADATE                          S11029
059500200602     C                     ENDIF                                          S11029
059600200602     C*
059700200602     C                     END
059800200602     C/COPY WNCPYSRC,SE2510C002
059900200602     C*
060000200602     C                     ENDSR                           **START ENDSR**
060100200602     C*****************************************************************
060200200602      /EJECT
060300200602     C*****************************************************************
060400200602     C*                                                               *
060500200602     C* P R O C E S  - PROCESS EACH INPUT RECORD ON SECEO             *
060600200602     C* -----------                                                   *
060700200602     C*    CALLED BY : MAIN PROCESSING                                *
060800200602     C*    CALLS     : DROP                                           *
060900200602     C*                                                               *
061000200602     C*****************************************************************
061100200602     C*
061200200602     C           PROCES    BEGSR                           **PROCES BEGSR**
061300200602     C*
061400200602     C                     MOVEA'0'       *IN,30
061500200602     C/COPY WNCPYSRC,SE2510C003
061600200602     C*
061700200602     C           RECI      IFEQ 'R'
061800200602     C*
061900200602     C                     MOVEA'1'       *IN,30
062000200602     C*
062100200602     C                     END
062200200602     C*
062300200602     C           RECI      IFEQ '*'                                                           095907
062400200602     C*                                                                                       095907
062500200602     C                     MOVEA'1'       *IN,30                                              095907
062600200602     C*                                                                                       095907
062700200602     C                     END                                                                095907
062800200602     C*                                                                                       095907
062900200602     C* DROP SNDEVD RECORD IF EVENT DATE IS EARLIER RETENTION DATE                            095907
063000200602     C*                                                                                       095907
063100200602     C           RECI      IFEQ 'D'                                                           095907
063200200602     C           *IN21     IFEQ '1'                                                           095907
063300200602     C           SDSN      ANDNELASTSE                                                        095907
063400200602     C           SDSN      CHAINSECTYDF              31                                       095907
063500200602     C           *IN31     IFEQ '1'                                                           095907
063600200602     C           *IN,31    OREQ '0'                                                           095907
063700200602     C           RECIS     ANDEQ'*'                                                           095907
063800200602     C                     MOVEA'1'       *IN,30                                              095907
063900200602     C                     ELSE                                                               095907
064000200602     C           SDED      IFLT WDATE                                                         095907
064100200602     C                     MOVEA'1'       *IN,30                                              095907
064200200602     C                     END                                                                095907
064300200602     C                     END                                                                095907
064400200602     C                     END                                                                095907
064500200602     C                     END                                                                095907
064600200602     C*
064700200602     C*                                                                                       095907
064800200602     C           SDSN      IFEQ LASTSE                                                        095907
064900200602     C           *IN31     IFEQ '1'                                                           095907
065000200602     C                     MOVEA'1'       *IN,30                                              095907
065100200602     C                     ELSE                                                               095907
065200200602     C           SDED      IFLT WDATE                                                         095907
065300200602     C                     MOVEA'1'       *IN,30                                              095907
065400200602     C                     END                                                                095907
065500200602     C                     END                                                                095907
065600200602     C                     END                                                                095907
065700200602     C*                                                                                       095907
065800200602     C           RECI      IFEQ 'M'
065900200602     C           RECI      OREQ 'D'                                       092129
066000200602     C           *IN21     ANDEQ'1'                                       092129
066100200602     C*************************************************************       071067
066200200602     C**Ignore*if*event*type*'XR'*and*event*date*0*for*Diary*events       071067
066300200602     C*************************************************************       071067
066400200602     C************IN20     IFEQ '1'                                       071067
066500200602     C***********SDET      ANDEQ'XR'                                      071067
066600200602     C***********SDED      ANDEQ*ZEROS                                    071067
066700200602     C***********          GOTO EPROC                                     071067
066800200602     C***********          END                                            071067
066900200602     C*
067000200602     C* IF SECURITY HAS RECI=*, EVENTS 'XR' MUST ALSO BE DROPPED                              095907
067100200602     C* STORE REQUIRED DATA
067200200602     C*
067300200602     C* GET SECURITY RECORD IF NOT ALREADY READ
067400200602     C*
067500200602     C           SDSN      IFNE SESN
067600200602     C           SDSN      CHAINSECTYDF              31
067700200602     C*
067800200602     C           *IN,31    IFEQ '0'
067900200602     C***********RECI      ANDEQ'*'                                                           095907
068000200602     C           RECIS     ANDEQ'*'                                                           095907
068100200602     C                     MOVEA'1'       *IN,31
068200200602     C                     END
068300200602     C*
068400200602     C                     END
068500200602     C*
068600200602     C* IF NOT THERE, DROP EVENT
068700200602     C*
068800200602     C           *IN,31    IFEQ '1'
068900200602     C                     MOVEA'1'       *IN,30
069000200602     C                     ELSE
069100200602     C*                                                                   071067
069200200602     C           *IN20     IFEQ '1'                                       071067
069300200602     C           SDET      ANDEQ'XR'                                      071067
069400200602     C           SDED      ANDEQ*ZEROS                                    071067
069500200602     C                     GOTO EPROC                                     071067
069600200602     C                     ELSE                                           071067
069700200602     C*
069800200602     C* DROP IF EVENT DATE EARLIER THAN RETENTION DATE
069900200602     C*
070000200602     C           SDED      IFLT WDATE
070100200602     C           RECI      OREQ '*'                                                           095907
070200200602     C                     MOVEA'1'       *IN,30
070300200602     C*
070400200602     C           SDET      IFEQ 'IR'
070500200602     C           SDET      OREQ 'PP'
070600200602     C           SDET      OREQ 'MP'
070700200602     C           SDET      OREQ 'CP'
070800200602     C           SDET      OREQ 'PR'
070900200602     C           SDET      OREQ 'AL'                                                         BUG9848
071000200602     C/COPY WNCPYSRC,SE2510C007
071100200602     C*
071200200602     C* EVENT DATE MUST ALSO BE EARLIER THAN COUPON DATE FOR THESE TYPES
071300200602     C* (& NOT FIRST EVENT TYPE FOR THIS SECURITY WITH EVENT DATE LT
071400200602     C*  BACK VALUE DATE)
071500200602     C*
071600200602     C           SDED      IFGE LCPN
071700200602     C           LCPN      ANDNE0                                                             247420
071800200602     C                     MOVEA'0'       *IN,30
071900200602     C                     ELSE
072000200602     C*
072100200602     C           LASTSE    IFNE *BLANKS                                                       095907
072200200602     C           LASTET    ORNE *BLANKS                                                       095907
072300200602     C           LASTSE    IFNE SDSN
072400200602     C           LASTET    ORNE SDET
072500200602     C                     SETOF                     25
072600200602     C                     MOVE SDSN      LASTSE
072700200602     C                     MOVE SDET      LASTET
072800200602     C                     END
072900200602     C                     END                                                                095907
073000200602     C           *IN25     IFEQ '0'
073100200602     C                     MOVEA'0'       *IN,30
073200200602     C                     END
073300200602     C           *IN25     IFEQ '1'
073400200602     C           SDED      ANDGTWADATE
073500200602     C                     MOVEA'0'       *IN,30
073600200602     C                     END
073700200602     C           SDED      IFLT WADATE
073800200602     C                     SETON                     25
073900200602     C                     END
074000200602     C                     END
074100200602     C*
074200200602     C** If security still valid, do not drop initial value record        E44166
074300200602     C** of any event type on file SEDEVD.                                E44166
074400200602     C*                                                                   E44166
074500200602     C           *IN20     IFEQ '1'                                                           247420
074600200602     C                     MOVELSDNV      NARRAT  7                       E44166
074700200602     C           NARRAT    IFEQ 'INITIAL'                                 E44166
074800200602     C                     MOVEA'0'       *IN,30                          E44166
074900200602     C                     END                                            E44166
075000200602     C                     ENDIF                                                              247420
075100200602     C*                                                                   E44166
075200200602     C                     END
075300200602     C*
075400200602     C                     END
075500200602     C*                                                                   071067
075600200602     C                     END                                            071067
075700200602     C*
075800200602     C                     END
075900200602     C*
076000200602     C                     END
076100200602     C*
076200200602     C* IF *IN30 ON, RECORD IS TO BE DROPPED
076300200602     C*
076400200602     C           *IN,30    IFEQ '1'
076500200602     C** AS RECORDS ARE NOW DELETED, PROCESS PRINT FIRST                                      095907
076600200602     C************         EXSR DROP                                                          095907
076700200602     C                     EXSR PR01
076800200602     C                     EXSR DROP                                                          095907
076900200602     C                     END
077000200602     C*
077100200602     C           EPROC     ENDSR                           **PROCES ENDSR**
077200200602     C*****************************************************************
077300200602      /EJECT
077400200602     C*****************************************************************
077500200602     C*                                                               *
077600200602     C* D R O P    - FLAG A RECORD TO BE DROPPED                      *
077700200602     C* -------                                                       *
077800200602     C*  CALLED BY : PROCES                                           *
077900200602     C*  CALLS     : NO SUBROUTINES                                   *
078000200602     C*                                                               *
078100200602     C*****************************************************************
078200200602     C*
078300200602     C           DROP      BEGSR                           **DROP BEGSR**
078400200602     C*
078500200602     C* INCREMENT CONTROL TOTALS                                                              095907
078600200602     C*                                                                                       095907
078700200602     C           *IN,20    IFEQ '1'                                                           095907
078800200602     C           RECI      IFNE '*'                                                           095907
078900200602     C           EDROP     ADD  1         EDROP                                               095907
079000200602     C                     END                                                                095907
079100200602     C                     ELSE                                                               095907
079200200602     C           RECI      IFNE '*'                                                           095907
079300200602     C           NDROP     ADD  1         NDROP                                               095907
079400200602     C***********NDROP6    ADD  1         NDROP6                                       095907 243026
079500200602     C           NDROP7    ADD  1         NDROP7                                              243026
079600200602     C                     END                                                                095907
079700200602     C                     END                                                                095907
079800200602     C*                                                                                       095907
079900200602     C*
080000200602     C                     MOVEL'*'       RECI
080100200602     C*
080200200602     C           *IN,20    IFEQ '1'
080300200602     C/COPY WNCPYSRC,SE2510C011
080400200602     C****                 UPDATSEDEVDF                                                       095907
080500200602     C                     DELETSEDEVDF                                                       095907
080600200602     C                     ELSE
080700200602     C****                 UPDATSNDEVDF                                                       095907
080800200602     C                     DELETSNDEVDF                                                       095907
080900200602     C                     END
081000200602     C*
081100200602     C* INCREMENT CONTROL TOTALS
081200200602     C*
081300200602     C***        *IN,20    IFEQ '1'                                                           095907
081400200602     C***        EDROP     ADD  1         EDROP                                               095907
081500200602     C***                  ELSE                                                               095907
081600200602     C***        RECI      IFNE '*'                                                    172190 095907
081700200602     C***        NDROP     ADD  1         NDROP                                               095907
081800200602     C***                  END                                                         172190 095907
081900200602     C***                  END                                                                095907
082000200602     C*
082100200602     C                     ENDSR                           **DROP ENDSR**
082200200602     C*****************************************************************
082300200602      /EJECT
082400200602     C*****************************************************************
082500200602     C*                                                               *
082600200602     C* P R 0 1    - OUTPUT DETAIL REPORT                             *
082700200602     C* ---------                                                     *
082800200602     C*  CALLED BY : MAIN PROCESSING                                  *
082900200602     C*  CALLS     : ZDATE2. ZSEDIT                                   *
083000200602     C*                                                               *
083100200602     C*****************************************************************
083200200602     C*
083300200602     C           PR01      BEGSR                           **PR01  BEGSR**
083400200602     C*
083500200602      *     OPEN OUTPUT FILE IF REQUIRED
083600200602     C*
083700200602     C           *IN55     IFEQ '0'
083800200602     C                     SETON                     55
083900200602     C                     Z-ADD70        LINCNT  20
084000200602     C                     OPEN SE2510P1
084100200602     C*                                                                   E29170
084200200602     C** RCF Processing for Detail Printer File                           E29170
084300200602     C*                                                                   E29170
084400200602     C                     EXSR RCFP1                                     E29170
084500200602     C                     END
084600200602      *
084700200602      *     PRINT PAGE HEADINGS
084800200602      *
084900200602     C           LINCNT    IFGT 40
085000200602     C                     Z-ADD0         LINCNT
085100200602     C                     WRITEHEADP1
085200200602     C                     END
085300200602      *
085400200602      * FORMAT OUTPUT & PRINT
085500200602      * FIRST LINE   ***
085600200602      *
085700200602      * SECURITY SHORTNAME
085800200602      *
085900200602     C                     SETOF                     80
086000200602     C           SDSN      IFNE ZSDSN
086100200602     C                     SETON                     80
086200200602     C                     MOVE SDSN      ZSDSN  10
086300200602     C                     END
086400200602      *
086500200602      * FORMAT EVENT DATE
086600200602      *
086700200602     C                     MOVE *BLANK    ZASDED
086800200602     C                     Z-ADDSDED      ZDAYNO
086900200602     C                     EXSR ZDATE2
087000200602     C                     MOVE ZADATE    ZASDED
087100200602      *
087200200602      * FORMAT EVENT DESCRIPTION USING TABLE
087300200602      *
087400200602     C                     SETOF                     59
087500200602     C           SDET      LOKUPTABEVT    TABLEG         59
087600200602     C           *IN59     IFEQ '0'
087700200602     C                     MOVE *BLANK    LSDET  14
087800200602     C                     ELSE
087900200602     C                     MOVE TABLEG    LSDET
088000200602     C                     END
088100200602     C/COPY WNCPYSRC,SE2510C004
088200200602      *
088300200602      * FORMAT CURRENCY FOR EXCH. RATE CHG/CONVERSION ONLY
088400200602      *
088500200602     C                     MOVE *BLANK    ZSDCX
088600200602     C           SDET      IFEQ 'XR'
088700200602     C           SDET      OREQ 'CV'
088800200602     C                     MOVELSDCX      ZSDCX
088900200602     C                     END
089000200602      *
089100200602      * FORMAT AMOUNT/SECURITY EVENT - DV,PP,MP,RC,RP AND CV
089200200602      *
089300200602     C                     SETOF                     606162
089400200602     C                     SETOF                     636465
089500200602     C                     SETOF                     666768
089600200602     C                     SETOF                     69
089700200602      *
089800200602      *    DIVIDEND
089900200602      *
090000200602     C           SDET      IFEQ 'DV'
090100200602     C                     SETON                     60
090200200602     C                     ELSE
090300200602      *
090400200602      *    P.P.CALL PROC TYPE = 4
090500200602      *
090600200602     C           SDET      IFEQ 'PP'
090700200602     C           *IN31     IFEQ '0'
090800200602      *
090900200602      *    READ INVTPD FILE USING KEY
091000200602      *
091100200602     C           INVTPK    CHAININVTPDF              58
091200200602     C           *IN58     IFEQ '1'
091300200602     C                     MOVEL'1'       *INU8
091400200602     C                     MOVEL'1'       *INU7
091500200602     C           *LOCK     IN   LDA                                       S01117
091600200602     C***********          MOVEL'09'      DBASE            **DB ERROR 09**S01117
091700200602     C                     Z-ADD9         DBASE            **DB ERROR 09**S01117
091800200602     C                     MOVEL'INVTPD'  DBFILE
091900200602     C****                 MOVELNMCY      DBKEY6  6                                           095907
092000200602     C                     MOVELXNMCY     DBKEY6  6                                           095907
092100200602     C                     MOVE SITP      DBKEY6
092200200602     C                     MOVELDBKEY6    DBKEY
092300200602     C                     OUT  LDA                                       S01117
092400200602     C                     EXSR *PSSR                                     S01117
092500200602     C***********          WRITEHEADER                                    E29170
092600200602     C***********          WRITEERROR                                     E29170
092700200602     C***********          WRITETRAILER                                   E29170
092800200602     C                     GOTO ENDPGM
092900200602     C                     END
093000200602     C                     END
093100200602      *
093200200602      *   PROC TYPE 04
093300200602      *
093400200602     C           PROT      IFEQ '4'
093500200602     C                     SETON                     61
093600200602     C           *IN31     IFEQ '0'
093700200602      *
093800200602      *   DEC.PLACES CDP TABTG10 FOR ZDECS
093900200602      *
094000200602     C                     MOVEL'20      'TKEY
094100200602      *
094200200602      *   CURRENCY NMCY - SECTY (NMDP)
094300200602      *
094400200602     C***                  MOVELNMCY      ZWK4    4                                           095907
094500200602     C                     MOVELXNMCY     ZWK4    4                                           095907
094600200602     C                     MOVE 1         ZWK4
094700200602     C                     MOVE ZWK4      TKEY
094800200602     C                     MOVE '1'       TKEY
094900200602     C           TKEY      CHAINTABTG10F             56
095000200602     C           *IN56     IFEQ '0'
095100200602     C           RECI      IFEQ '*'
095200200602     C                     SETON                     56
095300200602     C                     END
095400200602     C                     END
095500200602     C           *IN56     IFEQ '1'
095600200602     C                     MOVEL'1'       *INU8
095700200602     C                     MOVEL'1'       *INU7
095800200602     C           *LOCK     IN   LDA                                       S01117
095900200602     C***********          MOVEL'10'      DBASE            **DB*ERROR*10**E20651
096000200602     C***********          MOVEL'11'      DBASE            **DB 11*E20651 S01117
096100200602     C                     Z-ADD11        DBASE            **DB ERROR 11**S01117
096200200602     C                     MOVEL'TABLE'   DBFILE
096300200602     C                     MOVELTKEY      DBKEY
096400200602     C                     OUT  LDA                                       S01117
096500200602     C                     EXSR *PSSR                                     S01117
096600200602     C***********          WRITEHEADER                                    E29170
096700200602     C***********          WRITEERROR                                     E29170
096800200602     C***********          WRITETRAILER                                   E29170
096900200602     C                     GOTO ENDPGM
097000200602     C                     END
097100200602      *
097200200602     C                     Z-ADDCDP       ZDECS
097300200602     C                     ELSE
097400200602     C                     Z-ADD0         ZDECS
097500200602     C                     END
097600200602      *
097700200602     C                     Z-ADDSDPP      ZFLD15
097800200602     C                     MOVE 'J'       ZECODE
097900200602     C                     EXSR ZSEDIT
098000200602     C                     MOVE ZOUT21    ZESDPP 21
098100200602     C                     ELSE
098200200602      *
098300200602      *   PROC NOT TYPE 04
098400200602      *
098500200602     C                     SETON                     62
098600200602      *
098700200602      *   PROC 4 END NEXT
098800200602      *
098900200602     C                     END
099000200602     C                     ELSE
099100200602      *
099200200602      *   MORT.PAYT. EVENT TYPE
099300200602      *
099400200602     C           SDET      IFEQ 'MP'
099500200602     C                     SETON                     63
099600200602     C           SRPT      IFNE 0
099700200602     C           *IN31     IFEQ '0'
099800200602      *
099900200602      *   DEC.PLACES CDP TABTG10 FOR ZDECS
100000200602      *
100100200602     C                     MOVEL'20      'TKEY
100200200602      *
100300200602      *   CURRENCY NMCY - SEDEVD,NMDP - TABTG10 (NMCY ADDED TO SEDEVD)
100400200602      *
100500200602     C                     MOVELNMCY      ZWK4    4
100600200602     C                     MOVE 1         ZWK4
100700200602     C                     MOVE ZWK4      TKEY
100800200602     C           TKEY      CHAINTABTG10F             56
100900200602     C           *IN56     IFEQ '0'
101000200602     C           RECI      IFEQ '*'
101100200602     C                     SETON                     56
101200200602     C                     END
101300200602     C                     END
101400200602     C           *IN56     IFEQ '1'
101500200602     C                     MOVEL'1'       *INU8
101600200602     C                     MOVEL'1'       *INU7
101700200602     C           *LOCK     IN   LDA                                       S01117
101800200602     C***********          MOVEL'10'      DBASE            **DB*ERROR*10**E20651
101900200602     C***********          MOVEL'12'      DBASE            **DB 12*E20651 S01117
102000200602     C                     Z-ADD12        DBASE            **DB ERROR 12**S01117
102100200602     C                     MOVEL'TABLE'   DBFILE
102200200602     C                     MOVELTKEY      DBKEY
102300200602     C                     OUT  LDA                                       S01117
102400200602     C                     EXSR *PSSR                                     S01117
102500200602     C***********          WRITEHEADER                                    E29170
102600200602     C***********          WRITEERROR                                     E29170
102700200602     C***********          WRITETRAILER                                   E29170
102800200602     C                     GOTO ENDPGM
102900200602     C                     END
103000200602      *
103100200602     C                     Z-ADDCDP       ZDECS
103200200602     C                     ELSE
103300200602     C                     Z-ADD0         ZDECS
103400200602     C                     END
103500200602      *
103600200602     C                     Z-ADDSRPT      ZFLD15
103700200602     C                     MOVE 'J'       ZECODE
103800200602     C                     EXSR ZSEDIT
103900200602     C                     MOVE ZOUT21    ZESRPT 19
104000200602      *
104100200602      *   SRPT IS ZERO
104200200602      *
104300200602     C                     ELSE
104400200602     C                     MOVE *BLANK    ZESRPT
104500200602      *
104600200602      *   SRPT IS ZERO END NEXT
104700200602      *
104800200602     C                     END
104900200602     C                     ELSE
105000200602      *
105100200602      *   RED.CALL RED.PUT EVENT TYPE
105200200602      *
105300200602     C           SDET      IFEQ 'RC'
105400200602     C                     SETON                     64
105500200602     C           SDPP      IFNE 0
105600200602     C                     Z-ADD0         ZDECS
105700200602      *
105800200602     C                     Z-ADDSDPP      ZFLD15
105900200602     C                     MOVE 'J'       ZECODE
106000200602     C                     EXSR ZSEDIT
106100200602     C                     MOVE ZOUT21    ZEPPRC 20
106200200602      *
106300200602      *   SDPP IS ZERO
106400200602      *
106500200602     C                     ELSE
106600200602     C                     MOVE *BLANK    ZEPPRC
106700200602      *
106800200602      *   SDPP IS ZERO END NEXT
106900200602      *
107000200602     C                     END
107100200602     C                     ELSE
107200200602      *
107300200602      *   RED.PUT EVENT TYPE
107400200602      *
107500200602     C           SDET      IFEQ 'RP'
107600200602     C                     SETON                     65
107700200602     C           SDPP      IFNE 0
107800200602     C                     Z-ADD0         ZDECS
107900200602      *
108000200602     C                     Z-ADDSDPP      ZFLD15
108100200602     C                     MOVE 'J'       ZECODE
108200200602     C                     EXSR ZSEDIT
108300200602     C                     MOVE ZOUT21    ZEPPRP 20
108400200602      *
108500200602      *   SDPP IS ZERO
108600200602      *
108700200602     C                     ELSE
108800200602     C                     MOVE *BLANK    ZEPPRP
108900200602      *
109000200602      *   SDPP IS ZERO END NEXT
109100200602      *
109200200602     C                     END
109300200602     C                     ELSE
109400200602      *
109500200602      * CONVERSION SECURITY EVENT TYPE
109600200602      *
109700200602     C           SDET      IFEQ 'CV'
109800200602     C                     SETON                     66
109900200602      *
110000200602      *   EVENT TYPE ENDS
110100200602      *
110200200602     C                     END
110300200602     C                     END
110400200602     C                     END
110500200602     C                     END
110600200602     C                     END
110700200602     C                     END
110800200602      *
110900200602      * FORMAT PAYMENT DATE
111000200602      *
111100200602     C                     MOVE *BLANK    ZASDPD
111200200602     C           SDET      IFEQ 'DV'
111300200602     C           SDET      OREQ 'MP'
111400200602     C/COPY WNCPYSRC,SE2510C005
111500200602     C                     Z-ADDSDPD      ZDAYNO
111600200602     C                     EXSR ZDATE2
111700200602     C                     MOVE ZADATE    ZASDPD
111800200602     C                     END
111900200602      *
112000200602      * FORMAT FACTOR/PERCENTAGE/RATE
112100200602      *
112200200602     C           SDET      IFEQ 'RC'
112300200602     C                     Z-ADDSDPC      ZPCRC
112400200602     C                     ELSE
112500200602     C           SDET      IFEQ 'RP'
112600200602     C                     Z-ADDSDPC      ZPCRP
112700200602     C                     ELSE
112800200602     C           SDET      IFEQ 'IR'
112900200602     C                     SETON                     67
113000200602     C                     ELSE
113100200602     C           SDET      IFEQ 'XR'
113200200602     C                     SETON                     68
113300200602     C                     Z-ADDSDCE      ZCEXR
113400200602     C/COPY WNCPYSRC,SE2510C008
113500200602     C                     END
113600200602     C                     END
113700200602     C                     END
113800200602     C                     END
113900200602      *
114000200602      * FORMAT CONVERSION REDEMPTION PRICE
114100200602      *
114200200602     C           SDET      IFEQ 'PR'
114300200602     C/COPY WNCPYSRC,SE2510C009
114400200602     C                     SETON                     69
114500200602     C                     END
114600200602      *
114700200602      * FORMAT NARRATIVE
114800200602      *
114900200602     C           *IN21     IFEQ '1'
115000200602     C                     MOVE *BLANKS   NARR
115100200602     C                     MOVELSNNA      NARR
115200200602     C                     ELSE
115300200602     C                     MOVELSDNV      NARR
115400200602     C                     END
115500200602      *
115600200602     C                     ADD  3         LINCNT
115700200602     C                     WRITEDETAIL
115800200602     C                     ENDSR                           **PR01 ENDSR**
115900200602     C*****************************************************************
116000200602      /EJECT
116100200602      *****************************************************************                       197419
116200200602      *                                                               *                       197419
116300200602      * P R 0 2    - Output Detail Report for PRICED                  *                       197419
116400200602      * ---------                                                     *                       197419
116500200602      *  Called By : Main Processing                                  *                       197419
116600200602      *  Calls     : ZDATE2                                           *                       197419
116700200602      *                                                               *                       197419
116800200602      *****************************************************************                       197419
116900200602      *                                                                                       197419
117000200602     C           PR02      BEGSR                           **PR02  BEGSR**                    197419
117100200602     C           *IN57     IFEQ '0'                                                           197419
117200200602     C                     MOVE '1'       *IN57                                               197419
117300200602     C                     Z-ADD70        LINCNT                                              197419
117400200602     C                     ENDIF                                                              197419
117500200602      *                                                                                       197419
117600200602      ** Open output file if required                                                         197419
117700200602      *                                                                                       197419
117800200602     C           *IN55     IFEQ '0'                                                           197419
117900200602     C                     MOVE '1'       *IN55                                               197419
118000200602     C                     Z-ADD70        LINCNT  20                                          197419
118100200602     C                     OPEN SE2510P1                                                      197419
118200200602      *                                                                                       197419
118300200602      ** RCF Processing for Detail Printer File                                               197419
118400200602      *                                                                                       197419
118500200602     C                     EXSR RCFP1                                                         197419
118600200602     C                     ENDIF                                                              197419
118700200602      *                                                                                       197419
118800200602      ** Print page headings                                                                  197419
118900200602      *                                                                                       197419
119000200602     C           LINCNT    IFGT 40                                                            197419
119100200602     C                     Z-ADD0         LINCNT                                              197419
119200200602     C                     WRITEHEADP2                                                        197419
119300200602     C                     ENDIF                                                              197419
119400200602      *                                                                                       197419
119500200602      ** Format output & print                                                                197419
119600200602      ** Format value date                                                                    197419
119700200602      *                                                                                       197419
119800200602     C                     MOVE *BLANK    ZPVDT                                               197419
119900200602     C                     Z-ADDZPVDT     ZDAYNO                                              197419
120000200602     C                     EXSR ZDATE2                                                        197419
120100200602     C                     MOVE ZADATE    ZPVDT                                               197419
120200200602      *                                                                                       197419
120300200602      ** Format event description using table                                                 197419
120400200602      *                                                                                       197419
120500200602     C                     MOVE '0'       *IN59                                               197419
120600200602     C           SDET      LOKUPTABEVT    TABLEG         59                                   197419
120700200602     C           *IN59     IFEQ '0'                                                           197419
120800200602     C                     MOVE *BLANK    LSDET  14                                           197419
120900200602     C                     ELSE                                                               197419
121000200602     C                     MOVE TABLEG    LSDET                                               197419
121100200602     C                     ENDIF                                                              197419
121200200602      *                                                                                       197419
121300200602     C                     ADD  2         LINCNT                                              197419
121400200602      *                                                                                       197419
121500200602     C                     WRITEDETAIL2                                                       197419
121600200602      *                                                                                       197419
121700200602     C                     ENDSR                           **PR02  ENDSR**                    197419
121800200602      *****************************************************************                       197419
121900200602      /EJECT                                                                                  197419
122000200602     C*****************************************************************
122100200602     C*                                                               *
122200200602     C**A*U*D*I*T**-*UPDATE*AUDIT*FILES*-*(SEDEVA/SNDEVA)**************                       197419
122300200602      * A U D I T  - Update audit files - (SEDEVA/SNDEVA/PRICEA)      *                       197419
122400200602     C* ---------                                                     *
122500200602     C*  CALLED BY : MAIN PROCESSING                                  *
122600200602     C*  CALLS     : NO OTHER SUBROUTINES                             *
122700200602     C*                                                               *
122800200602     C*****************************************************************
122900200602     C*
123000200602     C           AUDIT     BEGSR                           **AUDIT BEGSR**
123100200602     C*
123200200602     C           ETOTI     SUB  EDROP     ETOTO
123300200602     C***********NTOTI     SUB  NDROP     NTOTO                                               095907
123400200602     C****       NTOTI     SUB  NDROP     NTOTO   50                                   095907 247420
123500200602     C           NTOTI     SUB  NDROP     NTOTO   70                                          247420
123600200602     C           NTOTI7    SUB  NDROP7    NTOTO7  70                                          243026
123700200602     C*
123800200602     C           1         CHAINSEDEVAF              99
123900200602     C*
124000200602     C           *IN99     IFEQ '1'
124100200602     C           *LOCK     IN   LDA                                       S01117
124200200602     C                     MOVE '1'       *INU7
124300200602     C                     MOVE '1'       *INU8            ***************
124400200602     C***********          MOVEL'04'      DBASE            **DB ERROR 04**S01117
124500200602     C                     Z-ADD4         DBASE            **DB ERROR 04**S01117
124600200602     C                     MOVEL'SEDEVA'  DBFILE           ***************
124700200602     C                     MOVEL'AUDIT'   DBKEY
124800200602     C                     OUT  LDA                                       S01117
124900200602     C                     EXSR *PSSR                                     S01117
125000200602     C                     ELSE
125100200602     C                     Z-ADDNORE      EFILE   50
125200200602     C*
125300200602     C* CHECK CONTROL TOTALS AGREE
125400200602     C*
125500200602     C           ETOTI     IFNE NORE
125600200602     C                     MOVE '1'       *INU8
125700200602     C                     MOVEA'1'       *IN,70
125800200602     C*
125900200602     C                     ELSE
126000200602     C*
126100200602     C* WRITE SEDEVA RECORD
126200200602     C*
126300200602     C                     Z-ADDETOTO     NORE
126400200602AW   C                     Z-ADDETOTO     NLRB
126500200602     C*
126600200602     C                     UPDATSEDEVAF
126700200602     C*
126800200602     C                     END
126900200602     C*
127000200602     C                     END
127100200602     C*
127200200602     C           *INU7     IFEQ '0'
127300200602     C*
127400200602     C           1         CHAINSNDEVAF              99
127500200602     C*
127600200602     C           *IN99     IFEQ '1'
127700200602     C           *LOCK     IN   LDA                                       S01117
127800200602     C                     MOVE '1'       *INU7
127900200602     C                     MOVE '1'       *INU8            ***************
128000200602     C***********          MOVEL'05'      DBASE            **DB ERROR 05**
128100200602     C                     Z-ADD5         DBASE            **DB ERROR 05**
128200200602     C                     MOVEL'SNDEVA'  DBFILE           ***************
128300200602     C                     MOVEL'AUDIT'   DBKEY
128400200602     C                     OUT  LDA                                       S01117
128500200602     C                     EXSR *PSSR                                     S01117
128600200602     C                     ELSE
128700200602     C**********           Z-ADDNORE      NFILE   50                                          247420
128800200602     C                     Z-ADDSNNORE    NFILE   70                                          247420
128900200602     C*
129000200602     C* CHECK CONTROL TOTALS AGREE
129100200602     C*
129200200602     C***********NTOTI     IFNE NORE                                                         243026
129300200602     C****       NFILE7    IFNE NTOTI7                                                243026 247420
129400200602     C           NTOTI     IFNE SNNORE                                                       247420
129500200602     C*
129600200602     C                     MOVE '1'       *INU8
129700200602     C                     MOVEA'1'       *IN,71
129800200602     C*
129900200602     C                     ELSE
130000200602     C*
130100200602     C* WRITE SNDEVA RECORD
130200200602     C*
130300200602     C**********           MOVE NTOTO     NORE                                                247420
130400200602     C                     Z-ADDNTOTO     SNNORE                                              247420
130500200602     C*
130600200602     C                     UPDATSNDEVAF
130700200602     C*
130800200602     C                     END                                         RE
130900200602     C*
131000200602     C                     END
131100200602     C*
131200200602     C                     END
131300200602     C*
131400200602     C                     ENDSR                           **AUDIT ENDSR**
131500200602     C*****************************************************************
131600200602      /EJECT
131700200602     C*****************************************************************
131800200602     C*                                                               *
131900200602     C* P R I N T  - PRINT CONTROL TOTALS OR ERROR REPORT             *
132000200602     C* ---------                                                     *
132100200602     C*  CALLED BY : MAIN PROCESSING                                  *
132200200602     C*  CALLS     : NO OTHER SUBROUTINES                             *
132300200602     C*                                                               *
132400200602     C*****************************************************************
132500200602     C*
132600200602     C           PRINT     BEGSR                           **PRINT BEGSR**
132700200602     C*                                                                   E29170
132800200602     C** RCF Processing for Audit File                                    E29170
132900200602     C*                                                                   E29170
133000200602     C                     EXSR RCFAU                                     E29170
133100200602     C*
133200200602     C                     WRITEHEADER
133300200602     C*
133400200602     C           *INU7     IFEQ '0'
133500200602     C*
133600200602     C                     WRITETOTALS
133700200602     C*                                                                   E29170
133800200602     C           *IN55     IFEQ '0'                                       E29170
133900200602     C           *IN57     ANDEQ'0'                                                           197419
134000200602     C                     WRITENONE                                      E29170
134100200602     C                     END                                            E29170
134200200602     C*
134300200602     C                     ELSE
134400200602     C*
134500200602     C                     WRITEERROR
134600200602     C*
134700200602     C                     END
134800200602     C*
134900200602     C***********          WRITETRAILER                                   E29170
135000200602     C           *IN55     IFEQ '1'
135100200602     C           *INU7     IFEQ '1'                                       E29170
135200200602     C                     WRITEERRORP1                                   E29170
135300200602     C                     END                                            E29170
135400200602     C                     WRITETRAILP1
135500200602     C                     END
135600200602     C*
135700200602     C                     ENDSR                           **PRINT ENDSR**
135800200602     C*****************************************************************
135900200602      /EJECT
136000200602     C*****************************************************************
136100200602     C*                                                               *
136200200602     C* N E X T  - READ NEXT RECORD FROM SECEO AND INCREMENT COUNTER  *
136300200602     C* -------                                                       *
136400200602     C*  CALLED BY : MAIN PROCESSING                                  *
136500200602     C*  CALLS     : NO OTHER SUBROUTINES                             *
136600200602     C*                                                               *
136700200602     C*****************************************************************
136800200602     C*
136900200602     C           NEXT      BEGSR                           **NEXT  BEGSR**
137000200602     C*
137100200602     C                     SETOF                     2021
137200200602     C           *IN,22    IFEQ '0'
137300200602     C                     READ SECEO                    22
137400200602     C*
137500200602     C* IF NOT END OF FILE, ADD TO COUNT OF INPUT DIARY EVENTS
137600200602     C*
137700200602     C           *IN,22    IFEQ '0'
137800200602     C           RECI      ANDNE'*'
137900200602     C   20      ETOTI     ADD  1         ETOTI
138000200602     C   21      NTOTI     ADD  1         NTOTI
138100200602     C   21      NTOTI7    ADD  1         NTOTI7                                             243026
138200200602     C** 21      NFILE7    ADD  1         NFILE7                                       243026247420
138300200602     C                     END
138400200602     C*
138500200602     C           *IN20     IFEQ '1'                                                           095907
138600200602     C           RECI      IFEQ 'D'                                                           095907
138700200602     C           RECI      OREQ 'M'                                                           095907
138800200602     C                     ADD  1         LVREC   50                                          095907
138900200602     C                     END                                                                095907
139000200602     C                     END                                                                095907
139100200602     C*                                                                                       095907
139200200602     C                     END
139300200602     C*
139400200602     C                     ENDSR                           **NEXT  ENDSR**
139500200602     C*
139600200602     C*****************************************************************
139700200602      /EJECT
139800200602     C*****************************************************************
139900200602     C*                                                               *
140000200602     C*  SUBROUTINE FOR SECEO FILE EXCEPTION/ERROR HANDLING           *
140100200602     C*                                                               *
140200200602     C*****************************************************************
140300200602     C*
140400200602     C           CEDSR     BEGSR                           **CEDSR BEGSR**
140500200602     C*
140600200602     C           *LOCK     IN   LDA                                       S01117
140700200602     C                     MOVE '1'       *INU7
140800200602     C                     MOVE '1'       *INU8            ***************
140900200602     C***********          MOVEL'06'      DBASE            **DB ERROR 06**S01117
141000200602     C                     Z-ADD6         DBASE            **DB ERROR 06**S01117
141100200602     C                     MOVEL'SECEO'   DBFILE           ***************
141200200602     C                     MOVELEKEY      DBKEY
141300200602     C                     OUT  LDA                                       S01117
141400200602     C                     EXSR *PSSR                                     S01117
141500200602     C*
141600200602     C                     ENDSR                           ** ENDSR **
141700200602     C*
141800200602     C*****************************************************************
141900200602      /SPACE 3
142000200602     C/COPY WNCPYSRC,SE2510C006
142100200602     C*****************************************************************
142200200602     C*                                                               *
142300200602     C*  SUBROUTINE FOR SEDEVA FILE EXCEPTION/ERROR HANDLING          *
142400200602     C*                                                               *
142500200602     C*****************************************************************
142600200602     C*
142700200602     C           EDASR     BEGSR                           **EDASR BEGSR**
142800200602     C*
142900200602     C           *LOCK     IN   LDA                                       S01117
143000200602     C                     MOVE '1'       *INU7
143100200602     C                     MOVE '1'       *INU8            ***************
143200200602     C***********          MOVEL'07'      DBASE            **DB ERROR 07**S01117
143300200602     C                     Z-ADD7         DBASE            **DB ERROR 07**S01117
143400200602     C                     MOVEL'SEDEVA'  DBFILE           ***************
143500200602     C                     MOVEL'1'       DBKEY
143600200602     C                     OUT  LDA                                       S01117
143700200602     C                     EXSR *PSSR                                     S01117
143800200602     C*
143900200602     C                     ENDSR                           ** ENDSR **
144000200602     C*
144100200602     C*****************************************************************
144200200602      /SPACE 3
144300200602     C*****************************************************************
144400200602     C*                                                               *
144500200602     C*  SUBROUTINE FOR SNDEVA FILE EXCEPTION/ERROR HANDLING          *
144600200602     C*                                                               *
144700200602     C*****************************************************************
144800200602     C*
144900200602     C           NDASR     BEGSR                           **NDASR BEGSR**
145000200602     C*
145100200602     C           *LOCK     IN   LDA                                       S01117
145200200602     C                     MOVE '1'       *INU7
145300200602     C                     MOVE '1'       *INU8            ***************
145400200602     C***********          MOVEL'08'      DBASE            **DB ERROR 08**S01117
145500200602     C                     Z-ADD8         DBASE            **DB ERROR 08**S01117
145600200602     C                     MOVEL'SNDEVA'  DBFILE           ***************
145700200602     C                     MOVEL'1'       DBKEY
145800200602     C                     OUT  LDA                                       S01117
145900200602     C                     EXSR *PSSR                                     S01117
146000200602     C*
146100200602     C                     ENDSR                           ** ENDSR **
146200200602     C*
146300200602      *****************************************************************   S01117
146400200602      /EJECT                                                              S01117
146500200602      *****************************************************************                       197419
146600200602      *                                                               *                       197419
146700200602      *  Subroutine for PRICED file exception/error handling          *                       197419
146800200602      *                                                               *                       197419
146900200602      *****************************************************************                       197419
147000200602      *                                                                                       197419
147100200602     C           PRCSR     BEGSR                           **PRCSR BEGSR**                    197419
147200200602      *                                                                                       197419
147300200602     C           *LOCK     IN   LDA                                                           197419
147400200602     C                     MOVE '1'       *INU7                                               197419
147500200602     C                     MOVE '1'       *INU8            ***************                    197419
147600200602     C                     Z-ADD14        DBASE            **DB ERROR 14**                    197419
147700200602     C                     MOVEL'PRICED'  DBFILE           ***************                    197419
147800200602     C                     MOVELPSSN      DBKEY                                               197419
147900200602     C                     OUT  LDA                                                           197419
148000200602     C                     EXSR *PSSR                                                         197419
148100200602      *                                                                                       197419
148200200602     C                     ENDSR                           ** ENDSR **                        197419
148300200602      *                                                                                       197419
148400200602      ****************************************************************                        197419
148500200602      /EJECT                                                                                  197419
148600200602      *****************************************************************   S01117
148700200602      *                                                               *   S01117
148800200602      *  *PSSR  - Error control subroutine                            *   S01117
148900200602      *                                                               *   S01117
149000200602      *****************************************************************   S01117
149100200602      *                                                                   S01117
149200200602     C           *PSSR     BEGSR                           ** *PSSR **    S01117
149300200602     C**                                                                  S01117
149400200602     C           @RUN      IFEQ *BLANKS                                   S01117
149500200602     C                     MOVE 'Y'       @RUN    1                       S01117
149600200602     C                     DUMP                                           S01117
149700200602     C                     END                                            S01117
149800200602     C**                                                                  S01117
149900200602     C                     ENDSR                                          S01117
150000200602      *                                                                   S01117
150100200602     C*****************************************************************
150200200602     C/EJECT                                                              E29170
150300200602     C********************************************************************E29170
150400200602     C*                                                                   E29170
150500200602     C*  RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF          E29170
150600200602     C*                                                                   E29170
150700200602     C********************************************************************E29170
150800200602     C*                                                                   E29170
150900200602     C           RCFP1     BEGSR                            ** RCFP1 **   E29170
151000200602     C*                                                                   E29170
151100200602     C**      ENSURE REPORT SPOOL FILE RECORDED BY RCF                    E29170
151200200602     C*                                                                   E29170
151300200602     C                     Z-ADDSFNUM     ZSNUM   60                      E29170
151400200602     C**                                                                  E29170
151500200602     C                     CALL 'ZSFILE'                                  E29170
151600200602     C                     PARM           SEQ     5                       E29170
151700200602     C                     PARM *BLANKS   SENTY   3                       E29170
151800200602     C                     PARM           SFILE                           E29170
151900200602     C                     PARM           ZSNUM                           E29170
152000200602     C                     PARM           ZSERR   1                       E29170
152100200602     C*                                                                   E29170
152200200602     C           ZSERR     IFEQ 'Y'                                       E29170
152300200602     C*                                                                   E29170
152400200602     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       E29170
152500200602     C*                                                                   E29170
152600200602     C                     SETON                     U7U8LR               E29170
152700200602     C                     RETRN                                          E29170
152800200602     C                     END                                            E29170
152900200602     C*                                                                   E29170
153000200602     C                     ENDSR                                          E29170
153100200602     C*                                                                   E29170
153200200602     C********************************************************************E29170
153300200602     C/EJECT                                                              E29170
153400200602     C********************************************************************E29170
153500200602     C*                                                                   E29170
153600200602     C*  RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF          E29170
153700200602     C*                                                                   E29170
153800200602     C********************************************************************E29170
153900200602     C*                                                                   E29170
154000200602     C           RCFAU     BEGSR                            ** RCFAU **   E29170
154100200602     C*                                                                   E29170
154200200602     C**      ENSURE AUDIT SPOOL FILE RECORDED BY RCF                     E29170
154300200602     C*                                                                   E29170
154400200602     C                     Z-ADDSFNUMU    ZSNUMU  60                      E29170
154500200602     C**                                                                  E29170
154600200602     C                     CALL 'ZSFILE'                                  E29170
154700200602     C                     PARM           SEQ                             E29170
154800200602     C                     PARM *BLANKS   SENTY                           E29170
154900200602     C                     PARM           SFILEU                          E29170
155000200602     C                     PARM           ZSNUMU                          E29170
155100200602     C                     PARM *BLANK    ZSERR                           E29170
155200200602     C*                                                                   E29170
155300200602     C           ZSERR     IFEQ 'Y'                                       E29170
155400200602     C*                                                                   E29170
155500200602     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       E29170
155600200602     C*                                                                   E29170
155700200602     C                     SETON                     U7U8LR               E29170
155800200602     C                     RETRN                                          E29170
155900200602     C                     END                                            E29170
156000200602     C*                                                                   E29170
156100200602     C                     ENDSR                                          E29170
156200200602     C*                                                                   E29170
156300200602     C*****************************************************************   E29170
156400200602      /EJECT
156500200602     C/COPY ZSRSRC,ZDATE2Z4
156600200602      /EJECT
156700200602     C/COPY ZSRSRC,ZICD2Z1
156800200602      /EJECT
156900200602     C/COPY ZSRSRC,ZICDSEZ1
157000200602      /EJECT
157100200602     C/COPY ZSRSRC,ZSEDITZ3
157200200602      /EJECT
157300200602     C/COPY ZSRSRC,ZSYSTMZ1
157400200602      ***
157500200602**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
1576002006020366073110961461
157700200602**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
157800200602000031059090120151181212243273304334365
157900200602**   ZMNM - MONTHS SHORT NAMES
158000200602JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
158100200602**  CPY@
158200200602(c) Finastra International Limited 2001
158300200602**   EVENT TYPE/LEGEND TABLE
158400200602DVDIVIDEND      PPP.P.CALL      MPMORT.PAYT.    IRINT.RATE CHG. XREXCH.RATE CHG
158500200602RCRED.CALL      RPRED.PUT       CVCONVERSION    BIBONUS ISSUE   RIRIGHTS ISSUE
158600200602CRCAP REORG     OCOTH.CHANGES   CPCOUPON        PRMKT.PRICE
