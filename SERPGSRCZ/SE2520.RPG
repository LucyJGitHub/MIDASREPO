000100200529     H        1                                                           SE0720
000200200529      *****************************************************************
000300200529/*STD *  RPGBASE                                                      *
000400200529/*EXI *  TEXT('Midas SE Expired trades report')                       *
000500200529     F*****************************************************************
000600200529     F*                                                               *
000700200529     F*  Midas - Securities Trading Module
000800200529     F*                                                               *
000900200529     F*  SE2520 -  EXPIRED TRADES REPORT                              *
001000200529     F*                                                               *
001100200529     F*  Function: This report advises of the Trade Records removed   *
001200200529     F*   (COB)    from file.  Before a trade is removed, it must     *
001300200529     F*            satisfy the following conditions:                  *
001400200529     F*            - no activity has occurred (such as reversal of a  *
001500200529     F*              settlement) for at least one month               *
001600200529     F*            - The user defined period has passed since the     *
001700200529     F*              later of value date and fully settled date.      *
001800200529     F*                                                               *
001900200529     F* Called by: SEC1002 - Drop off Historic Trades                 *
002000200529     F*            Frequency:                                         *
002100200529     F*            - Automatically at end of month                    *
002200200529     F*                                                               *
002300200529      *  (c) Finastra International Limited 2001                      *
002400200529     F*                                                               *
002500200604     F*  Last Amend No. 254290             Date 22May20               *
002600200604     F*  PREV Amend No. 251887             Date 22May20               *
002700200604      *                 MD046248           Date 27Oct17               *
002800200529      *                 217131             Date 02Apr12               *
002900200529      *                 CSW210             Date 04May10               *
003000200529      *                 CER059             Date 19Jul10               *
003100200529      *                 BUG23967           Date 14May09               *
003200200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
003300200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
003400200529      *                 095907             Date 19Jan07               *
003500200529      * Midas Plus 1.4 Base ------------------------------------------*
003600200529      * Midas Plus 1.3 ----------- Base ------------------------------*
003700200529      *                 CSD027             Date 09sep06               *
003800200529      *                 234300             Date 25Sep06               *
003900200529      *                 234300             Date 23Jun05               *
004000200529      *                 CSE071             Date 19Jul05               *
004100200529      *                 BUG7985            Date 07Jul05               *
004200200529      *                 CER001             Date 25Apr05               *
004300200529      *                 CLE025             Date 20Oct03               *
004400200529      *                 CAS006             Date 21Jan03               *
004500200529      * Midas Release 4.01 -------------------------------------------*
004600200529      *                 202689             Date 07Feb02               *
004700200529      * Midas Release 4 --------------- Base -------------------------*
004800200529      * Midas DBA 3.04 -----------------------------------------------*
004900200529      *                 CSE023             Date 14Aug00               *
005000200529      * Midas DBA 3.03 -----------------------------------------------*
005100200529      * Midas DBA 3.00 ---------------- Base -------------------------*
005200200529      *                 CAC005             Date 21Dec98               *
005300200529      *                 S01408             Date 11Nov96               *
005400200529      *                 097131             Date 28Aug96               *
005500200529     F*                 079760             DATE 26JUL96               *
005600200529     F*                 S01408             DATE 12FEB96               *
005700200529     F*                 S01486 MD          DATE 28OCT94               *
005800200529     F*                 052254             DATE 10JAN94               *
005900200529     F*                 S01401             DATE 16JUN93               *
006000200529     F*                 S01397             DATE 10SEP92               *
006100200529     F*                 042027             DATE 08JUL92               *
006200200529     F*                 E37493             DATE 02APR92               *
006300200529     F*                 E29170             DATE 15OCT91               *
006400200529     F*                 S01117             DATE 07JUN91               *
006500200529     F*                 S01269             DATE 19JUL90               *
006600200529     F*                 E22404             DATE 25JUN90               *
006700200529     F*                 E20651             DATE 30JAN90               *
006800200529     F*                 S01176             DATE 11AUG88               *
006900200529     F*                                                               *
007000200529     F*---------------------------------------------------------------*
007100200529     F*                                                               *
007200200529      *  254290 - Amend 251887 changes. Delete from TRADSDX2 when     *
007300200529      *           T2WHEN = 'B'.                                       *
007400200529      *  251887 - Unable to insert trade due to the trade reference   *
007500200529      *           no. used which is already existing in TRADSDX1.     *
007600200529      *           Applied fix 223696 to drop records in extension     *
007700200529      *           files whenever TRADSD record is deleted.            *
007800200529      *  MD046248 - Finastra Rebranding                               *
007900200529      *  217131 - Prevent extension file records being deleted when   *
008000200529      *           security linked to trade has not yet matured.       *
008100200529      *         - Applied for AR943222 (Child:AR943225)               *
008200200529     F*  CSW210 - SWIFT 2010 Changes (Recompile)                      *
008300200529      *  CER059 - German Feature Upgrade to Delhi                     *
008400200529     F*  BUG23967 - Add Local Industry Code Field.                    *
008500200529     F*  095907 -  FILE CONTROLS INCORRECT. TSDEL SHOULD ONLY BE      *
008600200529     F*            INCREMENTED WHEN PROCESSING LIVE RECORDS.          *
008700200529     F*            ALSO SINS, SDEL AND SAMD FIELDS SET TO ZERO.       *
008800200529     F*            AND ALSO FOR HISTORIC RECORDS                      *
008900200529     F*         -  TRAILERS HSTTRA AND SETLEA MUST BE UPDATED         *
009000200529     F*         -  MODIFICATIONS CALCULATIONS FOR OUTPUT TRAILER      *
009100200529     F*         -  OUT OF BALANCE NOT USED ANYMORE DUE TO WRONG       *
009200200529     F*            TRAILER WHEN ENTERING THE PGM                      *
009300200529     F*         -  UPDATES OF RECI WITH '*' REPLACED BY DELETES       *
009400200529     F*         -  RECOMPILED TO USE CHANGES IN /COPY SE2520C001      *
009500200529     F*         -  DROP CORRESPONDING TRANSACTION IN MT5XX EXTENSION  *
009600200529     F*            FILES IF S01401 ACTIVE                             *
009700200529     F*         -  ONLY ACCESS SECTYD WHEN CHANGE OF SECURITY         *
009800200529     F*         -  MONITOR OVERFLOW FOR CHANGE OF BRANCH              *
009900200529     F*         -  REPORT SE2520P1 IS SHOWING TWO PAGE 1              *
010000200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
010100200529      *  234300 - Recompiled over changed in PF/HSTTRD.               *
010200200529      *           The previous delivery 234300 did not have PF/HSTTRD *
010300200529      *           changed and so recompiled over old version PF/HSTTRD*
010400200529      *  234300 - Recompiled over changed in PF/HSTTRD.               *
010500200529      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
010600200529      *  BUG7985- Several components failed due to accessing TABLETR  *
010700200529      *  CER001 - LUX Upgrade to MidasPlus                            *
010800200529      *  CLE025 - Credit Lines (Recompile)                            *
010900200529      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
011000200529      *  202689 - Partially applied fix 182888 to complete fix        *
011100200529      *           161531 - If Switchable Feature S01401 is 'On',      *
011200200529      *           delete trade records from extension file TRADSDX1.  *
011300200529      *  CSE023 - Treaty Withholding Tax                              *
011400200529      *  CAC005 - PCA-SE Enhancement.                                 *
011500200529     F*  S01408 - Addition of Core Hook SE2520CCP2                    *
011600200529     F*  097131 - Decrease limit for no. of details to be printed     *
011700200529     F*           per page to prevent overflow caused by              *
011800200529     F*           Trail message (END OF REPORT)--(rare case).         *
011900200529     F*  079760 - Increase work field size from 3 to 5                *
012000200529     F*  S01408 - Addition of core hook SE2520FFP1
012100200529     F*           Addition of core hook SE2520CCP1
012200200529     F*           Addition of core hook SE2520IIP1
012300200529     F*           Addition of core hook SE2520OOP1
012400200529     F*  S01486 - PORTFOLIO MANAGEMENT - update PM changes to historic*
012500200529     F*           turnover file and output instrument display group   *
012600200529     F*           to file.                                            *
012700200529     F*  052254 - RECOMPILED as CURRENT FACTOR amended from 9,8       *
012800200529     F*           to 10,9                                             *
012900200529     F*  S01401 - MT5xx SWIFT Messages Feature:                       *
013000200529     F*          - Recompiled due to changes to files.                *
013100200529     F*  S01397 - Rel 10 Incorporation of BNZ SARs A46008 and A46013. *
013200200529     F*          - Recompiled due to changes to files.                *
013300200529     F*  042027 - Program was not resetting the Printer File Open Ind.*
013400200529     F*           (*IN36) when the Printer File was being closed.     *
013500200529     F*  E37493 - Recompiled over changed printer file.               *
013600200529     F*  E29170 - Report Control Facility changes.                    *
013700200529     F*  S01117 - Multi-branching.                                    *
013800200529     F*  S01269  -  Trades Authorisation - Check if record is already *
013900200529     F*             Authorised                                        *
014000200529     F*  E22404  -  FILE CONTROLS INCORRECT. TSDEL SHOULD ONLY BE     *
014100200529     F*             INCREMENTED WHEN PROCESSING LIVE RECORDS.         *
014200200529     F*             ALSO SINS, SDEL AND SAMD FIELDS SET TO ZERO.      *
014300200529     F*  E20651  -  DB ERROR NUMBERS USED IN MORE THAN ONE PLACE.     *
014400200529     F*             NEW ERROR NUMBERS AS FOLLOWS:                     *
014500200529     F*             DB ERROR 01 -> 07                                 *
014600200529     F*             DB ERRPR 01 -> 08                                 *
014700200529     F*  S01176  -  ST3.1                                             *
014800200529     F*                                                               *
014900200529     F*****************************************************************
015000200529     F*
015100200529     FHSTTR   UP  E           K        DISK
015200200529     FHSTTTR  IF  E           K        DISK                                                   251887
015300200529     F            HSTTRDF                           KRENAMEHISTRAD                            251887
015400200529     FSETLT   UF  E           K        DISK
015500200529     FPMCHTVPDUF  E           K        DISK                      A        S01486
015600200529     FTRADSDY1UF  E           K        DISK                                                   202689
015700200529     FTRADSDY2UF  E           K        DISK                                                   202689
015800200529     FTRADSD10IF  E           K        DISK                                                   251887
015900200529     FSECTY   IF  E           K        DISK
016000200529     FINVTP   IF  E           K        DISK                               S01486
016100200529     FHSTTRA  UF  E                    DISK
016200200529     FSETLEA  UF  E                    DISK
016300200529     FHTRAUT  UF  E           K        DISK                               S01269
016400200529     FTABSE   IF  E           K        DISK
016500200529     F            TABLETAF                          KIGNORE
016600200529     F            TABTB11F                          KIGNORE
016700200529     F            TABTE10F                          KIGNORE
016800200529     F            TABTE20F                          KIGNORE
016900200529     F            TABTG20F                          KIGNORE
017000200529     F            TABLETHF                          KIGNORE
017100200529     F*********** TABLETJF                          KIGNORE               S01117
017200200529     F            TABLETKF                          KIGNORE
017300200529     F            TABLETLF                          KIGNORE
017400200529     F            TABLETNF                          KIGNORE
017500200529     F            TABLETPF                          KIGNORE
017600200529     F            TABLETXF                          KIGNORE
017700200529     F            TABLET2F                          KIGNORE
017800200529     F            TABLET3F                          KIGNORE
017900200529     F            TABLET5F                          KIGNORE
018000200529     F            TABTB40F                          KIGNORE
018100200529     FCLINT   IF  E           K        DISK
018200200529     F            CLINTCAF                          KIGNORE
018300200529     F            CLINTCCF                          KIGNORE
018400200529     F            CLINTC1F                          KIGNORE
018500200529     F            CLINTSEF                          KIGNORE
018600200529     F/COPY WNCPYSRC,SE2520F001
018700200529     FSE2520AUO   E                    PRINTER
018800200529     F                                              KINFDS SPOOLU         E29170
018900200529     FSE2520P1O   E                    PRINTER                        UC
019000200529     F                                              KINFDS SPOOL          E29170
019100200529     F*
019200200529     F/COPY WNCPYSRC,SE2520FFP1
019300200529     FSETRX1PDUF  E           K        DISK                           UC                      CER001
019400200529      *                                                                                       CER001
019500200529      ***  CAD Extended details                                                               CER001
019600200529      *                                                                                       CER001
019700200529     F*
019800200529      /EJECT
019900200529     F*****************************************************************
020000200529     F*                                                               *
020100200529     F*  FUNCTION OF INDICATORS                                       *
020200200529     F*                                                               *
020300200529     F*   31 - Security not found for trade record                    *
020400200529     F*   32 - Control new page printing                              *
020500200529     F*   33 - General work indicator                                 *
020600200529     F*   36 - DETAIL PRINTER P1 IS OPEN                              *   E29170
020700200529     F*   37 - MULTIBRANCHING ON                                      *   E29170
020800200529     F*   69 - Used to Control first cycle processing                 *
020900200529     F*   70 - ON-Print Client number/OFF-Print shortname             *
021000200529     F*   71 - ON-Trade not settled - Print message                   *
021100200529     F*   73 - Number of records on audit file different to           *
021200200529     F*        number of records read                                 *
021300200529     F*81-83 - Work indicator                                         *   S01486
021400200529     F*90-99 - Used in standard sub-routines                          *
021500200529     F*   U7 - Database error                                         *
021600200529     F*   U8 - Database / Control error                               *
021700200529     F*   L2 - Change of Branch                                       *
021800200529     F*   L1 - Change of Trade reference                              *
021900200529     F*****************************************************************
022000200529      /SPACE 3
022100200529     F*****************************************************************
022200200529     F*                                                               *
022300200529     F*  SUBROUTINE INDEX                                             *
022400200529     F*                                                               *
022500200529     F*   DLTREC - Flag records as deleted and count total            *
022600200529     F*   PRINTD - Print deleted record                               *
022700200529     F*   *PSSR  - Error handling                                     *   S01117
022800200529     F*   RCFP1   -  SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF   *   E29170
022900200529     F*   RCFAU   -  SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF   *   E29170
023000200529     F*   ZDATE2 - DAYNO - DATE conversion                            *
023100200529     F*   ZICDSE - Access ICD record for Securities Trading           *
023200200529     F*   ZSEDIT - Insert a decimal point and sign into a numeric FLD *
023300200529     F*            and blank out leading zeros                        *
023400200529     F*   ZSYSTM - Access ICD record                                  *
023500200529     F*   UPDTVM - Uodate PM changes to historic turnover file        *   S01486
023600200529     F*****************************************************************
023700200529      /EJECT
023800200529     E/COPY ZSRSRC,ZDATE2Z1
023900200529     E*
024000200529     E/COPY ZSRSRC,ZSEDITZ1
024100200529     E                    CPY@    1   1 80
024200200529      /EJECT
024300200529     I*
024400200529     I/COPY WNCPYSRC,SE2520IIP1
024500200529     I*
024600200529      *
024700200529     IINVTPDF                                                                                 CAS006
024800200529     I              SFLG                            ITSFLG                                    CAS006
024900200529     I**TRADSDF                                                           S01176
025000200529     IHSTTRDF                                                             S01176
025100200529     I***********                                   TDBR  L2              S01117
025200200529     I                                              TDBA  L2              S01117
025300200529     I                                              TDRF  L1
025400200529     I              RECI                            RECIX
025500200529     I              LCD                             LCDX
025600200529     I*
025700200529     ICPYR@#      DS
025800200529     I*
025900200529     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
026000200529     I*
026100200529     I                                        1  80 CPY@
026200200529     I                                        1  20 CPY@##
026300200529     I*                                                                   S01486
026400200529     I** DS TO SPLIT ZDATE (DDMMYY FROM ZDATE2)                           S01486
026500200529     IWWDATE      DS                                                      S01486
026600200529     I                                        1   20WWDAY                 S01486
026700200529     I                                        3   40WWMTHN                S01486
026800200529     I                                        5   60WWYEAR                S01486
026900200529     I*                                                                   S01486
027000200529     ICHTVDS      DS                                                      S01486
027100200529     I**********                              1   60SCCNUM                             S01486 CSD027
027200200529     I                                        1   6 SCCNUM                                    CSD027
027300200529     I                                        7  10 SCPTFR                S01486
027400200529     I                                       11  13 SCINNR                S01486
027500200529     I                                       14  16 SCICCY                S01486
027600200529     I                                       17  190SCLIND                S01486
027700200529     I                                       20  210SCYRNO                S01486
027800200529     I                                       22  230SCMTHN                S01486
027900200529     I*                                                                   S01486
028000200529     IIVTPDS      DS                                                      S01486
028100200529     I                                        1   3 TNMC                  S01486
028200200529     I                                        4   6 SITP                  S01486
028300200529     I*                                                                   S01486
028400200529     I*
028500200529     I*LDA******* UDS                            256                      S01117
028600200529     I***********                           134 177 DBLOT                 S01117
028700200529     I***********                           134 138 DBFILE                S01117
028800200529     I***********                           139 167 DBKEY                 S01117
028900200529     I***********                           168 175 DBPGM                 S01117
029000200529     I***********                           176 177 DBASE                 S01117
029100200529     ILDA         DS                            256                       S01117
029200200529     I                                      134 183 DBLOT                 S01117
029300200529     I                                      134 141 DBFILE                S01117
029400200529     I                                      142 170 DBKEY                 S01117
029500200529     I                                      171 180 DBPGM                 S01117
029600200529     I                                      181 1830DBASE                 S01117
029700200529     I*                                                                   E29170
029800200529     ISPOOL       DS                                                      E29170
029900200529     I*                                                                   E29170
030000200529     I**  DS FOR P1 SPOOL FILE NAME                                       E29170
030100200529     I*                                                                   E29170
030200200529     I                                       83  92 SFILE                 E29170
030300200529     I                                    B 123 1240SFNUM                 E29170
030400200529     I**                                                                  E29170
030500200529     ISPOOLU      DS                                                      E29170
030600200529     I                                       83  92 SFILEU                E29170
030700200529     I                                    B 123 1240SFNUMU                E29170
030800200529     IRUNDT       DS                                                      E29170
030900200529     I                                        1   7 RUNA                  E29170
031000200529     I                                    P   8  100RUND                  E29170
031100200529     I                                       11  11 SSF                   E29170
031200200529     I                                       12  12 DATF                  E29170
031300200529     I                                       13  13 MBIN                  E29170
031400200529     I/COPY WNCPYSRC,SE2520I001
031500200529     I*                                                                   E29170
031600200529     I**  DATA STRUCTURE FOR RUN DATE DETAILS                             E29170
031700200529     I*                                                                   E29170
031800200529     ISDMMOD    E DSSDMMODPD                                              S01486
031900200529     I**  Data structure for module details                               S01486
032000200529     I*                                                                   S01486
032100200529     ISDPLIN    E DSSDPLINPD                                              S01486
032200200529     I**  Data structure for instrument details                           S01486
032300200529     I*                                                                   S01486
032400200529     ISDBRCH    E DSSDBRCHPD                                                                 BUG7985
032500200529     I              A8BRNM                          BRNM                                     BUG7985
032600200529     IDSSDY     E DSDSSDY                                                                    BUG7985
032700200529     IDSFDY     E DSDSFDY                                                 S01486
032800200529     I** First Data structure for access objects, short data structure    S01486
032900200529     I*                                                                   S01486
033000200529     I/COPY ZSRSRC,ZSEDITZ2
033100200529      /EJECT
033200200529     C*===================================================================S01486
033300200529     C*                                                                   S01486
033400200529     C** CALCULATION SPECIFICATIONS:KEY LISTS                             S01486
033500200529     C*                                                                   S01486
033600200529     C** DEFINE KEY LIST FOR CHAINING TO PMCHTVPP                         S01486
033700200529     C*                                                                   S01486
033800200529     C           CHTVKY    KLIST                                          S01486
033900200529     C                     KFLD           SCCNUM                          S01486
034000200529     C                     KFLD           SCPTFR                          S01486
034100200529     C                     KFLD           SCINNR                          S01486
034200200529     C                     KFLD           SCICCY                          S01486
034300200529     C**********           KFLD           SCLIND                                     S01486 BUG23967
034400200529     C                     KFLD           SCLOIC                                            BUG23967
034500200529     C                     KFLD           SCYRNO                          S01486
034600200529     C                     KFLD           SCMTHN                          S01486
034700200529     C*                                                                   S01486
034800200529     C** DEFINE KEY LIST FOR CHAINING TO INVTP                            S01486
034900200529     C*                                                                   S01486
035000200529     C           IVTPKY    KLIST                                          S01486
035100200529     C                     KFLD           TNMC                            S01486
035200200529     C                     KFLD           SITP                            S01486
035300200529      *                                                                                       202689
035400200529      ** Define key list for chaining to TRADSDY1 and TRADSDY2                                202689
035500200529      *                                                                                       202689
035600200529     C           KEY1      KLIST                                                              202689
035700200529     C                     KFLD           TDRF                                                202689
035800200529     C*                                                                   S01486
035900200529     C/COPY WNCPYSRC,SE2520C007
036000200529     C*===================================================================S01486
036100200529      /EJECT                                                              S01486
036200200529     C           *LIKE     DEFN TDSS      STDSS                                               095907
036300200529     C*================================================================
036400200529     C*  P R O G R A M     S T A R T                                  *
036500200529     C*================================================================
036600200529     C*
036700200529     C           *IN69     IFEQ '0'
036800200529     C*
036900200529     C* Prepare LDA
037000200529     C*
037100200529     C           *NAMVAR   DEFN           LDA                             S01117
037200200529     C           *LOCK     IN   LDA                                       S01117
037300200529     C                     MOVE *BLANKS   DBLOT
037400200529     C                     MOVE 'SE2520  'DBPGM
037500200529     C                     OUT  LDA                                       S01117
037600200529     C*
037700200529     C* Get Installation Control Data record 1
037800200529     C*
037900200529     C                     EXSR ZSYSTM
038000200529     C*
038100200529     C* If error in ZSYSTM, abend program
038200200529     C*
038300200529     C           *IN99     IFEQ '1'                        ***************
038400200529     C           *LOCK     IN   LDA                                       S01117
038500200529     C***********          MOVE '01'      DBASE            **DB*ERROR*01**E20651
038600200529     C***********          MOVE '07'      DBASE            **DB 7**E20651 S01117
038700200529     C                     Z-ADD7         DBASE            **DB ERROR 07**S01117
038800200529     C                     MOVEL'TABLE'   DBFILE           ***************
038900200529     C                     MOVELZTABKY    DBKEY
039000200529     C                     OUT  LDA                                       S01117
039100200529     C                     EXSR *PSSR                                     S01117
039200200529     C                     WRITEHEADAU
039300200529     C                     WRITEERROR
039400200529     C*0*********          WRITETRAILAU                                   E29170
039500200529     C                     SETON                     U7U8LR
039600200529     C                     RETRN
039700200529     C                     END
039800200529     C*
039900200529     C* Get Installation Control Data record for Securities trading
040000200529     C*
040100200529     C                     EXSR ZICDSE
040200200529     C*
040300200529     C* If error in ZICDSE, abend program
040400200529     C*
040500200529     C           *IN99     IFEQ '1'                        ***************
040600200529     C           *LOCK     IN   LDA                                       S01117
040700200529     C***********          MOVE '02'      DBASE            **DB ERROR 02**S01117
040800200529     C                     Z-ADD2         DBASE            **DB ERROR 02**S01117
040900200529     C                     MOVEL'TABLE'   DBFILE           ***************
041000200529     C                     MOVELZTABKY    DBKEY
041100200529     C                     OUT  LDA                                       S01117
041200200529     C                     EXSR *PSSR                                     S01117
041300200529     C                     WRITEHEADAU
041400200529     C                     WRITEERROR
041500200529     C***********          WRITETRAILAU                                   E29170
041600200529     C                     SETON                     U7U8LR
041700200529     C                     RETRN
041800200529     C                     END
041900200529     C*                                                                   S01486
042000200529     C**  Get module details using access object                          S01486
042100200529     C*                                                                   S01486
042200200529     C                     CALL 'AOMMODR0'                                S01486
042300200529     C                     PARM *BLANKS   @RTCD   7                       S01486
042400200529     C                     PARM '*FIRST'  @OPTN   7                       S01486
042500200529     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
042600200529     C*                                                                   S01486
042700200529     C           @RTCD     IFNE *BLANKS                                   S01486
042800200529     C           *LOCK     IN   LDA                                       S01486
042900200529     C                     Z-ADD15        DBASE            ***************S01486
043000200529     C                     MOVE 'SDMMODPD'DBFILE           * DB ERROR 15 *S01486
043100200529     C                     MOVEL@OPTN     DBKEY            ***************S01486
043200200529     C                     OUT  LDA                                       S01486
043300200529     C                     EXSR *PSSR                                     S01486
043400200529     C                     WRITEHEADAU                                    S01486
043500200529     C                     WRITEERROR                                     S01486
043600200529     C                     SETON                     U7U8LR               S01486
043700200529     C                     RETRN                                          S01486
043800200529     C                     END                                            S01486
043900200529      *                                                                   CAC005
044000200529      ** Check if CAC005 - PCA-SE Enhancement is on.                      CAC005
044100200529      *                                                                   CAC005
044200200529     C                     MOVE 'N'       CAC005  1                       CAC005
044300200529     C                     CALL 'AOSARDR0'                                CAC005
044400200529     C                     PARM *BLANKS   @RTCD   7                       CAC005
044500200529     C                     PARM '*VERIFY' @OPTN   7                       CAC005
044600200529     C                     PARM 'CAC005'  @SARD   6                       CAC005
044700200529      *                                                                   CAC005
044800200529     C           @RTCD     IFEQ *BLANK                                    CAC005
044900200529     C                     MOVE 'Y'       CAC005                          CAC005
045000200529     C                     ENDIF                                          CAC005
045100200529      *                                                                   CSE023
045200200529      ** Check if CSE023 - Treaty Withholding Tax present                 CSE023
045300200529      *                                                                   CSE023
045400200529     C                     MOVE 'N'       CSE023  1                       CSE023
045500200529     C                     CALL 'AOSARDR0'                                CSE023
045600200529     C                     PARM *BLANKS   @RTCD   7                       CSE023
045700200529     C                     PARM '*VERIFY' @OPTN   7                       CSE023
045800200529     C                     PARM 'CSE023'  @SARD   6                       CSE023
045900200529      *                                                                   CSE023
046000200529     C           @RTCD     IFEQ *BLANK                                    CSE023
046100200529     C                     MOVE 'Y'       CSE023                          CSE023
046200200529     C           31        MULT 18        @MINR   30                      CSE023
046300200529     C                     ENDIF                                          CSE023
046400200529      *                                                                   CAC005
046500200529     C/COPY WNCPYSRC,SE2520C001
046600200529     C*                                                                                       202689
046700200529      **  Access Switchable features file for S01401.                                         202689
046800200529      *                                                                                       202689
046900200529     C                     MOVE 'N'       S01401                                              202689
047000200529     C                     CALL 'AOSARDR0'                                                    202689
047100200529     C                     PARM '       ' @RTCD                                               202689
047200200529     C                     PARM '*VERIFY' @OPTN                                               202689
047300200529     C                     PARM 'S01401'  @SARD   6                                           202689
047400200529     C*                                                                                       202689
047500200529     C           @RTCD     IFEQ *BLANK                                                        202689
047600200529     C                     MOVE 'Y'       S01401  1                                           202689
047700200529     C                     END                                                                202689
047800200529      *                                                                                       202689
047900200529      **  Access Switchable features file for CSW003                                          202689
048000200529      *                                                                                       202689
048100200529     C                     MOVE 'N'       CSW003  1                                           202689
048200200529     C                     CALL 'AOSARDR0'                                                    202689
048300200529     C                     PARM '       ' @RTCD                                               202689
048400200529     C                     PARM '*VERIFY' @OPTN                                               202689
048500200529     C                     PARM 'CSW003'  @SARD   6                                           202689
048600200529      *                                                                                       202689
048700200529     C           @RTCD     IFEQ *BLANK                                                        202689
048800200529     C                     MOVE 'Y'       CSW003                                              202689
048900200529     C                     END                                                                202689
049000200529      *                                                                                       202689
049100200529     C*
049200200529     C* Calculate drop off date
049300200529     C*
049400200529     C           RUND      SUB  31        DROPDT  50
049500200529     C*
049600200529     C* Calculate Retention date
049700200529     C*
049800200529     C*********  31        MULT RTST      WK3N    30                      079760
049900200529     C*********  RUND      SUB  WK3N      RTNTDT  50                      079760
050000200529     C*
050100200529     C           31        MULT RTST      WK5N    50                      079760
050200200529     C*                                                                   CSE023
050300200529     C** If CSE023 is present, the minimum retention period is            CSE023
050400200529     C** 18 months.                                                       CSE023
050500200529     C*                                                                   CSE023
050600200529     C           CSE023    IFEQ 'Y'                                       CSE023
050700200529     C           WK5N      ANDLT@MINR                                     CSE023
050800200529     C                     Z-ADD@MINR     WK5N                            CSE023
050900200529     C                     END                                            CSE023
051000200529     C*                                                                   CSE023
051100200529     C           RUND      SUB  WK5N      RTNTDT  50                      079760
051200200529     C                     SETON                     69
051300200529     C/COPY WNCPYSRC,SE2520C004
051400200529     C*                                                                   E29170
051500200529     C** IN THE DATAAREA RUNDAT                                           E29170
051600200529     C*                                                                   E29170
051700200529     C           *NAMVAR   DEFN RUNDAT    RUNDT                           E29170
051800200529     C                     IN   RUNDT                                     E29170
051900200529     C*                                                                   E29170
052000200529     C**  TEST FOR MULTIBRANCHING                                         E29170
052100200529     C*                                                                   E29170
052200200529     C           MBIN      IFEQ 'Y'                                       E29170
052300200529     C                     SETON                     37                   E29170
052400200529     C                     END                                            E29170
052500200529     C*                                                                   E29170
052600200529     C** RCF Processing for Audit File                                    E29170
052700200529     C*                                                                   E29170
052800200529     C                     EXSR RCFAU                                     E29170
052900200529     C*                                                                                       095907
053000200529     C                     READ SETLEDF                  33                                   095907
053100200529     C           *IN33     DOWEQ'0'                                                           095907
053200200529     C** AS FIELDS ARE ALL RESET WHEN DROP RUNS USE ALL FOR REPORT                            095907
053300200529     C                     ADD  1         TSRNO                                               095907
053400200529     C                     READ SETLEDF                  33                                   095907
053500200529     C                     END                                                                095907
053600200529     C                     SETOF                         33                                   095907
053700200529     C/COPY WNCPYSRC,SE2520C002
053800200529      *                                                                                       CER001
053900200529      ** Check SAR details file to see if ER_R10 is installed.                                CER001
054000200529      *                                                                                       CER001
054100200529     C                     MOVE *OFF      *IN46                                               CER001
054200200529     C                     CALL 'AOSARDR0'                                                    CER001
054300200529     C                     PARM '       ' @RTCD                                               CER001
054400200529     C                     PARM '*VERIFY' @OPTN                                               CER001
054500200529     C                     PARM 'ULX004'  @SARD   6                                           CER001
054600200529      *                                                                                       CER001
054700200529     C           @RTCD     IFEQ *BLANK                                                        CER001
054800200529     C                     MOVE *ON       *IN46                                               CER001
054900200529     C                     OPEN SETRX1PD                                                      CER001
055000200529     C                     END                                                                CER001
055100200529      *                                                                                       CER001
055200200529     C                     END
055300200529     C*
055400200529      /EJECT
055500200529     C*
055600200529     C* Change of Branch calcs
055700200529     C*
055800200529     C   L2                DO
055900200529     C*
056000200529     C**Fetch*Branch*name**********************************************   E29170
056100200529     C* Fetch Branch name if multibranching is on                         E29170
056200200529     C*
056300200529     C           *IN37     IFEQ '1'                                       E29170
056400200529     C                     MOVE *BLANKS   KEY12A 12
056500200529     C**********           MOVEL'10'      KEY12A                                             BUG7985
056600200529     C***********          MOVE TDBR      KEY12A                          S01117
056700200529     C**********           MOVE TDBA      KEY12A                                      S01117 BUG7985
056800200529     C********** KEY12A    CHAINTABLETRF             33                                      BUG7985
056900200529     C********** *IN33     IFEQ '1'                        ***************                   BUG7985
057000200529     C                     CALL 'AOBRCHR1'                                                   BUG7985
057100200529     C                     PARM *BLANKS   PRTCD   7                                          BUG7985
057200200529     C                     PARM '*KEY   ' POPTN   7                                          BUG7985
057300200529     C                     PARM TDBA      PBRCH   3                                          BUG7985
057400200529     C           SDBRCH    PARM SDBRCH    DSSDY                                              BUG7985
057500200529      *                                                                                      BUG7985
057600200529     C           PRTCD     IFNE *BLANKS                                                      BUG7985
057700200529     C           *LOCK     IN   LDA                                       S01117
057800200529     C***********          MOVEL'03'      DBASE            **DB ERROR 03**S01117
057900200529     C                     Z-ADD3         DBASE            **DB ERROR 03**S01117
058000200529     C**********           MOVEL'TABLE'   DBFILE           ***************                   BUG7985
058100200529     C**********           MOVELKEY12A    DBKEY                                              BUG7985
058200200529     C                     MOVE 'SDBRCHPD'DBFILE                                             BUG7985
058300200529     C                     MOVELTDBA      DBKEY                                              BUG7985
058400200529     C                     OUT  LDA                                       S01117
058500200529     C                     EXSR *PSSR                                     S01117
058600200529     C                     WRITEHEADAU
058700200529     C                     WRITEERROR
058800200529     C***********          WRITETRAILAU                                   E29170
058900200529     C                     SETON                     U7U8LR
059000200529     C                     RETRN
059100200529     C                     END
059200200529     C                     END                                            E29170
059300200529     C*
059400200529     C* Indicator controlling new page printing
059500200529     C*
059600200529     C                     SETOF                     32
059700200529     C*
059800200529     C   L2                END
059900200529      /SPACE 3
060000200529     C*
060100200529     C* Detail processing
060200200529     C*
060300200529      /SPACE 2
060400200529     C*
060500200529     C* Ignore this record if already deleted
060600200529     C*
060700200529     C           RECIX     IFNE '*'
060800200529     C*
060900200529     C* Count Trade records read
061000200529     C*
061100200529     C                     ADD  1         HTRRD
061200200529     C*
061300200529     C* Check if Trade settled (for print line)
061400200529     C*
061500200529     C           RECIX     COMP 'S'                  7171
061600200529     C*
061700200529     C* Access Security
061800200529     C*
061900200529     C           TDSS      IFNE STDSS                                                         095907
062000200529     C                     MOVE TDSS      STDSS                                               095907
062100200529     C           TDSS      CHAINSECTYDF              31
062200200529     C  N31      RECI      COMP '*'                      31
062300200529     C                     END                                                                095907
062400200529     C/COPY WNCPYSRC,SE2520C013
062500200529     C*
062600200529     C* If not found, flag trade and any settlement records and count as
062700200529     C* deleted
062800200529     C*
062900200529     C           *IN31     IFEQ '1'
063000200529     C*
063100200529     C/COPY WNCPYSRC,SE2520C010
063200200529     C                     EXSR DLTREC
063300200529     C*
063400200529     C* Print detail report
063500200529     C*
063600200529     C                     EXSR PRINTD
063700200529     C/COPY WNCPYSRC,SE2520C011
063800200529     C*
063900200529     C* Else if security found
064000200529     C*
064100200529     C                     ELSE
064200200529     C*
064300200529     C/COPY WNCPYSRC,SE2520C008
064400200529     C* If Last change date after Drop date, take no further action
064500200529     C*
064600200529     C           LCDX      IFLE DROPDT
064700200529     C*
064800200529     C* If later of Value date and Fully Settled date after Retention date
064900200529     C* also take no further action
065000200529     C*
065100200529     C                     Z-ADDTDVD      LATERD  50
065200200529     C           TDFS      IFGT LATERD
065300200529     C                     Z-ADDTDFS      LATERD
065400200529     C                     END
065500200529     C           LATERD    IFLE RTNTDT
065600200529      ** Check that security has matured                                                      217131
065700200529     C           LATERD    ANDGEMATY                                                          217131
065800200529     C*                                                                   S01408
065900200529     C/COPY WNCPYSRC,SE2520CCP2                                           S01408
066000200529     C*                                                                   S01408
066100200529     C*
066200200529     C* Flag trade and any settlement records and count as deleted
066300200529     C*
066400200529     C                     EXSR DLTREC
066500200529     C*
066600200529     C* Print detail report
066700200529     C*
066800200529     C                     EXSR PRINTD
066900200529     C/COPY WNCPYSRC,SE2520C012
067000200529     C*
067100200529     C                     END
067200200529     C                     END
067300200529     C/COPY WNCPYSRC,SE2520C009
067400200529     C*
067500200529     C                     END
067600200529     C*
067700200529     C                     END
067800200529     C*
067900200529      /SPACE 3
068000200529     C*
068100200529     C* Change of Branch
068200200529     C*
068300200529     CL2         HTRRD     IFGT *ZEROS
068400200529     CL2         *IN36     ANDEQ'1'                                       E29170
068500200529     CL2         LCOUNT    IFGT 58                                                            095907
068600200529     CL2                   WRITEHEADL2                                                        095907
068700200529     CL2                   Z-ADD10        LCOUNT                                              095907
068800200529     CL2                   END                                                                095907
068900200529     CL2                   WRITETRAILP1                                   E29170
069000200529     CL2                   CLOSESE2520P1
069100200529     CL2                   SETOF                     36                   042027
069200200529     CL2                   END
069300200529     C*
069400200529      /SPACE 3
069500200529     C*
069600200529     C* LR time
069700200529     C*
069800200529     CLR                   DO
069900200529     CLR                   CLOSETRADSDY1                                                      095907
070000200529     CLR                   CLOSETRADSDY2                                                      095907
070100200529     C/COPY WNCPYSRC,SE2520C005
070200200529     C*
070300200529     C* If no records read, perform 1st time calcs for audit report
070400200529     C*
070500200529     CL0         HTRRD     IFEQ *ZEROS
070600200529     C*
070700200529     C* Prepare LDA
070800200529     C*
070900200529     CL0                   MOVE *BLANKS   DBLOT
071000200529     CL0                   MOVE 'SE2520  'DBPGM
071100200529     C*
071200200529     C* Get Installation Control Data record 1
071300200529     C*
071400200529     CL0                   EXSR ZSYSTM
071500200529     C*
071600200529     C* If error in ZSYSTM, abend program
071700200529     C*
071800200529     CL0         *IN99     IFEQ '1'                        ***************
071900200529     CL0         *LOCK     IN   LDA                                       S01117
072000200529     C**L0*******          MOVE '01'      DBASE            **DB*ERROR*01**E20651
072100200529     C*L0********          MOVE '08'      DBASE            **DB ERROR 08**E20651
072200200529     CL0                   Z-ADD8         DBASE            **DB ERROR 08**E20651
072300200529     CL0                   MOVEL'TABLE'   DBFILE           ***************
072400200529     CL0                   MOVELZTABKY    DBKEY
072500200529     CL0                   OUT  LDA                                       S01117
072600200529     CL0                   EXSR *PSSR                                     S01117
072700200529     CL0                   WRITEHEADAU
072800200529     CL0                   WRITEERROR
072900200529     C*0*********          WRITETRAILAU                                   E29170
073000200529     CL0                   SETON                     U7U8LR
073100200529     CL0                   RETRN
073200200529     CL0                   END
073300200529     C*
073400200529     CL0                   END
073500200529     C*
073600200529     C* Fetch Historic trades audit file
073700200529     C*
073800200529     CL0         1         CHAINHSTTRAF              33
073900200529     CL0         *IN33     IFEQ '1'                        ***************
074000200529     CL0         *LOCK     IN   LDA                                       S01117
074100200529     C*L0********           MOVEL'05'      DBASE            **DB ERROR 05*S01117
074200200529     CL0                   Z-ADD5         DBASE            **DB ERROR 05**S01117
074300200529     CL0                   MOVEL'HSTTRA'  DBFILE           ***************
074400200529     CL0                   MOVEL'1'       DBKEY
074500200529     CL0                   OUT  LDA                                       S01117
074600200529     CL0                   EXSR *PSSR                                     S01117
074700200529     CL0                   WRITEHEADAU
074800200529     CL0                   WRITEERROR
074900200529     C*0*********          WRITETRAILAU                                   E29170
075000200529     CL0                   SETON                     U7U8
075100200529     CL0                   RETRN
075200200529     CL0                   ELSE
075300200529     C*
075400200529     C* Compare control total to number of records read
075500200529     C* Unuseful at this level HTRRD correctly contains nb of records read                    095907
075600200529     C* and HSTTRA update is done just after                                                  095907
075700200529     C*
075800200529     C***L0         NORE      COMP HTRRD                U8U8                                  095907
075900200529     C***L0 U8                SETON                     73                                    095907
076000200529     C*
076100200529     C* Calculate output fields
076200200529     C*
076300200529     CL0                   Z-ADDNORE      HTRNO
076400200529     C***L0         NORE      SUB  HTDEL     HTNEW                                            095907
076500200529     CL0         HTRRD     SUB  HTDEL     HTNEW                                               095907
076600200529     C*
076700200529     C* If totals same, update audit record
076800200529     C*
076900200529     CL0         *INU8     IFEQ '0'
077000200529     CL0                   Z-ADD0         SINS                            E22404
077100200529     CL0                   Z-ADD0         SDEL                            E22404
077200200529     CL0                   Z-ADD0         SAMD                            E22404
077300200529     CL0                   Z-ADDHTNEW     SLRB
077400200529     CL0                   Z-ADDHTNEW     NORE
077500200529     CL0                   UPDATHSTTRAF
077600200529     CL0                   END
077700200529     C*
077800200529     C* Fetch Settlements audit file
077900200529     C*
078000200529     CL0         1         CHAINSETLEA               33
078100200529     CL0         *IN33     IFEQ '1'                        ***************
078200200529     CL0         *LOCK     IN   LDA                                       S01117
078300200529     C*L0********          MOVEL'06'      DBASE            **DB ERROR 06**S01117
078400200529     CL0                   Z-ADD6         DBASE            **DB ERROR 06**S01117
078500200529     CL0                   MOVEL'SETLEA'  DBFILE           ***************
078600200529     CL0                   MOVEL'1'       DBKEY
078700200529     CL0                   OUT  LDA                                       S01117
078800200529     CL0                   EXSR *PSSR                                     S01117
078900200529     CL0                   WRITEHEADAU
079000200529     CL0                   WRITEERROR
079100200529     C*0*********          WRITETRAILAU                                   E29170
079200200529     CL0                   SETON                     U7U8
079300200529     CL0                   RETRN
079400200529     CL0                   ELSE
079500200529     C*
079600200529     C* Calculate output fields
079700200529     C*
079800200529     C***L0                Z-ADDNORE      TSRNO                                               095907
079900200529     C***L0         NORE      SUB  TSDEL     TSNEW                                            095907
080000200529     CL0         TSRNO     SUB  TSDEL     TSNEW                                               095907
080100200529     C*
080200200529     C* Update audit record if HSTTRA number of records ok
080300200529     C*
080400200529     CL0         *INU8     IFEQ '0'
080500200529     CL0                   Z-ADD0         SINS                            E22404
080600200529     CL0                   Z-ADD0         SDEL                            E22404
080700200529     CL0                   Z-ADD0         SAMD                            E22404
080800200529     C** AS FIELDS ARE ALL RESET WHEN DROP RUNS RESET TO ZERO                                 095907
080900200529     C**L0                   Z-ADDTSNEW     SLRB                                              095907
081000200529     C**L0                   Z-ADDTSNEW     NORE                                              095907
081100200529     CL0                   Z-ADD0         SLRB                                                095907
081200200529     CL0                   Z-ADD0         NORE                                                095907
081300200529     CL0                   UPDATSETLEAF
081400200529     CL0                   END
081500200529     C*
081600200529     C* Print audit report
081700200529     C*
081800200529     CL0                   WRITEHEADAU
081900200529     CL0                   WRITEDETLAU
082000200529     C*                                                                   E29170
082100200529     C** If have read no records then output 'No Details' to Audit file   E29170
082200200529     C*                                                                   E29170
082300200529     CL0         *IN36     IFEQ '0'                                       E29170
082400200529     CL0                   WRITENONE                                      E29170
082500200529     CL0                   END                                            E29170
082600200529     C*
082700200529     CL0                   END
082800200529     CL0                   END
082900200529     C*
083000200529     C/COPY WNCPYSRC,SE2520C003
083100200529     CLR         *IN46     IFEQ *ON                                                           CER001
083200200529     CLR                   CLOSESETRX1PD                                                      CER001
083300200529     CLR                   ENDIF                                                              CER001
083400200529      *                                                                                       CER001
083500200529      *                                                                                       251887
083600200529      ** If S01401 is on and CSW003 is off, delete 1 record each from                         251887
083700200529      ** files TRADSDX1 and TRADSDX2.                                                         251887
083800200529      *                                                                                       251887
083900200529     CLR         S01401    IFEQ 'Y'                                                           251887
084000200529     CLR         CSW003    ANDEQ'N'                                                           251887
084100200529     CLR                   MOVE '0'       *IN28                                               251887
084200200529     CLR                   MOVE '0'       *IN34                                               251887
084300200529     CLR                   READ TRADSD10                 28                                   251887
084400200529      *                                                                                       251887
084500200529     CLR         *IN28     DOWEQ'0'                                                           251887
084600200529      *                                                                                       251887
084700200529     CLR         KEY1      CHAINHISTRAD              35                                       251887
084800200529      *                                                                                       251887
084900200529      ** Delete records from TRADSDX1 and TRADSDX2 if no record found                         251887
085000200529      ** in PF/HSTTRD.                                                                        251887
085100200529      *                                                                                       251887
085200200529     CLR         *IN35     IFEQ '1'                                                           251887
085300200529     CLR         RECIX     OREQ '*'                                                           251887
085400200529     CLR         KEY1      CHAINTRADSDY1             34                                       251887
085500200529     CLR         *IN34     IFEQ '0'                                                           251887
085600200529     CLR                   DELETTRADSDD1                                                      251887
085700200529     CLR                   ENDIF                                                              251887
085800200529     CLR         KEY1      CHAINTRADSDY2             34                                       251887
085900200529     CLR         *IN34     IFEQ '0'                                                           251887
086000200529     CLR                   DELETTRADSDD2                                                      251887
086100200529     CLR                   ENDIF                                                              251887
086200200529     CLR                   ENDIF                                                              251887
086300200529      *                                                                                       251887
086400200529     CLR                   READ TRADSD10                 28                                   251887
086500200529     CLR                   ENDDO                                                              251887
086600200529     CLR                   ENDIF                                                              251887
086700200529      *                                                                                       251887
086800200529      ** If S01401 is on and CSW003 is off, delete 2 records each from                        251887
086900200529      ** files TRADSDX1 and TRADSDX2, if they exist.                                          251887
087000200529      *                                                                                       251887
087100200529     CLR         S01401    IFEQ 'Y'                                                           251887
087200200529     CLR         CSW003    ANDEQ'Y'                                                           251887
087300200529     CLR                   MOVE '0'       *IN28                                               251887
087400200529     CLR                   MOVE '0'       *IN34                                               251887
087500200529     CLR                   READ TRADSD10                 28                                   251887
087600200529      *                                                                                       251887
087700200529     CLR         *IN28     DOWEQ'0'                                                           251887
087800200529      *                                                                                       251887
087900200529     CLR         KEY1      CHAINHISTRAD              35                                       251887
088000200529      *                                                                                       251887
088100200529      ** Delete records from TRADSDX1 and TRADSDX2 if no record found                         251887
088200200529      ** in PF/HSTTRD.                                                                        251887
088300200529      *                                                                                       251887
088400200529     CLR         *IN35     IFEQ '1'                                                           251887
088500200529     CLR         RECIX     OREQ '*'                                                           251887
088600200529     CLR                   MOVELTDRF      W#TDRF                                              251887
088700200529     CLR                   MOVE 'A'       W#WHEN                                              251887
088800200529      *                                                                                       251887
088900200529     CLR         DY1KY     CHAINTRADSDY1             34                                       251887
089000200529     CLR         *IN34     IFEQ '0'                                                           251887
089100200529     CLR                   DELETTRADSDD1                                                      251887
089200200529     CLR                   MOVE 'B'       W#WHEN                                              251887
089300200529     CLR         DY1KY     CHAINTRADSDY1             34                                       251887
089400200529     CLR         *IN34     IFEQ '0'                                                           251887
089500200529     CLR                   DELETTRADSDD1                                                      251887
089600200529     CLR                   ENDIF                                                              251887
089700200529     CLR                   ENDIF                                                              251887
089800200529      *                                                                                       251887
089900200529     CLR                   MOVE 'A'       W#WHEN                                              251887
090000200529     CLR         DY1KY     CHAINTRADSDY2             34                                       251887
090100200529     CLR         *IN34     IFEQ '0'                                                           251887
090200200529     CLR                   DELETTRADSDD2                                                      251887
090300200529     CLR                   MOVE 'B'       W#WHEN                                              251887
090400200529     CLR         DY1KY     CHAINTRADSDY2             34                                       251887
090500200529     CLR         *IN34     IFEQ '0'                                                           251887
090600200529     C*LR*******           DELETTRADSDD1                                               251887 254290
090700200529     CLR                   DELETTRADSDD2                                                      254290
090800200529     CLR                   ENDIF                                                              251887
090900200529     CLR                   ENDIF                                                              251887
091000200529     CLR                   ENDIF                                                              251887
091100200529      *                                                                                       251887
091200200529     CLR                   READ TRADSD10                 28                                   251887
091300200529     CLR                   ENDDO                                                              251887
091400200529     CLR                   ENDIF                                                              251887
091500200529     C*
091600200529     CLR                   END
091700200529     C*
091800200529     C*****************************************************************
091900200529      /EJECT
092000200529     C*****************************************************************
092100200529     C**                                                              *
092200200529     C**   DLTREC SR. TO FLAG RECORDS AND COUNT AS DELETED            *
092300200529     C**                                                              *
092400200529     C*****************************************************************
092500200529     C**
092600200529     CSR         DLTREC    BEGSR                           *** DLTREC  ***
092700200529     C*                                                                   S01486
092800200529     C**  If Portfolio Management is present                              S01486
092900200529     C*                                                                   S01486
093000200529     C           BGPFMG    IFEQ 'Y'                                       S01486
093100200529     C*                                                                   S01486
093200200529     C** IF PORTFOLIO REFERENCE NOT BLANK AND TRADE TYPE IS 'TS' AND      S01486
093300200529     C** RECID IS 'D' THEN UPDATE PM CHANGES TO HISTORIC TURNOVER FILE    S01486
093400200529     C*                                                                   S01486
093500200529     C           PTFR      IFNE *BLANK                                    S01486
093600200529     C           TDTP      ANDEQ'TS'                                      S01486
093700200529     C           RECIX     ANDEQ'D'                                       S01486
093800200529     C                     EXSR UPDTVF                                    S01486
093900200529     C                     END                                            S01486
094000200529     C*                                                                   S01486
094100200529     C                     END                                            S01486
094200200529     C*
094300200529     C* Flag Trade record and count as deleted
094400200529     C*
094500200529     C***                  MOVE '*'       RECIX                                               095907
094600200529     C***                  EXCPTDELHST                                                        095907
094700200529     C/COPY WNCPYSRC,SE2520C006
094800200529     C                     ADD  1         HTDEL
094900200529     C*
095000200529     C/COPY WNCPYSRC,SE2520CCP1
095100200529      *                                                                                       CER001
095200200529     C           *IN46     IFEQ *ON                                                           CER001
095300200529     C           TDRF      CHAINSETRX1PD             86                                       CER001
095400200529     C           *IN86     IFEQ *OFF                                                          CER001
095500200529     C                     DELETTRADSDD6                                                      CER001
095600200529     C                     ENDIF                                                              CER001
095700200529     C                     ENDIF                                                              CER001
095800200529      *                                                                                       202689
095900200529      ** If Switchable Feature S01401 is on and CSW003 is off, only                           202689
096000200529      ** one record must be deleted from TRADSDX1/TRADSDX2                                    202689
096100200529      *                                                                                       202689
096200200529     C           S01401    IFEQ 'Y'                                                           202689
096300200529     C           CSW003    ANDEQ'N'                                                           202689
096400200529     C           KEY1      CHAINTRADSDY1             34                                       202689
096500200529     C           *IN34     IFEQ '0'                                                           202689
096600200529     C                     DELETTRADSDD1                                                      202689
096700200529     C                     ENDIF                                                              202689
096800200529     C           KEY1      CHAINTRADSDY2             34                                       202689
096900200529     C           *IN34     IFEQ '0'                                                           202689
097000200529     C                     DELETTRADSDD2                                                      202689
097100200529     C                     ENDIF                                                              202689
097200200529     C                     ENDIF                                                              202689
097300200529     C*****************************************************************                       202689
097400200529      *                                                                                       202689
097500200529      ** If both features are on, more than one record must be                                202689
097600200529      ** deleted from file TRADSDX1                                                           202689
097700200529      ** and TRADSDX2.                                                                        251887
097800200529      *                                                                                       202689
097900200529     C           S01401    IFEQ 'Y'                        IF*1                               202689
098000200529     C           CSW003    ANDEQ'Y'                                                           202689
098100200529     C*                                                                                       202689
098200200529     C           DY1KY     KLIST                                                              202689
098300200529     C                     KFLD           W#TDRF  6                                           202689
098400200529     C                     KFLD           W#WHEN  1                                           202689
098500200529     C*                                                                                       202689
098600200529     C                     MOVELTDRF      W#TDRF                                              202689
098700200529     C                     MOVE 'A'       W#WHEN                                              202689
098800200529     C*                                                                                       202689
098900200529     C           DY1KY     CHAINTRADSDY1             40                                       202689
099000200529     C*                                                                                       202689
099100200529     C           *IN40     IFEQ *OFF                       IF*2                               202689
099200200529     C                     DELETTRADSDD1                                                      202689
099300200529     C                     MOVE 'B'       W#WHEN                                              202689
099400200529     C*                                                                                       202689
099500200529     C           DY1KY     CHAINTRADSDY1             40                                       202689
099600200529     C*                                                                                       202689
099700200529     C           *IN40     IFEQ *OFF                       IF*3                               202689
099800200529     C                     DELETTRADSDD1                                                      202689
099900200529     C                     ENDIF                           FI*3                               202689
100000200529     C*                                                                                       202689
100100200529     C                     ENDIF                           FI*2                               202689
100200200529     C                     MOVE 'A'       W#WHEN                                              251887
100300200529     C           DY1KY     CHAINTRADSDY2             40                                       251887
100400200529     C           *IN40     IFEQ '0'                                                           251887
100500200529     C                     DELETTRADSDD2                                                      251887
100600200529     C                     MOVE 'B'       W#WHEN                                              251887
100700200529     C           DY1KY     CHAINTRADSDY2             40                                       251887
100800200529     C           *IN40     IFEQ '0'                                                           251887
100900200529     C**********           DELETTRADSDD1                                               251887 254290
101000200529     C                     DELETTRADSDD2                                                      254290
101100200529     C                     ENDIF                                                              251887
101200200529     C                     ENDIF                                                              251887
101300200529     C*                                                                                       202689
101400200529     C                     ENDIF                           FI*1                               202689
101500200529     C*
101600200529     C* Flag all corresponding settlement records and count as deleted
101700200529     C*
101800200529     C           TDRF      SETLLSETLEDF
101900200529     C                     SETOF                     33
102000200529     C           *IN33     DOWEQ'0'
102100200529     C           TDRF      READESETLEDF                  33
102200200529     C           *IN33     IFEQ '0'
102300200529     C****       RECI      ANDNE'*'                                                           095907
102400200529     C*********************MOVE '*'       RECI                            E22404
102500200529     C*********************EXCPTDELSET                                    E22404
102600200529     C*********************ADD  1         TSDEL                           E22404
102700200529     C*                                                                   E22404
102800200529     C* Only add to TSDEL if RECI = 'D', not 'H'.                         E22404
102900200529     C*                                                                   E22404
103000200529     C** AS FIELDS ARE ALL RESET WHEN DROP RUNS USE ALL FOR REPORT                            095907
103100200529     C***********RECI      IFEQ 'D'                                                    E22404 095907
103200200529     C                     ADD  1         TSDEL                           E22404
103300200529     C***********          END                                                         E22404 095907
103400200529     C***********          MOVE '*'       RECI                                         E22404 095907
103500200529     C                     DELETSETLEDF                                                       095907
103600200529     C***********          EXCPTDELSET                                                 E22404 095907
103700200529     C                     END
103800200529     C                     END
103900200529     C*
104000200529     C*                                                                   S01269
104100200529     C* Flag all corresponding authoristion records as deleted            S01269
104200200529     C*                                                                   S01269
104300200529     C                     SETOF                     33                   S01269
104400200529     C           TDRF      SETLLTRAUTDF              33                   S01269
104500200529     C           *IN33     DOWEQ'0'                                       S01269
104600200529     C           TDRF      READETRAUTDF                  33               S01269
104700200529     C           *IN33     IFEQ '0'                                       S01269
104800200529     C           RECI      ANDNE'*'                                       S01269
104900200529     C***                  MOVE '*'       RECI                                         S01269 095907
105000200529     C***                  UPDATTRAUTDF                                                S01269 095907
105100200529     C                     DELETTRAUTDF                                                       095907
105200200529     C                     END                                            S01269
105300200529     C                     END                                            S01269
105400200529     C                     DELETHSTTRDF                                                       095907
105500200529     C*
105600200529     C/COPY WNCPYSRC,SE2520C014
105700200529     CSR                   ENDSR
105800200529     C*
105900200529     C*****************************************************************
106000200529      /EJECT                                                              S01486
106100200529     C*===================================================================S01486
106200200529     C** UPDTVF      :  S/R TO UPDATE PM CHANGES TO HISTORIC TURNOVER FILES01486
106300200529     C*===================================================================S01486
106400200529     C*                                                                   S01486
106500200529     C           UPDTVF    BEGSR                           **UPDTVF BSR **S01486
106600200529     C*                                                                   S01486
106700200529     C** CHAIN TO INVTP WITH INVESTMENT TYPE AND NOMINAL CURRENCY         S01486
106800200529     C** TO GET THE PM INTRUMENT TYPE                                     S01486
106900200529     C*                                                                   S01486
107000200529     C           IVTPKY    CHAININVTPDF              81                   S01486
107100200529     C           *IN81     IFEQ '1'                                       S01486
107200200529     C           *LOCK     IN   LDA                        ***************S01486
107300200529     C                     Z-ADD09        DBASE            **DB ERROR 09**S01486
107400200529     C                     MOVEL'INVTP'   DBFILE           ***************S01486
107500200529     C                     MOVELIVTPDS    DBKEY                           S01486
107600200529     C                     OUT  LDA                                       S01486
107700200529     C                     EXSR *PSSR                                     S01486
107800200529     C                     WRITEHEADAU                                    S01486
107900200529     C                     WRITEERROR                                     S01486
108000200529     C                     SETON                     U7U8LR               S01486
108100200529     C                     RETRN                                          S01486
108200200529     C                     END                                            S01486
108300200529     C*                                                                   S01486
108400200529     C**  Chain to SDPLINPD with instrument type to get display group     S01486
108500200529     C*                                                                   S01486
108600200529     C                     CALL 'AOPLINR0'                                S01486
108700200529     C                     PARM *BLANKS   @RTCD                           S01486
108800200529     C                     PARM '*KEY   ' @OPTN                           S01486
108900200529     C                     PARM INNR      WLINNR  3                       S01486
109000200529     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
109100200529     C*                                                                   S01486
109200200529     C           @RTCD     IFNE *BLANK                                    S01486
109300200529     C           *LOCK     IN   LDA                                       S01486
109400200529     C                     Z-ADD17        DBASE            ***************S01486
109500200529     C                     MOVE 'SDPLINPD'DBFILE           * DB ERROR 17 *S01486
109600200529     C                     MOVELINNR      DBKEY            ***************S01486
109700200529     C                     OUT  LDA                                       S01486
109800200529     C                     EXSR *PSSR                                     S01486
109900200529     C                     WRITEHEADAU                                    S01486
110000200529     C                     WRITEERROR                                     S01486
110100200529     C                     MOVE '1'       *INU7                           S01486
110200200529     C                     MOVE '1'       *INU8                           S01486
110300200529     C                     MOVE '1'       *INLR                           S01486
110400200529     C                     RETRN                                          S01486
110500200529     C                     END                                            S01486
110600200529     C*                                                                   S01486
110700200529     C** CONVERT THE TRADE DATE TO DDMMYY OR MMDDYY FORMAT                S01486
110800200529     C*                                                                   S01486
110900200529     C                     Z-ADDTDDT      ZDAYNO                          S01486
111000200529     C                     EXSR ZDATE2                                    S01486
111100200529     C                     MOVE ZDATE     WWDATE                          S01486
111200200529     C           *IN98     IFEQ '1'                                       S01486
111300200529     C                     MOVE WWDAY     WWMTHN                          S01486
111400200529     C                     END                                            S01486
111500200529     C*                                                                   S01486
111600200529     C** CHAIN TO PM CHANGES TO HISTORIC TURNOVER FILE                    S01486
111700200529     C** TO KNOW IF RECORD ALREADY EXISTS                                 S01486
111800200529     C*                                                                   S01486
111900200529     C                     MOVE TCNR      SCCNUM                          S01486
112000200529     C                     MOVELPTFR      SCPTFR                          S01486
112100200529     C                     MOVELPDDSPG    SCDSPG                          S01486
112200200529     C                     MOVELINNR      SCINNR                          S01486
112300200529     C                     MOVELTNMC      SCICCY                          S01486
112400200529     C**********           Z-ADDSIDY      SCLIND                                     S01486 BUG23967
112500200529     C                     MOVE LOIC      SCLOIC                                            BUG23967
112600200529     C                     Z-ADDWWYEAR    SCYRNO                          S01486
112700200529     C                     Z-ADDWWMTHN    SCMTHN                          S01486
112800200529     C           CHTVKY    CHAINPMCHTVP0             82                   S01486
112900200529     C*                                                                   S01486
113000200529     C** IF ALREADY EXISTS THEN UPDATE ELSE WRITE                         S01486
113100200529     C*                                                                   S01486
113200200529     C           *IN82     IFEQ '0'                                       S01486
113300200529     C*                                                                   S01486
113400200529     C           SCTNVR    ADD  TCSR      SCTNVR                          S01486
113500200529     C                     UPDATPMCHTVP0                                  S01486
113600200529     C*                                                                   S01486
113700200529     C                     ELSE                                           S01486
113800200529     C                     MOVEL'D'       SCRECI                          S01486
113900200529     C                     Z-ADDTCSR      SCTNVR                          S01486
114000200529     C                     Z-ADD0         SCTNVF                          S01486
114100200529     C                     Z-ADD0         SCNUCO                          S01486
114200200529     C                     WRITEPMCHTVP0               83                 S01486
114300200529     C           *IN83     IFEQ '1'                                       S01486
114400200529     C           *LOCK     IN   LDA                        ***************S01486
114500200529     C                     Z-ADD10        DBASE            **DB ERROR 10**S01486
114600200529     C                     MOVEL'INVTP'   DBFILE           ***************S01486
114700200529     C                     MOVELIVTPDS    DBKEY                           S01486
114800200529     C                     OUT  LDA                                       S01486
114900200529     C                     EXSR *PSSR                                     S01486
115000200529     C                     WRITEHEADAU                                    S01486
115100200529     C                     WRITEERROR                                     S01486
115200200529     C                     SETON                     U7U8LR               S01486
115300200529     C                     RETRN                                          S01486
115400200529     C                     END                                            S01486
115500200529     C*                                                                   S01486
115600200529     C                     END                                            S01486
115700200529     C*                                                                   S01486
115800200529     C                     ENDSR                           **UPDTVF ESR **S01486
115900200529     C*                                                                   S01486
116000200529     C*===================================================================S01486
116100200529      /EJECT                                                              S01486
116200200529     C*****************************************************************
116300200529     C**                                                              *
116400200529     C**   PRINTD SR. TO PRINT DETAIL RECORDS                         *
116500200529     C**                                                              *
116600200529     C*****************************************************************
116700200529     C**
116800200529     CSR         PRINTD    BEGSR                           *** PRINTD  ***
116900200529      *                                                                   CAC005
117000200529      ** If CAC005 is on, retrieve user book from AOBKPCR0.               CAC005
117100200529      *                                                                   CAC005
117200200529     C           CAC005    IFEQ 'Y'                                       CAC005
117300200529     C                     CALL 'AOBKPCR0'                                CAC005
117400200529     C                     PARM           PRTCD   7                       CAC005
117500200529     C                     PARM '*USER  ' POPTN   7                       CAC005
117600200529     C           PMBKCD    PARM *BLANKS   PMBKCD  2                       CAC005
117700200529     C           PMPRFC    PARM *BLANKS   PMPRFC  4                       CAC005
117800200529     C                     PARM TDBK      PMPSBK  2                       CAC005
117900200529      *                                                                   CAC005
118000200529     C           PRTCD     IFEQ *BLANKS                                   CAC005
118100200529     C                     MOVELPMBKCD    TDBK                            CAC005
118200200529     C                     ENDIF                                          CAC005
118300200529     C                     ENDIF                                          CAC005
118400200529     C*
118500200529     C* Convert Trade date to DDMMMYY format
118600200529     C*
118700200529     C                     Z-ADDTDDT      ZDAYNO
118800200529     C                     EXSR ZDATE2
118900200529     C                     MOVE ZADATE    TRDDAT
119000200529     C*
119100200529     C* Convert Value date to DDMMMYY format
119200200529     C*
119300200529     C                     Z-ADDTDVD      ZDAYNO
119400200529     C                     EXSR ZDATE2
119500200529     C                     MOVE ZADATE    VALDAT
119600200529     C*
119700200529     C* Fetch Client shortname
119800200529     C*
119900200529     C                     MOVE *BLANKS   CSNM
120000200529     C           TCNR      CHAINCLINTCBF             70
120100200529     C  N70      CSNM      COMP *BLANKS                  70
120200200529     C*
120300200529     C* Format Nominal sum for printing  - Print unsigned
120400200529     C*
120500200529     C           NOML      IFLT *ZEROS
120600200529     C                     Z-SUBNOML      NOML
120700200529     C                     END
120800200529     C*
120900200529     C                     Z-ADD*ZEROS    ZFLD15
121000200529     C                     MOVE NOML      ZFLD15
121100200529     C                     Z-ADDTNMD      ZDECS
121200200529     C                     MOVE 'J'       ZECODE
121300200529     C                     EXSR ZSEDIT
121400200529     C                     MOVE ZOUT21    NOMNAL
121500200529     C*
121600200529     C* Fetch Nominal Currency decimal places
121700200529     C*
121800200529     C                     MOVE *BLANKS   KEY12A
121900200529     C                     MOVELTNMC      WORK4A  4
122000200529     C                     MOVE '1'       WORK4A
122100200529     C                     MOVEL'20'      KEY12A
122200200529     C                     MOVE WORK4A    KEY12A
122300200529     C           KEY12A    CHAINTABTG10F             33
122400200529     C  N33      RECI      COMP '*'                      33
122500200529     C           *IN33     IFEQ '1'                        ***************
122600200529     C           *LOCK     IN   LDA                        ***************S01117
122700200529     C***********          MOVEL'04'      DBASE            **DB ERROR 04**
122800200529     C                     Z-ADD4         DBASE            **DB ERROR 04**
122900200529     C                     MOVEL'TABLE'   DBFILE           ***************
123000200529     C                     MOVELKEY12A    DBKEY
123100200529     C                     OUT  LDA                                       S01117
123200200529     C                     EXSR *PSSR                                     S01117
123300200529     C                     WRITEHEADAU
123400200529     C                     WRITEERROR
123500200529     C*0*********          WRITETRAILAU                                   E29170
123600200529     C                     SETON                     LRU7U8
123700200529     C                     RETRN
123800200529     C                     END
123900200529     C*
124000200529     C* Format Purchased Interest for printing
124100200529     C*
124200200529     C                     Z-ADD*ZEROS    ZFLD15
124300200529     C                     MOVE ITRA      ZFLD15
124400200529     C                     Z-ADDCDP       ZDECS
124500200529     C                     MOVE 'J'       ZECODE
124600200529     C                     EXSR ZSEDIT
124700200529     C                     MOVE ZOUT21    PURINT
124800200529     C*
124900200529     C* Format Countervalue for printing
125000200529     C*
125100200529     C                     Z-ADD*ZEROS    ZFLD15
125200200529     C                     MOVE TCTR      ZFLD15
125300200529     C                     Z-ADDCDP       ZDECS
125400200529     C                     MOVE 'J'       ZECODE
125500200529     C                     EXSR ZSEDIT
125600200529     C                     MOVE ZOUT21    CVALUE
125700200529     C*
125800200529     C* Open printer file and print heading if first deleted record for
125900200529     C* branch
126000200529     C*
126100200529     C           *IN32     IFEQ '0'
126200200529     C           *IN36     IFEQ '1'                                       E29170
126300200529     C                     WRITETRAILP1                                   E29170
126400200529     C                     CLOSESE2520P1                                  E29170
126500200529     C                     SETOF                     36                   042027
126600200529     C                     END                                            E29170
126700200529     C*                                                                   E29170
126800200529     C                     OPEN SE2520P1
126900200529     C                     Z-ADD*ZEROS    PAGE
127000200529     C                     WRITEHEADL2
127100200529     C                     Z-ADD10        LCOUNT  30
127200200529     C                     SETON                     32
127300200529     C******               Z-ADD0         PAGE                                         E29170 095907
127400200529     C                     SETON                     36                   E29170
127500200529     C                     Z-ADD10        LCOUNT  30                      E29170
127600200529     C*                                                                   E29170
127700200529     C** RCF Processing for Detail Printer File                           E29170
127800200529     C*                                                                   E29170
127900200529     C                     EXSR RCFP1                                     E29170
128000200529     C                     END
128100200529     C*
128200200529     C* Check for overflow
128300200529     C*
128400200529     C***********LCOUNT    IFGT 58                                        097131
128500200529     C           LCOUNT    IFGT 56                                        097131
128600200529     C                     WRITEHEADL2
128700200529     C                     Z-ADD10        LCOUNT
128800200529     C                     END
128900200529     C*
129000200529     C* Print Detail line
129100200529     C*
129200200529     C                     WRITEDETAIL
129300200529     C                     ADD  1         LCOUNT
129400200529     C*
129500200529     CSR                   ENDSR
129600200529     C*
129700200529      *****************************************************************   S01117
129800200529      /EJECT                                                              S01117
129900200529      *****************************************************************   S01117
130000200529      *                                                               *   S01117
130100200529      *  *PSSR  - Error control subroutine                            *   S01117
130200200529      *                                                               *   S01117
130300200529      *****************************************************************   S01117
130400200529      *                                                                   S01117
130500200529     C           *PSSR     BEGSR                           ** *PSSR **    S01117
130600200529     C**                                                                  S01117
130700200529     C           @RUN      IFEQ *BLANKS                                   S01117
130800200529     C                     MOVE 'Y'       @RUN    1                       S01117
130900200529     C                     DUMP                                           S01117
131000200529     C                     END                                            S01117
131100200529     C**                                                                  S01117
131200200529     C                     ENDSR                                          S01117
131300200529      *                                                                   S01117
131400200529     C*****************************************************************
131500200529     C/EJECT                                                              E29170
131600200529     C********************************************************************E29170
131700200529     C*                                                                   E29170
131800200529     C*  RCFP1 -- SUBROUTINE TO REGISTER P1 PRINTER FILE VIA RCF          E29170
131900200529     C*                                                                   E29170
132000200529     C********************************************************************E29170
132100200529     C*                                                                   E29170
132200200529     C           RCFP1     BEGSR                            ** RCFP1 **   E29170
132300200529     C*                                                                   E29170
132400200529     C**      ENSURE REPORT SPOOL FILE RECORDED BY RCF                    E29170
132500200529     C*                                                                   E29170
132600200529     C                     Z-ADDSFNUM     ZSNUM   60                      E29170
132700200529     C**                                                                  E29170
132800200529     C                     CALL 'ZSFILE'                                  E29170
132900200529     C                     PARM           SEQ     5                       E29170
133000200529     C                     PARM TDBA      SENTY   3                       E29170
133100200529     C                     PARM           SFILE                           E29170
133200200529     C                     PARM           ZSNUM                           E29170
133300200529     C                     PARM           ZSERR   1                       E29170
133400200529     C*                                                                   E29170
133500200529     C           ZSERR     IFEQ 'Y'                                       E29170
133600200529     C*                                                                   E29170
133700200529     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       E29170
133800200529     C*                                                                   E29170
133900200529     C                     SETON                     U7U8LR               E29170
134000200529     C                     RETRN                                          E29170
134100200529     C                     END                                            E29170
134200200529     C*                                                                   E29170
134300200529     C                     ENDSR                                          E29170
134400200529     C*                                                                   E29170
134500200529     C********************************************************************E29170
134600200529     C/EJECT                                                              E29170
134700200529     C********************************************************************E29170
134800200529     C*                                                                   E29170
134900200529     C*  RCFAU -- SUBROUTINE TO REGISTER AU PRINTER FILE VIA RCF          E29170
135000200529     C*                                                                   E29170
135100200529     C********************************************************************E29170
135200200529     C*                                                                   E29170
135300200529     C           RCFAU     BEGSR                            ** RCFAU **   E29170
135400200529     C*                                                                   E29170
135500200529     C**      ENSURE AUDIT SPOOL FILE RECORDED BY RCF                     E29170
135600200529     C*                                                                   E29170
135700200529     C                     Z-ADDSFNUMU    ZSNUMU  60                      E29170
135800200529     C**                                                                  E29170
135900200529     C                     CALL 'ZSFILE'                                  E29170
136000200529     C                     PARM           SEQ                             E29170
136100200529     C                     PARM *BLANKS   SENTY                           E29170
136200200529     C                     PARM           SFILEU                          E29170
136300200529     C                     PARM           ZSNUMU                          E29170
136400200529     C                     PARM *BLANK    ZSERR                           E29170
136500200529     C*                                                                   E29170
136600200529     C           ZSERR     IFEQ 'Y'                                       E29170
136700200529     C*                                                                   E29170
136800200529     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       E29170
136900200529     C*                                                                   E29170
137000200529     C                     SETON                     U7U8LR               E29170
137100200529     C                     RETRN                                          E29170
137200200529     C                     END                                            E29170
137300200529     C*                                                                   E29170
137400200529     C                     ENDSR                                          E29170
137500200529     C*                                                                   E29170
137600200529     C*****************************************************************   E29170
137700200529      /EJECT
137800200529     C/COPY ZSRSRC,ZDATE2Z4
137900200529      /EJECT
138000200529     C/COPY ZSRSRC,ZICDSEZ1
138100200529      /EJECT
138200200529     C/COPY ZSRSRC,ZSEDITZ3
138300200529      /EJECT
138400200529     C/COPY ZSRSRC,ZSYSTMZ1
138500200529     O/EJECT
138600200529     O**TRADSDF*E                DELHST                                   S01176
138700200529     O***HSTTRDF E                DELHST                                               S01176 095907
138800200529     O***                      RECIX                                                          095907
138900200529     O***SETLEDF E                DELSET                                                      095907
139000200529     O***                      RECI                                                           095907
139100200529     O*
139200200529     O/COPY WNCPYSRC,SE2520OOP1
139300200529     O*
139400200529      /EJECT
139500200529      ***
139600200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
1397002005290366073110961461
139800200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
139900200529000031059090120151181212243273304334365
140000200529**   ZMNM - MONTHS SHORT NAMES
140100200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
140200200529**  CPY@
140300200529(c) Finastra International Limited 2001
