000100200604     H
000200200604      *****************************************************************
000300200604/*STD *  RPGBASE                                                      *
000400200604/*EXI *  TEXT('Midas SE Safe custody fee accruals')                   *
000500200604     F*****************************************************************
000600200604     F*                                                               *
000700200604     F*  Midas - Securities Trading Modules                           *
000800200604     F*                                                               *
000900200604     F*  RPG/SE6240 - Safe Custody Fee Accruals                       *
001000200604     F*                                                               *
001100200604     F*  Function:  This Program calculates Fees Accrued on security  *
001200200604     F*  (COB)      positions and Precious Metal Account balances,    *
001300200604     F*             generates accrual postings and provides an accrual*
001400200604     F*             report.                                           *
001500200604     F*                                                               *
001600200604     F*  Called by: SEC6240 - Calculate Safe Custody Fee Accruals     *
001700200604     F*                                                               *
001800200604      *  (c) Finastra International Limited 2001                      *
001900200604      *                                                               *
002000200604      *  Last Amend No. MD045517           Date 01Jun20               *
002100200604      *  Prev Amend No. MD046248           Date 27Oct17               *
002200200604      *                 226449             Date 24Jun15               *
002300200604      *                 MD034776           Date 08Jul15               *
002400200604      *                 AR1067108          Date 11Dec12               *
002500200604      *                 AR1001183A         Date 20Nov12               *
002600200604      *                 CER059             Date 19Jul10               *
002700200604      *                 CER043             Date 19May08               *
002800200604      * Bank Fusion Midas 1.4 Base -----------------------------------*
002900200604      * Midas Plus 1.4 Base 04 ---------------------------------------*
003000200604      * Midas Plus 1.4 Base ------------------------------------------*
003100200604      * Midas Plus 1.3 ----------- Base ------------------------------*
003200200604      *                 CSD027             Date 09Dec05               *
003300200604      *                 CSE071             Date 19Jul05               *
003400200604      *                 CSW037A            Date 02May05               *
003500200604      *                 229857             Date 07Oct04               *
003600200604      *                 226570             Date 27Jun04               *
003700200604      *                 CSD025             Date 11Jan05               *
003800200604      *                 CSW037             Date 15Dec04               *
003900200604      *                 CSW036             Date 15Dec04               *
004000200604      *                 CGL029             Date 01Sep03               *
004100200604      *                 211407             Date 07Jan03               *
004200200604      *                 207543             Date 17Jul02               *
004300200604      *                 194370             Date 12Jul01               *
004400200604      *                 180056             Date 18Oct00               *
004500200604      *                 CSE035             Date 22Apr02               *
004600200604      *                 CGL020             Date 12Dec02               *
004700200604      *                 206316             Date 19Jul02               *
004800200604      * Midas Release 4.01 -------------------------------------------*
004900200604      *                 CPK015             Date 17Jun01               *
005000200604      *                 CSE031             Date 09Nov01               *
005100200604      *                 180707             Date 25Jul00               *
005200200604      *                 179044             Date 17Aug01               *
005300200604      * Midas Release 4 --------------- Base -------------------------*
005400200604      * Midas DBA 3.05 -----------------------------------------------*
005500200604      *                 157193             Date 29Nov00               *
005600200604      * Midas DBA 3.04 -----------------------------------------------*
005700200604      * Midas DBA 3.03 -----------------------------------------------*
005800200604      * Midas DBA 3.02 -----------------------------------------------*
005900200604      *                 CGL007             Date 26Mar99               *
006000200604      * Midas DBA 3.00 ---------------- Base -------------------------*
006100200604      *                 CSD005             Date 01Mar99               *
006200200604      *                 130862             Date 18Oct98               *
006300200604      *                 CTI002             DATE 23SEP98               *
006400200604      *                 151945             DATE 06Jan99               *
006500200604     F*                 CSE005             Date 09Mar98               *
006600200604     F*                 CAC003             Date 25Feb97               *
006700200604     F*                 084704             Date 01AUG96               *
006800200604     F*                 083039             DATE 01AUG96               *
006900200604     F*                 059110             DATE 25JUL96               *
007000200604     F*                 088047             DATE 27JUN96               *
007100200604     F*                 099886             DATE 18APR96               *
007200200604     F*                 100017             DATE 18APR96               *
007300200604     F*                 100125             DATE 26FEB96               *
007400200604     F*                 092961             DATE 04OCT95               *
007500200604     F*                 091522             DATE 15AUG95               *
007600200604     F*                 086491             DATE 15JUN95               *
007700200604     F*                 083825             DATE 12JUN95               *
007800200604     F*                 S01464             DATE 04APR94               *
007900200604     F*                 048360             DATE 11DEC92               *
008000200604     F*                 047719             DATE 24NOV92               *
008100200604     F*                    036734     JPJ     DATE 14APR92               *
008200200604     F*                    B07896     SC      DATE 15JUL91               *
008300200604     F*                    B5945      SC      DATE 15JUL91               *
008400200604     F**                   B5920      DC      DATE 15JUL91               *
008500200604     F**                   R5553              DATE 27FEB91               *
008600200604     F**                   R5516              DATE 27FEB91               *
008700200604     F**                   R0134              DATE 11FEB91               *
008800200604     F**                   R0131              DATE 11FEB91               *
008900200604     F*                                                                  *
009000200604     F*---------------------------------------------------------------*
009100200604     F*                                                               *
009200200604      *  MD045517 - Additional condition for Private Banking customers*
009300200604      *             for Safe custody fee portfolio position processing*
009400200604      *  MD046248 - Finastra Rebranding                               *
009500200604      *  226449 - Recompiled over changes made in /COPY ZDYYRZ3.      *
009600200604      *         - Applied for MD034387.                               *
009700200604      *  MD034776 - Reverse AR1001183A to allow negative interest     *
009800200604      *             rate. (Recompile)                                 *
009900200604      *  AR1067108 - PMC1140 Component failed during Clean COB        *
010000200604      *              Applied fix AR1001183A                           *
010100200604      *  AR1001183A - Coupon rate was still used in computation of    *
010200200604      *              interest instead of using the details in FRN tab *
010300200604      *              (Reopen) (Recompile)                             *
010400200604      *  CER059 - German Feature Upgrade to Delhi                     *
010500200604      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
010600200604      *           (Recompile)                                         *
010700200604      *  CSD027 - Conversion Of Customer Number to Alpha              *
010800200604      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
010900200604      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
011000200604      *  229857 - Recompiled due to change in ZYLDZ2.                 *
011100200604      *  226570 - Recompiled due to change in ZYLDZ2.                 *
011200200604      *  CSD025 - Customer De-Activation                              *
011300200604      *  CSW037 - Additional Field Data on MT300/MT320                *
011400200604      *  CSW036 - Dual SWIFT BIC held on Client Details               *
011500200604      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
011600200604      *  211407 - Recompile after change on copy sources ZYLDZ2,      *
011700200604      *           ZACCRZ1 and ZYCEZ1 for NX/NNX processing.           *
011800200604      *           The change was to call subroutine ZLCD1 instead     *
011900200604      *           of ZLCD in retrieving the PERIOD for NNX processing *
012000200604      *           and ZNCD1 is called instead of ZNCD in retrieving   *
012100200604      *           the WBENCD for NNX processing. Also rewrite tests   *
012200200604      *           for identifying if position is NX,NNX or CUM.       *
012300200604      *  207543 - CEU018 not working on a price basis.                *
012400200604      *           Recompile over changed ZYLDZ2.                      *
012500200604      *  194370 - Recompile after change on copy sources ZYLDZ2,      *
012600200604      *           For securities with divisor basis = '5' and first   *
012700200604      *           coupon date > valuation date (rundate + 1), set     *
012800200604      *           event control date to first coupon date before      *
012900200604      *           processing SR/ZDYYR. This is to ensure that the     *
013000200604      *           correct hypothetical last and next coupon dates are *
013100200604      *           used in deriving the price/yield rate.              *
013200200604      *  180056 - Recompiled over changed in ZDYYRZ3.                 *
013300200604      *  CSE035 - NX/NNX Coupon Payment Processing.                   *
013400200604      *           Recompile over changed ZACCRZ1/ZYLDZ2
013500200604      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
013600200604      *           Information (Recompile)                             *
013700200604      *  206316 - Recompiled over changed ZLCDZ1.                     *
013800200604      *  CPK015 - Conversion of ZYIELD from PLI to RPG.               *
013900200604      *           Recompile over changed ZYLDZ2.                      *
014000200604      *  CSE031 - Coupon Fixing for Floating Rate Notes.              *
014100200604      *           recompilation over amended subroutine ZACCR.        *
014200200604      *  180707 - No Position Settlements generated. Recompile over   *
014300200604      *           changes in /COPY ZNCDZ3.                            *
014400200604      *  179044 - Apply S01522 processing to enable Multi-language    *
014500200604      *           Posting Narratives in Safe Custody Fees.            *
014600200604      *  157193 - Report SE6240P1 is without a header.                *
014700200604      *  CGL007 - Account Postings Enquiry.  Recompile.               *
014800200604      *  CSD005 - Standing Data Account Narrative.  Add new field     *
014900200604      *           to SDACODPD.  Recompilation of programs.            *
015000200604     F*  130862 - Recompiled over ZLCDZ1 & ZDAYSZ2 changes.           *
015100200604      *  CTI002 - Recompiled : File SDACODPD changed                  *
015200200604     F*  151945 - Recompiled Over changed ZDYYRZ3 .                   *
015300200604     F*  CSE005 - Effect of holidays on FRN coupon dates:             *
015400200604     F*           recompilation over amended subroutine ZACCR.        *
015500200604     F*  CAC003 - Profit Centre Accounting Development Phase 3.       *
015600200604     F*  084704 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
015700200604     F*  083039 - RECOMPILE OVER CHANGED ZYLDZ2 SUB.                  *
015800200604     F*  059110 - Recompile over changed ZYLDZ2 sub.                  *
015900200604     F*  088047 - RECOMPILE over change SR/ZYLDZ2.                    *
016000200604     F*  099886 - Rounding problem for partly paid securities.        *
016100200604     F*           Recompile over amended standard subroutine ZACCZ.   *
016200200604     F*  100017 - Position settlement unable to pick up day adjustment*
016300200604     F*           on SECTYD. Therefore subroutine ZDAYSZ2 changed to  *
016400200604     F*           use indicator DADJN to not apply interest rate      *
016500200604     F*           adjustment for amortisation if set to 'N'.          *
016600200604     F*  100125 - Fix 092961/086491 - recompile did not work because  *
016700200604     F*           SR/ZDAYSZ2 is internally defined in the program.    *
016800200604     F*           Amend pgm to use the version in ZSRSRC instead.     *
016900200604     F*           This also applied to ZDAYSZ3, ZDATE1Z2 and ZDATE2Z2.*
017000200604     F*           Note - these subroutines have been removed.         *
017100200604     F*  092961 - Recompile over ZDAYSZ2 which was amended by 086491  *
017200200604     F*           (Wrong number of days calculated for day basis 1    *
017300200604     F*           when start or end day is last day of February)      *
017400200604     F*  091522 - Safe Custody Fees - Private Banking (CSE001)        *
017500200604     F*  086491 - Wrong nbr of days calculated for day basis 1        *
017600200604     F*           when start or end day is last day of February       *
017700200604     F*           Recompiled for ZSRSRC/ZDAYSZ2 changes.              *
017800200604     F*  083825 - Overflow must be checked before writing a           *
017900200604     F*           detail line.                                        *
018000200604     F*  S01464 - Safe Custody Fees                                   *
018100200604     F*    48360  - DO NOT OUTPUT POSTINGS WITH ZERO AMOUNT
018200200604     F*    47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES
018300200604     F*    036734 - Recompiled due to changes on ZYLDZ2                  *
018400200604     F*    B07896 - CALCULATE ACCRUALS ON POSITIONS WITH NO MARKET       *
018500200604     F*             VALUE IF THE CHARGE BASIS IS FLAT                    *
018600200604     F*    B5945  - INCORRECT ACCRUALS FOR DISCOUNT SECURITIES           *
018700200604     F*             WRITE NO DETAILS IF POSITION IS FLAT                 *
018800200604     F*    B5920  - NO ACCRUALS HAVE BEEN CREATED|                       *
018900200604     F*    R5553  - ACCOUNT TYPES WRONG                                  *
019000200604     F*    R5516  - LAST BRACKET MISSING ON NARRATIVE. FIX NOT TESTED.   *
019100200604     F*    R0134  - Field names changes.                                 *
019200200604     F*    R0131  - Changes the presentation on report.                  *
019300200604     F*                                                                  *
019400200604     F********************************************************************
019500200604     F**  C R E A T I O N     P A R A M E T E R S                        *
019600200604     F*                                                                  *
019700200604     F*                                                                  *
019800200604     F********************************************************************
019900200604     F/EJECT
020000200604     F********************************************************************
020100200604     F*
020200200604     F**      FILE DEFINITIONS
020300200604     F**     ------------------
020400200604     F*
020500200604     F*****SAFE*CUSTODY*CUSTOMERS.*PREFIX*-*AZ/BB/BF*******************   S01464
020600200604     F***SCCUSTL1IF**E        K        DISK         KINFSR *PSSR          S01464
020700200604     F*
020800200604     F**   BANK*DETAILS. PREFIX - BJ
020900200604     FSDBANKPDIF  E                    DISK         KINFSR *PSSR
021000200604     F*
021100200604     F**   BRANCH DETAILS. PREFIX - A8
021200200604     FSDBRCHL1IF  E           K        DISK         KINFSR *PSSR
021300200604     F*****************************************************************   S01464
021400200604     F*****PORTFOLIO*MANAGEMENT*ICD*FILE.*PREFIX*-*P9******************   S01464
021500200604     F***SDPORTPDIF**E                 DISK         KINFSR *PSSR          S01464
021600200604     F*****************************************************************   S01464
021700200604     F*****PORTFOLIO*CUSTOMER*DEFINITION.*PREFIX*-*QB******************   S01464
021800200604     F***SDPLCSPDIF**E        K        DISK         KINFSR *PSSR          S01464
021900200604     F*****************************************************************   S01464
022000200604     F*****PORTFOLIO*DEFINITION.*PREFIX*-*PN***************************   S01464
022100200604     F***PMPORTLLIF**E        K        DISK         KINFSR *PSSR          S01464
022200200604     F*****************************************************************   S01464
022300200604     F*****SECURITY*CUSTOMER*POSITIONS.*PREFIX*-*CS********************   S01464
022400200604     F***SCSEPSLLIF**E        K        DISK         KINFSR *PSSR          S01464
022500200604     F*****************************************************************   S01464
022600200604     F*****PORTFOLIO*CUSTOMER*POSITIONS.*PREFIX*-*QA*******************   S01464
022700200604     F***SCPMPSLLIF**E        K        DISK         KINFSR *PSSR          S01464
022800200604     F*****************************************************************   S01464
022900200604     F*****SAFE*CUSTODY*CHARGE*DEFINITION.*PREFIX*-*SF*****************   S01464
023000200604     F***SCCGCDPDIF**E        K        DISK         KINFSR *PSSR          S01464
023100200604     F*****************************************************************   S01464
023200200604     F*****PRECIOUS*METAL*ACCOUNT*BALANCES*EXTRACT.*PREFIX*-*SE********   S01464
023300200604     F***SCPMABPDIF**E        K        DISK         KINFSR *PSSR          S01464
023400200604     F*                                                                   S01464
023500200604     F**   SAFE CUSTODY CUSTOMERS. PREFIX - AZ/BB/BF                      S01464
023600200604     FSECUSTL1IF  E           K        DISK         KINFSR *PSSR          S01464
023700200604     F*                                                                   S01464
023800200604     F**   Security Customer Positions. Prefix - CS                       S01464
023900200604     FSESEPSLLIF  E           K        DISK         KINFSR *PSSR          S01464
024000200604     F*                                                                   S01464
024100200604     F**   Safe Custody Charge Definition. Prefix - SF                    S01464
024200200604     FSECGCDPDIF  E           K        DISK         KINFSR *PSSR          S01464
024300200604     F*                                                                   S01464
024400200604     F**   Precious Metal Account Balances Extract. Prefix - SG           S01464
024500200604     FSEPMABPDIF  E           K        DISK         KINFSR *PSSR          S01464
024600200604     F*                                                                   091522
024700200604     F**   Portfolio customer definition. prefix - QB                     091522
024800200604     FSDPLCSL0IF  E           K        DISK         KINFSR *PSSR          091522
024900200604     F*                                                                   091522
025000200604     F**   Portfolio definition. prefix - PN                              091522
025100200604     FPMPORTLLIF  E           K        DISK         KINFSR *PSSR          091522
025200200604     F**   Portfolio customer positions. prefix - QA                      091522
025300200604     FSEPMPSL0IF  E           K        DISK         KINFSR *PSSR          091522
025400200604     F*                                                                   R5553
025500200604     FSDACODL0IF  E           K        DISK                               R5553
025600200604     F*
025700200604     F**   CURRENCY DETAILS. PREFIX - A6
025800200604     F***SDCURRJ0IF**E        K        DISK         KINFSR *PSSR          S01464
025900200604     FSDCURRL0IF  E           K        DISK         KINFSR *PSSR          S01464
026000200604     F*
026100200604     F**   SECURITY DETAILS.
026200200604     FSECTY   IF  E           K        DISK         KINFSR *PSSR
026300200604     F*
026400200604     F*****CUSTOMER/INSTRUMENT*CUSTODY*FEE*DETAILS.*PREFIX*-*SC********   S01464
026500200604     F***SCCICFPDIF**E        K        DISK         KINFSR *PSSR          S01464
026600200604     F*****************************************************************   S01464
026700200604     F*****SAFE*CUSTODY*ICD*FILE.*PREFIX*-*SA**************************   S01464
026800200604     F*SCICDPPDUF  E                    DISK         KINFSR *PSSR         B5920
026900200604     F***SCICDPPDIF**E                  DISK         KINFSR *PSSR   B5920 S01464
027000200604     F*****************************************************************   S01464
027100200604     F*****SAFE*CUSTODY*FEES*ACCRUED.*PREFIX*-*PC**********************   S01464
027200200604     F***SCSCFAPDUF**E        K        DISK         KINFSR *PSSR A        S01464
027300200604     F*                                                                   S01464
027400200604     F**   Safe Custody ICD File. Prefix - FB                             S01464
027500200604     FSDSCFEPDIF  E                    DISK         KINFSR *PSSR          S01464
027600200604     F*                                                                   S01464
027700200604     F**   Customer/Instrument Custody Fee Details. Prefix - SC           S01464
027800200604     FSECICFPDIF  E           K        DISK         KINFSR *PSSR          S01464
027900200604     F*                                                                   S01464
028000200604     F**   SAFE CUSTODY FEES ACCRUED. PREFIX - PC                         S01464
028100200604     FSESCFAPDUF  E           K        DISK         KINFSR *PSSR A        S01464
028200200604     F*
028300200604     F**   SAFE CUSTODY FEES POSTING FILE.
028400200604     FGESCPD  O   E           K        DISK         KINFSR *PSSR A
028500200604     F*
028600200604     F**   SAFE CUSTODY FEES POSTING FILE TRAILER
028700200604     FGESCZZ  O   E           K        DISK         KINFSR *PSSR A
028800200604     F*                                                                   S01464
028900200604     F**   ACCOUNT OFFICER DETAILS FILE. PREFIX - AZ                      S01464
029000200604     FSDACOFL1IF  E           K        DISK         KINFSR *PSSR      UC  S01464
029100200604     F*
029200200604     F**   CUSTODY FEES ACCRUED TODAY REPORT.
029300200604     FSE6240P1O   E             21     PRINTER      KINFDS ERF1DS     UC
029400200604     F                                              KINFSR *PSSR
029500200604     F*                                                                   B05945
029600200604     FSEDEV   IF  E           K        DISK                               B05945
029700200604     F*                                                                   S01464
029800200604     FSECEO   IF  E           K        DISK                               S01464
029900200604     F            SNDEVDF                           KRENAMESNDEVDO        S01464
030000200604     F            SEDEVDF                           KRENAMESEDEVDO        S01464
030100200604     F*                                                                   S01464
030200200604     FINVTP   IF  E           K        DISK                               S01464
030300200604     F*
030400200604     F**   CUSTODY FEES ACCRUED TODAY RUN CONTROLS REPORT
030500200604     FSE6240AUO   E             22     PRINTER      KINFDS ERF2DS
030600200604     F                                              KINFSR *PSSR
030700200604     F/COPY WNCPYSRC,SE6240F001
030800200604     F*
030900200604     F*****************************************************************
031000200604     F/EJECT
031100200604     F*****************************************************************
031200200604     F**                                                              *
031300200604     F** ID F  C  H  L    FUNCTION OF INDICATORS                      *
031400200604     F**                 ------------------------                     *
031500200604     F**      10 - Multibranch Indicator                              *   S01464
031600200604     F**   21 - OVERFLOW INDICATOR ON PRINTER FILE                    *
031700200604     F**   22 - OVERFLOW INDICATOR ON RUN CONTROLS                    *
031800200604     F**                                                              *
031900200604     F**      30 - HEADINGS ALREADY WRITTEN ON NEW PAGE INDICATOR     *
032000200604     F**      31 - HEADER 3 NECESSARY INDICATOR                       *
032100200604     F**                                                              *
032200200604     F**      40 - READ FAIL ON SDBANKPD                              *
032300200604     F**      41 - READ FAIL ON SCICDPPD                              *
032400200604     F********42*-*CHAIN*FAIL*ON*SDCURRJ0*USING*BANK*CHARGING*CCY.*****   S01464
032500200604     F**      42 - CHAIN FAIL ON SDCURRL0 USING BANK CHARGING CCY.    *   S01464
032600200604     F**      43 - READ FAIL ON SDPORTPD                              *
032700200604     F**      44 - READ FAIL ON SCCUSTL1                              *
032800200604     F**      45 - CHAIN FAIL ON SDPLCSPD                             *
032900200604     F**      46 - CHAIN FAIL ON SCSCFAPD                             *
033000200604     F**      47 - CHAIN FAIL ON SCSEPSLL                             *
033100200604     F**      48 - CHAIN FAIL ON SECTY                                *
033200200604     F**      49 - CHAIN FAIL ON SCCGCDPD                             *
033300200604     F********50*-*CHAIN*FAIL*ON*SDCURRJ0*USING*NOMINAL*CCY.***********   S01464
033400200604     F**      50 - CHAIN FAIL ON SDCURRL0 USING NOMINAL CCY.          *   S01464
033500200604     F**      51 - CHAIN FAIL ON SCCICFPD                             *
033600200604     F**      52 - CHAIN FAIL ON SDBRCHL1                             *
033700200604     F**      53 - CHAIN FAIL ON SCPMABPD                             *
033800200604     F**      54 - CHAIN FAIL ON PMPORTLL                             *
033900200604     F**      55 - CHAIN FAIL ON SCPMPSLL                             *
034000200604     F********56*-*CHAIN*FAIL*ON*SDCURRJ0*USING*ACCOUNT*CCY.***********   S01464
034100200604     F**      56 - CHAIN FAIL ON SDCURRL0 USING ACCOUNT CCY.          *   S01464
034200200604     F**      57 - CHAIN FAIL ON SDACOFL1                             *   S01464
034300200604     F**      90 - NEGATIVE OR ZERO RESULT ON SUB OPERATION           *   S01464
034400200604     F**                                                              *
034500200604     F*****************************************************************
034600200604     E/EJECT
034700200604     E*****************************************************************
034800200604     E*****************************************************************   S01464
034900200604     E*****QCMDEXC*ARRAY***********************************************   S01464
035000200604     E***********         CMD     1   1 39                                S01464
035100200604     E*****************************************************************   S01464
035200200604     E*****************************************************************
035300200604     E/EJECT
035400200604     E*****************************************************************
035500200604     E*
035600200604     E**   ARRAY FOR COPYRIGHT
035700200604     E                    CPY@    1   1 80
035800200604     E*
035900200604     E*****************************************************************
036000200604     E/EJECT
036100200604     E*****************************************************************
036200200604     E*
036300200604     E**   ARRAY FOR STANDARD SUBROUTINE ZSEDIT
036400200604     E*/COPY ZSRSRC,ZSEDITZ1
036500200604     E                    ZS1        15  1 0
036600200604     E                    ZS2        21  1
036700200604     E*
036800200604     E*****************************************************************
036900200604     E/EJECT
037000200604     E*****************************************************************
037100200604     E*
037200200604     E**   ARRAY FOR STANDARD SUBROUTINE ZPMCRG
037300200604     E*/COPY ZSRSRC,ZPMCRGZ1
037400200604     E                    ZRA        14 15 0             RANGE LIMITS
037500200604     E                    ZRB        15 15 0             INTERNAL RANGE LIMITS
037600200604     E                    ZPC        15 11 7             PERCENTAGES
037700200604     E                    ZCG        15 15 0             FLAT CHARGES
037800200604     E*
037900200604     E*****************************************************************
038000200604     E/EJECT
038100200604     E*****************************************************************
038200200604     E*
038300200604     E**   ARRAY FOR STANDARD SUBROUTINE ZDAYS
038400200604     E*/COPY ZSRSRC,ZDAYSZ1
038500200604     E                    ZF29   14  32  5 0             29TH FEB ARRAY
038600200604     E*
038700200604     E*****************************************************************
038800200604     E/EJECT
038900200604     E*****************************************************************
039000200604     E*
039100200604     E**   ARRAY FOR STANDARD SUBROUTINE ZDYYR
039200200604     E*/COPY ZSRSRC,ZDYYRZ1
039300200604     E***                 CD         12  5 0             CD01-12 ARRAY CE14 GB
039400200604     E                    CD         12  4 0             CD01-12 ARRAY CE14 GB
039500200604     E                    CR         12  1               CR01-12 ARRAY
039600200604     E*
039700200604     E*****************************************************************
039800200604     E/EJECT
039900200604     E*****************************************************************
040000200604     E*
040100200604     E**   ARRAY FOR STANDARD SUBROUTINE ZDATE2
040200200604     E*/COPY ZSRSRC,ZDATE2Z1
040300200604     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
040400200604     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
040500200604     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
040600200604     E*
040700200604     E*****************************************************************
040800200604     E/EJECT
040900200604     E*****************************************************************
041000200604     E*
041100200604     E** ARRAY USED IN CURRENCY AMOUNT CONVERSION
041200200604     E*/COPY ZSRSRC,ZPOWERZ1
041300200604     E                    POWER   1   7  7 3             POWER ARRAY
041400200604     E*
041500200604     E*****************************************************************
041600200604     E/EJECT
041700200604     E*****************************************************************
041800200604     E*
041900200604     E** ARRAY USED IN CURRENCY AMOUNT CONVERSION FOR ZAPNUM
042000200604     E*/COPY ZSRSRC,ZPOWER8Z1
042100200604     E                    POWER8  1   8  8 4             POWER8 ARRAY
042200200604     E*
042300200604     E*****************************************************************
042400200604     E/EJECT
042500200604     E*****************************************************************
042600200604     E*
042700200604     E** ARRAY USED FOR 'POSTING NARRATIVE' ON PF/GESCPD
042800200604     E                    PNARR   1   1 15
042900200604     E*
043000200604     E*****************************************************************
043100200604     E/EJECT
043200200604     E*****************************************************************
043300200604     E*                                                                   S01464
043400200604     E** NUMBER OF DAYS IN EACH MONTH                                     S01464
043500200604     E                    ZFMD   12  12  2               ZFREQ SR. ARRAY  S01464
043600200604     E*
043700200604     E*****************************************************************
043800200604     E*                                                                   S01464
043900200604     E/COPY ZSRSRC,ZACCRZ0                                                S01464
044000200604     E*****************************************************************   S01464
044100200604     E/EJECT                                                              S01464
044200200604     E*****************************************************************   S01464
044300200604     I/EJECT
044400200604     I*****************************************************************
044500200604     I*
044600200604     I**   DATA STRUCTURE FOR COMPILATION - COPYRIGHT INSERTION
044700200604     ICPYR@$      DS
044800200604     I                                        1  80 CPY@
044900200604     I                                        1  20 CPY@$$
045000200604     I*
045100200604     I**   PROGRAM STATUS DATA STRUCTURE
045200200604     IPSDS       SDS
045300200604     I                                      244 253 JOB
045400200604     I                                      254 263 USER
045500200604     I*
045600200604     I**   FILE INFORMATION DATA STRUCTURE
045700200604     IERF1DS      DS
045800200604     I                                       83  92 SFILE                 S01464
045900200604     I                                    B 123 1240SFNUM                 S01464
046000200604     I**   FOR OVERFLOW
046100200604     I                                    B 367 3680LINE
046200200604     IERF2DS      DS
046300200604     I                                       83  92 SFILEU                S01464
046400200604     I                                    B 123 1240SFNUMU                S01464
046500200604     I**   FOR OVERFLOW
046600200604     I                                    B 367 3680LINE1
046700200604     I*                                                                   S01464
046800200604     I** Rundate data area                                                S01464
046900200604     I*                                                                   S01464
047000200604     IRUNDT       DS                             13                       S01464
047100200604     I                                       13  13 MBIN                  S01464
047200200604     I*
047300200604     I**   LOCAL DATA AREA
047400200604     ILDA        UDS                            256
047500200604     I**************************************132 141 DBFILE                S01464
047600200604     I                                      134 141 DBFILE                S01464
047700200604     I                                      142 170 DBKEY
047800200604     I                                      171 180 DBPGM
047900200604     I                                      181 1830DBASE
048000200604     I********************************************************************
048100200604     I/EJECT
048200200604     I********************************************************************
048300200604     I*
048400200604     I**  DATA STRUCTURE FOR 'POSTING NARRATIVE' ON PF/GESCPD
048500200604     IPNART       DS
048600200604     I                                        1  30 WWPNAR
048700200604     I                                        1  15 WWTEXT
048800200604     I                                       16  17 WWSPAC
048900200604     I                                       17  22 WWCUSN
049000200604     I                                       23  24 WWLBRK
049100200604     I                                       25  28 WWPORT
049200200604     I                                       29  30 WWRBRK
049300200604     I**                                                                  B05945
049400200604     I/COPY ZSRSRC,ZYLDZ1                                                 B05945
049500200604     I/COPY ZSRSRC,ZNCDZ2                                                 B05945
049600200604     I********************************************************************
049700200604     I/EJECT
049800200604     I********************************************************************
049900200604     I*
050000200604     I**  FIELD NAME FOR 'POSTING RECORD INDICATOR' ON PF/GESCPD
050100200604     I*
050200200604     I**            '01234567'            C         BITNC                 R5516
050300200604     I********************************************************************
050400200604     I/EJECT
050500200604     I********************************************************************
050600200604     I*
050700200604     I**  DATA STRUCTURE FOR 'ACCOUNT CODE' ON REPORT
050800200604     IACNT        DS
050900200604     I**********                              1  14 WWACNT                                    CGL029
051000200604     I                                        1  20 WWACNT                                    CGL029
051100200604     I**********                              1   60SGCNUM                                    CSD027
051200200604     I                                        1   6 SGCNUM                                    CSD027
051300200604     I                                        7   7 WWDASH
051400200604     I**********                              8  110SGACOD                                    CGL029
051500200604     I**********                             12  12 WWDAS1                                    CGL029
051600200604     I**********                             13  140SGACSQ                                    CGL029
051700200604     I                                        8  170SGACOD                                    CGL029
051800200604     I                                       18  18 WWDAS1                                    CGL029
051900200604     I                                       19  200SGACSQ                                    CGL029
052000200604     I********************************************************************
052100200604     I/EJECT
052200200604     I********************************************************************
052300200604     I*
052400200604     I**  DATA STRUCTURE FOR DATE OF LAST UPDATE ON PF/SCSCFAPD
052500200604     IDATE        DS
052600200604     I                                        1   7 BJMRDT
052700200604     I                                        1   20WWDAYU
052800200604     I                                        3   5 WWMTHU
052900200604     I                                        6   70WWYERU
053000200604     I*
053100200604     I*    MIDAS 'Next Available Transaction No.' Data Area DNATN .
053200200604     IDNATN       DS                              5
053300200604     I                                        1   50FNATN
053400200604     I********************************************************************
053500200604     I/EJECT
053600200604     I********************************************************************
053700200604     I*
053800200604     I**  EXTERNAL DATA STRUCTURE FOR 'EVENT CONTROL DATE' FROM SDSTAT
053900200604     ISDSTAT    EUDS
054000200604     I*
054100200604     I********************************************************************
054200200604     I/EJECT
054300200604     I********************************************************************
054400200604     I*
054500200604     I** DATA STRUCTURE FOR STANDARD SUBROUTINE ZSEDIT
054600200604     I*
054700200604     I*/COPY ZSRSRC,ZSEDITZ2
054800200604     I            DS
054900200604     I                                        1  150WORK15
055000200604     I                                        1  150ZS1
055100200604     I*
055200200604     I********************************************************************
055300200604     I/EJECT
055400200604     I********************************************************************
055500200604     I*
055600200604     I** DATA STRUCTURE FOR STANDARD SUBROUTINE ZDYYR
055700200604     I*
055800200604     I*/COPY ZSRSRC,ZDYYRZ2
055900200604     I*CRDS        DS                                                     B05945
056000200604     I*                                       1   1 CR01                  B05945
056100200604     I*                                       2   2 CR02                  B05945
056200200604     I*                                       3   3 CR03                  B05945
056300200604     I*                                       4   4 CR04                  B05945
056400200604     I*                                       5   5 CR05                  B05945
056500200604     I*                                       6   6 CR06                  B05945
056600200604     I*                                       7   7 CR07                  B05945
056700200604     I*                                       8   8 CR08                  B05945
056800200604     I*                                       9   9 CR09                  B05945
056900200604     I*                                      10  10 CR10                  B05945
057000200604     I*                                      11  11 CR11                  B05945
057100200604     I*                                      12  12 CR12                  B05945
057200200604     I*                                       1  12 CR                    B05945
057300200604     I********************************************************************
057400200604     ISDPORT    E DSSDPORTPD                                              091522
057500200604     I** EXTERNAL DS FOR PM ICD                                           091522
057600200604     ISDMMOD    E DSSDMMODPD                                              091522
057700200604     I** EXTERNAL DS FOR MMOD                                             091522
057800200604     ISDCUST    E DSSDCUSTPD                                                                MD045517
057900200604     I** EXTERNAL DS FOR CUSTOMER DETAILS                                                   MD045517
058000200604     IDSFDY     E DSDSFDY                                                 091522
058100200604     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                091522
058200200604     IDSSDY     E DSDSSDY                                                 091522
058300200604     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                       091522
058400200604     IDSLDY     E DSDSLDY                                                                   MD045517
058500200604     I* DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE                                    MD045517
058600200604     I/COPY WNCPYSRC,SE6240I001
058700200604     I/EJECT
058800200604      *                                                                   179044
058900200604      ** SAR File Details Accessed via access program AOSARDR0            179044
059000200604      *                                                                   179044
059100200604     ISCSARD    E DSSCSARDPD                                              179044
059200200604      *                                                                   179044
059300200604      ** UDC Multi Language Narrative Data Structure                      179044
059400200604      *                                                                   179044
059500200604     ICGPNAR    E DSCGPNARPD                                              179044
059600200604      *                                                                   179044
059700200604      ** Data Structure for Customer and Branch                           179044
059800200604      *                                                                   179044
059900200604     I##PRM1      DS                                                      179044
060000200604     I                                        1   6 A#CUST                179044
060100200604     I                                        7   9 A#BRCA                179044
060200200604     I/EJECT                                                              179044
060300200604     I********************************************************************
060400200604     C*                                                               *
060500200604     C**   KEY LISTS USED IN PROGRAM                                  *
060600200604     C**   -------------------------                                  *
060700200604     C*                                                               *
060800200604     C**   KEY LIST FOR PF/SCSCFAPD
060900200604     C           WWKEY1    KLIST                                      *
061000200604     C                     KFLD           WWBRCH                      *   S01464
061100200604     C                     KFLD           WWCNUM                      *
061200200604     C                     KFLD           WWPTFR                      *
061300200604     C*                                                               *
061400200604     C**   KEY LIST FOR PFSCCICFPD                                    *
061500200604     C           WWKEY2    KLIST                                      *
061600200604     C                     KFLD           WWFGCK                      *
061700200604     C                     KFLD           WWCNOK                      *
061800200604     C                     KFLD           WWCSQK                      *
061900200604     C                     KFLD           WWSSNK                      *
062000200604     C                     KFLD           WWCCYK                      *
062100200604     C                     KFLD           WWIVTK                      *
062200200604     C*                                                               *
062300200604     C**   KEY LIST FOR PF/SCPMABPD
062400200604     C           WWKEY3    KLIST                                      *
062500200604     C                     KFLD           WWCNUM                      *
062600200604     C                     KFLD           WWPTFR                      *
062700200604     C                     KFLD           WWCCYP                      *
062800200604     C                     KFLD           WWACOD                      *
062900200604     C                     KFLD           WWACSQ                      *
063000200604     C*                                                               *   S01464
063100200604     C**   Key List for LF/INVTP                                          S01464
063200200604     C           WWKEY4    KLIST                                      *   S01464
063300200604     C                     KFLD           NMCY                        *   S01464
063400200604     C                     KFLD           SITP                        *   S01464
063500200604     C*                                                               *
063600200604     C**   KEY LIST FOR LF/SEPMPSL0                                       091522
063700200604     C           WWKEY5    KLIST                                      *   091522
063800200604     C                     KFLD           WWCNUM                      *   091522
063900200604     C                     KFLD           WWPTFR                      *   091522
064000200604     C*****************************************************************
064100200604     C/EJECT
064200200604     C*****************************************************************
064300200604     C*
064400200604     C**              START MAIN
064500200604     C**             -------------
064600200604     C*
064700200604     C**   INITIAL PROCESSING
064800200604     C                     EXSR #INIT
064900200604     C*
065000200604     C**   CUSTOMER PROCESSING
065100200604     C                     EXSR #P01
065200200604     C*
065300200604     C**   AUDIT PROCESSING
065400200604     C**   Check first if null indicator is not set on                    S01464
065500200604     C           WWNUIN    IFNE '1'                                       S01464
065600200604     C                     EXSR #P12
065700200604     C                     END                                            S01464
065800200604     C*                                                                   S01464
065900200604     C** Call ZSFILE for AU file                                          S01464
066000200604     C*                                                                   S01464
066100200604     C                     Z-ADDSFNUMU    ZSNUM   60                      S01464
066200200604     C                     CALL 'ZSFILE'                                  S01464
066300200604     C                     PARM           SEQ     5                       S01464
066400200604     C                     PARM *BLANKS   @PARM   3                       S01464
066500200604     C                     PARM           SFILEU                          S01464
066600200604     C                     PARM           ZSNUM                           S01464
066700200604     C                     PARM           ZSERR   1                       S01464
066800200604     C*                                                                   S01464
066900200604     C           ZSERR     IFEQ 'Y'                                       S01464
067000200604     C                     MOVE '1'       *INU7                           S01464
067100200604     C                     MOVE '1'       *INU8                           S01464
067200200604     C                     MOVE '1'       *INLR                           S01464
067300200604     C                     RETRN                                          S01464
067400200604     C                     END                                            S01464
067500200604     C*
067600200604     C**   END PROGRAM
067700200604     C                     MOVE '1'       *INLR
067800200604     C*
067900200604     C*****CLOSE*PRINTER*FILE******************************************   S01464
068000200604     C***********          CLOSESE6240P1                                  S01464
068100200604     C                     RETRN
068200200604     C*
068300200604     C********************************************************************
068400200604     C/EJECT
068500200604     C********************************************************************
068600200604     C*
068700200604     C           #INIT     BEGSR
068800200604     C*                                                                   S01464
068900200604     C** Move the copyright statement                                     S01464
069000200604     C*                                                                   S01464
069100200604     C                     MOVEACPY@      BIS@   80                       S01464
069200200604     C*                                                                   S01464
069300200604     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01464
069400200604     C                     IN   RUNDT                                     S01464
069500200604     C*
069600200604     C**   INITIALISE DB ERROR FIELDS AND STORE PROGRAM NAME FOR
069700200604     C**   DB ERROR FIELD.
069800200604     C**   Prepare LDA                                                    S01464
069900200604     C*                                                                   S01464
070000200604     C           *NAMVAR   DEFN           LDA                             S01464
070100200604     C           *LOCK     IN   LDA                                       S01464
070200200604     C                     MOVE *BLANKS   DBFILE
070300200604     C                     MOVE *BLANKS   DBKEY
070400200604     C                     Z-ADD*ZEROS    DBASE
070500200604     C                     MOVE *BLANKS   DBPGM                           S01464
070600200604     C                     MOVEL'SE6240'  DBPGM
070700200604     C                     OUT  LDA                                       S01464
070800200604     C*
070900200604     C**   RETRIEVE 'EVENT CONTROL DATE' FROM SDSTAT FOR STANDARD
071000200604     C**    SUBROUTINE ZDYYR
071100200604     C                     MOVE MECD      ECD     50
071200200604     C*
071300200604     C**   DEFINE WORK FIELDS
071400200604     C************LIKE     DEFN SABCGC    WWBCGC                          S01464
071500200604     C           *LIKE     DEFN FBBCGC    WWBCGC                          S01464
071600200604     C           *LIKE     DEFN BBCUST    WWCUST
071700200604     C************LIKE     DEFN AZPRTL    WWPLOC                          S01464
071800200604     C************LIKE     DEFN AZACOC    WWACOC                          S01464
071900200604     C           *LIKE     DEFN BBACOC    WWACOC                          S01464
072000200604     C           *LIKE     DEFN SDPTFR    WWPTFR
072100200604     C           *LIKE     DEFN BFCFGC    WWCFGC
072200200604     C           *LIKE     DEFN CSSC      WWCSSC
072300200604     C           *LIKE     DEFN SCCGCO    WWCGCO
072400200604     C           *LIKE     DEFN SCCFGC    WWFGCK
072500200604     C           *LIKE     DEFN SCSESN    WWSSNK
072600200604     C           *LIKE     DEFN SCCCY     WWCCYK
072700200604     C           *LIKE     DEFN SCCCY     WWLCCY
072800200604     C           *LIKE     DEFN SCSITP    WWIVTK
072900200604     C           *LIKE     DEFN SCCNUM    WWCNUM
073000200604     C           *LIKE     DEFN SCCNUM    WWCNOK
073100200604     C           *LIKE     DEFN SCCKSQ    WWCSQK
073200200604     C           *LIKE     DEFN BBBRCD    WWBRCD
073300200604     C           *LIKE     DEFN BBBRCD    WWBRCH                          S01464
073400200604     C           *LIKE     DEFN SDCFAC    WWCFAC
073500200604     C           *LIKE     DEFN SDOSAJ    WWOSAJ
073600200604     C           *LIKE     DEFN SDOSAS    WWOSAS
073700200604     C           *LIKE     DEFN SGACOD    WWACOD
073800200604     C           *LIKE     DEFN SGACSQ    WWACSQ
073900200604     C           *LIKE     DEFN SGBRCA    WWBRCA                          S01464
074000200604     C**
074100200604     C           PMPORK    KLIST
074200200604     C                     KFLD           WWCNUM
074300200604     C                     KFLD           WWPREF  4
074400200604     C*
074500200604     C**   INITIALISE WORK FIELDS
074600200604     C                     MOVE *BLANKS   WWBCGC
074700200604     C                     MOVE *BLANKS   WWCUST
074800200604     C***********          MOVE *BLANKS   WWPLOC                          S01464
074900200604     C***********          MOVE *BLANKS   WWPRTL                          S01464
075000200604     C                     MOVE *BLANKS   WWACOC
075100200604     C                     MOVE *BLANKS   WWPTFR
075200200604     C                     MOVE *BLANKS   WWCFGC
075300200604     C                     MOVE *BLANKS   WWCSSC
075400200604     C                     MOVE *BLANKS   WWCGCO
075500200604     C                     MOVE *BLANKS   WWFGCK
075600200604     C                     MOVE *BLANKS   WWSSNK
075700200604     C                     MOVE *BLANKS   WWCCYK
075800200604     C                     MOVE *BLANKS   WWIVTK
075900200604     C                     MOVE *BLANKS   WWBRCD
076000200604     C                     MOVE *BLANKS   WWBRCH                          S01464
076100200604     C                     MOVE *BLANKS   WWOSAS
076200200604     C                     MOVE *BLANKS   WWBRCA                          S01464
076300200604     C                     MOVE *BLANKS   WWBLHD  1                       S01464
076400200604     C**********           Z-ADD*ZEROS    WWCNUM                                              CSD027
076500200604     C**********           Z-ADD*ZEROS    WWCNOK                                              CSD027
076600200604     C                     MOVE *BLANKS   WWCNUM                                              CSD027
076700200604     C                     MOVE *BLANKS   WWCNOK                                              CSD027
076800200604     C                     Z-ADD*ZEROS    WWCSQK
076900200604     C                     Z-ADD*ZEROS    WWCFAC
077000200604     C                     Z-ADD*ZEROS    WWOSAJ
077100200604     C                     Z-ADD*ZEROS    WWTOTP 180
077200200604     C                     Z-ADD*ZEROS    WWNUMR  50
077300200604     C                     MOVE 'N'       DADJN                           100017
077400200604     C*
077500200604     C**   INITIALISE OUTPUT FIELDS
077600200604     C***********          MOVE *BLANKS   RRPLOC                          S01464
077700200604     C                     MOVE *BLANKS   RRBRCD                          S01464
077800200604     C                     MOVE *BLANKS   RRACOC
077900200604     C                     MOVE *BLANKS   RRACON
078000200604     C***********          MOVE *BLANKS   RRCNM1                          S01464
078100200604     C***********          MOVE *BLANKS   RRSNM1                          S01464
078200200604     C***********          MOVE *BLANKS   RRPNM1                          S01464
078300200604     C***********          MOVE *BLANKS   RRPSN1                          S01464
078400200604     C***********          MOVE *BLANKS   RRAFG1                          S01464
078500200604     C                     MOVE *BLANKS   RRCNM2
078600200604     C                     MOVE *BLANKS   RRSNM2
078700200604     C                     MOVE *BLANKS   RRAFG2
078800200604     C                     MOVE *BLANKS   RRBCCY
078900200604     C                     MOVE *BLANKS   RRCCCY
079000200604     C                     MOVE *BLANKS   RRFATT
079100200604     C                     MOVE *BLANKS   RROTAS
079200200604     C                     MOVE *BLANKS   RROUTA
079300200604     C                     MOVE *BLANKS   RRFATD
079400200604     C                     MOVE *BLANKS   RRBRCA                          S01464
079500200604     C                     MOVE *BLANKS   RRSCTY
079600200604     C                     MOVE *BLANKS   RRIVTS
079700200604     C                     MOVE *BLANKS   RRNMCS
079800200604     C                     MOVE *BLANKS   RRNPSS
079900200604     C                     MOVE *BLANKS   RRMNCS
080000200604     C                     MOVE *BLANKS   RRMCCS
080100200604     C                     MOVE *BLANKS   RRFECS
080200200604     C                     MOVE *BLANKS   RRAATS
080300200604     C                     MOVE *BLANKS   RRACNT
080400200604     C                     MOVE *BLANKS   RRIVTA
080500200604     C                     MOVE *BLANKS   RRNMCA
080600200604     C                     MOVE *BLANKS   RRNPSA
080700200604     C                     MOVE *BLANKS   RRMNCA
080800200604     C                     MOVE *BLANKS   RRMCCA
080900200604     C                     MOVE *BLANKS   RRFECA
081000200604     C                     MOVE *BLANKS   RRAATA
081100200604     C                     Z-ADD*ZEROS    RRPROG
081200200604     C*
081300200604     C** SET UP ACCOUNT FORMAT DETAILS
081400200604     C                     MOVE '-'       WWDASH
081500200604     C                     MOVE '-'       WWDAS1
081600200604     C*
081700200604     C**   SET OFF ALL INDICATORS
081800200604     C                     MOVEA'00'      *IN,21
081900200604     C                     MOVEA'00'      *IN,30
082000200604     C                     MOVEA'0000000' *IN,40
082100200604     C                     MOVEA'0000000' *IN,47
082200200604     C                     MOVEA'000'     *IN,54
082300200604     C                     MOVE '1'       *IN98
082400200604     C*
082500200604     C**   INITIALISE LINE COUNTERS
082600200604     C                     Z-ADD*ZEROS    LINE
082700200604     C                     Z-ADD*ZEROS    LINE1
082800200604     C*
082900200604     C*****BUILD*COMMAND*EXPRESSION*FOR*QCMDEXC************************   S01464
083000200604     C***********          MOVELCMD,1     WWCMDP 43                       S01464
083100200604     C***********          MOVE ')'       WWPRTL  4                       S01464
083200200604     C*                                                                   S01464
083300200604     C** Test for multibranching                                          S01464
083400200604     C*                                                                   S01464
083500200604     C           MBIN      IFEQ 'Y'                                       S01464
083600200604     C                     MOVE '1'       *IN10                           S01464
083700200604     C                     END                                            S01464
083800200604     C/COPY WNCPYSRC,SE6240C001
083900200604      *                                                                                       CSE035
084000200604      *  Access SAR details file to see if CSE035 is installed                                CSE035
084100200604      *                                                                                       CSE035
084200200604     C                     CALL 'AOSARDR0'                                                    CSE035
084300200604     C                     PARM *BLANKS   @RTCD                                               CSE035
084400200604     C                     PARM '*VERIFY' @OPTN                                               CSE035
084500200604     C                     PARM 'CSE035'  WSARD   6                                           CSE035
084600200604      *                                                                                       CSE035
084700200604     C           @RTCD     IFEQ *BLANK                                                        CSE035
084800200604     C                     MOVE 'Y'       CSE035  1                                           CSE035
084900200604     C                     ELSE                                                               CSE035
085000200604     C                     MOVE 'N'       CSE035                                              CSE035
085100200604     C                     ENDIF                                                              CSE035
085200200604      *                                                                                       207543
085300200604      ** Access SAR details file to see if CEU018 is installed                                207543
085400200604      *                                                                                       207543
085500200604     C                     CALL 'AOSARDR0'                                                    207543
085600200604     C                     PARM *BLANKS   @RTCD                                               207543
085700200604     C                     PARM '*VERIFY' @OPTN                                               207543
085800200604     C                     PARM 'CEU018'  WSARD                                               207543
085900200604      *                                                                                       207543
086000200604     C           @RTCD     IFEQ *BLANK                                                        207543
086100200604     C                     MOVE 'Y'       CEU018  1                                           207543
086200200604     C                     ELSE                                                               207543
086300200604     C                     MOVE 'N'       CEU018                                              207543
086400200604     C                     ENDIF                                                              207543
086500200604     C*
086600200604     C**   ACCESS ICD FILE SDBANKL1
086700200604     C           1         SETLLSDBANKPD
086800200604     C                     READ SDBANKPD                 40
086900200604     C*
087000200604     C**   IF RECORD NOT FOUND OR DELETED
087100200604     C           *IN40     IFEQ '1'
087200200604     C           BJTYLC    OREQ 'D'
087300200604     C           *LOCK     IN   LDA                                       S01464
087400200604     C                     Z-ADD1         DBASE
087500200604     C                     MOVE *BLANKS   DBFILE           ***************
087600200604     C                     MOVEL'SDBANKPD'DBFILE           * DBERROR 001 *
087700200604     C                     MOVE *BLANKS   DBKEY            ***************
087800200604     C                     OUT  LDA                                       S01464
087900200604     C                     EXSR #ZA
088000200604     C                     END
088100200604     C*
088200200604     C*****ACCESS*SAFE*CUSTODY*ICD*FILE********************************   S01464
088300200604     C***********1         SETLLSCICDPPD                                  S01464
088400200604     C***********          READ SCICDPPD                 41               S01464
088500200604     C*****************************************************************   S01464
088600200604     C*****IF*RECORD*NOT*FOUND*OR*DELETED******************************   S01464
088700200604     C************IN41     IFEQ '1'                                       S01464
088800200604     C***********SACHTP    OREQ 'D'                                       S01464
088900200604     C***********          Z-ADD2         DBASE                           S01464
089000200604     C***********          MOVE *BLANKS   DBFILE           ***************S01464
089100200604     C***********          MOVEL'SCICDPPD'DBFILE           * DBERROR 002 *S01464
089200200604     C***********          MOVE *BLANKS   DBKEY            ***************S01464
089300200604     C***********          EXSR #ZA                                       S01464
089400200604     C*****************************************************************   S01464
089500200604     C***********          ELSE                                           S01464
089600200604     C*****************************************************************   S01464
089700200604     C*****SAVE*'LAST*ACCRUAL*DATE'*AND*'CURRENT*ACCRUAL*DATE'*INTO****   S01464
089800200604     C******SR/ZPMCRG*PARAMETER*FIELDS*********************************   S01464
089900200604     C***********          Z-ADDSALCRD    ZFMDAT                          S01464
090000200604     C***********          Z-ADDSACCRD    ZTODAT                          S01464
090100200604     C*****************************************************************   S01464
090200200604     C*****SAVE*'BANK*CHARGING*CCY'*INTO*A*WORK*FIELD*AND*INTO*********   S01464
090300200604     C******SR/ZCCYCN*PARAMETER*FIELD**********************************   S01464
090400200604     C***********          MOVE SABCGC    WWBCGC                          S01464
090500200604     C***********          MOVE SABCGC    ZCCYT                           S01464
090600200604     C***********          END                                            S01464
090700200604     C*                                                                   S01464
090800200604     C**   Access Safe Custody ICD File                                   S01464
090900200604     C           1         SETLLSDSCFEPD                                  S01464
091000200604     C                     READ SDSCFEPD                 41               S01464
091100200604     C*                                                                   S01464
091200200604     C**   If Record Not Found or Deleted                                 S01464
091300200604     C           *IN41     IFEQ '1'                                       S01464
091400200604     C           FBTYLC    OREQ 'D'                                       S01464
091500200604     C           *LOCK     IN   LDA                                       S01464
091600200604     C                     Z-ADD2         DBASE                           S01464
091700200604     C                     MOVE *BLANKS   DBFILE           ***************S01464
091800200604     C                     MOVEL'SDSCFEPD'DBFILE           * DBERROR 002 *S01464
091900200604     C                     MOVE *BLANKS   DBKEY            ***************S01464
092000200604     C                     OUT  LDA                                       S01464
092100200604     C                     EXSR #ZA                                       S01464
092200200604     C*                                                                   S01464
092300200604     C                     ELSE                                           S01464
092400200604     C*                                                                   S01464
092500200604     C**   Compute last accrual date based on current accrual date and    S01464
092600200604     C**   accrual frequency if last accrual date is zero.                S01464
092700200604     C           FBLCRD    IFEQ 0                                         S01464
092800200604     C                     EXSR ZLCRD                                     S01464
092900200604     C                     Z-ADDZDAYNO    FBLCRD                          S01464
093000200604     C                     END                                            S01464
093100200604     C*                                                                   S01464
093200200604     C**   Save 'LAST ACCRUAL DATE' and 'CURRENT ACCRUAL DATE' into       S01464
093300200604     C**    SR/ZPMCRG parameter fields                                    S01464
093400200604     C                     Z-ADDFBLCRD    ZFMDAT                          S01464
093500200604     C                     Z-ADDFBCCRD    ZTODAT                          S01464
093600200604     C*                                                                   S01464
093700200604     C**   Save 'BANK CHARGING CCY' into a work field and into            S01464
093800200604     C**    SR/ZCCYCN parameter field                                     S01464
093900200604     C                     MOVE FBBCGC    WWBCGC                          S01464
094000200604     C                     MOVE FBBCGC    ZCCYT                           S01464
094100200604     C                     END                                            S01464
094200200604     C*
094300200604     C**   MOVE 'CURRENT ACCRUAL DATE' TO 'LAST ACCRUAL DATE' AND
094400200604     C**    UPDATE PF/SCICDPPD
094500200604     C**                   Z-ADDSACCRD    SALCRD                          B5920
094600200604     C**                   UPDATSCICDPP0                                  B5920
094700200604     C*
094800200604     C**   ACCESS CURRENCY CODES FILE WITH BANK CHARGING CURRENCY
094900200604     C***********WWBCGC    CHAINSDCURRJ0             42                   S01464
095000200604     C           WWBCGC    CHAINSDCURRL0             42                   S01464
095100200604     C*
095200200604     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
095300200604     C           *IN42     IFEQ '1'
095400200604     C           A6TYLC    OREQ 'D'
095500200604     C           *LOCK     IN   LDA                                       S01464
095600200604     C                     Z-ADD3         DBASE
095700200604     C                     MOVE *BLANKS   DBFILE           *****************
095800200604     C***********          MOVEL'SDCURRJ0'DBFILE         ** DBERROR  003**S01464
095900200604     C                     MOVEL'SDCURRL0'DBFILE           **DBERROR 003**S01464
096000200604     C                     MOVE *BLANKS   DBKEY            *****************
096100200604     C                     MOVELWWBCGC    DBKEY
096200200604     C                     OUT  LDA                                       S01464
096300200604     C                     EXSR #ZA
096400200604     C*
096500200604     C                     ELSE
096600200604     C*
096700200604     C**   SAVE 'SPOT RATE' 'MULTIPLY/DIVIDE INDICATOR' AND 'BANK
096800200604     C**    CHARGING CCY DECIMAL PLACES' INTO SR/ZCCYCN PARAMETERS
096900200604     C                     Z-ADDA6SPRT    ZRATET
097000200604     C                     MOVE A6MDIN    ZMDINT
097100200604     C                     MOVE A6NBDP    ZCDPT
097200200604     C                     END
097300200604     C*
097400200604     C*****ACCESS*PORTFOLIO*MANAGEMENT*ICD*FILE************************   S01464
097500200604     C***********1         SETLLSDPORTPD                                  S01464
097600200604     C***********          READ SDPORTPD                 43               S01464
097700200604     C*****************************************************************   S01464
097800200604     C*****IF*RECORD*NOT*FOUND*OR*DELETED******************************   S01464
097900200604     C************IN43     IFEQ '1'                                       S01464
098000200604     C**         P9TYLC    OREQ 'D'                                       R0134
098100200604     C***********P9ADST    OREQ 'D'                                 R0134 S01464
098200200604     C***********          Z-ADD4         DBASE                           S01464
098300200604     C***********          MOVE *BLANKS   DBFILE           ***************S01464
098400200604     C***********          MOVEL'SDPORTPD'DBFILE           * DBERROR 004 *S01464
098500200604     C***********          MOVE *BLANKS   DBKEY            ***************S01464
098600200604     C***********          EXSR #ZA                                       S01464
098700200604     C***********          END                                            S01464
098800200604     C*                                                                   091522
098900200604     C**   ACCESS PORTFOLIO MANAGEMENT ICD FILE IF MODULE IS ON           091522
099000200604     C                     CALL 'AOMMODR0'                                091522
099100200604     C                     PARM *BLANKS   P@RTCD  7                       091522
099200200604     C                     PARM '*FIRST'  P@OPTN  7                       091522
099300200604     C           SDMMOD    PARM SDMMOD    DSSDY                           091522
099400200604     C           P@RTCD    IFNE *BLANKS                                   091522
099500200604     C                     Z-ADD11        DBASE                           091522
099600200604     C                     MOVE *BLANKS   DBFILE           ***************091522
099700200604     C                     MOVEL'SDMMODPD'DBFILE           * DBERROR 011 *091522
099800200604     C                     MOVE *BLANKS   DBKEY            ***************091522
099900200604     C                     EXSR #ZA                                       091522
100000200604     C                     ELSE                                           091522
100100200604     C           BGPFMG    IFEQ 'Y'                                       091522
100200200604     C                     CALL 'AOPORTR0'                                091522
100300200604     C                     PARM *BLANKS   P@RTCD                          091522
100400200604     C                     PARM '*FIRST'  P@OPTN                          091522
100500200604     C           SDPORT    PARM SDPORT    DSFDY                           091522
100600200604     C*                                                                   091522
100700200604     C           P@RTCD    IFNE *BLANKS                                   091522
100800200604     C                     Z-ADD4         DBASE                           091522
100900200604     C                     MOVE *BLANKS   DBFILE           ***************091522
101000200604     C                     MOVEL'SDPORTPD'DBFILE           * DBERROR 004 *091522
101100200604     C                     MOVE *BLANKS   DBKEY            ***************091522
101200200604     C                     EXSR #ZA                                       091522
101300200604     C                     END                                            091522
101400200604     C                     END                                            091522
101500200604     C                     END                                            091522
101600200604      *                                                                   179044
101700200604      **  Check for Switchable feature                                    179044
101800200604      *                                                                   179044
101900200604     C                     MOVE 'N'       SEPNAR  1                       179044
102000200604     C           BGN1ST    IFEQ 'Y'                                       179044
102100200604      *                                                                   179044
102200200604     C                     CALL 'AOSARDR0'                                179044
102300200604     C                     PARM '       ' @RTCD   7                       179044
102400200604     C                     PARM '*VERIFY' @OPTN   7                       179044
102500200604     C                     PARM 'SEPNAR'  @SARD   6                       179044
102600200604     C           SCSARD    PARM SCSARD    DSFDY                           179044
102700200604      *                                                                   179044
102800200604     C           @RTCD     IFNE *BLANK                                    179044
102900200604     C           @RTCD     ANDNE'*NRF   '                                 179044
103000200604     C           *LOCK     IN   LDA                                       179044
103100200604     C                     SETON                     U7U8                 179044
103200200604     C                     MOVEL'SCSARDPD'DBFILE           ************** 179044
103300200604     C                     Z-ADD13        DBASE            * DBERROR 13 * 179044
103400200604     C                     MOVEL@SARD     DBKEY            ************** 179044
103500200604     C                     OUT  LDA                                       179044
103600200604     C                     EXSR #ZA                                       179044
103700200604     C                     ENDIF                                          179044
103800200604      *                                                                   179044
103900200604     C           @RTCD     IFEQ *BLANK                                    179044
104000200604     C                     MOVE 'Y'       SEPNAR                          179044
104100200604     C                     ENDIF                                          179044
104200200604     C                     ENDIF                                          179044
104300200604      *                                                                   CAC003
104400200604      ** Check if CAC003 is switched on.                                  CAC003
104500200604      *                                                                   CAC003
104600200604     C                     SETOF                     20                   CAC003
104700200604      *                                                                   CAC003
104800200604     C                     CALL 'AOSARDR0'                                CAC003
104900200604     C                     PARM           P@RTCD                          CAC003
105000200604     C                     PARM '*VERIFY' P@OPTN                          CAC003
105100200604     C                     PARM 'CAC003'  P@SARD  6                       CAC003
105200200604      *                                                                   CAC003
105300200604     C           P@RTCD    IFEQ *BLANK                                    CAC003
105400200604     C           BGN0ST    ANDEQ'Y'                                       CAC003
105500200604     C                     SETON                     20                   CAC003
105600200604     C                     ENDIF                                          CAC003
105700200604     C*                                                                   CAC003
105800200604     C/COPY WNCPYSRC,SE6240C024
105900200604     C*
106000200604     C                     ENDSR
106100200604     C*****************************************************************
106200200604     C/EJECT
106300200604     C********************************************************************
106400200604     C*
106500200604     C           #P01      BEGSR
106600200604     C*
106700200604     C*****READ*FROM*LF/SCCUSTL1***************************************   S01464
106800200604     C***********          READ SCCUSTL1                 44               S01464
106900200604     C**   Read from LF/SECUSTL1                                          S01464
107000200604     C                     READ SECUSTL1                 44               S01464
107100200604     C*
107200200604     C*****IF*NO*RECORDS*ON*SCCUSTL1***********************************   S01464
107300200604     C**   If no records on SECUSTL1                                      S01464
107400200604     C           *IN44     IFEQ '1'
107500200604     C***********          OPEN SE6240P1                                  S01464
107600200604     C***********          WRITEHEADER1                                   S01464
107700200604     C***********          MOVE SABCGC    RRBCCY                          S01464
107800200604     C***********          MOVE SABCGC    RRCCCY                          S01464
107900200604     C***********          WRITEHEADER3                                   S01464
108000200604     C                     MOVE '1'       WWNUIN  1                       S01464
108100200604     C                     WRITEHEADER                                    S01464
108200200604     C                     WRITENULL1
108300200604     C***********          WRITEFOOTING1                                  S01464
108400200604     C                     ELSE
108500200604     C*
108600200604     C*****MOVE*PRINTER*LOCATION*INTO*WORK*FIELD*AND*CALL*'QCMDEXC'****   S01464
108700200604     C***********          MOVE AZPRTL    WWPLOC                          S01464
108800200604     C***********          MOVELAZPRTL    WWPRTL                          S01464
108900200604     C***********          MOVE WWPRTL    WWCMDP                          S01464
109000200604     C***********          CALL 'QCMDEXC'                                 S01464
109100200604     C***********          PARM WWCMDP    QCAA   43                       S01464
109200200604     C***********          PARM 43        QCAN   155                      S01464
109300200604     C*                                                                   S01464
109400200604     C**   Move Branch Code into a work field                             S01464
109500200604     C                     MOVE BBBRCD    WWBRCH                          S01464
109600200604     C                     OPEN SE6240P1
109700200604     C                     MOVE 'Y'       WWOPEN  1                       S01464
109800200604     C*                                                                   S01464
109900200604     C** Call ZSFILE for P1 file                                          S01464
110000200604     C*                                                                   S01464
110100200604     C                     Z-ADDSFNUM     ZSNUM   60                      S01464
110200200604     C                     CALL 'ZSFILE'                                  S01464
110300200604     C                     PARM           SEQ     5                       S01464
110400200604     C                     PARM BBBRCD    @PARM   3                       S01464
110500200604     C                     PARM           SFILE                           S01464
110600200604     C                     PARM           ZSNUM                           S01464
110700200604     C                     PARM           ZSERR   1                       S01464
110800200604     C*                                                                   S01464
110900200604     C           ZSERR     IFEQ 'Y'                                       S01464
111000200604     C                     MOVE '1'       *INU7                           S01464
111100200604     C                     MOVE '1'       *INU8                           S01464
111200200604     C                     MOVE '1'       *INLR                           S01464
111300200604     C                     RETRN                                          S01464
111400200604     C                     END                                            S01464
111500200604     C*
111600200604     C*****DO*WHILE*RECORDS*EXIST*ON*SCCUSTL1**************************   S01464
111700200604     C**   Do while records exist on SECUSTL1                             S01464
111800200604     C           *IN44     DOWEQ'0'
111900200604     C*
112000200604     C*****MOVE*CUSTOMER*NUMBER*ON*SCCUSTL1*INTO*A*CHARACTER*AND*A*****   S01464
112100200604     C******NUMERIC*WORK*FIELD*****************************************   S01464
112200200604     C**   Move customer number on SECUSTL1 into a character and a        S01464
112300200604     C**    numeric work field                                            S01464
112400200604     C                     MOVE BBCUST    WWCUST
112500200604     C                     MOVE BBCUST    WWCNUM
112600200604     C                     MOVE BFCFGC    WWCFGC
112700200604     C                     MOVE BBCRNM    ##CRNM                          179044
112800200604     C/COPY WNCPYSRC,SE6240C002
112900200604     C*
113000200604     C**   IF AT END OF PAGE WRITE HEADINGS
113100200604     C           LINE      IFGT 55
113200200604     C*
113300200604     C*****MOVE*PRINTER*LOCATION*TO*REPORT*FIELD***********************   S01464
113400200604     C***********          MOVE WWPLOC    RRPLOC                          S01464
113500200604     C*                                                                   S01464
113600200604     C**   Move Branch Code to Report Field                               S01464
113700200604     C                     MOVE WWBRCH    RRBRCD                          S01464
113800200604     C*
113900200604     C**   WRITE MAIN HEADING
114000200604     C                     WRITEHEADER1
114100200604     C*
114200200604     C**  MOVE FILE FIELDS TO REPORT FIELDS FOR ACCOUNT OFFICER HEADING
114300200604     C***********          MOVE AZACOC    RRACOC                          S01464
114400200604     C                     MOVE BBACOC    RRACOC                          S01464
114500200604     C*                                                                   S01464
114600200604     C** OPEN ACCOUNT OFFICER DETAILS FILE                                S01464
114700200604     C                     OPEN SDACOFL1                                  S01464
114800200604     C*                                                                   S01464
114900200604     C** ACCESS LF/SDACOFL1 WITH ACCOUNT OFFICER CODE                     S01464
115000200604     C           BBACOC    CHAINSDACOFL1             57                   S01464
115100200604     C*                                                                   S01464
115200200604     C** GET ACCOUNT OFFICER NAME FOR ACCOUNT OFFICER HEADING             S01464
115300200604     C           *IN57     IFEQ '1'                                       S01464
115400200604     C                     MOVE *BLANKS   RRACON                          S01464
115500200604     C                     ELSE                                           S01464
115600200604     C                     MOVE AZACON    RRACON
115700200604     C                     END                                            S01464
115800200604     C*                                                                   S01464
115900200604     C                     CLOSESDACOFL1                                  S01464
116000200604     C*
116100200604     C**   WRITE ACCOUNT OFFICER HEADING
116200200604     C                     WRITEHEADER2
116300200604     C*
116400200604     C**   MOVE FEE GROUP CODE TO REPORT FIELDS
116500200604     C                     MOVE BFCFGC    WWCFGC
116600200604     C*
116700200604     C**   OUTPUT BANK CHARGING CURRENCY TO REPORT
116800200604     C                     MOVE WWBCGC    RRBCCY
116900200604     C                     MOVE WWBCGC    RRCCCY
117000200604     C*
117100200604     C*****IF*FEES*PER*CUSTOMER*POSITIONS*=*'P'************************   S01464
117200200604     C***********SACFCP    IFEQ 'P'                                       S01464
117300200604     C*****************************************************************   S01464
117400200604     C*****MOVE*FILE*FIELDS*TO*REPORT*FIELDS*FOR*PORTFOLIO*CUST*HEADING   S01464
117500200604     C***********          MOVE BBCUST    RRCNM1                          S01464
117600200604     C***********          MOVE BBCRNM    RRSNM1                          S01464
117700200604     C*****************************************************************   S01464
117800200604     C*****SET*ON*HEADER*3*NECESSARY*INDICATOR*************************   S01464
117900200604     C***********          MOVE '1'       *IN31                           S01464
118000200604     C*****************************************************************   S01464
118100200604     C***********          ELSE                                           S01464
118200200604     C**   IF FEES PER CUSTOMER POSITIONS = 'P'                           091522
118300200604     C           FBCFCP    IFEQ 'P'                                       091522
118400200604     C*                                                                   091522
118500200604     C**   MOVE FILE FIELDS TO REPORT FIELDS FOR PORTFOLIO CUST HEADING   091522
118600200604     C                     MOVE BBCUST    RRCNM1                          091522
118700200604     C                     MOVE BBCRNM    RRSNM1                          091522
118800200604     C*                                                                   091522
118900200604     C**   SET ON HEADER 3 NECESSARY INDICATOR                            091522
119000200604     C                     MOVE '1'       *IN31                           091522
119100200604     C*                                                                   091522
119200200604     C                     ELSE                                           091522
119300200604     C*
119400200604     C**   IF FEES PER CUSTOMER POSITIONS = 'C'
119500200604     C***********SACFCP    IFEQ 'C'                                       S01464
119600200604     C           FBCFCP    IFEQ 'C'                                       S01464
119700200604     C*
119800200604     C**   MOVE FILE FIELDS TO REPORT FIELDS FOR CUSTOMER HEADING
119900200604     C                     MOVE BBCUST    RRCNM2
120000200604     C                     MOVE BBCRNM    RRSNM2
120100200604     C*
120200200604     C**   WRITE NON PORTFOLIO CUSTOMER HEADING
120300200604     C**                   MOVE BFCFGC    WWCFGC                          R0131
120400200604     C**                   MOVE WWCFGC    RRAFG2                          R0131
120500200604     C**                   WRITEDETAIL2                                   R0131
120600200604     C*
120700200604     C**   WRITE HEADINGS FOR CUSTOMER DETAILS
120800200604     C                     WRITEHEADER3
120900200604     C*                                                                   R0131
121000200604     C**   WRITE NON PORTFOLIO CUSTOMER HEADING                           R0131
121100200604     C                     MOVE BFCFGC    WWCFGC                          R0131
121200200604     C                     MOVE WWCFGC    RRAFG2                          R0131
121300200604     C                     WRITEDETAIL2                                   R0131
121400200604     C*
121500200604     C                     END
121600200604     C***********          END                                            S01464
121700200604     C                     END                                            091522
121800200604     C*
121900200604     C**   SET ON HEADINGS ALREADY WRITTEN INDICATOR
122000200604     C                     MOVE '1'       *IN30
122100200604     C*
122200200604     C                     END
122300200604     C*
122400200604     C*****IF*FEES*PER*CUSTOMER*POSITIONS*ON*PF/SCICDPPD*=*'P'*********   S01464
122500200604     C***********SACFCP    IFEQ 'P'                                       S01464
122600200604     C*****************************************************************   S01464
122700200604     C*****ACCESS*PF/SDPLCSPD*WITH*CUSTOMER*NUMBER*********************   S01464
122800200604     C***********WWCUST    CHAINSDPLCSPD             45                   S01464
122900200604     C*****************************************************************   S01464
123000200604     C*****IF*LIVE*RECORD*IS*FOUND*************************************   S01464
123100200604     C************IN45     IFEQ '0'                                       S01464
123200200604     C***********QBRECI    ANDEQ'D'                                       S01464
123300200604     C*****************************************************************   S01464
123400200604     C*****CALL*SUBROUTINE*TO*DO*PORTFOLIO*POSITION*PROCESSING*********   S01464
123500200604     C***********          EXSR #P04                                      S01464
123600200604     C*****************************************************************   S01464
123700200604     C***********          ELSE                                           S01464
123800200604     C*****************************************************************   S01464
123900200604     C*****CALL*SUBROUTINE*TO*DO*CUSTOMER*POSITION*PROCESSING**********   S01464
124000200604     C***********          EXSR #P03                                      S01464
124100200604     C*****************************************************************   S01464
124200200604     C***********          END                                            S01464
124300200604     C*****************************************************************   S01464
124400200604     C***********          ELSE                                           S01464
124500200604     C**   IF FEES PER CUSTOMER POSITIONS ON PF/SCICDPPD = 'P'            091522
124600200604     C           FBCFCP    IFEQ 'P'                                       091522
124700200604     C/COPY WNCPYSRC,SE6240C003
124800200604     C*                                                                   091522
124900200604     C**   ACCESS PF/SDPLCSL0 WITH CUSTOMER NUMBER                        091522
125000200604     C           WWCUST    CHAINSDPLCSL0             45                   091522
125100200604     C*                                                                   091522
125200200604      **  Access Customer Details by using Access Object,                                   MD045517
125300200604      **  to retrieve Private Banking Customer Indicator.                                   MD045517
125400200604     C                     MOVE *BLANKS   @CUST                                             MD045517
125500200604     C                     MOVELWWCUST    @CUST                                             MD045517
125600200604     C                     CALL 'AOCUSTR1'                                                  MD045517
125700200604     C                     PARM '*MSG   ' @RTCD   7                                         MD045517
125800200604     C                     PARM '*KEY   ' @OPTN   7                                         MD045517
125900200604     C                     PARM           @CUST  10                                         MD045517
126000200604     C                     PARM           @KYST   7                                         MD045517
126100200604     C           SDCUST    PARM SDCUST    DSLDY                                             MD045517
126200200604      *                                                                                     MD045517
126300200604      **  If Customer Details do not exist, handle Database Error.                          MD045517
126400200604     C           @RTCD     IFNE *BLANK                                                      MD045517
126500200604     C                     MOVEL'SDCUSTPD'DBFILE                                            MD045517
126600200604     C                     MOVEL@CUST     DBKEY                                             MD045517
126700200604     C                     Z-ADD15        DBASE                                             MD045517
126800200604     C                     EXSR *PSSR                                                       MD045517
126900200604     C                     ENDIF                                                            MD045517
127000200604      *                                                                                     MD045517
127100200604     C**   IF LIVE RECORD IS FOUND                                        091522
127200200604     C********** *IN45     IFEQ '0'                                                  091522 MD045517
127300200604     C           BGPFMG    IFEQ 'Y'                                                         MD045517
127400200604     C           *IN45     ANDEQ'0'                                                         MD045517
127500200604     C           QBRECI    ANDEQ'D'                                       091522
127600200604     C           BGN4ST    OREQ 'Y'                                                         MD045517
127700200604     C           BBPRBA    ANDEQ'Y'                                                         MD045517
127800200604     C*                                                                   091522
127900200604     C**   CALL SUBROUTINE TO DO PORTFOLIO POSITION PROCESSING            091522
128000200604     C                     EXSR #P04                                      091522
128100200604     C*                                                                   091522
128200200604     C                     ELSE                                           091522
128300200604     C*                                                                   091522
128400200604     C**   CALL SUBROUTINE TO DO CUSTOMER POSITION PROCESSING             091522
128500200604     C                     EXSR #P03                                      091522
128600200604     C*                                                                   091522
128700200604     C                     END                                            091522
128800200604     C*                                                                   091522
128900200604     C                     ELSE                                           091522
129000200604     C*
129100200604     C**   IF FEES PER CUSTOMER POSITIONS = 'C'
129200200604     C***********SACFCP    IFEQ 'C'                                       S01464
129300200604     C           FBCFCP    IFEQ 'C'                                       S01464
129400200604     C*
129500200604     C**   CALL SUBROUTINE TO DO CUSTOMER POSITION PROCESSING
129600200604     C                     EXSR #P03
129700200604     C*
129800200604     C                     END
129900200604     C***********          END                                            S01464
130000200604     C                     END                                            091522
130100200604     C*****************************************************************   S01464
130200200604     C*****READ*NEXT*RECORD*FROM*LF/SCCUSTL1***************************   S01464
130300200604     C***********          READ SCCUSTL1                 44               S01464
130400200604     C*****************************************************************   S01464
130500200604     C*****ON*CHANGE*OF*PRINTER*LOCATION*CODE*OR*EOF*******************   S01464
130600200604     C***********WWPLOC    IFNE AZPRTL                                    S01464
130700200604     C*                                                                   S01464
130800200604     C**   Read next record from LF/SECUSTL1                              S01464
130900200604     C                     READ SECUSTL1                 44               S01464
131000200604     C*                                                                   S01464
131100200604     C**   On change of branch code or EOF                                S01464
131200200604     C           WWBRCH    IFNE BBBRCD                                    S01464
131300200604     C           *IN44     OREQ '1'
131400200604     C*
131500200604     C**   CALL SUBROUTINE TO OPEN/CLOSE PRINTER FILE
131600200604     C                     EXSR #P02
131700200604     C*
131800200604     C                     END
131900200604     C*
132000200604     C                     END
132100200604     C*
132200200604     C                     END
132300200604     C*
132400200604     C                     ENDSR
132500200604     C********************************************************************
132600200604     C/EJECT
132700200604     C********************************************************************
132800200604     C*
132900200604     C           #P02      BEGSR
133000200604     C*
133100200604     C***********          MOVE WWCFGC    RRAFG1                          S01464
133200200604     C                     MOVE WWCFGC    RRAFG2
133300200604     C*
133400200604     C**   IF AT END OF PAGE WRITE HEADINGS
133500200604     C           LINE      IFGT 55
133600200604     C*
133700200604     C**   WRITE MAIN HEADING
133800200604     C                     WRITEHEADER1
133900200604     C*
134000200604     C**   WRITE ACCOUNT OFFICER HEADING
134100200604     C                     WRITEHEADER2
134200200604     C*                                                                   R0131
134300200604     C**   WRITE HEADINGS FOR CUSTOMER DETAILS                            R0131
134400200604     C                     WRITEHEADER3                                   R0131
134500200604     C*
134600200604     C*****IF*FEES*PER*CUSTOMER*POSITIONS*=*'P'************************   S01464
134700200604     C***********SACFCP    IFEQ 'P'                                       S01464
134800200604     C*****************************************************************   S01464
134900200604     C*****WRITE*PORTFOLIO*CUSTOMER*HEADING****************************   S01464
135000200604     C***********          WRITEDETAIL1                                   S01464
135100200604     C*****************************************************************   S01464
135200200604     C***********          ELSE                                           S01464
135300200604     C**   IF FEES PER CUSTOMER POSITIONS = 'P'                           091522
135400200604     C           FBCFCP    IFEQ 'P'                                       091522
135500200604     C*                                                                   091522
135600200604     C**   WRITE PORTFOLIO CUSTOMER HEADING                               091522
135700200604     C                     WRITEDETAIL1                                   091522
135800200604     C*                                                                   091522
135900200604     C                     ELSE                                           091522
136000200604     C*
136100200604     C**   IF FEES PER CUSTOMER POSITIONS = 'C'
136200200604     C***********SACFCP    IFEQ 'C'                                       S01464
136300200604     C           FBCFCP    IFEQ 'C'                                       S01464
136400200604     C*
136500200604     C**   WRITE NON PORTFOLIO CUSTOMER HEADING
136600200604     C                     WRITEDETAIL2
136700200604     C                     END
136800200604     C***********          END                                            S01464
136900200604     C                     END                                            091522
137000200604     C*
137100200604     C**   WRITE HEADINGS FOR CUSTOMER DETAILS
137200200604     C**                   WRITEHEADER3                                   R0131
137300200604     C                     END
137400200604     C                     WRITEFOOTING1
137500200604     C                     CLOSESE6240P1
137600200604     C                     MOVE 'N'       WWOPEN                          S01464
137700200604     C*
137800200604     C*****IF*NOT*AT*END*OF*FILE*OVERRIDE*TO*NEW*PRINTER*LOCATION******   S01464
137900200604     C************IN44     IFEQ '0'                                       S01464
138000200604     C***********          MOVELAZPRTL    WWPRTL                          S01464
138100200604     C***********          MOVE WWPRTL    WWCMDP                          S01464
138200200604     C***********          CALL 'QCMDEXC'                                 S01464
138300200604     C***********          PARM WWCMDP    QCAA   43                       S01464
138400200604     C***********          PARM 43        QCAN   155                      S01464
138500200604     C           *IN44     IFEQ '0'                                       S01464
138600200604     C                     OPEN SE6240P1
138700200604     C                     Z-ADD*ZERO     PAGE
138800200604     C                     MOVE 'Y'       WWOPEN                          S01464
138900200604     C***********          MOVE AZPRTL    WWPLOC                          S01464
139000200604     C                     MOVE *BLANKS   WWBLHD                          S01464
139100200604     C                     MOVE BBBRCD    WWBRCH                          S01464
139200200604     C*                                                                   S01464
139300200604     C** Call ZSFILE for P1 file                                          S01464
139400200604     C*                                                                   S01464
139500200604     C                     Z-ADDSFNUM     ZSNUM   60                      S01464
139600200604     C                     CALL 'ZSFILE'                                  S01464
139700200604     C                     PARM           SEQ     5                       S01464
139800200604     C                     PARM BBBRCD    @PARM   3                       S01464
139900200604     C                     PARM           SFILE                           S01464
140000200604     C                     PARM           ZSNUM                           S01464
140100200604     C                     PARM           ZSERR   1                       S01464
140200200604     C*                                                                   S01464
140300200604     C           ZSERR     IFEQ 'Y'                                       S01464
140400200604     C                     MOVE '1'       *INU7                           S01464
140500200604     C                     MOVE '1'       *INU8                           S01464
140600200604     C                     MOVE '1'       *INLR                           S01464
140700200604     C                     RETRN                                          S01464
140800200604     C                     END                                            S01464
140900200604     C                     END
141000200604     C*
141100200604     C                     ENDSR
141200200604     C********************************************************************
141300200604     C/EJECT
141400200604     C********************************************************************
141500200604     C*
141600200604     C/COPY WNCPYSRC,SE6240C004
141700200604     C           #P03      BEGSR
141800200604     C*
141900200604     C** MOVE FEE GROUP CODE TO REPORT FIELDS AND TO A WORK FIELD
142000200604     C***********          MOVE WWCFGC    RRAFG1                          S01464
142100200604     C                     MOVE WWCFGC    RRAFG2
142200200604     C*
142300200604     C** IF HEADINGS NOT ALREADY WRITTEN ON NEW PAGE
142400200604     C           *IN30     IFEQ '0'
142500200604     C*
142600200604     C** IF CHANGE OF ACCOUNT OFFICER
142700200604     C***********AZACOC    IFNE WWACOC                                    S01464
142800200604     C           BBACOC    IFNE WWACOC                                    S01464
142900200604     C           BBACOC    OREQ *BLANKS                                   S01464
143000200604     C           RRBRCD    ORNE WWBRCH                                    157193
143100200604     C           WWBLHD    ANDEQ*BLANKS                                   S01464
143200200604     C                     MOVE 'Y'       WWBLHD                          S01464
143300200604     C*
143400200604     C***MOVE*PRINTER*LOCATION*INTO*REPORT*FIELD***********************   S01464
143500200604     C***********          MOVE WWPLOC    RRPLOC                          S01464
143600200604     C*                                                                   S01464
143700200604     C** Move branch code into report field                               S01464
143800200604     C                     MOVE WWBRCH    RRBRCD                          S01464
143900200604     C*
144000200604     C** WRITE MAIN HEADING
144100200604     C                     WRITEHEADER1
144200200604     C*
144300200604     C** MOVE FILE FIELDS TO REPORT FIELDS FOR ACCOUNT OFFICER HEADING
144400200604     C***********          MOVE AZACOC    RRACOC
144500200604     C                     MOVE BBACOC    RRACOC                          S01464
144600200604     C*                                                                   S01464
144700200604     C** OPEN ACCOUNT OFFICER DETAILS FILE                                S01464
144800200604     C                     OPEN SDACOFL1                                  S01464
144900200604     C*                                                                   S01464
145000200604     C** ACCESS LF/SDACOFL1 WITH ACCOUNT OFFICER CODE                     S01464
145100200604     C           BBACOC    CHAINSDACOFL1             57                   S01464
145200200604     C*                                                                   S01464
145300200604     C** GET ACCOUNT OFFICER NAME FOR ACCOUNT OFFICER HEADING             S01464
145400200604     C           *IN57     IFEQ '1'                                       S01464
145500200604     C                     MOVE *BLANKS   RRACON                          S01464
145600200604     C                     ELSE                                           S01464
145700200604     C                     MOVE AZACON    RRACON
145800200604     C                     END                                            S01464
145900200604     C*                                                                   S01464
146000200604     C                     CLOSESDACOFL1                                  S01464
146100200604     C*
146200200604     C** WRITE ACCOUNT OFFICER HEADING
146300200604     C                     WRITEHEADER2
146400200604      *                                                                   R0131
146500200604     C** IF CHANGE OF ACCOUNT OFFICER                                     R0131
146600200604     C***********AZACOC    IFNE WWACOC                              R0131 S01464
146700200604     C*                                                                   R0131
146800200604     C** OUTPUT BANK CHARGING CURRENCY TO REPORT                          R0131
146900200604     C                     MOVE WWBCGC    RRBCCY                          R0131
147000200604     C                     MOVE WWBCGC    RRCCCY                          R0131
147100200604     C*                                                                   R0131
147200200604     C** WRITE HEADINGS FOR CUSTOMER DETAILS                              R0131
147300200604     C                     WRITEHEADER3                                   R0131
147400200604     C*                                                                   R0131
147500200604     C** MOVE NEW ACCOUNT OFFICER CODE INTO WORK FIELD                    R0131
147600200604     C***********          MOVE AZACOC    WWACOC                    R0131 S01464
147700200604     C                     MOVE BBACOC    WWACOC                          S01464
147800200604     C*                                                                   R0131
147900200604     C***********          END                                      R0131 S01464
148000200604     C*
148100200604     C                     END
148200200604     C*
148300200604     C***IF*FEES*PER*CUSTOMER*POSITIONS*=*'P'**************************   S01464
148400200604     C***********SACFCP    IFEQ 'P'                                       S01464
148500200604     C*****************************************************************   S01464
148600200604     C***MOVE*FILE*FIELDS*TO*REPORT*FIELDS*FOR*PORTFOLIO*CUST*HEADING**   S01464
148700200604     C***********          MOVE BBCUST    RRCNM1                          S01464
148800200604     C***********          MOVE BBCRNM    RRSNM1                          S01464
148900200604     C***********          MOVE P9R999    RRPNM1                          S01464
149000200604     C***********          MOVE P9N999    RRPSN1                          S01464
149100200604     C*****************************************************************   S01464
149200200604     C***SET*PORTFOLIO*REFERENCE***************************************   S01464
149300200604     C***********          MOVE '9999'    WWPTFR                          S01464
149400200604     C*****************************************************************   S01464
149500200604     C***WRITE*PORTFOLIO*CUSTOMER*HEADING******************************   S01464
149600200604     C***********          WRITEDETAIL1                                   S01464
149700200604     C*****************************************************************   S01464
149800200604     C***********          ELSE                                           S01464
149900200604     C** IF FEES PER CUSTOMER POSITIONS = 'P'                             091522
150000200604     C           FBCFCP    IFEQ 'P'                                       091522
150100200604     C*                                                                   091522
150200200604     C** MOVE FILE FIELDS TO REPORT FIELDS FOR PORTFOLIO CUST HEADING     091522
150300200604     C                     MOVE BBCUST    RRCNM1                          091522
150400200604     C                     MOVE BBCRNM    RRSNM1                          091522
150500200604     C                     MOVE FCR999    RRPNM1                          091522
150600200604     C                     MOVE FCN999    RRPSN1                          091522
150700200604     C*                                                                   091522
150800200604     C** SET PORTFOLIO REFERENCE                                          091522
150900200604     C                     MOVE '9999'    WWPTFR                          091522
151000200604     C*                                                                   091522
151100200604     C** WRITE PORTFOLIO CUSTOMER HEADING                                 091522
151200200604     C                     WRITEDETAIL1                                   091522
151300200604     C*                                                                   091522
151400200604     C                     ELSE                                           091522
151500200604     C*
151600200604     C** IF FEES PER CUSTOMER POSITIONS = 'C'
151700200604     C***********SACFCP    IFEQ 'C'                                       S01464
151800200604     C           FBCFCP    IFEQ 'C'                                       S01464
151900200604     C*
152000200604     C** MOVE FILE FIELDS TO REPORT FIELDS FOR CUSTOMER HEADING
152100200604     C                     MOVE BBCUST    RRCNM2
152200200604     C                     MOVE BBCRNM    RRSNM2
152300200604     C*
152400200604     C** SET PORTFOLIO REFERENCE BLANK
152500200604     C                     MOVE *BLANKS   WWPTFR
152600200604     C*
152700200604     C** WRITE NON PORTFOLIO CUSTOMER HEADING
152800200604     C                     WRITEDETAIL2
152900200604     C*                                                                   083825
153000200604     C** Print header and sub-header if detail line will                  083825
153100200604     C**    be greater than the overflow                                  083825
153200200604     C*                                                                   083825
153300200604     C           LINE      IFGT 52                                        083825
153400200604     C                     WRITEHEADER1                                   083825
153500200604     C                     WRITEHEADER2                                   083825
153600200604     C                     WRITEHEADER3                                   083825
153700200604     C                     END                                            083825
153800200604     C*                                                                   083825
153900200604     C*
154000200604     C                     END
154100200604     C***********          END                                            S01464
154200200604     C                     END                                            091522
154300200604     C*
154400200604     C** IF CHANGE OF ACCOUNT OFFICER
154500200604     C**         AZACOC    IFNE WWACOC                                    R0131
154600200604     C*
154700200604     C** OUTPUT BANK CHARGING CURRENCY TO REPORT
154800200604     C**                   MOVE WWBCGC    RRBCCY                          R0131
154900200604     C**                   MOVE WWBCGC    RRCCCY                          R0131
155000200604     C*
155100200604     C** WRITE HEADINGS FOR CUSTOMER DETAILS
155200200604     C**                   WRITEHEADER3                                   R0131
155300200604     C*
155400200604     C** MOVE NEW ACCOUNT OFFICER CODE INTO WORK FIELD
155500200604     C**                   MOVE AZACOC    WWACOC                          R0131
155600200604     C*
155700200604     C**                   END                                            R0131
155800200604     C*
155900200604     C                     ELSE
156000200604     C*
156100200604     C** RESET HEADINGS ALREADY WRITTEN INDICATOR
156200200604     C                     MOVE '0'       *IN30
156300200604     C*
156400200604     C** DECIDE PORTFOLIO REFERENCE TO BE USED
156500200604     C***********SACFCP    IFEQ 'P'                                       S01464
156600200604     C***********          MOVE '9999'    WWPTFR                          S01464
156700200604     C***********          ELSE                                           S01464
156800200604     C           FBCFCP    IFEQ 'P'                                       091522
156900200604     C                     MOVE '9999'    WWPTFR                          091522
157000200604     C                     ELSE                                           091522
157100200604     C***********SACFCP    IFEQ 'C'                                       S01464
157200200604     C           FBCFCP    IFEQ 'C'                                       S01464
157300200604     C                     MOVE *BLANKS   WWPTFR
157400200604     C                     END
157500200604     C***********          END                                            S01464
157600200604     C                     END                                            091522
157700200604     C*****************************************************************   S01464
157800200604     C***IF*HEADER*3*INDICATOR*IS*ON*MOVE*PORTFOLIO*VALUES*INTO*REPORT*   S01464
157900200604     C****FIELDS,*FINISH*PRINTING*HEADINGS*AND*RESET*INDICATOR*********   S01464
158000200604     C************IN31     IFEQ '1'                                       S01464
158100200604     C***********          MOVE P9R999    RRPNM1                          S01464
158200200604     C***********          MOVE P9N999    RRPSN1                          S01464
158300200604     C**                   WRITEDETAIL1                             R0131 S01464
158400200604     C***********          WRITEHEADER3                                   S01464
158500200604     C***********          WRITEDETAIL1                             R0131 S01464
158600200604     C***********          MOVE '0'       *IN31                           S01464
158700200604     C***********          END                                            S01464
158800200604     C** IF HEADER 3 INDICATOR IS ON MOVE PORTFOLIO VALUES INTO REPORT    091522
158900200604     C**  FIELDS, FINISH PRINTING HEADINGS AND RESET INDICATOR            091522
159000200604     C           *IN31     IFEQ '1'                                       091522
159100200604     C                     MOVE FCR999    RRPNM1                          091522
159200200604     C                     MOVE FCN999    RRPSN1                          091522
159300200604     C                     WRITEHEADER3                                   091522
159400200604     C                     WRITEDETAIL1                                   091522
159500200604     C                     MOVE '0'       *IN31                           091522
159600200604     C                     END                                            091522
159700200604     C                     END
159800200604     C*
159900200604     C** INITIALISE A WORK FIELD TO HOLD 'FEES ACCRUED TODAY'
160000200604     C                     Z-ADD*ZEROS    WWFACT 130
160100200604     C*
160200200604     C***ACCESS*PF/SCSCFAPD*WITH*CUSTOMER*NUMBER*AND*PORTFOLIO*REF.****   S01464
160300200604     C***********WWKEY1    CHAINSCSCFAPD             46                   S01464
160400200604     C*                                                                   S01464
160500200604     C** Access PF/SESCFAPD with branch code, customer number and         S01464
160600200604     C** portfolio reference.                                             S01464
160700200604     C           WWKEY1    CHAINSESCFAPD             46                   S01464
160800200604     C*
160900200604     C** IF NO RECORD FOUND
161000200604     C           *IN46     IFEQ '1'
161100200604     C*
161200200604     C** SET UP WORK FIELDS FOR 'FEE ACCRUED TO DATE', 'OUTSTANDING
161300200604     C**  ACCRUAL ADJUSTMENT' AND 'OUTSTANDING ACCRUAL ADJUSTMENT SIGN'
161400200604     C                     Z-ADD*ZEROS    WWCFAC
161500200604     C                     Z-ADD*ZEROS    WWOSAJ
161600200604     C                     MOVE *BLANKS   WWOSAS
161700200604     C                     ELSE
161800200604     C*
161900200604     C** SET UP WORK FIELDS WITH VALUES FROM FILE
162000200604     C                     Z-ADDSDCFAC    WWCFAC
162100200604     C                     Z-ADDSDOSAJ    WWOSAJ
162200200604     C                     MOVE SDOSAS    WWOSAS
162300200604     C                     END
162400200604     C*
162500200604     C** OUTPUT 'FEES ACCRUED TO TODAY' REPORT LINE
162600200604     C                     Z-ADDWWCFAC    ZFLD15
162700200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
162800200604     C                     Z-ADDZCDPT     ZDECS                           S01464
162900200604     C                     MOVE 'J'       ZECODE
163000200604     C                     EXSR ZSEDIT
163100200604     C                     MOVE ZOUT21    RRFATT
163200200604     C*                                                                   083825
163300200604     C**  Check for overflow and write the appropiate header              083825
163400200604     C*                                                                   083825
163500200604     C           LINE      IFGT 55                                        083825
163600200604     C                     EXSR #WRTHD                                    083825
163700200604     C                     END                                            083825
163800200604     C*                                                                   083825
163900200604     C                     WRITEDETAIL3
164000200604     C*
164100200604     C** IF 'OUTSTANDING ACCRUAL ADJUSTMENTS' > 0 WRITE REPORT LINE
164200200604     C           WWOSAJ    IFGT *ZEROS
164300200604     C                     Z-ADDWWOSAJ    ZFLD15
164400200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
164500200604     C                     Z-ADDZCDPT     ZDECS                           S01464
164600200604     C                     MOVE 'J'       ZECODE
164700200604     C                     EXSR ZSEDIT
164800200604     C                     MOVE ZOUT21    RROUTA
164900200604     C*
165000200604     C** OUTPUT 'OUTSTANDING ADJUSTMENT SIGN' TO REPORT
165100200604     C                     MOVE WWOSAS    RROTAS
165200200604     C*                                                                   083825
165300200604     C**  Check for overflow and write the appropiate header              083825
165400200604     C*                                                                   083825
165500200604     C           LINE      IFGT 55                                        083825
165600200604     C                     EXSR #WRTHD                                    083825
165700200604     C                     END                                            083825
165800200604     C*                                                                   083825
165900200604     C                     WRITEDETAIL4
166000200604     C*
166100200604     C** UPDATE 'FEES ACCRUED TO DATE' AND GENERATE ACCRUAL ADJUSTMENT
166200200604     C**  POSTINGS
166300200604     C                     EXSR #P05
166400200604     C                     END
166500200604     C*
166600200604     C***ACCESS*LF/SCSEPSLL*WITH*A*NUMERIC*CUSTOMER*NUMBER*************   S01464
166700200604     C***********WWCNUM    SETLLSCSEPSLL                                  S01464
166800200604     C***********          READ SCSEPSLL                 47               S01464
166900200604     C/COPY WNCPYSRC,SE6240C027
167000200604     C*                                                                   S01464
167100200604     C** Access LF/SESEPSLL with a numeric customer number                S01464
167200200604     C           WWCNUM    SETLLSESEPSLL                                  S01464
167300200604     C                     READ SESEPSLL                 47               S01464
167400200604     C*
167500200604     C***DO*WHILE*RECORDS*ON*LF/SCSEPSLL*FOR*CUSTOMER******************   S01464
167600200604     C** Do while records on LF/SESEPSLL for customer                     S01464
167700200604     C           *IN47     DOWEQ'0'
167800200604     C           WWCNUM    ANDEQCSCN
167900200604     C*                                                                   S01464
168000200604     C** Move 'Branch Reference' into a work field                        S01464
168100200604     C                     MOVE CSBA      WWBRCA                          S01464
168200200604     C*
168300200604     C** MOVE 'SECURITY REFERENCE' INTO A WORK FIELD
168400200604     C                     MOVE CSSC      WWCSSC
168500200604     C*
168600200604     C** SET WORK FIELD FOR 'TOTAL VALUE DATE NOMINAL' TO ZERO
168700200604     C                     Z-ADD*ZEROS    WWTVDN 150
168800200604     C*
168900200604     C***DO*WHILE*RECORDS*ON*LF/SCSEPSLL*FOR*SAVED*SECURITY*REFERENCE**   S01464
169000200604     C** Do while records on LF/SESEPSLL for saved security and branch    S01464
169100200604     C** reference.                                                       S01464
169200200604     C           CSSC      DOWEQWWCSSC
169300200604     C           *IN47     ANDEQ'0'
169400200604     C           CSBA      ANDEQWWBRCA                                    S01464
169500200604     C           CSCN      ANDEQWWCNUM                                    S01464
169600200604     C*
169700200604     C** ADD 'VALUE DATE NOMINAL' INTO TOTAL WORK FIELD
169800200604     C/COPY WNCPYSRC,SE6240C005
169900200604     C                     ADD  CSNV      WWTVDN
170000200604     C/COPY WNCPYSRC,SE6240C028
170100200604     C*
170200200604     C***READ*NEXT*RECORD*ON*LF/SCSEPSLL*WITH*CUSTOMER*NUMBER**********   S01464
170300200604     C***********          READ SCSEPSLL                 47               S01464
170400200604     C*                                                                   S01464
170500200604     C** Read next record on LF/SESEPSLL with customer number             S01464
170600200604     C                     READ SESEPSLL                 47               S01464
170700200604     C*
170800200604     C                     END
170900200604     C*
171000200604     C** CALCULATE FEE TO BE ACCRUED FOR THIS SECURITY
171100200604     C                     EXSR #P06
171200200604     C*
171300200604     C** IF CHARGE CODE NOT BLANK
171400200604     C           WWCGCO    IFNE *BLANKS
171500200604     C*
171600200604     C** SET UP REPORT FIELDS FOR SECURITY DETAIL LINE
171700200604     C** SECURITY REFERENCE
171800200604     C                     MOVE WWCSSC    RRSCTY
171900200604     C*                                                                   S01464
172000200604     C** Branch Reference                                                 S01464
172100200604     C                     MOVE WWBRCA    RRBRCA                          S01464
172200200604     C*
172300200604     C** INVESTMENT TYPE
172400200604     C                     MOVE SITP      RRIVTS
172500200604     C*
172600200604     C** NOMINAL CURRENCY
172700200604     C                     MOVE NMCY      RRNMCS
172800200604     C*
172900200604     C** NOMINAL POSITION
173000200604     C                     Z-ADDWWTVDN    ZFLD15
173100200604     C                     Z-ADDNMDP      ZDECS
173200200604     C                     MOVE 'J'       ZECODE
173300200604     C                     EXSR ZSEDIT
173400200604     C                     MOVE ZOUT21    RRNPSS
173500200604     C*
173600200604     C** MARKET VALUE IN NOMINAL CURRENCY
173700200604     C                     Z-ADDWWMVNC    ZFLD15
173800200604     C                     Z-ADDA6NBDP    ZDECS
173900200604     C                     MOVE 'J'       ZECODE
174000200604     C                     EXSR ZSEDIT
174100200604     C                     MOVE ZOUT21    RRMNCS
174200200604     C*
174300200604     C** MARKET VALUE IN BANK CHARGING CURRENCY
174400200604     C                     Z-ADDWWMVBC    ZFLD15
174500200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
174600200604     C                     Z-ADDZCDPT     ZDECS                           S01464
174700200604     C                     MOVE 'J'       ZECODE
174800200604     C                     EXSR ZSEDIT
174900200604     C                     MOVE ZOUT21    RRMCCS
175000200604     C*
175100200604     C** FEE CODE
175200200604     C                     MOVE WWCGCO    RRFECS
175300200604     C*
175400200604     C** AMOUNT ACCRUED TODAY
175500200604     C                     Z-ADDWWAAFS    ZFLD15
175600200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
175700200604     C                     Z-ADDZCDPT     ZDECS                           S01464
175800200604     C                     MOVE 'J'       ZECODE
175900200604     C                     EXSR ZSEDIT
176000200604     C/COPY WNCPYSRC,SE6240C006
176100200604     C                     MOVE ZOUT21    RRAATS
176200200604     C/COPY WNCPYSRC,SE6240C007
176300200604     C*
176400200604     C** WRITE DETAIL LINE TO REPORT
176500200604     C           CSNV      IFNE 0                                         B05945
176600200604     C*                                                                   083825
176700200604     C**  Check for overflow and write the appropiate header              083825
176800200604     C*                                                                   083825
176900200604     C           LINE      IFGT 55                                        083825
177000200604     C                     EXSR #WRTHD                                    083825
177100200604     C                     END                                            083825
177200200604     C*                                                                   083825
177300200604     C                     WRITEDETAIL6
177400200604     C                     END                                            B05945
177500200604     C*
177600200604     C** ADD FEE ACCRUED IN #P06 TO 'FEES ACCRUED TO DATE' AND TO
177700200604     C**  'FEES ACCRUED TODAY'
177800200604     C                     ADD  WWAAFS    WWCFAC
177900200604     C                     ADD  WWAAFS    WWFACT
178000200604     C/COPY WNCPYSRC,SE6240C029
178100200604     C*
178200200604     C                     END
178300200604     C                     END
178400200604     C*
178500200604     C***ACCESS*PF/SCPMABPD*WITH*CUST*NUMBER*AND*PORTFOLIO*REFERENCE***   S01464
178600200604     C*                                                                   S01464
178700200604     C** Access PF/SEPMABPD with CUST Number and Portfolio Reference      S01464
178800200604     C*                                                                   S01464
178900200604     C                     MOVE *BLANKS   WWPTFR
179000200604     C                     MOVE *BLANKS   WWCCYP  3
179100200604     C***********WWKEY3    SETLLSCPMABPD                                  S01464
179200200604     C***********          READ SCPMABPD                 53               S01464
179300200604     C           WWKEY3    SETLLSEPMABPD                                  S01464
179400200604     C                     READ SEPMABPD                 53               S01464
179500200604     C*
179600200604     C** SET UP PORTFOLIO REFERENCE TO BE OUTPUT TO SCSCFAPD
179700200604     C           FBCFCP    IFNE 'C'                                       S01464
179800200604     C           WWPTFR    IFEQ *BLANKS
179900200604     C                     MOVE '9999'    WWPTFR
180000200604     C                     ELSE
180100200604     C                     MOVE SGPTFR    WWPTFR
180200200604     C                     END
180300200604     C                     END                                            S01464
180400200604     C*
180500200604     C** WHILE RECORDS EXIST FOR THIS CUSTOMER
180600200604     C           *IN53     DOWEQ'0'
180700200604     C           WWCNUM    ANDEQSGCNUM
180800200604     C*
180900200604     C** CALCULATE FEE TO BE ACCRUED FOR THIS ACCOUNT
181000200604     C                     EXSR #P07
181100200604     C*
181200200604     C** IF CHARGE CODE NOT BLANK
181300200604     C           WWCGCO    IFNE *BLANKS
181400200604     C*
181500200604     C** SET UP REPORT FIELDS FOR ACCOUNT DETAIL LINE
181600200604     C*                                                                   S01464
181700200604     C** If in a multi-branch environment, output branch to report.       S01464
181800200604     C           *IN10     IFEQ '1'                                       S01464
181900200604     C                     MOVE SGBRCA    RRBRCA                          S01464
182000200604     C                     END                                            S01464
182100200604     C*                                                                   S01464
182200200604     C** ACCOUNT CODE
182300200604     C                     MOVE WWACNT    RRACNT
182400200604     C*
182500200604     C** INVESTMENT TYPE
182600200604     C                     MOVE *BLANKS   RRIVTA
182700200604     C*
182800200604     C** NOMINAL CURRENCY
182900200604     C                     MOVE SGCCY     RRNMCA
183000200604     C*
183100200604     C** NOMINAL POSITION
183200200604     C           SGCLBL    IFLT 0
183300200604     C                     Z-SUBSGCLBL    ZFLD15
183400200604     C                     ELSE
183500200604     C                     Z-ADDSGCLBL    ZFLD15
183600200604     C                     END
183700200604     C*
183800200604     C                     Z-ADDA6NBDP    ZDECS
183900200604     C                     MOVE 'J'       ZECODE
184000200604     C                     EXSR ZSEDIT
184100200604     C                     MOVE ZOUT21    RRNPSA
184200200604     C*
184300200604     C** SET UP CREDIT DEBIT INDICATOR
184400200604     C           SGCLBL    IFLT 0
184500200604     C                     MOVE 'CR'      RRDRCR
184600200604     C                     ELSE
184700200604     C                     MOVE 'DR'      RRDRCR
184800200604     C                     END
184900200604     C*
185000200604     C** MARKET VALUE IN NOMINAL CURRENCY
185100200604     C                     Z-ADDWWMVNC    ZFLD15
185200200604     C                     Z-ADDA6NBDP    ZDECS
185300200604     C                     MOVE 'J'       ZECODE
185400200604     C                     EXSR ZSEDIT
185500200604     C                     MOVE ZOUT21    RRMNCA
185600200604     C*
185700200604     C** MARKET VALUE IN BANK CHARGING CURRENCY
185800200604     C                     Z-ADDWWMVBC    ZFLD15
185900200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
186000200604     C                     Z-ADDZCDPT     ZDECS                           S01464
186100200604     C                     MOVE 'J'       ZECODE
186200200604     C                     EXSR ZSEDIT
186300200604     C                     MOVE ZOUT21    RRMCCA
186400200604     C*
186500200604     C** FEE CODE
186600200604     C                     MOVE WWCGCO    RRFECA
186700200604     C*
186800200604     C** AMOUNT ACCRUED TODAY
186900200604     C                     Z-ADDWWAAFA    ZFLD15
187000200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
187100200604     C                     Z-ADDZCDPT     ZDECS                           S01464
187200200604     C                     MOVE 'J'       ZECODE
187300200604     C                     EXSR ZSEDIT
187400200604     C/COPY WNCPYSRC,SE6240C008
187500200604     C                     MOVE ZOUT21    RRAATA
187600200604     C/COPY WNCPYSRC,SE6240C009
187700200604     C*
187800200604     C** WRITE DETAIL LINE TO REPORT
187900200604     C           SGCLBL    IFNE 0                                         B05945
188000200604     C*                                                                   083825
188100200604     C**  Check for overflow and write the appropiate header              083825
188200200604     C*                                                                   083825
188300200604     C           LINE      IFGT 55                                        083825
188400200604     C                     EXSR #WRTHD                                    083825
188500200604     C                     END                                            083825
188600200604     C*                                                                   083825
188700200604     C                     WRITEDETAIL7
188800200604     C                     END                                            B05945
188900200604     C*
189000200604     C** ADD FEE ACCRUED IN #P07 TO 'FEES ACCRUED TO DATE' AND TO
189100200604     C**  'FEES ACCRUED TODAY'
189200200604     C                     ADD  WWAAFA    WWCFAC
189300200604     C                     ADD  WWAAFA    WWFACT
189400200604     C*
189500200604     C                     END
189600200604     C*
189700200604     C***READ*NEXT*RECORD*ON*PF/SCPMABPD*******************************   S01464
189800200604     C***********          READ SCPMABPD                 53               S01464
189900200604     C*                                                                   S01464
190000200604     C** Read next record ON PF/SEPMABPD                                  S01464
190100200604     C                     READ SEPMABPD                 53               S01464
190200200604     C*
190300200604     C                     END
190400200604     C/COPY WNCPYSRC,SE6240C010
190500200604     C*
190600200604     C***ACCESS*PF/SCSCFAPD*WITH*CUSTOMER*AND*PORTFOLIO*REFERENCE*TO***   S01464
190700200604     C****SEE*IF*RECORD*EXISTS*****************************************   S01464
190800200604     C***********WWKEY1    CHAINSCSCFAPD             46                   S01464
190900200604     C*                                                                   S01464
191000200604     C** Access PF/SCSCFAPD with Customer and Portfolio Reference to      S01464
191100200604     C**  see if record exists                                            S01464
191200200604     C*                                                                   S01464
191300200604     C           WWKEY1    CHAINSESCFAPD             46                   S01464
191400200604     C*****************************************************************   S01464
191500200604     C***IF*RECORD*EXISTS*UPDATE*RECORD*ON*PF/SCSCFAPD*****************   S01464
191600200604     C** IF RECORD EXISTS UPDATE RECORD ON PF/SESCFAPD                    S01464
191700200604     C           *IN46     IFEQ '0'
191800200604     C*
191900200604     C** TYPE OF LAST CHANGE
192000200604     C                     MOVE 'A'       SDCHTP
192100200604     C*
192200200604     C** CUSTODY FEE ACCRUED TO DATE
192300200604     C                     Z-ADDWWCFAC    SDCFAC
192400200604     C*
192500200604     C** OUTSTANDING ACCRUAL ADJUSTMENT
192600200604     C                     Z-ADD*ZEROS    SDOSAJ
192700200604     C*
192800200604     C** OUTSTANDING ACCRUAL ADJUSTMENT SIGN
192900200604     C                     MOVE *BLANKS   SDOSAS
193000200604     C*
193100200604     C***UPDATE*PF/SCSCFAPD********************************************   S01464
193200200604     C***********          UPDATSCSCFAP0                                  S01464
193300200604     C*                                                                   S01464
193400200604     C** Update PF/SESCFAPD                                               S01464
193500200604     C                     UPDATSESCFAP0                                  S01464
193600200604     C*
193700200604     C                     ELSE
193800200604     C*
193900200604     C***IF*RECORD*DOES*NOT*EXIST*WRITE*RECORD*TO*PF/SCSCFAPD**********   S01464
194000200604     C** If record does not exist write record to PF/SESCFAPD             S01464
194100200604     C*
194200200604     C** RECORD ID
194300200604     C                     MOVE 'D'       SDRECI
194400200604     C*
194500200604     C** DAY OF LAST UPDATE
194600200604     C                     Z-ADDWWDAYU    SDDLUP
194700200604     C*
194800200604     C** MONTH OF LAST UPDATE
194900200604     C                     MOVE WWMTHU    SDMLUP
195000200604     C*
195100200604     C** YEAR OF LAST UPDATE
195200200604     C                     Z-ADDWWYERU    SDYLUP
195300200604     C*
195400200604     C** TIME OF LAST UPDATE
195500200604     C                     TIME           SDTLUP
195600200604     C*
195700200604     C** TYPE OF LAST CHANGE
195800200604     C                     MOVE 'I'       SDCHTP
195900200604     C*
196000200604     C** LAST CHANGE DATE
196100200604     C                     Z-ADDBJRDNB    SDLCD
196200200604     C*
196300200604     C** TRANSACTION NUMBER OF LAST UPDATE
196400200604     C********             Z-ADD*ZEROS    SDTNLU
196500200604     C*
196600200604     C** RETRIEVE NEXT TRANSACTION NUMBER
196700200604     C*
196800200604     C                     EXSR ZTNLU1
196900200604     C                     MOVELNATN      SDTNLU
197000200604     C*
197100200604     C** CUSTOMER NUMBER
197200200604     C**********           Z-ADDWWCNUM    SDCNUM                                              CSD027
197300200604     C                     MOVE WWCNUM    SDCNUM                                              CSD027
197400200604     C*
197500200604     C** PORTFOLIO REFERENCE
197600200604     C                     MOVE WWPTFR    SDPTFR
197700200604     C*
197800200604     C** CUSTODY FEE ACCRUED TO DATE
197900200604     C                     Z-ADDWWCFAC    SDCFAC
198000200604     C*
198100200604     C** OUTSTANDING ACCRUAL ADJUSTMENT
198200200604     C                     Z-ADD*ZEROS    SDOSAJ
198300200604     C*
198400200604     C** OUTSTANDING ACCRUAL ADJUSTMENT SIGN
198500200604     C                     MOVE *BLANKS   SDOSAS
198600200604     C*
198700200604     C** Branch Code                                                      S01464
198800200604     C                     MOVE WWBRCH    SDBRCA                          S01464
198900200604     C*                                                                   S01464
199000200604     C***WRITE*RECORD*TO*PF/SCSCFAPD***********************************   S01464
199100200604     C***********          WRITESCSCFAP0                                  S01464
199200200604     C*                                                                   S01464
199300200604     C** Write record to PF/SESCFAPD                                      S01464
199400200604     C                     WRITESESCFAP0                                  S01464
199500200604     C*
199600200604     C                     END
199700200604     C/COPY WNCPYSRC,SE6240C030
199800200604     C*
199900200604     C** IF 'FEE ACCRUED TODAY' NOT ZERO CALL #P10
200000200604     C           WWFACT    IFNE *ZEROS
200100200604     C                     EXSR #P10
200200200604     C                     END
200300200604     C/COPY WNCPYSRC,SE6240C011
200400200604     C*
200500200604     C** OUTPUT 'FEES ACCRUED TO DATE' REPORT LINE
200600200604     C                     Z-ADDWWCFAC    ZFLD15
200700200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
200800200604     C                     Z-ADDZCDPT     ZDECS                           S01464
200900200604     C                     MOVE 'J'       ZECODE
201000200604     C                     EXSR ZSEDIT
201100200604     C                     MOVE ZOUT21    RRFATD
201200200604     C*                                                                   083825
201300200604     C**  Check for overflow and write the appropiate header              083825
201400200604     C*                                                                   083825
201500200604     C           LINE      IFGT 55                                        083825
201600200604     C                     EXSR #WRTHD                                    083825
201700200604     C                     END                                            083825
201800200604     C*                                                                   083825
201900200604     C                     WRITEDETAIL5
202000200604     C*
202100200604     C                     ENDSR
202200200604     C********************************************************************
202300200604     C/EJECT
202400200604     C********************************************************************
202500200604     C*
202600200604     C***********#P04      BEGSR                                          S01464
202700200604     C*****************************************************************   S01464
202800200604     C***IF*HEADINGS*NOT*ALREADY*WRITTEN*ON*NEW*PAGE*******************   S01464
202900200604     C************IN30     IFEQ '0'                                       S01464
203000200604     C*****************************************************************   S01464
203100200604     C***IF*CHANGE*OF*ACCOUNT*OFFICER**********************************   S01464
203200200604     C***********AZACOC    IFNE WWACOC                                    S01464
203300200604     C*****************************************************************   S01464
203400200604     C***MOVE*PRINTER*LOCATION*INTO*REPORT*FIELD***********************   S01464
203500200604     C***********          MOVE WWPLOC    RRPLOC                          S01464
203600200604     C*****************************************************************   S01464
203700200604     C***WRITE*MAIN*HEADING********************************************   S01464
203800200604     C***********          WRITEHEADER1                                   S01464
203900200604     C*****************************************************************   S01464
204000200604     C***MOVE*FILE*FIELDS*TO*REPORT*FIELDS*FOR*ACCOUNT*OFFICER*HEADING*   S01464
204100200604     C***********          MOVE AZACOC    RRACOC                          S01464
204200200604     C***********          MOVE AZACON    RRACON                          S01464
204300200604     C*****************************************************************   S01464
204400200604     C***WRITE*ACCOUNT*OFFICER*HEADING*********************************   S01464
204500200604     C***********          WRITEHEADER2                                   S01464
204600200604     C*****************************************************************   S01464
204700200604     C***********          END                                            S01464
204800200604     C***********          END                                            S01464
204900200604     C*****************************************************************   S01464
205000200604     C***ACCESS*PF/PMPORTPP*WITH*NUMERIC*CUSTOMER*NUMBER***************   S01464
205100200604     C*******    WWCNUM    CHAINPMPORTPP             54
205200200604     C***********          MOVE *LOVAL    WWPREF                          S01464
205300200604     C***********PMPORK    SETLLPMPORTLL                                  S01464
205400200604     C***********          READ PMPORTLL                 54               S01464
205500200604     C*****************************************************************   S01464
205600200604     C***WHILE*RECORDS*FOR*THIS*CUSTOMER*******************************   S01464
205700200604     C************IN54     DOWEQ'0'                                       S01464
205800200604     C***********PNCNUM    ANDEQWWCNUM                                    S01464
205900200604     C*****************************************************************   S01464
206000200604     C***SET*'FEES*ACCRUED*TODAY'*TO*ZERO******************************   S01464
206100200604     C***********          Z-ADD*ZEROS    WWFACT                          S01464
206200200604     C*****************************************************************   S01464
206300200604     C***SET*PORTFOLIIO*REFERENCE**************************************   S01464
206400200604     C***********          MOVE PNPTFR    WWPTFR                          S01464
206500200604     C*****************************************************************   S01464
206600200604     C***CALL*SUBROUTINE*TO*CALCULATE*ACCRUALS*FOR*PORTFOLIO***********   S01464
206700200604     C***********          EXSR #P11                                      S01464
206800200604     C*****************************************************************   S01464
206900200604     C***READ*NEXT*RECORD*FOR*THIS*CUSTOMER*FROM*LF/PMPORTLL***********   S01464
207000200604     C***********          READ PMPORTLL                 54               S01464
207100200604     C***********          END                                            S01464
207200200604     C*****************************************************************   S01464
207300200604     C***SET*'FEES*ACCRUED*TODAY'*TO*ZERO******************************   S01464
207400200604     C***********          Z-ADD*ZEROS    WWFACT                          S01464
207500200604     C*****************************************************************   S01464
207600200604     C***SET*PORTFOLIIO*REFERENCE**************************************   S01464
207700200604     C***********          MOVE '9997'    WWPTFR                          S01464
207800200604     C*****************************************************************   S01464
207900200604     C***CALL*SUBROUTINE*TO*CALCULATE*ACCRUALS*FOR*PORTFOLIO***********   S01464
208000200604     C***********          EXSR #P11                                      S01464
208100200604     C*****************************************************************   S01464
208200200604     C***********          ENDSR                                          S01464
208300200604     C*                                                                   091522
208400200604     C           #P04      BEGSR                                          091522
208500200604     C*                                                                   091522
208600200604     C** IF HEADINGS NOT ALREADY WRITTEN ON NEW PAGE                      091522
208700200604     C           *IN30     IFEQ '0'                                       091522
208800200604     C*                                                                   091522
208900200604     C** IF CHANGE OF ACCOUNT OFFICER                                     091522
209000200604     C           BBACOC    IFNE WWACOC                                    091522
209100200604     C           BBACOC    OREQ *BLANKS                                   091522
209200200604     C           RRBRCD    ORNE WWBRCH                                    157193
209300200604     C           WWBLHD    ANDEQ*BLANKS                                   091522
209400200604     C                     MOVE 'Y'       WWBLHD                          091522
209500200604     C*                                                                   091522
209600200604     C** Move branch code into report field                               091522
209700200604     C                     MOVE WWBRCH    RRBRCD                          091522
209800200604     C*                                                                   091522
209900200604     C** WRITE MAIN HEADING                                               091522
210000200604     C                     WRITEHEADER1                                   091522
210100200604     C*                                                                   091522
210200200604     C** MOVE FILE FIELDS TO REPORT FIELDS FOR ACCOUNT OFFICER HEADING    091522
210300200604     C                     MOVE BBACOC    RRACOC                          091522
210400200604     C*                                                                   091522
210500200604     C** OPEN ACCOUNT OFFICER DETAILS FILE                                091522
210600200604     C                     OPEN SDACOFL1                                  091522
210700200604     C*                                                                   091522
210800200604     C** ACCESS LF/SDACOFL1 WITH ACCOUNT OFFICER CODE                     091522
210900200604     C           BBACOC    CHAINSDACOFL1             57                   091522
211000200604     C*                                                                   091522
211100200604     C** GET ACCOUNT OFFICER NAME FOR ACCOUNT OFFICER HEADING             091522
211200200604     C           *IN57     IFEQ '1'                                       091522
211300200604     C                     MOVE *BLANKS   RRACON                          091522
211400200604     C                     ELSE                                           091522
211500200604     C                     MOVE AZACON    RRACON                          091522
211600200604     C                     END                                            091522
211700200604     C*                                                                   091522
211800200604     C                     CLOSESDACOFL1                                  091522
211900200604     C*                                                                   091522
212000200604     C** WRITE ACCOUNT OFFICER HEADING                                    091522
212100200604     C                     WRITEHEADER2                                   091522
212200200604     C**                                                                  091522
212300200604     C                     END                                            091522
212400200604     C                     END                                            091522
212500200604     C*                                                                   091522
212600200604     C** ACCESS PF/PMPORTPP WITH NUMERIC CUSTOMER NUMBER                  091522
212700200604     C                     MOVE *LOVAL    WWPREF                          091522
212800200604     C           PMPORK    SETLLPMPORTLL                                  091522
212900200604     C                     READ PMPORTLL                 54               091522
213000200604     C*                                                                   091522
213100200604     C** WHILE RECORDS FOR THIS CUSTOMER                                  091522
213200200604     C           *IN54     DOWEQ'0'                                       091522
213300200604     C           PNCNUM    ANDEQWWCNUM                                    091522
213400200604     C*                                                                   091522
213500200604     C** SET 'FEES ACCRUED TODAY' TO ZERO                                 091522
213600200604     C                     Z-ADD*ZEROS    WWFACT                          091522
213700200604     C/COPY WNCPYSRC,SE6240C012
213800200604     C*                                                                   091522
213900200604     C** SET PORTFOLIO REFERENCE                                          091522
214000200604     C                     MOVE PNPTFR    WWPTFR                          091522
214100200604     C*                                                                   091522
214200200604     C** CALL SUBROUTINE TO CALCULATE ACCRUALS FOR PORTFOLIO              091522
214300200604     C                     EXSR #P11                                      091522
214400200604     C*                                                                   091522
214500200604     C** READ NEXT RECORD FOR THIS CUSTOMER FROM LF/PMPORTLL              091522
214600200604     C                     READ PMPORTLL                 54               091522
214700200604     C                     END                                            091522
214800200604     C*                                                                   091522
214900200604     C** SET 'FEES ACCRUED TODAY' TO ZERO                                 091522
215000200604     C                     Z-ADD*ZEROS    WWFACT                          091522
215100200604     C/COPY WNCPYSRC,SE6240C026
215200200604     C*                                                                   091522
215300200604     C** SET PORTFOLIO REFERENCE                                          091522
215400200604     C                     MOVE '9997'    WWPTFR                          091522
215500200604     C*                                                                   091522
215600200604     C** CALL SUBROUTINE TO CALCULATE ACCRUALS FOR PORTFOLIO              091522
215700200604     C                     EXSR #P11                                      091522
215800200604     C*                                                                   091522
215900200604     C                     ENDSR                                          091522
216000200604     C********************************************************************
216100200604     C/EJECT
216200200604     C********************************************************************
216300200604     C*
216400200604     C           #P05      BEGSR
216500200604     C*
216600200604     C** IF CHARGE ADJUSTMENT SIGN ON PF/SCSCFAPD IS '+'
216700200604     C           WWOSAS    IFEQ '+'
216800200604     C*
216900200604     C** GENERATE ACCRUAL ENTRIES WITH 'FEES ACCRUED TODAY' EQUAL TO
217000200604     C**  'OUTSTANDING ADJUSTMENT AMOUNT' ON PF/SCSCFAPD
217100200604     C                     Z-ADDWWOSAJ    WWFACT
217200200604     C                     EXSR #P10
217300200604     C                     ADD  WWOSAJ    WWCFAC
217400200604     C*
217500200604     C                     ELSE
217600200604     C*
217700200604     C** IF CHARGE ADJUSTMENT SIGN ON PF/SCSCFAPD IS '-'
217800200604     C           WWOSAS    IFEQ '-'
217900200604     C*
218000200604     C** GENERATE ACCRUAL ENTRIES WITH 'FEES ACCRUED TODAY' EQUAL TO
218100200604     C**  '-OUTSTANDING ADJUSTMENT AMOUNT' ON PF/SCSCFAPD
218200200604     C                     Z-SUBWWOSAJ    WWFACT
218300200604     C                     EXSR #P10
218400200604     C                     SUB  WWOSAJ    WWCFAC
218500200604     C*
218600200604     C                     END
218700200604     C                     END
218800200604     C*
218900200604     C** ZEROISE THE CHARGE ADJUSTMENT AMOUNT AND BLANK OUT THE
219000200604     C**  CHARGE ADJUSTMENT SIGN
219100200604     C                     Z-ADD*ZEROS    WWOSAJ
219200200604     C                     MOVE *BLANKS   WWOSAS
219300200604     C*
219400200604     C** SET 'FEES ACCRUED TODAY' TO ZERO
219500200604     C                     Z-ADD*ZEROS    WWFACT
219600200604     C*
219700200604     C                     ENDSR
219800200604     C********************************************************************
219900200604     C/EJECT
220000200604     C********************************************************************
220100200604     C*
220200200604     C           #P06      BEGSR
220300200604     C*
220400200604     C** INITIALISE WORK FIELD FOR 'AMOUNT ACCRUED FOR SECURITY'
220500200604     C                     Z-ADD*ZEROS    WWAAFS 150
220600200604     C*
220700200604     C** SET WORK FIELD FOR 'CHARGE CODE ' TO BLANK
220800200604     C                     MOVE *BLANKS   WWCGCO
220900200604     C*
221000200604     C** ACCESS LF/SECTY WITH SECURITY REFERENCE
221100200604     C           WWCSSC    CHAINSECTY                48
221200200604     C*
221300200604     C** IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
221400200604     C           *IN48     IFEQ '1'
221500200604     C           CHTP      OREQ 'D'
221600200604     C           *LOCK     IN   LDA                                       S01464
221700200604     C                     Z-ADD5         DBASE
221800200604     C                     MOVE *BLANKS   DBFILE           *****************
221900200604     C                     MOVEL'SECTY   'DBFILE           ** DBERROR  005**
222000200604     C                     MOVE *BLANKS   DBKEY            *****************
222100200604     C                     MOVELWWCSSC    DBKEY
222200200604     C                     OUT  LDA                                       S01464
222300200604     C                     EXSR #ZA
222400200604     C*
222500200604     C                     ELSE
222600200604     C*
222700200604     C** DETERMINE CHARGE TO BE LEVIED
222800200604     C                     EXSR #P08
222900200604     C                     END
223000200604     C*
223100200604     C** IF CHARGE CODE BLANK TERMINATE ROUTINE
223200200604     C           WWCGCO    IFEQ *BLANKS
223300200604     C                     GOTO #P060
223400200604     C                     END
223500200604     C*
223600200604     C***ACCESS*PF/SCCHRGPD*WITH*CHARGE*CODE*RETURNED*FROM*#P08           S01464
223700200604     C***********WWCGCO    CHAINSCCGCDPD             49                   S01464
223800200604     C*                                                                   S01464
223900200604     C** Access PF/SECGCDPD with charge code returned from #P08           S01464
224000200604     C           WWCGCO    CHAINSECGCDPD             49                   S01464
224100200604     C*
224200200604     C** IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
224300200604     C           *IN49     IFEQ '1'
224400200604     C           SFCHTP    OREQ 'D'
224500200604     C           *LOCK     IN   LDA                                       S01464
224600200604     C                     Z-ADD6         DBASE
224700200604     C                     MOVE *BLANKS   DBFILE           *****************
224800200604     C***********          MOVEL'SCCGCDPD'DBFILE         ** DBERROR  006**S01464
224900200604     C                     MOVEL'SECGCDPD'DBFILE           * DBERROR 006 *S01464
225000200604     C                     MOVE *BLANKS   DBKEY            *****************
225100200604     C                     MOVELWWCGCO    DBKEY
225200200604     C                     OUT  LDA                                       S01464
225300200604     C                     EXSR #ZA
225400200604     C*
225500200604     C                     ELSE
225600200604     C*
225700200604     C***ACCESS*LF/SDCURRJ0*WITH*NOMINAL*CCY*FROM*LF/SECTY*************   S01464
225800200604     C***********NMCY      CHAINSDCURRJ0             50                   S01464
225900200604     C*                                                                   S01464
226000200604     C** Access LF/SDCURRL0 with Nominal Ccy from LF/SECTY                S01464
226100200604     C           NMCY      CHAINSDCURRL0             50                   S01464
226200200604     C*
226300200604     C** IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
226400200604     C           *IN50     IFEQ '1'
226500200604     C           A6TYLC    OREQ 'D'
226600200604     C           *LOCK     IN   LDA                                       S01464
226700200604     C                     Z-ADD7         DBASE
226800200604     C                     MOVE *BLANKS   DBFILE           *****************
226900200604     C***********          MOVEL'SDCURRJ0'DBFILE         ** DBERROR  007**S01464
227000200604     C                     MOVEL'SDCURRL0'DBFILE           **DBERROR 007**S01464
227100200604     C                     MOVE *BLANKS   DBKEY            *****************
227200200604     C                     MOVELNMCY      DBKEY
227300200604     C                     OUT  LDA                                       S01464
227400200604     C                     EXSR #ZA
227500200604     C*
227600200604     C                     ELSE
227700200604     C*
227800200604     C** CALCULATE 'MARKET VALUE OF SECURITY' IN NOMINAL CCY USING
227900200604     C**  STANDARD SUBROUTINE ZAPNUM
228000200604     C                     Z-ADDWWTVDN    ZNOML
228100200604     C*                                                                   B05945
228200200604     C** CONVERT DISCOUNT/YIELD INTO PERCENTAGE PRICE                     B05945
228300200604     C           SPBS      IFEQ 'D'                                       B05945
228400200604     C           SPBS      OREQ 'Y'                                       B05945
228500200604     C                     Z-ADDBJRDNB    ZFDATE                          B05945
228600200604     C                     Z-ADDMKPR      ZPRCIN                          B05945
228700200604     C*                                                                   S01464
228800200604     C** Access LF/INVTP with Nominal Ccy and Investment Type             S01464
228900200604     C** from LF/SECTY.                                                   S01464
229000200604     C           WWKEY4    CHAININVTP                60                   S01464
229100200604     C*                                                                   S01464
229200200604     C** If record not found or RECI not equal to 'D' then DB error       S01464
229300200604     C           *IN60     IFEQ '1'                                       S01464
229400200604     C           RECI      ORNE 'D'                                       S01464
229500200604     C           *LOCK     IN   LDA                                       S01464
229600200604     C                     Z-ADD10        DBASE                           S01464
229700200604     C                     MOVE *BLANKS   DBFILE           ***************S01464
229800200604     C                     MOVEL'INVTP   'DBFILE           **DBERROR 010**S01464
229900200604     C                     MOVE *BLANKS   DBKEY            ***************S01464
230000200604     C                     MOVELNMCY      DBKEY                           S01464
230100200604     C                     MOVE SITP      DBKEY                           S01464
230200200604     C                     OUT  LDA                                       S01464
230300200604     C                     EXSR #ZA                                       S01464
230400200604     C                     ELSE                                           S01464
230500200604     C                     EXSR ZPRCI                                     B05945
230600200604     C                     END                                            S01464
230700200604     C*                                                                   S01464
230800200604     C                     Z-ADDZPRCOT    ZAVPR                           B05945
230900200604     C                     ELSE                                           B05945
231000200604     C                     Z-ADDMKPR      ZAVPR
231100200604     C                     END                                            B05945
231200200604     C/COPY WNCPYSRC,SE6240C032
231300200604     C                     Z-ADDNMDP      ZNMDP
231400200604     C                     Z-ADDA6NBDP    ZNMCD
231500200604     C                     MOVE SPBS      ZPRCB
231600200604     C                     EXSR ZAPNUM
231700200604     C                     Z-ADDZVALU     WWMVNC 150
231800200604     C*
231900200604     C** CONVERT FROM NOMINAL CCY TO BANK CHARGING CCY. USING SR/ZCCYCN
232000200604     C                     Z-ADDWWMVNC    ZAMTF
232100200604     C                     MOVE NMCY      ZCCYF
232200200604     C                     Z-ADDA6SPRT    ZRATEF
232300200604     C                     MOVE A6MDIN    ZMDINF
232400200604     C                     Z-ADDA6NBDP    ZCDPF
232500200604     C                     EXSR ZCCYCN
232600200604     C                     Z-ADDZAMTT     WWMVBC 150
232700200604     C*                                                                   B07896
232800200604     C** IF POSITION EXISTS, BUT MARKET VALUE IS ZERO, SHOULD CALCULATE   B07896
232900200604     C** FEE IF THE CHARGE BASIS IS FLAT                                  B07896
233000200604     C           SFCGBS    IFEQ 'F'                                       B07896
233100200604     C           ZNOML     ANDGT0                                         B07896
233200200604     C           WWMVBC    ANDEQ0                                         B07896
233300200604     C                     Z-ADD1         WWMVBC                          B07896
233400200604     C                     END                                            B07896
233500200604     C*
233600200604     C** CALCULATE FEE TO BE CHARGED FOR SECURITY USING SR/ZPMCRG
233700200604     C           SFCGBS    IFEQ 'N'
233800200604     C                     Z-ADDWWTVDN    WWTVDS 150
233900200604     C           NMDP      IFGT *ZEROS
234000200604     C*          NMDP      ADD  4         X       10                      B05945
234100200604     C           NMDP      ADD  4         X       20                      B05945
234200200604     C           WWTVDN    DIV  POWER8,X  WWTVDN
234300200604     C                     END
234400200604     C                     Z-ADDWWTVDN    ZAMT
234500200604     C                     Z-ADDWWTVDS    WWTVDN
234600200604     C                     ELSE
234700200604     C           SFCGBS    IFEQ 'F'
234800200604     C           SFCGBS    OREQ 'P'
234900200604     C                     Z-ADDWWMVBC    ZAMT
235000200604     C                     END
235100200604     C                     END
235200200604     C                     Z-ADD3         ZDYBS
235300200604     C                     Z-ADD3         ZDVBS
235400200604     C                     Z-ADD*ZEROS    ZSPRD
235500200604     C                     MOVE *BLANKS   ZSPRI
235600200604     C           SFCGBS    IFEQ 'N'
235700200604     C                     MOVE 'F'       ZCGBS
235800200604     C                     ELSE
235900200604     C           SFCGBS    IFEQ 'F'
236000200604     C           SFCGBS    OREQ 'P'
236100200604     C                     MOVE SFCGBS    ZCGBS
236200200604     C                     END
236300200604     C                     END
236400200604     C                     MOVE SFCGMT    ZCGMT
236500200604     C                     Z-ADDSFMINC    ZMINC
236600200604     C                     Z-ADDSFCRU1    ZRA,1
236700200604     C                     Z-ADDSFCRU2    ZRA,2
236800200604     C                     Z-ADDSFCRU3    ZRA,3
236900200604     C                     Z-ADDSFCRU4    ZRA,4
237000200604     C                     Z-ADDSFCRU5    ZRA,5
237100200604     C                     Z-ADDSFCRU6    ZRA,6
237200200604     C                     Z-ADDSFCRU7    ZRA,7
237300200604     C                     Z-ADDSFCRU8    ZRA,8
237400200604     C                     Z-ADDSFCRU9    ZRA,9
237500200604     C                     Z-ADDSFCR10    ZRA,10
237600200604     C                     Z-ADDSFCR11    ZRA,11
237700200604     C                     Z-ADDSFCR12    ZRA,12
237800200604     C                     Z-ADDSFCR13    ZRA,13
237900200604     C                     Z-ADDSFCR14    ZRA,14
238000200604     C                     Z-ADDSFPCL1    ZPC,1
238100200604     C                     Z-ADDSFPCL2    ZPC,2
238200200604     C                     Z-ADDSFPCL3    ZPC,3
238300200604     C                     Z-ADDSFPCL4    ZPC,4
238400200604     C                     Z-ADDSFPCL5    ZPC,5
238500200604     C                     Z-ADDSFPCL6    ZPC,6
238600200604     C                     Z-ADDSFPCL7    ZPC,7
238700200604     C                     Z-ADDSFPCL8    ZPC,8
238800200604     C                     Z-ADDSFPCL9    ZPC,9
238900200604     C                     Z-ADDSFPC10    ZPC,10
239000200604     C                     Z-ADDSFPC11    ZPC,11
239100200604     C                     Z-ADDSFPC12    ZPC,12
239200200604     C                     Z-ADDSFPC13    ZPC,13
239300200604     C                     Z-ADDSFPC14    ZPC,14
239400200604     C                     Z-ADDSFPC15    ZPC,15
239500200604     C                     Z-ADDSFFLC1    ZCG,1
239600200604     C                     Z-ADDSFFLC2    ZCG,2
239700200604     C                     Z-ADDSFFLC3    ZCG,3
239800200604     C                     Z-ADDSFFLC4    ZCG,4
239900200604     C                     Z-ADDSFFLC5    ZCG,5
240000200604     C                     Z-ADDSFFLC6    ZCG,6
240100200604     C                     Z-ADDSFFLC7    ZCG,7
240200200604     C                     Z-ADDSFFLC8    ZCG,8
240300200604     C                     Z-ADDSFFLC9    ZCG,9
240400200604     C                     Z-ADDSFFL10    ZCG,10
240500200604     C                     Z-ADDSFFL11    ZCG,11
240600200604     C                     Z-ADDSFFL12    ZCG,12
240700200604     C                     Z-ADDSFFL13    ZCG,13
240800200604     C                     Z-ADDSFFL14    ZCG,14
240900200604     C                     Z-ADDSFFL15    ZCG,15
241000200604     C*
241100200604     C** ONLY PERFORM ROUTINE SR/ZPMCRG FOR LONG POSITIONS
241200200604     C           ZAMT      IFGT 0
241300200604     C                     EXSR ZPMCRG
241400200604     C                     ELSE
241500200604     C                     Z-ADD0         ZCHGA
241600200604     C                     END
241700200604     C                     Z-ADDZCHGA     WWAAFS
241800200604     C*
241900200604     C                     END
242000200604     C                     END
242100200604     C*
242200200604     C           #P060     ENDSR
242300200604     C********************************************************************
242400200604     C/EJECT
242500200604     C********************************************************************
242600200604     C*
242700200604     C           #P07      BEGSR
242800200604     C*
242900200604     C** INITIALISE WORK FIELD FOR 'AMOUNT ACCRUED FOR ACCOUNT'
243000200604     C                     Z-ADD*ZEROS    WWAAFA 150
243100200604     C*
243200200604     C** SET WORK FIELD FOR 'CHARGE CODE ' TO BLANK
243300200604     C                     MOVE *BLANKS   WWCGCO
243400200604     C*
243500200604     C** DETERMINE CHARGE TO BE LEVIED
243600200604     C                     EXSR #P09
243700200604     C*
243800200604     C** IF CHARGE CODE BLANK TERMINATE ROUTINE
243900200604     C           WWCGCO    IFEQ *BLANKS                    B1
244000200604     C                     GOTO #P070
244100200604     C                     END                             E1
244200200604     C*
244300200604     C***ACCESS*PF/SCCHRGPD*WITH*CHARGE*CODE*RETURNED*FROM*#P09           S01464
244400200604     C***********WWCGCO    CHAINSCCGCDPD             49                   S01464
244500200604     C*                                                                   S01464
244600200604     C** Access PF/SECGCDPD with charge code returned from #P09           S01464
244700200604     C           WWCGCO    CHAINSECGCDPD             49                   S01464
244800200604     C*
244900200604     C** IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
245000200604     C           *IN49     IFEQ '1'                        B1
245100200604     C           SFCHTP    OREQ 'D'
245200200604     C           *LOCK     IN   LDA                                       S01464
245300200604     C***********          Z-ADD6         DBASE                           091522
245400200604     C                     Z-ADD12        DBASE                           091522
245500200604     C                     MOVE *BLANKS   DBFILE           *****************
245600200604     C***********          MOVEL'SCCGCDPD'DBFILE         ** DBERROR  006**S01464
245700200604     C***********          MOVEL'SCCGCDPD'DBFILE           * DBERRORS01464091522
245800200604     C                     MOVEL'SCCGCDPD'DBFILE           * DBERROR 012 *091522
245900200604     C                     MOVE *BLANKS   DBKEY            *****************
246000200604     C                     MOVELWWCGCO    DBKEY
246100200604     C                     OUT  LDA                                       S01464
246200200604     C                     EXSR #ZA
246300200604     C*
246400200604     C                     ELSE                            X1
246500200604     C*
246600200604     C***ACCESS*LF/SDCURRJ0*WITH*ACCOUNT*CCY*FROM*PF/SCPMABPD**********   S01464
246700200604     C***********SGCCY     CHAINSDCURRJ0             56                   S01464
246800200604     C*                                                                   S01464
246900200604     C** Access LF/SDCURRL0 with Account Ccy from PF/SEPMABPD             S01464
247000200604     C           SGCCY     CHAINSDCURRL0             56                   S01464
247100200604     C*
247200200604     C** IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
247300200604     C           *IN56     IFEQ '1'                        B2
247400200604     C           *LOCK     IN   LDA                                       S01464
247500200604     C                     Z-ADD9         DBASE
247600200604     C                     MOVE *BLANKS   DBFILE           *****************
247700200604     C***********          MOVEL'SDCURRJ0'DBFILE         ** DBERROR  009**S01464
247800200604     C                     MOVEL'SDCURRL0'DBFILE           **DBERROR 009**S01464
247900200604     C                     MOVE *BLANKS   DBKEY            *****************
248000200604     C                     MOVELSGCCY     DBKEY
248100200604     C                     OUT  LDA                                       S01464
248200200604     C                     EXSR #ZA
248300200604     C*
248400200604     C                     ELSE                            X2
248500200604     C*
248600200604     C** SET 'MARKET VALUE OF SECURITY IN NOMINAL CCY' TO 'ACCOUNT
248700200604     C**  BALANCE' ON PF/SCPMABPD
248800200604     C/COPY WNCPYSRC,SE6240C013
248900200604     C                     Z-SUBSGCLBL    WWMVNC
249000200604     C/COPY WNCPYSRC,SE6240C014
249100200604     C*
249200200604     C** CONVERT FROM NOMINAL CCY TO BANK CHARGING CCY. USING SR/ZCCYCN
249300200604     C                     Z-ADDWWMVNC    ZAMTF
249400200604     C                     MOVE SGCCY     ZCCYF
249500200604     C                     Z-ADDA6SPRT    ZRATEF
249600200604     C                     MOVE A6MDIN    ZMDINF
249700200604     C                     Z-ADDA6NBDP    ZCDPF
249800200604     C                     EXSR ZCCYCN
249900200604     C                     Z-ADDZAMTT     WWMVBC 150
250000200604     C*
250100200604     C** CALCULATE FEE TO BE CHARGED FOR ACCOUNT USING SR/ZPMCRG
250200200604     C           SFCGBS    IFEQ 'N'                        B3
250300200604     C           A6NBDP    IFGT *ZEROS                     B4
250400200604     C*          A6NBDP    ADD  4         X       10                      B05945
250500200604     C           A6NBDP    ADD  4         X       20                      B05945
250600200604     C           WWMVNC    DIV  POWER,X   WWMVNC
250700200604     C                     END                             E4
250800200604     C*
250900200604     C** INVERSE NOMINAL AMOUNT PASSED TO SR/ZPMCRG SO THAT NOMINAL
251000200604     C** AMOUNT CAN BE COMPARED WITH AMOUNTS FROM CHARGES FILE
251100200604     C                     Z-ADDWWMVNC    ZAMT
251200200604     C                     END                             E3
251300200604     C*
251400200604     C           SFCGBS    IFEQ 'F'                        B3
251500200604     C           SFCGBS    OREQ 'P'
251600200604     C                     Z-ADDWWMVBC    ZAMT
251700200604     C                     END                             E3
251800200604     C                     Z-ADD3         ZDYBS
251900200604     C                     Z-ADD3         ZDVBS
252000200604     C                     Z-ADD*ZEROS    ZSPRD
252100200604     C                     MOVE *BLANKS   ZSPRI
252200200604     C           SFCGBS    IFEQ 'N'                        B3
252300200604     C                     MOVE 'F'       ZCGBS
252400200604     C                     ELSE                            X3
252500200604     C           SFCGBS    IFEQ 'F'                        B4
252600200604     C           SFCGBS    OREQ 'P'
252700200604     C                     MOVE SFCGBS    ZCGBS
252800200604     C                     END                             E4
252900200604     C                     END                             E3
253000200604     C                     MOVE SFCGMT    ZCGMT
253100200604     C                     Z-ADDSFMINC    ZMINC
253200200604     C                     Z-ADDSFCRU1    ZRA,1
253300200604     C                     Z-ADDSFCRU2    ZRA,2
253400200604     C                     Z-ADDSFCRU3    ZRA,3
253500200604     C                     Z-ADDSFCRU4    ZRA,4
253600200604     C                     Z-ADDSFCRU5    ZRA,5
253700200604     C                     Z-ADDSFCRU6    ZRA,6
253800200604     C                     Z-ADDSFCRU7    ZRA,7
253900200604     C                     Z-ADDSFCRU8    ZRA,8
254000200604     C                     Z-ADDSFCRU9    ZRA,9
254100200604     C                     Z-ADDSFCR10    ZRA,10
254200200604     C                     Z-ADDSFCR11    ZRA,11
254300200604     C                     Z-ADDSFCR12    ZRA,12
254400200604     C                     Z-ADDSFCR13    ZRA,13
254500200604     C                     Z-ADDSFCR14    ZRA,14
254600200604     C                     Z-ADDSFPCL1    ZPC,1
254700200604     C                     Z-ADDSFPCL2    ZPC,2
254800200604     C                     Z-ADDSFPCL3    ZPC,3
254900200604     C                     Z-ADDSFPCL4    ZPC,4
255000200604     C                     Z-ADDSFPCL5    ZPC,5
255100200604     C                     Z-ADDSFPCL6    ZPC,6
255200200604     C                     Z-ADDSFPCL7    ZPC,7
255300200604     C                     Z-ADDSFPCL8    ZPC,8
255400200604     C                     Z-ADDSFPCL9    ZPC,9
255500200604     C                     Z-ADDSFPC10    ZPC,10
255600200604     C                     Z-ADDSFPC11    ZPC,11
255700200604     C                     Z-ADDSFPC12    ZPC,12
255800200604     C                     Z-ADDSFPC13    ZPC,13
255900200604     C                     Z-ADDSFPC14    ZPC,14
256000200604     C                     Z-ADDSFPC15    ZPC,15
256100200604     C                     Z-ADDSFFLC1    ZCG,1
256200200604     C                     Z-ADDSFFLC2    ZCG,2
256300200604     C                     Z-ADDSFFLC3    ZCG,3
256400200604     C                     Z-ADDSFFLC4    ZCG,4
256500200604     C                     Z-ADDSFFLC5    ZCG,5
256600200604     C                     Z-ADDSFFLC6    ZCG,6
256700200604     C                     Z-ADDSFFLC7    ZCG,7
256800200604     C                     Z-ADDSFFLC8    ZCG,8
256900200604     C                     Z-ADDSFFLC9    ZCG,9
257000200604     C                     Z-ADDSFFL10    ZCG,10
257100200604     C                     Z-ADDSFFL11    ZCG,11
257200200604     C                     Z-ADDSFFL12    ZCG,12
257300200604     C                     Z-ADDSFFL13    ZCG,13
257400200604     C                     Z-ADDSFFL14    ZCG,14
257500200604     C                     Z-ADDSFFL15    ZCG,15
257600200604     C*
257700200604     C** ONLY PERFORM ROUTINE SR/ZPMCRG FOR CR ACCOUNT BALANCES
257800200604     C           ZAMT      IFGT 0
257900200604     C                     EXSR ZPMCRG
258000200604     C                     ELSE
258100200604     C                     Z-ADD0         ZCHGA
258200200604     C                     END
258300200604     C                     Z-ADDZCHGA     WWAAFA
258400200604     C*
258500200604     C                     END                             E2
258600200604     C                     END                             E1
258700200604     C*
258800200604     C           #P070     ENDSR
258900200604     C********************************************************************
259000200604     C/EJECT
259100200604     C********************************************************************
259200200604     C*
259300200604     C           #P08      BEGSR
259400200604     C*
259500200604     C***SET*FIRST*KEY*AND*ACCESS*PF/SCCICFPD**************************   S01464
259600200604     C** Set first key and access PF/SCCICFPD                             S01464
259700200604     C                     MOVE *BLANKS   WWFGCK
259800200604     C**********           Z-ADDWWCNUM    WWCNOK                                              CSD027
259900200604     C                     MOVE WWCNUM    WWCNOK                                              CSD027
260000200604     C                     Z-ADD1         WWCSQK
260100200604     C                     MOVE WWCSSC    WWSSNK
260200200604     C                     MOVE *BLANKS   WWCCYK
260300200604     C                     MOVE *BLANKS   WWIVTK
260400200604     C*
260500200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
260600200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
260700200604     C*
260800200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
260900200604     C**  TERMINATE ROUTINE
261000200604     C           *IN51     IFEQ '0'
261100200604     C           SCRECI    ANDEQ'D'
261200200604     C                     MOVE SCCGCO    WWCGCO
261300200604     C                     GOTO #P080
261400200604     C                     END
261500200604     C*
261600200604     C***SET*SECOND*KEY*AND*ACCESS*PF/SCCICFPD*************************   S01464
261700200604     C** Set second key and access PF/SECICFPD                            S01464
261800200604     C                     MOVE *BLANKS   WWFGCK
261900200604     C**********           Z-ADDWWCNUM    WWCNOK                                              CSD027
262000200604     C                     MOVE WWCNUM    WWCNOK                                              CSD027
262100200604     C                     Z-ADD2         WWCSQK
262200200604     C                     MOVE *BLANKS   WWSSNK
262300200604     C                     MOVE NMCY      WWCCYK
262400200604     C                     MOVE SITP      WWIVTK
262500200604     C*
262600200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
262700200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
262800200604     C*
262900200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
263000200604     C**  TERMINATE ROUTINE
263100200604     C           *IN51     IFEQ '0'
263200200604     C           SCRECI    ANDEQ'D'
263300200604     C                     MOVE SCCGCO    WWCGCO
263400200604     C                     GOTO #P080
263500200604     C                     END
263600200604     C*
263700200604     C***SET*THIRD*KEY*AND*ACCESS*PF/SCCICFPD**************************   S01464
263800200604     C** Set third key and access PF/SECICFPD                             S01464
263900200604     C                     MOVE *BLANKS   WWFGCK
264000200604     C**********           Z-ADDWWCNUM    WWCNOK                                              CSD027
264100200604     C                     MOVE WWCNUM    WWCNOK                                              CSD027
264200200604     C                     Z-ADD3         WWCSQK
264300200604     C                     MOVE *BLANKS   WWSSNK
264400200604     C                     MOVE *BLANKS   WWCCYK
264500200604     C                     MOVE SITP      WWIVTK
264600200604     C*
264700200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
264800200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
264900200604     C*
265000200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
265100200604     C**  TERMINATE ROUTINE
265200200604     C           *IN51     IFEQ '0'
265300200604     C           SCRECI    ANDEQ'D'
265400200604     C                     MOVE SCCGCO    WWCGCO
265500200604     C                     GOTO #P080
265600200604     C                     END
265700200604     C*
265800200604     C***SET*FOURTH*KEY*AND*ACCESS*PF/SCCICFPD*************************   S01464
265900200604     C** Set fourth key and access PF/SECICFPD                            S01464
266000200604     C                     MOVE WWCFGC    WWFGCK
266100200604     C**********           Z-ADD*ZEROS    WWCNOK                                              CSD027
266200200604     C                     MOVE *BLANKS   WWCNOK                                              CSD027
266300200604     C                     Z-ADD1         WWCSQK
266400200604     C                     MOVE WWCSSC    WWSSNK
266500200604     C                     MOVE *BLANKS   WWCCYK
266600200604     C                     MOVE *BLANKS   WWIVTK
266700200604     C*
266800200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
266900200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
267000200604     C*
267100200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
267200200604     C**  TERMINATE ROUTINE
267300200604     C           *IN51     IFEQ '0'
267400200604     C           SCRECI    ANDEQ'D'
267500200604     C                     MOVE SCCGCO    WWCGCO
267600200604     C                     GOTO #P080
267700200604     C                     END
267800200604     C*
267900200604     C***SET*FIFTH*KEY*AND*ACCESS*PF/SCCICFPD**************************   S01464
268000200604     C** Set fifth key and access PF/SECICFPD                             S01464
268100200604     C                     MOVE WWCFGC    WWFGCK
268200200604     C**********           Z-ADD*ZEROS    WWCNOK                                              CSD027
268300200604     C                     MOVE *BLANKS   WWCNOK                                              CSD027
268400200604     C                     Z-ADD2         WWCSQK
268500200604     C                     MOVE *BLANKS   WWSSNK
268600200604     C                     MOVE NMCY      WWCCYK
268700200604     C                     MOVE SITP      WWIVTK
268800200604     C*
268900200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
269000200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
269100200604     C*
269200200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
269300200604     C**  TERMINATE ROUTINE
269400200604     C           *IN51     IFEQ '0'
269500200604     C           SCRECI    ANDEQ'D'
269600200604     C                     MOVE SCCGCO    WWCGCO
269700200604     C                     GOTO #P080
269800200604     C                     END
269900200604     C*
270000200604     C***SET*SIXTH*KEY*AND*ACCESS*PF/SCCICFPD**************************   S01464
270100200604     C** Set sixth key and access PF/SECICFPD                             S01464
270200200604     C                     MOVE WWCFGC    WWFGCK
270300200604     C**********           Z-ADD*ZEROS    WWCNOK                                              CSD027
270400200604     C                     MOVE *BLANKS   WWCNOK                                              CSD027
270500200604     C                     Z-ADD3         WWCSQK
270600200604     C                     MOVE *BLANKS   WWSSNK
270700200604     C                     MOVE *BLANKS   WWCCYK
270800200604     C                     MOVE SITP      WWIVTK
270900200604     C*
271000200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
271100200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
271200200604     C*
271300200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
271400200604     C**  TERMINATE ROUTINE
271500200604     C           *IN51     IFEQ '0'
271600200604     C           SCRECI    ANDEQ'D'
271700200604     C                     MOVE SCCGCO    WWCGCO
271800200604     C                     GOTO #P080
271900200604     C                     END
272000200604     C*
272100200604     C           #P080     ENDSR
272200200604     C********************************************************************
272300200604     C/EJECT
272400200604     C********************************************************************
272500200604     C*
272600200604     C           #P09      BEGSR
272700200604     C*
272800200604     C***SET*FIRST*KEY*AND*ACCESS*PF/SCCICFPD**************************   S01464
272900200604     C** Set first key and access PF/SECICFPD                             S01464
273000200604     C                     MOVE *BLANKS   WWFGCK
273100200604     C**********           Z-ADDWWCNUM    WWCNOK                                              CSD027
273200200604     C                     MOVE WWCNUM    WWCNOK                                              CSD027
273300200604     C                     Z-ADD4         WWCSQK
273400200604     C                     MOVE *BLANKS   WWSSNK
273500200604     C                     MOVE SGCCY     WWCCYK
273600200604     C                     MOVE *BLANKS   WWIVTK
273700200604     C*
273800200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
273900200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
274000200604     C*
274100200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
274200200604     C**  TERMINATE ROUTINE
274300200604     C           *IN51     IFEQ '0'
274400200604     C           SCRECI    ANDEQ'D'
274500200604     C                     MOVE SCCGCO    WWCGCO
274600200604     C                     GOTO #P090
274700200604     C                     ELSE                                           S01464
274800200604     C                     MOVE 'ALL'     WWCCYK                          S01464
274900200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
275000200604     C*                                                                   S01464
275100200604     C** If live record found move 'CHARGE CODE' to a work field and      S01464
275200200604     C**  terminate routine.                                              S01464
275300200604     C           *IN51     IFEQ '0'                                       S01464
275400200604     C           SCRECI    ANDEQ'D'                                       S01464
275500200604     C                     MOVE SCCGCO    WWCGCO                          S01464
275600200604     C                     GOTO #P090                                     S01464
275700200604     C                     END                                            S01464
275800200604     C                     END
275900200604     C*
276000200604     C***SET*SECOND*KEY*AND*ACCESS*PF/SCCICFPD*************************   S01464
276100200604     C** Set second key and access PF/SECICFPD                            S01464
276200200604     C                     MOVE WWCFGC    WWFGCK
276300200604     C**********           Z-ADD*ZEROS    WWCNOK                                              CSD027
276400200604     C                     MOVE *BLANKS   WWCNOK                                              CSD027
276500200604     C                     Z-ADD4         WWCSQK
276600200604     C                     MOVE *BLANKS   WWSSNK
276700200604     C                     MOVE SGCCY     WWCCYK
276800200604     C                     MOVE *BLANKS   WWIVTK
276900200604     C*
277000200604     C***********WWKEY2    CHAINSCCICFPD             51                   S01464
277100200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
277200200604     C*
277300200604     C** IF LIVE RECORD FOUND MOVE 'CHARGE CODE' TO A WORK FIELD AND
277400200604     C**  TERMINATE ROUTINE
277500200604     C           *IN51     IFEQ '0'
277600200604     C           SCRECI    ANDEQ'D'
277700200604     C                     MOVE SCCGCO    WWCGCO
277800200604     C                     GOTO #P090
277900200604     C                     ELSE                                           S01464
278000200604     C                     MOVE 'ALL'     WWCCYK                          S01464
278100200604     C           WWKEY2    CHAINSECICFPD             51                   S01464
278200200604     C*                                                                   S01464
278300200604     C** If live record found move 'CHARGE CODE' to a work field and      S01464
278400200604     C**  terminate routine.                                              S01464
278500200604     C           *IN51     IFEQ '0'                                       S01464
278600200604     C           SCRECI    ANDEQ'D'                                       S01464
278700200604     C                     MOVE SCCGCO    WWCGCO                          S01464
278800200604     C                     GOTO #P090                                     S01464
278900200604     C                     END                                            S01464
279000200604     C                     END
279100200604     C*
279200200604     C           #P090     ENDSR
279300200604      ********************************************************************R5553
279400200604      /EJECT                                                              R5553
279500200604      ********************************************************************R5553
279600200604      *                                                                   R5553
279700200604      **   #ACOD - Subroutine to access account code details              R5553
279800200604      *                                                                   R5553
279900200604      **   Called by                                                      R5553
280000200604      *                                                                   R5553
280100200604      **   Calls - *PSSR                                                  R5553
280200200604      *                                                                   R5553
280300200604      *===================================================================R5553
280400200604     C           #ACOD     BEGSR                           * #ACOD BEGS **R5553
280500200604      *                                                                   R5553
280600200604     C**********           MOVE ACOD      KKACOD  4                                     R5553 CGL029
280700200604     C                     MOVE ACOD      KKACOD 10                                           CGL029
280800200604     C           KKACOD    CHAINSDACODL0             81                   R5553
280900200604     C           *IN81     IFEQ '0'                                       R5553
281000200604     C                     MOVE A5ACTY    ATYP                            R5553
281100200604     C                     ELSE                                           R5553
281200200604      **   DB error:                                                      R5553
281300200604     C           *LOCK     IN   LDA                                       S01464
281400200604     C***********          MOVEL'09'      DBASE            *********R5553 091522
281500200604     C***********          MOVEL'SDACODL0'DBFILE           *  DB ERROR5553091522
281600200604     C                     MOVEL'13'      DBASE            ***************091522
281700200604     C                     MOVEL'SDACODL0'DBFILE           *  DB ERROR 13 091522
281800200604     C                     MOVEL'KKACOD'  DBKEY            ***************R5553
281900200604     C                     OUT  LDA                                       S01464
282000200604     C                     EXSR *PSSR                                     R5553
282100200604     C                     END                                            R5553
282200200604      *                                                                   R5553
282300200604     C                     ENDSR                           * #ACOD ENDS **R5553
282400200604     C********************************************************************
282500200604     C/EJECT
282600200604     C********************************************************************
282700200604     C*
282800200604     C           #P10      BEGSR
282900200604     C*
283000200604     C** IF CHANGE OF BRANCH CODE
283100200604     C           BBBRCD    IFNE WWBRCD
283200200604     C*
283300200604     C** MOVE NEW BRANCH CODE INTO WORK FIELD
283400200604     C                     MOVE BBBRCD    WWBRCD
283500200604     C*
283600200604     C** ACCESS LF/SDBRCHL1 WITH BRANCH CODE
283700200604     C           BBBRCD    CHAINSDBRCHL1             52
283800200604     C*
283900200604     C** IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
284000200604     C           *IN52     IFEQ '1'
284100200604     C           A8TYLC    OREQ 'D'
284200200604     C           *LOCK     IN   LDA                                       S01464
284300200604     C                     Z-ADD8         DBASE
284400200604     C                     MOVE *BLANKS   DBFILE           *****************
284500200604     C                     MOVEL'SDBRCHL1'DBFILE           ** DBERROR  008**
284600200604     C                     MOVE *BLANKS   DBKEY            *****************
284700200604     C                     MOVELBBBRCD    DBKEY
284800200604     C                     OUT  LDA                                       S01464
284900200604     C                     EXSR #ZA
285000200604     C*
285100200604     C                     END
285200200604     C                     END
285300200604     C*
285400200604     C** SET UP FIELDS FOR UPDATE OF PF/GESCPD
285500200604     C*
285600200604     C** RECORD ID
285700200604     C                     MOVE 'P'       RECI
285800200604     C*
285900200604     C** CUSTOMER NUMBER
286000200604     C                     MOVE A8BICN    CNUM
286100200604     C*
286200200604     C** CURRENCY
286300200604     C                     MOVE WWBCGC    CCY
286400200604     C*
286500200604     C** ACCOUNT CODE
286600200604     C***********          Z-ADDSAAACT    ACOD                            S01464
286700200604     C                     Z-ADDFBAACT    ACOD                            S01464
286800200604     C*
286900200604     C** ACCOUNT SEQUENCE
287000200604     C                     Z-ADD1         ACSQ
287100200604     C*
287200200604     C** RETAIL ACCOUNT NUMBER
287300200604     C                     Z-ADD*ZEROS    ACNO
287400200604     C*
287500200604     C** POSTING DATE
287600200604     C                     Z-ADDBJRDNB    PSTD
287700200604     C*
287800200604     C** VALUE DATE
287900200604     C***********          Z-ADDSACCRD    VALD                            S01464
288000200604     C                     Z-ADDFBCCRD    VALD                            S01464
288100200604     C*
288200200604     C** TRANSACTION TYPE
288300200604     C                     Z-ADD*ZEROS    TRAT
288400200604     C*
288500200604     C** POSTING NARRATIVE
288600200604     C                     MOVEAPNARR     WWTEXT
288700200604     C                     MOVE *BLANKS   WWSPAC
288800200604     C                     MOVE WWCUST    WWCUSN
288900200604     C***********SACFCP    IFEQ 'C'                                       S01464
289000200604     C           FBCFCP    IFEQ 'C'                                       S01464
289100200604     C                     MOVE *BLANKS   WWLBRK
289200200604     C                     MOVE *BLANKS   WWPORT
289300200604     C                     MOVE *BLANKS   WWRBRK
289400200604     C***********          ELSE                                           S01464
289500200604     C***********SACFCP    IFEQ 'P'                                       S01464
289600200604     C***********          MOVE ' ('      WWLBRK                          S01464
289700200604     C***********          MOVE ') '      WWRBRK                          S01464
289800200604     C***********WWPTFR    IFEQ '9997'                                    S01464
289900200604     C***********          MOVE P9R997    WWPORT                          S01464
290000200604     C***********          ELSE                                           S01464
290100200604     C***********WWPTFR    IFEQ '9999'                                    S01464
290200200604     C***********          MOVE P9R999    WWPORT                          S01464
290300200604     C***********          ELSE                                           S01464
290400200604     C***********          MOVE WWPTFR    WWPORT                          S01464
290500200604     C***********          END                                            S01464
290600200604     C***********          END                                            S01464
290700200604     C***********          END                                            S01464
290800200604     C                     ELSE                                           091522
290900200604     C           FBCFCP    IFEQ 'P'                                       091522
291000200604     C                     MOVE ' ('      WWLBRK                          091522
291100200604     C                     MOVE ') '      WWRBRK                          091522
291200200604     C           WWPTFR    IFEQ '9997'                                    091522
291300200604     C                     MOVE FCR997    WWPORT                          091522
291400200604     C                     ELSE                                           091522
291500200604     C           WWPTFR    IFEQ '9999'                                    091522
291600200604     C                     MOVE FCR999    WWPORT                          091522
291700200604     C                     ELSE                                           091522
291800200604     C                     MOVE WWPTFR    WWPORT                          091522
291900200604     C                     END                                            091522
292000200604     C                     END                                            091522
292100200604     C                     END                                            091522
292200200604     C                     END
292300200604     C*
292400200604     C                     MOVE WWPNAR    PNAR
292500200604     C*
292600200604     C** POSTING AMOUNT
292700200604     C                     Z-ADDWWFACT    PSTA
292800200604     C*
292900200604     C** DEBIT/CREDIT INDICATOR
293000200604     C           PSTA      IFGT *ZEROS
293100200604     C                     Z-ADD*ZEROS    DRCR
293200200604     C                     ELSE
293300200604     C           PSTA      IFLT *ZEROS
293400200604     C                     Z-ADD1         DRCR
293500200604     C                     Z-SUBPSTA      PSTA
293600200604     C                     END
293700200604     C                     END
293800200604     C*
293900200604     C** ASSOCIATED CUSTOMER
294000200604     C                     MOVE WWCUST    ASOC
294100200604     C*
294200200604     C** CHEQUE NUMBER
294300200604     C                     Z-ADD*ZEROS    CHQN
294400200604     C*
294500200604     C** SOURCE OF POSTING
294600200604     C                     MOVE 'GE-SC'   SPOS
294700200604     C*
294800200604     C** BRANCH CODE
294900200604     C***********          MOVE BBBRCD    BRCD                            S01464
295000200604     C                     MOVE BBBRCD    BRCA                            S01464
295100200604     C*
295200200604     C** RETAIL INDICATOR
295300200604     C                     Z-ADD*ZEROS    RIND
295400200604     C*
295500200604     C** REJECT CODE
295600200604     C                     Z-ADD*ZEROS    REJC
295700200604     C*
295800200604     C** DEPARTMENT CODE
295900200604     C                     MOVE *BLANKS   DPMT
296000200604     C*
296100200604     C** RELATIVE RECORD NUMBER
296200200604     C                     Z-ADD*ZEROS    RRNM
296300200604     C*
296400200604     C** ACCOUNT TYPE
296500200604     C*********************MOVE 'G'       ATYP                            R5553
296600200604     C                     EXSR #ACOD                                     R5553
296700200604     C*
296800200604     C** EXTRACT INDICATOR
296900200604     C                     MOVE *BLANKS   EXIN
297000200604     C*
297100200604     C** POSTING RECORD INDICATOR
297200200604     C**                   BITOFBITNC     PRIN                            R5516
297300200604     C                     BITOF'01234567'PRIN                            R5516
297400200604     C*
297500200604     C** GENERATED ENTRY TYPE
297600200604     C***********          MOVE *BLANKS   GETP                            S01464
297700200604     C                     MOVE 'B'       GETP                            S01464
297800200604     C*
297900200604     C** ACCUMULATOR
298000200604     C                     Z-ADD*ZEROS    ACUM
298100200604     C*
298200200604     C** PROFIT CENTRE
298300200604     C*                                                                   CAC003
298400200604     C** If Analytical Accounting and SAR CAC003 are installed,           CAC003
298500200604     C** move the Safe Custody Fee Profit Centre.                         CAC003
298600200604     C*                                                                   CAC003
298700200604     C           *IN20     IFEQ '1'                                       CAC003
298800200604     C                     MOVE FBPCSF    PRFC                            CAC003
298900200604     C                     ELSE                                           CAC003
299000200604     C*                                                                   CAC003
299100200604     C                     MOVE *BLANKS   PRFC
299200200604     C*                                                                   CAC003
299300200604     C                     ENDIF                                          CAC003
299400200604     C*
299500200604     C***REBATABLE*INDICATOR*******************************************   S01464
299600200604     C***********          MOVE *BLANKS   REBI                            S01464
299700200604     C*
299800200604     C***CHARGE*AMOUNT*************************************************   S01464
299900200604     C***********          Z-ADD*ZEROS    CHGA                            S01464
300000200604     C*
300100200604     C** SWIFT COMMON REFERENCE
300200200604     C                     MOVE *BLANKS   SWCR
300300200604     C*
300400200604     C** DEAL/LOAN REFERENCE
300500200604     C                     MOVE *BLANKS   DLREF
300600200604     C*
300700200604     C** FOR ACCOUNT OF
300800200604     C                     MOVE *BLANKS   FACO
300900200604     C*
301000200604     C** DEALT/BORROWER CUSTOMER
301100200604     C**********           Z-ADD*ZEROS    DBCNUM                                              CSD027
301200200604     C                     MOVE *BLANKS   DBCNUM                                              CSD027
301300200604     C*
301400200604     C** PAYMENT REFERENCE
301500200604     C                     MOVE *BLANKS   PREF
301600200604     C*
301700200604     C***NUMBER*OF*ITEMS***********************************************   S01464
301800200604     C***********          Z-ADD*ZEROS    NITMS                           S01464
301900200604     C*
302000200604     C** ORIGINAL TRANSACTION REFERENCE
302100200604     C                     MOVE WWPNAR    OTRF
302200200604     C*
302300200604     C** ORIGINAL TRANSACTION SUB-TYPE
302400200604     C                     MOVE *BLANKS   OTST
302500200604     C*
302600200604     C** ORIGINAL TRANSACTION TYPE
302700200604     C                     MOVE *BLANKS   OTTP
302800200604     C*
302900200604     C** START OF DAY CLEARED BALANCE
303000200604     C                     Z-ADD*ZEROS    SDCB
303100200604     C*
303200200604     C** START OF DAY LEDGER BALANCE
303300200604     C                     Z-ADD*ZEROS    SDLB
303400200604     C*
303500200604     C** BOOK CODE
303600200604     C                     MOVE *BLANKS   BOKC
303700200604      *                                                                   179044
303800200604      ** Message ID                                                       179044
303900200604      *                                                                   179044
304000200604     C                     MOVE 'GBC7000' ##MGID                          179044
304100200604     C*
304200200604     C** WRITE A RECORD TO PF/GESCPD
304300200604     C           PSTA      IFNE 0                                         48360
304400200604      *                                                                   179044
304500200604      ** Determine the posting narrative:                                 179044
304600200604      *                                                                   179044
304700200604     C                     EXSR SRPNAR                                    179044
304800200604      *                                                                   179044
304900200604     C                     WRITEAPOSTPDF
305000200604     C*
305100200604     C** TOTAL POSTING AMOUNT
305200200604     C                     ADD  PSTA      WWTOTP
305300200604     C*
305400200604     C** INCREMENT NUMBER OF RECORDS WRITTEN TO PF/GESCPD
305500200604     C                     ADD  1         WWNUMR
305600200604     C                     END                                            48360
305700200604     C*
305800200604     C** SET ACCOUNT CODE
305900200604     C***********          Z-ADDSAINCA    ACOD                            S01464
306000200604     C                     Z-ADDFBINCA    ACOD                            S01464
306100200604     C*
306200200604     C** REVERSE DB/CR
306300200604     C           DRCR      IFEQ *ZEROS
306400200604     C                     Z-ADD1         DRCR
306500200604     C                     ELSE
306600200604     C           DRCR      IFEQ 1
306700200604     C                     Z-ADD*ZEROS    DRCR
306800200604     C                     END
306900200604     C                     END
307000200604     C*
307100200604     C** RESET ACCOUNT TYPE
307200200604     C*********************MOVE 'G'       ATYP                            R5553
307300200604     C                     EXSR #ACOD                                     R5553
307400200604     C*
307500200604     C** RESET RETAIL ACCOUNT NUMBER TRANSACTION TYPE AND RETAIL IND.
307600200604     C                     Z-ADD*ZEROS    ACNO
307700200604     C                     Z-ADD*ZEROS    TRAT
307800200604     C                     Z-ADD*ZEROS    RIND
307900200604     C*
308000200604     C** WRITE ANOTHER RECORD TO PF/GESCPD
308100200604     C           PSTA      IFNE 0                                         48360
308200200604      *                                                                   179044
308300200604      ** Determine the posting narrative:                                 179044
308400200604      *                                                                   179044
308500200604     C                     EXSR SRPNAR                                    179044
308600200604      *                                                                   179044
308700200604     C                     WRITEAPOSTPDF
308800200604     C*
308900200604     C** TOTAL POSTING AMOUNT
309000200604     C                     ADD  PSTA      WWTOTP
309100200604     C*
309200200604     C** INCREMENT NUMBER OF RECORDS WRITTEN TO PF/GESCPD
309300200604     C                     ADD  1         WWNUMR
309400200604     C                     END                                            48360
309500200604     C*
309600200604     C                     ENDSR
309700200604     C********************************************************************
309800200604     C/EJECT
309900200604     C********************************************************************
310000200604     C*
310100200604     C***********#P11      BEGSR                                          S01464
310200200604     C*****************************************************************   S01464
310300200604     C***CHECK*VALUE*OF*'CUSTODY*FEE*GROUP*CODE'*ON*LF/PMPORTLL********   S01464
310400200604     C***********PNCFGC    IFNE *BLANKS                                   S01464
310500200604     C***********WWPTFR    ANDNE'9997'                                    S01464
310600200604     C***********          MOVE PNCFGC    WWCFGC                          S01464
310700200604     C***********          ELSE                                           S01464
310800200604     C***********          MOVE BFCFGC    WWCFGC                          S01464
310900200604     C***********          END                                            S01464
311000200604     C*****************************************************************   S01464
311100200604     C***IF*HEADINGS*HAVE*NOT*JUST*BEEN*WRITTEN************************   S01464
311200200604     C************IN30     IFEQ '0'                                       S01464
311300200604     C*****************************************************************   S01464
311400200604     C***MOVE*VALUES*FOR*CUSTOMER*HEADING*INTO*REPORT*FIELDS***********   S01464
311500200604     C***********          MOVE BBCUST    RRCNM1                          S01464
311600200604     C***********          MOVE BBCRNM    RRSNM1                          S01464
311700200604     C*****************************************************************   S01464
311800200604     C***********          ELSE                                           S01464
311900200604     C*****************************************************************   S01464
312000200604     C***RESET*HEADINGS*ALREADY*WRITTEN*INDICATOR**********************   S01464
312100200604     C***********          MOVE '0'       *IN30                           S01464
312200200604     C***********          END                                            S01464
312300200604     C*****************************************************************   S01464
312400200604     C***DECIDE*PORTFOLIO*REFERENCE*TO*BE*USED*IN*CUSTOMER*HEADING*****   S01464
312500200604     C***********WWPTFR    IFEQ '9997'                                    S01464
312600200604     C***********          MOVE P9R997    RRPNM1                          S01464
312700200604     C***********          MOVE P9N997    RRPSN1                          S01464
312800200604     C***********          ELSE                                           S01464
312900200604     C***********          MOVE PNPTFR    RRPNM1                          S01464
313000200604     C***********          MOVE PNPTFN    RRPSN1                          S01464
313100200604     C***********          END                                            S01464
313200200604     C*****************************************************************   S01464
313300200604     C***WRITE*PORTFOLIO*CUSTOMER*HEADING******************************   S01464
313400200604     C***********          MOVE WWCFGC    RRAFG1                          S01464
313500200604     C***                  WRITEDETAIL1                                   R0131
313600200604     C*****************************************************************   S01464
313700200604     C***IF*HEADER*3*NECESSARY*OR*ACCOUNT*OFFICER*CHANGED**************   S01464
313800200604     C************IN31     IFEQ '1'                                       S01464
313900200604     C***********AZACOC    ORNE WWACOC                                    S01464
314000200604     C*****************************************************************   S01464
314100200604     C***OUTPUT*BANK*CHARGING*CURRENCY*TO*REPORT***********************   S01464
314200200604     C***********          MOVE WWBCGC    RRBCCY                          S01464
314300200604     C***********          MOVE WWBCGC    RRCCCY                          S01464
314400200604     C***********          WRITEHEADER3                                   S01464
314500200604     C*****************************************************************   S01464
314600200604     C***RESET*HEADER*3*NECESSARY*INDICATOR****************************   S01464
314700200604     C***********          MOVE '0'       *IN31                           S01464
314800200604     C*****************************************************************   S01464
314900200604     C***MOVE*NEW*ACCOUNT*OFFICER*CODE*INTO*WORK*FIELD*****************   S01464
315000200604     C***********          MOVE AZACOC    WWACOC                          S01464
315100200604     C*****************************************************************   S01464
315200200604     C***********          END                                            S01464
315300200604     C***WRITE*PORTFOLIO*CUSTOMER*HEADING***************************R0131 S01464
315400200604     C***********          WRITEDETAIL1                             R0131 S01464
315500200604     C*****************************************************************   S01464
315600200604     C***ACCESS*PF/SCSCFAPD*WITH*CUSTOMER*NUMBER*AND*PORTFOLIO*REF.****   S01464
315700200604     C***********WWKEY1    CHAINSCSCFAPD             46                   S01464
315800200604     C*****************************************************************   S01464
315900200604     C***IF*NO*RECORD*FOUND********************************************   S01464
316000200604     C************IN46     IFEQ '1'                                       S01464
316100200604     C*****************************************************************   S01464
316200200604     C***SET*UP*WORK*FIELDS*FOR*'FEE*ACCRUED*TO*DATE',*'OUTSTANDING****   S01464
316300200604     C****ACCRUAL*ADJUSTMENT'*AND*'OUTSTANDING*ACCRUAL*ADJUSTMENT*SIGN'   S01464
316400200604     C***********          Z-ADD*ZEROS    WWCFAC                          S01464
316500200604     C***********          Z-ADD*ZEROS    WWOSAJ                          S01464
316600200604     C***********          MOVE *BLANKS   WWOSAS                          S01464
316700200604     C***********          ELSE                                           S01464
316800200604     C*****************************************************************   S01464
316900200604     C***SET*UP*WORK*FIELDS*WITH*VALUES*FROM*FILE**********************   S01464
317000200604     C***********          Z-ADDSDCFAC    WWCFAC                          S01464
317100200604     C***********          Z-ADDSDOSAJ    WWOSAJ                          S01464
317200200604     C***********          MOVE SDOSAS    WWOSAS                          S01464
317300200604     C***********          END                                            S01464
317400200604     C*****************************************************************   S01464
317500200604     C***OUTPUT*'FEES*ACCRUED*TO*TODAY'*REPORT*LINE********************   S01464
317600200604     C***********          Z-ADDWWCFAC    ZFLD15                          S01464
317700200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
317800200604     C***********          MOVE 'J'       ZECODE                          S01464
317900200604     C***********          EXSR ZSEDIT                                    S01464
318000200604     C***********          MOVE ZOUT21    RRFATT                          S01464
318100200604     C***********          WRITEDETAIL3                                   S01464
318200200604     C*****************************************************************   S01464
318300200604     C***IF*'OUTSTANDING*ACCRUAL*ADJUSTMENTS'*>*0*WRITE*REPORT*LINE****   S01464
318400200604     C***********WWOSAJ    IFGT *ZEROS                                    S01464
318500200604     C***********          Z-ADDWWOSAJ    ZFLD15                          S01464
318600200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
318700200604     C***********          MOVE 'J'       ZECODE                          S01464
318800200604     C***********          EXSR ZSEDIT                                    S01464
318900200604     C***********          MOVE ZOUT21    RROUTA                          S01464
319000200604     C*****************************************************************   S01464
319100200604     C***OUTPUT*'OUTSTANDING*ADJUSTMENT*SIGN'*TO*REPORT****************   S01464
319200200604     C***********          MOVE SDOSAS    RROTAS                          S01464
319300200604     C***********          WRITEDETAIL4                                   S01464
319400200604     C*****************************************************************   S01464
319500200604     C***UPDATE*'FEES*ACCRUED*TO*DATE'*AND*GENERATE*ACCRUAL*ADJUSTMENT*   S01464
319600200604     C****POSTINGS*****************************************************   S01464
319700200604     C***********          EXSR #P05                                      S01464
319800200604     C***********          END                                            S01464
319900200604     C*****************************************************************   S01464
320000200604     C***ACCESS*LF/SCPMPSLL*WITH*CUSTOMER*NUMBER*AND*PORTFOLIO*REF.****   S01464
320100200604     C*****      WWKEY1    CHAINSCPMPSLL             55
320200200604     C***********WWKEY1    SETLLSCPMPSLL             55                   S01464
320300200604     C***********          READ SCPMPSLL                 55               S01464
320400200604     C*****************************************************************   S01464
320500200604     C***DO*WHILE*RECORDS*ON*LF/SCPMPSLL*FOR*CUSTOMER*AND PORTFOLIO****   S01464
320600200604     C************IN55     DOWEQ'0'                                       S01464
320700200604     C***********WWCNUM    ANDEQQACNUM                                    S01464
320800200604     C***********WWPTFR    ANDEQQAPTFR                                    S01464
320900200604     C*****************************************************************   S01464
321000200604     C***MOVE*'SECURITY*REFERENCE'*INTO*A*WORK*FIELD*******************   S01464
321100200604     C***********          MOVE QATDSS    WWCSSC                          S01464
321200200604     C*****************************************************************   S01464
321300200604     C***SET*WORK*FIELD*FOR*'TOTAL*VALUE*DATE*NOMINAL'*****************   S01464
321400200604     C***********          Z-ADDQANOML    WWTVDN 150                      S01464
321500200604     C*****************************************************************   S01464
321600200604     C***CALCULATE*FEE*TO*BE*ACCRUED*FOR*THIS*SECURITY*****************   S01464
321700200604     C***********          EXSR #P06                                      S01464
321800200604     C*****************************************************************   S01464
321900200604     C***IF*CHARGE*CODE*NOT*BLANK**************************************   S01464
322000200604     C***********WWCGCO    IFNE *BLANKS                                   S01464
322100200604     C*****************************************************************   S01464
322200200604     C***SET*UP*REPORT*FIELDS*FOR*SECURITY*DETAIL*LINE*****************   S01464
322300200604     C***SECURITY*REFERENCE********************************************   S01464
322400200604     C***********          MOVE WWCSSC    RRSCTY                          S01464
322500200604     C*****************************************************************   S01464
322600200604     C***INVESTMENT*TYPE***********************************************   S01464
322700200604     C***********          MOVE SITP      RRIVTS                          S01464
322800200604     C*****************************************************************   S01464
322900200604     C***NOMINAL*CURRENCY**********************************************   S01464
323000200604     C***********          MOVE NMCY      RRNMCS                          S01464
323100200604     C*****************************************************************   S01464
323200200604     C***NOMINAL*POSITION**********************************************   S01464
323300200604     C***********          Z-ADDWWTVDN    ZFLD15                          S01464
323400200604     C***********          Z-ADDNMDP      ZDECS                           S01464
323500200604     C***********          MOVE 'J'       ZECODE                          S01464
323600200604     C***********          EXSR ZSEDIT                                    S01464
323700200604     C***********          MOVE ZOUT21    RRNPSS                          S01464
323800200604     C*****************************************************************   S01464
323900200604     C***MARKET*VALUE*IN*NOMINAL*CURRENCY******************************   S01464
324000200604     C***********          Z-ADDWWMVNC    ZFLD15                          S01464
324100200604     C***********          Z-ADDA6NBDP    ZDECS                           S01464
324200200604     C***********          MOVE 'J'       ZECODE                          S01464
324300200604     C***********          EXSR ZSEDIT                                    S01464
324400200604     C***********          MOVE ZOUT21    RRMNCS                          S01464
324500200604     C*****************************************************************   S01464
324600200604     C***MARKET*VALUE*IN*BANK*CHARGING*CURRENCY************************   S01464
324700200604     C***********          Z-ADDWWMVBC    ZFLD15                          S01464
324800200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
324900200604     C***********          MOVE 'J'       ZECODE                          S01464
325000200604     C***********          EXSR ZSEDIT                                    S01464
325100200604     C***********          MOVE ZOUT21    RRMCCS                          S01464
325200200604     C*****************************************************************   S01464
325300200604     C***FEE*CODE******************************************************   S01464
325400200604     C***********          MOVE WWCGCO    RRFECS                          S01464
325500200604     C*****************************************************************   S01464
325600200604     C***AMOUNT*ACCRUED*TODAY******************************************   S01464
325700200604     C***********          Z-ADDWWAAFS    ZFLD15                          S01464
325800200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
325900200604     C***********          MOVE 'J'       ZECODE                          S01464
326000200604     C***********          EXSR ZSEDIT                                    S01464
326100200604     C***********          MOVE ZOUT21    RRAATS                          S01464
326200200604     C*****************************************************************   S01464
326300200604     C***WRITE*DETAIL*LINE*TO*REPORT***********************************   S01464
326400200604     C***********QANOML    IFNE 0                                  B05945 S01464
326500200604     C***********          WRITEDETAIL6                                   S01464
326600200604     C***********          END                                     B05945 S01464
326700200604     C*****************************************************************   S01464
326800200604     C***ADD*FEE*ACCRUED*IN*#P06*TO*'FEES*ACCRUED*TO*DATE'*AND*TO******   S01464
326900200604     C****'FEES*ACCRUED*TODAY'*****************************************   S01464
327000200604     C***********          ADD  WWAAFS    WWCFAC                          S01464
327100200604     C***********          ADD  WWAAFS    WWFACT                          S01464
327200200604     C***********          END                                            S01464
327300200604     C*****************************************************************   S01464
327400200604     C***READ*NEXT*RECORD*ON*LF/SCPMPSLL*WITH*CUST*NUMBER*AND*PORT.****   S01464
327500200604     C***********          READ SCPMPSLL                 55               S01464
327600200604     C*****************************************************************   S01464
327700200604     C***********          END                                            S01464
327800200604     C*****************************************************************   S01464
327900200604     C***ACCESS*PF/SCPMABPD*WITH*CUST*NUMBER*AND*PORTFOLIO*REFERENCE***   S01464
328000200604     C***********          MOVE *LOVAL    WWCCYP  3                       S01464
328100200604     C***********WWKEY3    SETLLSCPMABPD                                  S01464
328200200604     C***********          READ SCPMABPD                 53               S01464
328300200604     C*****************************************************************   S01464
328400200604     C***WHILE*RECORDS*EXIST*FOR*THIS*CUSTOMER*************************   S01464
328500200604     C************IN53     DOWEQ'0'                                       S01464
328600200604     C***********WWCNUM    ANDEQSGCNUM                                    S01464
328700200604     C***********WWPTFR    ANDEQSGPTFR                                    S01464
328800200604     C*****************************************************************   S01464
328900200604     C***CALCULATE*FEE*TO*BE*ACCRUED*FOR*THIS*ACCOUNT******************   S01464
329000200604     C***********          EXSR #P07                                      S01464
329100200604     C*****************************************************************   S01464
329200200604     C***IF*CHARGE*CODE*NOT*BLANK**************************************   S01464
329300200604     C***********WWCGCO    IFNE *BLANKS                                   S01464
329400200604     C*****************************************************************   S01464
329500200604     C***SET*UP*REPORT*FIELDS*FOR*ACCOUNT*DETAIL*LINE******************   S01464
329600200604     C***ACCOUNT*CODE**************************************************   S01464
329700200604     C***********          MOVE WWACNT    RRACNT                          S01464
329800200604     C*****************************************************************   S01464
329900200604     C***INVESTMENT*TYPE***********************************************   S01464
330000200604     C***********          MOVE *BLANKS   RRIVTA                          S01464
330100200604     C*****************************************************************   S01464
330200200604     C***NOMINAL*CURRENCY**********************************************   S01464
330300200604     C***********          MOVE SGCCY     RRNMCA                          S01464
330400200604     C*****************************************************************   S01464
330500200604     C***NOMINAL*POSITION**********************************************   S01464
330600200604     C***********SGCLBL    IFLT 0                                         S01464
330700200604     C***********          Z-SUBSGCLBL    ZFLD15                          S01464
330800200604     C***********          ELSE                                           S01464
330900200604     C***********          Z-ADDSGCLBL    ZFLD15                          S01464
331000200604     C***********          END                                            S01464
331100200604     C*****************************************************************   S01464
331200200604     C***********          Z-ADDA6NBDP    ZDECS                           S01464
331300200604     C***********          MOVE 'J'       ZECODE                          S01464
331400200604     C***********          EXSR ZSEDIT                                    S01464
331500200604     C***********          MOVE ZOUT21    RRNPSA                          S01464
331600200604     C*****************************************************************   S01464
331700200604     C***SET*UP*CREDIT*DEBIT*INDICATOR*********************************   S01464
331800200604     C***********SGCLBL    IFLT 0                                         S01464
331900200604     C***********          MOVE 'CR'      RRDRCR                          S01464
332000200604     C***********          ELSE                                           S01464
332100200604     C***********          MOVE 'DR'      RRDRCR                          S01464
332200200604     C***********          END                                            S01464
332300200604     C*****************************************************************   S01464
332400200604     C***MARKET*VALUE*IN*NOMINAL*CURRENCY******************************   S01464
332500200604     C***********          Z-ADDWWMVNC    ZFLD15                          S01464
332600200604     C***********          Z-ADDA6NBDP    ZDECS                           S01464
332700200604     C***********          MOVE 'J'       ZECODE                          S01464
332800200604     C***********          EXSR ZSEDIT                                    S01464
332900200604     C***********          MOVE ZOUT21    RRMNCA                          S01464
333000200604     C*****************************************************************   S01464
333100200604     C***MARKET*VALUE*IN*BANK*CHARGING*CURRENCY************************   S01464
333200200604     C***********          Z-ADDWWMVBC    ZFLD15                          S01464
333300200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
333400200604     C***********          MOVE 'J'       ZECODE                          S01464
333500200604     C***********          EXSR ZSEDIT                                    S01464
333600200604     C***********          MOVE ZOUT21    RRMCCA                          S01464
333700200604     C*****************************************************************   S01464
333800200604     C***FEE*CODE******************************************************   S01464
333900200604     C***********          MOVE WWCGCO    RRFECA                          S01464
334000200604     C*****************************************************************   S01464
334100200604     C***AMOUNT*ACCRUED*TODAY******************************************   S01464
334200200604     C***********          Z-ADDWWAAFA    ZFLD15                          S01464
334300200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
334400200604     C***********          MOVE 'J'       ZECODE                          S01464
334500200604     C***********          EXSR ZSEDIT                                    S01464
334600200604     C***********          MOVE ZOUT21    RRAATA                          S01464
334700200604     C*****************************************************************   S01464
334800200604     C***WRITE*DETAIL*LINE*TO*REPORT***********************************   S01464
334900200604     C***********SGCLBL    IFNE 0                                  B05945 S01464
335000200604     C***********          WRITEDETAIL7                                   S01464
335100200604     C***********          END                                     B05945 S01464
335200200604     C*****************************************************************   S01464
335300200604     C***ADD*FEE*ACCRUED*IN*#P07*TO*'FEES*ACCRUED*TO*DATE'*AND*TO******   S01464
335400200604     C****'FEES*ACCRUED*TODAY'*****************************************   S01464
335500200604     C***********          ADD  WWAAFA    WWCFAC                          S01464
335600200604     C***********          ADD  WWAAFA    WWFACT                          S01464
335700200604     C*****************************************************************   S01464
335800200604     C***********          END                                            S01464
335900200604     C*****************************************************************   S01464
336000200604     C***READ*NEXT*RECORD*ON*PF/SCPMABPD*******************************   S01464
336100200604     C***********          READ SCPMABPD                 53               S01464
336200200604     C*****************************************************************   S01464
336300200604     C***********          END                                            S01464
336400200604     C*****************************************************************   S01464
336500200604     C** ACCESS PF/SCSCFAPD WITH CUSTOMER AND PORTFOLIO REFERENCE TO      S01464
336600200604     C****SEE*IF*RECORD*EXISTS*****************************************   S01464
336700200604     C***********WWKEY1    CHAINSCSCFAPD             46                   S01464
336800200604     C*****************************************************************   S01464
336900200604     C***IF*RECORD*EXISTS*UPDATE*RECORD*ON*PF/SCSCFAPD*****************   S01464
337000200604     C************IN46     IFEQ '0'                                       S01464
337100200604     C*****************************************************************   S01464
337200200604     C***TYPE*OF*LAST*CHANGE*******************************************   S01464
337300200604     C***********          MOVE 'A'       SDCHTP                          S01464
337400200604     C*****************************************************************   S01464
337500200604     C***CUSTODY*FEE*ACCRUED*TO*DATE***********************************   S01464
337600200604     C***********          Z-ADDWWCFAC    SDCFAC                          S01464
337700200604     C*****************************************************************   S01464
337800200604     C***OUTSTANDING*ACCRUAL*ADJUSTMENT********************************   S01464
337900200604     C***********          Z-ADD*ZEROS    SDOSAJ                          S01464
338000200604     C*****************************************************************   S01464
338100200604     C***OUTSTANDING*ACCRUAL*ADJUSTMENT*SIGN***************************   S01464
338200200604     C***********          MOVE *BLANKS   SDOSAS                          S01464
338300200604     C*****************************************************************   S01464
338400200604     C***UPDATE*PF/SCSCFAPD********************************************   S01464
338500200604     C***********          UPDATSCSCFAP0                                  S01464
338600200604     C*****************************************************************   S01464
338700200604     C***********          ELSE                                           S01464
338800200604     C*****************************************************************   S01464
338900200604     C***IF*RECORD*DOES*NOT*EXIST*WRITE*RECORD*TO*PF/SCSCFAPD**********   S01464
339000200604     C*****************************************************************   S01464
339100200604     C***RECORD*ID*****************************************************   S01464
339200200604     C***********          MOVE 'D'       SDRECI                          S01464
339300200604     C*****************************************************************   S01464
339400200604     C***DAY*OF*LAST*UPDATE********************************************   S01464
339500200604     C***********          Z-ADDWWDAYU    SDDLUP                          S01464
339600200604     C*****************************************************************   S01464
339700200604     C***MONTH*OF*LAST*UPDATE******************************************   S01464
339800200604     C***********          MOVE WWMTHU    SDMLUP                          S01464
339900200604     C*****************************************************************   S01464
340000200604     C***YEAR*OF*LAST*UPDATE*******************************************   S01464
340100200604     C***********          Z-ADDWWYERU    SDYLUP                          S01464
340200200604     C*****************************************************************   S01464
340300200604     C***TIME*OF*LAST*UPDATE*******************************************   S01464
340400200604     C***********          TIME           SDTLUP                          S01464
340500200604     C*****************************************************************   S01464
340600200604     C***TYPE*OF*LAST*CHANGE*******************************************   S01464
340700200604     C***********          MOVE 'I'       SDCHTP                          S01464
340800200604     C*****************************************************************   S01464
340900200604     C***LAST*CHANGE*DATE**********************************************   S01464
341000200604     C***********          Z-ADDBJRDNB    SDLCD                           S01464
341100200604     C*****************************************************************   S01464
341200200604     C***TRANSACTION*NUMBER*OF*LAST*UPDATE*****************************   S01464
341300200604     C********             Z-ADD*ZEROS    SDTNLU
341400200604     C*****************************************************************   S01464
341500200604     C***RETRIEVE*NEXT*TRANSACTION*NUMBER******************************   S01464
341600200604     C*****************************************************************   S01464
341700200604     C***********          EXSR ZTNLU1                                    S01464
341800200604     C***********          MOVELNATN      SDTNLU                          S01464
341900200604     C*****************************************************************   S01464
342000200604     C***CUSTOMER*NUMBER***********************************************   S01464
342100200604     C***********          Z-ADDWWCNUM    SDCNUM                          S01464
342200200604     C*****************************************************************   S01464
342300200604     C***PORTFOLIO*REFERENCE*******************************************   S01464
342400200604     C***********          MOVE WWPTFR    SDPTFR                          S01464
342500200604     C*****************************************************************   S01464
342600200604     C***CUSTODY*FEE*ACCRUED*TO*DATE***********************************   S01464
342700200604     C***********          Z-ADDWWCFAC    SDCFAC                          S01464
342800200604     C*****************************************************************   S01464
342900200604     C***OUTSTANDING*ACCRUAL*ADJUSTMENT********************************   S01464
343000200604     C***********          Z-ADD*ZEROS    SDOSAJ                          S01464
343100200604     C*****************************************************************   S01464
343200200604     C***OUTSTANDING*ACCRUAL*ADJUSTMENT*SIGN***************************   S01464
343300200604     C***********          MOVE *BLANKS   SDOSAS                          S01464
343400200604     C*****************************************************************   S01464
343500200604     C***WRITE*RECORD*TO*PF/SCSCFAPD***********************************   S01464
343600200604     C***********          WRITESCSCFAP0                                  S01464
343700200604     C*****************************************************************   S01464
343800200604     C***********          END                                            S01464
343900200604     C*****************************************************************   S01464
344000200604     C***IF*'FEE*ACCRUED*TODAY'*NOT*ZERO*CALL*#P10*********************   S01464
344100200604     C***********WWFACT    IFNE *ZEROS                                    S01464
344200200604     C***********          EXSR #P10                                      S01464
344300200604     C***********          END                                            S01464
344400200604     C*****************************************************************   S01464
344500200604     C***OUTPUT*'FEES*ACCRUED*TO*DATE'*REPORT*LINE*********************   S01464
344600200604     C***********          Z-ADDWWCFAC    ZFLD15                          S01464
344700200604     C***********          Z-ADDSABCGD    ZDECS                           S01464
344800200604     C***********          MOVE 'J'       ZECODE                          S01464
344900200604     C***********          EXSR ZSEDIT                                    S01464
345000200604     C***********          MOVE ZOUT21    RRFATD                          S01464
345100200604     C***********          WRITEDETAIL5                                   S01464
345200200604     C*****************************************************************   S01464
345300200604     C***********          ENDSR                                          S01464
345400200604     C*                                                                   091522
345500200604     C           #P11      BEGSR                                          091522
345600200604     C*                                                                   091522
345700200604     C** CHECK VALUE OF 'CUSTODY FEE GROUP CODE' ON LF/PMPORTLL           091522
345800200604     C           FBFGCP    IFEQ 'Y'                                       091522
345900200604     C           WWPTFR    ANDNE'9997'                                    091522
346000200604     C                     MOVE PNCFGC    WWCFGC                          091522
346100200604     C                     ELSE                                           091522
346200200604     C                     MOVE BFCFGC    WWCFGC                          091522
346300200604     C                     END                                            091522
346400200604     C*                                                                   091522
346500200604     C** IF HEADINGS HAVE NOT JUST BEEN WRITTEN                           091522
346600200604     C           *IN30     IFEQ '0'                                       091522
346700200604     C*                                                                   091522
346800200604     C** MOVE VALUES FOR CUSTOMER HEADING INTO REPORT FIELDS              091522
346900200604     C                     MOVE BBCUST    RRCNM1                          091522
347000200604     C                     MOVE BBCRNM    RRSNM1                          091522
347100200604     C*                                                                   091522
347200200604     C                     ELSE                                           091522
347300200604     C*                                                                   091522
347400200604     C** RESET HEADINGS ALREADY WRITTEN INDICATOR                         091522
347500200604     C                     MOVE '0'       *IN30                           091522
347600200604     C                     END                                            091522
347700200604     C*                                                                   091522
347800200604     C** DECIDE PORTFOLIO REFERENCE TO BE USED IN CUSTOMER HEADING        091522
347900200604     C           WWPTFR    IFEQ '9997'                                    091522
348000200604     C                     MOVE FCR997    RRPNM1                          091522
348100200604     C                     MOVE FCN997    RRPSN1                          091522
348200200604     C                     ELSE                                           091522
348300200604     C                     MOVE PNPTFR    RRPNM1                          091522
348400200604     C                     MOVE PNPTFN    RRPSN1                          091522
348500200604     C                     END                                            091522
348600200604     C*                                                                   091522
348700200604     C** WRITE PORTFOLIO CUSTOMER HEADING                                 091522
348800200604     C                     MOVE WWCFGC    RRAFG1                          091522
348900200604     C*                                                                   091522
349000200604     C** IF HEADER 3 NECESSARY OR ACCOUNT OFFICER CHANGED                 091522
349100200604     C           *IN31     IFEQ '1'                                       091522
349200200604     C           BBACOC    ORNE WWACOC                                    091522
349300200604     C*                                                                   091522
349400200604     C** OUTPUT BANK CHARGING CURRENCY TO REPORT                          091522
349500200604     C                     MOVE WWBCGC    RRBCCY                          091522
349600200604     C                     MOVE WWBCGC    RRCCCY                          091522
349700200604     C                     WRITEHEADER3                                   091522
349800200604     C*                                                                   091522
349900200604     C** RESET HEADER 3 NECESSARY INDICATOR                               091522
350000200604     C                     MOVE '0'       *IN31                           091522
350100200604     C*                                                                   091522
350200200604     C** MOVE NEW ACCOUNT OFFICER CODE INTO WORK FIELD                    091522
350300200604     C                     MOVE BBACOC    WWACOC                          091522
350400200604     C*                                                                   091522
350500200604     C                     END                                            091522
350600200604     C** WRITE PORTFOLIO CUSTOMER HEADING                                 091522
350700200604     C                     WRITEDETAIL1                             R0131 091522
350800200604     C*                                                                   091522
350900200604     C** ACCESS PF/SCSCFAPD WITH CUSTOMER NUMBER AND PORTFOLIO REF.       091522
351000200604     C           WWKEY1    CHAINSESCFAPD             46                   091522
351100200604     C*                                                                   091522
351200200604     C** IF NO RECORD FOUND                                               091522
351300200604     C           *IN46     IFEQ '1'                                       091522
351400200604     C*                                                                   091522
351500200604     C** SET UP WORK FIELDS FOR 'FEE ACCRUED TO DATE', 'OUTSTANDING       091522
351600200604     C**  ACCRUAL ADJUSTMENT' AND 'OUTSTANDING ACCRUAL ADJUSTMENT SIGN'   091522
351700200604     C                     Z-ADD*ZEROS    WWCFAC                          091522
351800200604     C                     Z-ADD*ZEROS    WWOSAJ                          091522
351900200604     C                     MOVE *BLANKS   WWOSAS                          091522
352000200604     C                     ELSE                                           091522
352100200604     C*                                                                   091522
352200200604     C** SET UP WORK FIELDS WITH VALUES FROM FILE                         091522
352300200604     C                     Z-ADDSDCFAC    WWCFAC                          091522
352400200604     C                     Z-ADDSDOSAJ    WWOSAJ                          091522
352500200604     C                     MOVE SDOSAS    WWOSAS                          091522
352600200604     C                     END                                            091522
352700200604     C*                                                                   091522
352800200604     C** OUTPUT 'FEES ACCRUED TO TODAY' REPORT LINE                       091522
352900200604     C                     Z-ADDWWCFAC    ZFLD15                          091522
353000200604     C                     Z-ADDZCDPT     ZDECS                           091522
353100200604     C                     MOVE 'J'       ZECODE                          091522
353200200604     C                     EXSR ZSEDIT                                    091522
353300200604     C                     MOVE ZOUT21    RRFATT                          091522
353400200604     C                     WRITEDETAIL3                                   091522
353500200604     C*                                                                   091522
353600200604     C** IF 'OUTSTANDING ACCRUAL ADJUSTMENTS' > 0 WRITE REPORT LINE       091522
353700200604     C           WWOSAJ    IFGT *ZEROS                                    091522
353800200604     C                     Z-ADDWWOSAJ    ZFLD15                          091522
353900200604     C                     Z-ADDZCDPT     ZDECS                           091522
354000200604     C                     MOVE 'J'       ZECODE                          091522
354100200604     C                     EXSR ZSEDIT                                    091522
354200200604     C                     MOVE ZOUT21    RROUTA                          091522
354300200604     C*                                                                   091522
354400200604     C** OUTPUT 'OUTSTANDING ADJUSTMENT SIGN' TO REPORT                   091522
354500200604     C                     MOVE SDOSAS    RROTAS                          091522
354600200604     C                     WRITEDETAIL4                                   091522
354700200604     C*                                                                   091522
354800200604     C** UPDATE 'FEES ACCRUED TO DATE' AND GENERATE ACCRUAL ADJUSTMENT    091522
354900200604     C**  POSTINGS                                                        091522
355000200604     C                     EXSR #P05                                      091522
355100200604     C                     END                                            091522
355200200604     C*                                                                   091522
355300200604     C** ACCESS LF/SCPMPSLL WITH CUSTOMER NUMBER AND PORTFOLIO REF.       091522
355400200604     C           WWKEY5    SETLLSEPMPSL0             55                   091522
355500200604     C                     READ SEPMPSL0                 55               091522
355600200604     C*                                                                   091522
355700200604     C** DO WHILE RECORDS ON LF/SCPMPSLL FOR CUSTOMER AND PORTFOLIO       091522
355800200604     C           *IN55     DOWEQ'0'                                       091522
355900200604     C           WWCNUM    ANDEQQACNUM                                    091522
356000200604     C           WWPTFR    ANDEQQAPTFR                                    091522
356100200604     C*                                                                   091522
356200200604     C** MOVE 'SECURITY REFERENCE' INTO A WORK FIELD                      091522
356300200604     C                     MOVE QATDSS    WWCSSC                          091522
356400200604     C*                                                                   091522
356500200604     C** SET WORK FIELD FOR 'TOTAL VALUE DATE NOMINAL'                    091522
356600200604     C/COPY WNCPYSRC,SE6240C015
356700200604     C                     Z-ADDQANOML    WWTVDN 150                      091522
356800200604     C*                                                                   091522
356900200604     C** CALCULATE FEE TO BE ACCRUED FOR THIS SECURITY                    091522
357000200604     C                     EXSR #P06                                      091522
357100200604     C*                                                                   091522
357200200604     C** IF CHARGE CODE NOT BLANK                                         091522
357300200604     C           WWCGCO    IFNE *BLANKS                                   091522
357400200604     C*                                                                   091522
357500200604     C** SET UP REPORT FIELDS FOR SECURITY DETAIL LINE                    091522
357600200604     C** BRANCH CODE                                                      091522
357700200604     C                     MOVE *BLANKS   RRBRCA                          091522
357800200604     C** SECURITY REFERENCE                                               091522
357900200604     C                     MOVE WWCSSC    RRSCTY                          091522
358000200604     C*                                                                   091522
358100200604     C** INVESTMENT TYPE                                                  091522
358200200604     C                     MOVE SITP      RRIVTS                          091522
358300200604     C*                                                                   091522
358400200604     C** NOMINAL CURRENCY                                                 091522
358500200604     C                     MOVE NMCY      RRNMCS                          091522
358600200604     C*                                                                   091522
358700200604     C** NOMINAL POSITION                                                 091522
358800200604     C                     Z-ADDWWTVDN    ZFLD15                          091522
358900200604     C                     Z-ADDNMDP      ZDECS                           091522
359000200604     C                     MOVE 'J'       ZECODE                          091522
359100200604     C                     EXSR ZSEDIT                                    091522
359200200604     C                     MOVE ZOUT21    RRNPSS                          091522
359300200604     C*                                                                   091522
359400200604     C** MARKET VALUE IN NOMINAL CURRENCY                                 091522
359500200604     C                     Z-ADDWWMVNC    ZFLD15                          091522
359600200604     C                     Z-ADDA6NBDP    ZDECS                           091522
359700200604     C                     MOVE 'J'       ZECODE                          091522
359800200604     C                     EXSR ZSEDIT                                    091522
359900200604     C                     MOVE ZOUT21    RRMNCS                          091522
360000200604     C*                                                                   091522
360100200604     C** MARKET VALUE IN BANK CHARGING CURRENCY                           091522
360200200604     C                     Z-ADDWWMVBC    ZFLD15                          091522
360300200604     C                     Z-ADDZCDPT     ZDECS                           091522
360400200604     C                     MOVE 'J'       ZECODE                          091522
360500200604     C                     EXSR ZSEDIT                                    091522
360600200604     C                     MOVE ZOUT21    RRMCCS                          091522
360700200604     C*                                                                   091522
360800200604     C** FEE CODE                                                         091522
360900200604     C                     MOVE WWCGCO    RRFECS                          091522
361000200604     C*                                                                   091522
361100200604     C** AMOUNT ACCRUED TODAY                                             091522
361200200604     C                     Z-ADDWWAAFS    ZFLD15                          091522
361300200604     C                     Z-ADDZCDPT     ZDECS                           091522
361400200604     C                     MOVE 'J'       ZECODE                          091522
361500200604     C                     EXSR ZSEDIT                                    091522
361600200604     C/COPY WNCPYSRC,SE6240C016
361700200604     C                     MOVE ZOUT21    RRAATS                          091522
361800200604     C/COPY WNCPYSRC,SE6240C017
361900200604     C*                                                                   091522
362000200604     C** WRITE DETAIL LINE TO REPORT                                      091522
362100200604     C           QANOML    IFNE 0                                         091522
362200200604     C                     WRITEDETAIL6                                   091522
362300200604     C                     END                                            091522
362400200604     C*                                                                   091522
362500200604     C** ADD FEE ACCRUED IN #P06 TO 'FEES ACCRUED TO DATE' AND TO         091522
362600200604     C**  'FEES ACCRUED TODAY'                                            091522
362700200604     C                     ADD  WWAAFS    WWCFAC                          091522
362800200604     C                     ADD  WWAAFS    WWFACT                          091522
362900200604     C/COPY WNCPYSRC,SE6240C018
363000200604     C                     END                                            091522
363100200604     C*                                                                   091522
363200200604     C** READ NEXT RECORD ON LF/SEPMPSL0 WITH CUST NUMBER AND PORT.       091522
363300200604     C                     READ SEPMPSL0                 55               091522
363400200604     C*                                                                   091522
363500200604     C                     END                                            091522
363600200604     C*                                                                   091522
363700200604     C** ACCESS PF/SCPMABPD WITH CUST NUMBER AND PORTFOLIO REFERENCE      091522
363800200604     C                     MOVE *LOVAL    WWCCYP  3                       091522
363900200604     C           WWKEY3    SETLLSEPMABPD                                  091522
364000200604     C                     READ SEPMABPD                 53               091522
364100200604     C*                                                                   091522
364200200604     C** WHILE RECORDS EXIST FOR THIS CUSTOMER                            091522
364300200604     C           *IN53     DOWEQ'0'                                       091522
364400200604     C           WWCNUM    ANDEQSGCNUM                                    091522
364500200604     C           WWPTFR    ANDEQSGPTFR                                    091522
364600200604     C*                                                                   091522
364700200604     C** CALCULATE FEE TO BE ACCRUED FOR THIS ACCOUNT                     091522
364800200604     C                     EXSR #P07                                      091522
364900200604     C*                                                                   091522
365000200604     C** IF CHARGE CODE NOT BLANK                                         091522
365100200604     C           WWCGCO    IFNE *BLANKS                                   091522
365200200604     C*                                                                   091522
365300200604     C** SET UP REPORT FIELDS FOR ACCOUNT DETAIL LINE                     091522
365400200604     C** BRANCH CODE                                                      091522
365500200604     C                     MOVE SGBRCA    RRBRCA                          091522
365600200604     C** ACCOUNT CODE                                                     091522
365700200604     C                     MOVE WWACNT    RRACNT                          091522
365800200604     C*                                                                   091522
365900200604     C** INVESTMENT TYPE                                                  091522
366000200604     C                     MOVE *BLANKS   RRIVTA                          091522
366100200604     C*                                                                   091522
366200200604     C** NOMINAL CURRENCY                                                 091522
366300200604     C                     MOVE SGCCY     RRNMCA                          091522
366400200604     C*                                                                   091522
366500200604     C** NOMINAL POSITION                                                 091522
366600200604     C           SGCLBL    IFLT 0                                         091522
366700200604     C                     Z-SUBSGCLBL    ZFLD15                          091522
366800200604     C                     ELSE                                           091522
366900200604     C                     Z-ADDSGCLBL    ZFLD15                          091522
367000200604     C                     END                                            091522
367100200604     C*                                                                   091522
367200200604     C                     Z-ADDA6NBDP    ZDECS                           091522
367300200604     C                     MOVE 'J'       ZECODE                          091522
367400200604     C                     EXSR ZSEDIT                                    091522
367500200604     C                     MOVE ZOUT21    RRNPSA                          091522
367600200604     C*                                                                   091522
367700200604     C** SET UP CREDIT DEBIT INDICATOR                                    091522
367800200604     C           SGCLBL    IFLT 0                                         091522
367900200604     C                     MOVE 'CR'      RRDRCR                          091522
368000200604     C                     ELSE                                           091522
368100200604     C                     MOVE 'DR'      RRDRCR                          091522
368200200604     C                     END                                            091522
368300200604     C*                                                                   091522
368400200604     C** MARKET VALUE IN NOMINAL CURRENCY                                 091522
368500200604     C                     Z-ADDWWMVNC    ZFLD15                          091522
368600200604     C                     Z-ADDA6NBDP    ZDECS                           091522
368700200604     C                     MOVE 'J'       ZECODE                          091522
368800200604     C                     EXSR ZSEDIT                                    091522
368900200604     C                     MOVE ZOUT21    RRMNCA                          091522
369000200604     C*                                                                   091522
369100200604     C** MARKET VALUE IN BANK CHARGING CURRENCY                           091522
369200200604     C                     Z-ADDWWMVBC    ZFLD15                          091522
369300200604     C                     Z-ADDZCDPT     ZDECS                           091522
369400200604     C                     MOVE 'J'       ZECODE                          091522
369500200604     C                     EXSR ZSEDIT                                    091522
369600200604     C                     MOVE ZOUT21    RRMCCA                          091522
369700200604     C*                                                                   091522
369800200604     C** FEE CODE                                                         091522
369900200604     C                     MOVE WWCGCO    RRFECA                          091522
370000200604     C*                                                                   091522
370100200604     C** AMOUNT ACCRUED TODAY                                             091522
370200200604     C                     Z-ADDWWAAFA    ZFLD15                          091522
370300200604     C                     Z-ADDZCDPT     ZDECS                           091522
370400200604     C                     MOVE 'J'       ZECODE                          091522
370500200604     C                     EXSR ZSEDIT                                    091522
370600200604     C/COPY WNCPYSRC,SE6240C019
370700200604     C                     MOVE ZOUT21    RRAATA                          091522
370800200604     C/COPY WNCPYSRC,SE6240C020
370900200604     C*                                                                   091522
371000200604     C** WRITE DETAIL LINE TO REPORT                                      091522
371100200604     C           SGCLBL    IFNE 0                                         091522
371200200604     C                     WRITEDETAIL7                                   091522
371300200604     C                     END                                            091522
371400200604     C*                                                                   091522
371500200604     C** ADD FEE ACCRUED IN #P07 TO 'FEES ACCRUED TO DATE' AND TO         091522
371600200604     C**  'FEES ACCRUED TODAY'                                            091522
371700200604     C                     ADD  WWAAFA    WWCFAC                          091522
371800200604     C                     ADD  WWAAFA    WWFACT                          091522
371900200604     C/COPY WNCPYSRC,SE6240C021
372000200604     C*                                                                   091522
372100200604     C                     END                                            091522
372200200604     C*                                                                   091522
372300200604     C** READ NEXT RECORD ON PF/SEPMABPD                                  091522
372400200604     C                     READ SEPMABPD                 53               091522
372500200604     C*                                                                   091522
372600200604     C                     END                                            091522
372700200604     C*                                                                   091522
372800200604     C** ACCESS PF/SESCFAPD WITH CUSTOMER AND PORTFOLIO REFERENCE TO      091522
372900200604     C**  SEE IF RECORD EXISTS                                            091522
373000200604     C/COPY WNCPYSRC,SE6240C022
373100200604     C           WWKEY1    CHAINSESCFAPD             46                   091522
373200200604     C*                                                                   091522
373300200604     C** IF RECORD EXISTS UPDATE RECORD ON PF/SCSCFAPD                    091522
373400200604     C           *IN46     IFEQ '0'                                       091522
373500200604     C*                                                                   091522
373600200604     C** TYPE OF LAST CHANGE                                              091522
373700200604     C                     MOVE 'A'       SDCHTP                          091522
373800200604     C*                                                                   091522
373900200604     C** CUSTODY FEE ACCRUED TO DATE                                      091522
374000200604     C                     Z-ADDWWCFAC    SDCFAC                          091522
374100200604     C*                                                                   091522
374200200604     C** OUTSTANDING ACCRUAL ADJUSTMENT                                   091522
374300200604     C                     Z-ADD*ZEROS    SDOSAJ                          091522
374400200604     C*                                                                   091522
374500200604     C** OUTSTANDING ACCRUAL ADJUSTMENT SIGN                              091522
374600200604     C                     MOVE *BLANKS   SDOSAS                          091522
374700200604     C*                                                                   091522
374800200604     C** UPDATE PF/SESCFAPD                                               091522
374900200604     C                     UPDATSESCFAP0                                  091522
375000200604     C*                                                                   091522
375100200604     C                     ELSE                                           091522
375200200604     C*                                                                   091522
375300200604     C** IF RECORD DOES NOT EXIST WRITE RECORD TO PF/SCSCFAPD             091522
375400200604     C*                                                                   091522
375500200604     C** RECORD ID                                                        091522
375600200604     C                     MOVE 'D'       SDRECI                          091522
375700200604     C*                                                                   091522
375800200604     C** DAY OF LAST UPDATE                                               091522
375900200604     C                     Z-ADDWWDAYU    SDDLUP                          091522
376000200604     C*                                                                   091522
376100200604     C** MONTH OF LAST UPDATE                                             091522
376200200604     C                     MOVE WWMTHU    SDMLUP                          091522
376300200604     C*                                                                   091522
376400200604     C** YEAR OF LAST UPDATE                                              091522
376500200604     C                     Z-ADDWWYERU    SDYLUP                          091522
376600200604     C*                                                                   091522
376700200604     C** TIME OF LAST UPDATE                                              091522
376800200604     C                     TIME           SDTLUP                          091522
376900200604     C*                                                                   091522
377000200604     C** TYPE OF LAST CHANGE                                              091522
377100200604     C                     MOVE 'I'       SDCHTP                          091522
377200200604     C*                                                                   091522
377300200604     C** LAST CHANGE DATE                                                 091522
377400200604     C                     Z-ADDBJRDNB    SDLCD                           091522
377500200604     C*                                                                   091522
377600200604     C** RETRIEVE NEXT TRANSACTION NUMBER                                 091522
377700200604     C*                                                                   091522
377800200604     C                     EXSR ZTNLU1                                    091522
377900200604     C                     MOVELNATN      SDTNLU                          091522
378000200604     C*                                                                   091522
378100200604     C** CUSTOMER NUMBER                                                  091522
378200200604     C**********           Z-ADDWWCNUM    SDCNUM                                       091522 CSD027
378300200604     C                     MOVE WWCNUM    SDCNUM                                              CSD027
378400200604     C*                                                                   091522
378500200604     C** PORTFOLIO REFERENCE                                              091522
378600200604     C                     MOVE WWPTFR    SDPTFR                          091522
378700200604     C*                                                                   091522
378800200604     C** CUSTODY FEE ACCRUED TO DATE                                      091522
378900200604     C                     Z-ADDWWCFAC    SDCFAC                          091522
379000200604     C*                                                                   091522
379100200604     C** OUTSTANDING ACCRUAL ADJUSTMENT                                   091522
379200200604     C                     Z-ADD*ZEROS    SDOSAJ                          091522
379300200604     C*                                                                   091522
379400200604     C** OUTSTANDING ACCRUAL ADJUSTMENT SIGN                              091522
379500200604     C                     MOVE *BLANKS   SDOSAS                          091522
379600200604     C*                                                                   091522
379700200604     C** BRANCH CODE                                                      091522
379800200604     C                     MOVE WWBRCH    SDBRCA                          091522
379900200604     C*                                                                   091522
380000200604     C** WRITE RECORD TO PF/SESCFAPD                                      091522
380100200604     C                     WRITESESCFAP0                                  091522
380200200604     C*                                                                   091522
380300200604     C                     END                                            091522
380400200604     C*                                                                   091522
380500200604     C** IF 'FEE ACCRUED TODAY' NOT ZERO CALL #P10                        091522
380600200604     C           WWFACT    IFNE *ZEROS                                    091522
380700200604     C                     EXSR #P10                                      091522
380800200604     C                     END                                            091522
380900200604     C/COPY WNCPYSRC,SE6240C023
381000200604     C*                                                                   091522
381100200604     C** OUTPUT 'FEES ACCRUED TO DATE' REPORT LINE                        091522
381200200604     C                     Z-ADDWWCFAC    ZFLD15                          091522
381300200604     C                     Z-ADDZCDPT     ZDECS                           091522
381400200604     C                     MOVE 'J'       ZECODE                          091522
381500200604     C                     EXSR ZSEDIT                                    091522
381600200604     C                     MOVE ZOUT21    RRFATD                          091522
381700200604     C                     WRITEDETAIL5                                   091522
381800200604     C*                                                                   091522
381900200604     C                     ENDSR                                          091522
382000200604     C********************************************************************
382100200604     C/EJECT
382200200604     C********************************************************************
382300200604     C*
382400200604     C           #P12      BEGSR
382500200604     C*
382600200604     C** SET UP FIELDS FOR OUTPUT TO TRAILER FILE GESCZZ
382700200604     C                     MOVE 'T'       RECI
382800200604     C                     Z-ADDWWNUMR    NORE1
382900200604     C                     ADD  2         NORE1                           S01464
383000200604     C           WWTOTP    DIV  1000      HRWN
383100200604     C                     MVR            HRDC
383200200604     C*
383300200604     C** WRITE RECORD TO TRAILER FILE GESCZZ
383400200604     C                     WRITEAPOSTZZF
383500200604     C*
383600200604     C** OUTPUT RUN CONTROLS REPORT
383700200604     C                     WRITEHEADER
383800200604     C                     Z-ADDWWNUMR    RRPROG
383900200604     C                     WRITEDETAILA
384000200604     C***********          WRITEFOOTING                                   S01464
384100200604     C*
384200200604     C                     ENDSR
384300200604     C********************************************************************
384400200604     C/EJECT                                                              083825
384500200604     C*****************************************************************   083825
384600200604     C*                                                               *   083825
384700200604     C* #WRTHD  -  Write the appropiate header and subheader          *   083825
384800200604     C*                                                               *   083825
384900200604     C* Called by: #P03                                               *   083825
385000200604     C* Calls    : None                                               *   083825
385100200604     C*                                                               *   083825
385200200604     C*****************************************************************   083825
385300200604     C*                                                                   083825
385400200604     C           #WRTHD    BEGSR                                          083825
385500200604     C*                                                                   083825
385600200604     C                     WRITEHEADER1                                   083825
385700200604     C                     WRITEHEADER2                                   083825
385800200604     C                     WRITEHEADER3                                   083825
385900200604     C           FBCFCP    IFEQ 'C'                                       083825
386000200604     C                     WRITEDETAIL2                                   083825
386100200604     C                     END                                            083825
386200200604     C*                                                                   083825
386300200604     C                     ENDSR                                          083825
386400200604     C********************************************************************083825
386500200604     C/EJECT
386600200604     C********************************************************************
386700200604     C*
386800200604     C           #ZA       BEGSR
386900200604     C*
387000200604     C                     WRITEHEADER
387100200604     C                     WRITEDBERROR
387200200604     C***********          WRITEFOOTING                                   S01464
387300200604     C*
387400200604     C                     MOVE '1'       *INU7
387500200604     C                     MOVE '1'       *INU8
387600200604     C                     MOVE '1'       *INLR
387700200604     C                     RETRN
387800200604     C*
387900200604     C                     ENDSR
388000200604     C********************************************************************
388100200604     C/EJECT
388200200604     C********************************************************************
388300200604     C*
388400200604     C           *PSSR     BEGSR
388500200604     C                     DUMP
388600200604     C           #PSSR0    ENDSR
388700200604     C*****************************************************************
388800200604     C/EJECT
388900200604     C********************************************************************
389000200604     C*/COPY ZSRSRC,ZPMCRG
389100200604     C**************************************************************************
389200200604     C*                                                                        *
389300200604     C*  ZPMCRG SR. TO CALCULATE PORTFOLIO MANAGEMENT CHARGES                  *
389400200604     C*                                                                        *
389500200604     C*  INPUT  FIELDS                                                         *
389600200604     C********ZAMT***150*****PRINCIPAL*AMOUNT**************************   S01464
389700200604     C*       ZAMT   110     Principal Amount                         *   S01464
389800200604     C*       ZDYBS   10     DAY BASIS                                         *
389900200604     C*       ZDVBS   10     DIVISOR BASIS                                     *
390000200604     C*       ZFMDAT  50     FROM DATE                                         *
390100200604     C*       ZTODAT  50     TO DATE                                           *
390200200604     C*       ZSPRD  130     EFFECTIVE CHARGE SPREAD                           *
390300200604     C*       ZSPRI   1      EFFECTIVE CHARGE SPREAD INDICATOR                 *
390400200604     C*       ZCGBS   1      CHARGE BASIS                                      *
390500200604     C*       ZCGMT   1      CHARGING METHOD                                   *
390600200604     C*       ZMINC  150     MINIMUM CHARGE AMOUNT                             *
390700200604     C*       ZRA    150x14  RANGE UPPER LIMITS                                *
390800200604     C*       ZPC    117x15  PERCENTAGES                                       *
390900200604     C*       ZCG    150x15  FLAT CHARGE AMOUNTS                               *
391000200604     C*                                                                        *
391100200604     C*  OUTPUT  FIELDS                                                        *
391200200604     C*       ZCHGA  150     TOTAL CHARGE AMOUNT                               *
391300200604     C*                                                                        *
391400200604     C*  CALLS: ZDYYR                                                          *
391500200604     C*         ZDAYS                                                          *
391600200604     C**************************************************************************
391700200604     C*
391800200604     C           ZPMCRG    BEGSR                           *** ZPMCRG ***
391900200604     C*
392000200604     C** DEFINE ALL FIELDS
392100200604     C                     Z-ADD*ZEROS    NCD     50
392200200604     C                     MOVE *BLANKS   DVBS    1
392300200604     C                     MOVE *BLANKS   DYBS    1
392400200604     C                     Z-ADD*ZEROS    MATY    50
392500200604     C                     Z-ADD*ZEROS    LCPN    50
392600200604     C                     Z-ADD*ZEROS    ITLD    50
392700200604     C*********************Z-ADD*ZEROS    IADJ    50
392800200604     C                     Z-ADD*ZEROS    WIADJ   50       **RENAMED 23/10/90**
392900200604     C***********          Z-ADDZAMT      ZAMT   150                      S01464
393000200604     C                     Z-ADDZAMT      ZAMT                            S01464
393100200604     C                     Z-ADDZDYBS     ZDYBS   10
393200200604     C                     Z-ADDZDVBS     ZDVBS   10
393300200604     C                     Z-ADDZFMDAT    ZFMDAT  50
393400200604     C                     Z-ADDZTODAT    ZTODAT  50
393500200604     C                     Z-ADDZSPRD     ZSPRD  130
393600200604     C                     MOVE ZSPRI     ZSPRI   1
393700200604     C                     MOVE ZCGBS     ZCGBS   1
393800200604     C                     MOVE ZCGMT     ZCGMT   1
393900200604     C                     Z-ADDZMINC     ZMINC  150
394000200604     C                     Z-ADD*ZEROS    ZCHGA  150
394100200604     C                     Z-ADD*ZEROS    ZZ      20
394200200604     C                     MOVEAZRA       ZRB
394300200604     C                     Z-ADD*HIVAL    ZRB,15
394400200604     C                     MOVE *BLANKS   ZFLAG   1
394500200604     C*
394600200604     C** DETERMINE THE NUMBER OF CHARGE DAYS
394700200604     C*
394800200604     C                     Z-ADDZFMDAT    ZSDATE
394900200604     C                     Z-ADDZTODAT    ZEDATE
395000200604     C                     MOVE ZDYBS     DYBS
395100200604     C** PROCESS SUB-ROUTINE
395200200604     C                     EXSR ZDAYS
395300200604     C*
395400200604     C                     Z-ADDZDDAYS    ZNOCD   50
395500200604     C*
395600200604     C** DETERMINE THE NUMBER OF DAYS IN THE CHARGE YEAR
395700200604     C*
395800200604     C                     Z-ADDZFMDAT    NCD
395900200604     C                     MOVE ZDVBS     DVBS
396000200604     C                     Z-ADDZTODAT    MATY
396100200604     C                     Z-ADD*ZEROS    LCPN
396200200604     C                     Z-ADD*ZEROS    ITLD
396300200604     C                     MOVE *BLANKS   CR
396400200604     C** PROCESS SUB-ROUTINE
396500200604     C                     EXSR ZDYYR
396600200604     C*
396700200604     C                     Z-ADDZINTDD    ZNOCY   50
396800200604     C*
396900200604     C** CHECK IF CHARGE BASIS (ZCGBS) IS 'F' (FLAT)
397000200604     C*
397100200604     C           ZCGBS     IFEQ 'F'                        - B1
397200200604     C*
397300200604     C** DO UNTIL FLAG IS 'Y'
397400200604     C*
397500200604     C           ZFLAG     DOUEQ'Y'                        - B2
397600200604     C                     ADD  1         ZZ
397700200604     C*
397800200604     C** CHECK INDEX
397900200604     C*
398000200604     C           ZZ        IFEQ 15                         - B3
398100200604     C                     MOVE 'Y'       ZFLAG
398200200604     C                     END                             - E3
398300200604     C*
398400200604     C** CHECK IF PRINCIPAL AMOUNT IS LESS EQUAL THAN RANGE UPPER LIMITS
398500200604     C*
398600200604     C           ZAMT      IFLE ZRB,ZZ                     - B3
398700200604     C                     MOVE 'Y'       ZFLAG
398800200604     C                     END                             - E3
398900200604     C*
399000200604     C** CHECK IF RANGE UPPER LIMITS IS ZERO
399100200604     C*
399200200604     C           ZRB,ZZ    IFEQ *ZEROS                     - B3
399300200604     C                     MOVE 'Y'       ZFLAG
399400200604     C                     END                             - E3
399500200604     C*
399600200604     C                     END                             - E2
399700200604     C*
399800200604     C** SET THE TOTAL CHARGE AMOUNT (ZCHGA) TO FLAT CHARGE AMOUNTS
399900200604     C*
400000200604     C                     Z-ADDZCG,ZZ    ZCHGA
400100200604     C*
400200200604     C** CHECK IF THE CHARGE SPREAD INDICATOR IS '+' OR '-'
400300200604     C*
400400200604     C           ZSPRI     IFEQ '+'                        - B2
400500200604     C                     ADD  ZSPRD     ZCHGA
400600200604     C                     ELSE                            - X2
400700200604     C                     SUB  ZSPRD     ZCHGA
400800200604     C                     END                             - E2
400900200604     C*
401000200604     C** MULTIPLY TOTAL CHARGE AMOUNT BY NUMBER OF CHARGE DAYS
401100200604     C*
401200200604     C           ZCHGA     MULT ZNOCD     ZCHGA
401300200604     C*
401400200604     C** DIVIDE TOTAL CHARGE AMOUNT BY NUMBER OF DAYS IN THE CHARGE YEAR
401500200604     C*
401600200604     C           ZCHGA     DIV  ZNOCY     ZCHGA     H
401700200604     C*
401800200604     C                     END                             - E1
401900200604     C*
402000200604     C** CHECK IF CHARGE BASIS (ZCGBS) IS 'P' (PERCENTAGE) AND THE CHARGING
402100200604     C** METHOD IS 'T' (THRESHOLD)
402200200604     C*
402300200604     C           ZCGBS     IFEQ 'P'                        - B1
402400200604     C           ZCGMT     ANDEQ'T'
402500200604     C*
402600200604     C** DO UNTIL FLAG IS 'Y'
402700200604     C*
402800200604     C           ZFLAG     DOUEQ'Y'                        - B2
402900200604     C                     ADD  1         ZZ
403000200604     C*
403100200604     C** CHECK INDEX
403200200604     C*
403300200604     C           ZZ        IFEQ 15                         - B3
403400200604     C                     MOVE 'Y'       ZFLAG
403500200604     C                     END                             - E3
403600200604     C*
403700200604     C** CHECK IF PRINCIPAL AMOUNT IS LESS EQUAL THAN RANGE UPPER LIMITS
403800200604     C*
403900200604     C           ZAMT      IFLE ZRB,ZZ                     - B3
404000200604     C                     MOVE 'Y'       ZFLAG
404100200604     C                     END                             - E3
404200200604     C*
404300200604     C** CHECK IF RANGE UPPER LIMITS IS ZERO
404400200604     C*
404500200604     C           ZRB,ZZ    IFEQ *ZEROS                     - B3
404600200604     C                     MOVE 'Y'       ZFLAG
404700200604     C                     END                             - E3
404800200604     C*
404900200604     C                     END                             - E2
405000200604     C*
405100200604     C** SET THE CHARGE RATE (ZCGRT) EQUAL TO PERCENTAGE
405200200604     C*
405300200604     C                     Z-ADDZPC,ZZ    ZCGRT  117
405400200604     C*
405500200604     C** MOVE THE EFFECTIVE CHARGE SPREAD (ZSPRD) INTO THE ADJUSTED
405600200604     C** CHARGE SPREAD (ZACSD)
405700200604     C*
405800200604     C                     MOVE ZSPRD     ZACSD  117
405900200604     C*
406000200604     C** CHECK IF THE CHARGE SPREAD INDICATOR IS '+' OR '-'
406100200604     C*
406200200604     C           ZSPRI     IFEQ '+'                        - B2
406300200604     C                     ADD  ZACSD     ZCGRT
406400200604     C                     ELSE                            - X2
406500200604     C                     SUB  ZACSD     ZCGRT
406600200604     C                     END                             - E2
406700200604     C*
406800200604     C** DIVIDE THE PRINCIPAL AMOUNT BY 100 AND PUT THE RESULT IN A WORK
406900200604     C** FIELD (ZZ152)
407000200604     C*
407100200604     C           ZAMT      DIV  100       ZZ152  152H
407200200604     C*
407300200604     C** MULTIPLY THIS WORK FIELD BY NUMBER OF CHARGE DAYS AND PUT THE
407400200604     C** RESULT IN A WORK FIELD (ZZ154)
407500200604     C*
407600200604     C           ZZ152     MULT ZNOCD     ZZ154  154
407700200604     C*
407800200604     C** DIVIDE TOTAL CHARGE AMOUNT BY NUMBER OF DAYS IN THE CHARGE YEAR
407900200604     C*
408000200604     C           ZZ154     DIV  ZNOCY     ZZ154     H
408100200604     C*
408200200604     C** MULTIPLY THIS WORK FIELD BY THE CHARGE RATE (ZCGRT)
408300200604     C*
408400200604     C           ZZ154     MULT ZCGRT     ZCHGA
408500200604     C*
408600200604     C           ZMINC     MULT ZNOCD     ZMINC
408700200604     C           ZMINC     DIV  ZNOCY     ZMINC     H
408800200604     C*
408900200604     C           ZCHGA     IFLT ZMINC
409000200604     C                     Z-ADDZMINC     ZCHGA
409100200604     C                     END
409200200604     C*
409300200604     C                     END                             - E1
409400200604     C*
409500200604     C** CHECK IF CHARGE BASIS (ZCGBS) IS 'P' (PERCENTAGE) AND THE CHARGING
409600200604     C** METHOD IS 'X' (TIERED)
409700200604     C*
409800200604     C           ZCGBS     IFEQ 'P'                        - B1
409900200604     C           ZCGMT     ANDEQ'X'
410000200604     C*
410100200604     C** DO UNTIL FLAG IS 'Y'
410200200604     C*
410300200604     C           ZFLAG     DOUEQ'Y'                        - B2
410400200604     C                     ADD  1         ZZ
410500200604     C*
410600200604     C** CHECK INDEX
410700200604     C*
410800200604     C           ZZ        IFEQ 15                         - B3
410900200604     C                     MOVE 'Y'       ZFLAG
411000200604     C                     END                             - E3
411100200604     C*
411200200604     C** CHECK IF PRINCIPAL AMOUNT IS LESS EQUAL THAN RANGE UPPER LIMITS
411300200604     C*
411400200604     C           ZAMT      IFLE ZRB,ZZ                     - B3
411500200604     C                     MOVE 'Y'       ZFLAG
411600200604     C                     END                             - E3
411700200604     C*
411800200604     C** CHECK IF RANGE UPPER LIMITS IS ZERO
411900200604     C*
412000200604     C           ZRB,ZZ    IFEQ *ZEROS                     - B3
412100200604     C                     MOVE 'Y'       ZFLAG
412200200604     C                     END                             - E3
412300200604     C*
412400200604     C** SET THE CHARGE RATE (ZCGRT) EQUAL TO PERCENTAGE
412500200604     C*
412600200604     C                     Z-ADDZPC,ZZ    ZCGRT
412700200604     C*
412800200604     C** MOVE THE EFFECTIVE CHARGE SPREAD (ZSPRD) INTO THE ADJUSTED
412900200604     C** CHARGE SPREAD (ZACSD)
413000200604     C*
413100200604     C                     MOVE ZSPRD     ZACSD
413200200604     C*
413300200604     C** CHECK IF THE CHARGE SPREAD INDICATOR IS '+' OR '-'
413400200604     C*
413500200604     C           ZSPRI     IFEQ '+'                        - B3
413600200604     C                     ADD  ZACSD     ZCGRT
413700200604     C                     ELSE                            - X3
413800200604     C                     SUB  ZACSD     ZCGRT
413900200604     C                     END                             - E3
414000200604     C*
414100200604     C** IF THE PRINCIPAL AMOUNT IS GREATER THAN RANGE UPPER LIMITS
414200200604     C*
414300200604     C           ZAMT      IFGT ZRB,ZZ                     - B3
414400200604     C           ZRB,ZZ    ANDNE*ZEROS
414500200604     C*
414600200604     C** CHECK THE INDEX
414700200604     C*
414800200604     C           ZZ        IFEQ 1                          - B4
414900200604     C*
415000200604     C** IF INDEX IS 1 PUT THE RANGE UPPER LIMITS IN A WORK FIELD ZZ152
415100200604     C*
415200200604     C                     Z-ADDZRB,ZZ    ZZ152  152
415300200604     C*
415400200604     C                     ELSE                            - X4
415500200604     C*
415600200604     C** OTHERWISE CALCULATE THE DIFFERENCE BETWEEN THE TWO LIMITS
415700200604     C*
415800200604     C           ZZ        SUB  1         Z2      20
415900200604     C           ZRB,ZZ    SUB  ZRB,Z2    ZZ152
416000200604     C                     END                             - E4
416100200604     C*
416200200604     C                     ELSE                            - X3
416300200604     C*
416400200604     C** IF THE PRINCIPAL AMOUNT IS LESS OR EQUAL THAN RANGE UPPER LIMITS
416500200604     C*
416600200604     C*
416700200604     C** CHECK THE INDEX
416800200604     C*
416900200604     C           ZZ        IFEQ 1                          - B4
417000200604     C*
417100200604     C** IF INDEX IS 1 PUT THE RANGE UPPER LIMITS IN A WORK FIELD ZZ152
417200200604     C*
417300200604     C                     Z-ADDZAMT      ZZ152
417400200604     C*
417500200604     C                     ELSE                            - X4
417600200604     C*
417700200604     C** OTHERWISE CALCULATE THE DIFFERENCE BETWEEN THE TWO LIMITS
417800200604     C*
417900200604     C           ZZ        SUB  1         Z2      20
418000200604     C           ZAMT      SUB  ZRB,Z2    ZZ152
418100200604     C                     END                             - E4
418200200604     C*
418300200604     C                     END                             - E3
418400200604     C*
418500200604     C** DIVIDE ZZ152 BY 100
418600200604     C*
418700200604     C           ZZ152     DIV  100       ZZ152     H
418800200604     C*
418900200604     C** MULTIPLY ZZ152 BY THE NUMBER OF CHARGE DAYS AND PUT THE RESULT
419000200604     C** IN A WORK FIELD (ZZ154)
419100200604     C*
419200200604     C           ZZ152     MULT ZNOCD     ZZ154  154
419300200604     C*
419400200604     C** DIVIDE THIS WORK FIELD (ZZ154) BY THE NUMBER OF DAYS IN THE
419500200604     C** CHARGE YEAR (ZNOCY)
419600200604     C*
419700200604     C           ZZ154     DIV  ZNOCY     ZZ154     H
419800200604     C*
419900200604     C**MULTIPLY THIS WORK FIELD ZZ154 BY THE CHARGE RATE (ZCGRT)
420000200604     C*
420100200604     C           ZZ154     MULT ZCGRT     ZZ154
420200200604     C*
420300200604     C** ADD THIS WORK FIELD ZZ154 TO THE TOTAL CHARGE AMOUNT (ZCHGA)
420400200604     C*
420500200604     C                     ADD  ZZ154     ZCHGA
420600200604     C*
420700200604     C           ZMINC     MULT ZNOCD     ZMINC
420800200604     C           ZMINC     DIV  ZNOCY     ZMINC     H
420900200604     C*
421000200604     C           ZCHGA     IFLT ZMINC
421100200604     C                     Z-ADDZMINC     ZCHGA
421200200604     C                     END
421300200604     C*
421400200604     C                     END                             - E2
421500200604     C*
421600200604     C                     END                             - E1
421700200604     C*
421800200604     C                     ENDSR                           ** ZPMCRG ESR**
421900200604     C********************************************************************
422000200604     C********************************************************************
422100200604     C/EJECT
422200200604     C********************************************************************
422300200604     C*/COPY ZSRSRC,ZSEDITZ3
422400200604     C********************************************************************
422500200604     C********************************************************************
422600200604     C**                                                                 *
422700200604     C** ZSEDIT subroutine to insert a decimal point and sign into a     *
422800200604     C** numeric field and to blank out leading zeros (optionaly         *
422900200604     C** inserting commas).                                              *
423000200604     C**     Input fields:   ZFLD15 15/0                                 *
423100200604     C**                     ZDECS  1/0                                  *
423200200604     C**                     ZECODE 1/  ('J', 'L' or blank)              *
423300200604     C**                                                                 *
423400200604     C**     Arrays:         ZS1    15/1/0                               *
423500200604     C**                     ZS2    21/1/                                *
423600200604     C**                                                                 *
423700200604     C**     Output fields:  ZOUT21 21                                   *
423800200604     C**                                                                 *
423900200604     CSR         ZSEDIT    BEGSR                           **  ZSEDIT   *
424000200604     C*
424100200604     C* Define/Clear fields
424200200604     C*
424300200604     C                     Z-ADDZFLD15    ZFLD15 150
424400200604     C                     Z-ADDZDECS     ZDECS   10
424500200604     C                     MOVE ZECODE    ZECODE  1
424600200604     C                     MOVE *BLANKS   ZOUT21 21
424700200604     C*
424800200604     C*       SET UP WORK FIELDS
424900200604     C*
425000200604     C                     Z-ADD0         ZS1
425100200604     C                     MOVE ' '       ZS2
425200200604     C*
425300200604     C                     Z-ADD15        Z1      20
425400200604     C                     Z-ADD20        Z2      20
425500200604     C*
425600200604     C           15        SUB  ZDECS     ZINTS   20
425700200604     C*
425800200604     C* Check if numeric field is negative
425900200604     C*
426000200604     C           ZFLD15    IFLT *ZEROS
426100200604     C                     MOVE '-'       ZS2,21
426200200604     C                     Z-SUBZFLD15    ZFLD15
426300200604     C                     END
426400200604     C*
426500200604     C                     Z-ADDZFLD15    WORK15
426600200604     C*
426700200604     C*       CHECK TO SEE IF THERE ARE ANY DECIMAL PLACES
426800200604     C*
426900200604     C           ZDECS     CABEQ0         ZS10
427000200604     C*
427100200604     C*       SET UP DECIMALS
427200200604     C*
427300200604     C                     Z-ADD*ZEROS    ZCNT    10
427400200604     C           ZCNT      DOUEQZDECS
427500200604     C                     MOVE ZS1,Z1    ZS2,Z2
427600200604     C                     SUB  1         Z2
427700200604     C                     ADD  1         ZCNT
427800200604     C                     SUB  1         Z1
427900200604     C                     END
428000200604     C*
428100200604     C*       PUT IN DECIMAL PLACE
428200200604     C*
428300200604     C                     MOVE '.'       ZS2,Z2
428400200604     C                     SUB  1         Z2
428500200604     C*
428600200604     C           ZS10      TAG                             ** ZS10 TAG **
428700200604     C*
428800200604     C*       SET UP INTEGERS
428900200604     C*
429000200604     C                     Z-ADD*ZEROS    CNT3    10
429100200604     C           Z1        DOUEQ*ZEROS
429200200604     C                     MOVE ZS1,Z1    ZS2,Z2
429300200604     C                     SUB  1         Z1
429400200604     C                     SUB  1         Z2
429500200604     C*
429600200604     C* If edit code is 'J', insert a ',' before each group of three
429700200604     C* digits - not if beginning of array reached.
429800200604     C*
429900200604     C           Z2        IFGT *ZEROS
430000200604     C           ZECODE    ANDEQ'J'
430100200604     C                     ADD  1         CNT3
430200200604     C           CNT3      IFEQ 3
430300200604     C                     MOVE ','       ZS2,Z2
430400200604     C                     SUB  1         Z2
430500200604     C                     Z-ADD*ZEROS    CNT3
430600200604     C                     END
430700200604     C                     END
430800200604     C*
430900200604     C                     END
431000200604     C*
431100200604     C*       PUT IN LEADING BLANKS
431200200604     C*
431300200604     C                     Z-ADD1         Z2
431400200604     C           ZS2,Z2    DOWEQ'0'
431500200604     C           ZS2,Z2    OREQ ' '
431600200604     C           ZS2,Z2    OREQ ','
431700200604     C                     MOVE ' '       ZS2,Z2
431800200604     C                     ADD  1         Z2
431900200604     C           Z2        CABEQ22        ZS20
432000200604     C                     END
432100200604     C*
432200200604     C*       IF NO INTEGERS PUT IN LEADING ZERO
432300200604     C*
432400200604     C           ZS20      TAG                             ** ZS20 TAG **
432500200604     C*
432600200604     C           Z2        IFEQ 22
432700200604     C                     SUB  2         Z2
432800200604     C                     MOVE '0'       ZS2,Z2
432900200604     C                     ELSE
433000200604     C*
433100200604     C           ZS2,Z2    IFEQ '.'
433200200604     C                     SUB  1         Z2
433300200604     C                     MOVE '0'       ZS2,Z2
433400200604     C                     END
433500200604     C                     END
433600200604     C*
433700200604     C*       SET UP OUTPUT FIELD
433800200604     C*
433900200604     C                     MOVEAZS2       ZOUT21
434000200604     C*
434100200604     CSR                   ENDSR
434200200604     C*****************************************************************
434300200604     C********************************************************************
434400200604     C/EJECT
434500200604     C********************************************************************
434600200604     C*/COPY ZSRSRC,ZAPNUM
434700200604     C**************************************************************************
434800200604     C*                                                                        *
434900200604     C*  ZAPNUM - CALCULATE AP NUMERATOR                                       *
435000200604     C*                                                                        *
435100200604     C*  PURPOSE : TO MULTIPLY A NOMINAL POSITION BY THE PRICE OF THE          *
435200200604     C*  POSITION TO GIVE A VALUE OF THE POSITION WITH THE CORRECT NUMBER      *
435300200604     C*  OF DECIMAL PLACES FOR THE NOMINAL CURRENCY                            *
435400200604     C*                                                                        *
435500200604     C*  INPUT  FIELDS                                                         *
435600200604     C********ZNOML**11*0*****NOMINAL**********************************   S01464
435700200604     C*       ZNOML  15 0     Nominal                                 *   S01464
435800200604     C*       ZAVPR  15 8     AVERAGE PRICE                                    *
435900200604     C*       ZNMDP   1 0     NOMINAL DECIMAL PLACES (0-4)                     *
436000200604     C*       ZNMCD   1 0     NOMINAL CURRENCY DECIMAL PLACES (0-3)            *
436100200604     C*       ZPRCB   1 A     PRICE BASIS (P/U)                                *
436200200604     C*                                                                        *
436300200604     C*  OUTPUT  FIELDS                                                        *
436400200604     C*       ZVALU  15 0     VALUE                                            *
436500200604     C*                                                                        *
436600200604     C*  ALSO REQUIRED                                                         *
436700200604     C*       POWER8 ARRAY OF MULTIPLYING FACTORS FOR NOMINAL DECIMAL PLACES   *
436800200604     C*                                                                        *
436900200604     C*  WORK FIELDS:                                                          *
437000200604     C*       ZVAL0  15 0 - AVERAGE PRICE WITH 0 DECIMAL PLACES                *
437100200604     C*       ZVAL1  15 1 - --------------- '' ----------------                *
437200200604     C*       ZVAL2  15 2 - --------------- '' ----------------                *
437300200604     C*       ZVAL3  15 3 - --------------- '' ----------------                *
437400200604     C*       ZI      1 0 - POWER ARRAY                                        *
437500200604     C*                                                                        *
437600200604     C*  CALLED FROM:                                                          *
437700200604     C*                                                                        *
437800200604     C*************************************************************************
437900200604     C           ZAPNUM    BEGSR                           *** ZAPNUM ***
438000200604     C*
438100200604     C** DEFINE ALL FIELDS
438200200604     C***********          Z-ADDZNOML     ZNOML  110                      S01464
438300200604     C                     Z-ADDZNOML     ZNOML                           S01464
438400200604     C                     Z-ADDZAVPR     ZAVPR  158
438500200604     C                     Z-ADDZNMDP     ZNMDP   10
438600200604     C                     Z-ADDZNMCD     ZNMCD   10
438700200604     C                     MOVE ZPRCB     ZPRCB   1
438800200604     C                     Z-ADDZVALU     ZVALU  150
438900200604     C*
439000200604     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 0
439100200604     C           ZNMCD     IFEQ 0
439200200604     C           ZNOML     MULT ZAVPR     ZVAL0  150H
439300200604     C                     MOVE ZVAL0     ZVALU
439400200604     C                     END
439500200604     C*
439600200604     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 1
439700200604     C           ZNMCD     IFEQ 1
439800200604     C           ZNOML     MULT ZAVPR     ZVAL1  151H
439900200604     C                     MOVE ZVAL1     ZVALU
440000200604     C                     END
440100200604     C*
440200200604     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 2
440300200604     C           ZNMCD     IFEQ 2
440400200604     C           ZNOML     MULT ZAVPR     ZVAL2  152H
440500200604     C                     MOVE ZVAL2     ZVALU
440600200604     C                     END
440700200604     C*
440800200604     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 3
440900200604     C           ZNMCD     IFEQ 3
441000200604     C           ZNOML     MULT ZAVPR     ZVAL3  153H
441100200604     C                     MOVE ZVAL3     ZVALU
441200200604     C                     END
441300200604     C*
441400200604     C** SET INDEX ZI EQUAL TO 5 -. NOMINAL DECIMAL PLACES )
441500200604     C           5         SUB  ZNMDP     ZI      10
441600200604     C*
441700200604     C** MULTIPLY ZVALU BY  POWER8,ZI TO GET AMOUNT WITH NOMINAL DECIMAL PLACES
441800200604     C           ZVALU     MULT POWER8,ZI ZVALU
441900200604     C*
442000200604     C** PRICE BASIS IF = PERCENTAGE
442100200604     C           ZPRCB     IFEQ 'P'
442200200604     C           ZVALU     DIV  100       ZVALU     H
442300200604     C                     END
442400200604     C*
442500200604     C                     ENDSR
442600200604     C*************************************************************************
442700200604     C********************************************************************
442800200604     C/EJECT
442900200604     C/COPY ZSRSRC,ZDAYSZ2                                                100125
443000200604     C/EJECT                                                              100125
443100200604     C/COPY ZSRSRC,ZDYYRZ3                                                100125
443200200604     C/EJECT                                                              100125
443300200604     C/COPY ZSRSRC,ZDATE1Z2                                               100125
443400200604     C/EJECT                                                              100125
443500200604     C/COPY ZSRSRC,ZDATE2Z2                                               100125
443600200604     C/EJECT                                                              100125
443700200604     C********************************************************************
443800200604     C**==================================================================S01464
443900200604     C**  ZLCRD      :       TO COMPUTE LAST ACCRUAL DATE BASED ON        S01464
444000200604     C**                     CURRENT ACCRUAL DATE AND ACCRUAL FREQUENCY   S01464
444100200604      ** CALLED FROM :       #INIT                                        S01464
444200200604      ** CALLS       :       ZDATE2                                       S01464
444300200604     C*===================================================================S01464
444400200604     C           ZLCRD     BEGSR                           *** ZLCRD ***  S01464
444500200604     C**                                                                  S01464
444600200604     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.                           S01464
444700200604     C                     MOVE FBAFRQ    ZFREQ   1                       S01464
444800200604     C                     Z-ADDFBCCRD    ZDAYNO  50                      S01464
444900200604     C                     Z-ADDFBADYM    ZMDAY   20                      S01464
445000200604     C**                                                                  S01464
445100200604     C**   CONVERT DAY NUMBER TO DATE.                                    S01464
445200200604     C                     EXSR ZDATE2                                    S01464
445300200604      *                                                                   S01464
445400200604      ** If the day number input (zmday ) is zero set it equal to the     S01464
445500200604      ** day number of the current accrual date.                          S01464
445600200604      *                                                                   S01464
445700200604     C           ZMDAY     IFEQ 0                                         S01464
445800200604     C*                                                                   S01464
445900200604     C                     MOVELZADATE    ZZWRK2  2                       S01464
446000200604     C                     MOVE ZZWRK2    ZMDAY                           S01464
446100200604     C*                                                                   S01464
446200200604     C                     END                                            S01464
446300200604     C**                                                                  S01464
446400200604     C/COPY WNCPYSRC,SE6240C025
446500200604     C**   CHECK FOR AND DECREMENT FOR CODE W-WEEKLY.                     S01464
446600200604     C           ZFREQ     IFEQ 'W'                                       S01464
446700200604     C           ZDAYNO    SUB  7         ZDAYNO                          S01464
446800200604     C                     GOTO ZLEND                                     S01464
446900200604     C                     END                                            S01464
447000200604     C**                                                                  S01464
447100200604     C**   CHECK FOR AND DECREMENT FOR CODE M-MONTHLY.                    S01464
447200200604     C           ZFREQ     IFEQ 'M'                                       S01464
447300200604     C                     Z-ADDZMDAY     ZDAY                            S01464
447400200604     C           ZMTH      SUB  1         ZMTH         9090               S01464
447500200604     C   90      12        ADD  ZMTH      ZMTH                            S01464
447600200604     C   90      ZYEAR     SUB  1         ZYEAR                           S01464
447700200604     C                     END                                            S01464
447800200604     C**                                                                  S01464
447900200604     C**   CHECK FOR AND DECREMENT FOR CODE Q-QUARTERLY.                  S01464
448000200604     C           ZFREQ     IFEQ 'Q'                                       S01464
448100200604     C                     Z-ADDZMDAY     ZDAY                            S01464
448200200604     C           ZMTH      SUB  3         ZMTH         9090               S01464
448300200604     C   90      12        ADD  ZMTH      ZMTH                            S01464
448400200604     C   90      ZYEAR     SUB  1         ZYEAR                           S01464
448500200604     C                     END                                            S01464
448600200604     C**                                                                  S01464
448700200604     C**   CHECK FOR AND DECREMENT FOR CODE X-SIX MONTHLY.                S01464
448800200604     C           ZFREQ     IFEQ 'X'                                       S01464
448900200604     C                     Z-ADDZMDAY     ZDAY                            S01464
449000200604     C           ZMTH      SUB  6         ZMTH         9090               S01464
449100200604     C   90      12        ADD  ZMTH      ZMTH                            S01464
449200200604     C   90      ZYEAR     SUB  1         ZYEAR                           S01464
449300200604     C                     END                                            S01464
449400200604     C**                                                                  S01464
449500200604     C**   CHECK FOR AND DECREMENT FOR CODE Y-YEARLY.                     S01464
449600200604     C           ZFREQ     IFEQ 'Y'                                       S01464
449700200604     C                     Z-ADDZMDAY     ZDAY                            S01464
449800200604     C           ZYEAR     SUB  1         ZYEAR                           S01464
449900200604     C                     END                                            S01464
450000200604     C**                                                                  S01464
450100200604     C**   REFORMAT DATE AND ENSURE VALID.                                S01464
450200200604     C**
450300200604     C**   CHECK FOR LEAP YEAR.
450400200604     C           ZYEAR     DIV  4         ZLYR    20
450500200604     C                     MVR            ZLY     10
450600200604     C**                                                                  S01464
450700200604     C**   VALIDATE DAY NUMBER.                                           S01464
450800200604     C                     MOVE ZFMD,ZMTH ZWRK2   20                      S01464
450900200604     C           ZMTH      IFEQ 2                                         S01464
451000200604     C           ZLY       ANDEQ0                                         S01464
451100200604     C           ZDAY      ANDGT29                                        S01464
451200200604     C                     Z-ADD29        ZWRK2                           S01464
451300200604     C                     END
451400200604     C**
451500200604     C           ZDAY      IFGT ZWRK2
451600200604     C                     Z-ADDZWRK2     ZDAY
451700200604     C                     END
451800200604     C**
451900200604     C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
452000200604     C                     MOVELZDAY      ZWRK4   40
452100200604     C                     MOVE ZMTH      ZWRK4
452200200604     C   98                MOVELZMTH      ZWRK4
452300200604     C   98                MOVE ZDAY      ZWRK4
452400200604     C                     MOVELZWRK4     ZDATE
452500200604     C                     MOVE ZYEAR     ZDATE
452600200604     C                     EXSR ZDATE1
452700200604     C**
452800200604     C           ZLEND     ENDSR                           * ZFEND ENDSR *
452900200604      /EJECT
453000200604     C**========================================================================
453100200604     C**  ZTNLU1     :       TO LOCK THE TRANSACTION NUMBER DATA AREA,
453200200604     C**                     ACCESS THE NEXT AVAILABLE TRANSACTION NUMBER,
453300200604     C**                     THEN UPDATE AND RELEASE THE DATA AREA.
453400200604      ** CALLED FROM :       #P1005
453500200604      ** CALLS       :
453600200604     C*=========================================================================
453700200604     C           ZTNLU1    BEGSR                            ** ZTNLU1 BSR**
453800200604     C*
453900200604     C           *NAMVAR   DEFN MNATN     DNATN
454000200604     C           *LOCK     IN   DNATN
454100200604     C                     MOVE FNATN     NATN    50
454200200604     C                     MOVE FNATN     ZZWK05  50
454300200604     C                     ADD  1         ZZWK05
454400200604     C                     MOVE ZZWK05    FNATN
454500200604     C                     OUT  DNATN
454600200604     C*
454700200604     C                     ENDSR                            ** ZTNLU1 ESR**
454800200604     C**
454900200604     C********************************************************************
455000200604     C/EJECT
455100200604     C********************************************************************
455200200604     C*                                                                   B05945
455300200604     C*  ZPRCI - SUBROUTINE TO OUTPUT PRICE AS %PRICE                     B05945
455400200604     C*                                                                   B05945
455500200604     C*  INPUT  - ZPRCIN (15,8) PRICE IN AS PRICE/DISC/YIELD              B05945
455600200604     C*           ZFDATE (5,0) FROM DATE                                  B05945
455700200604     C*           STBS (1) TRADE BASIS FROM SECURITY                      B05945
455800200604     C*           MATY (5,0) MATURITY DATE FROM SECURITY                  B05945
455900200604     C*           SYBS (1) YIELD BASIS FROM SECURITY                      B05945
456000200604     C*                                                                   B05945
456100200604     C*  OUTPUT - ZPRCOT (15,8) OUTPUT PRICE AS PERCENTAGE                B05945
456200200604     C*                                                                   B05945
456300200604     C*  CALLS  - ZDAYS (ZDATE2)                                          B05945
456400200604     C*           ZDYYR (ZDAYS)                                           B05945
456500200604     C*           ZYLDI                                                   B05945
456600200604     C*                                                                   B05945
456700200604     C******************************************************************  B05945
456800200604     C*                                                                   B05945
456900200604      /EJECT                                                              B05945
457000200604     C/COPY ZSRSRC,ZPRCIZ1                                                B05945
457100200604     C*****************************************************************   B05945
457200200604     C*                                                                   B05945
457300200604     C*  ZYLDI - SUBROUTINE TO OUTPUT YIELD AS PERCENTAGE PRICE           B05945
457400200604     C*                                                                   B05945
457500200604     C*  INPUT  - ZPRCIN (15,8) INPUT PRICE AS YIELD                      B05945
457600200604     C*                                                                   B05945
457700200604     C*  OUTPUT - ZYLDOT (15,8) PRICE AS PERCENTAGE                       B05945
457800200604     C*                                                                   B05945
457900200604     C*****************************************************************   B05945
458000200604     C*                                                                   B05945
458100200604      /EJECT                                                              B05945
458200200604     C/COPY ZSRSRC,ZYLDIZ1                                                B05945
458300200604     C*                                                                   B05945
458400200604     C/COPY ZSRSRC,ZYLDZ2                                                 B05945
458500200604     C*                                                                   B05945
458600200604     C********************************************************************
458700200604     C*    SUBROUTINE- ZNCD
458800200604     C*    DETERMINE NEXT COUPON DATE
458900200604     C*
459000200604     C**
459100200604     C**  INPUT - CD ARRAY - COUPON DATES - SECTYD SECURITY FILE
459200200604     C**          CR ARRAY - RATE/PAYT INDICS - SECTYD SECURITY FILE
459300200604     C**          FCPN - FIRST COUPON DATE - SECTYD SECURITY FILE
459400200604     C**          MATY - MATURITY DATE - SECTYD SECURITY FILE
459500200604     C**          ECD - EVENT CONTROL DTAE - ZEVCD PROCESS
459600200604     C**          *IN98 - DATE FORMAT - FROM TABTB10 RECORD VIA ZSYSTM
459700200604     C**
459800200604     C**  OUTPUT - NCD (5,0) - NEXT COUPON DATE
459900200604     C**
460000200604     C**  CALLS  - ZDATE2
460100200604     C*
460200200604     C********************************************************************
460300200604     C*
460400200604     C/COPY ZSRSRC,ZNCDZ3
460500200604     C*****************************************************************   E20380
460600200604     C**                                                             **   E20380
460700200604     C** ZLCD   - Subroutine to calculate the Last Coupon Date prior **   E20380
460800200604     C**          to an Event Control Date (For Example: the Value   **   E20380
460900200604     C**          Date of a Trade).                                  **   E20380
461000200604     C**                                                             **   E20380
461100200604     C** INPUT - CD ARRAY - Coupon Dates from PF/SECTYD              **   E20380
461200200604     C**         CR ARRAY - Rate/Payment indicators from PF/SECTYD   **   E20380
461300200604     C**         ITLD   (5,0) Initial Date from PF/SECTYD            **   E20380
461400200604     C**         FCPN   (5,0) First Coupon Date from PF/SECTYD       **   E20380
461500200604     C**         ZECD   (5,0) Event Control Date                     **   E20380
461600200604     C**         *IN98        Date Format from PF/TABTB10            **   E20380
461700200604     C**                                                             **   E20380
461800200604     C** OUTPUT - ZZLCD (5,0) Last Coupon Date before Control Date   **   E20380
461900200604     C**                                                             **   E20380
462000200604     C** CALLS  - ZDATE1                                             **   E20380
462100200604     C**          ZDATE2                                             **   E20380
462200200604     C********************************************************************E20380
462300200604     C/EJECT                                                              E20380
462400200604     C/COPY ZSRSRC,ZLCDZ1                                                 E20380
462500200604     C/EJECT                                                              E20380
462600200604     C/COPY ZSRSRC,ZCCYCN                                                 E20380
462700200604     C****/EJECT                                                    47719 E20380
462800200604     C****/COPY ZSRSRC,ZCCYXR                                       47719 E20380
462900200604     C**                                                                  S01158
463000200604     C*
463100200604     C/EJECT                                                              S01464
463200200604     C/COPY ZSRSRC,ZACCRZ1                                                S01464
463300200604     C/EJECT                                                              S01464
463400200604     C/COPY ZSRSRC,ZACCZZ1                                                S01464
463500200604     C/EJECT                                                              S01464
463600200604     C/COPY ZSRSRC,ZCALCD                                                 S01464
463700200604     C/EJECT                                                              S01464
463800200604     C/COPY ZSRSRC,ZCNSDZ1                                                S01464
463900200604     C/EJECT                                                              S01464
464000200604     C/COPY ZSRSRC,ZRATEZ1                                                S01464
464100200604     C/COPY WNCPYSRC,SE6240C031
464200200604     C*                                                                   S01464
464300200604     C/EJECT                                                              179044
464400200604      *****************************************************************   179044
464500200604      *                                                               *   179044
464600200604      * SRPNAR - Subroutine to determine required posting narratives  *   179044
464700200604      *                                                               *   179044
464800200604      * Called by: #P10                                               *   179044
464900200604      *                                                               *   179044
465000200604      * Calls: *PSSR                                                  *   179044
465100200604      *                                                               *   179044
465200200604      *****************************************************************   179044
465300200604      *                                                                   179044
465400200604     C           SRPNAR    BEGSR                                          179044
465500200604      *                                                                   179044
465600200604      ** Define the data structure parameter                              179044
465700200604      *                                                                   179044
465800200604     C           *LIKE     DEFN MNCRNM    ##CRNM                          179044
465900200604     C           *LIKE     DEFN CGPNAR    ##PNAR                          179044
466000200604      *                                                                   179044
466100200604     C                     CLEARCGPNAR                                    179044
466200200604     C                     CLEAR##PRM1                                    179044
466300200604      *                                                                   179044
466400200604      ** If the facility is switched off or unavailable,                  179044
466500200604      ** or UDC is not installed, exit this subroutine                    179044
466600200604      *                                                                   179044
466700200604     C           SEPNAR    IFNE 'Y'                                       179044
466800200604     C                     GOTO EXPNAR                                    179044
466900200604     C                     ENDIF                                          179044
467000200604      *                                                                   179044
467100200604      ** Determine the value for the narrative using AOPNARR0             179044
467200200604      *                                                                   179044
467300200604     C                     MOVE 'SE'      MNMODI                          179044
467400200604     C                     MOVE CNUM      MNCUST                          179044
467500200604     C                     MOVE CCY       MNCYCD                          179044
467600200604     C                     MOVE ACOD      MNACCD                          179044
467700200604     C                     MOVE ACSQ      MNACSQ                          179044
467800200604     C                     MOVE BRCA      MNBRCA                          179044
467900200604     C                     MOVE BOKC      MNBOKC                          179044
468000200604     C                     MOVE ##CRNM    MNCRNM                          179044
468100200604     C                     MOVELPNAR      MNNARR    P                     179044
468200200604     C                     MOVE ASOC      MNASOC                          179044
468300200604     C                     MOVE ACNO      MNRACN                          179044
468400200604     C                     MOVE OTRF      MNTRNO                          179044
468500200604      *                                                                   179044
468600200604     C                     CALL 'AOPNARR0'                                179044
468700200604     C                     PARM           ##RTN   7                       179044
468800200604     C                     PARM           ##MGID  7                       179044
468900200604     C                     PARM           ##PRM1                          179044
469000200604     C           CGPNAR    PARM CGPNAR    ##PNAR                          179044
469100200604     C                     PARM           ##NARR 50                       179044
469200200604      *                                                                   179044
469300200604     C           ##RTN     IFNE *BLANKS                                   179044
469400200604     C                     MOVEL'CGPNARPD'DBFILE             *************179044
469500200604     C                     Z-ADD14        DBASE              * DBERR 014 *179044
469600200604     C                     MOVELMNCUST    DBKEY              *************179044
469700200604     C                     EXSR *PSSR                                     179044
469800200604     C                     SETON                     U7U8                 179044
469900200604     C                     ENDIF                                          179044
470000200604      *                                                                   179044
470100200604     C                     MOVEL##NARR    PNAR      P                     179044
470200200604      *                                                                   179044
470300200604     C           EXPNAR    TAG                                            179044
470400200604     C*                                                                   179044
470500200604     C                     ENDSR                                          179044
470600200604     C********************************************************************
470700200604**  CPY@
470800200604(c) Finastra International Limited 2001
470900200604**   ZF29 DAY NOS OF FEB 29 TO 2096 (INCLUDING 2000)
4710002006040006001521029820444305904073650882610287117481320914670161311759219053
4711002006042051421975234362489726358278192928030741322023366335124365853804639507
47120020060440968424294389045351
471300200604**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
4714002006040366073110961461
471500200604**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
471600200604000031059090120151181212243273304334365
471700200604**   ZMNM - MONTHS SHORT NAMES
471800200604JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
471900200604**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
4720002006040000001
4721002006040000010
4722002006040000100
4723002006040001000
4724002006040010000
4725002006040100000
4726002006041000000
472700200604**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
47280020060400000001
47290020060400000010
47300020060400000100
47310020060400001000
47320020060400010000
47330020060400100000
47340020060401000000
47350020060410000000
473600200604**  PNARR
473700200604CUSTODY FEE FOR
473800200604**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
473900200604312831303130313130313031
