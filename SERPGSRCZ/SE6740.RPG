000100200616     H        1
000200200616     F*****************************************************************
000300200616/*STD *  RPGBASE                                                      *
000400200616/*EXI *  TEXT('Midas SE ER gen. trades and depot movements')
000500200616     F*****************************************************************
000600200616     F*                                                               *
000700200616     F*  Midas - Securities Trading Module                            *
000800200616     F*                                                               *
000900200616     F*  SE6740 - SE ER Generates Trades and Depot Movements          *
001000200616     F*                                                               *
001100200616      *  (c) Finastra International Limited 2001                      *
001200200616     F*                                                               *
001201200616      *  Last Amend No. AR324886           Date 01JUN20               *
001300200616      *  PREV Amend No. MD046248           Date 27Oct17               *
001400200616      * Bank Fusion Midas 1.4 Base -----------------------------------*
001500200616      * Midas Plus 1.4 Base 04 ---------------------------------------*
001600200616      * Midas Plus 1.4 Base ------------------------------------------*
001700200616      * Midas Plus 1.3 ----------- Base ------------------------------*
001800200616      *                 234300             Date 29Sep06               *
001900200616      *                 CSD031             Date 10Apr06               *
002000200616      *                 CSD027A            Date 06May06               *
002100200616      *                 CSD027             Date 09Dec05               *
002200200616      *                 235041             Date 20Jul05
002300200616      *                 234829             Date 08Jul05               *
002400200616      *                 CSE071             Date 19Jul05               *
002500200616      *                 CSW037A            Date 02May05               *
002600200616      *                 220225             Date 13Aug03               *
002700200616      *                 220441             Date 07MAY03               *
002800200616      *                 CSD025             Date 11Jan05               *
002900200616      *                 CSW037             Date 15Dec04               *
003000200616      *                 CSW036             Date 15Dec04               *
003100200616      *                 CLE025             Date 20Oct03               *
003200200616      *                 CGL029             Date 01Sep03               *
003300200616      *                 222727             Date 05Nov03               *
003400200616      *                 CAS006             Date 21Jan03               *
003500200616      *                 CSE040             Date 13May03               *
003600200616      *                 CSE039             Date 24Apr03               *
003700200616      * Midas Release 4.01.01 ----------------------------------------*
003800200616      *                 207006             Date 18Jun02               *
003900200616      * Midas Release 4.01 -------------------------------------------*
004000200616      *                 CPK015             Date 01Jul02               *
004100200616      * Midas Release 4 --------------- Base -------------------------*
004200200616      * Midas DBA 3.04 -----------------------------------------------*
004300200616      *                 CSE023             Date 12Jul00               *
004400200616      * Midas DBA 3.02 -----------------------------------------------*
004500200616      *                 CSE015             Date 06Dec99               *
004600200616      *                 CSE017             Date 20Oct99               *
004700200616      *                 CSE012             Date 17Aug99               *
004800200616      *                 CPB001             Date 01Jun99               *
004900200616      * Midas DBA 3.00 ---------------- Base -------------------------*
005000200616      *                 CAC005             Date 23Nov98               *
005100200616      *                 CAP003             Date 30Jul98               *
005200200616      *                 092665             Date 24Feb98               *
005300200616     F*                 094702             DATE 25OCT95               *
005400200616     F*                 094693             DATE 18OCT95               *
005500200616     F*                 S01496             DATE 03OCT94               *
005600200616     F*                 64747              DATE 24DEC93               *
005700200616     F*                 S10978             DATE 03MAY93               *
005800200616     F*                                                               *
005900200616     F*---------------------------------------------------------------*
006000200616     F*                                                               *
006001200616      *  AR324886 - Implement 4-eyes processing in Position           *
006002200616      *             Settlement Maintenance.                           *
006100200616      *  MD046248 - Finastra Rebranding                               *
006200200616      *  234300 - Recompiled over changed in PF/HSTTRD.               *
006300200616      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
006400200616      *  CSD027A - Conversion Of Customer Number to Alpha             *
006500200616      *  CSD027 - Conversion Of Customer Number to Alpha              *
006600200616      *  235041 - Beneficiary is blank on DPTMVD                      *
006700200616      *  234829 - Add ETCPOS coding for EU Tax                        *
006800200616      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
006900200616      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
007000200616      *  220225 - No front office ID for early redemption.            *
007100200616      *           Field updated due to CHAIN                          *
007200200616      *  220441 - Set trade date of the depot movement equal to value *
007300200616      *  CSD025 - Customer De-Activation                              *
007400200616      *  CSW037 - Additional Field Data on MT300/MT320                *
007500200616      *  CSW036 - Dual SWIFT BIC held on Client Details               *
007600200616      *  CLE025 - Credit Lines (Recompile)                            *
007700200616      *  CGL029 - Increase Account Code to 10 digits                  *
007800200616      *  222727 - Release 5.0 errors  (Recompile)                     *
007900200616      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
008000200616      *  CSE040 - Security Statement Production                       *
008100200616      *  CSE039 - Automatic Settlment of Trades - write to Movement   *
008200200616      *           Status file                                         *
008300200616      *  207006 - Add Counterparty & Market Centre to SSI             *
008400200616      *  CPK015 - Release 4.01 Packaging:                             *
008500200616      *           - A default timestamp string is required for WRITE. *
008600200616      *  CSE023 - Treaty Withholding Tax (Recompiled)                 *
008700200616      *  CSE015 - Forward Valued Depot Movements (Recompile)          *
008800200616      *  CSE017 - Cum/Ex Indicator on Depot Movements                 *
008900200616      *  CSE012 - SE Depot Movement Narratives                        *
009000200616      *  CPB001 - Meridian DBA Middleware Replication Customization.  *
009100200616      *           Midas/TOF Interface.                                *
009200200616      *  CAC005 - Profit Centre Accounting - SE Enhancement           *
009300200616      *  CAP003 - Conversion of Midas inputs to modular API structure *
009400200616      *           Phase 2.  Program recompiled over changed files.    *
009500200616     F*  092665 - CORRECT WEEKEND GENERATION                          *
009600200616     F*  094702 - Early red. range not updated directly (SE0375 list  *
009700200616     F*           shows wrong info. as range is updated in SE0630     *
009800200616     F*           which run after)                                    *
009900200616     F*  094693 - Generated depot movements should set up             *
010000200616     F*           customer delivery / withdrawal indicator            *
010100200616     F*  S01496 - Incorporation of JYSKE Enhancements (S10978)        *
010200200616     F*  64747  - TEST THE DAY BEFORE THE NEXT WORKING DAY, AND NOT   *
010300200616     F*           THE NEXT DAY                                        *
010400200616     F*  S10978 - JYSZRH: EARLY REDEMPTIONS                           *
010500200616     F*                                                               *
010600200616     F*****************************************************************
010700200616     F*
010800200616     F**Bank*Details***************************************************   S01496
010900200616     F***SDBANKL1IF**E           K        DISK         KINFSR  PSSR       S01496
011000200616     F*
011100200616     F**Branch*Details*************************************************   S01496
011200200616     F***SDBRCHL0IF**E           K        DISK         KINFSR  PSSR       S01496
011300200616     F*
011400200616     F**Securities*Trading*Data****************************************   S01496
011500200616     F***SDSTRDL1IF**E           K        DISK         KINFSR  PSSR       S01496
011600200616     F*
011700200616     F**General*Ledger*Details*****************************************   S01496
011800200616     F***SDGELRL1IF**E           K        DISK         KINFSR  PSSR       S01496
011900200616     F*
012000200616     F**PM*Special*Customer*Details************************************   S01496
012100200616     F***SDPLCSPDIF**E           K        DISK         KINFSR  PSSR       S01496
012200200616     F*
012300200616     F* PM Live Portfolio Definition Details
012400200616     FPMPORTLLIF  E           K        DISK         KINFSR *PSSR
012500200616     F*
012600200616     F**Currency*Codes*************************************************   S01496
012700200616     F***SDCURRL1IF**E           K        DISK         KINFSR *PSSR       S01496
012800200616     F*
012900200616     F* Securities Details
013000200616     FSECTY   IF  E           K        DISK         KINFSR *PSSR
013100200616     F*
013200200616     F* Trade Number Range File
013300200616     F*NRAN***IF  E           K        DISK         KINFSR *PSSR          094702
013400200616     FTNRAN   UF  E           K        DISK         KINFSR *PSSR          094702
013500200616     F*
013600200616     F* Trades and Historic Trades
013700200616     FTRADHS  IF  E           K        DISK         KINFSR *PSSR
013800200616     F            TRADSDF                           KRENAMETRADSDF1
013900200616     F*
014000200616     F* Depot Movements
014100200616     FDPTMV   IF  E           K        DISK         KINFSR *PSSR
014200200616     F            DPTMVDF                           KRENAMEDPTMVDF2
014300200616     FDPTMVDL1IF  E           K        DISK         KINFSR *PSSR      UC  CPB001
014400200616     F            DPTMVDF                           KRENAMEDPTMVDF1       CPB001
014500200616     F*
014600200616     F* SE ER Depot - Rtv Idx
014700200616     FSEERDPL1IF  E           K        DISK         KINFSR *PSSR
014800200616     F*
014900200616     F* SE ER Reference Authorised
015000200616     FSEERRFL2UF  E           K        DISK         KINFSR *PSSR
015100200616     F*
015200200616     F* SE ER Allocations
015300200616     FSEERALL0UF  E           K        DISK         KINFSR *PSSR
015400200616     F*
015500200616     F* SE Trades audit
015600200616     FTRADSA  UF  E                    DISK         KINFSR *PSSR
015700200616     F*
015800200616     F* SE Depot movements audit
015900200616     FDPTMVA  UF  E                    DISK         KINFSR *PSSR
016000200616     F*
016100200616     F* SE Position Settlements - Audit
016200200616     FPOSETA  UF  E                    DISK         KINFSR *PSSR
016300200616     F*
016400200616     F* SE Position Settlements - Details
016500200616     FPOSET1  UF  E           K        DISK         KINFSR *PSSR
016600200616     F*
016601200616     FPSAUT   UF  E           K        DISK         KINFSR *PSSR                            AR324886
016602200616      ** SE Position Settlement Authorisation detail                                        AR324886
016603200616      *                                                                                     AR324886
016700200616     F* SE Trades details
016800200616     FTRADS   UF  E           K        DISK         KINFSR *PSSR A
016900200616     F*
017000200616     F**SE*Trades*Extended*file****************************************   S01496
017100200616     F***CHTRADXCO***E           K        DISK         KINFSR *PSSR       S01496
017200200616     F*
017300200616     F* SE Depot Movements details
017400200616     FDPTMVD  O   E           K        DISK         KINFSR *PSSR
017500200616     F*
017600200616     F**SE*Depot*Movements*Extended*files******************************   S01496
017700200616     F***DPTMVDXAUF**E           K        DISK         KINFSR *PSSR A     S01496
017800200616     F************DPTMVDF1                          KRENAMEDPTMVDFA       S01496
017900200616     F***DPTMVDX0UF**E           K        DISK         KINFSR *PSSR A     S01496
018000200616     F***DPTMVDX1UF**E           K        DISK         KINFSR *PSSR A     S01496
018100200616     F* SE Depot Movements Extended File                                  S01496
018200200616     FDPTMVDY1UF  E           K        DISK         KINFSR *PSSR A    UC  S01496
018300200616     FSEPCCD  IF  E           K        DISK         KINFSR *PSSR          CAC005
018400200616     F*
018500200616     FSEMVTSL1IF  E           K        DISK         KINFSR *PSSR A        CSE039
018600200616      ***  Movement Status                                                CSE039
018700200616     F* Progran run control report
018800200616     FSE6740AUO   E                    PRINTER      KINFSR *PSSR
018900200616     F/COPY WNCPYSRC,SE6740F001
019000200616     F*****************************************************************
019100200616      /EJECT
019200200616      *****************************************************************   CSE012
019300200616      *                                                               *   CSE012
019400200616      *   F U N C T I O N   O F   I N D I C A T O R S                 *   CSE012
019500200616      *                                                               *   CSE012
019600200616      *   90-99   Used in standard Sub-Routines                       *   CSE012
019700200616      *   U7  -   Data base error                                     *   CSE012
019800200616      *   U8  -   Data base error/Audit record count difference       *   CSE012
019900200616      *   LR  -   Last Record indicator                               *   CSE012
020000200616      *****************************************************************   CSE012
020100200616      /EJECT                                                              CSE012
020200200616     F*****************************************************************
020300200616     F*    I N D E X   T O   S U B R O U T I N E S
020400200616     F*
020500200616     F*   P001   - INITIAL PROCESSING
020600200616     F*   P002   - MAIN PROCESSING
020700200616     F*   P003   - TERMINATION PROCESSING
020800200616     F*
020900200616     F*   P005R  - PROCESS ALL DEPOT      RECORDS - REVERSED
021000200616     F*   P006   - PROCESS ALL ALLOCATION RECORDS
021100200616     F*   P006R  - PROCESS ALL ALLOCATION RECORDS - REVERSED
021200200616     F*
021300200616     F*   W01    - WRITE TRADE RECORD
021400200616     F*   W02    - WRITE DEPOT MOVEMENT RECORD
021500200616     F*
021600200616     F*   FIRST  - ACCESS TO ICD.
021700200616     F*   *PSSR  - STANDARD DATABASE ERROR PROCESSING
021800200616     F*
021900200616     F*   STANDARD SUBROUTINE
022000200616     F*   ZEVCD  - ACCESS EVENT CONTROL DATE
022100200616     F*   ZTNLU1 - ACCESS NEXT AVAILABLE TRANSACTION NUMBER
022200200616     F*            FROM DTAARA/MNATN
022300200616     F*   ZAPNUM - CALCULATE AP NUMERATOR
022400200616     F*
022500200616     E*****************************************************************
022600200616      /EJECT
022700200616     E*****************************************************************
022800200616     E/COPY ZSRSRC,ZPOWER8Z1
022900200616     E/COPY ZSRSRC,ZPOWERZ1
023000200616      /COPY ZSRSRC,ZDATE2Z1                                               CSE017
023100200616      /COPY ZSRSRC,ZNCDZ1                                                 CSE017
023200200616      /COPY ZSRSRC,ZHOLE                                                  CSE017
023300200616     E                    STAMP   1   1 26                                                    CPK015
023400200616      ** Array containing dummy timestamp                                                     CPK015
023500200616     E*
023600200616     E**   FOR COMPILATION - COPYRIGHT INSERTION
023700200616     E                    CPY@    1   1 80
023800200616     E*
023900200616     E                    TMMP    1   1 26               TIMESTAMP        CSE039
024000200616     E                    @FNXA      40 10                                                    234829
024100200616     E                    @MIXA      40  7                                                    234829
024200200616     E                    @MDXA      40 45                                                    234829
024300200616     E/COPY WNCPYSRC,SE6740E001
024400200616     E*****************************************************************
024500200616      /EJECT
024600200616     I*****************************************************************
024700200616     I*                                                                   CPB001
024800200616     I**  Rename Trade Replication Indicator.                             CPB001
024900200616     ITRADSDF                                                             CPB001
025000200616     I              REPI                            TRREPI                CPB001
025100200616     I*
025200200616     I**   DATA STRUCTURE FOR DATABASE ERROR
025300200616     ILDA         DS                            256
025400200616     I                                      132 183 WWLOT
025500200616     I                                      132 141 WWFILE
025600200616     I                                      142 170 WWKEY
025700200616     I                                      171 180 WWPGM
025800200616     I                                      181 1830WWASE
025900200616      *                                                                   CSE039
026000200616     IPSDS       SDS                                                      CSE039
026100200616      ***  Program Status Data Structure                                  CSE039
026200200616     I                                      254 263 USER                  CSE039
026300200616     I*
026400200616     I**  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
026500200616     ICPYR@#      DS
026600200616     I                                        1  80 CPY@
026700200616     I                                        1  20 CPY@##
026800200616     I*
026900200616     I***LZSTAT******DS                            256                    S01496
027000200616     I***************************************10  10 DMCG                  S01496
027100200616     I***************************************33  33 M500                  S01496
027200200616     I*
027300200616     IWKEY7       DS
027400200616     I                                        1  10 WASESN
027500200616     I                                       11  16 WCTRRF
027600200616     I            DS                                                                          234829
027700200616     I**********                              1   60DPBN                              234829 CSD027A
027800200616     I                                        1   6 DPBN                                     CSD027A
027900200616     I                                        1   6 WDPBN                                     234829
028000200616     IWKEY56      DS
028100200616     I                                        1   30WBRCD
028200200616     I                                        4  13 WSESN
028300200616     I**********                             14  190WCNDP                                     CSD027
028400200616     I                                       14  19 WCNDP                                     CSD027
028500200616     I                                       20  240WERRD
028600200616     I                                       25  26 WEVTY
028700200616     I                                       26  29 WPTFR
028800200616     I                                       30  340WTNL1
028900200616     I/COPY WNCPYSRC,SE6740I001
029000200616     I@BANK     E DSSDBANKPD                                              S01496
029100200616     I** Dummy record format for access to Bank Details                   S01496
029200200616     I*                                                                   S01496
029300200616     I@CURR     E DSSDCURRPD                                              S01496
029400200616     I** Dummy record format for access to Currency Details               S01496
029500200616     I*                                                                   S01496
029600200616     I@PLCS     E DSSDPLCSPD                                              S01496
029700200616     I** Dummy record format for access to PM Special Customer Details    S01496
029800200616     I*                                                                   S01496
029900200616     I@BRCH     E DSSDBRCHPD                                              S01496
030000200616     I** Dummy record format for access to Branch Details                 S01496
030100200616     I*                                                                   S01496
030200200616     I@GELR     E DSSDGELRPD                                              S01496
030300200616     I** Dummy record format for access to General Ledger Details         S01496
030400200616     I*                                                                   S01496
030500200616     I@STRD     E DSSDSTRDPD                                              S01496
030600200616     I** Dummy record format for access to Securities Trading Data        S01496
030700200616     I*                                                                   S01496
030800200616     I@SARD     E DSSCSARDPD                                              S01496
030900200616     I** Dummy record format for access to SAR Installation File          S01496
031000200616     I*                                                                   CPB001
031100200616     ISDMMOD    E DSSDMMODPD                                              CPB001
031200200616     I** Data Structure for access to Midas Modules Details.              CPB001
031300200616     I*                                                                   CPB001
031400200616     ISDCUST    E DSSDCUSTPD                                              CPB001
031500200616     I              QQDFAC                          QQDFA1                                    CGL029
031600200616     I** Data Structure for access to Customer Details.                   CPB001
031700200616     I*                                                                   S01496
031800200616     IINVTP     E DSINVTPD                                                CSE017
031900200616     I              LCD                             INLCD                 CSE017
032000200616      ** Dummy record format for access to Investment Types File          CSE017
032100200616     I@TRDDS    E DSTRADSD                                                                    234829
032200200616     I              RECI                            RECIT                                     234829
032300200616     I              CHTP                            CHTPT                                     234829
032400200616     I              TNLU                            TNLUT                                     234829
032500200616     I              LCD                             LCDT                                      234829
032600200616      ** Security Details Data Structure                                                      234829
032700200616     I@SECTY    E DSSECTYD                                                                    234829
032800200616     I              RECI                            RECIA                                     234829
032900200616     I              NMCY                            NMCYA                                     234829
033000200616     I              ZZ005                           ZZ005A                                    234829
033100200616     I              CHTP                            CHTPA                                     234829
033200200616     I              TNLU                            TNLUA                                     234829
033300200616     I              REPI                            REPIA                                     234829
033400200616     I              REPA                            REPAA                                     234829
033500200616     I              LCD                             LCDTA                                     234829
033600200616     I              FRNT                            FRNTA                                     234829
033700200616     I              TMST                            TMSTA                                     234829
033800200616     I              CD01                            CD01A                                     234829
033900200616     I              CD02                            CD02A                                     234829
034000200616     I              CD03                            CD03A                                     234829
034100200616     I              CD04                            CD04A                                     234829
034200200616     I              CD05                            CD05A                                     234829
034300200616     I              CD06                            CD06A                                     234829
034400200616     I              CD07                            CD07A                                     234829
034500200616     I              CD08                            CD08A                                     234829
034600200616     I              CD09                            CD09A                                     234829
034700200616     I              CD10                            CD10A                                     234829
034800200616     I              CD11                            CD11A                                     234829
034900200616     I              CD12                            CD12A                                     234829
035000200616     I              CR01                            CR01A                                     234829
035100200616     I              CR02                            CR02A                                     234829
035200200616     I              CR03                            CR03A                                     234829
035300200616     I              CR04                            CR04A                                     234829
035400200616     I              CR05                            CR05A                                     234829
035500200616     I              CR06                            CR06A                                     234829
035600200616     I              CR07                            CR07A                                     234829
035700200616     I              CR08                            CR08A                                     234829
035800200616     I              CR09                            CR09A                                     234829
035900200616     I              CR10                            CR10A                                     234829
036000200616     I              CR11                            CR11A                                     234829
036100200616     I              CR12                            CR12A                                     234829
036200200616     I              NDEC                            NDECA                                     234829
036300200616     I@SEVDP    E DSSEVDPMVPD                                                                 234829
036400200616     I              RECI                            RECIV                                     234829
036500200616     I              ORBR                            ORBRV                                     234829
036600200616     I              TACI                            TACIV                                     234829
036700200616     I              ORED                            OREDV                                     234829
036800200616     I              LCD                             LCDV                                      234829
036900200616     I              CHTP                            CHTPV                                     234829
037000200616     I              TNLU                            TNLUV                                     234829
037100200616     I              SPXR                            SPXRV                                     234829
037200200616     I              SPMD                            SPMDV                                     234829
037300200616     I              PTFR                            PTFRV                                     234829
037400200616     I              COAF                            COAFV                                     234829
037500200616     I              ACIN                            ACINV                                     234829
037600200616     I              REPI                            REPIV                                     234829
037700200616     I              DPAP                            DPAPV                                     234829
037800200616     I              FSPR                            FSPRV                                     234829
037900200616     I              FSPP                            FSPPV                                     234829
038000200616     I              DPBN                            DPBNV                                     234829
038100200616      *                                                                   CSE017
038200200616     IDSFDY     E DSDSFDY                                                 S01496
038300200616     I** First DS for access programs, short data structure               S01496
038400200616     I*                                                                   S01496
038500200616     IDSSDY     E DSDSSDY                                                 S01496
038600200616     I** Second DS for access programs, long data structure               S01496
038700200616     I*
038800200616     IDSLDY     E DSDSLDY                                                 CPB001
038900200616     I** Third DS for access programs, very long data structure           CPB001
039000200616     I*                                                                   CPB001
039100200616     I              'SEVSEFSPR3'          C         SEVFSP                                    234829
039200200616     I              'SEETCPUPD'           C         SEETCP                                    234829
039300200616     I              'SEVOPUINT'           C         SEVOPI                                    234829
039301200616     ISDSTAT    E DSSDSTAT                                                                  AR324886
039302200616      ** SD Data area                                                                       AR324886
039303200616      *                                                                                     AR324886
039400200616      /COPY ZSRSRC,ZNCDZ2                                                 CSE017
039500200616      /COPY ZSRSRC,ZHOLI                                                  CSE017
039600200616     I/COPY ZSRSRC,ZTNLU1Z1
039700200616     I*
039800200616     I*****************************************************************
039900200616      /EJECT
040000200616     C*****************************************************************
040100200616     C*================================================================
040200200616     C*  P R O G R A M     S T A R T
040300200616     C*================================================================
040400200616     C*****************************************************************
040500200616     C** MAIN PROCESSING
040600200616     C*****************************************************************
040700200616     C*
040800200616     C**   INITIAL PROCESSING
040900200616     C                     EXSR P001
041000200616     C*
041100200616     C**   MAIN PROCESSING
041200200616     C                     EXSR P002
041300200616     C*
041400200616     C**   TERMINATION PROCESSING
041500200616     C                     EXSR P003
041600200616     C*
041700200616     ******************************************************************
041800200616      /EJECT
041900200616     ******************************************************************
042000200616     C* P001   : INITIAL PROCESSING                                   *
042100200616     ******************************************************************
042200200616     C*
042300200616     C           P001      BEGSR
042400200616     C*                                                                   S01496
042500200616     C**  Copyright statement                                             S01496
042600200616     C*                                                                   S01496
042700200616     C                     MOVEACPY@      ACT@   80                       S01496
042800200616     C*
042900200616     C***LZSTAT********************************************************   S01496
043000200616     C************NAMVAR   DEFN           LZSTAT                          S01496
043100200616     C***********          IN   LZSTAT                                    S01496
043200200616     C*
043300200616     C** INITIALISE KEY AND WORKING FIELDS
043400200616     C** SAVED SECURITY
043500200616     C           *LIKE     DEFN VASESN    #1SESN
043600200616     C*
043700200616     C** FIELDS FOR SECURITY NOMINAL CURRENCY
043800200616     C           *LIKE     DEFN A6SPRT    WNSPRT
043900200616     C           *LIKE     DEFN A6MDIN    WNMDIN
044000200616     C           *LIKE     DEFN A6NBDP    WNNBDP
044100200616     C*
044200200616     C** FIELDS FOR SR/ZEVCD (EVENT CONTROL DATE)
044300200616     C           *LIKE     DEFN BKAPDT    APDA
044400200616     C           *LIKE     DEFN BJDNWD    DNWD
044500200616     C*
044600200616     C                     MOVE *BLANKS   WWLOT
044700200616     C                     MOVEL'SE6740  'DBPGM  10
044800200616     C*
044900200616     C** COUNTS FOR AUDIT
045000200616     C                     Z-ADD0         W01CNT  50
045100200616     C                     Z-ADD0         W02CNT  50
045200200616     C                     Z-ADD0         W03CNT  50
045300200616     C                     Z-ADD0         W04CNT  50
045400200616     C                     Z-ADD0         W05CNT  50
045500200616     C                     Z-ADD0         W06CNT  50
045501200616     C           *NAMVAR   DEFN           SDSTAT                                            AR324886
045502200616     C                     IN   SDSTAT                                                      AR324886
045600200616     C*
045700200616     C** EXECUTE INITIAL PROCESSING SR/FIRST
045800200616     C                     EXSR FIRST
045900200616     C*
046000200616     C** DEFINE NECESSARY KLIST'S
046100200616     C** KEY TO ACCESS TRADE NUMBER RANGE FILE
046200200616     C           KEY1      KLIST
046300200616     C                     KFLD           K1RECT  20
046400200616     C                     KFLD           K1FILL  8
046500200616     C                     KFLD           K1RANG  20
046600200616     C*
046700200616     C***KEY*TO*ACCESS*SDBRCHPD****************************************   S01496
046800200616     C***********KEY2      KLIST                                          S01496
046900200616     C***********          KFLD           K2BRCD  3                       S01496
047000200616     C*
047100200616     C** KEY TO ACCESS DPTMV
047200200616     C           KEY3      KLIST
047300200616     C                     KFLD           VASESN
047400200616     C                     KFLD           WWNTRC
047500200616     C*
047600200616     C** KEY TO ACCESS PMPORTLL
047700200616     C           KEY4      KLIST
047800200616     C                     KFLD           VCCNUM
047900200616     C                     KFLD           VCPTFR
048000200616     C*
048100200616     C** KEY TO ACCESS POSETD (1)
048200200616     C           KEY5      KLIST
048300200616     C                     KFLD           VBBRCD
048400200616     C                     KFLD           VASESN
048500200616     C                     KFLD           VBDDPT
048600200616     C                     KFLD           VAERRD
048700200616     C                     KFLD           K5EVTY  2
048800200616     C                     KFLD           K5PTFR  4
048900200616     C                     KFLD           VBTNL1
049000200616     C*
049100200616     C** KEY TO ACCESS POSETD (2)
049200200616     C           KEY6      KLIST
049300200616     C                     KFLD           VCBRCD
049400200616     C                     KFLD           VASESN
049500200616     C                     KFLD           VCCNUM
049600200616     C                     KFLD           VAERRD
049700200616     C                     KFLD           K5EVTY
049800200616     C                     KFLD           VCPTFR
049900200616     C                     KFLD           VCTNL1
049901200616      *                                                                                     AR324886
049902200616     C           PSAUTH    KLIST                                                            AR324886
049903200616     C                     KFLD           PBCA                                              AR324886
049904200616     C                     KFLD           PSSH                                              AR324886
049905200616     C                     KFLD           PCPY                                              AR324886
049906200616     C                     KFLD           PDUD                                              AR324886
049907200616     C                     KFLD           PEVT                                              AR324886
049908200616     C                     KFLD           PTFR                                              AR324886
049909200616     C                     KFLD           TNLU                                              AR324886
049910200616     C                     KFLD           TXBS                                              AR324886
049911200616     C                     KFLD           BNFO                                              AR324886
049912200616     C                     KFLD           EXCD                                              AR324886
050000200616     C*
050100200616     C***KEY*TO*ACCESS*DPTMVDXA,X0,X1**********************************   S01496
050200200616     C** Key to access DPTMVDY1                                           S01496
050300200616     C           KEY7      KLIST
050400200616     C                     KFLD           VASESN
050500200616     C                     KFLD           VCTRRF
050600200616      *                                                                   CAC005
050700200616      ** Key to access SEPCCD                                             CAC005
050800200616      *                                                                   CAC005
050900200616     C           KEY8      KLIST                                          CAC005
051000200616     C                     KFLD           VCCNUM                          CAC005
051100200616     C                     KFLD           VCBRCD                          CAC005
051200200616     C                     KFLD           VASESN                          CAC005
051300200616     C*                                                                   CSE039
051400200616     C*  - MOVEMENTS STATUS FILE                                          CSE039
051500200616     C*                                                                   CSE039
051600200616     C           KSEMV     KLIST                                          CSE039
051700200616     C                     KFLD           KTDRF   6                       CSE039
051800200616     C                     KFLD           KTRTY   1                       CSE039
051900200616     C                     KFLD           KNTDT   50                      CSE039
052000200616     C*
052100200616     C** CALCULATE ECD AS PER STANDARD MIDAS PROCESSING
052200200616     C                     Z-ADDBKAPDT    APDA
052300200616     C                     Z-ADDBJDNWD    DNWD
052400200616     C                     EXSR ZEVCD
052500200616     C*                                                                   CPB001
052600200616     C** Retrieve Midas Modules Details.                                  CPB001
052700200616     C                     CALL 'AOMMODR0'                                CPB001
052800200616     C                     PARM '*MSG    '@RTCD   7                       CPB001
052900200616     C                     PARM '*FIRST  '@OPTN   7                       CPB001
053000200616     C           SDMMOD    PARM SDMMOD    DSFDY                           CPB001
053100200616     C*                                                                   CPB001
053200200616     C** If Module Details do not exist, handle Database Error.           CPB001
053300200616     C           @RTCD     IFNE *BLANK                     Begin @RTCD    CPB001
053400200616     C                     MOVE 'SDMMODPD'DBFILE           ***************CPB001
053500200616     C                     MOVEL@OPTN     DBKEY            * DB ERROR 91 *CPB001
053600200616     C                     Z-ADD91        DBASE            ***************CPB001
053700200616     C                     EXSR *PSSR                                     CPB001
053800200616     C*                                                                   CPB001
053900200616     C                     ENDIF                           End @RTCD      CPB001
054000200616     C*                                                                   CPB001
054100200616     C** If Private Banking Module is installed.                          CPB001
054200200616     C           BGN4ST    IFEQ 'Y'                         Begin BGN4ST  CPB001
054300200616     C*                                                                   CPB001
054400200616     C** Set up Replication Processing Indicator.                         CPB001
054500200616     C                     MOVE 'Y'       WUREPL  1                       CPB001
054600200616     C*                                                                   CPB001
054700200616     C** If MT500 is not installed, open Depot Movement Logical File.     CPB001
054800200616     C           *IN41     IFEQ *OFF                        Begin *IN41   CPB001
054900200616     C                     OPEN DPTMVDL1                                  CPB001
055000200616     C*                                                                   CPB001
055100200616     C                     ENDIF                            End *IN41     CPB001
055200200616     C*                                                                   CPB001
055300200616     C                     ENDIF                            End BGN4ST    CPB001
055400200616     C*
055500200616     C           EP001     ENDSR
055600200616     ******************************************************************
055700200616      /EJECT
055800200616     ******************************************************************
055900200616     C* P002   : MAIN PROCESSING                                      *
056000200616     ******************************************************************
056100200616     C*
056200200616     C           P002      BEGSR
056300200616     C*
056400200616     C** ACCESS FIRST RECORD (BY READ) IN ER REFERENCES FILE LF/SEERRFL2
056500200616     C           *LOVAL    SETLLSEERRFL2
056600200616     C                     READ SEERRFL2                 89
056700200616     C*
056800200616     C** DO WHILE END OF FILE IS NOT REACHED
056900200616     C           *IN89     DOWEQ'0'
057000200616     C*
057100200616     C** IF 'REDEMPTION DATE' IS LOWER THAN OR EQUAL TO ECD AND           64747
057200200616     C** IF 'TRADE/DEPOT MVMNT EVENT IND' IS NOT EQUAL TO 'Y' AND         64747
057300200616     C** IF 'STATUS' IS NOT 'REVERSE'                                     64747
057400200616     C*          VAERRD    IFLE ECD                                       64747
057500200616     C*                                                                   64747
057600200616     C*                                                                   64747
057700200616     C** IF 'REDEMPTION DATE' IS LOWER THAN 'NEXT WORKING DAY' AND        64747
057800200616     C** IF 'TRADE/DEPOT MVMNT EVENT IND' IS NOT EQUAL TO 'Y' AND         64747
057900200616     C** IF 'STATUS' IS NOT 'REVERSE'                                     64747
058000200616     C           VAERRD    IFLT DNWD                                      64747
058100200616     C           VAEVNI    ANDNE'Y'
058200200616     C           VAERST    ANDNE'R'
058300200616     C*
058400200616     C** IF 'SECURITY SHORTNAME' IS NOT EQUAL TO 'SAVED SECURITY'
058500200616     C** ACCESS TO SECURITY DETAILS
058600200616     C           VASESN    IFNE #1SESN
058700200616     C                     MOVELVASESN    #1SESN
058800200616     C                     EXSR SECTIN
058900200616     C                     ENDIF
059000200616     C*
059100200616     C** PROCESS ALL ALLOCATION RECORDS
059200200616     C                     EXSR P006
059300200616     C*
059400200616     C** MOVE 'Y' TO 'TRADE/DEPOT MOVEMENTS EVENT INDICATOR'
059500200616     C                     MOVEL'Y'       VAEVNI
059600200616     C*                                                                    92665
059700200616     C           VAPOSI    IFEQ 'Y'                                        92665
059800200616     C                     MOVE 'C'       VAERST                           92665
059900200616     C                     END                                             92665
060000200616     C*
060100200616     C** UPDATE EARLY REDEMPTION REFERENCE RECORD
060200200616     C                     UPDATSEERRFD0
060300200616     C*
060400200616     C                     ENDIF
060500200616     C*
060600200616     C** IF 'STATUS' IS 'REVERSE' AND
060700200616     C** IF 'LAST CHANGE DATE' IS THE 'RUN DATE'  (= REVERSED TODAY)
060800200616     C           VAERST    IFEQ 'R'
060900200616     C           VALCD     ANDEQBJRDNB
061000200616     C*
061100200616     C** IF 'SECURITY SHORTNAME' IS NOT EQUAL TO 'SAVED SECURITY'
061200200616     C** ACCESS TO SECURITY DETAILS
061300200616     C           VASESN    IFNE #1SESN
061400200616     C                     MOVELVASESN    #1SESN
061500200616     C                     EXSR SECTIN
061600200616     C                     ENDIF
061700200616     C*
061800200616     C** IF POSITION SETTLEMENT REQUIRED IS EQUAL TO 'Y'
061900200616     C           VAPOSI    IFEQ 'Y'
062000200616     C*
062100200616     C** PROCESS ALL DEPOT RECORDS
062200200616     C                     EXSR P005R
062300200616     C                     ENDIF
062400200616     C*
062500200616     C** IF POSITION SETTLEMENT REQUIRED IS EQUAL TO 'Y'OR
062600200616     C** IF TRADE/DEPOT MOVEMENTS EVENT INDICATOR' IS EQUAL TO 'Y'
062700200616     C           VAPOSI    IFEQ 'Y'
062800200616     C           VAEVNI    OREQ 'Y'
062900200616     C*
063000200616     C** PROCESS ALL ALLOCATION RECORDS - REVERSED
063100200616     C                     EXSR P006R
063200200616     C                     ENDIF
063300200616     C                     ENDIF
063400200616     C*
063500200616     C** ACCESS NEXT RECORD IN ER REFERENCES FILE
063600200616     C                     READ SEERRFL2                 89
063700200616     C*
063800200616     C                     ENDDO
063900200616     C*
064000200616     C           EP002     ENDSR
064100200616     ******************************************************************
064200200616      /EJECT
064300200616     ******************************************************************
064400200616     C* P003   : TERMINATION PROCESSING                               *
064500200616     ******************************************************************
064600200616     C*
064700200616     C           P003      BEGSR
064800200616     C*                                                                   S01496
064900200616     C** Close file if S01401 is installed.                               S01496
065000200616     C*                                                                   S01496
065100200616     C           *IN41     IFEQ '1'                                       S01496
065200200616     C                     CLOSEDPTMVDY1                                  S01496
065300200616     C                     CLOSEDPTMVDL1                                  CPB001
065400200616     C                     END                                            S01496
065500200616     C*                                                                   CPB001
065600200616     C** Close file if Private Banking Module is installed                CPB001
065700200616     C** and MT500 is not installed.                                      CPB001
065800200616     C*                                                                   CPB001
065900200616     C           BGN4ST    IFEQ 'Y'                        Begin BGN4ST   CPB001
066000200616     C           *IN41     ANDEQ*OFF                                      CPB001
066100200616     C                     CLOSEDPTMVDL1                                  CPB001
066200200616     C*                                                                   CPB001
066300200616     C                     END                             End BGN4ST     CPB001
066400200616     C*                                                                   094702
066500200616     C** UPDATE early red. trade ref range if trade gen.                  094702
066600200616     C/COPY WNCPYSRC,SE6740C013
066700200616     C           NTRN      IFNE WWNTR1                                    094702
066800200616     C                     Z-ADDWWNTR1    NTRN                            094702
066900200616     C                     UPDATTNRANABF               89                 094702
067000200616     C                     END                                            094702
067100200616     C/COPY WNCPYSRC,SE6740C001
067200200616     C*
067300200616     C** UPDATE TRADE AUDIT DETAILS
067400200616     C           W01CNT    IFNE *ZEROS
067500200616     C           W04CNT    ORNE *ZEROS
067600200616     C           1         CHAINTRADSAF              89
067700200616     C*
067800200616     C           *IN89     IFEQ '0'
067900200616     C                     ADD  W01CNT    SINS
068000200616     C                     ADD  W01CNT    NORE
068100200616     C                     ADD  W04CNT    SDEL
068200200616     C                     UPDATTRADSAF
068300200616     C                     ELSE
068400200616     C                     Z-ADD1         DBASE            *****************
068500200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 01 **
068600200616     C***********          MOVEL'TRADSA'  DBFILE           ************** S01496
068700200616     C                     MOVE 'TRADSA  'DBFILE                          S01496
068800200616     C                     MOVEL'AUDIT'   DBKEY
068900200616     C                     EXSR *PSSR
069000200616     C                     ENDIF
069100200616     C                     ENDIF
069200200616     C*
069300200616     C** UPDATE DEPOT MOVEMENTS AUDIT DETAILS
069400200616     C           W02CNT    IFNE *ZEROS
069500200616     C           W05CNT    ORNE *ZEROS
069600200616     C           1         CHAINDPTMVAF              89
069700200616     C*
069800200616     C           *IN89     IFEQ '0'
069900200616     C                     ADD  W02CNT    SINS
070000200616     C                     ADD  W05CNT    SINS
070100200616     C                     ADD  W02CNT    NORE
070200200616     C                     ADD  W05CNT    NORE
070300200616     C                     UPDATDPTMVAF
070400200616     C                     ELSE
070500200616     C                     Z-ADD2         DBASE             *****************
070600200616     C                     MOVEL*BLANKS   DBFILE            ** DB ERROR 02 **
070700200616     C***********          MOVEL'DPTMVA'  DBFILE            ************* S01496
070800200616     C                     MOVE 'DPTMVA  'DBFILE                          S01496
070900200616     C                     MOVEL'AUDIT'   DBKEY
071000200616     C                     EXSR *PSSR
071100200616     C                     ENDIF
071200200616     C                     ENDIF
071300200616     C*
071400200616     C** UPDATE POSITION SETTLEMENT AUDIT DETAILS
071500200616     C           W03CNT    IFNE *ZEROS
071600200616     C           1         CHAINPOSETAF              89
071700200616     C*
071800200616     C           *IN89     IFEQ '0'
071900200616     C                     ADD  W03CNT    NODE             *NO.DLTD TDY
072000200616     C                     SUB  W03CNT    NORE             *NO.LIVE RCS
072100200616     C                     UPDATPOSETAF                89
072200200616     C*
072300200616     C           *IN89     IFEQ '1'
072400200616     C                     Z-ADD3         DBASE            *****************
072500200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 03 **
072600200616     C***********          MOVEL'POSETAF' DBFILE           ************** S01496
072700200616     C                     MOVE 'POSETAF 'DBFILE                          S01496
072800200616     C                     MOVEL'UPDAT'   DBKEY
072900200616     C                     EXSR *PSSR
073000200616     C                     ENDIF
073100200616     C*
073200200616     C                     ELSE
073300200616     C                     Z-ADD4         DBASE            *****************
073400200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 04 **
073500200616     C***********          MOVEL'POSETA'  DBFILE           ************** S01496
073600200616     C                     MOVE 'POSETA  'DBFILE                          S01496
073700200616     C                     MOVEL'AUDIT'   DBKEY
073800200616     C                     EXSR *PSSR
073900200616     C                     ENDIF
074000200616     C                     ENDIF
074100200616     C*
074200200616     C** PROCESS AUDIT PROCESSING
074300200616     C                     EXSR AUDIT
074400200616     C*
074500200616     C** RETURN OUT OF THE PROGRAM
074600200616     C                     MOVE '1'       *INLR
074700200616     C                     RETRN
074800200616     C*
074900200616     C           EP003     ENDSR
075000200616     ******************************************************************
075100200616      /EJECT
075200200616     ******************************************************************
075300200616     C* P005R  : PROCESS ALL DEPOT RECORDS IN LF/SEERDPL1             *
075400200616     ******************************************************************
075500200616     C*
075600200616     C           P005R     BEGSR
075700200616     C*
075800200616     C** ACCESS FIRST DEPOT RECORD FOR CURRENT 'ER REFERENCE'
075900200616     C*
076000200616     C           VAERRF    SETLLSEERDPL1
076100200616     C                     READ SEERDPL1                 89
076200200616     C*
076300200616     C** DO WHILE END OF FILE AND END OF ER REFERENCE NOT REACHED
076400200616     C           *IN89     DOWEQ'0'
076500200616     C           VBERRF    ANDEQVAERRF
076600200616     C*
076700200616     C** IF 'POSITION SETTLEMENT' IS NOT EQUAL TO ZEROS
076800200616     C           VBTNL1    IFNE *ZEROS
076900200616     C*
077000200616     C** ACCESS TO POSITION SETTLEMENT FILE WITH KEY OF
077100200616     C** 1.BRANCH  2.SECURITY  3.DEPOT  4.REDEMPTION DATE  5.EVENT TYPE  6.PTFR
077200200616     C                     MOVE 'RC'      K5EVTY
077300200616     C                     MOVE *BLANKS   K5PTFR
077400200616     C           KEY5      CHAINPOSET1               88
077500200616     C*
077600200616     C** IF THE RECORD IS FOUND
077700200616     C           *IN88     IFEQ '0'
077800200616     C*
077900200616     C** IF THE RECORD IDENTIFIER IS 'D'
078000200616     C           RECI      IFEQ 'D'
078100200616     C                     MOVE '*'       RECI
078200200616     C                     MOVE 'D'       CHTP
078300200616     C                     Z-ADDBJRDNB    LCD
078400200616     C                     UPDATPOSETDF                89
078401200616     C                     EXSR PSAUDT                                                      AR324886
078500200616     C*
078600200616     C** IF RECORD IS NOT FOUND
078700200616     C           *IN89     IFEQ '1'
078800200616     C***********          Z-ADDVBBRCD    WBRCD                           S01496
078900200616     C                     MOVE VBBRCD    WBRCD                           S01496
079000200616     C                     MOVE VASESN    WSESN
079100200616     C**********           Z-ADDVBDDPT    WCNDP                                               CSD027
079200200616     C                     MOVE VBDDPT    WCNDP                                               CSD027
079300200616     C                     Z-ADDVAERRD    WERRD
079400200616     C                     MOVE K5EVTY    WEVTY
079500200616     C                     MOVE K5PTFR    WPTFR
079600200616     C                     Z-ADDVBTNL1    WTNL1
079700200616     C                     Z-ADD5         DBASE            *****************
079800200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 05 **
079900200616     C***********          MOVEL'POSETDF' DBFILE           ************** S01496
080000200616     C                     MOVE 'POSETDF 'DBFILE                          S01496
080100200616     C                     MOVELWKEY56    DBKEY
080200200616     C                     EXSR *PSSR
080300200616     C                     END
080400200616     C*
080500200616     C                     ADD  1         W03CNT
080600200616     C                     END
080700200616     C*
080800200616     C** IF THE RECORD IDENTIFIER IS 'M'
080900200616     C           RECI      IFEQ 'M'
081000200616     C                     MOVE 'R'       RECI
081100200616     C                     MOVE 'R'       CHTP
081200200616     C                     Z-ADDBJRDNB    LCD
081300200616     C                     UPDATPOSETDF                89
081301200616     C                     EXSR PSAUDT                                                      AR324886
081400200616     C*
081500200616     C** IF RECORD IS NOT FOUND
081600200616     C           *IN89     IFEQ '1'
081700200616     C***********          Z-ADDVBBRCD    WBRCD                           S01496
081800200616     C                     MOVE VBBRCD    WBRCD                           S01496
081900200616     C                     MOVE VASESN    WSESN
082000200616     C**********           Z-ADDVBDDPT    WCNDP                                               CSD027
082100200616     C                     MOVE VBDDPT    WCNDP                                               CSD027
082200200616     C                     Z-ADDVAERRD    WERRD
082300200616     C                     MOVE K5EVTY    WEVTY
082400200616     C                     MOVE K5PTFR    WPTFR
082500200616     C                     Z-ADD6         DBASE            *****************
082600200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 06 **
082700200616     C***********          MOVEL'POSETDF' DBFILE           ************** S01496
082800200616     C                     MOVE 'POSETDF 'DBFILE                          S01496
082900200616     C                     MOVELWKEY56    DBKEY
083000200616     C                     EXSR *PSSR
083100200616     C                     END
083200200616     C*
083300200616     C                     ADD  1         W06CNT
083400200616     C                     END
083500200616     C                     END
083600200616     C                     END
083700200616     C*
083800200616     C** ACCESS NEXT RECORD FOR CURRENT ER REFERENCE
083900200616     C                     READ SEERDPL1                 89
084000200616     C                     ENDDO
084100200616     C*
084200200616     C           EP005R    ENDSR
084300200616     ******************************************************************
084400200616      /EJECT
084500200616     ******************************************************************
084600200616     C* P006   : PROCESS ALL ALLOCATION RECORDS IN LF/SEERALL0        *
084700200616     ******************************************************************
084800200616     C*
084900200616     C           P006      BEGSR
085000200616     C*
085100200616     C** ACCESS FIRST ALLOCATION RECORD (READE) FOR CURRENT
085200200616     C** 'ER REFERENCE' IN ER ALLOCATION FILE LF/SEERALL0
085300200616     C*
085400200616     C           VAERRF    SETLLSEERALL0
085500200616     C           VAERRF    READESEERALL0                 89
085600200616     C*
085700200616     C** DO WHILE 'END OF FILE' AND 'END OF ER REFERENCE' NOT REACHED
085800200616     C           *IN89     DOWEQ'0'
085900200616     C*
086000200616     C** IF RECORD IDENTIFIER IS 'D' AND NOMINAL ALLOCATED NOT EQUAL TO ZERO
086100200616     C           VCRECI    IFEQ 'D'
086200200616     C           VCNOMA    ANDNE0
086300200616     C*
086400200616     C** CUSTOMER ALLOCATION RECORD
086500200616     C           VCERTP    IFEQ 'P'
086600200616     C                     MOVE ' '       WALLOC  1
086700200616     C*
086800200616     C** WRITE A DEPOT MOVEMENT RECORD AND DEPOT MOVEMENT EXTENDED RECORDS
086900200616     C                     EXSR W02
087000200616     C                     ENDIF
087100200616     C*
087200200616     C** BOOK ALLOCATION RECORD
087300200616     C           VCERTP    IFEQ 'B'
087400200616     C*
087500200616     C** WRITE A TRADE RECORD AND TRADE EXTENDED RECORD
087600200616     C                     EXSR W01
087700200616     C                     ENDIF
087800200616     C*
087900200616     C** MOVE 'REFERENCE' OF GENERATED RECORD (TRADE OR DPT MOV)
088000200616     C** INTO TRANSACTION REFERENCE OF SEERALL0
088100200616     C                     MOVE WWNTRC    VCTRRF
088200200616     C*
088300200616     C                     ENDIF
088400200616     C*
088500200616     C** MOVE 'RUN DATE' INTO 'BLOCKED END DATE'
088600200616     C                     Z-ADDBJRDNB    VCBEDT
088700200616     C*
088800200616     C** UPDATE EARLY REDEMPTION DEPOT RECORD IN LF/SEERALL0
088900200616     C                     UPDATSEERALD0
089000200616     C*
089100200616     C** ACCESS NEXT RECORD FOR CURRENT ER REFERENCE
089200200616     C           VAERRF    READESEERALL0                 89
089300200616     C                     ENDDO
089400200616     C*
089500200616     C           EP006     ENDSR
089600200616     ******************************************************************
089700200616      /EJECT
089800200616     ******************************************************************
089900200616     C* P006R  : PROCESS ALL ALLOCATION RECORDS IN LF/SEERALL0 - REV. *
090000200616     ******************************************************************
090100200616     C*
090200200616     C           P006R     BEGSR
090300200616     C*
090400200616     C** ACCESS FIRST ALLOCATION RECORD FOR CURRENT 'ER REFERENCE'
090500200616     C*
090600200616     C           VAERRF    SETLLSEERALL0
090700200616     C                     READ SEERALL0                 89
090800200616     C*
090900200616     C** DO WHILE END OF FILE AND END OF ER REFERENCE NOT REACHED
091000200616     C           *IN89     DOWEQ'0'                        B*1
091100200616     C           VCERRF    ANDEQVAERRF
091200200616     C*
091300200616     C** IF 'POSITION SETTLEMENT' IS NOT EQUAL TO ZEROS
091400200616     C           VCTNL1    IFNE *ZEROS                     B*2
091500200616     C*
091600200616     C** ACCESS TO POSITION SETTLEMENT FILE WITH KEY OF
091700200616     C** 1.BRANCH  2.SECURITY  3.CUST.  4.REDEMPTION DATE  5.EVENT TYPE  6.PTFR
091800200616     C                     MOVE 'RC'      K5EVTY
091900200616     C           KEY6      CHAINPOSET1               88
092000200616     C*
092100200616     C** IF THE RECORD IS FOUND
092200200616     C           *IN88     IFEQ '0'                        B*3
092300200616     C*
092400200616     C** IF THE RECORD IDENTIFIER IS 'D'
092500200616     C           RECI      IFEQ 'D'                        B*4
092600200616     C                     MOVE '*'       RECI
092700200616     C                     MOVE 'D'       CHTP
092800200616     C                     Z-ADDBJRDNB    LCD
092900200616     C                     UPDATPOSETDF                89
092901200616     C                     EXSR PSAUDT                                                      AR324886
093000200616     C*
093100200616     C** IF RECORD IS NOT FOUND
093200200616     C           *IN89     IFEQ '1'                        B*5
093300200616     C***********          Z-ADDVCBRCD    WBRCD                           S01496
093400200616     C                     MOVE VCBRCD    WBRCD                           S01496
093500200616     C                     MOVE VASESN    WSESN
093600200616     C**********           Z-ADDVCCNUM    WCNDP                                               CSD027
093700200616     C                     MOVE VCCNUM    WCNDP                                               CSD027
093800200616     C                     Z-ADDVAERRD    WERRD
093900200616     C                     MOVE K5EVTY    WEVTY
094000200616     C                     MOVE VCPTFR    WPTFR
094100200616     C                     Z-ADDVCTNL1    WTNL1
094200200616     C                     Z-ADD7         DBASE            *****************
094300200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 07 **
094400200616     C***********          MOVEL'POSETDF' DBFILE           ************** S01496
094500200616     C                     MOVE 'POSETDF 'DBFILE                          S01496
094600200616     C                     MOVELWKEY56    DBKEY
094700200616     C                     EXSR *PSSR
094800200616     C                     END                             E*5
094900200616     C*
095000200616     C                     ADD  1         W03CNT
095100200616     C                     END                             E*4
095200200616     C*
095300200616     C** IF THE RECORD IDENTIFIER IS 'M'
095400200616     C           RECI      IFEQ 'M'                        B*4
095500200616     C                     MOVE 'R'       RECI
095600200616     C                     MOVE 'R'       CHTP
095700200616     C                     Z-ADDBJRDNB    LCD
095800200616     C                     UPDATPOSETDF                89
095801200616     C                     EXSR PSAUDT                                                      AR324886
095900200616     C*
096000200616     C** IF RECORD IS NOT FOUND
096100200616     C           *IN89     IFEQ '1'                        B*5
096200200616     C***********          Z-ADDVCBRCD    WBRCD                           S01496
096300200616     C                     MOVE VCBRCD    WBRCD                           S01496
096400200616     C                     MOVE VASESN    WSESN
096500200616     C**********           Z-ADDVCCNUM    WCNDP                                               CSD027
096600200616     C                     MOVE VCCNUM    WCNDP                                               CSD027
096700200616     C                     Z-ADDVAERRD    WERRD
096800200616     C                     MOVE K5EVTY    WEVTY
096900200616     C                     MOVE VCPTFR    WPTFR
097000200616     C                     Z-ADDVCTNL1    WTNL1
097100200616     C                     Z-ADD8         DBASE            *****************
097200200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 08 **
097300200616     C***********          MOVEL'POSETDF' DBFILE           ************** S01496
097400200616     C                     MOVE 'POSETDF 'DBFILE                          S01496
097500200616     C                     MOVELWKEY56    DBKEY
097600200616     C                     EXSR *PSSR
097700200616     C                     END                             E*5
097800200616     C*
097900200616     C                     ADD  1         W06CNT
098000200616     C                     END                             E*4
098100200616     C                     END                             E*3
098200200616     C                     END                             E*2
098300200616     C*
098400200616     C** IF 'TRANSACTION REFERENCE' IS NOT EQUAL TO BLANKS
098500200616     C           VCTRRF    IFNE *BLANKS                    B*2
098600200616     C*
098700200616     C** IF 'ER TYPE' IS 'P' (CUSTOMER ALLOCATION RECORD)
098800200616     C           VCERTP    IFEQ 'P'                        B*3
098900200616     C*
099000200616     C** SETUP THE TWO FIELDS (SECURITY/TRANS. REF.) OF DATA STRUCTURE WKEY7
099100200616     C                     MOVE VASESN    WASESN
099200200616     C                     MOVE VCTRRF    WCTRRF
099300200616     C*
099400200616     C** ACCESS TO DEPOT MOVEMENT PREVIOUSLY GENERATED USING 'TRANSACTION REF'
099500200616     C           KEY7      CHAINDPTMV                88
099600200616     C*
099700200616     C** IF THE RECORD IS NOT FOUND
099800200616     C           *IN88     IFEQ '1'                        B*4
099900200616     C                     Z-ADD9         DBASE            *****************
100000200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 09 **
100100200616     C***********          MOVEL'DPTMV'   DBFILE           ************** S01496
100200200616     C                     MOVE 'DPTMV   'DBFILE                          S01496
100300200616     C                     MOVELWKEY7     DBKEY
100400200616     C                     EXSR *PSSR
100500200616     C                     END                             E*4
100600200616     C*
100700200616     C** Access DPTMVDY1 if S01401 is installed.                          S01496
100800200616     C*                                                                   S01496
100900200616     C           *IN41     IFEQ '1'                                       S01496
101000200616     C           KEY7      CHAINDPTMVDY1             88                   S01496
101100200616     C*                                                                   S01496
101200200616     C** Record not found, database error.                                S01496
101300200616     C*                                                                   S01496
101400200616     C           *IN88     IFEQ '1'                                       S01496
101500200616     C                     Z-ADD10        DBASE            ***************S01496
101600200616     C                     MOVEL*BLANKS   DBFILE           * DB ERROR 10 *S01496
101700200616     C                     MOVE 'DPTMVDY1'DBFILE           ***************S01496
101800200616     C                     MOVELWKEY7     DBKEY                           S01496
101900200616     C                     EXSR *PSSR                                     S01496
102000200616     C                     END                                            S01496
102100200616     C*                                                                   S01496
102200200616     C                     MOVE '1'       *IN42                           S01496
102300200616     C                     END                                            S01496
102400200616     C/COPY WNCPYSRC,SE6740C008
102500200616     C*                                                                   S01496
102600200616     C***ACCESS*TO*ALL*EXTENDED*FILES**********************************   S01496
102700200616     C***********                                                         S01496
102800200616     C***IF*MT500*(LZSTAT,*POS.33)*IS*EQUAL*TO*'Y'*********************   S01496
102900200616     C***********M500      IFEQ 'Y'                        B*4            S01496
103000200616     C***********                                                         S01496
103100200616     C***ACCESS*TO*FIRST*EXTENDED*FILE*********************************   S01496
103200200616     C***********KEY7      CHAINDPTMVDXA             88                   S01496
103300200616     C***********                                                         S01496
103400200616     C***IF*THE*RECORD*IS*NOT*FOUND************************************   S01496
103500200616     C************IN88     IFEQ '1'                        B*5            S01496
103600200616     C***********          Z-ADD10        DBASE            ************** S01496
103700200616     C***********          MOVEL*BLANKS   DBFILE           ** DB ERROR 10 S01496
103800200616     C***********          MOVEL'DPTMVDX' DBFILE           ************** S01496
103900200616     C***********          MOVE 'A  '     DBFILE                          S01496
104000200616     C***********          MOVELWKEY7     DBKEY                           S01496
104100200616     C***********          EXSR *PSSR                                     S01496
104200200616     C***********          END                             E*5            S01496
104300200616     C***********          END                             E*4            S01496
104400200616     C***********                                                         S01496
104500200616     C***ACCESS*TO*SECOND*EXTENDED*FILE********************************   S01496
104600200616     C***********KEY7      CHAINDPTMVDX0             88                   S01496
104700200616     C***********                                                         S01496
104800200616     C***IF*THE*RECORD*IS*NOT*FOUND************************************   S01496
104900200616     C************IN88     IFEQ '1'                        B*4            S01496
105000200616     C***********          Z-ADD11        DBASE            ************** S01496
105100200616     C***********          MOVEL*BLANKS   DBFILE           ** DB ERROR 11 S01496
105200200616     C***********          MOVEL'DPTMVDX' DBFILE           ************** S01496
105300200616     C***********          MOVE '0  '     DBFILE                          S01496
105400200616     C***********          MOVELWKEY7     DBKEY                           S01496
105500200616     C***********          EXSR *PSSR                                     S01496
105600200616     C***********          END                             E*4            S01496
105700200616     C***********                                                         S01496
105800200616     C***IF*DEPOT*MOVEMENT*CHARGE*(LZSTAT,*POS.10)*IS*EQUAL*TO*'Y'*****   S01496
105900200616     C***********DMCG      IFEQ 'Y'                        B*4            S01496
106000200616     C***********                                                         S01496
106100200616     C***ACCESS*TO*THIRD*EXTENDED*FILE*********************************   S01496
106200200616     C***********KEY7      CHAINDPTMVDX1             88                   S01496
106300200616     C***********                                                         S01496
106400200616     C***IF*THE*RECORD*IS*NOT*FOUND************************************   S01496
106500200616     C************IN88     IFEQ '1'                        B*5            S01496
106600200616     C***********          Z-ADD12        DBASE            ************** S01496
106700200616     C***********          MOVEL*BLANKS   DBFILE           ** DB ERROR 12 S01496
106800200616     C***********          MOVEL'DPTMVDX' DBFILE           ************** S01496
106900200616     C***********          MOVE '1  '     DBFILE                          S01496
107000200616     C***********          MOVELWKEY7     DBKEY                           S01496
107100200616     C***********          EXSR *PSSR                                     S01496
107200200616     C***********          END                             E*5            S01496
107300200616     C***********          END                             E*4            S01496
107400200616     C*
107500200616     C** WRITE A DEPOT MOVEMENT RECORD AND DEPOT MOVEMENT EXTENDED RECORDS
107600200616     C                     MOVE 'R'       WALLOC
107700200616     C                     EXSR W02
107800200616     C*
107900200616     C** MOVE 'REFERENCE' OF GENERATED RECORD (DPT MOV)
108000200616     C** INTO 'REVERSAL REFERENCE' OF SEERALL0
108100200616     C                     MOVE WWNTRC    VCRVRF
108200200616     C*
108300200616     C** UPDATE EARLY REDEMPTION DEPOT RECORD IN LF/SEERALL0
108400200616     C                     UPDATSEERALD0
108500200616     C*
108600200616     C                     END                             E*3
108700200616     C*
108800200616     C** IF 'ER TYPE' IS 'B' (BOOK ALLOCATION RECORD)
108900200616     C           VCERTP    IFEQ 'B'                        B*3
109000200616     C*
109100200616     C** ACCESS TO TRADE PREVIOUSLY GENERATED USING 'TRANSACTION REFERENCE'
109200200616     C           VCTRRF    CHAINTRADS                88
109300200616     C*
109400200616     C** IF THE RECORD IS NOT FOUND
109500200616     C           *IN88     IFEQ '1'                        B*4
109600200616     C                     Z-ADD13        DBASE            *****************
109700200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 13 **
109800200616     C***********          MOVEL'TRADS'   DBFILE           ************** S01496
109900200616     C                     MOVE 'TRADS   'DBFILE                          S01496
110000200616     C                     MOVELVCTRRF    DBKEY
110100200616     C                     EXSR *PSSR
110200200616     C                     END                             E*4
110300200616     C*
110400200616     C                     MOVE 'C'       RECI
110500200616     C                     MOVE 'D'       CHTP
110600200616     C                     Z-ADDBJRDNB    LCD
110700200616     C                     UPDATTRADSDF
110800200616     C*
110900200616     C** ADD 1 INTO COUNTER OF REVERSED TRADES
111000200616     C                     ADD  1         W04CNT
111100200616      * write to Movement Status file                                     CSE039
111200200616      *                                                                   CSE039
111300200616     C           CSE039    IFEQ 'Y'                                       CSE039
111400200616      *                                                                   CSE039
111500200616      ** Check if record exists (Reference, Type, Notification)           CSE039
111600200616     C                     MOVELTDRF      KTDRF                           CSE039
111700200616     C                     MOVEL'T'       KTRTY                           CSE039
111800200616     C                     Z-ADDBJRDNB    KNTDT                           CSE039
111900200616     C                     Z-ADD0         USQNR   30                      CSE039
112000200616      *                                                                   CSE039
112100200616      ** Get Sequence Number                                              CSE039
112200200616     C           KSEMV     SETLLSEMVTSL1                                  CSE039
112300200616     C                     READ SEMVTSL1                 65               CSE039
112400200616     C           *IN65     IFEQ *OFF                                      CSE039
112500200616     C           KTDRF     ANDEQTMTRRF                                    CSE039
112600200616     C           KTRTY     ANDEQTMTRTY                                    CSE039
112700200616     C           KNTDT     ANDEQTMNTDT                                    CSE039
112800200616     C                     Z-ADDTMSQNR    USQNR                           CSE039
112900200616     C                     ENDIF                                          CSE039
113000200616     C                     MOVELTDRF      TMTRRF                          CSE039
113100200616     C                     MOVEL'T'       TMTRTY                          CSE039
113200200616     C                     Z-ADDBJRDNB    TMNTDT                          CSE039
113300200616     C           USQNR     ADD  1         TMSQNR                          CSE039
113400200616     C                     MOVEL'DEL'     TMSWSC                          CSE039
113500200616     C                     MOVEL*BLANKS   TMSWRC                          CSE039
113600200616     C                     MOVEL*BLANKS   TMNTMT                          CSE039
113700200616     C                     MOVEL*BLANKS   TMLCUS                          CSE039
113800200616     C                     MOVEL'MIDAS'   TMINOR                          CSE039
113900200616     C                     MOVEL*BLANKS   TMMSGK                          CSE039
114000200616     C                     MOVEL*BLANKS   TMSTMG                          CSE039
114100200616     C                     MOVELVARNAR    TMNARR                          CSE039
114200200616     C                     MOVEL'I'       TMLCTP                          CSE039
114300200616     C                     Z-ADDBJRDNB    TMLCDT                          CSE039
114400200616     C                     MOVELTMMP,1    TMTMST                          CSE039
114500200616     C                     MOVELTDBA      TMTRBB                          CSE039
114600200616     C                     MOVE USER      TMLCUS                          CSE039
114700200616      *                                                                   CSE039
114800200616     C                     WRITESEMVTSD0                                  CSE039
114900200616     C                     ENDIF                                          CSE039
115000200616     C                     END                             E*3
115100200616     C                     END                             E*2
115200200616     C*
115300200616     C** ACCESS NEXT RECORD FOR CURRENT ER REFERENCE
115400200616     C                     READ SEERALL0                 89
115500200616     C                     ENDDO                           E*1
115600200616     C*
115700200616     C           EP006R    ENDSR
115800200616     ******************************************************************
115900200616      /EJECT
116000200616     C*****************************************************************
116100200616     C* FIRST
116200200616     C*****************************************************************
116300200616     C*
116400200616     C           FIRST     BEGSR                           ** FIRST **
116500200616     C*
116600200616     C** RETRIEVE RUN DATE AND BASE CURRENCY
116700200616     C************LOVAL    SETLLSDBANKL1                                  S01496
116800200616     C***********          READ SDBANKL1                 89               S01496
116900200616     C*                                                                   S01496
117000200616     C                     CALL 'AOBANKR0'                                S01496
117100200616     C                     PARM '*MSG    '@RTCD   7                       S01496
117200200616     C                     PARM '*FIRST  '@OPTN   7                       S01496
117300200616     C           @BANK     PARM @BANK     DSFDY                           S01496
117400200616     C*
117500200616     C************IN89     IFEQ '1'                                       S01496
117600200616     C           @RTCD     IFNE *BLANK                                    S01496
117700200616     C                     Z-ADD14        DBASE   30       *****************
117800200616     C                     MOVEL*BLANKS   DBFILE 10        ** DB ERROR 14 **
117900200616     C***********          MOVEL'SDBANKL1'DBFILE           ************** S01496
118000200616     C                     MOVE 'SDBANKPD'DBFILE                          S01496
118100200616     C                     MOVEL*BLANKS   DBKEY  29
118200200616     C                     EXSR *PSSR
118300200616     C                     ENDIF
118400200616     C/COPY WNCPYSRC,SE6740C007
118500200616     C*
118600200616     C** RETRIEVE TRADE NUMBER RANGE (BVTRNR)
118700200616     C************LOVAL    SETLLSDSTRDL1                                  S01496
118800200616     C***********          READ SDSTRDL1                 89               S01496
118900200616     C*                                                                   S01496
119000200616     C                     CALL 'AOSTRDR0'                                S01496
119100200616     C                     PARM '*MSG    '@RTCD   7                       S01496
119200200616     C                     PARM '*FIRST  '@OPTN   7                       S01496
119300200616     C           @STRD     PARM @STRD     DSSDY                           S01496
119400200616     C*
119500200616     C************IN89     IFEQ '1'                                       S01496
119600200616     C           @RTCD     IFNE *BLANK                                    S01496
119700200616     C                     Z-ADD15        DBASE            *****************
119800200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 15 **
119900200616     C***********          MOVEL'SDSTRDL1'DBFILE           ************** S01496
120000200616     C                     MOVE 'SDSTRDPD'DBFILE                          S01496
120100200616     C                     MOVEL*BLANKS   DBKEY
120200200616     C                     EXSR *PSSR
120300200616     C                     ENDIF
120400200616     C*
120500200616     C** USING TRADE NUMBER RANGE, CHAIN LF/TNRAN TO RETRIEVE
120600200616     C** NEXT AVAILABLE REFERENCE (NTRN)
120700200616     C                     Z-ADD0         K1RECT
120800200616     C                     MOVEL*BLANKS   K1FILL
120900200616     C                     Z-ADDBVTRNR    K1RANG
121000200616     C*
121100200616     C           KEY1      CHAINTNRANABF             89
121200200616     C*
121300200616     C           *IN89     IFEQ '1'
121400200616     C                     Z-ADD16        DBASE            *****************
121500200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 16 **
121600200616     C***********          MOVEL'TNRAN'   DBFILE           ************** S01496
121700200616     C                     MOVE 'TNRAN   'DBFILE                          S01496
121800200616     C                     MOVELBVTRNR    DBKEY
121900200616     C                     EXSR *PSSR
122000200616     C                     ENDIF
122100200616     C*
122200200616     C                     Z-ADDNTRN      WWNTR1  60       Next Trade Number
122300200616     C/COPY WNCPYSRC,SE6740C014
122400200616     C                     Z-ADDNTRN      WWNTR2  60       Next Depot Number
122500200616     C/COPY WNCPYSRC,SE6740C015
122600200616     C*
122700200616     C** RETRIEVE ACCRUALS/PROFIT DATE
122800200616     C************LOVAL    SETLLSDGELRL1                                  S01496
122900200616     C***********          READ SDGELRL1                 89               S01496
123000200616     C*                                                                   S01496
123100200616     C**********           CALL 'AOGELRR0'                                             S01496 CGL029
123200200616     C                     CALL 'AOGELRR1'                                                    CGL029
123300200616     C                     PARM '*MSG    '@RTCD   7                       S01496
123400200616     C                     PARM '*FIRST  '@OPTN   7                       S01496
123500200616     C********** @GELR     PARM @GELR     DSFDY                                        S01496 CGL029
123600200616     C           @GELR     PARM @GELR     DSSDY                                               CGL029
123700200616     C*
123800200616     C************IN89     IFEQ '1'                                       S01496
123900200616     C           @RTCD     IFNE *BLANK                                    S01496
124000200616     C                     Z-ADD17        DBASE            *****************
124100200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 17 **
124200200616     C***********          MOVEL'SDGELRL1'DBFILE           ************** S01496
124300200616     C                     MOVE 'SDGELRPD'DBFILE                          S01496
124400200616     C                     MOVEL*BLANK    DBKEY
124500200616     C                     EXSR *PSSR
124600200616     C                     ENDIF
124700200616     C*                                                                   S01496
124800200616     C** Check if S01445 is installed.                                    S01496
124900200616     C*                                                                   S01496
125000200616     C                     CALL 'AOSARDR0'                                S01496
125100200616     C                     PARM *BLANKS   @RTCD                           S01496
125200200616     C                     PARM '*VERIFY' @OPTN                           S01496
125300200616     C                     PARM 'S01445'  @SARC   6                       S01496
125400200616     C           @SARD     PARM @SARD     DSFDY                           S01496
125500200616     C*                                                                   S01496
125600200616     C** Set indicator if installed.                                      S01496
125700200616     C*                                                                   S01496
125800200616     C           @RTCD     IFEQ *BLANK                                    S01496
125900200616     C                     MOVE '1'       *IN40                           S01496
126000200616     C                     END                                            S01496
126100200616     C*                                                                   S01496
126200200616     C** Check if S01401 is installed.                                    S01496
126300200616     C*                                                                   S01496
126400200616     C                     CALL 'AOSARDR0'                                S01496
126500200616     C                     PARM *BLANKS   @RTCD                           S01496
126600200616     C                     PARM '*VERIFY' @OPTN                           S01496
126700200616     C                     PARM 'S01401'  @SARC   6                       S01496
126800200616     C           @SARD     PARM @SARD     DSFDY                           S01496
126900200616     C*                                                                   S01496
127000200616     C** Open file DPTMVDY1 and set indicator if installed.               S01496
127100200616     C*                                                                   S01496
127200200616     C           @RTCD     IFEQ *BLANK                                    S01496
127300200616     C                     OPEN DPTMVDY1                                  S01496
127400200616     C                     OPEN DPTMVDL1                                  CPB001
127500200616     C                     MOVE '1'       *IN41                           S01496
127600200616     C                     END                                            S01496
127700200616      *                                                                   CAC005
127800200616      ** Check if CAC005 is installed                                     CAC005
127900200616      *                                                                   CAC005
128000200616     C                     CALL 'AOSARDR0'                                CAC005
128100200616     C                     PARM *BLANKS   PRTCD   7                       CAC005
128200200616     C                     PARM '*VERIFY' POPTN   7                       CAC005
128300200616     C                     PARM 'CAC005'  PSARD   6                       CAC005
128400200616      *                                                                   CAC005
128500200616     C           PRTCD     IFEQ *BLANKS                                   CAC005
128600200616     C                     MOVE 'Y'       CAC005  1                       CAC005
128700200616     C                     ELSE                                           CAC005
128800200616     C                     MOVE 'N'       CAC005                          CAC005
128900200616     C                     ENDIF                                          CAC005
129000200616     C/COPY WNCPYSRC,SE6740C002
129100200616      *                                                                   CSE012
129200200616      **  Determine if feature CSE012 is installed.                       CSE012
129300200616      *                                                                   CSE012
129400200616     C                     MOVE 'N'       CSE012  1                       CSE012
129500200616     C                     CALL 'AOSARDR0'                                CSE012
129600200616     C                     PARM '       ' @RTCD                           CSE012
129700200616     C                     PARM '*VERIFY' @OPTN                           CSE012
129800200616     C                     PARM 'CSE012'  @SARC                           CSE012
129900200616      *                                                                   CSE012
130000200616     C           @RTCD     IFEQ *BLANK                                    CSE012
130100200616     C                     MOVE 'Y'       CSE012                          CSE012
130200200616     C                     ELSE                                           CSE012
130300200616     C                     MOVE 'N'       CSE012                          CSE012
130400200616      *                                                                   CSE012
130500200616      ** Database Error (return code other than *NRF)                     CSE012
130600200616      *                                                                   CSE012
130700200616     C           @RTCD     IFNE '*NRF   '                                 CSE012
130800200616     C           *LOCK     IN   LDA                                       CSE012
130900200616     C                     MOVEL'SCSARDPD'DBFILE           ***************CSE012
131000200616     C                     MOVEL'CSE012'  DBKEY            * DB ERROR 21 *CSE012
131100200616     C                     Z-ADD21        DBASE            ***************CSE012
131200200616     C                     OUT  LDA                                       CSE012
131300200616     C                     MOVE *ON       *INU7                           CSE012
131400200616     C                     MOVE *ON       *INU8                           CSE012
131500200616     C                     MOVE *ON       *INLR                           CSE012
131600200616     C                     EXSR *PSSR                                     CSE012
131700200616     C                     ENDIF                                          CSE012
131800200616      *                                                                   CSE012
131900200616     C                     ENDIF                                          CSE012
132000200616      *                                                                   CSE012
132100200616      **  If feature CSE012 is installed.                                 CSE012
132200200616      *                                                                   CSE012
132300200616     C           CSE012    IFEQ 'Y'                                       CSE012
132400200616      *                                                                   CSE012
132500200616      **  If found, check system date format, DDMMYY or MMDDYY.           CSE012
132600200616      *                                                                   CSE012
132700200616     C           BJDFIN    IFEQ 'M'                                       CSE012
132800200616     C                     MOVE '1'       *IN98                           CSE012
132900200616     C                     ELSE                                           CSE012
133000200616     C                     MOVE '0'       *IN98                           CSE012
133100200616     C                     ENDIF                                          CSE012
133200200616      *                                                                   CSE012
133300200616     C                     ENDIF                                          CSE012
133400200616      *                                                                   CSE017
133500200616      ** Determine if feature CSE017 is installed.                        CSE017
133600200616      *                                                                   CSE017
133700200616     C                     MOVE 'N'       CSE017  1                       CSE017
133800200616     C                     CALL 'AOSARDR0'                                CSE017
133900200616     C                     PARM '       ' @RTCD                           CSE017
134000200616     C                     PARM '*VERIFY' @OPTN                           CSE017
134100200616     C                     PARM 'CSE017'  @SARC                           CSE017
134200200616      *                                                                   CSE017
134300200616     C           @RTCD     IFEQ *BLANK                                    CSE017
134400200616     C                     MOVE 'Y'       CSE017                          CSE017
134500200616     C                     ELSE                                           CSE017
134600200616     C                     MOVE 'N'       CSE017                          CSE017
134700200616      *                                                                   CSE017
134800200616      ** Database Error (return code other than *NRF)                     CSE017
134900200616      *                                                                   CSE017
135000200616     C           @RTCD     IFNE '*NRF   '                                 CSE017
135100200616     C           *LOCK     IN   LDA                                       CSE017
135200200616     C                     MOVEL'SCSARDPD'DBFILE           ************   CSE017
135300200616     C                     MOVEL'CSE017'  DBKEY            * DBERR 22 *   CSE017
135400200616     C                     Z-ADD22        DBASE            ************   CSE017
135500200616     C                     OUT  LDA                                       CSE017
135600200616     C                     MOVE *ON       *INU7                           CSE017
135700200616     C                     MOVE *ON       *INU8                           CSE017
135800200616     C                     MOVE *ON       *INLR                           CSE017
135900200616     C                     EXSR *PSSR                                     CSE017
136000200616     C                     ENDIF                                          CSE017
136100200616      *                                                                   CSE017
136200200616     C                     ENDIF                                          CSE017
136300200616      *                                                                                       207006
136400200616      ** Determine if feature CSE029 is installed                                             207006
136500200616      *                                                                                       207006
136600200616     C                     MOVE 'N'       CSE029  1                                           207006
136700200616     C                     CALL 'AOSARDR0'                                                    207006
136800200616     C                     PARM '       ' @RTCD                                               207006
136900200616     C                     PARM '*VERIFY' @OPTN                                               207006
137000200616     C                     PARM 'CSE029'  @SARC                                               207006
137100200616      *                                                                                       207006
137200200616      ** Database Error (return code other than *NRF)                                         207006
137300200616      *                                                                                       207006
137400200616     C           @RTCD     IFNE '*NRF   '                                                     207006
137500200616     C           @RTCD     ANDNE*BLANKS                                                       207006
137600200616     C           *LOCK     IN   LDA                                                           207006
137700200616     C                     MOVEL'SCSARDPD'DBFILE                                              207006
137800200616     C                     MOVEL'CSE029'  DBKEY                                               207006
137900200616     C                     Z-ADD24        DBASE                                               207006
138000200616     C                     OUT  LDA                                                           207006
138100200616     C                     MOVE *ON       *INU7                                               207006
138200200616     C                     MOVE *ON       *INU8                                               207006
138300200616     C                     MOVE *ON       *INLR                                               207006
138400200616     C                     EXSR *PSSR                                                         207006
138500200616     C                     ENDIF                                                              207006
138600200616      *                                                                                       207006
138700200616     C           @RTCD     IFEQ *BLANK                                                        207006
138800200616     C                     MOVE 'Y'       CSE029                                              207006
138900200616     C                     ENDIF                                                              207006
139000200616      *                                                                                       CSE039
139100200616      ** Determine if feature CSE039 is installed                                             CSE039
139200200616      *                                                                                       CSE039
139300200616     C                     MOVE 'N'       CSE039  1                                           CSE039
139400200616     C                     CALL 'AOSARDR0'                                                    CSE039
139500200616     C                     PARM '       ' @RTCD                                               CSE039
139600200616     C                     PARM '*VERIFY' @OPTN                                               CSE039
139700200616     C                     PARM 'CSE039'  @SARC                                               CSE039
139800200616      *                                                                                       CSE039
139900200616     C           @RTCD     IFEQ *BLANK                                                        CSE039
140000200616     C                     MOVE 'Y'       CSE039                                              CSE039
140100200616     C                     ENDIF                                                              CSE039
140200200616      *                                                                                       CSE040
140300200616      ** Determine if feature CSE040 is installed                                             CSE040
140400200616      *                                                                                       CSE040
140500200616     C                     MOVE 'N'       CSE040  1                                           CSE040
140600200616     C                     CALL 'AOSARDR0'                                                    CSE040
140700200616     C                     PARM '       ' @RTCD                                               CSE040
140800200616     C                     PARM '*VERIFY' @OPTN                                               CSE040
140900200616     C                     PARM 'CSE040'  @SARC                                               CSE040
141000200616      *                                                                                       CSE040
141100200616     C           @RTCD     IFEQ *BLANK                                                        CSE040
141200200616     C                     MOVE 'Y'       CSE040                                              CSE040
141300200616     C                     ENDIF                                                              CSE040
141400200616      *                                                                                       234829
141500200616      ** Check if CGL031 is installed                                                         234829
141600200616      *                                                                                       234829
141700200616     C                     CALL 'AOSARDR0'                                                    234829
141800200616     C                     PARM *BLANKS   PRTCD   7                                           234829
141900200616     C                     PARM '*VERIFY' POPTN   7                                           234829
142000200616     C                     PARM 'CGL031'  PSARD   6                                           234829
142100200616      *                                                                                       234829
142200200616     C           PRTCD     IFEQ *BLANKS                                                       234829
142300200616     C                     MOVE 'Y'       CGL031  1                                           234829
142400200616     C                     ENDIF                                                              234829
142500200616     C*
142600200616     C           EFIRST    ENDSR
142700200616     C********************************************************************
142800200616      /EJECT
142900200616     C********************************************************************
143000200616     C*  W01 - WRITE A TRADE RECORD                                      *
143100200616     C********************************************************************
143200200616     C*
143300200616     C           W01       BEGSR
143400200616     C*
143500200616     C** .. Trade reference
143600200616     C                     MOVE WWNTR1    WWNTRC  6
143700200616     C           WWNTRC    CHAINTRADHS               89
143800200616     C*
143900200616     C           *IN89     DOWEQ'0'
144000200616     C                     ADD  1         WWNTR1
144100200616     C                     MOVE WWNTR1    WWNTRC
144200200616     C           WWNTRC    CHAINTRADHS               89
144300200616     C                     ENDDO
144400200616     C                     ADD  1         WWNTR1
144500200616     C*
144600200616     C                     MOVE WWNTRC    TDRF
144700200616     C** .. Incomplete indicator
144800200616     C                     MOVE 'C'       TINC
144900200616     C** .. Security
145000200616     C                     MOVELVASESN    TDSS
145100200616     C** .. Counterparty Customer nummer
145200200616     C***********          MOVE VCBRCD    K2BRCD                          S01496
145300200616     C***********KEY2      CHAINSDBRCHL0             89                   S01496
145400200616     C                     MOVE VCBRCD    K2BRCD  3                       S01496
145500200616     C*                                                                   S01496
145600200616     C**********           CALL 'AOBRCHR0'                                             S01496 CGL029
145700200616     C                     CALL 'AOBRCHR1'                                                    CGL029
145800200616     C                     PARM *BLANKS   @RTCD                           S01496
145900200616     C                     PARM '*KEY   ' @OPTN                           S01496
146000200616     C                     PARM K2BRCD    @BRCA   3                       S01496
146100200616     C********** @BRCH     PARM @BRCH     DSFDY                                        S01496 CGL029
146200200616     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
146300200616     C*                                                                   S01496
146400200616     C                     MOVE A8BICN    TCNR
146500200616     C** .. Trade Type and nominal
146600200616     C           VCNOMA    IFGT *ZEROS
146700200616     C                     MOVE 'TS'      TDTP
146800200616     C                     Z-ADDVCNOMA    NOML
146900200616     C                     ELSE
147000200616     C                     MOVE 'TP'      TDTP
147100200616     C                     Z-SUBVCNOMA    NOML
147200200616     C                     ENDIF
147300200616     C** .. Nominal currency
147400200616     C                     MOVE NMCY      TNMC
147500200616     C** .. Nominal decimal places
147600200616     C                     Z-ADDNMDP      TNMD
147700200616     C** .. Price/Discount/Yield
147800200616     C                     Z-ADDVAREDP    TPDY
147900200616     C** .. Value Date
148000200616     C                     Z-ADDVAERRD    TDVD
148100200616     C** .. Branch
148200200616     C***********          Z-ADDVCBRCD    TDBR                            S01496
148300200616     C                     MOVE VCBRCD    TDBA                            S01496
148400200616     C** .. Book
148500200616     C                     MOVELVCBOOK    TDBK
148600200616      *                                                                   CAC005
148700200616      ** If CAC005 is installed, retrieve the corresponding profit        CAC005
148800200616      ** centre.  VCBOOK in the Early Redemptions-Allocation file         CAC005
148900200616      ** is being held as a pseudo book.                                  CAC005
149000200616      *                                                                   CAC005
149100200616     C           CAC005    IFEQ 'Y'                                       CAC005
149200200616     C                     CALL 'AOBKPCR0'                                CAC005
149300200616     C                     PARM *BLANKS   PRTCD                           CAC005
149400200616     C                     PARM '*USER  ' POPTN                           CAC005
149500200616     C                     PARM           PBKCD   2                       CAC005
149600200616     C                     PARM           PPRFC   4                       CAC005
149700200616     C                     PARM VCBOOK    PPSBK   2                       CAC005
149800200616      *                                                                   CAC005
149900200616     C           PRTCD     IFEQ *BLANKS                                   CAC005
150000200616     C                     MOVELPPRFC     BPRC                            CAC005
150100200616     C                     ELSE                                           CAC005
150200200616     C                     MOVE *BLANKS   BPRC                            CAC005
150300200616     C                     ENDIF                                          CAC005
150400200616     C                     ENDIF                                          CAC005
150500200616     C** .. Trade Date
150600200616     C                     Z-ADDVAERRD    TDDT
150700200616     C** .. Trade Subtype
150800200616     C                     MOVELBVDTDS    TSUB
150900200616     C** .. Link Reference
151000200616     C                     MOVE *ZEROS    LKRF
151100200616     C** .. Market Indicator
151200200616     C                     MOVE MKTI      TDMI
151300200616     C** .. Narrative
151400200616     C                     MOVELVARNAR    TDNR
151500200616     C           CSE040    IFEQ 'Y'                                       CSE040
151600200616     C                     MOVE 'ER'      TDNR                            CSE040
151700200616     C                     ENDIF                                          CSE040
151800200616     C** .. Trader ID
151900200616     C                     MOVEL*BLANKS   TDID
152000200616     C** .. AIBD/IPMA
152100200616     C                     MOVE 'Y'       AIIP
152200200616     C** .. Market Centre
152300200616     C                     MOVELSMCC      TMKC
152400200616     C** .. Capacity
152500200616     C                     MOVE *ZEROS    TCAP
152600200616     C** .. Current Factor
152700200616     C                     MOVE *ZEROS    TCFC
152800200616     C** .. Accrued Indicator
152900200616     C                     MOVE 'F'       ACIN
153000200616     C** .. Days Adjustment
153100200616     C                     MOVE *ZEROS    DADJ
153200200616     C** .. Actual/Difference Indicator
153300200616     C                     MOVE *BLANKS   ADIN
153400200616     C** .. Interest Amount
153500200616     C                     MOVE *ZEROS    ITRA
153600200616     C** .. Interest Adjustment
153700200616     C                     MOVE *ZEROS    TINA
153800200616     C** .. Coupon Rate
153900200616     C                     Z-ADDCPNR      TDCR
154000200616     C** .. Price
154100200616     C                     Z-ADDVAREDP    PRIC
154200200616     C** .. Ex-Dividend
154300200616     C                     MOVE *BLANKS   EXDV
154400200616     C** .. Reallowance
154500200616     C                     MOVE *ZEROS    RALL
154600200616     C** .. Settlement Currency
154700200616     C                     MOVE NMCY      SETC
154800200616     C** .. Exchange Rate
154900200616     C                     Z-ADD1         TDER
155000200616     C** .. Multiply/Divide Ind.
155100200616     C                     MOVE 'M'       TMDI
155200200616     C** .. Base Currency Rate
155300200616     C                     Z-ADDWNSPRT    TBCR
155400200616     C** .. Settlement method
155500200616     C                     Z-ADD*ZERO     SMTH
155600200616     C** .. Pay From
155700200616     C                     MOVE *BLANKS   PYFM
155800200616     C** .. Pay From Branch
155900200616     C***********          MOVE *BLANKS   PYFB                            S01496
156000200616     C                     MOVE *BLANKS   PYFA                            S01496
156100200616     C** .. Pay To
156200200616     C                     MOVE *BLANKS   PAYT
156300200616     C** .. Pay To Branch
156400200616     C***********          MOVE *BLANKS   PYTB                            S01496
156500200616     C                     MOVE *BLANKS   PYTA                            S01496
156600200616     C** .. For Account of (Deliver to)
156700200616     C                     MOVE *BLANKS   TDFA
156800200616     C** .. Account Sequence Number
156900200616     C                     MOVE *BLANKS   ASNM
157000200616     C** .. Clearence Type
157100200616     C                     MOVE *BLANK    CLTY
157200200616     C** .. Deliver To
157300200616     C**********           Z-ADDVCDDPT    DELT                                                CSD027
157400200616     C                     MOVE VCDDPT    DELT                                                CSD027
157500200616     C** .. For Account of
157600200616     C                     MOVE *BLANKS   DTFA
157700200616     C** .. Deliver From
157800200616     C**********           Z-ADDVCDDPT    DELF                                                CSD027
157900200616     C                     MOVE VCDDPT    DELF                                                CSD027
158000200616     C** .. For Account of
158100200616     C                     MOVE *BLANKS   DFFA
158200200616     C** .. Special Instruction
158300200616     C                     MOVE *BLANKS   TDSI
158400200616     C** .. Priority Code
158500200616     C                     MOVE *BLANK    PRYC
158600200616     C** .. Pay Code
158700200616     C                     MOVE *BLANK    PCOD
158800200616     C** .. Broker Commission Code
158900200616     C                     MOVE *BLANKS   TBCC
159000200616     C** .. Broker Commission Amount
159100200616     C                     Z-ADD*ZEROS    TBCA
159200200616     C** .. Broker Commission Code
159300200616     C                     MOVE *BLANKS   TCCC
159400200616     C** .. Customer Commission Amount
159500200616     C                     Z-ADD*ZEROS    TCCA
159600200616     C** .. Charges Code 1 - 7
159700200616     C                     MOVE *BLANKS   TCC1
159800200616     C                     MOVE *BLANKS   TCC2
159900200616     C                     MOVE *BLANKS   TCC3
160000200616     C                     MOVE *BLANKS   TCC4
160100200616     C                     MOVE *BLANKS   TCC5
160200200616     C                     MOVE *BLANKS   TCC6
160300200616     C                     MOVE *BLANKS   TCC7
160400200616     C** .. Charges Amount 1 - 7
160500200616     C                     Z-ADD*ZEROS    TCA1
160600200616     C                     Z-ADD*ZEROS    TCA2
160700200616     C                     Z-ADD*ZEROS    TCA3
160800200616     C                     Z-ADD*ZEROS    TCA4
160900200616     C                     Z-ADD*ZEROS    TCA5
161000200616     C                     Z-ADD*ZEROS    TCA6
161100200616     C                     Z-ADD*ZEROS    TCA7
161200200616     C** .. Tax Amount
161300200616     C                     Z-ADD*ZEROS    TAXA
161400200616     C** .. Broker Commission Rebate
161500200616     C                     Z-ADD0         BCMR
161600200616     C** .. Customer Commission Rebate
161700200616     C                     Z-ADD0         CCMR
161800200616     C** .. Tax Rebate
161900200616     C                     Z-ADD0         TXRB
162000200616     C** .. Bulk Reference
162100200616     C                     MOVE *BLANKS   BLKR
162200200616     C** .. Related Trade Reference
162300200616     C                     MOVE *BLANKS   RTRF
162400200616     C** .. Agency Trade Identifier
162500200616     C                     MOVE *BLANKS   ATRD
162600200616     C** .. Bulk confirmation required
162700200616     C                     MOVE *BLANKS   BCON
162800200616     C** .. Time of Input
162900200616     C                     TIME           WWTIME  60
163000200616     C                     Z-ADDWWTIME    TIME
163100200616     C** .. Autosettle Indicator
163200200616     C                     MOVE 'N'       AUTS
163300200616     C** .. Accounting Indicator
163400200616     C                     BITOF'01234567'TACI
163500200616     C** .. Message Indicator
163600200616     C                     BITOF'01234567'TMSI
163700200616     C** .. Confirmation Required
163800200616     C                     MOVE 'N'       TCFR
163900200616     C** .. Outstanding Nominal
164000200616     C                     Z-ADDNOML      TOSN
164100200616     C** .. Nominal Settled - not posted
164200200616     C                     Z-ADD*ZEROS    TNSN
164300200616     C** .. Nominal Settled - posted
164400200616     C                     Z-ADD*ZEROS    TNSP
164500200616     C** .. Outstanding Value
164600200616     C                     Z-ADD*ZEROS    TOSV
164700200616     C** .. Value Settled - not posted
164800200616     C                     Z-ADD*ZEROS    TVSN
164900200616     C** .. Value Settled - posted
165000200616     C                     Z-ADD*ZEROS    TVSP
165100200616     C** .. Discrepancy - not posted
165200200616     C                     Z-ADD*ZEROS    TDSN
165300200616     C** .. Discrepancy - posted
165400200616     C                     Z-ADD*ZEROS    TDSP
165500200616     C** .. Date Fully Settled
165600200616     C                     Z-ADD*ZEROS    TDFS
165700200616     C** .. Settlement Sequence
165800200616     C                     Z-ADD*ZEROS    TSSQ
165900200616     C** .. Consideration
166000200616     C                     Z-ADDNOML      ZNOML
166100200616     C                     Z-ADDVAREDP    ZAVPR
166200200616     C                     EXSR ZAPNUM
166300200616     C                     Z-ADDZVALU     TCSR
166400200616     C** .. Countervalue
166500200616     C                     Z-ADDTCSR      TCTR
166600200616     C** .. Date Made Complete
166700200616     C                     Z-ADDBJRDNB    TDMC
166800200616     C** .. Original Entry Date
166900200616     C                     Z-ADDBJRDNB    TOED
167000200616     C** .. Last Change Date
167100200616     C                     Z-ADDBJRDNB    LCD
167200200616     C** .. Type of last change
167300200616     C                     MOVE 'I'       CHTP
167400200616     C** .. Transaction number of last Update
167500200616     C                     Z-ADD0         TNLU
167600200616     C** .. Last SWIFT Sequence
167700200616     C                     Z-ADD0         LSWS
167800200616     C** .. Portfolio Reference
167900200616     C                     MOVE *BLANKS   PTFR
168000200616     C** .. Echange Rate (Settle - Port)
168100200616     C                     Z-ADD0         SPXR
168200200616     C** .. Spot Rate Mult/Div Indicator
168300200616     C                     MOVE *BLANKS   SPMD
168400200616     C*
168500200616     C                     MOVE 'D'       RECI
168600200616     C*
168700200616     C** UPDATE TRADE DETAILS
168800200616     C                     MOVE *BLANKS   FRNT                            220225
168900200616      * Initialise Time Stamp                                                                 235041
169000200616     C                     MOVEASTAMP,1   TMST             Default Time                       235041
169100200616      *                                                                                       235041
169200200616     C                     WRITETRADSDF
169300200616     C                     ADD  1         W01CNT
169400200616     C*
169500200616     C***UPDATE*EXTENSION*FILE*****************************************   S01496
169600200616     C***********          MOVE TDRF      TRTRAD                          S01496
169700200616     C***********          MOVE 'NNY'     TROPET                          S01496
169800200616     C***********          MOVE *BLANKS   TRTRAN                          S01496
169900200616     C***********          MOVE 'Y'       TRTAXR                          S01496
170000200616     C***********          MOVE *BLANKS   TRFORS                          S01496
170100200616     C***********          MOVE *BLANKS   TRMRCU                          S01496
170200200616     C***********          Z-ADD0         TRAMTS                          S01496
170300200616     C***********          MOVE *BLANKS   TRKEYC                          S01496
170400200616     C***********          Z-ADD0         TRRATC                          S01496
170500200616     C***********          Z-ADD0         TRAMTX                          S01496
170600200616     C***********          Z-ADD0         TRRATX                          S01496
170700200616     C***********          MOVE *BLANKS   TRPRTR                          S01496
170800200616     C***********                                                         S01496
170900200616     C***********          WRITECHTRADDC                                  S01496
171000200616     C/COPY WNCPYSRC,SE6740C003
171100200616      *                                                                   CSE039
171200200616      * write to Movement Status file                                     CSE039
171300200616      *                                                                   CSE039
171400200616     C           CSE039    IFEQ 'Y'                                       CSE039
171500200616     C                     MOVELTDRF      TMTRRF                          CSE039
171600200616     C                     MOVEL'T'       TMTRTY                          CSE039
171700200616     C                     Z-ADDBJRDNB    TMNTDT                          CSE039
171800200616     C                     Z-ADD1         TMSQNR                          CSE039
171900200616     C                     MOVEL'INS'     TMSWSC                          CSE039
172000200616     C                     MOVEL*BLANKS   TMSWRC                          CSE039
172100200616     C                     MOVEL*BLANKS   TMNTMT                          CSE039
172200200616     C                     MOVEL*BLANKS   TMLCUS                          CSE039
172300200616     C                     MOVEL'MIDAS'   TMINOR                          CSE039
172400200616     C                     MOVEL*BLANKS   TMMSGK                          CSE039
172500200616     C                     MOVEL*BLANKS   TMSTMG                          CSE039
172600200616     C                     MOVELVARNAR    TMNARR                          CSE039
172700200616     C                     MOVEL'I'       TMLCTP                          CSE039
172800200616     C                     Z-ADDBJRDNB    TMLCDT                          CSE039
172900200616     C                     MOVELTMMP,1    TMTMST                          CSE039
173000200616     C                     MOVELTDBA      TMTRBB                          CSE039
173100200616     C                     MOVE USER      TMLCUS                          CSE039
173200200616      *                                                                   CSE039
173300200616     C                     WRITESEMVTSD0                                  CSE039
173400200616     C                     ENDIF                                          CSE039
173500200616     C*
173600200616     C                     ENDSR
173700200616     C********************************************************************
173800200616      /EJECT
173900200616     C********************************************************************
174000200616     C*  W02 - WRITE A DEPOT MOVEMENT RECORD                             *
174100200616     C********************************************************************
174200200616     C*
174300200616     C           W02       BEGSR
174400200616     C** .. Security
174500200616     C                     MOVELVASESN    DPSS
174600200616     C** .. Reference
174700200616     C                     MOVE WWNTR2    WWNTRC  6
174800200616     C*                                                                   CPB001
174900200616     C** If MT500 or Private Banking Module is installed.                 CPB001
175000200616     C           *IN41     IFEQ *ON                        Begin *IN41    CPB001
175100200616     C           BGN4ST    OREQ 'Y'                                       CPB001
175200200616     C*                                                                   CPB001
175300200616     C** Access Depot Movement File by Reference Number to retrieve       CPB001
175400200616     C** next available unique Reference Number.                          CPB001
175500200616     C           WWNTRC    CHAINDPTMVDL1             89                   CPB001
175600200616     C           *IN89     DOWEQ*OFF                       Begin DO_W_89  CPB001
175700200616     C                     ADD  1         WWNTR2                          CPB001
175800200616     C                     MOVE WWNTR2    WWNTRC                          CPB001
175900200616     C           WWNTRC    CHAINDPTMVDL1             89                   CPB001
176000200616     C*                                                                   CPB001
176100200616     C                     ENDDO                           End DO_W_89    CPB001
176200200616     C*                                                                   CPB001
176300200616     C                     ELSE                            Else *IN41     CPB001
176400200616     C/COPY WNCPYSRC,SE6740C011
176500200616     C           KEY3      CHAINDPTMV                89
176600200616     C           *IN89     DOWEQ'0'
176700200616     C                     ADD  1         WWNTR2
176800200616     C                     MOVE WWNTR2    WWNTRC
176900200616     C           KEY3      CHAINDPTMV                89
177000200616     C                     ENDDO
177100200616     C*                                                                   CPB001
177200200616     C                     ENDIF                                          CPB001
177300200616     C/COPY WNCPYSRC,SE6740C012
177400200616     C                     ADD  1         WWNTR2
177500200616     C*
177600200616     C                     MOVE WWNTRC    DPRN
177700200616     C*
177800200616     C** .. In Depot, Out Depot, Movement Date In, Movement Date Out
177900200616     C**********           Z-ADD0         DPID                                                CSD027
178000200616     C                     MOVE *BLANKS   DPID                                                CSD027
178100200616     C                     Z-ADD0         DPMD
178200200616     C**********           Z-ADD0         DPOD                                                CSD027
178300200616     C                     MOVE *BLANKS   DPOD                                                CSD027
178400200616     C                     Z-ADD0         DPDO
178500200616     C*
178600200616     C           WALLOC    IFNE 'R'
178700200616     C*
178800200616     C** .. Movement Type and Nominal
178900200616     C           VCNOMA    IFGT *ZEROS
179000200616     C                     MOVE 'WO'      DPMV
179100200616     C**********           Z-ADDVCDDPT    DPOD                                                CSD027
179200200616     C                     MOVE VCDDPT    DPOD                                                CSD027
179300200616     C                     Z-ADDVAERRD    DPDO
179400200616     C                     Z-ADDVCNOMA    DPNA
179500200616     C                     ELSE
179600200616     C                     MOVE 'WI'      DPMV
179700200616     C**********           Z-ADDVCDDPT    DPID                                                CSD027
179800200616     C                     MOVE VCDDPT    DPID                                                CSD027
179900200616     C                     Z-ADDVAERRD    DPMD
180000200616     C                     Z-SUBVCNOMA    DPNA
180100200616     C                     ENDIF
180200200616     C*
180300200616     C                     ELSE
180400200616     C           DPMV      IFEQ 'WI'
180500200616     C                     MOVE 'WO'      DPMV
180600200616     C**********           Z-ADDVCDDPT    DPOD                                                CSD027
180700200616     C                     MOVE VCDDPT    DPOD                                                CSD027
180800200616     C                     Z-ADDVAERRD    DPDO
180900200616     C                     ELSE
181000200616     C                     MOVE 'WI'      DPMV
181100200616     C**********           Z-ADDVCDDPT    DPID                                                CSD027
181200200616     C                     MOVE VCDDPT    DPID                                                CSD027
181300200616     C                     Z-ADDVAERRD    DPMD
181400200616     C                     ENDIF
181500200616     C*
181600200616     C           VCNOMA    IFGT *ZEROS
181700200616     C                     Z-ADDVCNOMA    DPNA
181800200616     C                     ELSE
181900200616     C                     Z-SUBVCNOMA    DPNA
182000200616     C                     ENDIF
182100200616     C*
182200200616     C                     ENDIF
182300200616     C** .. Branch
182400200616     C***********          Z-ADDVCBRCD    DPBC                            S01496
182500200616     C                     MOVE VCBRCD    DPBA                            S01496
182600200616     C** .. Originating branch                                            S01496
182700200616     C                     MOVE VCBRCD    ORBR                            S01496
182800200616     C** .. Book
182900200616     C                     MOVELBVDPBC    DPBK
183000200616      *                                                                   CAC005
183100200616      ** Retrieve the customer position profit centre from SEPCCD         CAC005
183200200616      *                                                                   CAC005
183300200616     C           KEY8      CHAINSEPCCDF              87                   CAC005
183400200616     C           *IN87     IFEQ *OFF                                      CAC005
183500200616     C                     MOVELPCCU      DPPC                            CAC005
183600200616     C                     ELSE                                           CAC005
183700200616     C                     MOVE *BLANKS   DPPC                            CAC005
183800200616     C                     ENDIF                                          CAC005
183900200616      *                                                                   CAC005
184000200616      ** If CAC005 is installed, retrieve the pseudo book                 CAC005
184100200616      *                                                                   CAC005
184200200616     C           CAC005    IFEQ 'Y'                                       CAC005
184300200616     C                     CALL 'AOBKPCR0'                                CAC005
184400200616     C                     PARM *BLANKS   PRTCD                           CAC005
184500200616     C                     PARM '*PSEUDO' POPTN                           CAC005
184600200616     C                     PARM DPBK      PBKCD   2                       CAC005
184700200616     C                     PARM DPPC      PPRFC   4                       CAC005
184800200616     C                     PARM           PPSBK   2                       CAC005
184900200616      *                                                                   CAC005
185000200616     C           PRTCD     IFEQ *BLANKS                                   CAC005
185100200616     C                     MOVELPPSBK     DPBK                            CAC005
185200200616     C                     ENDIF                                          CAC005
185300200616     C                     ENDIF                                          CAC005
185400200616     C** .. Market Indicator
185500200616     C                     MOVE MKTI      DPMK
185600200616     C** .. Beneficial Customer
185700200616     C                     MOVE VCCNUM    DPBN
185800200616     C** .. Narrative
185900200616     C                     MOVELVARNAR    DPNR
186000200616     C           CSE040    IFEQ 'Y'                                       CSE040
186100200616     C                     MOVE 'ER'      DPNR                            CSE040
186200200616     C                     ENDIF                                          CSE040
186300200616     C** .. Market Price
186400200616     C                     Z-ADDVAREDP    MKTP
186500200616     C** .. Associated deal number
186600200616     C                     Z-ADD0         DPAD
186700200616     C** .. Switch reference
186800200616     C                     MOVE *BLANKS   SWRF
186900200616     C** .. Switch In/On Indicator
187000200616     C                     MOVE *BLANKS   SIOI
187100200616     C** .. Message Indicator
187200200616     C                     BITOF'0'       DPMS
187300200616     C** .. Confirmation Required
187400200616     C                     MOVE 'N'       DCFR
187500200616     C** .. Accounting Indicator
187600200616     C                     BITOF'01'      TACI
187700200616     C** .. Depot Required 1                                              S01496
187800200616     C                     MOVE 'N'       DPR1                            S01496
187900200616     C** .. Depot Required 2                                              S01496
188000200616     C                     MOVE 'N'       DPR2                            S01496
188100200616     C** .. Original Entry Date
188200200616     C                     Z-ADDBJRDNB    ORED
188300200616     C** .. Last Change Date
188400200616     C                     Z-ADDBJRDNB    LCD
188500200616     C** .. Type of last change
188600200616     C                     MOVE 'I'       CHTP
188700200616     C** .. Transaction number of last Update
188800200616     C                     EXSR ZTNLU1
188900200616     C                     Z-ADDNATN      TNLU
189000200616     C** .. Repo/Pledge Indicator
189100200616     C                     MOVE *BLANKS   RPIN
189200200616     C** .. Portfolio Reference
189300200616     C                     MOVE VCPTFR    PTFR
189400200616     C** .. Echange Rate (Settle - Port)
189500200616     C** .. Spot Rate Mult/Div Indicator
189600200616     C                     Z-ADD0         SPXR
189700200616     C                     MOVE *BLANKS   SPMD
189800200616     C*
189900200616     C           VCPTFR    IFNE *BLANKS
190000200616     C                     Z-ADD1         ZAMTF
190100200616     C                     MOVE NMCY      ZCCYF
190200200616     C                     MOVE WNSPRT    ZRATEF
190300200616     C                     MOVE WNMDIN    ZMDINF
190400200616     C                     MOVE WNNBDP    ZCDPF
190500200616     C*
190600200616     C           VCPTFR    IFEQ '9997'
190700200616     C                     MOVE VCCNUM    WWCNUM  6
190800200616     C***********WWCNUM    CHAINSDPLCSPD             89                   S01496
190900200616     C*                                                                   S01496
191000200616     C                     CALL 'AOPLCSR0'                                S01496
191100200616     C                     PARM '*MSG   ' @RTCD   7                       S01496
191200200616     C                     PARM '*KEY   ' @OPTN   7                       S01496
191300200616     C                     PARM WWCNUM    @CUST  10                       S01496
191400200616     C           @PLCS     PARM @PLCS     DSSDY                           S01496
191500200616     C*                                                                   S01496
191600200616     C                     MOVE QBCSBY    ZCCYT
191700200616     C                     ELSE
191800200616     C           KEY4      CHAINPMPORTLL             89
191900200616     C                     MOVE PNPTCY    ZCCYT
192000200616     C                     END
192100200616     C*
192200200616     C** RETRIEVE BASE CURRENCY SPOT, M/D INDICATOR, DEC.PLACES
192300200616     C***********ZCCYT     CHAINSDCURRL1             89                   S01496
192400200616     C*                                                                   S01496
192500200616     C                     CALL 'AOCURRR0'                                S01496
192600200616     C                     PARM '*MSG   ' @RTCD   7                       S01496
192700200616     C                     PARM '*KEY   ' @OPTN   7                       S01496
192800200616     C                     PARM ZCCYT     @CYCD   3                       S01496
192900200616     C           @CURR     PARM @CURR     DSSDY                           S01496
193000200616     C*
193100200616     C************IN89     IFEQ '1'                                       S01496
193200200616     C           @RTCD     IFNE *BLANK                                    S01496
193300200616     C                     Z-ADD18        DBASE            *****************
193400200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 18 **
193500200616     C***********          MOVEL'SDCURRL1'DBFILE           ************** S01496
193600200616     C                     MOVE 'SDCURRPD'DBFILE                          S01496
193700200616     C                     MOVELZCCYT     DBKEY
193800200616     C                     EXSR *PSSR
193900200616     C                     ENDIF
194000200616     C*
194100200616     C                     MOVE A6SPRT    ZRATET
194200200616     C                     MOVE A6MDIN    ZMDINT
194300200616     C                     MOVE A6NBDP    ZCDPT
194400200616     C/COPY WNCPYSRC,SE6740C004
194500200616     C                     EXSR ZCCYCN
194600200616     C/COPY WNCPYSRC,SE6740C005
194700200616     C                     Z-ADDZCRSRT    SPXR
194800200616     C                     MOVE ZCRSMD    SPMD
194900200616     C                     END
195000200616     C** .. Value Date
195100200616     C                     Z-ADDVAERRD    DPVD
195200200616     C** .. Customer Yield Rate
195300200616     C                     Z-ADD*ZEROS    CYLD
195400200616     C** .. Customer Delivery / Withdrawal                                094693
195500200616     C                     MOVE 'N'       CWDI                            094693
195600200616      *                                                                                       207006
195700200616     C           CSE029    IFEQ 'Y'                                                           207006
195800200616      *                                                                                       207006
195900200616     C**********           CALL 'AOBRCHR0'                                             207006 CGL029
196000200616     C                     CALL 'AOBRCHR1'                                                    CGL029
196100200616     C                     PARM *BLANKS   @RTCD                                               207006
196200200616     C                     PARM '*KEY   ' @OPTN                                               207006
196300200616     C                     PARM VCBRCD    @BRCA                                               207006
196400200616     C********** @BRCH     PARM @BRCH     DSFDY                                        207006 CGL029
196500200616     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
196600200616      *                                                                                       207006
196700200616     C                     MOVE SMCC      MRKT                                                207006
196800200616     C                     MOVE A8BICN    CPTY                                                207006
196900200616      *                                                                                       207006
197000200616     C                     ENDIF                                                              207006
197100200616     C*
197200200616     C                     MOVE 'D'       RECI
197300200616     C*                                                                   S01496
197400200616     C** Initialize fields if S01445 is installed.                        S01496
197500200616     C*                                                                   S01496
197600200616     C           *IN40     IFEQ '1'                                       S01496
197700200616     C                     MOVE *BLANK    DCHC                            S01496
197800200616     C                     MOVE *BLANK    DCCE                            S01496
197900200616     C                     MOVE *BLANK    DCAT                            S01496
198000200616     C                     MOVE *BLANK    DCAB                            S01496
198100200616     C                     Z-ADD*ZERO     DCHA                            S01496
198200200616     C                     Z-ADD*ZERO     DCSE                            S01496
198300200616     C                     END                                            S01496
198400200616      *                                                                   CPB001
198500200616      **  If Replication Processing required.                             CPB001
198600200616     C           WUREPL    IFEQ 'Y'                        Begin WUREPL   CPB001
198700200616     C                     EXSR REPLIC                                    CPB001
198800200616      *                                                                   CPB001
198900200616     C                     ENDIF                           End WUREPL     CPB001
199000200616      *                                                                   CSE012
199100200616      **  If feature CSE012 is installed.                                 CSE012
199200200616      *                                                                   CSE012
199300200616     C           CSE012    IFEQ 'Y'                                       CSE012
199400200616      *                                                                   CSE012
199500200616      ** If Depot Movement is 'WI' or 'WO'.                               CSE012
199600200616      *                                                                   CSE012
199700200616     C           DPMV      IFEQ 'WI'                                      CSE012
199800200616     C           DPMV      OREQ 'WO'                                      CSE012
199900200616      *                                                                   CSE012
200000200616      **  Set extended narratives to blanks.                              CSE012
200100200616      *                                                                   CSE012
200200200616     C                     MOVE *BLANKS   DPNR2                           CSE012
200300200616     C                     MOVE *BLANKS   DPNR3                           CSE012
200400200616     C                     MOVE *BLANKS   DPNR4                           CSE012
200500200616     C                     MOVE *BLANKS   DPNR5                           CSE012
200600200616      *                                                                   CSE012
200700200616     C                     ENDIF                                          CSE012
200800200616      *                                                                   CSE012
200900200616     C                     ENDIF                                          CSE012
201000200616      *                                                                   CSE017
201100200616      ** If CSE017 is installed, setup the Print Advice and Cum/Ex        CSE017
201200200616      ** Indicator                                                        CSE017
201300200616      *                                                                   CSE017
201400200616     C           CSE017    IFEQ 'Y'                                       CSE017
201500200616     C                     MOVE 'Y'       DPAP                            CSE017
201600200616      *                                                                   CSE017
201700200616      ** Access AOINVTR0 to get the processing type                       CSE017
201800200616      *                                                                   CSE017
201900200616     C                     CALL 'AOINVTR0'                                CSE017
202000200616     C                     PARM *BLANKS   PRTCD                           CSE017
202100200616     C                     PARM '*KEY   ' POPTN                           CSE017
202200200616     C                     PARM SITP      PINVT   3                       CSE017
202300200616     C                     PARM NMCY      PCCYI   3                       CSE017
202400200616     C           INVTP     PARM INVTP     DSFDY                           CSE017
202500200616      *                                                                   CSE017
202600200616     C           PRTCD     IFNE *BLANKS                                   CSE017
202700200616     C                     MOVELNMCY      WKEY    7                       CSE017
202800200616     C                     MOVE SITP      WKEY                            CSE017
202900200616     C                     Z-ADD23        DBASE            ************   CSE017
203000200616     C                     MOVE 'INVTPD  'DBFILE           * DBERR 23 *   CSE017
203100200616     C                     MOVELWKEY      DBKEY            ************   CSE017
203200200616     C                     EXSR *PSSR                                     CSE017
203300200616     C                     ENDIF                                          CSE017
203400200616      *                                                                   CSE017
203500200616     C           DPMV      IFEQ 'WI'                                      CSE017
203600200616     C                     Z-ADDDPMD      DATE    50                      CSE017
203700200616     C                     ELSE                                           CSE017
203800200616     C                     Z-ADDDPDO      DATE                            CSE017
203900200616     C                     ENDIF                                          CSE017
204000200616      *                                                                   CSE017
204100200616      ** Set up the Cum/Ex Indicator depending on the processing type     CSE017
204200200616      *                                                                   CSE017
204300200616     C           PROT      IFEQ '2'                                       CSE017
204400200616     C                     MOVE *BLANKS   DPIN                            CSE017
204500200616     C                     ENDIF                                          CSE017
204600200616      *                                                                   CSE017
204700200616     C           PROT      IFNE '2'                                       CSE017
204800200616     C           PROT      ANDNE'4'                                       CSE017
204900200616     C           PROT      ANDNE'7'                                       CSE017
205000200616     C                     EXSR SRACI                                     CSE017
205100200616     C                     ENDIF                                          CSE017
205200200616      *                                                                   CSE017
205300200616     C                     ELSE                                           CSE017
205400200616     C                     MOVE *BLANKS   DPAP                            CSE017
205500200616     C                     MOVE *BLANKS   DPIN                            CSE017
205600200616     C                     ENDIF                                          CSE017
205700200616      *                                                                                       234829
205800200616      ** Get Original Purchase Date                                                           234829
205900200616      *                                                                                       234829
206000200616     C           CGL031    IFEQ 'Y'                                                           234829
206100200616     C                     EXSR GOPD                                                          234829
206200200616      *                                                                                       234829
206300200616      ** Get Original Purchased Interest                                                      234829
206400200616      *                                                                                       234829
206500200616     C                     EXSR GOPI                                                          234829
206600200616      *                                                                                       234829
206700200616      ** Get Fiscal Price via SEVSEFSPR3                                                      234829
206800200616      *                                                                                       234829
206900200616     C                     EXSR GFSPR                                                         234829
207000200616      *                                                                                       234829
207100200616      ** Write Position details to ETCPOSND via SEETCPUPD                                     234829
207200200616      *                                                                                       234829
207300200616     C                     MOVE RECI      RECIV                                               234829
207400200616     C                     MOVE ORBR      ORBRV                                               234829
207500200616     C                     MOVE TACI      TACIV                                               234829
207600200616     C                     Z-ADDORED      OREDV                                               234829
207700200616     C                     Z-ADDLCD       LCDV                                                234829
207800200616     C                     MOVE CHTP      CHTPV                                               234829
207900200616     C                     Z-ADDTNLU      TNLUV                                               234829
208000200616     C                     Z-ADDSPXR      SPXRV                                               234829
208100200616     C                     MOVE SPMD      SPMDV                                               234829
208200200616     C                     MOVE PTFR      PTFRV                                               234829
208300200616     C                     MOVE COAF      COAFV                                               234829
208400200616     C                     MOVE ACIN      ACINV                                               234829
208500200616     C                     MOVE REPI      REPIV                                               234829
208600200616     C                     MOVE DPAP      DPAPV                                               234829
208700200616     C                     Z-ADDFSPR      FSPRV                                               234829
208800200616     C                     MOVE FSPP      FSPPV                                               234829
208900200616     C**********           Z-ADDDPBN      DPBNV                                       234829 CSD027A
209000200616     C                     MOVE DPBN      DPBNV                                              CSD027A
209100200616     C                     MOVE NMCY      NMCYA                                               234829
209200200616     C                     CALL SEETCP                                                        234829
209300200616     C                     PARM *BLANKS   PRETC                                               234829
209400200616     C                     PARM 'I'       @BCHTP  1                                           234829
209500200616     C                     PARM 'D'       WTYPE   1                                           234829
209600200616     C                     PARM           @TRDDS                                              234829
209700200616     C                     PARM           @SEVDP                                              234829
209800200616     C                     PARM           @SECTY                                              234829
209900200616     C                     ENDIF                                                              234829
210000200616     C*
210100200616     C*  UPDATE DEPOT MOVEMENTS DETAILS
210200200616     C                     MOVEASTAMP,1   DMTMST           Default Timestamp                  CPK015
210300200616     C                     MOVE *BLANKS   DMFRNT                                              220225
210400200616     C                     Z-ADDDPVD      DMTD                                                220441
210500200616     C** .. repeat the following set ups as sometimes they have been corrupted                235041
210600200616     C** .. Original Entry Date                                                               235041
210700200616     C                     Z-ADDBJRDNB    ORED                                                235041
210800200616     C** .. Last Change Date                                                                  235041
210900200616     C                     Z-ADDBJRDNB    LCD                                                 235041
211000200616     C** .. Type of last change                                                               235041
211100200616     C                     MOVE 'I'       CHTP                                                235041
211200200616     C** .. Beneficial Customer                                                               235041
211300200616     C                     MOVE VCCNUM    DPBN                                                235041
211400200616     C                     WRITEDPTMVDF
211500200616     C/COPY WNCPYSRC,SE6740C010
211600200616     C*
211700200616     C           WALLOC    IFNE 'R'
211800200616     C                     ADD  1         W02CNT
211900200616     C                     ELSE
212000200616     C                     ADD  1         W05CNT
212100200616     C                     END
212200200616     C*
212300200616     C** UPDATE EXTENSION FILES
212400200616     C                     MOVE DPSS      DPDPSS
212500200616     C                     MOVE DPRN      DPDPRN
212600200616     C*
212700200616     C***IF*MT500*(LZSTAT,*POS.33)*IS*EQUAL*TO*'Y'*********************   S01496
212800200616     C***********M500      IFEQ 'Y'                                       S01496
212900200616     C           *IN42     IFEQ '1'                                       S01496
213000200616     C                     MOVE *BLANKS   DPCONG
213100200616     C                     MOVE *BLANKS   DPRCDG
213200200616     C                     Z-ADD0         DPLSWS
213300200616     C                     Z-ADD0         DPLSSC
213400200616     C                     MOVE *ZEROS    DPTIME
213500200616     C                     Z-ADD0         DPLCD
213600200616     C***********          MOVE *BLANKS   DPGMES                          S01496
213700200616     C                     MOVE 'N'       DPGMES                          S01496
213800200616     C                     MOVE *BLANKS   DPINST
213900200616     C                     MOVE *BLANKS   DPINSS
214000200616     C                     MOVE *BLANKS   DPEUCL
214100200616     C                     MOVE *BLANKS   DPSAFA
214200200616     C                     MOVE *BLANKS   DPRPTY
214300200616     C                     MOVE *BLANKS   DPFIND
214400200616     C***********          MOVE *BLANKS   DPGMEC                          S01496
214500200616     C                     MOVE 'N'       DPGMEC                          S01496
214600200616     C                     MOVE *BLANKS   DPTRTT
214700200616     C                     MOVE *BLANKS   DPGDEL
214800200616     C                     MOVE *BLANKS   DPFCOD
214900200616     C                     MOVE *BLANKS   DPSROL
215000200616     C                     MOVE *BLANKS   DPSCMG                          S01496
215100200616     C*
215200200616     C***********          WRITEDPTMVDFA                                  S01496
215300200616     C                     WRITEDPTMVDD1                                  S01496
215400200616     C                     MOVE '0'       *IN42                           S01496
215500200616     C                     END
215600200616     C/COPY WNCPYSRC,SE6740C009
215700200616     C*
215800200616     C***********          MOVE *BLANKS   DPCHCD                          S01496
215900200616     C***********          MOVE *BLANKS   DPCHCY                          S01496
216000200616     C***********          Z-ADD0         DPCHAM                          S01496
216100200616     C***********          Z-ADD0         DPSTTP                          S01496
216200200616     C***********          Z-ADD0         DPSTAC                          S01496
216300200616     C***********                                                         S01496
216400200616     C***********          WRITEDPTMVDF0                                  S01496
216500200616     C***********                                                         S01496
216600200616     C***IF*DEPOT*MOVEMENT*CHARGE*(LZSTAT,*POS.10)*IS*EQUAL*TO*'Y'*****   S01496
216700200616     C***********DMCG      IFEQ 'Y'                                       S01496
216800200616     C***********          MOVE 'D'       RECIX                           S01496
216900200616     C***********          MOVE DPSS      DPSSX                           S01496
217000200616     C***********          MOVE DPRN      DPRNX                           S01496
217100200616     C***********          MOVE *BLANKS   DPNR2                           S01496
217200200616     C***********          MOVE *BLANKS   DPNR3                           S01496
217300200616     C***********          MOVE *BLANKS   DPNR4                           S01496
217400200616     C***********          MOVE *BLANKS   DPNR5                           S01496
217500200616     C***********                                                         S01496
217600200616     C***********          WRITEDPTMVDF1                                  S01496
217700200616     C***********                                                         S01496
217800200616     C***********          ENDIF                                          S01496
217900200616      * write to Movement Status file                                     CSE039
218000200616      *                                                                   CSE039
218100200616     C           CSE039    IFEQ 'Y'                                       CSE039
218200200616     C                     MOVELDPRN      TMTRRF                          CSE039
218300200616     C                     MOVEL'W'       TMTRTY                          CSE039
218400200616     C                     Z-ADDBJRDNB    TMNTDT                          CSE039
218500200616     C                     Z-ADD1         TMSQNR                          CSE039
218600200616     C                     MOVEL'INS'     TMSWSC                          CSE039
218700200616     C                     MOVEL*BLANKS   TMSWRC                          CSE039
218800200616     C                     MOVEL*BLANKS   TMNTMT                          CSE039
218900200616     C                     MOVEL*BLANKS   TMLCUS                          CSE039
219000200616     C                     MOVEL'MIDAS'   TMINOR                          CSE039
219100200616     C                     MOVEL*BLANKS   TMMSGK                          CSE039
219200200616     C                     MOVEL*BLANKS   TMSTMG                          CSE039
219300200616     C                     MOVELVARNAR    TMNARR                          CSE039
219400200616     C                     MOVEL'I'       TMLCTP                          CSE039
219500200616     C                     Z-ADDBJRDNB    TMLCDT                          CSE039
219600200616     C                     MOVELTMMP,1    TMTMST                          CSE039
219700200616     C                     MOVELDPBA      TMTRBB                          CSE039
219800200616     C                     MOVE USER      TMLCUS                          CSE039
219900200616      *                                                                   CSE039
220000200616     C                     WRITESEMVTSD0                                  CSE039
220100200616     C                     ENDIF                                          CSE039
220200200616     C*
220300200616     C                     ENDSR
220301200616      /EJECT                                                                                AR324886
220302200616      *****************************************************************                     AR324886
220303200616     C           PSAUDT    BEGSR                                                            AR324886
220304200616      *                                                                                     AR324886
220305200616     C           PSAUTH    CHAINPSAUT                80                                     AR324886
220306200616     C           *IN80     IFEQ *OFF                                                        AR324886
220307200616     C                     MOVE RECI      PARECI                                            AR324886
220308200616     C                     MOVE PALUSR    PAPUSR                                            AR324886
220309200616     C                     MOVE PALCD     PAPCD                                             AR324886
220310200616     C                     MOVE PALCTP    PAPCTP                                            AR324886
220311200616     C           LIBR      CAT  'OWNER'   PALUSR                                            AR324886
220312200616     C                     MOVE LCD       PALCD                                             AR324886
220313200616     C                     MOVE CHTP      PALCTP                                            AR324886
220314200616     C                     UPDATPSAUTDF                                                     AR324886
220315200616     C                     ENDIF                                                            AR324886
220316200616      *                                                                                     AR324886
220317200616     C                     ENDSR                                                            AR324886
220318200616      *****************************************************************                     AR324886
220400200616     ******************************************************************
220500200616      /EJECT
220600200616     ******************************************************************
220700200616     C* *PSSR : STANDARD DATABASE ERROR PROCESSING
220800200616     ******************************************************************
220900200616     C           *PSSR     BEGSR
221000200616     C*
221100200616     C** UPDATE LDA WITH ERROR INFORMATION
221200200616     C           *NAMVAR   DEFN           LDA
221300200616     C           *LOCK     IN   LDA
221400200616     C                     MOVELDBFILE    WWFILE
221500200616     C                     MOVELDBKEY     WWKEY
221600200616     C                     MOVELDBPGM     WWPGM
221700200616     C                     MOVELDBASE     WWASE
221800200616     C                     OUT  LDA
221900200616     C*
222000200616     C** OUTPUT ERROR ON PRINTER FILE
222100200616     C                     EXSR AUDIT
222200200616     C*
222300200616     C** PRINT DUMP AND CANCEL PROGRAM
222400200616     C                     DUMP
222500200616     C*
222600200616     C                     MOVE '1'       *INU7
222700200616     C                     MOVE '1'       *INU8
222800200616     C                     MOVE '1'       *INLR
222900200616     C*
223000200616     C** RETURN OF CURRENT PROGRAM
223100200616     C                     RETRN
223200200616     C*
223300200616     C                     ENDSR
223400200616     C**********************************************************************
223500200616      /EJECT
223600200616     C**********************************************************************
223700200616     C* SECTIN   - GET SECURITY RECORD
223800200616     C**********************************************************************
223900200616     C*
224000200616     C           SECTIN    BEGSR                           ** SECTIN **
224100200616     C*
224200200616     C** CHAIN FOR SECURITY RECORD
224300200616     C           VASESN    CHAINSECTY                89
224400200616     C*
224500200616     C           *IN89     IFEQ '1'
224600200616     C           RECI      OREQ '*'
224700200616     C                     Z-ADD19        DBASE            *****************
224800200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 19 **
224900200616     C***********          MOVEL'SECTY'   DBFILE           ************** S01496
225000200616     C                     MOVE 'SECTY   'DBFILE                          S01496
225100200616     C                     MOVELVASESN    DBKEY
225200200616     C                     EXSR *PSSR
225300200616     C                     ENDIF
225400200616     C*
225500200616     C** SECURITY NOMINAL DECIMAL PLACES AND PRICE BASIS FOR SR/ZAPNUM
225600200616     C                     Z-ADDNMDP      ZNMDP
225700200616     C                     MOVE SPBS      ZPRCB
225800200616     C*
225900200616     C** RETRIEVE NOMINAL CURRENCY SPOT, M/D IND. AND DEC.PLACES
226000200616     C***********NMCY      CHAINSDCURRL1             89                   S01496
226100200616     C*                                                                   S01496
226200200616     C                     CALL 'AOCURRR0'                                S01496
226300200616     C                     PARM '*MSG   ' @RTCD   7                       S01496
226400200616     C                     PARM '*KEY   ' @OPTN   7                       S01496
226500200616     C                     PARM NMCY      @CYCD   3                       S01496
226600200616     C           @CURR     PARM @CURR     DSSDY                           S01496
226700200616     C*
226800200616     C************IN89     IFEQ '1'                                       S01496
226900200616     C           @RTCD     IFNE *BLANK                                    S01496
227000200616     C                     Z-ADD20        DBASE            *****************
227100200616     C                     MOVEL*BLANKS   DBFILE           ** DB ERROR 20 **
227200200616     C***********          MOVEL'SDCURRL1'DBFILE           ************** S01496
227300200616     C                     MOVE 'SDCURRPD'DBFILE                          S01496
227400200616     C                     MOVELNMCY      DBKEY
227500200616     C                     EXSR *PSSR
227600200616     C                     ENDIF
227700200616     C*
227800200616     C** SAVE BASE CURRENCY SPOT, M/D INDICATOR, DEC.PLACES FOR LATER
227900200616     C                     MOVE A6SPRT    WNSPRT
228000200616     C                     MOVE A6MDIN    WNMDIN
228100200616     C                     MOVE A6NBDP    WNNBDP
228200200616     C*
228300200616     C** NOMINAL CURRENCY DECIMAL PLACES USED IN SR/ZAPNUM
228400200616     C                     Z-ADDA6NBDP    ZNMCD
228500200616     C*
228600200616     C                     ENDSR
228700200616     C**********************************************************************
228800200616     C/EJECT
228900200616     C**********************************************************************
229000200616     C* AUDIT    - OUTPUT CONTROL REPORT
229100200616     C**********************************************************************
229200200616     C*
229300200616     C           AUDIT     BEGSR                           ** AUDIT **
229400200616     C*
229500200616     C* OUTPUT CONTROL REPORT
229600200616     C                     WRITEHEADAU
229700200616     C*
229800200616     C           DBASE     IFEQ 0
229900200616     C                     WRITECONTROL
230000200616     C                     ELSE
230100200616     C                     WRITEERROR
230200200616     C                     ENDIF
230300200616     C*
230400200616     C***********          WRITETRAILAU                                   S01496
230500200616     C*
230600200616     C                     ENDSR
230700200616     C**********************************************************************
230800200616      /EJECT                                                                                  CSE017
230900200616      *****************************************************************                       CSE017
231000200616      *  SRACI  - Defaulting of Cum/Ex Indicator for Processing type  *                       CSE017
231100200616      *           Other than 2, 4 and 7                               *                       CSE017
231200200616      *                                                               *                       CSE017
231300200616      *  Called by:                                                   *                       CSE017
231400200616      *                                                               *                       CSE017
231500200616      *  Calls    :                                                   *                       CSE017
231600200616      *                                                               *                       CSE017
231700200616      *****************************************************************                       CSE017
231800200616     C           SRACI     BEGSR                                                              CSE017
231900200616      *                                                                                       CSE017
232000200616      ** Set up indicator for schuldschein                                                    CSE017
232100200616      *                                                                                       CSE017
232200200616     C           PROT      IFEQ '6'                                                           CSE017
232300200616     C                     MOVE 'F'       DPIN                                                CSE017
232400200616     C                     ENDIF                                                              CSE017
232500200616      *                                                                                       CSE017
232600200616      ** Determine next coupon date                                                           CSE017
232700200616      *                                                                                       CSE017
232800200616     C                     EXSR ZNCD                                                          CSE017
232900200616     C                     MOVE 'C'       DPIN                                                CSE017
233000200616      *                                                                                       CSE017
233100200616      ** If trade value date is the next coupon date, the trade is                            CSE017
233200200616      ** 'flat' of purchased interest                                                         CSE017
233300200616      *                                                                                       CSE017
233400200616     C           DATE      IFEQ NCD                                                           CSE017
233500200616     C                     MOVE 'F'       DPIN                                                CSE017
233600200616     C                     ELSE                                                               CSE017
233700200616      *                                                                                       CSE017
233800200616      ** Else if the trade value date is not the next coupon date                             CSE017
233900200616      ** Determine the ex-date of the security                                                CSE017
234000200616      *                                                                                       CSE017
234100200616     C                     MOVELEDFT      ZNRDYS                                              CSE017
234200200616     C           ZNRDYS    IFNE *ZEROS                                                        CSE017
234300200616     C                     MOVE EDFT      WEDFT   1                                           CSE017
234400200616      *                                                                                       CSE017
234500200616      ** ... if working days                                                                  CSE017
234600200616      *                                                                                       CSE017
234700200616     C           WEDFT     IFEQ 'W'                                                           CSE017
234800200616     C                     Z-ADDNCD       ZDAYNO                                              CSE017
234900200616     C                     MOVE NMCY      ZCCY                                                CSE017
235000200616     C                     MOVE *BLANKS   ZLOC                                                CSE017
235100200616     C                     EXSR ZBKDT                                                         CSE017
235200200616      *                                                                                       CSE017
235300200616      ** ... if actual days                                                                   CSE017
235400200616      *                                                                                       CSE017
235500200616     C                     ELSE                                                               CSE017
235600200616     C           NCD       SUB  ZNRDYS    ZDYNBR                                              CSE017
235700200616     C                     ENDIF                                                              CSE017
235800200616      *                                                                                       CSE017
235900200616      ** If the trade value date is in the 'ex-coupon' period                                 CSE017
236000200616      ** the trade is 'ex' purchased interest                                                 CSE017
236100200616      *                                                                                       CSE017
236200200616     C           DATE      IFLT NCD                                                           CSE017
236300200616     C           DATE      ANDGEZDYNBR                                                        CSE017
236400200616     C                     MOVE 'X'       DPIN                                                CSE017
236500200616     C                     ENDIF                                                              CSE017
236600200616     C                     ENDIF                                                              CSE017
236700200616     C                     ENDIF                                                              CSE017
236800200616     C                     ENDSR                                                              CSE017
236900200616      *****************************************************************                       CSE017
237000200616      /EJECT                                                                                  CSE017
237100200616      /EJECT
237200200616      *****************************************************************   CPB001
237300200616      *                                                               *   CPB001
237400200616      *  REPLIC - Subroutine to set up Replication Indicator.         *   CPB001
237500200616      *                                                               *   CPB001
237600200616      *  Called by : W02                                              *   CPB001
237700200616      *                                                               *   CPB001
237800200616      *  Calls     : None                                             *   CPB001
237900200616      *                                                               *   CPB001
238000200616      *****************************************************************   CPB001
238100200616     C           REPLIC    BEGSR                           ** REPLIC SR **CPB001
238200200616      *                                                                   CPB001
238300200616      **  Initialize Replication Indicator.                               CPB001
238400200616     C                     MOVE *BLANK    REPI                            CPB001
238500200616      *                                                                   CPB001
238600200616      **  Access Customer Details by using Access Object,                 CPB001
238700200616      **  to retrieve Private Banking Customer Indicator.                 CPB001
238800200616     C                     MOVE *BLANKS   @CUST                           CPB001
238900200616     C                     MOVELDPBN      @CUST                           CPB001
239000200616     C                     CALL 'AOCUSTR1'                                CPB001
239100200616     C                     PARM '*MSG   ' @RTCD   7                       CPB001
239200200616     C                     PARM '*KEY   ' @OPTN   7                       CPB001
239300200616     C                     PARM           @CUST  10                       CPB001
239400200616     C                     PARM           @KYST   7                       CPB001
239500200616     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
239600200616      *                                                                   CPB001
239700200616      **  If Customer Details do not exist, handle Database Error.        CPB001
239800200616     C           @RTCD     IFNE *BLANK                     BEGIN @RTCD    CPB001
239900200616     C                     MOVEL'SDCUSTPD'DBFILE           ***************CPB001
240000200616     C                     MOVEL@CUST     DBKEY            * DB ERROR 91 *CPB001
240100200616     C                     Z-ADD21        DBASE            ***************CPB001
240200200616     C                     EXSR *PSSR                                     CPB001
240300200616      *                                                                   CPB001
240400200616     C                     ENDIF                           End @RTCD      CPB001
240500200616      *                                                                   CPB001
240600200616      **  If Customer is a Private Banking Customer, set up               CPB001
240700200616      **  Replication Indicator.                                          CPB001
240800200616     C           BBPRBA    IFEQ 'Y'                        Begin BBPRBA   CPB001
240900200616     C                     MOVE 'Y'       REPI                            CPB001
241000200616      *                                                                   CPB001
241100200616     C                     ENDIF                           End BBPRBA     CPB001
241200200616      *                                                                   CPB001
241300200616     C                     ENDSR                                          CPB001
241400200616      *****************************************************************   CPB001
241500200616     C/EJECT                                                                                  234829
241600200616      *****************************************************************                       234829
241700200616      *                                                               *                       234829
241800200616      * GOPD - Get Original Purchase Date.                            *                       234829
241900200616      *                                                               *                       234829
242000200616      *****************************************************************                       234829
242100200616      *                                                                                       234829
242200200616     C           GOPD      BEGSR                                                              234829
242300200616      *                                                                                       234829
242400200616     C           DPMV      IFEQ 'WI'                                                          234829
242500200616     C                     Z-ADDDPMD      WDPMD                                               234829
242600200616     C                     ELSE                                                               234829
242700200616     C                     Z-ADDDPDO      WDPMD                                               234829
242800200616     C                     ENDIF                                                              234829
242900200616      *                                                                                       234829
243000200616     C                     CALL 'SEVOPDT'                                                     234829
243100200616     C                     PARM *BLANKS   PRETC  10                                           234829
243200200616     C                     PARM *BLANKS   DDOPDT  7                                           234829
243300200616     C                     PARM           DPMV                                                234829
243400200616     C                     PARM           DPSS                                                234829
243500200616     C                     PARM           DPBN                                                234829
243600200616     C                     PARM           DPBA                                                234829
243700200616     C                     PARM           BJRDNB                                              234829
243800200616     C                     PARM           BJDFIN                                              234829
243900200616     C                     PARM           DPVD                                                234829
244000200616     C                     PARM           WDPMD   50                                          234829
244100200616     C                     PARM           DPNA                                                234829
244200200616     C                     PARM           PTFR                                                234829
244300200616     C                     PARM           @FNXA                                               234829
244400200616     C                     PARM           @MIXA                                               234829
244500200616     C                     PARM           @MDXA                                               234829
244600200616     C                     PARM           WOPDOK  1                                           234829
244700200616     C                     PARM           OPDT                                                234829
244800200616      *                                                                                       234829
244900200616     C                     ENDSR                                                              234829
245000200616      *****************************************************************                       234829
245100200616     C/EJECT                                                                                  234829
245200200616      *****************************************************************                       234829
245300200616      *                                                               *                       234829
245400200616      * GFSPR - Get Fiscal Price                                      *                       234829
245500200616      *                                                               *                       234829
245600200616      *****************************************************************                       234829
245700200616      *                                                                                       234829
245800200616     C           GFSPR     BEGSR                                                              234829
245900200616      *                                                                                       234829
246000200616     C                     Z-ADD0         WFSPI                                               234829
246100200616     C                     MOVE NMCY      NMCYA                                               234829
246200200616     C                     Z-ADDDPNA      WNOML                                               235041
246300200616     C                     MOVE WDPBN     @DPBN   6                                           235041
246400200616      *                                                                                       234829
246500200616     C                     CALL SEVFSP                                                        234829
246600200616     C                     PARM *BLANKS   PRETC  10                                           234829
246700200616     C                     PARM           PFSPR  16                                           234829
246800200616     C                     PARM           @SECTY                                              234829
246900200616     C                     PARM           OPDT                                                234829
247000200616     C                     PARM           BJDFIN                                              234829
247100200616     C                     PARM           WFSPI   10                                          234829
247200200616     C                     PARM 'C'       SCUMEX  1                                           234829
247300200616     C***********          PARM           DPNA                                                235041
247400200616     C                     PARM           WNOML  150                                          235041
247500200616     C                     PARM           WNNBDP                                              234829
247600200616     C                     PARM           DPMV                                                234829
247700200616     C**********           PARM           WDPBN   6                                    234829 235041
247800200616     C                     PARM           @DPBN                                               235041
247900200616     C                     PARM           DPBA                                                234829
248000200616     C                     PARM *BLANKS   WDOPDT  6                                           234829
248100200616     C                     PARM           PTFR                                                234829
248200200616     C                     PARM           @FNXA                                               234829
248300200616     C                     PARM           @MIXA                                               234829
248400200616     C                     PARM           @MDXA                                               234829
248500200616     C                     PARM           WFSPOK  1                                           234829
248600200616     C                     PARM           FSPR                                                234829
248700200616     C                     PARM           FSPP                                                234829
248800200616      *                                                                                       234829
248900200616     C                     ENDSR                                                              234829
249000200616      *****************************************************************                       234829
249100200616     C/EJECT                                                                                  234829
249200200616      *****************************************************************                       234829
249300200616      *                                                               *                       234829
249400200616      * GOPI - Get Original Purchase Interest                         *                       234829
249500200616      *                                                               *                       234829
249600200616      *****************************************************************                       234829
249700200616      *                                                                                       234829
249800200616     C           GOPI      BEGSR                                                              234829
249900200616      *                                                                                       234829
250000200616     C                     MOVE NMCY      NMCYA                                               234829
250100200616     C                     MOVE WDPBN     @DPBN                                               235041
250200200616     C                     CALL SEVOPI                                                        234829
250300200616     C                     PARM *BLANKS   PRETC  10                                           234829
250400200616     C                     PARM *BLANKS   EOPIN  14                                           234829
250500200616     C                     PARM           DPMV                                                234829
250600200616     C**********           PARM           WDPBN   6                                    234829 235041
250700200616     C                     PARM           @DPBN                                               235041
250800200616     C                     PARM 'C'       SCUMEX  1                                           234829
250900200616     C                     PARM *BLANKS   WDOPDT                                              234829
251000200616     C                     PARM           DPSS                                                234829
251100200616     C                     PARM           DPNA                                                234829
251200200616     C                     PARM           OPDT                                                234829
251300200616     C                     PARM           DPBA                                                234829
251400200616     C                     PARM           BJDFIN                                              234829
251500200616     C                     PARM           @SECTY                                              234829
251600200616     C                     PARM           WNNBDP                                              234829
251700200616     C                     PARM 'Y'       WDFLT   1                                           234829
251800200616     C                     PARM *BLANKS   WVALD   1                                           235041
251900200616     C                     PARM           PTFR                                                234829
252000200616     C                     PARM           @FNXA                                               234829
252100200616     C                     PARM           @MIXA                                               234829
252200200616     C                     PARM           @MDXA                                               234829
252300200616     C                     PARM           WOPIOK  1                                           234829
252400200616     C                     PARM           OPIN                                                234829
252500200616     C                     PARM           ACIN                                                234829
252600200616      *                                                                                       234829
252700200616     C                     ENDSR                                                              234829
252800200616      *****************************************************************                       234829
252900200616     C/COPY WNCPYSRC,SE6740C006
253000200616     C********************************************************************
253100200616     C**   SUBROUTINE- ZTNLU1
253200200616     C**
253300200616     C/COPY ZSRSRC,ZTNLU1Z2
253400200616     C********************************************************************
253500200616      /EJECT
253600200616     C********************************************************************
253700200616     C**   SUBROUTINE- ZEVCD
253800200616     C**   ACCESS EVENT CONTROL DATE
253900200616     C**
254000200616     C/COPY ZSRSRC,ZEVCDZ1
254100200616     C********************************************************************
254200200616      /EJECT
254300200616     C********************************************************************
254400200616     C**   SUBROUTINE- ZAPNUM
254500200616     C**   CALCULATE AP NUMERATOR
254600200616     C**
254700200616     C/COPY ZSRSRC,ZAPNUM
254800200616     C*****************************************************************
254900200616      /EJECT
255000200616     C********************************************************************
255100200616     C**   SUBROUTINE- ZCCYCN
255200200616     C**   CONVERT AMOUNT IN CCY1 TO CCY2
255300200616     C**
255400200616     C/COPY ZSRSRC,ZCCYCN
255500200616     C*****************************************************************
255600200616      /COPY ZSRSRC,ZBKDT                                                  CSE017
255700200616      /COPY ZSRSRC,ZNCDZ3                                                 CSE017
255800200616      /COPY ZSRSRC,ZACCH                                                  CSE017
255900200616      /COPY ZSRSRC,ZDATE1Z2                                               CSE017
256000200616      /COPY ZSRSRC,ZDATE2Z2                                               CSE017
256100200616      /EJECT
256200200616     C*****************************************************************
256300200616      /COPY ZSRSRC,ZPOWER8Z2
256400200616**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
2565002006160000001
2566002006160000010
2567002006160000100
2568002006160001000
2569002006160010000
2570002006160100000
2571002006161000000
257200200616**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
2573002006160366073110961461
257400200616**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
257500200616000031059090120151181212243273304334365
257600200616**   ZMNM - MONTHS SHORT NAMES
257700200616JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
257800200616** STAMP - Dummy timestamp                                                                    CPK015
2579002006160001-01-01-00.00.00.000000                                                                    CPK015
258000200616**  CPY@
258100200616(c) Finastra International Limited 2001
258200200616     X/COPY WNCPYSRC,SE6740X001
258300200616**  TMMP  - Array of TIMESTAMP
2584002006160001-01-01-00.00.00.000000
