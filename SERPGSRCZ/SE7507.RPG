000100200529     H        1
000200200529      *****************************************************************
000300200529/*OVRF*: OVRDBF FILE(SECTYZ1) TOFILE(SECTY) SHARE(*NO)              : *
000400200529/*STD *  RPGBASE                                                      *
000500200529/*EXI *  TEXT('Midas SE Corporate actions corp. reorganization')
000600200529      *****************************************************************
000700200529      *                                                               *
000800200529      *  Midas - Securities Trading Module                            *
000900200529      *                                                               *
001000200529      *  SE7507 - Corporate Action - Corporate Reorganization         *
001100200529      *                                                               *
001200200529      *  Function:  This program maintains the Corporate Action type  *
001300200529      *  (I/C)      CR (Corporate Reorganization).                    *
001400200529      *                                                               *
001500200529      *  (c) Finastra International Limited 2001                      *
001600200529      *                                                               *
001800200619      *  LAST Amend No. MD046248           Date 27Oct17               *
001900200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
002000200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
002100200619      *  Prev Amend No. 247764             Date 12Jun07               *
002200200529      * Midas Plus 1.4 Base ------------------------------------------*
002300200529      * Midas Plus 1.3 ----------- Base ------------------------------*
002400200529      *                 CSD031             Date 10Apr06               *
002500200529      *                 CSD027             Date 09Dec05               *
002600200529      *                 CSE071             Date 19Jul05               *
002700200529      *                 CSW037A            Date 02May05               *
002800200529      *                 CSD025             Date 11Jan05               *
002900200529      *                 CSW037             Date 15Dec04               *
003000200529      *                 CSW036             Date 15Dec04               *
003100200529      *                 CLE025             Date 20Oct03               *
003200200529      * Midas Release 4 --------------- Base -------------------------*
003300200529      * Midas DBA 3.04 -----------------------------------------------*
003400200529      * Midas DBA 3.03 -----------------------------------------------*
003500200529      *                 CAP137             Date 07Feb00               *
003600200529      *                 CSE020             Date 21Mar00               *
003700200529      * Midas DBA 3.00 ---------------- Base -------------------------*
003800200529      *                 161729             Date 02Jun99               *
003900200529      *                 155622             Date 22Feb99               *
004000200529      *                 137884             Date 20Jul98               *
004100200529      *                 138957             Date 16Jul98               *
004200200529      *                 138962             Date 13Aug98               *
004300200529      *                 CSE007  *CREATE    Date  1DEC97               *
004400200529      *                                                               *
004500200529      *---------------------------------------------------------------*
004600200529      *                                                               *
004800200529      *  MD046248 - Finastra Rebranding                               *
004900200529      *  247764 - Database Error on Corporate Action Screen.  Apply   *
005000200529      *           UBS-MAD local fix 221720.                           *
005100200529      *  221720 - Return to General Information screen when F12 is    *
005200200529      *           pressed from detail screen and there is only 1      *
005300200529      *           option.                                             *
005400200529      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
005500200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
005600200529      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
005700200529      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
005800200529      *  CSD025 - Customer De-Activation                              *
005900200529      *  CSW037 - Additional Field Data on MT300/MT320                *
006000200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
006100200529      *  CLE025 - Credit Lines (Recompile)                            *
006200200529      *  CAP137 - Conversion of SE Security inputs into modular       *
006300200529      *           structure to use as APIs.                           *
006400200529      *  CSE020 - Corporate Actions Domino Effect Processing          *
006500200529      *           (Recompiled due to changes in PF/SECORFPD)          *
006600200529      *  161729 - Review setup of default values for fields Market    *
006700200529      *           price.                                              *
006800200529      *  155622 - Corporate Actions:                                  *
006900200529      *           1. New Security Shortname must be defaulted with    *
007000200529      *              the Event Security Shortname if left blanks      *
007100200529      *           2. Review validation of Cash Payment                *
007200200529      *  137884 - Corporate Actions: Cash fields can be changed even  *
007300200529      *           if the Corporate action is stock authorised.        *
007400200529      *  138957 - Corporate Actions: Review information passed to     *
007500200529      *           RPG/SE0040 (Security Details Maintenance) for a     *
007600200529      *           Name Change event where the Security Shortname is   *
007700200529      *           being changed (when F15 is pressed).                *
007800200529      *  138962 - Corporate Actions: various errors:                  *
007900200529      *           Due to new parameter used for Corporate Type        *
008000200529      *           Exercises and Conversion linked to Dividend Events  *
008100200529      *           or Right Issues, add new parameter on ENTRY list,   *
008200200529      *           this new parameter is not used in this program.     *
008300200529      *  CSE007 - Corporate Actions                                   *
008400200529      *                                                               *
008500200529      *****************************************************************
008600200529      *
008700200529      **  SE Corporate Actions - Name Changes
008800200529      *
008900200529     FSECOCRL0UF  E           K        DISK         KINFSR *PSSR A
009000200529     F                                              KCOMIT
009100200529      *
009200200529      **  Reference file
009300200529      *
009400200529     FSECORFL0UF  E           K        DISK         KINFSR *PSSR A
009500200529     F                                              KCOMIT
009600200529      *
009700200529      **  Security file
009800200529      *
009900200529     FSECTYZ1 IF  E           K        DISK         KINFSR *PSSR
010000200529      *
010100200529      **  Display file
010200200529      *
010300200529     FSE7507DFCF  E                    WORKSTN      KINFSR *PSSR
010400200529     F                                        #1RRN KSFILE SE7507S1
010500200529      *                                                                   161729
010600200529      **   Market Prices                                                  161729
010700200529      *                                                                   161729
010800200529     FPRICM   IF  E           K        DISK                               161729
010900200529     F                                              KINFSR *PSSR          161729
011000200529      *                                                                   161729
011100200529      **   Security Events by Type                                        161729
011200200529      *                                                                   161729
011300200529     FSECED   IF  E           K        DISK                               161729
011400200529     F                                              KINFSR *PSSR          161729
011500200529      *                                                                   161729
011600200529     F/COPY WNCPYSRC,SE7507F001
011700200529      *****************************************************************
011800200529      /EJECT
011900200529      *****************************************************************
012000200529      *                                                               *
012100200529      *                  FUNCTION OF INDICATORS                       *
012200200529      *                  ----------------------                       *
012300200529      *                                                               *
012400200529      *       15         Call Security Maintenance program            *
012500200529      *       20-35      Fields error in Display file                 *
012600200529      *       70         0 - Amend or Insert mode                     *
012700200529      *                  1 - Enquire mode                             *
012800200529      *       77         Record not found.                            *
012900200529      *       89         Record not found.                            *
013000200529      *       90-99      Standard MIDAS subroutines                   *
013100200529      *       KC         Exit program                                 *
013200200529      *       KL         Previous                                     *
013300200529      *       LR         End program.   ion with override             *
013400200529      *       U7+U8      Database error occurs                        *
013500200529      *                                                               *
013600200529      *****************************************************************
013700200529      *                                                               *
013800200529      *  S U B R O U T I N E   I N D E X                              *
013900200529      *                                                               *
014000200529      *  SRINIT   - Initial Processing                                *
014100200529      *  SRMAIN   - Main Processing                                   *
014200200529      *  SRENDP   - End Processing                                    *
014300200529      *  SRCLRS   - Clear screen fields                               *
014400200529      *  SRINTS   - Initialise screen field                           *
014500200529      *  SRVALD   - Validate Details entered                          *
014600200529      *  SRSAVE   - Save screen fields                                *
014700200529      *  *PSSR    - Program error handling routine                    *
014800200529      *  ZASNMS   - Send message to program's message queue           *
014900200529      *                                                               *
015000200529      *****************************************************************
015100200529      /EJECT
015200200529      *****************************************************************
015300200529      *
015400200529      **  Array for Copyright
015500200529      *
015600200529     E                    CPY@    1   1 80
015700200529      *
015800200529      **  Array for Narrative
015900200529      *
016000200529     E***********         NARR    1   2 27                                CAP137
016100200529     E                    NARR    1   3 27                                CAP137
016200200529      *
016300200529      **  Array for Subfile fields
016400200529      *
016500200529     E                    AR1        20 10
016600200529     E                    AR2        20 16
016700200529     E                    AR3        20 16
016800200529     E                    AR4        20  6
016900200529     E                    AR5        20  1
017000200529     E                    AR6        20  1
017100200529     E                    AR7        20 16
017200200529     E                    AR8        20 16
017300200529     E/COPY WNCPYSRC,SE7507E001
017400200529      *
017500200529     E/COPY ZSRSRC,ZDATE2Z1
017600200529      *
017700200529     E/COPY ZSRSRC,ZALIGNZ1
017800200529      *
017900200529     E/COPY ZSRSRC,ZASIGNZ1
018000200529      *
018100200529     E/COPY ZSRSRC,ZSEDITZ1
018200200529      *
018300200529     E                    POWER8  1   8  8 3             POWER8 ARRAY
018400200529      *****************************************************************
018500200529      /EJECT
018600200529      *****************************************************************
018700200529      *
018800200529      **  Program Data Structure
018900200529      *
019000200529     IPGMDS     ESDSY2PGDSP
019100200529      *
019200200529      **   LOCAL DATA AREA
019300200529      *
019400200529     ILDA       E DSLDA                         256
019500200529      *
019600200529      **  Local data area for database error details
019700200529      **  *LOCK IN LDA immediately before and OUT LDA immediately
019800200529      **  after each database error handling.
019900200529      **
020000200529      **                                    134 141 DBFILE
020100200529      **       Defines:                     142 170 DBKEY
020200200529      **                                    171 180 DBPGM
020300200529      **                                    181 1830DBASE
020400200529      *
020500200529      *
020600200529      **  Bank Details
020700200529      *
020800200529     ISDBANK    E DSSDBANKPD
020900200529      *
021000200529      **  Customer Details
021100200529      *
021200200529     ISDCUST    E DSSDCUSTPD
021300200529      *                                                                   CAP137
021400200529      ** Externally described DS for SAR details                          CAP137
021500200529     ISCSARD    E DSSCSARDPD                                              CAP137
021600200529      *                                                                   CAP137
021700200529      ** DS for Access program, Short data structure                      CAP137
021800200529     IDSFDY     E DSDSFDY                                                 CAP137
021900200529      *
022000200529      **  Second DS for Access Programs, Long Data Structure
022100200529      *
022200200529     IDSSDY     E DSDSSDY
022300200529      *
022400200529     ISCRDS       DS
022500200529     I                                      197 205 DSPNUM
022600200529     I                                    B 378 3790CPFPOS
022700200529      *
022800200529     I/COPY ZSRSRC,ZSEDITZ2
022900200529     I/COPY WNCPYSRC,SE7507I001
023000200529      *****************************************************************
023100200529      /EJECT
023200200529      *****************************************************************
023300200529      *                                                               *
023400200529      *            MAIN   - Main Routine                              *
023500200529      *                                                               *
023600200529      * CALLS      SRINIT - Initial Processing                        *
023700200529      *            SRMAIN - Main Processing                           *
023800200529      *            SRENDP - End Processing                            *
023900200529      *                                                               *
024000200529      * CALLED BY         -                                           *
024100200529      *                                                               *
024200200529      * FLDS USED         -                                           *
024300200529      *                                                               *
024400200529      *****************************************************************
024500200529      *
024600200529      **  Input Parameter List
024700200529      *
024800200529     C           *ENTRY    PLIST
024900200529     C                     PARM           PCORF   6        Reference
025000200529     C                     PARM           PSESN  10        Security Short.
025100200529     C                     PARM           PCOAT   2        Corporate Type
025200200529     C                     PARM           PSTAT   1        Corporate Action Stat
025300200529     C                     PARM           PFINA   1        Final Allocation Indi
025400200529     C                     PARM           PCOEX   5        Ex-Date
025500200529     C                     PARM           POPNB   2        Option Number
025600200529     C                     PARM           PMODE   1        Mode
025700200529     C                     PARM           PRTCD   1        Return Code
025800200529     C                     PARM           @FIELD  1        Parm not used| 138962
025900200529     C/COPY WNCPYSRC,SE7507C003
026000200529      *
026100200529     C                     MOVEACPY@      CPY2@  80
026200200529      *
026300200529      **  Initial Processing
026400200529      *
026500200529     C                     EXSR SRINIT
026600200529      *
026700200529      **  Main Processing
026800200529      *
026900200529     C                     EXSR SRMAIN
027000200529      *
027100200529      **  End Processing
027200200529      *
027300200529     C                     EXSR SRENDP
027400200529      *****************************************************************
027500200529      /EJECT
027600200529      *****************************************************************
027700200529      *                                                               *
027800200529      *            SRINIT - Initial Processing                        *
027900200529      *                                                               *
028000200529      * CALLS      *PSSR  - Program error handling routine.           *
028100200529      *                                                               *
028200200529      * CALLED BY         -                                           *
028300200529      *                                                               *
028400200529      * FLDS USED         -                                           *
028500200529      *                                                               *
028600200529      *****************************************************************
028700200529     C           SRINIT    BEGSR
028800200529      *
028900200529      **  Copyright Statement
029000200529      *
029100200529     C                     MOVEACPY@      MKI@   80
029200200529      *
029300200529     C           *NAMVAR   DEFN           LDA
029400200529      *
029500200529     C                     MOVEL'SE7507'  DBPGM
029600200529      *
029700200529      **  Setup Screen Time
029800200529      *
029900200529     C                     TIME           ##TME   60       Screen time.
030000200529      *
030100200529      **  Access Bank Details
030200200529      *
030300200529     C                     CALL 'AOBANKR0'
030400200529     C                     PARM *BLANKS   WLRTCD  7
030500200529     C                     PARM '*FIRST'  WLOPTN  7
030600200529     C           SDBANK    PARM SDBANK    DSSDY
030700200529      *
030800200529      **  If record not found
030900200529      *
031000200529     C           WLRTCD    IFNE *BLANKS                    B*1
031100200529     C           *LOCK     IN   LDA
031200200529     C                     Z-ADD1         DBASE
031300200529     C                     MOVE 'SDBANKPD'DBFILE
031400200529     C                     MOVEL*BLANKS   DBKEY
031500200529     C                     OUT  LDA
031600200529     C                     EXSR *PSSR
031700200529     C                     ENDIF                           E*1
031800200529      *
031900200529     C                     MOVE BJMRDT    ##MRDT           Midas Run Date
032000200529      *
032100200529      **  Determine Date Format
032200200529      *
032300200529     C           BJDFIN    IFEQ 'M'                        B*1
032400200529     C                     MOVE '1'       *IN98
032500200529     C                     ENDIF                           E*1
032600200529      *
032700200529      ** Retrieve Nominal Currency of the Event Security
032800200529      *
032900200529     C           PSESN     CHAINSECTYZ1              89
033000200529      *
033100200529      ** If record not found
033200200529      *
033300200529     C           *IN89     IFEQ '1'                        B*1
033400200529     C           *LOCK     IN   LDA
033500200529     C                     Z-ADD2         DBASE
033600200529     C                     MOVE 'SECTYD'  DBFILE
033700200529     C                     MOVELPSESN     DBKEY
033800200529     C                     OUT  LDA
033900200529     C                     EXSR *PSSR
034000200529     C                     ENDIF                           E*1
034100200529      *
034200200529     C                     MOVE PSESN     SSECN            Security Short.
034300200529     C                     MOVE PCOAT     SCOAT            Security Short.
034400200529     C                     MOVE PCORF     SCORF            Security Short.
034500200529     C                     MOVE POPNB     SOPNB
034600200529     C                     MOVE NMDP      WNMDP   20       Number of Decimal Pos
034700200529     C                     MOVE POPNB     WOPNB   20
034800200529      *
034900200529     C           PCOEX     IFNE *BLANKS
035000200529     C           PCOEX     ANDNE'00000'
035100200529     C                     MOVE PCOEX     ZDAYNO
035200200529     C                     EXSR ZDATE2
035300200529     C                     MOVE ZDATE     SEXDT            Ex-Date
035400200529     C                     ELSE
035500200529     C                     MOVE *BLANKS   SEXDT            Ex-Date
035600200529     C                     ENDIF
035700200529      *
035800200529     C                     MOVEL'SEUSRMSG'PMSGF  10
035900200529      *
036000200529      **  Fill in Fields for Subroutine ZASNMS
036100200529      *
036200200529     C                     MOVEL'SE7507'  ZAPGM  10        Message queue
036300200529     C                     MOVEL'SEUSRMSG'ZAMSGF 10        Message file
036400200529     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue
036500200529     C                     MOVEL*BLANK    ZAMSID  7        Message Id.
036600200529     C                     MOVEL*BLANK    ZAMSDA132        Message data.
036700200529     C                     MOVEL*BLANK    ZAMSTP  7        Message type.
036800200529      *
036900200529      **  Clear Messages from Program Message Queue.
037000200529      *
037100200529     C/COPY WNCPYSRC,SE7507C004
037200200529     C                     CALL 'Y2CLMSC'
037300200529     C                     PARM ##PGM     ZAPGM  10
037400200529     C                     PARM '*SAME'   ZAPGRL  5
037500200529      *
037600200529     C                     WRITESE7507C2
037700200529      *
037800200529     C/COPY WNCPYSRC,SE7507C001
037900200529      *
038000200529      **  Check if SO1401 is active
038100200529      *
038200200529     C                     CALL 'AOSARDR0'
038300200529     C                     PARM '       ' WLRTCD
038400200529     C                     PARM '*VERIFY' WLOPTN
038500200529     C                     PARM 'S01401'  @SARD   6
038600200529      *
038700200529     C                     MOVE *BLANKS   SCHCK   1
038800200529     C           WLRTCD    IFEQ *BLANK                     B*1
038900200529     C                     MOVE 'Y'       SCHCK
039000200529     C                     ELSE
039100200529     C                     MOVE 'N'       SCHCK
039200200529     C                     ENDIF                           E*1
039300200529      *                                                                   CAP137
039400200529      ** Check if API Securities New Screen Input is installed.           CAP137
039500200529      *                                                                   CAP137
039600200529     C                     CALL 'AOSARDR0'                                CAP137
039700200529     C                     PARM *BLANKS   WLRTCD                          CAP137
039800200529     C                     PARM '*VERIFY' WLOPTN                          CAP137
039900200529     C                     PARM 'CAP137'  WLSARD  6                       CAP137
040000200529     C           SCSARD    PARM SCSARD    DSFDY                           CAP137
040100200529      *                                                                   CAP137
040200200529      ** An NRF (No Record Found) return code is valid.                   CAP137
040300200529      ** Issue database error only for error return codes.                CAP137
040400200529      *                                                                   CAP137
040500200529     C           WLRTCD    IFNE *BLANKS                                   CAP137
040600200529     C           WLRTCD    ANDNE'*NRF   '                                 CAP137
040700200529     C           *LOCK     IN   LDA                                       CAP137
040800200529     C                     Z-ADD4         DBASE                           CAP137
040900200529     C                     MOVEL'SCSARDPD'DBFILE                          CAP137
041000200529     C                     MOVEL'CAP137'  DBKEY                           CAP137
041100200529     C                     OUT  LDA                                       CAP137
041200200529     C                     EXSR *PSSR                                     CAP137
041300200529     C                     ENDIF                                          CAP137
041400200529      *                                                                   CAP137
041500200529     C           WLRTCD    IFEQ *BLANK                                    CAP137
041600200529     C                     MOVEL'Y'       CAP137  1                       CAP137
041700200529     C                     MOVEL'SESECS'  PPGM    9                       CAP137
041800200529     C                     MOVE 'SIN'     PPGM                            CAP137
041900200529     C                     ELSE                                           CAP137
042000200529     C                     MOVEL'N'       CAP137                          CAP137
042100200529     C                     MOVE *BLANKS   PPGM                            CAP137
042200200529     C                     ENDIF                                          CAP137
042300200529      *
042400200529      ** Just for definition of the file in 'F' card with a 'A' (=ADD)
042500200529      ** Needed because file already open in calling program in Update
042600200529      ** Mode with ADD option specified
042700200529      *
042800200529     C           *IN99     IFEQ '0'                        B*1
042900200529     C           *IN99     ANDEQ'1'
043000200529     C                     WRITESECORFD0
043100200529     C                     ENDIF                           E*1
043200200529      *
043300200529      **  Determine fields to protect depending of the Status and the Final Allo
043400200529      *
043500200529     C                     MOVEA'000'     *IN,60
043600200529     C                     MOVE '0'       *IN63                           137884
043700200529      *
043800200529      **  LS=Final Allocation Stock          (*IN60)
043900200529      **  LY=Final Allocation Cash and Stock (*IN61)
044000200529      ****S*=Stock*Authorised****************(*IN62)                      137884
044100200529      **  S =Stock Authorised                (*IN63)                      137884
044200200529      **  X =Fully Authorised (Cash & Stock) (*IN62)
044300200529      *
044400200529     C           PSTAT     IFEQ 'L'                        B*1
044500200529      *
044600200529     C           PFINA     IFEQ 'S'                        B*2
044700200529     C                     MOVE '1'       *IN60
044800200529     C                     ELSE                            X*2
044900200529      *
045000200529     C           PFINA     IFEQ 'Y'                        B*3
045100200529     C                     MOVE '1'       *IN61
045200200529     C                     ENDIF                           E*3
045300200529      *
045400200529     C                     ENDIF                           E*2
045500200529      *
045600200529     C                     ELSE                            X*1
045700200529      *
045800200529     C           PSTAT     IFEQ 'S'                        B*2
045900200529     C           PSTAT     OREQ 'X'
046000200529     C                     MOVE '1'       *IN62
046100200529     C           PSTAT     IFEQ 'S'                                       137884
046200200529     C                     MOVE '1'       *IN63                           137884
046300200529     C                     ENDIF                                          137884
046400200529     C                     ENDIF                           E*2
046500200529      *
046600200529     C                     ENDIF                           E*1
046700200529      *
046800200529     C                     ENDSR
046900200529      *****************************************************************
047000200529      /EJECT
047100200529      *****************************************************************
047200200529      *                                                               *
047300200529      *            SRMAIN - Main Processing                           *
047400200529      *                                                               *
047500200529      * CALLS      SRCLRS - Clear Screen Fields                       *
047600200529      *            SRINTS - Initialise Screen Fields                  *
047700200529      *            SRVALD - Validate Details Entered                  *
047800200529      *            SRSAVE - Save Screen Fields                        *
047900200529      *            SE0040 - Security Detail Maintenance               *
048000200529      *                                                               *
048100200529      * CALLED BY         -                                           *
048200200529      *                                                               *
048300200529      * FLDS USED         -                                           *
048400200529      *                                                               *
048500200529      *****************************************************************
048600200529     C           SRMAIN    BEGSR
048700200529      *
048800200529     C                     MOVE '0'       *IN75
048900200529     C                     MOVE 'N'       WWEND   1
049000200529      *
049100200529      **  Protect fields if the mode is not Amend
049200200529      *
049300200529     C           PMODE     IFEQ 'A'                        B*1
049400200529     C           PMODE     OREQ 'I'
049500200529     C           PMODE     OREQ 'U'
049600200529     C                     MOVE '0'       *IN70
049700200529     C                     ELSE                            X*1
049800200529     C                     MOVE '1'       *IN70
049900200529     C                     ENDIF                           E*1
050000200529      *
050100200529     C                     EXSR SRCLRS
050200200529      *
050300200529     C/COPY WNCPYSRC,SE7507C005
050400200529     C                     EXSR SRINTS
050500200529     C/COPY WNCPYSRC,SE7507C006
050600200529      *
050700200529      **  Do while F3, F12 not pressed
050800200529      *
050900200529     C           *INKC     DOWEQ'0'                        B*1
051000200529     C           *INKL     ANDEQ'0'
051100200529     C           WWEND     ANDEQ'N'
051200200529      *
051300200529     C                     TIME           ##TME            Screen time.
051400200529     C                     MOVE '0'       *IN84
051500200529     C                     Z-ADD0         K       20
051600200529     C                     EXSR SRBLD
051700200529      *
051800200529     C/COPY WNCPYSRC,SE7507C007
051900200529     C                     WRITESE7507C2
052000200529     C                     WRITESE7507F1
052100200529     C                     EXFMTSE7507C1
052200200529     C/COPY WNCPYSRC,SE7507C008
052300200529      *
052400200529      **  Clear Messages from Program Message Queue.
052500200529      *
052600200529     C           *IN56     IFEQ '0'                        B*2
052700200529     C                     MOVEA'00000000'*IN,20
052800200529     C                     MOVEA'00000000'*IN,28
052900200529     C                     MOVEA'00'      *IN,77
053000200529     C                     MOVE 'N'       ERROR   1
053100200529      *
053200200529     C                     ELSE
053300200529     C                     Z-ADD0         X
053400200529     C                     ENDIF                           E*2
053500200529      *
053600200529     C           *INKC     IFEQ '0'                        B*2
053700200529     C           *INKL     ANDEQ'0'
053800200529     C           *IN15     ANDEQ'0'
053900200529     C           *IN56     ANDEQ'0'
054000200529     C                     EXSR SRVALD
054100200529      *
054200200529     C           ERROR     IFEQ 'N'                        B*3
054300200529     C                     EXSR SRSAVE
054400200529     C                     MOVE 'Y'       WWEND
054500200529     C                     ENDIF                           E*3
054600200529     C/COPY WNCPYSRC,SE7507C009
054700200529      *
054800200529     C                     ENDIF                           E*2
054900200529      *
055000200529      **  If F15 pressed, Call "Securities Maintenance" program
055100200529      *
055200200529     C           *IN15     IFEQ '1'                        B*2
055300200529      *
055400200529      ** Call SE0040 with the action code 'I'
055500200529      *
055600200529     C                     MOVE *BLANKS   #RTRN   7
055700200529     C                     MOVE SSECA     #SESN  10
055800200529      *
055900200529     C           SSECA     IFEQ SSECN                      B*3
056000200529     C                     MOVE 'A'       #ACTC   1
056100200529     C                     MOVE *BLANKS   #SESO  10
056200200529     C                     ELSE                            X*3
056300200529     C                     MOVE 'I'       #ACTC
056400200529     C                     MOVE SSECN     #SESO
056500200529     C                     ENDIF                           E*3
056600200529      *
056700200529     C           CAP137    IFNE 'Y'                                       CAP137
056800200529     C                     CALL 'SE0040'               99
056900200529     C                     PARM           #RTRN
057000200529     C                     PARM           #ACTC
057100200529     C                     PARM           #SESN
057200200529     C                     PARM           #SESO
057300200529     C                     PARM *BLANKS   #OTHER156                       138957
057400200529     C                     ELSE                                           CAP137
057500200529     C                     CALL 'SEC023'               99                 CAP137
057600200529     C                     PARM           PPGM                            CAP137
057700200529     C                     PARM           #RTRN                           CAP137
057800200529     C                     PARM           #ACTC                           CAP137
057900200529     C                     PARM           #SESN                           CAP137
058000200529     C                     PARM           #SESO                           CAP137
058100200529     C                     PARM *BLANKS   #OTHER                          CAP137
058200200529     C                     PARM 'Y'       PLINK   1                       CAP137
058300200529     C                     ENDIF                                          CAP137
058400200529      *
058500200529     C           *IN99     IFEQ '1'                        B*3
058600200529     C           *INU7     OREQ '1'
058700200529     C           *INU8     OREQ '1'
058800200529     C           *LOCK     IN   LDA
058900200529     C                     Z-ADD3         DBASE
059000200529     C                     MOVEL*BLANKS   DBFILE
059100200529     C           CAP137    IFNE 'Y'                                       CAP137
059200200529     C                     MOVELNARR,1    DBKEY
059300200529     C                     ELSE                                           CAP137
059400200529     C                     MOVELNARR,3    DBKEY                           CAP137
059500200529     C                     ENDIF                                          CAP137
059600200529     C                     OUT  LDA
059700200529     C                     EXSR *PSSR
059800200529     C                     ENDIF                           E*3
059900200529      *                                                                   137884
060000200529     C           #RTRN     IFEQ *BLANKS                    B*3            137884
060100200529     C                     EXSR SRVALD                                    137884
060200200529     C                     ENDIF                           E*3            137884
060300200529      *
060400200529     C                     ENDIF                           E*2
060500200529      *
060600200529      **  If <enter> pressed, validate screen fields
060700200529      *
060800200529     C                     ENDDO                           E*1
060900200529      *
061000200529     C                     ENDSR
061100200529      *****************************************************************
061200200529      /EJECT
061300200529      *****************************************************************
061400200529      *                                                               *
061500200529      *            SRENDP - End Processing                            *
061600200529      *                                                               *
061700200529      * CALLS             -                                           *
061800200529      *                                                               *
061900200529      * CALLED BY         -                                           *
062000200529      *                                                               *
062100200529      * FLDS USED         -                                           *
062200200529      *                                                               *
062300200529      *****************************************************************
062400200529     C           SRENDP    BEGSR
062500200529      *
062600200529     C           *INKC     IFEQ '1'                        B*1
062700200529     C                     MOVE '3'       PRTCD
062800200529     C                     ENDIF                           E*1
062900200529      *                                                                                       247764
063000200529     C           *INKL     IFEQ '1'                                                           247764
063100200529     C                     MOVE '2'       PRTCD                                               247764
063200200529     C                     ENDIF                                                              247764
063300200529      *
063400200529     C           PMODE     IFEQ 'A'                        B*1
063500200529      *
063600200529     C           *INKC     IFEQ '1'                        B*2
063700200529     C           *INKL     OREQ '1'
063800200529     C                     ROLBK
063900200529     C                     ENDIF                           E*2
064000200529      *
064100200529     C                     ENDIF                           E*1
064200200529     C/COPY WNCPYSRC,SE7507C010
064300200529      *
064400200529      **  End Program
064500200529      *
064600200529     C                     MOVE '1'       *INLR
064700200529     C                     RETRN
064800200529      *
064900200529     C                     ENDSR
065000200529      *****************************************************************
065100200529      /EJECT
065200200529      *****************************************************************
065300200529      *                                                               *
065400200529      *            SRCLRS - Clear screen fields                       *
065500200529      *                                                               *
065600200529      * CALLS             -                                           *
065700200529      *                                                               *
065800200529      * CALLED BY  SRMAIN - Main Processing                           *
065900200529      *                                                               *
066000200529      * FLDS USED         -                                           *
066100200529      *                                                               *
066200200529      *****************************************************************
066300200529     C           SRCLRS    BEGSR
066400200529      *
066500200529      **   CLEAR SUBFILE
066600200529      *
066700200529     C                     MOVE '1'       *IN80
066800200529     C                     WRITESE7507C1
066900200529     C                     MOVE '0'       *IN80
067000200529     C                     MOVE '0'       *IN81
067100200529     C                     MOVE '0'       *IN55
067200200529     C                     Z-ADD0         #1RRN
067300200529      *
067400200529     C                     ENDSR
067500200529      *****************************************************************
067600200529      /EJECT
067700200529      *****************************************************************
067800200529      *                                                               *
067900200529      *            SRINTS - Initialise screen fields                  *
068000200529      *                                                               *
068100200529      * CALLS      *PSSR  - Program error handling routine            *
068200200529      *                                                               *
068300200529      * CALLED BY  SRMAIN - Main Processing                           *
068400200529      *                                                               *
068500200529      * FLDS USED         -                                           *
068600200529      *                                                               *
068700200529      *****************************************************************
068800200529     C           SRINTS    BEGSR
068900200529      *
069000200529     C           KEY1      KLIST
069100200529     C                     KFLD           PCORF
069200200529     C                     KFLD           WOPNB
069300200529      *
069400200529     C           KEY1      CHAINSECOCRD0             77
069500200529      *
069600200529     C           *IN77     IFEQ '1'                        B*1
069700200529     C                     MOVEA*BLANKS   AR1
069800200529     C                     MOVEA*BLANKS   AR2
069900200529     C                     MOVEA*BLANKS   AR3
070000200529     C                     MOVEA*BLANKS   AR4
070100200529     C                     MOVEA*BLANKS   AR5
070200200529     C                     MOVEA*BLANKS   AR6
070300200529     C                     MOVEA*BLANKS   AR7
070400200529     C                     MOVEA*BLANKS   AR8
070500200529     C                     MOVE *BLANKS   SOSH1
070600200529     C                     MOVE *BLANKS   SADRE
070700200529     C                     MOVE *BLANKS   SCAPA
070800200529     C                     MOVE *BLANKS   STXT1
070900200529     C                     MOVE *BLANKS   STXT2
071000200529     C                     MOVE *BLANKS   STXT3
071100200529     C                     MOVE *BLANKS   STXT4
071200200529     C                     MOVE *BLANKS   SOPSH
071300200529     C                     ELSE                             X*1
071400200529     C                     MOVEAMHSECA    AR1
071500200529     C                     MOVEAMHNSHA    AR2
071600200529     C                     MOVEAMHDMLA    AR3
071700200529     C                     MOVEAMHDVRA    AR4
071800200529     C                     MOVEAMHDVRA    AR4
071900200529     C                     MOVEAMHRNDN    AR5
072000200529     C                     MOVEAMHRNDS    AR6
072100200529     C                     MOVEAMHCOPA    AR7
072200200529     C                     MOVEAMHMKTP    AR8
072300200529      *
072400200529     C           MHOSHA    IFNE *ZEROS                     B*2
072500200529     C                     MOVE *BLANKS   ZFLD15
072600200529     C                     MOVE MHOSHA    ZFLD15
072700200529     C                     Z-ADD7         ZDECS
072800200529     C                     MOVE 'L'       ZECODE
072900200529     C                     EXSR ZSEDIT
073000200529     C                     MOVEL*BLANKS   SOSH1
073100200529     C                     MOVE ZOUT21    WFLD17 17
073200200529     C                     MOVELWFLD17    SOSH1
073300200529     C                     ELSE                            X*2
073400200529     C                     MOVE *BLANKS   SOSH1
073500200529     C                     ENDIF                           E*2
073600200529     C*
073700200529     C                     MOVE MHADRE    SADRE
073800200529      *
073900200529     C           MHCAPA    IFNE *ZEROS                     B*2
074000200529     C                     MOVE *BLANKS   ZFLD15
074100200529     C                     MOVELMHCAPA    ZFLD15
074200200529     C*****                Z-ADDWNMDP     ZDECS                           155622
074300200529     C                     Z-ADD7         ZDECS                           155622
074400200529     C                     EXSR ZSEDIT
074500200529     C                     MOVEL*BLANKS   SCAPA
074600200529     C                     MOVE ZOUT21    WFLD17
074700200529     C                     MOVELWFLD17    SCAPA
074800200529     C                     ELSE                            X*2
074900200529     C                     MOVE *BLANKS   SCAPA
075000200529     C                     ENDIF                           E*2
075100200529      *
075200200529     C                     MOVE MHTXT1    STXT1
075300200529     C                     MOVE MHTXT2    STXT2
075400200529     C                     MOVE MHTXT3    STXT3
075500200529     C                     MOVE MHTXT4    STXT4
075600200529     C                     MOVE MHOPSH    SOPSH
075700200529     C                     ENDIF                           E*1
075800200529      *
075900200529      **  Clear Messages from Program Message Queue.
076000200529      *
076100200529     C                     MOVE 0         X       20
076200200529     C                     MOVE 0         Y       20
076300200529     C                     MOVE 0         Z       20
076400200529     C                     ENDSR
076500200529      *****************************************************************
076600200529      /EJECT
076700200529      *****************************************************************
076800200529      *                                                               *
076900200529      *            *PSSR  - Program error handling routine            *
077000200529      *                                                               *
077100200529      * CALLS      DBERRCTL - DB error                                *
077200200529      *                                                               *
077300200529      * CALLED BY  SRINIT - Initial Processing                        *
077400200529      *            SRINTS - Initialise Screen Fields                  *
077500200529      *            SRSAVE - Save Screen Fields                        *
077600200529      *                                                               *
077700200529      * FLDS USED         -                                           *
077800200529      *                                                               *
077900200529      *****************************************************************
078000200529     C           *PSSR     BEGSR
078100200529      *
078200200529     C/COPY WNCPYSRC,SE7507C011
078300200529     C                     CALL 'Y2CLMSC'
078400200529     C                     PARM ##PGM     ZAPGM  10
078500200529     C                     PARM '*SAME'   ZAPGRL  5
078600200529     C/COPY WNCPYSRC,SE7507C012
078700200529      *
078800200529      **  Rollback Changes, Print Dump and Cancel Program
078900200529      *
079000200529     C                     ROLBK
079100200529     C                     MOVE 'E'       PRTCD
079200200529     C                     DUMP
079300200529      *
079400200529     C                     MOVE '1'       *INU7
079500200529     C                     MOVE '1'       *INU8
079600200529     C                     MOVE '1'       *INLR
079700200529     C/COPY WNCPYSRC,SE7507C013
079800200529     C                     CALL 'DBERRCTL'
079900200529     C/COPY WNCPYSRC,SE7507C014
080000200529     C                     RETRN
080100200529      *
080200200529     C                     ENDSR
080300200529      *****************************************************************
080400200529      /EJECT                                                              S01401
080500200529      *****************************************************************
080600200529      *                                                               *   S01401
080700200529      *            ZASNMS - Send Message to program's Message Queue.  *
080800200529      *                                                               *
080900200529      * CALLS             -                                           *
081000200529      *                                                               *
081100200529      * CALLED BY         -                                           *
081200200529      *                                                               *
081300200529      * FLDS USED         -                                           *
081400200529      *                                                               *
081500200529      *****************************************************************
081600200529     C           ZASNMS    BEGSR
081700200529      *
081800200529      **  Message file specified use PMSGF
081900200529      *
082000200529     C                     MOVELPMSGF     ZAMSGF
082100200529     C/COPY WNCPYSRC,SE7507C015
082200200529     C                     CALL 'Y2SNMGC'
082300200529     C                     PARM           ZAPGM  10        Program queue
082400200529     C                     PARM           ZAPGRL  5        Rel queue
082500200529     C                     PARM           ZAMSID  7        Message Id.
082600200529     C                     PARM           ZAMSGF 10        Message file.
082700200529     C                     PARM           ZAMSDA132        Message data.
082800200529     C                     PARM           ZAMSTP  7        Message type.
082900200529     C/COPY WNCPYSRC,SE7507C016
083000200529      *
083100200529      **  Clear all fields for default mechanism next time.
083200200529      *
083300200529     C                     MOVEL*BLANK    ZAPGM            Program queue
083400200529     C                     MOVEL*BLANK    ZAPGRL           Rel queue
083500200529     C                     MOVEL*BLANK    ZAMSDA           Message data.
083600200529     C                     MOVEL*BLANK    ZAMSTP           Message type.
083700200529     C                     MOVEL*BLANK    ZAMSGF           Message file
083800200529     C                     MOVEL*BLANK    ZAMSID           Message id.
083900200529      *
084000200529     C                     ENDSR
084100200529     C********************************************************************
084200200529      /EJECT
084300200529      *****************************************************************
084400200529      *                                                               *
084500200529      *            SRBLD  - Build Subfile                             *
084600200529      *                                                               *
084700200529      * CALLS             -                                           *
084800200529      *                                                               *
084900200529      * CALLED BY         -                                           *
085000200529      *                                                               *
085100200529      * FLDS USED         -                                           *
085200200529      *                                                               *
085300200529      *****************************************************************
085400200529     C           SRBLD     BEGSR
085500200529      *
085600200529     C           X         DOWLT4                          B*1
085700200529     C           *IN55     ANDNE'1'
085800200529      *
085900200529     C                     ADD  1         Z
086000200529     C                     ADD  1         X
086100200529     C                     ADD  1         Y
086200200529     C                     ADD  1         #1RRN
086300200529     C/COPY WNCPYSRC,SE7507C017
086400200529     C                     MOVEAAR1,Z     SSECA
086500200529     C/COPY WNCPYSRC,SE7507C018
086600200529      *
086700200529     C           SSECA     CHAINSECTYZ1              89
086800200529      *
086900200529     C                     MOVEAAR2,Z     SNSHA
087000200529      *
087100200529     C           SNSHA     IFNE *BLANKS                    B*2
087200200529     C           SNSHA     ANDNE*ZEROS
087300200529     C                     MOVE *BLANKS   ZFLD15
087400200529     C                     MOVE SNSHA     ZFLD15
087500200529     C                     Z-ADD7         ZDECS
087600200529     C                     MOVE 'L'       ZECODE
087700200529     C                     EXSR ZSEDIT
087800200529     C                     MOVEL*BLANKS   SNSHA
087900200529     C                     MOVE ZOUT21    WFLD17 17
088000200529     C                     MOVELWFLD17    SNSHA
088100200529     C                     ELSE                            X*2
088200200529     C                     MOVE *BLANKS   SNSHA
088300200529     C                     ENDIF                           E*2
088400200529      *
088500200529     C                     MOVEAAR3,Z     SDMLA
088600200529      *
088700200529     C           SDMLA     IFNE *BLANKS                    B*2
088800200529     C           SDMLA     ANDNE*ZEROS
088900200529     C                     MOVE *BLANKS   ZFLD15
089000200529     C                     MOVE SDMLA     ZFLD15
089100200529     C                     Z-ADDNMDP      ZDECS
089200200529     C                     EXSR ZSEDIT
089300200529     C                     MOVEL*BLANKS   SDMLA
089400200529     C                     MOVE ZOUT21    WFLD17
089500200529     C                     MOVELWFLD17    SDMLA
089600200529     C                     ELSE                            X*2
089700200529     C                     MOVE *BLANKS   SDMLA
089800200529     C                     ENDIF                           E*2
089900200529      *
090000200529     C                     MOVEAAR4,Z     SDVRA
090100200529     C                     MOVE SDVRA     SDVRA1  60
090200200529      *
090300200529     C           SDVRA     IFNE *BLANKS                    B*2
090400200529     C           SDVRA     ANDNE*ZEROS
090500200529     C                     Z-ADDSDVRA1    ZDAYNO
090600200529     C                     EXSR ZDATE2
090700200529     C                     MOVE ZDATE     SDVRA
090800200529     C                     ELSE                            X*2
090900200529     C                     MOVE *BLANKS   SDVRA
091000200529     C                     ENDIF                           E*2
091100200529      *
091200200529     C                     MOVEAAR5,Z     SRNDA
091300200529     C                     MOVEAAR6,Z     SRDSA
091400200529     C                     MOVEAAR7,Z     SCOPA
091500200529      *
091600200529     C           SCOPA     IFNE *BLANKS                    B*2
091700200529     C           SCOPA     ANDNE*ZEROS
091800200529     C                     MOVE *BLANKS   ZFLD15
091900200529     C                     MOVE SCOPA     ZFLD15
092000200529     C                     Z-ADD8         ZDECS
092100200529     C                     MOVE 'L'       ZECODE
092200200529     C                     EXSR ZSEDIT
092300200529     C                     MOVEL*BLANKS   SCOPA
092400200529     C                     MOVE ZOUT21    WFLD17 17
092500200529     C                     MOVELWFLD17    SCOPA
092600200529     C                     ELSE                            X*2
092700200529     C                     MOVE *BLANKS   SCOPA
092800200529     C                     ENDIF                           E*2
092900200529      *
093000200529     C           Y         IFEQ 20
093100200529     C                     SETON                     55
093200200529     C                     ENDIF
093300200529      *
093400200529     C                     MOVEAAR8,Z     SMKTP
093500200529      *
093600200529     C           SMKTP     IFNE *BLANKS                    B*2
093700200529     C           SMKTP     ANDNE*ZEROS
093800200529     C                     MOVE *BLANKS   ZFLD15
093900200529     C                     MOVE SMKTP     ZFLD15
094000200529     C                     Z-ADD8         ZDECS
094100200529     C                     MOVE 'L'       ZECODE
094200200529     C                     EXSR ZSEDIT
094300200529     C                     MOVEL*BLANKS   SMKTP
094400200529     C                     MOVE ZOUT21    WFLD17 17
094500200529     C                     MOVELWFLD17    SMKTP
094600200529     C                     ELSE                            X*2
094700200529     C                     MOVE *BLANKS   SMKTP
094800200529     C                     ENDIF                           E*2
094900200529      *
095000200529     C                     MOVE *IN63     WIN63   1                       137884
095100200529     C           SNSHA     IFEQ *BLANKS                    B*2            137884
095200200529     C           *IN63     ANDEQ'1'                                       137884
095300200529     C           SNSHA     OREQ *ZEROS                                    137884
095400200529     C           *IN63     ANDEQ'1'                                       137884
095500200529     C                     MOVE '0'       *IN63                           137884
095600200529     C                     ENDIF                           E*2            137884
095700200529      *                                                                   137884
095800200529     C                     WRITESE7507S1
095900200529     C                     MOVE WIN63     *IN63                           137884
096000200529     C                     ENDDO                           E*1
096100200529      *
096200200529     C                     MOVE Z         Z1      20
096300200529     C                     MOVE #1RRN     W1RRN   40
096400200529     C                     SETOF                         80
096500200529      *
096600200529     C                     ENDSR
096700200529      ********************************************************************
096800200529      /EJECT
096900200529      *****************************************************************
097000200529      *                                                               *
097100200529      *            SRVALD - Validate                                  *
097200200529      *                                                               *
097300200529      * CALLS             -                                           *
097400200529      *                                                               *
097500200529      * CALLED BY         -                                           *
097600200529      *                                                               *
097700200529      * FLDS USED         -                                           *
097800200529      *                                                               *
097900200529      *****************************************************************
098000200529     C           SRVALD    BEGSR
098100200529      *
098200200529     C/COPY WNCPYSRC,SE7507C019
098300200529     C                     CALL 'Y2CLMSC'
098400200529     C                     PARM ##PGM     ZAPGM  10
098500200529     C                     PARM '*SAME'   ZAPGRL  5
098600200529     C/COPY WNCPYSRC,SE7507C020
098700200529      *
098800200529      **  Validate Number of Old Shares
098900200529      *
099000200529     C           SOSH1     IFNE *BLANKS                    B*1
099100200529     C                     MOVE *BLANKS   ZFIELD
099200200529     C                     MOVE SOSH1     ZFIELD
099300200529     C                     Z-ADD8         ZADIG
099400200529     C                     Z-ADD7         ZADEC
099500200529     C                     EXSR ZALIGN
099600200529      *
099700200529     C           *IN99     IFEQ '1'                        B*2
099800200529     C                     MOVEL'CO00103' ZAMSID
099900200529     C                     EXSR ZASNMS
100000200529     C                     MOVE '1'       *IN27
100100200529     C                     MOVE 'Y'       ERROR   1
100200200529     C                     ENDIF                           E*2
100300200529      *
100400200529     C                     ENDIF                           E*1
100500200529      *
100600200529      **  Validate Add/Replace
100700200529      *
100800200529     C           SADRE     IFNE 'R'                        B*1
100900200529     C           SADRE     ANDNE'A'
101000200529     C           SADRE     ANDNE' '
101100200529     C                     MOVEL'CO00137' ZAMSID
101200200529     C                     EXSR ZASNMS
101300200529     C                     MOVE '1'       *IN28
101400200529     C                     MOVE 'Y'       ERROR
101500200529     C                     ENDIF                           E*1
101600200529      *
101700200529      **  Validate Cash Payment
101800200529      *
101900200529     C           SCAPA     IFNE *BLANKS                    B*1
102000200529     C                     MOVE *BLANKS   ZFLD17
102100200529     C                     MOVE SCAPA     ZFLD17
102200200529     C*****      15        SUB  WNMDP     ZSDIG                           155622
102300200529     C*****                Z-ADDWNMDP     ZSDEC                           155622
102400200529     C           15        SUB  7         ZSDIG                           155622
102500200529     C                     Z-ADD7         ZSDEC                           155622
102600200529     C                     EXSR ZASIGN
102700200529      *
102800200529     C           *IN99     IFEQ '1'                        B*2
102900200529     C                     MOVEL'CO00209' ZAMSID
103000200529     C                     EXSR ZASNMS
103100200529     C                     MOVE '1'       *IN29
103200200529     C                     MOVE 'Y'       ERROR
103300200529     C                     ENDIF                           E*2
103400200529     C                     ENDIF                           E*1
103500200529      *
103600200529     C                     READCSE7507S1                 77
103700200529     C                     MOVE '1'       *IN84
103800200529      *
103900200529     C           *IN77     DOWEQ'0'                        B*1
104000200529      *
104100200529      **  Validate New Security Shortname
104200200529      *
104300200529     C           SSECA     IFNE *BLANKS                    B*2
104400200529      *
104500200529      ** Check Security Shortname
104600200529      *
104700200529     C/COPY WNCPYSRC,SE7507C002
104800200529      *
104900200529     C           SSECA     CHAINSECTYZ1              89
105000200529      *
105100200529     C           *IN89     IFEQ '1'                        B*3
105200200529     C                     MOVEL'CO00135' ZAMSID
105300200529     C                     EXSR ZASNMS
105400200529     C                     MOVE '1'       *IN20
105500200529     C                     MOVE 'Y'       ERROR
105600200529     C                     ENDIF                           E*3
105700200529      *                                                                   155622
105800200529     C                     ELSE                            X*2            155622
105900200529     C           SNSHA     IFNE *BLANKS                    B*3            155622
106000200529     C           SDMLA     ORNE *BLANKS                                   155622
106100200529     C           SDVRA     ORNE *BLANKS                                   155622
106200200529     C           SRNDA     ORNE *BLANKS                                   155622
106300200529     C           SRDSA     ORNE *BLANKS                                   155622
106400200529     C           SCOPA     ORNE *BLANKS                                   155622
106500200529     C           SMKTP     ORNE *BLANKS                                   155622
106600200529     C                     MOVE SSECN     SSECA                           155622
106700200529     C                     ENDIF                           E*3            155622
106800200529     C                     ENDIF                           E*2
106900200529      *
107000200529      **  Validate Number of New Shares
107100200529      *
107200200529     C           SNSHA     IFNE *BLANKS                    B*2
107300200529      *
107400200529     C           SSECA     IFEQ *BLANKS                    B*3
107500200529     C                     MOVEL'CO00135' ZAMSID
107600200529     C                     EXSR ZASNMS
107700200529     C                     MOVE '1'       *IN20
107800200529     C                     MOVE 'Y'       ERROR
107900200529     C                     ELSE                            X*3
108000200529     C                     MOVE *BLANKS   ZFIELD
108100200529     C                     MOVE SNSHA     ZFIELD
108200200529     C                     Z-ADD8         ZADIG
108300200529     C                     Z-ADD7         ZADEC
108400200529     C                     EXSR ZALIGN
108500200529      *
108600200529     C           *IN99     IFEQ '1'                        B*4
108700200529     C                     MOVEL'CO00101' ZAMSID
108800200529     C                     EXSR ZASNMS
108900200529     C                     MOVE '1'       *IN21
109000200529     C                     MOVE 'Y'       ERROR
109100200529     C                     ENDIF                           E*4
109200200529      *
109300200529     C                     ENDIF                           E*3
109400200529      *
109500200529     C                     ENDIF                           E*2
109600200529      *
109700200529      **  Validate Denomination Multiplier
109800200529      *
109900200529     C           SSECA     IFNE *BLANKS                    B*2
110000200529      *
110100200529     C           SDMLA     IFEQ *BLANKS                    B*3
110200200529     C                     Z-ADD*ZEROS    ZFLD15
110300200529      *
110400200529     C                     Z-ADDNMDP      Y       20
110500200529     C                     ADD  4         Y
110600200529     C           1         MULT POWER8,Y  ZFLD15
110700200529      *
110800200529     C                     Z-ADDNMDP      ZDECS
110900200529      *
111000200529     C                     EXSR ZSEDIT
111100200529     C                     MOVEL*BLANKS   SDMLA
111200200529     C                     MOVE ZOUT21    WFLD17
111300200529     C                     MOVELWFLD17    SDMLA
111400200529     C                     ENDIF                           E*3
111500200529      *
111600200529     C                     ENDIF                           E*2
111700200529      *
111800200529     C           SDMLA     IFNE *BLANKS                    B*2
111900200529      *
112000200529     C           SSECA     IFEQ *BLANKS                    B*3
112100200529     C                     MOVEL'CO00135' ZAMSID
112200200529     C                     EXSR ZASNMS
112300200529     C                     MOVE '1'       *IN20
112400200529     C                     MOVE 'Y'       ERROR
112500200529     C                     ELSE                            X*3
112600200529     C                     MOVE *BLANKS   ZFIELD
112700200529     C                     MOVE SDMLA     ZFIELD
112800200529     C           15        SUB  NMDP      ZADIG
112900200529     C                     Z-ADDNMDP      ZADEC
113000200529     C                     EXSR ZALIGN
113100200529      *
113200200529     C           *IN99     IFEQ '1'                        B*4
113300200529     C                     MOVEL'CO00107' ZAMSID
113400200529     C                     EXSR ZASNMS
113500200529     C                     MOVE '1'       *IN22
113600200529     C                     MOVE 'Y'       ERROR
113700200529     C                     ENDIF                           E*4
113800200529      *
113900200529     C                     ENDIF                           E*3
114000200529      *
114100200529     C                     ENDIF                           E*2
114200200529      *
114300200529      **  Validate Dividend Right
114400200529      *
114500200529     C           SDVRA     IFNE *BLANKS                    B*2
114600200529      *
114700200529     C           SSECA     IFEQ *BLANKS                    B*3
114800200529     C                     MOVEL'CO00135' ZAMSID
114900200529     C                     EXSR ZASNMS
115000200529     C                     MOVE '1'       *IN20
115100200529     C                     MOVE 'Y'       ERROR
115200200529     C                     ELSE                            X*3
115300200529     C                     MOVE SDVRA     ZDATE
115400200529     C                     EXSR ZDATE1
115500200529      *
115600200529     C           *IN99     IFEQ '1'                        B*4
115700200529     C                     MOVEL'CO00070' ZAMSID
115800200529     C                     EXSR ZASNMS
115900200529     C                     MOVE '1'       *IN23
116000200529     C                     MOVE 'Y'       ERROR
116100200529     C                     ENDIF                           E*4
116200200529      *
116300200529     C                     ENDIF                           E*3
116400200529      *
116500200529     C                     ENDIF                           E*2
116600200529      *
116700200529      **  Validate Rounding Type (D/R)
116800200529      *
116900200529     C           SRNDA     IFEQ *BLANKS                    B*2
117000200529      *
117100200529     C           SSECA     IFNE *BLANKS
117200200529     C                     MOVE 'D'       SRNDA
117300200529     C                     ENDIF
117400200529      *
117500200529     C                     ELSE                            X*2
117600200529      *
117700200529     C           SRNDA     IFNE 'D'                        B*3
117800200529     C           SRNDA     ANDNE'R'
117900200529     C           SRNDA     ANDNE'U'
118000200529     C                     MOVEL'CO00074' ZAMSID
118100200529     C                     EXSR ZASNMS
118200200529     C                     MOVE '1'       *IN24
118300200529     C                     MOVE 'Y'       ERROR
118400200529     C                     ELSE                            X*3
118500200529      *
118600200529     C           SRNDA     IFEQ 'D'                        B*4
118700200529     C           SRNDA     OREQ 'R'
118800200529     C           SRNDA     OREQ 'U'
118900200529      *
119000200529     C           SSECA     IFEQ *BLANKS                    B*5
119100200529     C                     MOVEL'CO00135' ZAMSID
119200200529     C                     EXSR ZASNMS
119300200529     C                     MOVE '1'       *IN20
119400200529     C                     MOVE 'Y'       ERROR
119500200529     C                     ENDIF                           E*5
119600200529      *
119700200529     C                     ENDIF                           E*4
119800200529      *
119900200529     C                     ENDIF                           E*3
120000200529      *
120100200529     C                     ENDIF                           E*2
120200200529      *
120300200529      **  Validate Rounding In Cash (Y/N)
120400200529      *
120500200529     C           SRDSA     IFEQ *BLANKS                    B*2
120600200529      *
120700200529     C           SSECA     IFNE *BLANKS                    B*3
120800200529     C                     MOVE 'N'       SRDSA
120900200529     C                     ENDIF                           E*3
121000200529      *
121100200529     C                     ELSE                            X*2
121200200529      *
121300200529     C           SRDSA     IFNE 'Y'                        B*3
121400200529     C           SRDSA     ANDNE'N'
121500200529     C                     MOVEL'CO00075' ZAMSID
121600200529     C                     EXSR ZASNMS
121700200529     C                     MOVE '1'       *IN25
121800200529     C                     MOVE 'Y'       ERROR
121900200529      *
122000200529     C           SSECA     IFEQ *BLANKS                    B*4
122100200529     C           SRDSA     ANDEQ'Y'
122200200529     C           SSECA     OREQ *BLANKS
122300200529     C           SRDSA     ANDEQ'N'
122400200529     C                     MOVEL'CO00135' ZAMSID
122500200529     C                     EXSR ZASNMS
122600200529     C                     MOVE '1'       *IN20
122700200529     C                     MOVE 'Y'       ERROR
122800200529     C                     ENDIF                           E*4
122900200529      *
123000200529     C                     ENDIF                           E*3
123100200529      *
123200200529     C                     ENDIF                           E*2
123300200529      *
123400200529     C           SSECA     IFEQ *BLANKS                    B*2
123500200529     C           SRDSA     ANDNE*BLANKS
123600200529     C                     MOVEL'CO00135' ZAMSID
123700200529     C                     EXSR ZASNMS
123800200529     C                     MOVE '1'       *IN20
123900200529     C                     MOVE 'Y'       ERROR
124000200529     C                     ENDIF                           E*2
124100200529      *
124200200529      **  Validate Compensation Price
124300200529      *
124400200529     C           SRDSA     IFEQ 'N'                        B*2
124500200529     C           SCOPA     ANDNE*BLANKS
124600200529     C           SRDSA     OREQ 'Y'
124700200529     C           SCOPA     ANDEQ*BLANKS
124800200529     C                     MOVEL'CO00067' ZAMSID
124900200529     C                     EXSR ZASNMS
125000200529     C                     MOVE '1'       *IN26
125100200529     C                     MOVE 'Y'       ERROR
125200200529      *
125300200529     C                     ELSE                            X*2
125400200529     C           SCOPA     IFNE *BLANKS                    B*3
125500200529      *
125600200529     C           SSECA     IFEQ *BLANKS                    B*4
125700200529     C                     MOVEL'CO00135' ZAMSID
125800200529     C                     EXSR ZASNMS
125900200529     C                     MOVE '1'       *IN20
126000200529     C                     MOVE 'Y'       ERROR
126100200529     C                     ELSE                            X*4
126200200529     C                     MOVE *BLANKS   ZFIELD
126300200529     C                     MOVE SCOPA     ZFIELD
126400200529     C                     Z-ADD7         ZADIG
126500200529     C                     Z-ADD8         ZADEC
126600200529     C                     EXSR ZALIGN
126700200529      *
126800200529     C           *IN99     IFEQ '1'                        B*5
126900200529     C                     MOVEL'CO00108' ZAMSID
127000200529     C                     EXSR ZASNMS
127100200529     C                     MOVE '1'       *IN26
127200200529     C                     MOVE 'Y'       ERROR
127300200529     C                     ENDIF                           E*5
127400200529      *
127500200529     C                     ENDIF                           E*4
127600200529      *
127700200529     C                     ENDIF                           E*3
127800200529      *
127900200529     C                     ENDIF                           E*2
128000200529      *
128100200529      **  Validate Market Price
128200200529      *
128300200529     C           SMKTP     IFNE *BLANKS                    B*2
128400200529      *
128500200529     C           SSECA     IFEQ *BLANKS                    B*3
128600200529     C                     MOVEL'CO00135' ZAMSID
128700200529     C                     EXSR ZASNMS
128800200529     C                     MOVE '1'       *IN20
128900200529     C                     MOVE 'Y'       ERROR
129000200529     C                     ELSE                            X*3
129100200529     C                     MOVE *BLANKS   ZFIELD
129200200529     C                     MOVE SMKTP     ZFIELD
129300200529     C                     Z-ADD7         ZADIG
129400200529     C                     Z-ADD8         ZADEC
129500200529     C                     EXSR ZALIGN
129600200529      *
129700200529     C           *IN99     IFEQ '1'                        B*4
129800200529     C                     MOVEL'CO00252' ZAMSID
129900200529     C                     EXSR ZASNMS
130000200529     C                     MOVE '1'       *IN31
130100200529     C                     MOVE 'Y'       ERROR
130200200529     C                     ENDIF                           E*4
130300200529      *                                                                   161729
130400200529     C           SSECA     IFNE AR1,#1RRN                  B*4            161729
130500200529     C                     MOVE SSECA     KSECN                           161729
130600200529     C                     MOVE PCOEX     KEXDT                           161729
130700200529      *                                                                   161729
130800200529     C                     EXSR SRPRIC                                    161729
130900200529      *                                                                   161729
131000200529     C                     MOVELOMKTP     SMKTP                           161729
131100200529     C                     ENDIF                           E*4            161729
131200200529      *
131300200529     C                     ENDIF                           E*3
131400200529      *                                                                   161729
131500200529      * If Market Price not entered, default it.                          161729
131600200529     C                     ELSE                            X*2            161729
131700200529      *                                                                   161729
131800200529     C                     MOVE SSECA     KSECN                           161729
131900200529     C                     MOVE PCOEX     KEXDT                           161729
132000200529      *                                                                   161729
132100200529     C                     EXSR SRPRIC                                    161729
132200200529      *                                                                   161729
132300200529     C                     MOVELOMKTP     SMKTP                           161729
132400200529      *
132500200529     C                     ENDIF                           E*2
132600200529      *
132700200529     C                     UPDATSE7507S1
132800200529      *
132900200529     C                     MOVEA'0000000' *IN,20
133000200529     C                     MOVE '0'       *IN,31
133100200529     C                     MOVE #1RRN     K       20
133200200529      *
133300200529     C                     MOVE SSECA     AR1,K
133400200529      *
133500200529     C           SSECA     CHAINSECTYZ1              89
133600200529      *
133700200529     C                     MOVE *BLANKS   ZFIELD
133800200529     C                     MOVELSNSHA     ZFIELD
133900200529     C                     Z-ADD8         ZADIG
134000200529     C                     Z-ADD7         ZADEC
134100200529     C                     EXSR ZALIGN
134200200529     C                     MOVE ZFIELD    SNSHA
134300200529     C                     MOVE SNSHA     AR2,K
134400200529      *
134500200529     C                     MOVE *BLANKS   ZFIELD
134600200529     C                     MOVELSDMLA     ZFIELD
134700200529     C           15        SUB  NMDP      ZADIG
134800200529     C                     Z-ADDNMDP      ZADEC
134900200529     C                     EXSR ZALIGN
135000200529     C                     MOVE ZFIELD    SDMLA
135100200529     C                     MOVE SDMLA     AR3,K
135200200529      *
135300200529     C                     MOVE SDVRA     ZDATE
135400200529     C                     EXSR ZDATE1
135500200529     C                     Z-ADDZDAYNO    SDVRA1
135600200529     C                     MOVE SDVRA1    SDVRA
135700200529     C                     MOVE SDVRA     AR4,K
135800200529      *
135900200529     C                     MOVE SRNDA     AR5,K
136000200529     C                     MOVE SRDSA     AR6,K
136100200529      *
136200200529     C                     MOVE *BLANKS   ZFIELD
136300200529     C                     MOVELSCOPA     ZFIELD
136400200529     C                     Z-ADD7         ZADIG
136500200529     C                     Z-ADD8         ZADEC
136600200529     C                     EXSR ZALIGN
136700200529     C                     MOVE ZFIELD    SCOPA
136800200529     C                     MOVE SCOPA     AR7,K
136900200529      *
137000200529     C                     MOVE *BLANKS   ZFIELD
137100200529     C                     MOVELSMKTP     ZFIELD
137200200529     C                     Z-ADD7         ZADIG
137300200529     C                     Z-ADD8         ZADEC
137400200529     C                     EXSR ZALIGN
137500200529     C                     MOVE ZFIELD    SMKTP
137600200529     C                     MOVE SMKTP     AR8,K
137700200529      *
137800200529     C                     READCSE7507S1                 77
137900200529      *
138000200529     C                     ENDDO                           E*1
138100200529      *
138200200529     C                     MOVE W1RRN     #1RRN
138300200529      *
138400200529     C                     ENDSR
138500200529      ********************************************************************
138600200529      /EJECT
138700200529      *****************************************************************
138800200529      *                                                               *
138900200529      *            SRSAVE - Save                                      *
139000200529      *                                                               *
139100200529      * CALLS             -                                           *
139200200529      *                                                               *
139300200529      * CALLED BY         -                                           *
139400200529      *                                                               *
139500200529      * FLDS USED         -                                           *
139600200529      *                                                               *
139700200529      *****************************************************************
139800200529     C           SRSAVE    BEGSR
139900200529      *
140000200529     C           KEY1      CHAINSECOCRD0             77
140100200529     C           *IN75     IFEQ '0'
140200200529     C                     MOVE 'A'       MHCHTP
140300200529     C                     ELSE
140400200529     C                     MOVE 'I'       MHCHTP
140500200529     C                     ENDIF
140600200529      *
140700200529     C                     MOVE 'D'       MHRECI
140800200529     C                     Z-ADDBJRDNB    MHLCD
140900200529     C                     MOVE ##USR     MHLUID
141000200529     C                     MOVE SCORF     MHCORF
141100200529     C                     MOVE SOPNB     MHOPTN
141200200529      *
141300200529     C                     MOVE *BLANKS   ZFIELD
141400200529     C                     MOVELSOSH1     ZFIELD
141500200529     C                     Z-ADD8         ZADIG
141600200529     C                     Z-ADD7         ZADEC
141700200529     C                     EXSR ZALIGN
141800200529     C                     MOVE ZFIELD    MHOSHA
141900200529      *
142000200529     C                     MOVE SADRE     MHADRE
142100200529      *
142200200529     C                     MOVE *BLANKS   ZFLD17
142300200529     C                     MOVELSCAPA     ZFLD17
142400200529     C*****      15        SUB  WNMDP     ZSDIG                           155622
142500200529     C*****                Z-ADDWNMDP     ZSDEC                           155622
142600200529     C           15        SUB  7         ZSDIG                           155622
142700200529     C                     Z-ADD7         ZSDEC                           155622
142800200529     C                     EXSR ZASIGN
142900200529     C                     MOVE ZOUT15    WOUT15 150
143000200529      *
143100200529     C           ZFSIGN    IFEQ '+'                        B*1
143200200529     C                     Z-ADDWOUT15    MHCAPA
143300200529     C                     ELSE                            X*1
143400200529     C                     Z-SUBWOUT15    MHCAPA
143500200529     C                     ENDIF                           E*1
143600200529      *
143700200529     C                     MOVE STXT1     MHTXT1
143800200529     C                     MOVE STXT2     MHTXT2
143900200529     C                     MOVE STXT3     MHTXT3
144000200529     C                     MOVE STXT4     MHTXT4
144100200529     C                     MOVE SOPSH     MHOPSH
144200200529      *
144300200529     C           SOPSH     IFEQ *BLANKS                    B*1
144400200529     C                     MOVELNARR,2    WWOPSH 26
144500200529     C                     MOVE SOPNB     WWOPSH
144600200529     C                     MOVELWWOPSH    MHOPSH
144700200529     C                     ELSE                            X*1
144800200529     C                     MOVE SOPSH     MHOPSH
144900200529     C                     ENDIF                           E*1
145000200529      *
145100200529     C                     MOVEAAR1       MHSECA
145200200529     C                     MOVEAAR2       MHNSHA
145300200529     C                     MOVEAAR3       MHDMLA
145400200529     C                     MOVEAAR4       MHDVRA
145500200529     C                     MOVEAAR5       MHRNDN
145600200529     C                     MOVEAAR6       MHRNDS
145700200529     C                     MOVEAAR7       MHCOPA
145800200529     C                     MOVEAAR8       MHMKTP
145900200529      *
146000200529     C           *IN77     IFEQ '0'
146100200529     C                     UPDATSECOCRD0
146200200529     C                     MOVE 'U'       PRTCD
146300200529     C                     ELSE
146400200529     C                     WRITESECOCRD0
146500200529     C                     MOVE 'W'       PRTCD
146600200529      *
146700200529      **   Access ER Reference file
146800200529      *
146900200529     C           PCORF     CHAINSECORFL0             89
147000200529      *
147100200529     C           *IN89     IFEQ '1'                        B*2
147200200529     C           *LOCK     IN   LDA
147300200529     C                     Z-ADD7         DBASE
147400200529     C                     MOVE 'SECORFL0'DBFILE
147500200529     C                     MOVELPCORF     DBKEY
147600200529     C                     OUT  LDA
147700200529     C                     EXSR *PSSR
147800200529     C                     ENDIF                           E*2
147900200529      *
148000200529     C                     MOVE 'D'       MARECI
148100200529     C                     Z-ADDBJRDNB    MALCD
148200200529     C                     MOVE 'A'       MACHTP
148300200529     C                     MOVE ##USR     MALUID
148400200529     C                     ADD  1         MANBOP
148500200529     C                     UPDATSECORFD0
148600200529     C                     ENDIF
148700200529      *
148800200529     C                     COMIT
148900200529      *
149000200529     C                     ENDSR
149100200529      *****************************************************************
149200200529      /EJECT
149300200529     C*****************************************************************   161729
149400200529     C*                                                               *   161729
149500200529     C*            SRPRIC - Retrieve price for a security/date        *   161729
149600200529     C*                     ( actual or first date after )            *   161729
149700200529     C*                     and give it reday for display.            *   161729
149800200529     C*                     ( partly taken from SE7502 )              *   161729
149900200529     C* CALLS             - ZSEDIT                                    *   161729
150000200529     C*                                                               *   161729
150100200529     C* CALLED BY         - SRVALD                                    *   161729
150200200529     C*                                                               *   161729
150300200529     C* FLDS USED  Input  - KSECN  Security name                      *   161729
150400200529     C*                     KEXDT  Price Value date                   *   161729
150500200529     C*            Output   OMKTP                                     *   161729
150600200529     C*****************************************************************   161729
150700200529     C           SRPRIC    BEGSR                                          161729
150800200529     C*                                                                   161729
150900200529     C           KEY5      KLIST                                          161729
151000200529     C                     KFLD           KSECN  10                       161729
151100200529     C                     KFLD           KEXDT   50                      161729
151200200529     C                     KFLD           KTYPE   2                       161729
151300200529      *                                                                   161729
151400200529     C           KEY7      KLIST                                          161729
151500200529     C                     KFLD           KSECN                           161729
151600200529     C                     KFLD           KEXDT                           161729
151700200529      *                                                                   161729
151800200529     C           KEY7      SETLLPRICM                                     161729
151900200619     C                     READEPRICM                    89                            161729
152100200529      *                                                                   161729
152200200529     C           *IN89     IFEQ '0'                                       161729
152300200529     C           PSSN      ANDEQKSECN                                     161729
152400200529     C           PVDT      ANDGEKEXDT                                     161729
152500200529     C           KEXDT     ANDNE*ZEROS                                    161729
152600200529     C                     Z-ADDPPRC      WMKTPC 158                      161729
152700200529     C                     MOVE WMKTPC    SMKTP                           161729
152800200529     C*                                                                   161729
152900200529     C                     ELSE                                           161729
153000200529     C*                                                                   161729
153100200529     C                     MOVE 'PR'      KTYPE                           161729
153200200529     C*                                                                   161729
153300200529     C           KEY5      SETLLSECED                                     161729
153400200619     C                     READESECED                    89                            161729
153600200529     C*                                                                   161729
153700200529     C           *IN89     IFEQ '0'                                       161729
153800200529     C           SNSN      ANDEQKSECN                                     161729
153900200529     C           SNDT      ANDGEKEXDT                                     161729
154000200529     C           SNET      ANDEQ'PR'                                      161729
154100200529     C           KEXDT     ANDNE*ZEROS                                    161729
154200200529     C                     Z-ADDSNPR      WMKTPC                          161729
154300200529     C                     MOVE WMKTPC    SMKTP                           161729
154400200529     C                     ELSE                                           161729
154500200529     C           KSECN     CHAINSECTYZ1              89                   161729
154600200529     C           *IN89     IFEQ '0'                                       161729
154700200529     C                     Z-ADDMKPR      WMKTPC                          161729
154800200529     C                     MOVE WMKTPC    SMKTP                           161729
154900200529     C                     ELSE                                           161729
155000200529     C                     Z-ADD*ZEROS    WMKTPC                          161729
155100200529     C                     MOVE WMKTPC    SMKTP                           161729
155200200529     C                     END                                            161729
155300200529     C                     END                                            161729
155400200529     C                     END                                            161729
155500200529     C*                                                                   161729
155600200529     C                     MOVE *BLANKS   ZFLD15                          161729
155700200529     C                     MOVE WMKTPC    ZFLD15                          161729
155800200529     C                     Z-ADD8         ZDECS                           161729
155900200529     C                     MOVE 'L'       ZECODE                          161729
156000200529     C                     EXSR ZSEDIT                                    161729
156100200529     C                     MOVEL*BLANKS   SMKTP                           161729
156200200529     C                     MOVE ZOUT21    WFLD17                          161729
156300200529     C*                                                                   161729
156400200529     C                     MOVELWFLD17    OMKTP  17                       161729
156500200529     C*                                                                   161729
156600200529     C                     ENDSR                                          161729
156700200529      *****************************************************************   161729
156800200529     C/COPY WNCPYSRC,SE7507C021
156900200529      /EJECT
157000200529     C/COPY ZSRSRC,ZDATE1Z2
157100200529      *
157200200529      /EJECT
157300200529     C/COPY ZSRSRC,ZDATE2Z4
157400200529      *
157500200529      /EJECT
157600200529     C/COPY ZSRSRC,ZSEDITZ3
157700200529      *
157800200529      /EJECT
157900200529     C/COPY ZSRSRC,ZALIGNZ2
158000200529      /EJECT
158100200529     C/COPY ZSRSRC,ZASIGNZ2
158200200529      *
158300200529**  CPY@
158400200529(c) Finastra International Limited 2001
158500200529**  NARR
158600200529ERROR CALLING PGM 'SE0040'
158700200529OPTION SHORTNAME NUMBER
158800200529ERROR CALLING PGM 'SEC023'
158900200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
1590002005290366073110961461
159100200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
159200200529000031059090120151181212243273304334365
159300200529**   ZMNM - MONTHS SHORT NAMES
159400200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
159500200529**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
15960020052900000001
15970020052900000010
15980020052900000100
15990020052900001000
16000020052900010000
16010020052900100000
16020020052901000000
16030020052910000000
