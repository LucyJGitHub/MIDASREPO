/*******************************************************************************/
/*                                                                             */
/*       Midas - Global Processing Module                                      */
/*                                                                             */
/*       V_CLCTYCWO - COUNTRY WEIGHTING CODES (PLEDGE COLLATERAL)              */
/*                                                                             */
/*       (c) Finastra International Limited 2006                               */
/*                                                                             */
/*                                                                             */
/*       Last Amend No. CSD103             Date 10Aug20                        */
/*       Prev Amend No. MD046248           Date 27Oct17                        */
/*                      CGL132             Date 01May13                        */
/*                      CRE073             Date 06Dec10                        */
/*                      CER059             Date 19Jul10                        */
/*                      CER045             Date 20Jul09                        */
/*                      CER020             Date 19May08                        */
/* Bank Fusion Midas 1.4 Base -------------------------------------------------*/
/* Midas Plus 1.4 Base 04 -----------------------------------------------------*/
/*                      CRE026             Date 24May06                        */
/* Midas Plus 1.3 ---------------- Base ---------------------------------------*/
/*                      241629             Date 15Aug06                        */
/*                      CSD031             Date 10Apr06                        */
/*                      CSD027A            Date 08May06                        */
/*                      BUG4721  *CREATE   Date 06AprIL0                       */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CSD103 - LIBOR Deregulation - Common Layer/Standing Data (Recompile)  */
/*       MD046248 - Finastra Rebranding                                        */
/*       CGL132 - FATCA Phase 1 - Customers' Identification and                */
/*                Classification - Master (Recompile)                          */
/*       CRE073 - Interest Rate Rounding (Recompile)                           */
/*       CER059 - German Feature Upgrade to Delhi                              */
/*       CER045 - German Features - Reporting Bundesbank                       */
/*                (Recompile)                                                  */
/*       CER020 - Enhanced Rollover Window: Upgrade FGE089 to                  */
/*                Midas Plus (Recompile)                                       */
/*       CRE026 - Consumer Banking (Recompile)                                 */
/*       241629 - Valuation amount & lending value were not calculated         */
/*                (Recompile)                                                  */
/*       CSD031 - Enhanced Centralised Static Data (Recompile)                 */
/*       CSD027A - Conversion Of Customer Number to Alpha                      */
/*       BUG4721 - SQL0204 V_CLINSCWO IN *LIBL TYPE *FILE NOT FOUND UPON       */
/*                 INSERT OF A PLEDGE COLLATERAL                               */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  (                                                                             :
  WOZONE ,                                                                      :
  WOCNUM ,                                                                      :
  WOPTFR ,                                                                      :
  WOCNCD ,                                                                      :
  WOWEIG ,                                                                      :
  PDPERC ,                                                                      :
  PDCUML ,                                                                      :
  PRIORITY )                                                                    :
  AS                                                                            :
  SELECT                                                                        :
   WOZONE                                                                       :
  ,WOCNUM                                                                       :
  ,WOPTFR                                                                       :
  ,WOCNCD                                                                       :
  ,WOWEIG                                                                       :
  ,PDPERC                                                                       :
  ,PDCUML                                                                       :
  ,PRIORITY                                                                     :
  FROM (                                                                        :
   SELECT                                                                       :
    WOZONE                                                                      :
   ,WOCNUM                                                                      :
   ,WOPTFR                                                                      :
   ,WOCNCD                                                                      :
   ,WOWEIG                                                                      :
***,CASE**WHEN*WOCNUM*<>*0                                                      :CSD027A
   ,CASE WHEN TRIM(WOCNUM) <> ''                                                :CSD027A
     AND TRIM(WOPTFR) <> ''                                                     :
     AND TRIM(WOCNCD) <> ''                                                     :
     AND TRIM(WOSESN)  = ''                                                     :
     AND TRIM(WOCYCD)  = '' THEN 1                                              :
******WHEN*****WOCNUM*<>*0                                                      :CSD027A
      WHEN TRIM(WOCNUM) <> ''                                                   :CSD027A
     AND TRIM(WOPTFR) <> ''                                                     :
     AND TRIM(WOCNCD)  = ''                                                     :
     AND TRIM(WOSESN)  = ''                                                     :
     AND TRIM(WOCYCD)  = '' THEN 2                                              :
****WHEN*******WOCNUM*<>*0                                                      :CSD027A
    WHEN TRIM(WOCNUM) <> ''                                                     :CSD027A
     AND TRIM(WOPTFR)  = ''                                                     :
     AND TRIM(WOCNCD) <> ''                                                     :
     AND TRIM(WOSESN)  = ''                                                     :
     AND TRIM(WOCYCD)  = '' THEN 3                                              :
****WHEN*******WOCNUM*<>*0                                                      :CSD027A
    WHEN TRIM(WOCNUM) <> ''                                                     :CSD027A
     AND TRIM(WOPTFR)  = ''                                                     :
     AND TRIM(WOCNCD)  = ''                                                     :
     AND TRIM(WOSESN)  = ''                                                     :
     AND TRIM(WOCYCD)  = '' THEN 4                                              :
    ELSE 0 END AS PRIORITY                                                      :
    FROM GZSDCUWOPD                                                             :
    UNION                                                                       :
    SELECT                                                                      :
     T_ZONE AS WOZONE                                                           :
****,0******AS*WOCNUM                                                           :CSD027A
    ,''     AS WOCNUM                                                           :CSD027A
    ,''     AS WOPTFR                                                           :
    ,SCOR   AS WOCNCD                                                           :
    ,A4CTWC AS WOWEIG                                                           :
    ,5      AS PRIORITY                                                         :
    FROM                                                                        :
      GPTRAPPD                                                                  :
     ,	                                                                  :
     ,GZSDCTRYPD                                                                :
    WHERE                                                                       :
          T_MOD = 'SE'                                                          :
     AND T_SMOD = 'SCPS'                                                        :
     AND T_SESN = SESN                                                          :
     AND T_ZONE = SEZONE                                                        :
     AND SCOR   = A4CNCD                                                        :
     AND SEZONE = A4ZONE ) AS CTRY                                              :
    ,GPWEIGPD                                                                   :
    WHERE                                                                       :
         CTRY.PRIORITY <> 0                                                     :
     AND CTRY.WOWEIG = PDWEIG ;                                                 :
                                                                                :
 LABEL ON COLUMN                                                                :
  **********/**********                                                         :
 ( WOZONE IS 'ZONE' ,                                                           :
  WOCNUM IS 'CUSTOMER            NUMBER' ,                                      :
  WOPTFR IS 'FOLIO               REF' ,                                         :
  WOCNCD IS 'CTRY                CODE' ,                                        :
  WOWEIG IS 'WEIGHTING           CODE' ,                                        :
  PDPERC IS 'PERCENTAGE' ,                                                      :
  PDCUML IS 'CUMULATIVE          PERCENTAGE' ) ;                                :
                                                                                :
 LABEL ON COLUMN                                                                :
  **********/**********                                                         :
 ( WOZONE TEXT IS 'ZONE' ,                                                      :
  WOCNUM TEXT IS 'CUSTOMER NUMBER' ,                                            :
  WOPTFR TEXT IS 'PORTFOLIO REFERENCE' ,                                        :
  WOCNCD TEXT IS 'COUNTRY CODE' ,                                               :
  WOWEIG TEXT IS 'WEIGHTING CODE' ,                                             :
  PDPERC TEXT IS 'PERCENTAGE' ,                                                 :
  PDCUML TEXT IS 'CUMULATIVE PERCENTAGE' ) ;                                    :
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Country Weighting Codes (Pledge Collateral)       ';                     :
                                                                                :
