     H DEBUG
     H COPYRIGHT('(c) Misys International Banking Systems Ltd. 2003')
      *****************************************************************
/*S*D****RPGBASEBND****************************************************
      *****************************************************************
      *                                                               *
      *  Midas - Security Profile Facility                            *
      *                                                               *
      *  SF000020 - Midas Users Maintenance                           *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. AR904191*REDUNDANT Date 01Feb12               *
      *  Prev Amend No. AR787620           Date 10Jun11               *
      *                 BUG28159           Date 02Oct10               *
      *                 BUG27952           Date 10Aug10               *
      *                 BUG27503           Date 20May10               *
      *                 BUG27689           Date 19May10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG27504           Date 21Apr10               *
      *                 CSD086             Date 17Mar10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 249757             Date 16Aug07               *
      *                 245075             Date 19Feb07               *
      *                 CRE026             Date 24May06               *
      *                 BUG12414A (Reopen) Date 28Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242254             Date 17Oct06               *
      *                 241801             Date 28Aug06               *
      *                 BUG12414           Date 15Nov06
      *                 240985             Date 13Jul06               *
      *                 239297             Date 08May06               *
      *                 CSD027             Date 09Dec05               *
      *                 239898             Date 29May06               *
      *                 BUG10744A (Reopen) Date 23May06               *
      *                 BUG8574            Date 07Oct05               *
      *                 BUG8091            Date 23Aug05               *
      *                 CGP009             Date 22Dec04               *
      *                 BUG2975            Date 28May04               *
      *                 BUG2844            Date 27May04               *
      *                 BUG2711            Date 26May04               *
      *                 BUG2597            Date 18May04               *
      *                 TDA035             Date 31Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSF002             Date 11Aug03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSC011             Date 27May02               *
      *                 193238             Date 22Jan02               *
      *                 195620             Date 20Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CPK014             Date 25Oct01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 178837             Date 23Jan01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL008             Date 01Mar99               *
      *                 098659             Date 26Feb97               *
      *                 105961             Date 17Jul96               *
      *                 071482             Date 03May94               *
      *                 S01408             Date 22Apr96               *
      *                 S01408             Date 20Feb96               *
      *                 097440             Date 22Jan96               *
      *                 087813             Date 11Oct95               *
      *                 092825             Date 12Sep95               *
      *                 077531             Date 14Nov94               *
      *                 CAAA01             Date 24Mar95               *
      *                 085650             Date 02May95               *
      *                 077951             Date 03Apr95               *
      *                 S01408             Date 06Mar95               *
      *                 083547             Date 20Feb95               *
      *                 080082             Date 16Dec94               *
      *                 079476             Date 13Dec94               *
      *                 S01496             Date 23Aug94               *
      *                 S01486             Date 08Jun94               *
      *                 067985             Date 15Jun94               *
      *                 S01408             Date 17May94               *
      *                 060154             Date 04Feb94               *
      *                 060733             Date 27Oct93               *
      *                 S01407             Date 26Jan93               *
      *                 S01117             Date 14Feb92               *
      *                 S01319             Date  5Sep91               *
      *                 S01269             Date 26Jun91               *
      *                 RT0148             Date 16Jun91               *
      *                 RT0099             Date 15May91               *
      *                 LN1187             Date 05Mar91               *
      *                 S01253             Date 01Mar91               *
      *                 S01199             Date 18Sep89               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR904191 - Replaced as per BF requirement (CBF005)           *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,SFH00095                                 *
      *             WNCPYSRC,SFH00096                                 *
      *             WNCPYSRC,SFH00097                                 *
      *             WNCPYSRC,SFH00098                                 *
      *             WNCPYSRC,SFH00099                                 *
      *             WNCPYSRC,SFH00100                                 *
      *             WNCPYSRC,SFH00101                                 *
      *             WNCPYSRC,SFH00102                                 *
      *             WNCPYSRC,SFH00103                                 *
      *             WNCPYSRC,SFH00104                                 *
      *             WNCPYSRC,SFH00105                                 *
      *             WNCPYSRC,SFH00106                                 *
      *             WNCPYSRC,SFH00107                                 *
      *             WNCPYSRC,SFH00108                                 *
      *             WNCPYSRC,SFH00109                                 *
      *             WNCPYSRC,SFH00110                                 *
      *             WNCPYSRC,SFH00111                                 *
      *             WNCPYSRC,SFH00112                                 *
      *             WNCPYSRC,SFH00113                                 *
      *             WNCPYSRC,SFH00114                                 *
      *             WNCPYSRC,SFH00115                                 *
      *             WNCPYSRC,SFH00116                                 *
      *             WNCPYSRC,SFH00117                                 *
      *             WNCPYSRC,SFH00118                                 *
      *             WNCPYSRC,SFH00119                                 *
      *             WNCPYSRC,SFH00120                                 *
      *             WNCPYSRC,SFH00121                                 *
      *             WNCPYSRC,SFH00122                                 *
      *             WNCPYSRC,SFH00123                                 *
      *             WNCPYSRC,SFH00124                                 *
      *             WNCPYSRC,SFH00125                                 *
      *             WNCPYSRC,SFH00126                                 *
      *             WNCPYSRC,SFH00127                                 *
      *             WNCPYSRC,SFH00128                                 *
      *             WNCPYSRC,SFH00129                                 *
      *             WNCPYSRC,SFH00130                                 *
      *             WNCPYSRC,SFH00131                                 *
      *             WNCPYSRC,SFH00132                                 *
      *             WNCPYSRC,SFH00133                                 *
      *             WNCPYSRC,SFH00134                                 *
      *             WNCPYSRC,SFH00135                                 *
      *             WNCPYSRC,SFH00136                                 *
      *             WNCPYSRC,SFH00137                                 *
      *             WNCPYSRC,SFH00138                                 *
      *             WNCPYSRC,SFH00139                                 *
      *             WNCPYSRC,SFH00140                                 *
      *             WNCPYSRC,SFH00141                                 *
      *             WNCPYSRC,SFH00142                                 *
      *  BUG28159 - Allow mixed case input in overridable             *
      *             profile (Recompile)                               *
      *  BUG27952 - Cannot authorize user in Midas Users Maintenance  *
      *  BUG27503 - Overridable profile is not protected on enquire   *
      *             (Recompile)                                       *
      *  BUG27689 - Overridable profiles screen goes back to initial  *
      *             screen                                            *
      *  BUG27504 - Prevent GP000025S from locking LDA. Also pass     *
      *             the zone as parameters for GP000025S              *
      *  CSD086 - Overridable Errors                                  *
      *  249757 - Revalidate field employee number only on change of  *
      *           value during Amend or during Insert.                *
      *  245075 - Some fields not updated due to CHAIN to MUSERDD     *
      *           after call to SFC000029.                            *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  BUG12414A- Add COMMIT to avoid ENDCMTCTL error. (Reopen)     *
      *  242254 - Commit Delete action.                               *
      *  241801 - Commit changes when for other options when Action   *
      *           codes are not amended                               *
      *  BUG12414 - Error ENDCMTCTL requested with changes pending    *
      *           occured when amending a user profile in one zone    *
      *           then change to another zone.
      *  240985 - Database error 101 in file SFMNUIPD, within program *
      *           SF000020. Passed the value of the user's security   *
      *           level to SFC000030 -> SF000030.                     *
      *  239297 - Display the 'Teller ID' field only when the CRT001  *
      *           feature is switched on.                             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  239898 - Applied core fix BUG11032.                          *
      *  BUG10744A - Files for update should be for commitment to     *
      *              avoid locking in User Maintenance. (Reopen)      *
      *  BUG11032 - Reporting About Users; also 239898 and 235634.    *
      *  BUG8574 - Added Teller/Batch Controls validation (Teller/    *
      *            Batch Control must exist in TTRNTM2 file)          *
      *  BUG8091 - Remove(comment) Embedded Blank checking for        *
      *            Department Code                                    *
      *  CGP009 - Local Zone Time Difference (Recompile)              *
      *  BUG2975 - Security Profile Facility changes for MidasPlus    *
      *  BUG2844- Account officer field should not be shown when text *
      *           is not displayed. Recompile.                        *
      *  BUG2711 - Security Profile Facility changes for MidasPlus    *
      *  BUG2597 - Wrong parameter for ZALIGN. Change the parameter   *
      *            such that it corresponds to PGM version of ZALIGN  *
      *            and not the module version of ZALIGN.              *
      *  TDA035 - Added Teller ID.                                    *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSF002 - Global Processing                                   *
      *           SF0020 has been converted to ILE and renamed.       *
      *           Commented out program codes have been stripped out  *
      *           for clarity.                                        *
      *  CSC011 - 24x7 Availability:                                  *
      *           - Add maintenance of COBAUT field.                  *
      *  193238 - Deleting option like Booking Branches, or Companies *
      *           or Action Codes in Midas Users Maintenance screen   *
      *           changes Last Change Type of PF/MUSERDD to "D" which *
      *           cause the FCOOB.  Amend program such that Last      *
      *           Change Type will only be equal "A" when deleting    *
      *           mentioned options.                                  *
      *  195620 - Ensure *IN65 is reset before processing new user.   *
      *  CPK014 - Release 4 packaging.  SDUBUT* files redundant.      *
      *  178837 - AS/400 profiles such as 'OFF-SUP' cannot be entered *
      *           in AMUS. This prevents access to live system.       *
      *           Add character '-' to the table of valid codes.      *
      *  CGL008 - Security on Journal Entry Input                     *
      *  098659 - When another user tried to amend the user auth.     *
      *           through SPF, system returned error msg 'Unable to   *
      *           allocate a record in MUSER'.                        *
      *  105961 - Fix 067985 was inadvertently removed by S01486      *
      *           and fix 071482 was not complete.                    *
      *           Code changed to validate non-blank department codes *
      *           in all cases regardless of BGPFMG and BGLMCR.       *
      *  071482 - Remove code that stopped validation of department   *
      *           codes if setup not complete as this allowed ? to    *
      *           be accepted as a department code, causing strange   *
      *           occurances at signon of user.                       *
      *  S01408 - Core hooks SE0020CCP1 renamed to SF0020CCP1         *
      *                      SE0020CCP2 renamed to SF0020CCP2         *
      *                      SE0020CCP3 renamed to SF0020CCP3         *
      *                      SE0020CCP4 renamed to SF0020CCP4         *
      *                      SE0020CCP5 renamed to SF0020CCP5         *
      *                      SE0020CCP6 renamed to SF0020CCP6         *
      *  S01408 - Core hooks added - SF0020CCP1                       *
      *                            - SF0020CCP2                       *
      *                            - SF0020CCP3                       *
      *                            - SF0020CCP4                       *
      *                            - SF0020CCP5                       *
      *                            - SF0020CCP6                       *
      *  097440 - Warning given on minor error, but not allowed to    *
      *           override error                                      *
      *  087813 - The system only checks whether any action codes are *
      *           inserted for the user if F12 is pressed in the      *
      *           action codes maintenance screen.  However, if the   *
      *           user inserted action codes for the user, but pressed*
      *           F3 in that screen, no updating of field ACDS in     *
      *           PF/MUSERDD occurs and this caused error in SPF report
      *  092825 - Amend program tp process Gui User = 'E' in the      *
      *           same way as Gui User = 'Y'.                         *
      *  077531 - During insert, MUSER flags are incorrectly updated. *
      *  CAAA01 - GUI/400 Development,                                *
      *           - In screen for 'definition and menu items',        *
      *             Extra validation added to field 'initial menu'    *
      *             and validation processing for 3 new fields added. *
      *           - Add GUI user indicator to SF0024 call.            *
      *  085650 - Record is MUSER is locked even in Enquiry mode.     *
      *  077951 - Numeric is not supported by IBM                     *
      *  S01408 - Core hooks added - SF0020CBU1                       *
      *                            - SF0020CISN                       *
      *                            - SF0020CIS1                       *
      *                            - SF0020CIS2                       *
      *                            - SF0020CVSF                       *
      *                            - SF0020CVS1                       *
      *                            - SF0020CVS2                       *
      *                            - SF0020CCAU                       *
      *                            - SF0020CADU                       *
      *                            - SF0020CIS3                       *
      *  083547 - Correcting Account Officer name on MUSERDD          *
      *  080082 - Error codes for the 'limits' screen fields appear   *
      *           even if 'limits' screen fields are not displayed.   *
      *  079476 - Account Officer and Department fields not properly  *
      *           conditioned                                         *
      *  S01496 - Jyske Enhancements - Change format parameter from   *
      *           DSFDY to DSSDY for AOSTRDR0                         *
      *  S01486 - Add Account Officer for Private Banking             *
      *  067985 - Condition the calling of 'AODEPTR0' to SDPPT being  *
      *           non-blank to avoid the incorrect display of Error   *
      *           Message 029                                         *
      *  S01408 - Core hook SF0020EEPG added                          *
      *           Core hook SF0020IIPG added                          *
      *           Core hook SF0020CCPG added                          *
      *           Core hook SF0020CBUW added                          *
      *           Core hook SF0020CDAU added                          *
      *           Core hook SF0020CDBU added                          *
      *           Core hook SF0020OOPG added                          *
      *  060154 - File trailer MUSERZZ not updated correctly when a   *
      *           user is deleted and re-inserted on the same day.    *
      *  060733 - Deleting user causes DB Error in COB if he has made *
      *           any report requests                                 *
      *  S01407 - SWITCHABILITY ENHANCEMENTS                          *
      *  S01117 - FT RELEASE 10 MULTIBRANCHING CHANGES                *
      *           (OUTPUT QUEUE FOR CHEQUES ADDED)                    *
      *  S01319 - ADD REFRESH PERIOD FOR TREASURY MANAGEMENT          *
      *  S01269 - SE TRADE AUTHORISATION LIMITS ADDED                 *
      *  RT0148 - RECOMPILE OVER CHANGED LF/MITEM                     *
      *  RT0099 - MUSERZZ SHOULD BE UPDATED ON DELETION OF RECORDS    *
      *  LN1187 - IF F12 TAKEN FROM SF0024, *IN65 WAS NOT RESET TO 0  *
      *  S01253 - MULTILANGUAGE INCORPORATION (MODIFIED TO COMPLY     *
      *           WITH RELEASE 10 REQUIREMENTS)                       *
      *  S01199 -  HELP SYSTEM.                                       *
      *                                                               *
      *****************************************************************
     FSF000020DFCF   E             WORKSTN
     F***MUSER**   UF A E           K DISK                                                 BUG10744A
     FMUSER     UF A E           K DISK    COMMIT                                          BUG10744A
     F***MUSERZZ   UF A E             DISK                                                 BUG10744A
     FMUSERZZ   UF A E             DISK    COMMIT                                          BUG10744A
     FFCRREQL5  IF   E           K DISK
     FFCRREQLC  IF   E           K DISK
     F                                     RENAME(FCRREQD0:FCRREQDX)
     FFCPREQL4  IF   E           K DISK
     FFCPREQL5  IF   E           K DISK
     F                                     RENAME(FCPREQD0:FCPREQDX)
     FMUSERL1   IF   E           K DISK
     F                                     RENAME(MUSERDDF:MUSERD1)
     FMUSERL3   IF   E           K DISK                                                       TDA035
     F                                     RENAME(MUSERDDF:MUSERD3)                           TDA035
     F                                     PREFIX(U_)                                         TDA035
     FGPZONEL2  IF   E           K DISK
      *                                                                                     BUG11032
     FMUSERL4   IF   E           K DISK                                                     BUG11032
     F                                     RENAME(MUSERDDF:MUSERD4)                         BUG11032
     F                                     PREFIX(M_)                                       BUG11032
     F/COPY WNCPYSRC,SFH00095
      *****************************************************************
      *                                                               *
      *  Use of indicators.                                           *
      *                                                               *
      *    04         GPZONEL2 No Record Found Indicator              *
      *    05         COB user validation                             *
      *    06         Chain for LF/MUSERL1                            *
      *    07         Chain for LF/MUSERL1                            *
      *    08         Error in 'Access to all J. Entry account codes' *
      *    09         Error in 'Reference User'                       *
      *    10         Error in 'User batch authorisation level'       *
      *    11         Blanks in default branch SDBRN                  *
      *    12         Multiple branch report indicator is not Y or N  *
      *    13         Embedded blanks in output queue SOUTQ           *
      *    14         Default branch (SDBRN) has not been entered     *
      *    15         Default branch not valid                        *
      *    16         Embedded blanks in cheque output queue SCOUTQ   *
      *    19         HELP processing requested                       *
      *    20         First cycle indicator                           *
      *   N21         Initial screen processing                       *
      *    22         Account Officer Field in error                  *
      *    23         Action code is  -  'A' AMEND                    *
      *    24         Action code is  -  'D' DELETE                   *
      *    25         Action code is  -  'E' ENQUIRE                  *
      *    26         Action code is  -  'I' INSERT                   *
      *    27         Used for right adjust processing                *
      *    28         Display text if CGL008 is switched on           *
      *    29         Account Officer must be displayed               *
      *    30         Action Code Field in error                      *
      *    31         User Profile Field in error                     *
      *    32         Midas User Field in error                       *
      *    33         Security Level Field in error                   *
      *    35         Time Out Field in error                         *
      *    36         Bank level functions Field in error             *
      *    37         Blanks in department                            *
      *    38         Report output indicator is not Y or N           *
      *    39         Multiple users report indicator is not Y or N   *
      *    40         A blank exists in field SUSER                   *
      *    41         User defN + menu items   Field in error         *
      *    42         Multilanguage Field in error                    *
      *    43         Booking branches Field in error                 *
      *    44         Originating branches Field in error             *
      *    45         Companies Field in error                        *
      *    46         Action codes Field in error                     *
      *    47         Protect/Non disp. SE Entering & Authorising     *
      *               Limits                                          *
      *    48         Protect/Non display SE Approving limit          *
      *    49         A blank exists in output queue SOUTQ            *
      *    50         User defN + menu items Deletes all details (W01)*
      *    51         User defN + menu items   Mandatory for insert   *
      *    53         Booking branches Field in error                 *
      *    54         Originating branches Field in error             *
      *    55         Companies Field in error                        *
      *    56         Action codes Field in error                     *
      *    57         Payment Authorisation Entry Not Valid           *
      *    58         Special Authority required for Insert/Delete    *
      *    59         User can only change his own Directory entry    *
      *    60         Directory USRID/Address already allocated       *
      *    61         AS/400 User Profile must exist for directory    *
      *               Entry                                           *
      *    62         System Routing Officer not valid                *
      *    63         Auto-refresh for user Field in error            *
      *    64         Refresh period Field in error                   *
      *    65         MUSER - non-live record (RECIDD = C)            *
      *    66         FRA/IRS not present in system, so do not        *
      *               display auto-refresh options                    *
      *    67         Funds Transfer present in system, so            *
      *               display payment authorisation option            *
      *    68         Swift Direct Link present in system, so         *
      *               display System Routing Officer option           *
      *    69         Write fail indicator to PF/MUSERDD   OR         *
      *               unable to access PF/MUSERDD record after update *
      *    70         Multi-branch indicator = 'Y'                    *
      *    71         Originating branch indicator = 'Y'              *
      *    72         Entering Limit Field in error                   *
      *    73         Approving Limit Field in error                  *
      *    74         Authorising Limit Field in error                *
      *    75         A blank exists in output queue SCOUTQ           *
      *    76         Action code is  -  'R' Reactivate               *
      *    77         Error on Teller ID                              *                       TDA035
      *    78         No Teller ID found in MUSERDD                   *                       TDA035
      *    79         Error indicator            }  .: IF 80N79       *
      *    80         Errors present from validn.}  -> WARNING        *
      *    81         Errors present from initial screen validation,  *
      *               but non-display error code/msg array.           *
      *    85         Chain fail PF/MUSERZZ                           *
      *    82         Display 'Teller ID' field when CRT001 feature   *                       239297
      *               is switched on                                  *                       239297
      *    86         LF/MUSER  Record found but locked by another    *
      *               workstation                                     *
      *    88         Chain fail LF/MUSER                             *
      * U7+U8         Database Errors                                 *
      *                                                               *
      *****************************************************************
 
      ** Parameters for ZSEDIT
     D PFld15          S             15  0
     D PDecs           S              1  0
     D PECode          S              1
     D POut21          S             21
 
      ** Parameters for ZALIGN
     D*PZAlignOk***    S              1                                                      BUG2597
     D PZRTN           S              7                                                      BUG2597
     D PZFIELD         S             16
     D PZADEC          S              1  0
     D PZADIG          S              2  0
     D PZAFLD          S             16                                                      BUG2597
                                                                                             BUG2711
      ** Parameters for SFC000030                                                            BUG2711
     D PRtCd           S              7A                                                     BUG2711
     D PUser           S             12A                                                     BUG2711
                                                                                             BUG2975
      ** Parameters for AOGUSRR0                                                             BUG2975
     D PZone           S                   LIKE(SZONE)                                       BUG2975
     D PUsrp           S                   LIKE(SUSER)                                       BUG2975
 
     D*MSG******       S             78    DIM(17) CTDATA PERRCD(1)                           TDA035
     D*MSG******       S             78    DIM(19) CTDATA PERRCD(1)                   TDA035 BUG8574
     D*MSG******       S             78    DIM(20) CTDATA PERRCD(1)                 BUG8574 BUG11032
     D*MSG******       S             78    DIM(21) CTDATA PERRCD(1)                  BUG11032 CSD086
     D/COPY WNCPYSRC,SFH00096
     D MSG             S             78    DIM(22) CTDATA PERRCD(1)                           CSD086
     D/COPY WNCPYSRC,SFH00097
     D VALI            S              1    DIM(41) CTDATA PERRCD(41)
     D ERR             S              4    DIM(19)
     D CHK             S              1    DIM(10)
     D CHK1            S              1    DIM(3)
     D                 DS
      *
      ** Mandatory Details Screen' fields data structure.
      *
     D  SUSER                  1     10
     D  SMUSR                 11     35
     D  SSECL                 36     39
     D  SSECN                 36     39  0
     D  SGRP1                 40     43
     D  SGRP2                 45     48
     D  SGRP3                 50     53
     D  SGRP4                 55     58
     D  SGRP5                 60     63
     D  SGRP6                 65     68
     D  SGRP7                 70     73
     D  SGRP8                 75     78
     D  SGRP9                 80     83
     D  SGRP0                 85     88
     D  GROUP                 40     89
     D  STIMO                 90     94
     D  STIMN                 90     94  0
     D  SDPPT                 95     97
     D  SDBRN                 98    100
     D  SPAUT                101    101
     D  SROUF                102    102
     D  SROUT                103    103
     D  SDIRID               104    111
     D  SDIRAD               112    119
     D  SOUTQ                120    129
     D  SMUREP               130    130
     D  SMBREP               131    131
     D  SBANK                132    132
     D  SAURF                133    133
     D  SREFP                134    137
     D  MULTA                138    139
     D  SACOF                140    142
     D  WPCIU                143    143
     D  WACTIN               144    144
     D  WPCINM               145    152
     D  SDTA2                 11    152
     D  ENLIM                153    169
     D  APLIM                170    186
     D  AULIM                187    203
     D  SCOUTQ               204    213
     D  SCOBU                225    225
     D  STLID                226    228                                                       TDA035
     D  SEMPN                229    240                                                     BUG11032
     D  SOVPR                241    250                                                       CSD086
     D**SCNDTA**               1    225                                                       TDA035
     D**SCNDTA**               1    228                                              TDA035 BUG11032
     D**SCNDTA**               1    240                                              BUG11032 CSD086
     D  SCNDTA                 1    250                                                       CSD086
     D                 DS
     D*
     D** Data structure to enable right-justification of field
     D*
     D  @VAL                   1      4
     D  @POS1                  1      1
     D  @POS2                  2      2
     D  @POS3                  3      3
     D  @POS4                  4      4
     D  @FST2                  1      2
     D  @FST3                  1      3
     D  @LST3                  2      4
     D  @LST2                  3      4
     D*
     D                 DS
     D**
     D**    'Initial Screen Details Requested' data structure.
     D**
     D  SXXRQ                  1      6
     D  SUDRQ                  1      1
     D  SDARQ                  2      2
     D  SBBRQ                  3      3
     D  SBORQ                  4      4
     D  SCORQ                  5      5
     D  SACRQ                  6      6
     D                 DS
     D**
     D**    'Initial Screen Details Requested' data structure (STORED)
     D**
     D  CXXRQ                  1      6
     D  CYYRQ                  2      6
     D  CUDRQ                  1      1
     D  CDARQ                  2      2
     D  CBBRQ                  3      3
     D  CBORQ                  4      4
     D  CCORQ                  5      5
     D  CACRQ                  6      6
     D                 DS
     D**
     D**     File Input/Output fields data structure.
     D**INFELD**               1    225                                                       TDA035
     D**INFELD**               1    228                                              TDA035 BUG11032
     D**INFELD**               1    240                                              BUG11032 CSD086
     D  INFELD                 1    250                                                       CSD086
     D  USRP                   1     10
     D  USER1                 11     35
     D  SECL                  36     39  0
     D  GRPP                  40     89
     D  TIMO                  90     94  0
     D  DPPT                  95     97
     D  DBRN                  98    100
     D  PAUT                 101    101
     D  ROUF                 102    102
     D  ROUT                 103    103
     D  DIRID                104    111
     D  DIRAD                112    119
     D  OUTQ                 120    129
     D  MUREP                130    130
     D  MBREP                131    131
     D  BANK                 132    132
     D  AURF                 133    133
     D  REFP                 134    137  0
     D  MULT                 138    139
     D  ACFA                 140    142
     D  PCIU                 143    143
     D  ACTIN                144    144
     D  PCINM                145    152
     D  COBAUT               225    225
     D  TLID                 226    228                                                       TDA035
     D  EMPNO                229    240                                                     BUG11032
     D  OVPR                 241    250                                                       CSD086
     D**OUTFLD**               1    225                                                       TDA035
     D**OUTFLD**               1    228                                              TDA035 BUG11032
     D**OUTFLD**               1    240                                              BUG11032 CSD086
     D  OUTFLD                 1    250                                                       CSD086
     D**
     D PSDS           SDS
     D**
     D**     Program status data structure.
     D**
     D  WSID                 244    246
     D  WSID2                245    246
     D  SWSID                244    253
     D  USRID                254    263
     D*
     D LDA             DS           256
     D**
     D**     Local data area.
     D**
     D  DBFILE               134    141
     D  DBKEY                142    170
     D  DBPGM                171    180
     D  DBASE                181    183  0
     D**
     D**     RUNDAT data area.
     D**
     D RUNDAT          DS
     D  AGMRDT                 1      7
     D  AGRDNB                 8     10P 0
     D  AGSUC                 11     11
     D  AGDFF                 12     12
     D  AGMBIN                13     13
      *
     D SDSTAT          DS           256
     D  LIBR                   6      7
     D*
     D* DATA STRUCTURES FOR USE WITH ACCESS OBJECTS
     D*
     D SDGELR        E DS                  EXTNAME(SDGELRPD)
     D*
     D SDBANK        E DS                  EXTNAME(SDBANKPD)
     D*
     D SDBRCH        E DS                  EXTNAME(SDBRCHPD)
     D*
     D SDDEPT        E DS                  EXTNAME(SDDEPTPD)
     D*
     D SDACOF        E DS                  EXTNAME(SDACOFPD)
     D*
     D SDMMOD        E DS                  EXTNAME(SDMMODPD)
     D*
     D SDSTRD        E DS                  EXTNAME(SDSTRDPD)
     D*
     D SDCURR        E DS                  EXTNAME(SDCURRPD)
     D* CURRENCY DETAILS ACCESSED VIA ACCESS PROGRAM
     D SDLANG        E DS                  EXTNAME(SDLANGPD)
                                                                                            BUG11032
     D SCSARD        E DS                  EXTNAME(SCSARDPD)                                BUG11032
     D                                     PREFIX(S_)                                       BUG11032
      ** External DS for SAR details                                                        BUG11032
     D*
     D SDTELD        E DS                  EXTNAME(SDTELDPD)                                  TDA035
      ** Teller id                                                                            TDA035
                                                                                              TDA035
     D GZMUSER       E DS                  EXTNAME(GZMUSERDD) PREFIX(GZ)                     BUG2975
      ** Global User Profiles Data Structure                                                 BUG2975
                                                                                             BUG2975
     D TRNTM2        E DS                  EXTNAME(TTRNTM2) PREFIX(TR)                       BUG8574
      ** Teller/Batch Control                                                                BUG8574
                                                                                             BUG8574
     D DSFDY         E DS                  EXTNAME(DSFDY)
     D* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     D DSSDY         E DS                  EXTNAME(DSSDY)
      *                                                                                       CSD086
     D GPOVPR        E DS                  EXTNAME(GPOVPRPD)                                  CSD086
                                                                                            BUG27689
      ** Work variables                                                                     BUG27689
                                                                                            BUG27689
     D OVPRFlg         S              1                                                     BUG27689
     I*
     I/EJECT
     IMUSERDDF
     I**
     I**    User maintenance - detail
     I**
     I              RECI                        RECIDD
     IMUSERZZF
     I**
     I**    User maintenance - trailer
     I**
     I              RECI                        RECIZZ
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     I/COPY WNCPYSRC,SFH00098
     I/EJECT
      *
     C/SPACE 2
      ********************************************************************
      *                                                                  *
      *    THE PROGRAM WORKS OUT SIDE THE RPG CYCLE, PROCESSING THE      *
      *    SCREEN BY A LOOP. A FIRST CYCLE IS INCLUDED BUT ONLY          *
      *    SO THAT PROCESSING WHICH IS DONE ONCE MAY BE SIMPLY           *
      *    PERFORMED.                                                    *
      *                 *****************************                    *
      *                                                                  *
      *    'F I R S T    C Y C L E'    P R O C E S S I N G               *
      *                                                                  *
      ********************************************************************
     C     *IN20         IFEQ      '0'
      *
     C/COPY WNCPYSRC,SFH00099
     C                   MOVE      '1'           *IN20
      *
      **  GET LOCAL DATA AREA
      *
     C     *DTAARA       DEFINE                  LDA
     C     *LOCK         IN        LDA
      *
      **  GET RUNDAT
      *
     C     *DTAARA       DEFINE                  RUNDAT
     C                   IN        RUNDAT
     C                   UNLOCK    RUNDAT
      *
      **  GET SDSTAT
      *
     C     *DTAARA       DEFINE                  SDSTAT
     C                   IN        SDSTAT
     C                   UNLOCK    SDSTAT
      *
     C                   MOVEL     'SF000020'    DBPGM
      *
     C                   MOVE      'N'           UPDATE            1
      *
      ** OBTAIN RUN DATE AND MBIN FROM RUNDAT
      *
     C                   MOVE      AGMRDT        SRUNA
     C                   Z-ADD     AGRDNB        RUNDD             5 0
     C                   MOVE      AGMBIN        MBRIND            1
     C     AGMBIN        IFEQ      'Y'
     C                   SETON                                        70
     C                   END
      *
      ** Get the zone name.
      *
     C     LIBR          CHAIN     GPZONEL2                           04
     C     *IN04         IFEQ      *OFF
     C                   MOVE      ZOZONE        SZONE
     C                   ENDIF
      *
     C**********         CALL      'AOGELRR0'                                                 CGL029
     C                   CALL      'AOGELRR1'                                                 CGL029
     C                   PARM      '*DBERR  '    @RTCD             7
     C                   PARM      '*FIRST  '    @OPTN             7
     C*****SDGELR        PARM      SDGELR        DSFDY                                        CGL029
     C     SDGELR        PARM      SDGELR        DSSDY                                        CGL029
      *
     C                   CALL      'AOBANKR0'
     C                   PARM      '*DBERR  '    @RTCD
     C                   PARM      '*FIRST  '    @OPTN
     C     SDBANK        PARM      SDBANK        DSFDY
      *
     C                   MOVE      BKOBUV        OBRIND            1
     C     BKOBUV        IFEQ      'Y'
     C                   SETON                                        71
     C                   END
      *
     C                   CALL      'AOMMODR0'
     C                   PARM      '*DBERR  '    @RTCD
     C                   PARM      '*FIRST  '    @OPTN
     C     SDMMOD        PARM      SDMMOD        DSFDY
      *
      ** FRA/IRS present?
      ** or Treasury Management?
      *
     C     BGFIIN        IFEQ      'Y'
     C     BGTRMG        OREQ      'Y'
     C                   MOVE      'Y'           @PRES             1
     C                   MOVE      '1'           *IN66
     C                   ELSE
     C                   MOVE      'N'           @PRES
     C                   END
      *
      ** Funds Transfer ?
      *
     C     BGFDTR        IFEQ      'Y'
     C                   MOVE      '1'           *IN67
     C                   END
      *
      ** Check whether Account Officer must be displayed or not.
      *
     C     BGPFMG        IFEQ      'Y'
     C     BGLMCR        OREQ      'Y'
     C                   MOVE      '1'           *IN29
     C                   END
      *
      ** Swift Direct Link?
      *
     C     BGMSDL        IFEQ      'Y'
     C                   MOVE      '1'           *IN68
     C                   END
      *
     C                   Z-ADD     0             RTCDE             1 0
      *
      ** Securities Trading ?
      *
     C     BGSECS        IFEQ      'Y'
      *
     C                   CALL      'AOSTRDR0'
     C                   PARM      '*DBERR  '    @RTCD             7
     C                   PARM      '*FIRST  '    @OPTN             7
     C     SDSTRD        PARM      SDSTRD        DSSDY
      *
     C     BVAUTH        IFNE      '00'
      *
     C                   CALL      'AOCURRR0'
     C                   PARM      '*DBERR '     @RTCD             7
     C                   PARM      '*KEY   '     @OPTN             7
     C                   PARM      BJCYCD        @CURKY            3
     C     SDCURR        PARM      SDCURR        DSSDY
      *
     C     BVAUTH        IFEQ      '10'
     C     BVAUTH        OREQ      '15'
     C                   MOVE      '1'           *IN48
     C                   END
      *
     C                   ELSE
     C                   MOVE      '1'           *IN47
     C                   MOVE      '1'           *IN48
     C                   END
      *
     C                   ELSE
     C                   MOVE      '1'           *IN47
     C                   MOVE      '1'           *IN48
     C                   END
      *
      ** Obtain and save current user's security level
      *
     C     USRID         CHAIN     MUSER                              8889
     C     *IN88         IFEQ      '0'
     C     *IN89         ANDEQ     '0'
     C                   Z-ADD     SECL          SECLVL            4 0
     C                   EXCEPT    MUSRRL
     C                   END
      *
      ** Check if CGL008 is installed
      *
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD             7
     C                   PARM      '*VERIFY'     POPTN             7
     C                   PARM      'CGL008'      PSARD             6
      *
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CGL008            1
     C                   MOVE      *ON           *IN28
     C                   ELSE
     C                   MOVE      'N'           CGL008
     C                   MOVE      *OFF          *IN28
     C                   ENDIF
      *                                                                                       239297
      ** Check if CRT001 (Retail Teller system) is installed                                  239297
      *                                                                                       239297
     C                   CALL      'AOSARDR0'                                                 239297
     C                   PARM      *BLANKS       PRTCD             7                          239297
     C                   PARM      '*VERIFY'     POPTN             7                          239297
     C                   PARM      'CRT001'      PSARD             6                          239297
      *                                                                                       239297
     C     PRTCD         IFEQ      *BLANKS                                                    239297
     C                   MOVE      'Y'           CRT001            1                          239297
     C                   MOVE      *ON           *IN82                                        239297
     C                   ELSE                                                                 239297
     C                   MOVE      'N'           CRT001                                       239297
     C                   MOVE      *OFF          *IN82                                        239297
     C                   ENDIF                                                                239297
      *
     C/COPY WNCPYSRC,SFH00100
     C                   END
     C/EJECT
      ********************************************************************
      *                                                                  *
      *    M  A  I  N      C  Y  C  L  E       P R O C E S S I N G       *
      *                                                                  *
      ********************************************************************
     C/SPACE 2
      ********************************************************************
      *                                                                  *
      *    I  N  I  T  I  A  L      S  C  R  E  E  N                     *
      *                                                                  *
     *********************************************************************
     C**
     C     *IN21         DOUEQ     '1'
     C**
     C     RDSPIN        TAG
     C**
     C                   WRITE     SF000020F1
      *
      ** READ WORKSTATION FILE / HELP FACILITY
      *
     C                   READ      SF000020F1                             19
      *
      ** F3
      *
     C     *INKC         IFEQ      '1'
     C                   EXSR      ENDPGM
      *
      ** ENTER
      *
     C                   ELSE
     C                   EXSR      INITSC
     C                   END
     C/SPACE 2
      *
      ** SETUP DEFAULT FIELDS FOR SCREEN, IF NECESSARY.
      *
     C     SSECL         IFEQ      '    '
     C                   MOVE      '5000'        SSECL
     C                   END
     C     SROUF         IFEQ      ' '
     C                   MOVE      'N'           SROUF
     C                   END
     C     SROUT         IFEQ      ' '
     C                   MOVE      'N'           SROUT
     C                   END
     C     SMUREP        IFEQ      ' '
     C                   MOVE      'N'           SMUREP
     C                   END
     C     SMBREP        IFEQ      ' '
     C                   MOVE      'N'           SMBREP
     C                   END
     C     SBANK         IFEQ      ' '
     C                   MOVE      'N'           SBANK
     C                   END
     C     MBRIND        IFNE      'Y'
     C     SDBRN         ANDEQ     '   '
     C                   MOVE      BJSBRC        SDBRN
     C                   END
      *
      ** If FRA/IRS present, set auto-refresh for user to 'N'
      *
     C     @PRES         IFEQ      'Y'
     C     SAURF         ANDEQ     *BLANK
     C                   MOVE      'N'           SAURF
     C                   END
      *
      ** If CGL008 is switched on, set 'Access to all journal entry
      ** account codes' to 'N' and 'User batch authorization level'
      ** to 'Z'
      *
     C     CGL008        IFEQ      'Y'
     C     SACTN         IFEQ      'I'
     C                   MOVE      'N'           SJEAA
     C                   MOVE      'Z'           SALVL
     C                   MOVE      *BLANKS       SREFU
     C                   MOVE      *BLANKS       REFUSR
     C                   MOVE      'N'           REFFLG
     C                   ELSE
     C                   MOVEL     ALACOD        SJEAA
     C                   MOVEL     REFUSR        SREFU
     C                   MOVEL     USRLVL        SALVL
     C                   MOVEL     REFUSR        WREFU            10
     C                   ENDIF
     C                   ENDIF
     C/SPACE 2
      ********************************************************************
      *                                                                 **
      *    M A N D A T O R Y    D E T A I L S     S C R E E N           **
      *                                                                 **
      ********************************************************************
      *
     C     *IN21         DOWEQ     '1'
      *
     C                   MOVE      SUSER         USRPRF           10
     C                   MOVE      SACTN         ACTCDE            1
      *
     C     CUDRQ         IFEQ      'Y'
      *
     C     RDSPDT        TAG
      *
     C/COPY WNCPYSRC,SFH00101
     C                   WRITE     SF000020F2
      *
      ** READ WORKSTATION FILE / HELP FACILITY
      *
     C                   READ      SF000020F2                             19
      *
      ** F3
      *
     C     *INKC         IFEQ      '1'
     C                   EXSR      ENDPGM
     C                   END
      *
      ** F12
      *
     C     *INKL         IFEQ      '1'
     C                   EXSR      RTRNSC
     C     SACTN         IFEQ      'A'
     C     SACTN         OREQ      'I'
     C     SACTN         OREQ      'D'
     C                   EXSR      EXCPT
     C                   ENDIF
     C                   GOTO      RDSPIN
     C                   END
      *
      ** F10
      *
     C     *IN24         IFEQ      '1'
     C     *INKJ         IFEQ      '1'
      *
      ** If CGL008 is installed, validate user profile
      *
     C     CGL008        IFEQ      'Y'
     C     *IN80         ANDEQ     *OFF
     C                   MOVE      *BLANKS       WREF              1
     C                   MOVE      SUSER         WSUSER           10
      *
      ** Check user profile if it is used as a reference user
      *
     C     SUSER         SETLL     MUSERD1
     C     SUSER         READE     MUSERD1                                07
      *
     C     *IN07         DOWEQ     *OFF
     C     USRP          IFNE      REFUSR
     C     RECI          ANDEQ     'D'
     C                   MOVE      'Y'           WREF
     C                   ENDIF
     C     SUSER         READE     MUSERD1                                07
     C                   ENDDO
      *
      ** If user profile is used as a reference user, can not delete
      *
     C     WREF          IFEQ      'Y'
     C                   MOVE      *BLANKS       SUSER
     C                   MOVE      *BLANKS       SACTN
     C                   MOVE      *BLANKS       SXXRQ
     C                   MOVE      *ON           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 144'        ERR(Z)
     C                   MOVEA     ERR           ERCD
     C                   ENDIF
      *
     C     WSUSER        CHAIN     MUSERDDF                           88
     C                   ENDIF
      *
      ** REMOVE DIRECTORY ENTRY
      *
     C/COPY WNCPYSRC,SFH00102
     C     *IN80         IFEQ      *OFF
     C                   MOVE      'D'           ACTCDE
     C                   EXSR      CHKDIR
      *
     C                   EXSR      DELREC
      *
     C     ERRCD         IFEQ      '1'
     C                   MOVE      '1'           *IN80
     C                   MOVEL     MSG(8)        ERMS
     C                   END
     C                   ENDIF
      *
     C/COPY WNCPYSRC,SFH00103
     C                   GOTO      RDSPIN
     C                   ELSE
     C                   GOTO      RDSPDT
     C                   END
     C                   END
      *
      ** ENTER
      *
     C                   EXSR      DSCRN
     C                   END
     C/SPACE 2
      ********************************************************************
      *                                                                 **
      *    ' O T H E R    D E T A I L S '     S C R E E N S             **
      *                                                                 **
      ********************************************************************
      *
      **   PROCEED ONLY IF NO ERRORS
      *
     C     *IN80         IFEQ      '0'
      *
      ** If Action Code is not 'REACTIVATE'.
      *
     C     *IN76         IFEQ      *OFF
      *
      ** WRITE A BLANK SCREEN TO PREVENT SCREEN FLASHING ON
      ** RETURNING FROM CALLED PROGRAMS.
      *
     C                   WRITE     SF000020F3
      *
      ** BOOKING BRANCHES SELECTED
      *
     C     CBBRQ         IFEQ      'Y'
      *
     C                   CALL      'SF000021'
     C                   PARM                    USRPRF
     C                   PARM                    ACTCDE
     C                   PARM                    RTCDE
     C                   PARM                    UPDATE
     C                   PARM                    SRUNA
     C                   PARM                    RUNDD
     C                   PARM                    SZONE
      *
     C     RTCDE         IFEQ      1
      *
      ** If CMD3 is pressed from called pgm, the system should also check
      ** whether any updating done for booking brchs. If so, execute
      ** SUBR/FLAGS to check any booking brch defined for this user
      *
     C     UPDATE        IFEQ      'Y'
     C                   EXSR      FLAGS
     C                   ENDIF
      *
     C                   EXSR      ENDPGM
     C                   ENDIF
     C     RTCDE         CABEQ     5             BYPASS
      *
     C                   ENDIF
      *
      ** ORIGINATING BRANCHES SELECTED
      *
     C     CBORQ         IFEQ      'Y'
      *
     C                   CALL      'SF000022'
     C                   PARM                    USRPRF
     C                   PARM                    ACTCDE
     C                   PARM                    RTCDE
     C                   PARM                    UPDATE
     C                   PARM                    SRUNA
     C                   PARM                    RUNDD
     C                   PARM                    SZONE
      *
     C     RTCDE         IFEQ      1
      *
      ** If CMD3 is pressed from called pgm, the system should also check
      ** whether any updating done for origin brches. If so, execute
      ** SUBR/FLAGS to check any origin brchs defined for this user
      *
     C     UPDATE        IFEQ      'Y'
     C                   EXSR      FLAGS
     C                   END
      *
     C                   EXSR      ENDPGM
     C                   END
      *
     C     RTCDE         CABEQ     5             BYPASS
      *
     C                   END
      *
      ** COMPANIES SELECTED
      *
     C     CCORQ         IFEQ      'Y'
      *
     C                   CALL      'SF000023'
     C                   PARM                    USRPRF
     C                   PARM                    ACTCDE
     C                   PARM                    RTCDE
     C                   PARM                    UPDATE
     C                   PARM                    SRUNA
     C                   PARM                    RUNDD
     C                   PARM                    SZONE
      *
     C     RTCDE         IFEQ      1
      *
      ** If CMD3 is pressed from called pgm, the system should also check
      ** whether any updating done for company codes. If so, execute
      ** SUBR/FLAGS to check any company codes defined for this user
      *
     C     UPDATE        IFEQ      'Y'
     C                   EXSR      FLAGS
     C                   END
      *
     C                   EXSR      ENDPGM
     C                   END
      *
     C     RTCDE         CABEQ     5             BYPASS
      *
     C                   END
      *
      ** ACTION CODES SELECTED
      *
     C     CACRQ         IFEQ      'Y'
      *
     C                   Z-ADD     SECL          SECLUS            4 0
                                                                                             BUG2711
     C                   IF        ACTCDE <> 'I'                                             BUG2711
                                                                                             BUG2711
     C                   EVAL      PUser = USRPRF                                            BUG2711
                                                                                             BUG2711
     C                   CALL      'SFC000030'                                               BUG2711
     C                   PARM      *BLANKS       PRtCd                                       BUG2711
     C                   PARM                    PUser                                       BUG2711
     C                   PARM                    SECLUS                                       240985
                                                                                             BUG2711
     C                   IF        PRtCd <> *BLANKS                                          BUG2711
     C     *LOCK         IN        LDA                                                       BUG2711
     C                   EVAL      DBFile = 'SFMNUIPD'                                       BUG2711
     C                   EVAL      DBKey = PUser                                             BUG2711
     C                   EVAL      DBase = 101                                               BUG2711
     C                   OUT       LDA                                                       BUG2711
     C                   EXSR      *PSSR                                                     BUG2711
     C                   ENDIF                                                               BUG2711
                                                                                             BUG2711
     C                   ENDIF                                                               BUG2711
      *
     C                   CALL      'SFC000024'
     C                   PARM                    USRPRF
     C                   PARM                    ACTCDE
     C                   PARM                    RTCDE
     C                   PARM                    UPDATE
     C                   PARM                    SRUNA
     C                   PARM                    RUNDD
     C                   PARM                    MBRIND
     C                   PARM                    SECLUS
     C                   PARM                    SZONE
      *
     C     RTCDE         IFEQ      1
      *
      ** If CMD3 is pressed from called pgm, the system should also check
      ** whether any updating done for actions codes. If so, execute
      ** SUBR/FLAGS to check any action codes defined for this user
      *
     C     UPDATE        IFEQ      'Y'
     C                   EXSR      FLAGS
     C                   END
      *
     C                   EXSR      ENDPGM
     C                   END
      *
     C     RTCDE         CABEQ     5             BYPASS
      *
      * Commit any changes made for other options when 'Action codes' is not                  241801
      * amended.                                                                              241801
     C                   ELSE                                                                 241801
     C     CUDRQ         IFEQ      'Y'                                                        241801
     C     CBBRQ         OREQ      'Y'                                                        241801
     C     CBORQ         OREQ      'Y'                                                        241801
     C     CCORQ         OREQ      'Y'                                                        241801
     C                   COMMIT                                                               241801
     C                   ENDIF                                                                241801
      *
     C                   END
      *
     C                   ELSE
      *
      ** ACTIVATE all User details.
      *
     C                   CALL      'SF000027'
     C                   PARM                    USRPRF
     C                   PARM                    RUNDD
     C                   PARM                    MBRIND
     C                   PARM                    OBRIND
      *
     C                   ENDIF
      *
     C     BYPASS        TAG
      *
     C                   EXSR      FLAGS
     C/COPY WNCPYSRC,SFH00104
     C                   EXSR      RTRNSC
     C                   COMMIT                                                             BUG12414
      *
     C                   END
      *
     C                   END
      *
     C                   END
     C                   COMMIT                                                            BUG12414A
      *
     C/EJECT
      ********************************************************************
      *                                                                  *
      *      S  U  B  R  O  U  T  I  N  E  S                             *
      *                                                                  *
      ********************************************************************
     C**                                                                **
     C**  ENDPGM SR.  TO END PROGRAM                                    **
     C**              CALLED FROM : MAIN PROCESSING                     **
     C**                                                                **
     C********************************************************************
      *
     C     ENDPGM        BEGSR
     C                   COMMIT                                                            BUG12414A
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C                   ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
      *                                                                  *
      *   RTRNSC SR. TO RETURN TO THE INITIAL SCREEN                     *
      *              CALLED FROM : MAIN PROCESSING                       *
      *                                                                  *
     C********************************************************************
      *
     C     RTRNSC        BEGSR
      *
     C     *IN69         IFEQ      '0'
     C                   MOVE      *BLANKS       SCNDTA
     C                   MOVE      ' '           SACTN
     C                   MOVE      '      '      SXXRQ
      *
     C                   END
      *
     C                   Z-ADD     0             RTCDE
      *
     C                   MOVEA     '000000'      *IN(11)
     C                   MOVEA     '0000000'     *IN(21)
     C                   MOVEA     '00'          *IN(79)
     C                   MOVEA     '0000'        *IN(30)
     C                   MOVEA     '00000'       *IN(36)
     C                   MOVEA     '000000'      *IN(41)
     C                   MOVEA     '00000000'    *IN(57)
     C                   MOVEA     '000'         *IN(08)
     C/COPY WNCPYSRC,SFH00105
      *
     C                   MOVE      *BLANKS       ERR
     C                   MOVE      *BLANKS       ERCD
     C     *IN69         IFEQ      '0'
     C                   MOVE      *BLANKS       ERMS
     C                   MOVE      '0'           *IN80
     C                   ELSE
     C                   MOVE      '0'           *IN69
     C                   MOVE      '1'           *IN80
     C                   END
      *
     C                   ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      *   FLAGS SR. TO UPDATE MUSER FLAGS                                *
      *              CALLED FROM : MAIN PROCESSING                       *
      *              CALLS       : SF000029                              *
      *                            SR. EXCPT                             *
      *                                                                  *
      ********************************************************************
      *
     C     FLAGS         BEGSR
      *
     C     UPDATE        IFEQ      'Y'
      *
     C/COPY WNCPYSRC,SFH00106
     C                   CALL      'SF000029'
     C                   PARM                    USRPRF
     C                   PARM                    MBRIND
     C                   PARM                    OBRIND
     C                   PARM                    DAF               1
     C                   PARM                    BRB               1
     C                   PARM                    BRO               1
     C                   PARM                    CMP               1
     C                   PARM                    ACD               1
      *
     C/COPY WNCPYSRC,SFH00107
     C     USRPRF        CHAIN     MUSER                              17                      245075
     C/COPY WNCPYSRC,SFH00108
      *                                                                                       245075
     C                   MOVE      DAF           DAFS
     C                   MOVE      BRB           BRBS
     C                   MOVE      BRO           BROS
     C                   MOVE      CMP           CMPS
     C                   MOVE      ACD           ACDS
      *
     C                   MOVE      'D'           RECIDD
     C                   Z-ADD     RUNDD         LCD
     C                   MOVE      'A'           CHTP
     C                   TIME                    TIMEP
     C                   Z-ADD     TIMEP         LCT
     C                   MOVE      SDIRID        DIRID
     C                   MOVE      SDIRAD        DIRAD
      *
     C*****USRPRF*****   CHAIN     MUSER                              17            BUG10744A 245075
     C/COPY WNCPYSRC,SFH00109
     C                   UPDATE    MUSERDDF
     C                   COMMIT                                                               245075
     C/COPY WNCPYSRC,SFH00110
      *
     C                   MOVE      'N'           UPDATE
      *
     C                   ELSE
     C     SACTN         IFEQ      'A'
     C     SACTN         OREQ      'I'
     C     SACTN         OREQ      'R'
     C     SACTN         OREQ      'D'
     C/COPY WNCPYSRC,SFH00111
     C                   EXSR      EXCPT
     C                   ENDIF
      *
     C                   END
      *
     C                   ENDSR
      ********************************************************************
     C/EJECT
      ********************************************************************
      *                                                                  *
      *   EXCPT SR. TO RELEASE USER'S MUSER RECORD                       *
      *             CALLED FROM : MAIN PROCESSING                        *
      *                           SR. INITSC                             *
      *                           SR. FLAGS                              *
      *                                                                  *
      ********************************************************************
      *
     C     EXCPT         BEGSR
      *
     C/COPY WNCPYSRC,SFH00112
     C     *IN86         IFEQ      '0'
     C     *IN88         ANDEQ     '0'
     C                   EXCEPT    MUSRRL
     C                   SETOFF                                       65
     C                   END
     C/COPY WNCPYSRC,SFH00113
      *
     C                   ENDSR
      ********************************************************************
     C/EJECT
      ********************************************************************
      *                                                                  *
      *   INITSC SR. TO PROCESS THE INITIAL SCREEN                       *
      *              CALLED FROM : MAIN PROCESSING                       *
      *              CALLS       : SR. EXCPT                             *
      *                                                                  *
      ********************************************************************
      *
     C     INITSC        BEGSR
      *
     C                   Z-ADD     0             Z                 2 0
     C                   MOVEA     '00'          *IN(21)
     C                   MOVE      '0'           *IN40
     C                   MOVE      *OFF          *IN76
     C                   MOVEA     '000'         *IN(79)
     C                   MOVEA     '00000'       *IN(23)
     C                   MOVEA     '0000000'     *IN(30)
     C                   MOVEA     '000000'      *IN(41)
     C                   MOVEA     '000000'      *IN(51)
     C                   MOVEA     '000'         *IN(63)
     C                   MOVEA     '000'         *IN(08)
     C                   MOVEA     '0'           *IN(05)
     C                   MOVE      '0'           *IN77                                        TDA035
     C                   EVAL      *IN84 = *OFF                                               CSD086
     C*
     C                   SETON                                        88
     C                   MOVE      *BLANKS       INFELD
     C                   MOVE      *BLANKS       SDTA2
     C                   MOVE      *BLANKS       ERR
     C                   MOVE      *BLANKS       ERCD
     C                   MOVE      *BLANKS       ERMS
     C/COPY WNCPYSRC,SFH00114
                                                                                             BUG2975
      ** Check first if the user requested user profile selection.                           BUG2975
                                                                                             BUG2975
     C                   IF        %SCAN('?' : SUSER) <> *ZERO                               BUG2975
     C                   EXSR      SRSUSR                                                    BUG2975
     C                   LEAVESR                                                             BUG2975
     C                   ENDIF                                                               BUG2975
      *
      ** ACTION CODE  VALIDATION
      ** ~~~~~~~~~~~~~~~~~~~~~~~
      **  001        MANDATORY ENTRY
      **  002        MUST BE A  D  E  I R
      **
      **
      ** RESET WARNING IND.
      *
     C     SACTN         IFNE      'D'
     C                   SETOFF                                       50
     C                   ELSE
     C     SUDRQ         IFNE      'Y'
     C                   SETOFF                                       50
     C                   END
     C                   END
      *
      ** ACTION CODE IS MANDATORY ENTRY.
      *
     C     SACTN         IFEQ      ' '
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 001'        ERR(Z)
     C                   GOTO      INT002
     C                   END
      *
      ** ACTION CODE MUST BE A  D  E  OR  I.
      *
     C                   MOVEA     '0000'        *IN(23)
     C/COPY WNCPYSRC,SFH00115
     C                   MOVE      *OFF          *IN76
     C     SACTN         CABEQ     'A'           INT002                   23
     C     SACTN         CABEQ     'D'           INT002                   24
     C     SACTN         CABEQ     'E'           INT002                   25
     C     SACTN         CABEQ     'I'           INT002                   26
     C     SACTN         CABEQ     'R'           INT002                   76
     C/COPY WNCPYSRC,SFH00116
      *
      ** ACTION CODE IS INVALID
      *
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 002'        ERR(Z)
      *
     C     INT002        TAG
      *
      ** USER PROFILE VALIDATION
      ** ~~~~~~~~~~~~~~~~~~~~~~~
      ** 003         MANDATORY ENTRY
      ** 004         MUST BE LEFT ADJUSTED WITH NO EMBEDDED BLANKS
      *
      ** USER PROFILE IS MANDATORY ENTRY.
      *
     C     SUSER         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 003'        ERR(Z)
     C                   GOTO      INT003
     C                   END
      *
      ** USER PROFILE MUST BE LEFT ADJUSTED (WITH NO EMBEDDED BLANKS.)
      *
     C                   MOVEL     SUSER         CHEK01
     C     CHEK01        IFEQ      ' '
     C     CHEK01        ORGT      'Z'
     C     CHEK01        ORLT      'A'
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 004'        ERR(Z)
     C                   GOTO      INT003
     C                   END
      *
      ** USER PROFILE MUST HAVE NO EMBEDDED BLANKS.
      *
     C                   MOVEA     SUSER         CHK
     C                   Z-ADD     1             X                 3 0
     C     X             DOWLE     10
      *
     C                   MOVE      '0'           *IN90
     C     CHK(X)        LOOKUP    VALI                                   90
     C     CHK(X)        IFNE      ' '
     C     *IN40         IFEQ      '1'
     C     *IN90         OREQ      '0'
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 004'        ERR(Z)
     C                   Z-ADD     10            X
     C                   GOTO      INT003
     C                   END
     C                   ELSE
     C                   MOVE      '1'           *IN40
     C                   END
      *
     C                   ADD       1             X
     C                   END
      *
      **   ATTEMPT TO ACCESS AN EXISTING MUSER RECORD :
      **   IF FOUND, CHECK IF THE RECORD IS LOCKED, SET UP SCREEN
      **   FIELDS  AND CHECK IF THE RECORD IS LIVE.
      *
     C/COPY WNCPYSRC,SFH00117
     C     SUSER         CHAIN     MUSER                              8886
     C/COPY WNCPYSRC,SFH00118
     C     *IN88         IFEQ      '0'
      *
     C     *IN86         IFEQ      '1'
     C                   SETON                                        303180
     C                   MOVEL     MSG(5)        ERMS
     C                   GOTO      INT003
     C                   END
      *
     C                   MOVEL     INFELD        SCNDTA
      *
      ** FORMATTING ENTERING/APPROVING/AUTHORISING LIMIT FIELDS
      ** FOR THE SCREEN
      *
     C                   Z-ADD     ENTL          PFld15
     C                   MOVE      A6NBDP        PDecs
     C                   MOVE      'L'           PECode
      *
      **  FORMATTING ENTERING LIMIT FIELD
      *
     C                   EXSR      SrCvtAmt
     C                   MOVE      POut21        ENLIM
      *
      ** FORMATTING APPROVING LIMIT FIELD
      *
     C                   Z-ADD     AUT1          PFld15
     C                   EXSR      SrCvtAmt
     C                   MOVE      POut21        APLIM
      *
      **
      *
     C                   Z-ADD     AUT2          PFld15
     C                   EXSR      SrCvtAmt
     C                   MOVE      POut21        AULIM
      *
     C                   MOVE      COUTQ         SCOUTQ
     C/COPY WNCPYSRC,SFH00119
     C     RECIDD        COMP      'C'                                    65
     C/COPY WNCPYSRC,SFH00120
      *
     C                   END
      *
      **
      *
     C     SACTN         IFEQ      'I'
     C     *IN88         IFEQ      '0'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 005'        ERR(Z)
     C     RECIDD        IFEQ      'C'
     C                   MOVEL     MSG(16)       ERMS
     C                   ELSE
     C                   MOVEL     MSG(1)        ERMS
     C                   ENDIF
     C                   GOTO      INT003
     C                   ENDIF
     C                   ENDIF
      *
      ** REACTIVATE must refer to a Deleted (Reci = 'C') record on File.
      *
     C     SACTN         IFEQ      'R'
     C     *IN88         IFEQ      '1'
     C     RECIDD        OREQ      'D'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 008'        ERR(Z)
     C                   MOVEL     MSG(17)       ERMS
     C                   GOTO      INT003
     C                   END
     C                   END
      *
      ** FOR AMEND OR DELETE MUST REFER TO A LIVE RECORD ON FILE
      *
     C     SACTN         IFEQ      'A'
     C     *IN88         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 006'        ERR(Z)
     C                   MOVEL     MSG(2)        ERMS
     C                   GOTO      INT003
      *
     C                   ELSE
      *
     C     *IN65         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 006'        ERR(Z)
     C                   MOVEL     MSG(2)        ERMS
     C                   GOTO      INT003
     C                   END
     C                   END
     C                   END
      *
     C     SACTN         IFEQ      'D'
     C     *IN88         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 006'        ERR(Z)
     C                   MOVEL     MSG(2)        ERMS
     C                   GOTO      INT003
      *
     C                   ELSE
      *
     C     *IN65         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 006'        ERR(Z)
     C                   MOVEL     MSG(2)        ERMS
     C                   GOTO      INT003
     C                   END
     C                   END
      *
      ** IF DELETING, ENSURE USER DOESN'T HAVE SUICIDAL TENDENCIES.
      *
     C     USRID         IFEQ      SUSER
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 107'        ERR(Z)
     C                   MOVEL     MSG(6)        ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** If deleting user is being maintained by another wrkstn,
      ** do not allow deletion
      *
     C     *IN89         IFEQ      '1'
     C                   SETON                                        80
     C                   MOVEL     MSG(14)       ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** NOT AUTHORISED TO DELETE A USER WITH A HIGHER SECURITY LEVEL
      *
     C     SECLVL        IFLT      SSECN
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 108'        ERR(Z)
     C                   MOVEL     MSG(7)        ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** Cannot delete MIDAS user
      *
     C     SUSER         IFEQ      'MIDAS   '
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 111'        ERR(Z)
     C                   MOVEL     MSG(9)        ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** Cannot delete user who has report requests outstanding
      *
     C     SUSER         CHAIN     FCRREQL5                           88
     C     *IN88         IFEQ      '0'
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 112'        ERR(Z)
     C                   MOVEL     MSG(10)       ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** Cannot delete user who is defined as user for output
      *
     C     SUSER         CHAIN     FCRREQLC                           88
     C     *IN88         IFEQ      '0'
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 113'        ERR(Z)
     C                   MOVEL     MSG(11)       ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** Cannot delete user who is defined as requesting user for
      ** periodic reports
      *
     C     SUSER         CHAIN     FCPREQL4                           88
     C     *IN88         IFEQ      '0'
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 114'        ERR(Z)
     C                   MOVEL     MSG(12)       ERMS
     C                   GOTO      INT003
     C                   END
      *
      ** Cannot delete user who is defined as user for output on
      ** periodic reports
      *
     C     SUSER         CHAIN     FCPREQL5                           88
     C     *IN88         IFEQ      '0'
     C                   SETON                                        303180
     C                   ADD       1             Z
     C                   MOVE      ' 115'        ERR(Z)
     C                   MOVEL     MSG(13)       ERMS
     C                   GOTO      INT003
     C                   END
      *
     C                   END
      *
      ** FOR ENQUIRE MUST REFER TO A RECORD ON FILE
      *
     C     SACTN         IFEQ      'E'
     C     *IN88         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN31
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 007'        ERR(Z)
     C                   MOVEL     MSG(3)        ERMS
     C                   GOTO      INT003
     C                   END
     C                   END
      *
      ** IF MULTI-BRANCH IND = 'Y'
      *
     C     *IN70         IFEQ      '1'
      *
      ** BOOKING BRANCHES
      *  ~~~~~~~~~~~~~~~~
     C     SBBRQ         IFNE      'Y'
     C     SBBRQ         ANDNE     ' '
     C                   SETON                                        4380
     C                   ADD       1             Z
     C                   MOVE      ' 103'        ERR(Z)
      *
     C                   ELSE
     C     SBBRQ         IFEQ      'Y'
     C     BRBS          ANDNE     'Y'
     C     *IN24         IFEQ      '1'
     C     *IN25         OREQ      '1'
     C/COPY WNCPYSRC,SFH00121
     C                   SETON                                        435381
     C                   END
     C                   END
     C     SBBRQ         IFEQ      ' '
     C     *IN26         ANDEQ     '1'
     C                   MOVE      'N'           BRBS
     C                   END
      *
     C                   END
      *
      ** IF ORIG. BRANCH IND = 'Y'
      *
     C     *IN71         IFEQ      '1'
      *
      ** ORIGINATING BRANCHES
      *  ~~~~~~~~~~~~~~~~~~~~
     C     SBORQ         IFNE      'Y'
     C     SBORQ         ANDNE     ' '
     C                   SETON                                        4480
     C                   ADD       1             Z
     C                   MOVE      ' 104'        ERR(Z)
      *
     C                   ELSE
     C     SBORQ         IFEQ      'Y'
     C     BROS          ANDNE     'Y'
     C     *IN24         IFEQ      '1'
     C     *IN25         OREQ      '1'
     C/COPY WNCPYSRC,SFH00122
     C                   SETON                                        445481
     C                   END
     C                   END
     C     SBORQ         IFEQ      ' '
     C     *IN26         ANDEQ     '1'
     C                   MOVE      'N'           BROS
     C                   END
      *
     C                   END
      *
     C                   END
      *
      ** COMPANIES
      * 7~~~~~~~~~
     C     SCORQ         IFNE      'Y'
     C     SCORQ         ANDNE     ' '
     C                   SETON                                        4580
     C                   ADD       1             Z
     C                   MOVE      ' 105'        ERR(Z)
      *
     C                   ELSE
     C     SCORQ         IFEQ      'Y'
     C     CMPS          ANDNE     'Y'
     C     *IN24         IFEQ      '1'
     C     *IN25         OREQ      '1'
     C/COPY WNCPYSRC,SFH00123
     C                   SETON                                        455581
     C                   END
     C                   END
     C     SCORQ         IFEQ      ' '
     C     *IN26         ANDEQ     '1'
     C                   MOVE      'N'           CMPS
     C                   END
      *
     C                   END
      *
     C                   END
      *
      ** ACTION CODES
      *  ~~~~~~~~~~~~
     C     SACRQ         IFNE      'Y'
     C     SACRQ         ANDNE     ' '
     C                   SETON                                        4680
     C                   ADD       1             Z
     C                   MOVE      ' 106'        ERR(Z)
      *
     C                   ELSE
     C     SACRQ         IFEQ      'Y'
     C     ACDS          ANDNE     'Y'
     C     *IN24         IFEQ      '1'
     C     *IN25         OREQ      '1'
     C/COPY WNCPYSRC,SFH00124
     C                   SETON                                        465681
     C                   END
     C                   END
     C     SACRQ         IFEQ      ' '
     C     *IN26         ANDEQ     '1'
     C                   MOVE      'N'           ACDS
     C                   END
      *
     C                   END
      *
      ** NO DETAILS REQUESTED
      *  ~~~~~~~~~~~~~~~~~~~~
     C     SACTN         IFNE      'R'
     C     SXXRQ         IFEQ      '      '
      *
     C                   SETON                                        80
     C                   MOVEA     '111111'      *IN(41)
     C                   ADD       1             Z
     C                   MOVE      ' 110'        ERR(Z)
     C                   ENDIF
     C                   ELSE
     C     SXXRQ         IFNE      '      '
     C*
     C                   SETON                                        80
     C                   MOVEA     '111111'      *IN(41)
     C                   ADD       1             Z
     C                   MOVE      ' 116'        ERR(Z)
     C                   ENDIF
     C                   ENDIF
      *
      ** USER DEFINITION + MENU ITEMS
      *    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     C     SUDRQ         IFNE      'Y'
     C     SUDRQ         ANDNE     ' '
     C                   SETON                                        4180
     C                   ADD       1             Z
     C                   MOVE      ' 101'        ERR(Z)
      *
     C                   ELSE
      *
     C     SUDRQ         IFEQ      ' '
      *     MANDATORY FOR 'INSERT'
     C     *IN26         IFEQ      '1'
     C                   SETON                                        415181
     C                   END
      *
     C                   ELSE
      *     WARNING :- 'DELETE' DELETES ALL DETAILS
     C     *IN24         IFEQ      '1'
     C     *IN50         IFEQ      '0'
     C                   SETON                                        415080
     C                   ADD       1             Z
     C                   MOVE      ' W01'        ERR(Z)
     C                   ELSE
     C     *IN80         IFEQ      '0'
     C     *IN81         ANDEQ     '0'
     C                   SETOFF                                       50
     C                   END
     C                   END
     C                   END
      *
     C                   END
      *
     C                   END
      *
     C     INT003        TAG
     C/SPACE 2
      *
      ** CHECK WHETHER A VALID SCREEN
      *
      ** VALID SCREEN : PROCEED TO DISPLAY DETAIL SCREEN(S)
      *
     C     *IN80         IFEQ      '0'
     C     *IN81         ANDEQ     '0'
     C     *IN50         ANDEQ     '0'
     C                   MOVE      '1'           *IN21
     C                   MOVE      SXXRQ         CXXRQ
      *
      ** - INVALID SCREEN : DISPLAY ERRORS AND RELEASE MUSER RECORD
      *
     C                   ELSE
     C                   MOVEA     ERR           ERCD
     C                   EXSR      EXCPT
     C                   END
      *
     C/COPY WNCPYSRC,SFH00125
     C     *IN80         IFEQ      '0'
     C     *IN81         ANDEQ     '0'
     C     *IN50         ANDEQ     '0'
     C     SACTN         ANDEQ     'E'
     C                   EXCEPT    MUSRRL
     C                   ENDIF
     C/COPY WNCPYSRC,SFH00126
      *
     C                   ENDSR
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
      *
      *   DSCRN SR. TO PROCESS THE DETAIL SCREEN                        **
      *             CALLED FROM : MAIN PROCESSING                       **
      *             CALLS       : SR. DETLSC                            **
      *                           SR. INSTSR                            **
      *                           SR. AMNDSR                            **
      *                           SR. ENQSR                             **
      *                                                                 **
      ********************************************************************
      *
     C     DSCRN         BEGSR
      *
     C                   MOVEA     '0000000'     *IN(30)
     C                   MOVEA     '000'         *IN(37)
     C                   MOVEA     '000000'      *IN(11)
     C                   MOVE      '0'           *IN49
     C                   MOVEA     '00'          *IN(63)
     C                   MOVE      '0'           *IN75
     C                   MOVEA     '000'         *IN(08)
     C                   MOVEA     '0'           *IN(05)
     C                   SETOFF                                       22
     C                   MOVE      *BLANKS       ERR
     C                   MOVE      *BLANKS       ERCD
     C                   MOVE      *BLANKS       ERMS
     C                   EVAL      *IN83 = *OFF                                             BUG11032
     C                   EVAL      *IN84 = *OFF                                               CSD086
     C                   EVAL      OVPRFlg = 'N'                                            BUG27689
      *
      ** AMEND SCREEN PROCESSING.
      *
     C     *IN23         IFEQ      '1'
     C                   EXSR      DETLSC
      *                                                                                     BUG27689
     C                   IF        OVPRFlg = 'Y'                                            BUG27689
     C                   GOTO      RDSPDT                                                   BUG27689
     C                   ENDIF                                                              BUG27689
      *
     C     *IN80         IFEQ      '0'
     C                   EXSR      AMNDSR
     C                   END
     C                   END
      *
     C     *IN26         IFEQ      '1'
     C                   EXSR      DETLSC
      *                                                                                     BUG27689
     C                   IF        OVPRFlg = 'Y'                                            BUG27689
     C                   GOTO      RDSPDT                                                   BUG27689
     C                   ENDIF                                                              BUG27689
     C*
     C     *IN80         IFEQ      '0'
     C                   EXSR      INSTSR
     C                   END
     C                   END
      *
      ** ENQUIRE SCREEN PROCESSING.
      *
     C     *IN25         IFEQ      '1'
     C/COPY WNCPYSRC,SFH00127
     C*
     C*
     C                   EXSR      ENQSR
     C/COPY WNCPYSRC,SFH00128
     C                   END
     C                   ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
      *                                                                  *
      *   DETLSC SR. TO PROCESS THE DETAIL SCREEN                        *
      *              CALLED FROM : SR. DSCRN                             *
      *                                                                  *
      ********************************************************************
     C**
     C     DETLSC        BEGSR
     C**
     C                   Z-ADD     0             Z                 2 0
     C                   MOVEA     '00'          *IN(79)
     C                   MOVEA     '0000'        *IN(30)
     C                   MOVEA     '000'         *IN(36)
     C                   MOVEA     '00000000'    *IN(57)
     C                   MOVEA     '000000'      *IN(11)
     C                   MOVE      '0'           *IN49
     C                   MOVEA     '00'          *IN(63)
     C                   MOVE      '0'           *IN75
     C                   MOVEA     '000'         *IN(08)
     C                   MOVEA     '0'           *IN(05)
     C                   SETOFF                                       22
     C                   MOVE      *BLANKS       ERR
     C                   MOVE      *BLANKS       ERCD
     C                   MOVE      *BLANKS       ERMS
     C                   EVAL      *IN83 = *OFF                                             BUG11032
     C                   EVAL      *IN84 = *OFF                                               CSD086
      *
      ** Midas User is mandatory entry.
      *
     C     SMUSR         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN32
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      ' 010'        ERR(Z)
     C                   END
      *                                                                                     BUG11032
      ** Employee number must be unique                                                     BUG11032
      *                                                                                     BUG11032
     C     EMPNO         IFNE      SEMPN                                                      249757
     C     SACTN         ANDEQ     'A'                                                        249757
     C     SACTN         OREQ      'I'                                                        249757
     C                   IF        SEMPN <> *BLANKS                                         BUG11032
     C     SEMPN         CHAIN     MUSERL4                                                  BUG11032
     C                   IF        %FOUND()                                                 BUG11032
     C                   EVAL      *IN79 = *ON                                              BUG11032
     C                   EVAL      *IN80 = *ON                                              BUG11032
     C                   EVAL      *IN83 = *ON                                              BUG11032
     C                   EVAL      Z = Z + 1                                                BUG11032
     C                   EVAL      ERR(Z) = '144'                                           BUG11032
     C                   EVAL      ERMS  = MSG(21)                                          BUG11032
     C                   ENDIF                                                              BUG11032
      *                                                                                     BUG11032
     C                   ENDIF                                                              BUG11032
      *
     C                   ENDIF                                                                249757
      ** Security level is mandatory entry.
      *
     C     SSECL         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN33
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      ' 011'        ERR(Z)
     C                   GOTO      DET001
     C                   END
     C**
     C**   Right adjust security level field.
     C**
     C                   MOVE      '0'           *IN27
     C     *IN27         DOWEQ     '0'
     C**
     C                   MOVE      SSECL         CHEK01            1
     C     CHEK01        IFEQ      ' '
     C                   MOVEL     SSECL         CHEK03            3
     C                   MOVE      CHEK03        SSECL
     C                   MOVEL     '0'           SSECL
     C                   MOVE      '0'           *IN27
     C                   ELSE
     C                   MOVE      '1'           *IN27
     C                   END
     C**
     C                   END
     C**
     C**   Security level should be numeric
     C**
     C                   MOVEL     SSECL         CHKN05            5 0
     C                   MOVEL     CHKN05        CHEK04            4
     C     SSECL         IFNE      CHEK04
     C                   MOVE      '1'           *IN33
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      ' 012'        ERR(Z)
     C                   END
     C**
     C     DET001        TAG
     C**
     C** CHECK DEPARTMENT IF ENTERED MUST BE NO EMBEDDED BLANKS IF NOT?
     C**
     C*****SDPPT         IFNE      '  '                                                      BUG8091
     C*****SDPPT         ANDNE     '?'                                                       BUG8091
     C**********         Z-ADD     1             X                                           BUG8091
     C**********         MOVEA     SDPPT         CHK1                                        BUG8091
     C*****X****         DOWLE     3                                                         BUG8091
     C*****CHK1(X)       IFEQ      ' '                                                       BUG8091
     C**********         MOVE      '1'           *IN37                                       BUG8091
     C**********         MOVEA     '11'          *IN(79)                                     BUG8091
     C**********         ADD       1             Z                                           BUG8091
     C**********         MOVE      '020'         ERR(Z)                                      BUG8091
     C**********         END                                                                 BUG8091
     C**********         ADD       1             X                                           BUG8091
     C**********         END                                                                 BUG8091
     C**********         END                                                                 BUG8091
      *
      **  If entered, must be a valid department code.
      *
     C     SDPPT         IFNE      *BLANKS
     C                   CALL      'AODEPTR0'
     C                   PARM      *BLANK        @RTCD
     C                   PARM      '*KEY    '    @OPTN
     C                   PARM                    SDPPT
     C     SDDEPT        PARM      SDDEPT        DSFDY
     C*
     C     @RTCD         IFNE      *BLANK
     C                   MOVE      '1'           *IN37
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '029'         ERR(Z)
     C                   ELSE
     C                   MOVE      AEDPCD        SDPPT
     C                   END
     C*
     C                   END
     C*
     C** Check Account Officer is valid
     C*
     C     BGPFMG        IFEQ      'Y'
     C     BGLMCR        OREQ      'Y'
     C*
     C     SACOF         IFNE      *BLANKS
     C     SACOF         ANDNE     'ALL'
     C                   MOVEL     SACOF         PACOF             2
     C                   CALL      'AOACOFR0'
     C                   PARM      *BLANK        @RTCD
     C                   PARM      '*KEY    '    @OPTN
     C                   PARM                    PACOF
     C     SDACOF        PARM      SDACOF        DSFDY
     C*
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVEL     *BLANKS       SACOF
     C                   MOVEL     AZACOC        SACOF
     C                   ELSE
      *
      ** Check if Right Aligned
      *
     C                   MOVEL     SACOF         PFIRST            1
     C     PFIRST        IFEQ      *BLANKS
     C                   MOVE      SACOF         PACOF
      *
      ** Validate Input Account Officer
      *
     C                   CALL      'AOACOFR0'
     C                   PARM      *BLANK        @RTCD
     C                   PARM      '*KEY    '    @OPTN
     C                   PARM                    PACOF
     C     SDACOF        PARM      SDACOF        DSFDY
      *
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVEL     *BLANKS       SACOF
     C                   MOVEL     AZACOC        SACOF
     C                   ELSE
      *
     C                   SETON                                        227980
     C                   ADD       1             Z
     C                   MOVE      '032'         ERR(Z)
     C                   END
     C*
     C                   ELSE
     C                   SETON                                        227980
     C                   ADD       1             Z
     C                   MOVE      '032'         ERR(Z)
     C                   END
     C                   END
     C                   END
     C*
     C                   END
     C*
     C** Check department and account officer if Portfolio Management
     C** or Portfolio Lending is switched on
     C*
     C     BGPFMG        IFEQ      'Y'
     C     BGLMCR        OREQ      'Y'
     C*
     C     SACOF         IFEQ      *BLANKS
     C     SDPPT         ANDEQ     *BLANKS
     C                   SETON                                        2237
     C                   SETON                                        7980
     C                   ADD       1             Z
     C                   MOVE      '033'         ERR(Z)
     C                   END
     C*
     C     SACOF         IFNE      *BLANKS
     C     SDPPT         ANDNE     *BLANKS
     C                   SETON                                        2237
     C                   SETON                                        7980
     C                   ADD       1             Z
     C                   MOVE      '034'         ERR(Z)
     C                   END
     C*
     C                   ELSE
     C     SACOF         IFEQ      'ALL'
     C                   SETON                                        22
     C                   SETON                                        7980
     C                   ADD       1             Z
     C                   MOVE      '035'         ERR(Z)
     C                   END
     C                   END
      *
      ** CHOICE OF REPORT OUTPUT MUST BE Y OR N
      *
     C     SROUT         IFNE      'Y'
     C     SROUT         ANDNE     'N'
     C                   MOVE      '1'           *IN38
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '021'         ERR(Z)
     C                   END
      *
      ** PAYMENT AUTHORISATION CAN BE BLANK OR Y/N
      *
     C     SPAUT         IFNE      'Y'
     C     SPAUT         ANDNE     'N'
     C     SPAUT         ANDNE     ' '
     C                   MOVE      '1'           *IN57
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '028'         ERR(Z)
     C                   END
     C*
     C                   CALL      'AOLANGR0'
     C                   PARM      '*BLANKS'     @RTCD
     C                   PARM      '*KEY   '     @OPTN
     C                   PARM                    MULTA
     C     SDLANG        PARM      SDLANG        DSFDY
     C*
     C     @RTCD         COMP      *BLANKS                            4242
     C     *IN42         IFEQ      '1'
     C                   ADD       1             Z
     C                   MOVEA     '11'          *IN(79)
     C                   MOVE      ' 031'        ERR(Z)
     C                   END
      *
      ** SYSTEM ROUTING OFFICER BE Y/N
      *
     C     SROUF         IFNE      'Y'
     C     SROUF         ANDNE     'N'
     C                   MOVE      '1'           *IN62
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '030'         ERR(Z)
     C                   END
     C**
     C** AS/400 DIRECTORY ID AND ADDRESS IF ENTERED, MUST BE BOTH BE
     C** ENTERED AND BOTH BE VALID
     C**
     C     SDIRID        IFNE      *BLANKS
     C     SDIRAD        ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN58
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '122'         ERR(Z)
     C                   END
     C**
     C     SDIRID        IFEQ      *BLANKS
     C     SDIRAD        ANDNE     *BLANKS
     C                   MOVE      '1'           *IN58
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '122'         ERR(Z)
     C                   END
     C**
     C     SDIRID        IFNE      *BLANKS
     C     SDIRAD        ANDNE     *BLANKS
     C                   EXSR      CHKDIR
     C**
     C     ERRCD         IFEQ      '1'
     C                   MOVE      '1'           *IN58
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '123'         ERR(Z)
     C                   END
     C**
     C     ERRCD         IFEQ      '2'
     C                   MOVE      '1'           *IN59
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '124'         ERR(Z)
     C                   END
     C**
     C     ERRCD         IFEQ      '3'
     C                   MOVE      '1'           *IN60
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '125'         ERR(Z)
     C                   END
     C**
     C     ERRCD         IFEQ      '4'
     C                   MOVE      '1'           *IN61
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '126'         ERR(Z)
     C                   END
     C**
     C                   END
     C**
     C**   ACCESS TO MULTIPLE USERS REPORTS MUST BE Y OR N
     C**
     C     SMUREP        IFNE      'Y'
     C     SMUREP        ANDNE     'N'
     C                   MOVE      '1'           *IN39
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '022'         ERR(Z)
     C                   END
     C**   If system is Multi-Branching :-
     C**
     C     MBRIND        IFEQ      'Y'
     C**
     C**   DEFAULT BRANCH IS MANDATORY
     C**
     C     SDBRN         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN14
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '023'         ERR(Z)
     C                   ELSE
     C**
     C**   BRANCH MUST HAVE NO EMBEDDED BLANKS IF NOT A ?
     C**
     C     SDBRN         IFNE      '?'
     C                   Z-ADD     1             X
     C                   MOVEA     SDBRN         CHK1
     C     X             DOWLE     3
     C     CHK1(X)       IFEQ      ' '
     C                   MOVE      '1'           *IN11
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '024'         ERR(Z)
     C                   GOTO      DET007
     C                   END
     C                   ADD       1             X
     C                   END
     C                   END
     C                   END
     C**
     C** CHECK THAT BRANCH IS VALID
     C**
     C* CALL A/O
     C*
     C**********         CALL      'AOBRCHR0'                                                 CGL029
     C                   CALL      'AOBRCHR1'                                                 CGL029
     C                   PARM      *BLANK        @RTCD
     C                   PARM      '*KEY    '    @OPTN
     C                   PARM      SDBRN         @DSNB             3
     C*****SDBRCH        PARM      SDBRCH        DSFDY                                        CGL029
     C     SDBRCH        PARM      SDBRCH        DSSDY                                        CGL029
     C*
     C     @RTCD         IFNE      *BLANK
     C                   MOVE      '1'           *IN11
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '025'         ERR(Z)
     C                   ELSE
     C                   MOVE      A8BRCD        SDBRN
     C                   END
     C*
     C     DET007        TAG
     C**
     C**   ACCESS TO MULTIPLE BRANCHES REPORT MUST BE Y OR N
     C**
     C     SMBREP        IFNE      'Y'
     C     SMBREP        ANDNE     'N'
     C                   MOVE      '1'           *IN12
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '026'         ERR(Z)
     C                   END
     C**
     C**   Bank level functions ind is mandatory
     C**
     C     SBANK         IFEQ      *BLANK
     C                   MOVE      '1'           *IN36
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      ' 018'        ERR(Z)
     C                   GOTO      DET004
     C                   END
     C**
     C**  Bank level functions ind must be Y or N
     C**
     C     SBANK         IFNE      'Y'
     C     SBANK         ANDNE     'N'
     C                   MOVE      '1'           *IN36
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      ' 019'        ERR(Z)
     C                   END
     C**
     C                   END
     C**
     C     DET004        TAG
      *
      ** If FRA/IRS or Tr Man is present in system, then validate input
      ** Values should be 'Y' and a value > 0, or 'N' and blank
      *
     C     @PRES         IFEQ      'Y'
      *
      ** Right-justify input value first
      *
     C                   EXSR      RJUST
      *
     C     SAURF         IFNE      'N'
     C     SAURF         ANDNE     'Y'
     C                   MOVE      '1'           *IN63
     C                   MOVE      '1'           *IN79
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 024'        ERR(Z)
      *
     C                   ELSE
     C     SAURF         IFEQ      'N'
     C     SREFP         ANDNE     *ZEROS
     C                   MOVE      '1'           *IN64
     C                   MOVE      '1'           *IN79
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 025'        ERR(Z)
      *
     C                   ELSE
     C     SAURF         IFEQ      'Y'
      *
      ** Need to check that value input is numeric
      *
     C                   MOVEL     SREFP         @REFP             5 0
     C                   MOVEL     @REFP         @TSTV             4
      *
     C     SREFP         IFEQ      @TSTV
     C                   MOVE      '1'           *IN81
     C                   ELSE
     C                   MOVE      '0'           *IN81
     C                   END
      *
      ** If 81 is on, then value entered is valid numeric value
      ** Ensure that value input is sensible, ie. at least 30 secs.
      *
     C     *IN81         IFEQ      '1'
     C     SREFP         ANDLT     '0030'
     C                   MOVE      '1'           *IN64
     C                   MOVE      '1'           *IN79
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 022'        ERR(Z)
     C                   ELSE
     C     *IN81         IFEQ      '0'
     C                   MOVE      '1'           *IN64
     C                   MOVE      '1'           *IN79
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 023'        ERR(Z)
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
      *
      **   Validate COB user - must be Y or N.
      *
     C     SCOBU         IFNE      'Y'
     C     SCOBU         ANDNE     'N'
     C                   MOVE      '1'           *IN05
     C                   MOVE      '1'           *IN79
     C                   MOVE      '1'           *IN80
     C                   MOVEL     MSG(15)       ERMS
     C                   ENDIF
                                                                                              TDA035
      ** Validate Teller ID                                                                   TDA035
                                                                                              TDA035
     C     CRT001        IFEQ      'Y'                                                        239297
     C     STLID         IFNE      *BLANKS                                                    TDA035
     C                   CALL      'AOTELDR0'                                                 TDA035
     C                   PARM      *BLANKS       @RTCD                                        TDA035
     C                   PARM      '*VERIFY'     @OPTN                                        TDA035
     C                   PARM      STLID         @TELD             3                          TDA035
     C     SDTELD        PARM      SDTELD        DSFDY                                        TDA035
                                                                                              TDA035
      ** Teller ID not found                                                                  TDA035
                                                                                              TDA035
     C                   MOVE      '0'           *IN77                                        TDA035
     C     @RTCD         IFNE      *BLANKS                                                    TDA035
     C                   MOVE      '1'           *IN77                                        TDA035
     C                   MOVE      '1'           *IN79                                        TDA035
     C                   MOVE      '1'           *IN80                                        TDA035
     C                   MOVEL     MSG(18)       ERMS                                         TDA035
     C                   ELSE                                                                 TDA035
                                                                                              TDA035
      ** One Teller ID per user profile                                                       TDA035
                                                                                              TDA035
     C     STLID         CHAIN     MUSERD3                            78                      TDA035
     C     *IN78         IFEQ      '0'                                                        TDA035
     C     U_USRP        ANDNE     SUSER                                                      TDA035
     C                   MOVE      '1'           *IN77                                        TDA035
     C                   MOVE      '1'           *IN79                                        TDA035
     C                   MOVE      '1'           *IN80                                        TDA035
     C                   MOVEL     MSG(19)       ERMS                                         TDA035
     C                   ELSE                                                                BUG8574
      *                                                                                      BUG8574
      **   Validate Teller ID in Teller/Batch Controls file (TTRNTM2)                        BUG8574
      *                                                                                      BUG8574
     C                   CALL      'AOTRM2R0'                                                BUG8574
     C                   PARM      *BLANKS       @RTCD                                       BUG8574
     C                   PARM      '*VERIFY'     @OPTN                                       BUG8574
     C                   PARM      'T'           @TBRI             1                         BUG8574
     C                   PARM      STLID         @TELD                                       BUG8574
     C                   PARM      '1'           @RCTP             1                         BUG8574
     C     TRNTM2        PARM      TRNTM2        DSFDY                                       BUG8574
     C     @RTCD         IFNE      *BLANKS                                                   BUG8574
     C                   MOVE      '1'           *IN77                                       BUG8574
     C                   MOVE      '1'           *IN79                                       BUG8574
     C                   MOVE      '1'           *IN80                                       BUG8574
     C                   MOVEL     MSG(20)       ERMS                                        BUG8574
     C                   ENDIF                                                               BUG8574
     C                   ENDIF                                                                TDA035
                                                                                              TDA035
     C                   ENDIF                                                                TDA035
                                                                                              TDA035
     C                   ENDIF                                                                TDA035
     C                   ENDIF                                                                239297
     C**
     C**   CHECK OUTPUT QUEUE
     C**
     C     SOUTQ         IFNE      *BLANK
     C                   Z-ADD     1             X
     C                   MOVEA     SOUTQ         CHK
     C     X             DOWLE     10
     C     CHK(X)        IFNE      ' '
     C     *IN49         IFEQ      '1'
     C                   MOVE      '1'           *IN13
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      '027'         ERR(Z)
     C                   Z-ADD     10            X
     C                   GOTO      DET006
     C                   END
     C                   ELSE
     C                   MOVE      '1'           *IN49
     C                   END
     C                   ADD       1             X
     C                   END
     C                   END
     C     DET006        TAG
     C     BGSECS        IFEQ      'Y'
     C**
     C** VALIDATION OF THE 'LIMITS' SCREEN FIELDS
     C**
     C                   MOVE      A6NBDP        PZADEC
     C     15            SUB       A6NBDP        PZADIG
     C                   SETOFF                                       727374
     C**
     C** VALIDATION OF THE 'ENTERING LIMIT' FIELD
     C**
     C**  Only if 'Entering Limit' Field is displayed
     C     *IN47         IFEQ      '0'
     C                   EVAL      PZFIELD = ENLIM
     C                   EXSR      SRZAlign
     C*********          IF        PZAlignOk = 'N'                                           BUG2597
     C                   IF        PZRTN = '*ERROR*'                                         BUG2597
     C                   MOVE      '1'           *IN72
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 127'        ERR(Z)
     C                   ELSE
     C                   MOVE      PZFIELD       ENLIM1           15
     C                   END
     C                   END
     C**
     C** VALIDATION OF THE 'APPROVING LIMIT' FIELD
     C**
     C**  Only if 'Approving Limit' Field is displayed
     C     *IN48         IFEQ      '0'
     C                   EVAL      PZFIELD = APLIM
     C                   EXSR      SRZAlign
     C**********         IF        PZAlignOk = 'N'                                           BUG2597
     C                   IF        PZRTN = '*ERROR*'                                         BUG2597
     C                   MOVE      '1'           *IN73
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 128'        ERR(Z)
     C                   ELSE
     C                   MOVE      PZFIELD       APLIM1           15
     C                   END
     C                   END
     C**
     C** VALIDATION OF THE 'AUTHORISING LIMIT' FIELD
     C**
     C**  Only if 'Authorising Limit' Field is displayed
     C     *IN47         IFEQ      '0'
     C                   EVAL      PZFIELD = AULIM
     C                   EXSR      SRZAlign
     C**********         IF        PZAlignOk = 'N'                                           BUG2597
     C                   IF        PZRTN = '*ERROR*'                                         BUG2597
     C                   MOVE      '1'           *IN74
     C                   MOVE      '1'           *IN80
     C                   ADD       1             Z
     C                   MOVE      ' 129'        ERR(Z)
     C                   ELSE
     C                   MOVE      PZFIELD       AULIM1           15
     C                   END
     C                   END
     C                   END
     C**
     C**   OUTPUT QUEUE FOR CHEQUES MUST HAVE NO EMBEDDED BLANKS
     C**
     C     *IN67         IFEQ      '1'
     C     SCOUTQ        IFNE      *BLANK
     C                   Z-ADD     1             X
     C                   MOVEA     SCOUTQ        CHK
     C     X             DOWLE     10
     C     CHK(X)        IFNE      ' '
     C     *IN75         IFEQ      '1'
     C                   MOVE      '1'           *IN16
     C                   MOVEA     '11'          *IN(79)
     C                   ADD       1             Z
     C                   MOVE      ' 130'        ERR(Z)
     C                   Z-ADD     10            X
     C                   END
     C                   ELSE
     C                   MOVE      '1'           *IN75
     C                   END
     C                   ADD       1             X
     C                   END
     C                   END
     C                   END
      *
      ** Validation for Security on journal entry
      *
     C     CGL008        IFEQ      'Y'
     C                   MOVE      *BLANKS       WUPDAT
     C                   MOVE      REFFLG        WREFLG            1
      *
      ** Validate if user has authority to all account codes for
      ** journal entry input
      *
     C     SJEAA         IFNE      'Y'
     C     SJEAA         ANDNE     'N'
     C     SJEAA         ANDNE     *BLANKS
     C                   ADD       1             Z
     C                   MOVEL     ' 140'        ERR(Z)
     C                   MOVEA     '11'          *IN(79)
     C                   MOVE      *ON           *IN08
     C                   ENDIF
      *
     C     SJEAA         IFEQ      *BLANKS
     C                   MOVE      'N'           SJEAA
     C                   ENDIF
      *
      ** Validate Reference User.
      *
     C     SREFU         IFNE      *BLANKS
     C     SREFU         ANDNE     SUSER
      *
      ** If User is a reference user for other users, can not amend
      ** reference user field
      *
     C     REFFLG        IFEQ      'Y'
     C     SREFU         ANDNE     WREFU
     C                   ADD       1             Z
     C                   MOVEL     ' 145'        ERR(Z)
     C                   MOVEA     '11'          *IN(79)
     C                   MOVE      *ON           *IN09
     C                   ELSE
      *
     C     SREFU         CHAIN     MUSERDDF                           88
      *
      ** If Reference User is invalid, send error message
      *
     C     *IN88         IFEQ      *ON
     C                   ADD       1             Z
     C                   MOVEL     ' 141'        ERR(Z)
     C                   MOVEA     '11'          *IN(79)
     C                   MOVE      *ON           *IN09
     C                   ELSE
      *
      ** Check if Reference user is for other users
      *
     C     USRP          IFNE      REFUSR
     C     RECI          ANDEQ     'D'
     C                   ADD       1             Z
     C                   MOVEL     ' 142'        ERR(Z)
     C                   MOVEA     '11'          *IN(79)
     C                   MOVE      *ON           *IN09
     C                   ELSE
     C                   MOVE      'Y'           WUPDAT            1
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      *
      ** Reference Flag for the inserted user profile
      *
     C                   ELSE
     C                   MOVEL     SUSER         SREFU
     C                   ENDIF
      *
      ** If reference user field is amended to be blank and there are
      ** no other users with this reference user, update MUSERDD for
      ** the reference user with 'Ref. User Flag' = 'N'
      *
     C     SREFU         IFEQ      SUSER
     C     *IN23         ANDEQ     *ON
      *
     C     WREFU         SETLL     MUSERD1
     C     WREFU         READE     MUSERD1                                06
     C                   MOVE      '0'           WFLG              1
      *
     C     *IN06         DOWEQ     *OFF
     C     USRP          IFNE      REFUSR
     C     RECI          ANDEQ     'D'
     C     USRP          ANDNE     SUSER
     C                   MOVE      '1'           WFLG
     C                   ENDIF
     C     WREFU         READE     MUSERD1                                06
     C                   ENDDO
     C     WFLG          IFEQ      '0'
     C     WREFU         CHAIN     MUSERDDF                           88
                                                                                            BUG27952
      ** Update only when CHAIN is successful                                               BUG27952
                                                                                            BUG27952
     C                   IF        *IN88 = *OFF                                             BUG27952
     C                   MOVE      'N'           REFFLG
     C                   UPDATE    MUSERDDF
     C                   ENDIF                                                              BUG27952
     C                   ENDIF
      *
     C                   ENDIF
      *
      ** Validation for user batch authorisation
      *
     C     SALVL         IFNE      *BLANKS
     C     SALVL         ANDNE     'E'
     C     SALVL         ANDNE     'V'
     C     SALVL         ANDNE     'Z'
     C                   ADD       1             Z
     C                   MOVEL     ' 143'        ERR(Z)
     C                   MOVEA     '11'          *IN(79)
     C                   MOVE      *ON           *IN10
     C                   ENDIF
      *
     C     SALVL         IFEQ      *BLANKS
     C                   MOVE      'Z'           SALVL
     C                   ENDIF
      *
     C     SUSER         CHAIN     MUSERDDF                           88
      *
     C                   ENDIF
      *
      ** End of Validation Processing.
      *
      ** Override Profile                                                                     CSD086
      *                                                                                       CSD086
     C                   IF        SOVPR <> *BLANKS                                           CSD086
                                                                                              CSD086
      ** Go back to previous after overridable profile                                      BUG27689
      ** selection                                                                          BUG27689
                                                                                            BUG27689
     C                   IF        %SCAN('?' : SOVPR) <> *ZERO                              BUG27689
     C                   EVAL      OVPRFlg = 'Y'                                            BUG27689
     C                   ENDIF                                                              BUG27689
                                                                                            BUG27689
     C                   CALL      'GPAOOVPRR0'                                               CSD086
     C                   PARM      *BLANKS       PRtcd                                        CSD086
     C                   PARM      '*KEY   '     POptn                                        CSD086
     C                   PARM                    SOVPR                                        CSD086
     C                   PARM                    SZONE                                      BUG27504
     C     GPOVPR        PARM      GPOVPR        DSFDY                                        CSD086
                                                                                              CSD086
     C                   IF        PRtcd <> *BLANKS                                           CSD086
     C                   EVAL      *IN79 = *ON                                                CSD086
     C                   EVAL      *IN80 = *ON                                                CSD086
     C                   EVAL      *IN84 = *ON                                                CSD086
     C                   EVAL      Z = Z + 1                                                  CSD086
     C                   EVAL      ERR(Z) = ' 146'                                            CSD086
     C                   EVAL      ERMS = MSG(22)                                             CSD086
     C                   ELSE                                                                 CSD086
     C                   EVAL      SOVPR = A1OVPR                                             CSD086
     C                   ENDIF                                                                CSD086
     C                   ENDIF                                                                CSD086
      *                                                                                       CSD086
     C     *IN80         IFEQ      '1'
     C                   MOVEA     ERR           ERCD
     C     *IN79         IFEQ      '0'
     C     SCNSAV        IFEQ      SCNDTA
     C                   MOVE      '0'           *IN80
     C                   ELSE
     C     *LIKE         DEFINE    SCNDTA        SCNSAV
     C                   MOVE      SCNDTA        SCNSAV
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       SCNSAV
     C                   END
     C                   END
     C**
     C                   MOVE      *IN80         *IN21
     C**
     C                   ENDSR
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**                                                                **
     C**  INSTSR SR. TO INSERT A RECORD ON PF/MUSERDD                   **
     C**             CALLED FROM : SR. DETLSC                           **
     C**             CALLS       : SR. RTRNSC                           **
     C**                                                                **
     C********************************************************************
     C     INSTSR        BEGSR
      *
     C                   MOVE      'D'           RECIDD
     C                   Z-ADD     RUNDD         LCD
     C                   MOVE      SACTN         CHTP
     C                   TIME                    TIMEP             6 0
     C                   Z-ADD     TIMEP         LCT
     C                   MOVEL     SCNDTA        OUTFLD
     C                   Z-ADD     0             SOCNT
     C                   MOVEL     '0'           LPWT
     C                   Z-ADD     0             LPWD
     C                   MOVE      SDIRID        DIRID
     C                   MOVE      SDIRAD        DIRAD
     C                   MOVEL     MULTA         MULT
     C                   MOVE      ENLIM1        ENTL
     C                   MOVE      APLIM1        AUT1
     C                   MOVE      AULIM1        AUT2
     C                   MOVE      SCOUTQ        COUTQ
     C                   Z-ADD     0             TIMO
     C     CGL008        IFEQ      'Y'
     C                   MOVEL     SJEAA         ALACOD
     C                   MOVEL     SREFU         REFUSR
     C                   MOVEL     SALVL         USRLVL
     C                   MOVEL     WREFLG        REFFLG
     C                   ENDIF
      *                                                                                       CSD086
     C                   EVAL      OVPR = SOVPR                                               CSD086
      *
     C     *IN65         IFEQ      '1'
     C/COPY WNCPYSRC,SFH00129
     C                   UPDATE    MUSERDDF
     C/COPY WNCPYSRC,SFH00130
     C                   ELSE
     C/COPY WNCPYSRC,SFH00131
     C                   WRITE     MUSERDDF                             69
     C/COPY WNCPYSRC,SFH00132
     C                   END
     C/COPY WNCPYSRC,SFH00133
      *
      ** Update Reference Flag for Reference User
      *
     C     CGL008        IFEQ      'Y'
     C     WUPDAT        ANDEQ     'Y'
     C     SREFU         CHAIN     MUSERDDF                           06
                                                                                            BUG27952
      ** Update only when CHAIN is successful                                               BUG27952
                                                                                            BUG27952
     C                   IF        *IN06 = *OFF                                             BUG27952
     C                   MOVE      'Y'           REFFLG
     C                   UPDATE    MUSERDDF
     C                   ENDIF                                                              BUG27952
     C                   ENDIF
      *
     C     *IN69         IFEQ      '1'
     C                   MOVEL     MSG(5)        ERMS
      *
     C                   ELSE
      *
     C     SUSER         CHAIN     MUSER                              8886
      *
      ** Should always update trailer file at insert of user.
      *
     C     1             CHAIN     MUSERZZF                           85
      *
     C     *IN85         IFEQ      '1'
     C                   MOVE      'Z'           RECIZZ
     C                   Z-ADD     1             NORE
     C                   WRITE     MUSERZZF
     C                   ELSE
     C                   ADD       1             NORE
     C                   UPDATE    MUSERZZF
     C                   END
      *
     C     *IN86         IFEQ      '1'
     C     *IN88         OREQ      '1'
     C     CYYRQ         IFNE      '     '
     C                   MOVEL     MSG(5)        ERMS
     C                   SETON                                        69
     C                   END
     C                   END
      *
     C                   END
      *
     C/COPY WNCPYSRC,SFH00134
     C                   EXSR      RTRNSC
      *
     C                   ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**                                                                **
     C**  AMNDSR SR. TO AMEND A RECORD ON PF/MUSERDD                    **
     C**             CALLED FROM : SR. DETLSC                           **
     C**             CALLS       : SR. RTRNSC                           **
     C**                                                                **
     C********************************************************************
     C     AMNDSR        BEGSR
     C**
     C                   MOVE      'D'           RECIDD
     C                   Z-ADD     RUNDD         LCD
     C                   MOVE      SACTN         CHTP
     C                   TIME                    TIMEP             6 0
     C                   Z-ADD     TIMEP         LCT
     C                   MOVEL     SCNDTA        OUTFLD
     C                   MOVE      SDIRID        DIRID
     C                   MOVE      SDIRAD        DIRAD
     C                   MOVEL     MULTA         MULT
     C                   MOVE      ENLIM1        ENTL
     C                   MOVE      APLIM1        AUT1
     C                   MOVE      AULIM1        AUT2
     C                   MOVE      SCOUTQ        COUTQ
     C     CGL008        IFEQ      'Y'
     C                   MOVEL     SJEAA         ALACOD
     C                   MOVEL     SREFU         REFUSR
     C                   MOVEL     SALVL         USRLVL
     C                   MOVEL     WREFLG        REFFLG
     C                   ENDIF
      *                                                                                       CSD086
     C                   EVAL      OVPR = SOVPR                                               CSD086
      *
     C/COPY WNCPYSRC,SFH00135
     C                   UPDATE    MUSERDDF
     C/COPY WNCPYSRC,SFH00136
      *
      ** If Reference User is valid, update MUSERDD for the reference
      ** user flag
      *
     C     CGL008        IFEQ      'Y'
     C     WUPDAT        ANDEQ     'Y'
     C     SREFU         CHAIN     MUSERDDF                           06
     C                   MOVE      'Y'           REFFLG
     C                   UPDATE    MUSERDDF
     C                   ENDIF
      *
     C     SUSER         CHAIN     MUSER                              8886
      *
     C     *IN86         IFEQ      '1'
     C     *IN88         OREQ      '1'
     C     CYYRQ         IFNE      '     '
      *
     C                   MOVEL     MSG(5)        ERMS
     C                   SETON                                        69
     C                   END
     C                   END
      *
     C/COPY WNCPYSRC,SFH00137
     C                   EXSR      RTRNSC
      *
     C                   ENDSR
      *
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C**  RJUST SR - To right-justify an input value
     C*
     C*   CALLED BY - DETLSC
     C*
     C*   CALLS     - NONE
     C*
     C*   FIELDS USED - @VAL  - Value to be right-justified
     C*               - @POS1 - First character of value
     C*                 @POS4 - Fourth character of value
     C*                 @FST2 - First two characters of input value
     C*                 @FST3 - First three characters of input value
     C*                 @LST2 - Last two characters of input value
     C*                 @LST3 - Last three characters of input value
     C*                 SREFP - Screen refresh period
     C*
     C********************************************************************
      *
     C     RJUST         BEGSR
      *
     C     SREFP         IFEQ      *BLANKS
     C                   MOVE      '0000'        SREFP
     C                   END
      *
     C                   MOVE      SREFP         @VAL
      *
     C     @FST3         IFEQ      *BLANKS
     C                   MOVEL     '000'         SREFP
     C                   END
      *
     C     @FST2         IFEQ      *BLANKS
     C                   MOVEL     '00'          SREFP
     C                   END
      *
     C     @POS1         IFEQ      *BLANK
     C                   MOVEL     '0'           SREFP
     C                   END
      *
     C                   MOVE      SREFP         @VAL
     C*
     C     @LST3         IFEQ      *BLANK
     C                   MOVE      *ZEROS        SREFP
     C                   MOVE      @POS1         SREFP
     C                   ELSE
     C     @LST2         IFEQ      *BLANK
     C                   MOVE      *ZEROS        SREFP
     C                   MOVE      @FST2         SREFP
     C                   ELSE
     C     @POS4         IFEQ      *BLANK
     C                   MOVE      *ZEROS        SREFP
     C                   MOVE      @FST3         SREFP
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**                                                                **
     C**  ENQSR SR. TO SET UP FIELDS FOR ENQUIRY                        **
     C**            CALLED FROM : SR. DSCRN                             **
     C**                                                                **
     C********************************************************************
     C     ENQSR         BEGSR
      *
     C                   MOVE      *BLANKS       SCNDTA
     C                   MOVE      ' '           SACTN
     C                   MOVE      '      '      SXXRQ
     C*
     C                   MOVE      '0'           *IN21
     C                   MOVEA     '00000'       *IN(23)
     C                   MOVEA     '00'          *IN(79)
     C                   MOVE      '0'           *INKL
     C                   MOVEA     '0000000'     *IN(30)
     C                   MOVEA     '000'         *IN(08)
     C                   MOVE      *BLANKS       ERR
     C                   MOVE      *BLANKS       ERCD
     C                   MOVE      *BLANKS       ERMS
      *
     C                   ENDSR
     C********************************************************************
     C/EJECT
      ********************************************************************
      *                                                                  *
      *   DELREC SR. TO DELETE USER'S OTHER DETAILS                      *
      *              AND TO FLAG AN MUSER RECORD FOR DELETION            *
      *              CALLED FROM : MAIN PROCESSING                       *
      *              CALLS       : SF000028                              *
      *                            SR. RTRNSC                            *
      *                                                                  *
      ********************************************************************
     C     DELREC        BEGSR
     C                   CALL      'SF000028'
     C                   PARM                    USRPRF
     C                   PARM                    RUNDD
     C                   PARM                    MBRIND
     C                   PARM                    OBRIND
     C/COPY WNCPYSRC,SFH00138
     C                   MOVE      'C'           RECIDD
     C                   Z-ADD     RUNDD         LCD
     C                   MOVE      SACTN         CHTP
     C                   TIME                    TIMEP             6 0
     C                   Z-ADD     TIMEP         LCT
     C/COPY WNCPYSRC,SFH00139
     C                   UPDATE    MUSERDDF
      *
      ** If there are no reference user, update reference flag
      *
     C     CGL008        IFEQ      'Y'
      *
     C     WREFU         SETLL     MUSERD1
     C     WREFU         READE     MUSERD1                                07
     C                   MOVE      *BLANKS       WREF2             1
      *
     C     *IN07         DOWEQ     *OFF
     C     USRP          IFNE      REFUSR
     C     RECI          ANDEQ     'D'
     C                   MOVE      'Y'           WREF2
     C                   ENDIF
     C     WREFU         READE     MUSERD1                                07
     C                   ENDDO
      *
     C     WREF2         IFNE      'Y'
     C     WREFU         CHAIN     MUSERDDF                           88
     C     *IN88         IFEQ      *OFF
     C                   MOVE      'N'           REFFLG
     C                   UPDATE    MUSERDDF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      *
      ** MUSERZZ should be updated with one less record so that it
      ** keeps track of all LIVE records on MUSERDD.
      *
     C     1             CHAIN     MUSERZZF                           85
     C                   SUB       1             NORE
     C                   UPDATE    MUSERZZF
      *
      ** Commit the file after this action.                                                   242254
     C                   COMMIT                                                               242254
      *
     C/COPY WNCPYSRC,SFH00140
     C                   EXSR      RTRNSC
      *
     C                   ENDSR
     C********************************************************************
      *                                                                  *
      *   CHKDIR SR. TO DELETE USER'S ENTRY ON DIRECOTRY                 *
      *              AND TO ALLOW FOR ERROR PROCESSING                   *
      *              CALLED FROM : MAIN PROCESSING                       *
      *              CALLS       : SFC0030                               *
      *                                                                  *
     C********************************************************************
     C     CHKDIR        BEGSR
      *
     C                   MOVE      SMUSR         SMUSR1           50
      *
     C                   CALL      'SFC0030'
     C                   PARM                    ACTCDE
     C                   PARM                    ERRCD             1
     C                   PARM                    SUSER
     C                   PARM                    SMUSR1
     C                   PARM                    SDIRID
     C                   PARM                    SDIRAD
      *
     C                   ENDSR
      *****************************************************************
      *                                                               *
      *  SrCvtAmt - Convert Amount before printing                    *
      *                                                               *
      *****************************************************************
 
     C     SrCvtAmt      BEGSR
 
     C                   CALL      'ZSEDIT'
     C                   PARM                    PFld15
     C                   PARM                    PDecs
     C                   PARM                    PECode
     C                   PARM                    POut21
 
     C                   ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      * SRZAlign  - Align and validate field                          *
      *                                                               *
      *****************************************************************
     C     SRZAlign      BEGSR
 
     C                   CALL      'ZALIGN'
 
      ** Align OK Flag
      ** Input/output field
      ** Decimal places
      ** Number of digits
 
     C**********         PARM      *BLANKS       PZAlignOk                                   BUG2597
     C                   PARM      *BLANKS       PZRTN                                       BUG2597
     C                   PARM                    PZFIELD
     C                   PARM                    PZADEC
     C                   PARM                    PZADIG
     C                   PARM                    PZAFLD                                      BUG2597
 
     C                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************                      BUG2711
      *                                                               *                      BUG2711
      *  *PSSR - Program Exception Subroutine                         *                      BUG2711
      *                                                               *                      BUG2711
      *****************************************************************                      BUG2711
     C     *PSSR         BEGSR                                                               BUG2711
                                                                                             BUG2711
     C                   DUMP                                                                BUG2711
                                                                                             BUG2711
     C                   EVAL      *INU7 = *ON                                               BUG2711
     C                   EVAL      *INU8 = *ON                                               BUG2711
     C                   EVAL      *INLR = *ON                                               BUG2711
     C                   RETURN                                                              BUG2711
                                                                                             BUG2711
     C                   ENDSR                                                               BUG2711
      *****************************************************************                      BUG2711
      /EJECT                                                                                 BUG2711
      *****************************************************************                      BUG2711
      *                                                               *                      BUG2975
      *  SRSUSR - Handles user profile selection.                     *                      BUG2975
      *                                                               *                      BUG2975
      *****************************************************************                      BUG2975
     C     SRSUSR        BEGSR                                                               BUG2975
                                                                                             BUG2975
     C                   CALL      'AOGUSRR0'                                                BUG2975
     C                   PARM      *BLANKS       PRtCd                                       BUG2975
     C                   PARM      '*KEY   '     POptn                                       BUG2975
     C                   PARM      SZONE         PZone                                       BUG2975
     C                   PARM      SUSER         PUsrp                                       BUG2975
     C     GZMUSER       PARM      GZMUSER       DSSDY                                       BUG2975
                                                                                             BUG2975
     C                   IF        PRtCd = *BLANKS                                           BUG2975
     C                   EVAL      SUSER = GZUSRP                                            BUG2975
     C                   ELSE                                                                BUG2975
                                                                                             BUG2975
     C                   IF        PRtCd <> '*NOSEL '                                        BUG2975
     C     *LOCK         IN        LDA                                                       BUG2975
     C                   EVAL      DBFile = 'GZMUSERDD'                                      BUG2975
     C                   EVAL      DBKey = PZone + PUsrp                                     BUG2975
     C                   EVAL      DBase = 102                                               BUG2975
     C                   OUT       LDA                                                       BUG2975
     C                   EXSR      *PSSR                                                     BUG2975
     C                   ENDIF                                                               BUG2975
                                                                                             BUG2975
     C                   ENDIF                                                               BUG2975
                                                                                             BUG2975
     C                   ENDSR                                                               BUG2975
      *****************************************************************                      BUG2975
      /EJECT                                                                                 BUG2975
      *****************************************************************                      BUG2975
     C/COPY WNCPYSRC,SFH00141
     O**
     O**
     O**
     OMUSERDDF  E            MUSRRL
     O**
     O********************************************************************
** MSG  - ERROR MESSAGES ARRAY
A USER ALREADY EXISTS - INSERT NOT ALLOWED
A LIVE USER DOES NOT ALREADY EXIST - AMEND OR DELETE NOT ALLOWED
THERE IS NO RECORD OF THIS USER - ENQUIRE IS NOT ALLOWED
WARNING SOME OF THE MENU GROUP CODES DO NOT EXIST
USER BEING MAINTAINED BY ANOTHER WORKSTATION
CURRENT USER PROFILE NOT ELIGIBLE FOR DELETION
NOT AUTHORISED TO DELETE THIS USER
WARNING - DIRECTORY ENTRY NOT REMOVED - *SECADM AUTHORITY REQUIRED
CANNOT DELETE MIDAS USER
CANNOT DELETE USER WHO HAS OUTSTANDING REPORT REQUESTS
CANNOT DELETE USER WHO IS THE USER ID FOR OUTPUT FOR A REPORT REQUESTED
CANNOT DELETE USER WHO HAS REQUESTED PERIODIC REPORTS
CANNOT DELETE USER WHO IS USER ID FOR OUTPUT FOR PERIODIC REPORTS
DELETING USER IS BEING MAINTAINED BY ANOTHER WORKSTATION
COB USER FIELD MUST BE Y OR N
INSERT NOT ALLOWED. DETAILS OF THIS DELETED USER STILL EXIST AND MAY BE REACTIVATED.
REACTIVATION MAY BE ONLY ALLOWED IF DETAILS OF DELETED USER STILL EXIST.
TELLER IDENTIFIER NOT FOUND                                                                   TDA035
TELLER IDENTIFIER IS ALREADY ASSIGNED TO ANOTHER USER                                         TDA035
TELLER/BATCH CONTROL NOT FOUND                                                               BUG8574
USER EMPLOYEE NUMBER ALREADY EXISTS                                                         BUG11032
OVERRIDE PROFILE DOES NOT EXIST                                                               CSD086
     X/COPY WNCPYSRC,SFH00142
** TABLE - VALI
ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789#$_-@
