     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SF User maintenance set up data areas')
      *****************************************************************
      *                                                               *
      *  Midas SECURITY PROFILE FACILITY                              *
      *                                                               *
      *  SF0400 - MIDAS USERS MAINTENANCE : SETS UP USER DATA AREAS   *
      *                                                               *
      *  Function: This program sets up data areas for the user which *
      *            contain bank-level functions, booking branch,      *
      *            origination branch and company details.            *
      *                                                               *
      *  Where Used: Input Cycle                                      *
      *                                                               *
      *  Called By: SFC0400                                           *
      *                                                               *
      *  Calls: None                                                  *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *  Prev Amend No. CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 239898             Date 29May06               *
      *                 TDA035             Date 02Apr04               *
      *                 CAP084             Date 10Jul03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 197434             Date 09Oct01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAAA01             Date 08Mar95               *
      *                 S01117             Date 25Mar92               *
      *                  S01269              DATE 24JUN91             *
      *****************************************************************
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  239898 - Applied core fix BUG11032.                          *
      *  BUG11032 - Reporting About Users (Recompile)                 *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CAP084 - API Wrapper project                                 *
      *  197434 - Array index error on SF0021. Increase maximum       *
      *           number of branches from 100 to 900.                 *
      *    CAAA01 - GUI/400 development                               *
      *           - recompiled over changed MUSERDD                   *
      *    S01117 - RECOMPILE FOR FT CHANGE TO MUSERDD                *
      *    S01269 - RECOMPILE OVER CHANGED LF/MUSER                   *
      *****************************************************************
      *
     FMBRBS   IF  E           K        DISK
     FMBROS   IF  E           K        DISK
     FMCMPS   IF  E           K        DISK
     FMUSER   IF  E           K        DISK
      *
      *                 ************************
      *                  FUNCTION OF INDICATORS
      *                 ************************
      *
      * ID F  C  H  L
      *
      *      10         MUSER - CHAIN FAIL OR RECORD NOT LIVE
      *
      *      20         MBRBS - CHAIN FAIL OR RECORD NOT LIVE
      *      21         MBROS - CHAIN FAIL OR RECORD NOT LIVE
      *      22         MCMPS - CHAIN FAIL OR RECORD NOT LIVE
     F/EJECT
     E                    CPY@    1   1 80
     IWBRU        DS                                                                          197434
     I                                        1 150 WBB1                                      197434
     I                                      151 300 WBB2                                      197434
     I                                      301 555 WBB11                                     197434
     I                                      556 810 WBB12                                     197434
     I                                      8111065 WBB13                                     197434
     I                                     10661320 WBB14                                     197434
     I                                     13211575 WBB15                                     197434
     I                                     15761830 WBB16                                     197434
     I                                     18312085 WBB17                                     197434
     I                                     20862298 WBB18                                     197434
     I                                     22992553 WBB21                                     197434
     I                                     25542700 WBB22                                     197434
      *                                                                                       197434
      ** Working Data Structure for ZBRU                                                      197434
      *                                                                                       197434
     IWOBU        DS                                                                          197434
     I                                        1 150 WOB1                                      197434
     I                                      151 300 WOB2                                      197434
     I                                      301 555 WOB11                                     197434
     I                                      556 810 WOB12                                     197434
     I                                      8111065 WOB13                                     197434
     I                                     10661320 WOB14                                     197434
     I                                     13211575 WOB15                                     197434
     I                                     15761830 WOB16                                     197434
     I                                     18312085 WOB17                                     197434
     I                                     20862298 WOB18                                     197434
     I                                     22992553 WOB21                                     197434
     I                                     25542700 WOB22                                     197434
      *                                                                                       197434
      ** Working Data Structure for ZOBU                                                      197434
      *                                                                                       197434
     IZBRU       UDS
     I**   BANK LEVEL FUNCTIONS / BOOKING BRANCHES
     I                                        1   1 ZCHB
     I                                        2   4 ZINB
     I                                        5 154 ZBB1
     I                                      155 304 ZBB2
     IZBRU1      UDS                                                                          197434
      *                                                                                       197434
      ** Bank Level Functions / Booking Branches 1                                            197434
      *                                                                                       197434
     I                                        1 255 ZBB11                                     197434
     I                                      256 510 ZBB12                                     197434
     I                                      511 765 ZBB13                                     197434
     I                                      7661020 ZBB14                                     197434
     I                                     10211275 ZBB15                                     197434
     I                                     12761530 ZBB16                                     197434
     I                                     15311785 ZBB17                                     197434
     I                                     17861998 ZBB18                                     197434
     IZBRU2      UDS                                                                          197434
      *                                                                                       197434
      ** Bank Level Functions / Booking Branches 2                                            197434
      *                                                                                       197434
     I                                        1 255 ZBB21                                     197434
     I                                      256 402 ZBB22                                     197434
     IZOBU       UDS
     I**   ORIGINATING BRANCHES
     I                                        1   1 ZCHO
     I                                        2   4 ZINO
     I                                        5 154 ZOB1
     I                                      155 304 ZOB2
     IZOBU1      UDS                                                                          197434
      *                                                                                       197434
      ** Originating Branches 1                                                               197434
      *                                                                                       197434
     I                                        1 255 ZOB11                                     197434
     I                                      256 510 ZOB12                                     197434
     I                                      511 765 ZOB13                                     197434
     I                                      7661020 ZOB14                                     197434
     I                                     10211275 ZOB15                                     197434
     I                                     12761530 ZOB16                                     197434
     I                                     15311785 ZOB17                                     197434
     I                                     17861998 ZOB18                                     197434
     IZOBU2      UDS                                                                          197434
      *                                                                                       197434
      ** Originating Branches 2                                                               197434
      *                                                                                       197434
     I                                        1 255 ZOB21                                     197434
     I                                      256 402 ZOB22                                     197434
     IZCMP       UDS
     I**   COMPANIES
     I                                        1   1 ZCHC
     I                                        2   4 ZINC
     I                                        5 154 ZCO1
     I                                      155 304 ZCO2
      *                                                                                       CAP084
      ** External data area for user name                                                     CAP084
     IZMUSER      DS                             17                                           CAP084
     I                                        1  10 ZMUSR                                     CAP084
     I**
     IPSDS       SDS
     I                                      254 263 USRID
     I/EJECT
     C                     MOVEACPY@      BIS@   80
      *                                                                                       CAP084
      ** If ZMUSER exists, use the name from that, otherwise use the PSDS                     CAP084
     C           *NAMVAR   DEFN           ZMUSER                                              CAP084
     C                     IN   ZMUSER                 99                                     CAP084
     C           *IN99     IFEQ '0'                                                           CAP084
     C                     UNLCKZMUSER                                                        CAP084
     C                     ENDIF                                                              CAP084
      *                                                                                       CAP084
     C           ZMUSR     IFNE *BLANKS                                                       CAP084
     C                     MOVELZMUSR     USRID                                               CAP084
     C                     ENDIF                                                              CAP084
     C**
     C**   BANK LEVEL FUNCTIONS
     C**
     C           USRID     CHAINMUSERDDF             10
     C  N10      RECI      COMP 'D'                  1010
     C**
     C           *IN10     IFEQ '0'
     C                     MOVE BANK      ZCHB
     C                     END
     C**
     C           ZCHB      IFEQ ' '
     C                     MOVE 'D'       ZCHB
     C                     END
     C**
     C**   BOOKING BRANCHES
     C**
     C           USRID     CHAINMBRBSDDF             20
     C  N20      RECI      COMP 'D'                  2020
     C**N20***** VBRA      COMP *BLANK                   20                                   197434
     C  N20      VBRX      COMP *BLANK                   20                                   197434
     C**
     C           *IN20     IFEQ '1'
     C**********           MOVE '100'     ZINB                                                197434
     C                     MOVE '900'     ZINB                                                197434
     C                     MOVE *BLANK    ZBB1
     C                     MOVE *BLANK    ZBB2
     C                     MOVE *BLANK    ZBB11                                               197434
     C                     MOVE *BLANK    ZBB12                                               197434
     C                     MOVE *BLANK    ZBB13                                               197434
     C                     MOVE *BLANK    ZBB14                                               197434
     C                     MOVE *BLANK    ZBB15                                               197434
     C                     MOVE *BLANK    ZBB16                                               197434
     C                     MOVE *BLANK    ZBB17                                               197434
     C                     MOVE *BLANK    ZBB18                                               197434
     C                     MOVE *BLANK    ZBB21                                               197434
     C                     MOVE *BLANK    ZBB22                                               197434
     C**
     C                     ELSE
     C**********           MOVELVBRA      ZBB1                                                197434
     C**********           MOVE VBRA      ZBB2                                                197434
     C********** 101       SUB  NOBR      IND     30                                          197434
      *                                                                                       197434
      ** Move VBRX to a working DS                                                            197434
     C                     MOVE VBRX      WBRU                                                197434
      *                                                                                       197434
      ** Move to the Data Areas : ZBRU, ZBRU1, ZBRU2                                          197434
     C                     MOVE WBB1      ZBB1                                                197434
     C                     MOVE WBB2      ZBB2                                                197434
     C                     MOVE WBB11     ZBB11                                               197434
     C                     MOVE WBB12     ZBB12                                               197434
     C                     MOVE WBB13     ZBB13                                               197434
     C                     MOVE WBB14     ZBB14                                               197434
     C                     MOVE WBB15     ZBB15                                               197434
     C                     MOVE WBB16     ZBB16                                               197434
     C                     MOVE WBB17     ZBB17                                               197434
     C                     MOVE WBB18     ZBB18                                               197434
     C                     MOVE WBB21     ZBB21                                               197434
     C                     MOVE WBB22     ZBB22                                               197434
     C           901       SUB  NOBR      IND     30                                          197434
     C                     MOVE IND       ZINB
     C                     END
     C**
     C**   ORIGINATING BRANCHES
     C**
     C                     MOVE 'D'       ZCHO
     C**
     C           USRID     CHAINMBROSDDF             21
     C  N21      RECI      COMP 'D'                  2121
     C**N21***** VBRA      COMP *BLANK                   21                                   197434
     C  N21      VBRX      COMP *BLANK                   21                                   197434
     C**
     C           *IN21     IFEQ '1'
     C**********           MOVE '100'     ZINO                                                197434
     C                     MOVE '900'     ZINO                                                197434
     C                     MOVE *BLANK    ZOB1
     C                     MOVE *BLANK    ZOB2
     C                     MOVE *BLANK    ZOB11                                               197434
     C                     MOVE *BLANK    ZOB12                                               197434
     C                     MOVE *BLANK    ZOB13                                               197434
     C                     MOVE *BLANK    ZOB14                                               197434
     C                     MOVE *BLANK    ZOB15                                               197434
     C                     MOVE *BLANK    ZOB16                                               197434
     C                     MOVE *BLANK    ZOB17                                               197434
     C                     MOVE *BLANK    ZOB18                                               197434
     C                     MOVE *BLANK    ZOB21                                               197434
     C                     MOVE *BLANK    ZOB22                                               197434
     C**
     C                     ELSE
     C**********           MOVELVBRA      ZOB1                                                197434
     C**********           MOVE VBRA      ZOB2                                                197434
     C********** 101       SUB  NOBR      IND                                                 197434
      *                                                                                       197434
      ** Move VBRX to a working DS                                                            197434
      *                                                                                       197434
     C                     MOVE VBRX      WOBU                                                197434
      *                                                                                       197434
      ** Move to the Data Areas : ZOBU, ZOBU1, ZOBU2                                          197434
      *                                                                                       197434
     C                     MOVE WOB1      ZOB1                                                197434
     C                     MOVE WOB2      ZOB2                                                197434
     C                     MOVE WOB11     ZOB11                                               197434
     C                     MOVE WOB12     ZOB12                                               197434
     C                     MOVE WOB13     ZOB13                                               197434
     C                     MOVE WOB14     ZOB14                                               197434
     C                     MOVE WOB15     ZOB15                                               197434
     C                     MOVE WOB16     ZOB16                                               197434
     C                     MOVE WOB17     ZOB17                                               197434
     C                     MOVE WOB18     ZOB18                                               197434
     C                     MOVE WOB21     ZOB21                                               197434
     C                     MOVE WOB22     ZOB22                                               197434
     C           901       SUB  NOBR      IND     30                                          197434
     C                     MOVE IND       ZINO
     C                     END
     C**
     C**   COMPANIES
     C**
     C                     MOVE 'D'       ZCHC
     C**
     C           USRID     CHAINMCMPSDDF             22
     C  N22      RECI      COMP 'D'                  2222
     C  N22      VCMP      COMP *BLANK                   22
     C**
     C           *IN22     IFEQ '1'
     C                     MOVE '100'     ZINC
     C                     MOVE *BLANK    ZCO1
     C                     MOVE *BLANK    ZCO2
     C**
     C                     ELSE
     C                     MOVELVCMP      ZCO1
     C                     MOVE VCMP      ZCO2
     C*****      101       SUB  NOCO      IND                             SO1117
     C           101       SUB  NOOC      IND                             SO1117
     C                     MOVE IND       ZINC
     C                     END
     C**
     C                     SETON                     LR
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
