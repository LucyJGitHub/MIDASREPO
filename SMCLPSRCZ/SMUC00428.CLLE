/*********************************************************************/
/*STD    CLPBASEBND                                                  */
/*EXI    TEXT('BA3100 Migration Program')                            */
/*********************************************************************/
/*                                                                   */
/*       Midas - Implementation Module                               */
/*                                                                   */
/*       SMUC00428 - Migration Program for BA3100                    */
/*                   EML100_Target2Nostro to Target2Nostro           */
/*                                                                   */
/*       (c) Finastra International Limited 2022                     */
/*                                                                   */
/*       Last Amend No. BA3100  *CREATE     Date 01Sep22             */
/*       Prev Amend No. nnnnnn              Date ddmmmyy             */
/*                                                                   */
/*-------------------------------------------------------------------*/
/*                                                                   */
/*       BA3100 - MT103 and MT202 message details changes for        */
/*                Target 2 RTGS System                               */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&STM_STR) TYPE(*CHAR) LEN(80)

             COPYRIGHT TEXT('(c) Finastra International Limited +
                          2022')

/** Global monitor message.  */
             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
                          CMDLBL(ERROR))

             SNDPGMMSG  MSG('SMUC00428 - BA3100') TOMSGQ(MRUNQ)

             CHGJOB     SWS(XXXXXX00)

/** Create and rename temporary source file for RUNSQLSTM. */
             DLTF       FILE(QTEMP/RUNSQLSTM)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/RUNSQL)
             MONMSG     MSGID(CPF0000)
             CRTSRCPF   FILE(QTEMP/RUNSQLSTM) RCDLEN(112) +
                          MBR(RUNSQLSTM) TEXT('Temporary source +
                          file for GPCDROPCOL')
             RNMOBJ     OBJ(QTEMP/RUNSQLSTM) OBJTYPE(*FILE) +
                          NEWOBJ(RUNSQL)

/** Process migration program */
             CHGVAR     VAR(&STM_STR) VALUE('insert into SCSRSXTD +
                          (AXSARN, AXMODE) values(''BA3100'',''B'')')

             CALL       PGM(UTWRTSQL) PARM(&STM_STR '*CLEAR')
             RUNSQLSTM  SRCFILE(QTEMP/RUNSQL) SRCMBR(RUNSQLSTM) +
                          COMMIT(*NONE)
             MONMSG     MSGID(SQL9010)

             CHGVAR     VAR(&STM_STR) VALUE('insert into SCSRVXTD +
                          (GSSVAL, GSSARN, GSAVAL, GSMODE) +
                          values(''Target2Nostro'', ''BA3100'', ''Y'', ''B'')')

             CALL       PGM(UTWRTSQL) PARM(&STM_STR '*CLEAR')
             RUNSQLSTM  SRCFILE(QTEMP/RUNSQL) SRCMBR(RUNSQLSTM) +
                          COMMIT(*NONE)
             MONMSG     MSGID(SQL9010)

             CHGVAR     VAR(&STM_STR) VALUE('insert into SDSVLXTD +
                          (GISVAL, GIVAL, GILCT, GIMODE) +
                          values(''Target2Nostro'', ''01'', ''I'', ''B'')')

             CALL       PGM(UTWRTSQL) PARM(&STM_STR '*CLEAR')
             RUNSQLSTM  SRCFILE(QTEMP/RUNSQL) SRCMBR(RUNSQLSTM) +
                          COMMIT(*NONE)
             MONMSG     MSGID(SQL9010)

             CHGVAR     VAR(&STM_STR) VALUE('insert into SDSVRXTD +
                          (GJRECI, GJSVAL, GJSEQ, GJVDTA) +
                          values(''H'' ''Target2Nostro'', ''001'', ''*RANGE'')')

             CALL       PGM(UTWRTSQL) PARM(&STM_STR '*CLEAR')
             RUNSQLSTM  SRCFILE(QTEMP/RUNSQL) SRCMBR(RUNSQLSTM) +
                          COMMIT(*NONE)
             MONMSG     MSGID(SQL9010)

             CHGVAR     VAR(&STM_STR) VALUE('insert into SDSVRXTD +
                          (GJRECI, GJSVAL, GJSEQ, GJVDTA) +
                          values(''D'' ''Target2Nostro'', ''001'', ''01'')')

             CALL       PGM(UTWRTSQL) PARM(&STM_STR '*CLEAR')
             RUNSQLSTM  SRCFILE(QTEMP/RUNSQL) SRCMBR(RUNSQLSTM) +
                          COMMIT(*NONE)
             MONMSG     MSGID(SQL9010)

             CHGVAR     VAR(&STM_STR) VALUE('insert into SDSVRXTD +
                          (GJRECI, GJSVAL, GJSEQ, GJVDTA) +
                          values(''D'' ''Target2Nostro'', ''001'', ''99'')')

             CALL       PGM(UTWRTSQL) PARM(&STM_STR '*CLEAR')
             RUNSQLSTM  SRCFILE(QTEMP/RUNSQL) SRCMBR(RUNSQLSTM) +
                          COMMIT(*NONE)
             MONMSG     MSGID(SQL9010)

             GOTO       CMDLBL(ENDPGM)

ERROR:


             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Program +
                          SMUC00428 ended abnormally - see joblog +
                          ') TOMSGQ(MOPERQ)
             CHGJOB     SWS(XXXXXX11)

ENDPGM:

             ENDPGM


