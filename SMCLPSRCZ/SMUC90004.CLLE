/*********************************************************************/
/*STD    CLPBASEBND                                                  */
/*EXI    TEXT('CL Program to add job sched for ERC000110 job')       */
/*********************************************************************/
/*                                                                   */
/*       Midas - Implementation Module                               */
/*                                                                   */
/*       SMUC90004 - CL program to add job sched for ERC000110 job   */
/*                                                                   */
/*       (c) Finastra International Limited 2022                     */
/*                                                                   */
/*       Last Amend No. MD058462  *CREATE  Date 04Jul22              */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*       MD058462 - KWG24 Answerback processing was automated in M+  */
/*                  using program ERC000110. This program            */
/*                  (or equivalent) should be made available for     */
/*                  Fusion Midas.                                    */
/*                                                                   */
/*********************************************************************/
             PGM
/**/
             DCL        VAR(&PREF) TYPE(*CHAR) LEN(2)
             DCL        VAR(&XLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRTCD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PFMT) TYPE(*CHAR) LEN(200)
             DCL        VAR(&PSARD) TYPE(*CHAR) LEN(6)
             DCL        VAR(&POPTN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&CPYFLD) TYPE(*CHAR) LEN(64) VALUE('(c) Finastra +
                          International Limited 2022')
/**/
/* Global monitor message */
/**/
             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
                          CMDLBL(ABNOR1))
/**/
/* Start of program */

/** Check if SAR CER047 is installed */

             CHGVAR     VAR(&PRTCD) VALUE('       ')
             CHGVAR     VAR(&POPTN) VALUE('*VERIFY')
             CHGVAR     VAR(&PSARD) VALUE('CER047')
             CALL       PGM(AOSARDR0) PARM(&PRTCD &POPTN &PSARD &PFMT)

/** If an error ocurred  */

             IF         COND((&PRTCD *NE '       ') *AND (&PRTCD *NE +
                          '*NRF    ')) THEN(DO)
               SNDPGMMSG  MSG('AOSARDR0 - Program Error') +
                TOMSGQ(MOPERQ)
               CHGJOB     SWS('XXXXXX11')
               GOTO       CMDLBL(END)
             ENDDO

/** If CER047 is OFF, end program */

             IF         COND(&PRTCD *NE '       ') THEN(DO)
               GOTO       CMDLBL(END)
             ENDDO

/**/
/* Get system prefix */
/**/

             RTVJOBA    USER(&USER)

             RTVDTAARA  DTAARA(SDSTAT (6 2)) RTNVAR(&PREF)
             CHGVAR     VAR(&XLIB) VALUE(&PREF *TCAT 'XLIB')

             ADDJOBSCDE JOB(ERC000110) CMD(CALL PGM(ERC000110)) +
                          FRQ(*WEEKLY) SCDDATE(*NONE) SCDDAY(*MON +
                          *TUE *WED *THU *FRI) SCDTIME('07:30:00') +
                          JOBD(&XLIB/BULKTJOBD) JOBQ(*JOBD) +
                          USER(&USER)

              MONMSG     MSGID(CPF1633) EXEC(DO)
                GOTO       CMDLBL(ABNOR)
              ENDDO

             GOTO       CMDLBL(END)

/**/
/* Abnormal Termination of the program */
/**/
ABNOR:

 ABNOR1:     SNDPGMMSG  MSG('Error occurred in SMUC90004 program') TOPGMQ(*EXT) +
                          TOMSGQ(MOPERQ MRUNQ)

 END:        CHGVAR     VAR(&CPYFLD) VALUE('(c) Finastra International Limited +
                          2022')
             SNDPGMMSG  MSG('End of SMUC90004') TOMSGQ(MRUNQ MOPERQ)
             ENDPGM
