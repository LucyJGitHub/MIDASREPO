000100200529/*********************************************************************/
000200200529/*STD    SVPBASE                                                     */
000300200529/*EXI    MODULE(FT000980     FT000981    FT000982    FT000983        */
000400200529/*EXI           FT000984     FT000985    FT000652    FTCALCRNG       */
000500200529/*EXI           FTCALCLEV    FTRTVLOC    FTTIMECHAR  FTOPAYAMD       */
000600200529/*EXI           FTOPAYRTV    FTOPAY3DT   FTOPAY1DT   FTOPAYUPD       */
000700200529/*EXI           FTOPAYBRW    FTOPAYCVT   FTOPAY1DP   FTOPAY2DP       */
000800200529/*EXI           FTOPAY3DP    FTOPAYRPB   FTOPAY4DP   FTOPAY5DP       */
000900200529/*EXI    ) SRCMBR(SP8FT0003) ACTGRP(*CALLER)                         */
001000200529/*EXI    TEXT('Midas SP FT non-kernel non-validation functions 3')   */
001100200529/*********************************************************************/
001200200529/*                                                                   */
001300200529/*       Midas - Service Program                                     */
001400200529/*                                                                   */
001500200529/*       SP8FT0003 - FT Core Non-kernel Non-validation Functions 3   */
001600200529/*                                                                   */
001700200529/*       (c) Finastra International Limited 2001                     */
001800200529/*                                                                   */
001900200529/*       THIS SERVICE PROGRAM IS FULL. DO NOT ADD ANY NEW MODULES.   */
002000200529/*                                                                   */
002100200604/*       Last Amend No. 250041             Date 22May20              */
002200200529/*       Prev Amend No. MD054037           Date 23Sep19              */
002300200529/*                      CSD102             Date 08Jan19              */
002400200529/*                      MD052529           Date 12Feb19              */
002500200529/*                      MD039094           Date 15May18              */
002600200529/*                      MD041294           Date 19Sep16              */
002700200529/*                      MD046248           Date 05Feb18              */
002800200529/*                      CDL099             Date 06Oct17              */
002900200529/*                      MD044588           Date 09Mar17              */
003000200529/*                      MD039986           Date 10Aug16              */
003100200529/*                      MD024011           Date 10Aug16              */
003200200529/*                      AR1090283          Date 10Aug16              */
003300200529/*                      MD035776           Date 10Sep15              */
003400200529/*                      MD033641           Date 08Apr15              */
003500200529/*                      CFT049             Date 20Feb15              */
003600200529/*                      AR898165           Date 10Nov14              */
003700200529/*                      AR898162           Date 25Nov14              */
003800200529/*                      MD030940           Date 08Oct14              */
003900200529/*                      CFT157             Date 29Aug14              */
004000200529/*                      MD027047           Date 19Aug14              */
004100200529/*                      MD029681           Date 12Aug14              */
004200200529/*                      260903             Date 25Apr14              */
004300200529/*                      CFT151             Date 24Mar14              */
004400200529/*                      AR1091503          Date 30Sep13              */
004500200529/*                      MD020737           Date 10Jun13              */
004600200529/*                      MD000091           Date 10May13              */
004700200529/*                      262724             Date 24Apr13              */
004800200529/*                      MD019877           Date 10Apr13              */
004900200529/*                      MD019850           Date 06Apr13              */
005000200529/*                      AR1084524          Date 13Feb13              */
005100200529/*                      AR402776           Date 11Feb13              */
005200200529/*                      262786             Date 11Feb13              */
005300200529/*                      260045A            Date 11Feb13              */
005400200529/*                      260045             Date 11Feb13              */
005500200529/*                      217973             Date 11Feb13              */
005600200529/*                      AR895223           Date 11Feb13              */
005700200529/*                      AR1080200          Date 24Jan13              */
005800200529/*                      CFT120             Date 28Sep12              */
005900200529/*                      CAP211             Date 28Sep12              */
006000200529/*                      CFT039             Date 28Sep12              */
006100200529/*                      AR572042           Date 21Sep12              */
006200200529/*                      CLE134             Date 01Aug12              */
006300200529/*                      AR941425           Date 27Mar12              */
006400200529/*                      CSF011A            Date 28Nov11              */
006500200529/*                      AR787620           Date 10Jun11              */
006600200529/*                      CRE075             Date 06Dec10              */
006700200529/*                      CRE067             Date 05Oct10              */
006800200529/*                      CER059             Date 19Jul10              */
006900200529/*                      BUG23088A          Date 05Mar09              */
007000200529/*                      BUG23088           Date 26Feb09              */
007100200529/*                      BUG23063           Date 20Feb09              */
007200200529/*                      CER030             Date 09Jul08              */
007300200529/*                      CER043             Date 19May08              */
007400200529/*                      CSD083             Date 27May10              */
007500200529/* Bank Fusion Midas 1.4 Base ---------------------------------------*/
007600200529/*                      CAP205             Date 03Mar10              */
007700200529/*                      CAP204             Date 09Feb10              */
007800200529/*                      BUG26557           Date 30Oct09              */
007900200529/*                      258229             Date 05Jan09              */
008000200529/*                      260233             Date 13May09              */
008100200529/*                      BUG24776           Date 09Jul09              */
008200200529/*                      CSW209             Date 01Apr09              */
008300200529/* Midas Plus 1.4 Base 04 -------------------------------------------*/
008400200529/*                      257897             Date 26Nov08              */
008500200529/*                      257487             Date 04Nov08              */
008600200529/*                      256564             Date 17Sep08              */
008700200529/*                      257122             Date 09Oct08              */
008800200529/*                      256586             Date 18Sep08              */
008900200529/*                      256255             Date 01Sep08              */
009000200529/*                      255710             Date 04Aug08              */
009100200529/*                      255711             Date 31Jul08              */
009200200529/*                      BUG18500           Date 05May08              */
009300200529/*                      BUG18401           Date 29Apr08              */
009400200529/*                      BUG17019A          Date 31Mar08              */
009500200529/*                      BUG17718           Date 07Apr08              */
009600200529/*                      BUG17019           Date 19Mar08              */
009700200529/*                      BUG15088A          Date 29Oct07              */
009800200529/*                      BUG15042A          Date 23Oct07              */
009900200529/*                      BUG15042           Date 21Oct07              */
010000200529/*                      250600             Date 07Oct07              */
010100200529/*                      BUG14880           Date 19Sep07              */
010200200529/*                      246723             Date 18Apr07              */
010300200529/*                      245881             Date 17Apr07              */
010400200529/*                      CSW207A            Date 21Jun07              */
010500200529/*                      248174             Date 24Aug07              */
010600200529/*                      246583             Date 17Aug07              */
010700200529/*                      249709             Date 14Aug07              */
010800200529/*                      249111             Date 24Jul07              */
010900200529/*                      BUG14156           Date 25Jun07              */
011000200529/*                      BUG14157           Date 19Jun07              */
011100200529/*                      247314             Date 25Apr07              */
011200200529/*                      241255             Date 19Sep06              */
011300200529/*                      242480A            Date 12Dec06              */
011400200529/* Midas Plus 1.4 Base ----------------------------------------------*/
011500200529/*                      CRE026             Date 24May06              */
011600200529/*                      BUG13029           Date 11Jan07              */
011700200529/*                      BUG12862R          Date 20Dec06              */
011800200529/* Midas Plus 1.3 ---------------- Base -----------------------------*/
011900200529/*                      BUG12862           Date 08Dec06              */
012000200529/*                      228101             Date 09Oct06              */
012100200529/*                      241810A            Date 04Sep06              */
012200200529/*                      241810             Date 28Aug06              */
012300200529/*                      BUG12705           Date 17Nov06              */
012400200529/*                      CFT032             Date 11Sep06              */
012500200529/*                      240624             Date 05Jul06              */
012600200529/*                      221478             Date 06Jun06              */
012700200529/*                      223737             Date 06Jun06              */
012800200529/*                      222731             Date 06Jun06              */
012900200529/*                      240077             Date 30May06              */
013000200529/*                      240008             Date 23May06              */
013100200529/*                      CDL049             Date 11May06              */
013200200529/*                      CSD031             Date 10Apr06              */
013300200529/*                      219718             Date 27Apr06              */
013400200529/*                      227243             Date 26Apr06              */
013500200529/*                      BUG6864            Date 16Dec05              */
013600200529/*                      BUG433             Date 02Dec05              */
013700200529/*                      CSD027             Date 13Dec05              */
013800200529/*                      CLE042             Date 06Sep05              */
013900200529/*                      BUG7029            Date 10Jun05              */
014000200529/*                      BUG7455            Date 03Jun05              */
014100200529/*                      CER001             Date 25Apr05              */
014200200529/*                      BUG9071            Date 27Jul05              */
014300200529/*                      CDL038             Date 10May05              */
014400200529/*                      BUG8305            Date 31Aug05              */
014500200529/*                      CSC024             Date 07Feb05              */
014600200529/*                      CSW037A            Date 02May05              */
014700200529/*                      BUG6198            Date 04Apr05              */
014800200529/*                      CSD025             Date 11Jan05              */
014900200529/*                      BUG4449            Date 20Jan04              */
015000200529/*                      CSW037             Date 15Dec04              */
015100200529/*                      CSW036             Date 15Dec04              */
015200200529/*                      BUG4776 (Reopen)   Date 21Dec04              */
015300200529/*                      BUG4776            Date 15Nov04              */
015400200529/*                      BUG4331            Date 24Sep04              */
015500200529/*                      CFT116             Date 12Jul04              */
015600200529/*                      BUG3854            Date 27Jul04              */
015700200529/*                      BUG3821            Date 27Jul04              */
015800200529/*                      BUG3191            Date 02Jul04              */
015900200529/*                      CGL014             Date 20Oct03              */
016000200529/*                      CLE025             Date 20Oct03              */
016100200529/*                      BUG317             Date 14Jan04              */
016200200529/*                      221761             Date 13Apr04              */
016300200529/*                      TDA035             Date 02Apr04              */
016400200529/*                      CRE020             Date 20Jan04              */
016500200529/*                      TDA006             Date 19Mar04              */
016600200529/*                      CSC022             Date 24Feb04              */
016700200529/*                      CGL029             Date 01Sep03              */
016800200529/*                      CGP001             Date 16Oct03              */
016900200529/*                      221778             Date 01Oct03              */
017000200529/*                      CAP084             Date 18Jul03              */
017100200529/*                      CSW203             Date 26May03              */
017200200529/*                      210873             Date 23Jun03              */
017300200529/*                      212647             Date 23Jun03              */
017400200529/*                      215687             Date 20Mar03              */
017500200529/*                      212656             Date 14Apr03              */
017600200529/*                      219241             Date 01Jul03              */
017700200529/*                      CSD015             Date 14Oct02              */
017800200529/*                      CFT018             Date 29Nov02              */
017900200529/* Midas Release 4.01.03 --------------------------------------------*/
018000200529/*                      213004             Date 15Jan03              */
018100200529/*                      207404             Date 09Jan03              */
018200200529/* Midas Release 4.01.02 --------------------------------------------*/
018300200529/*                      209408             Date 16Oct02              */
018400200529/*                      201852             Date 02May02              */
018500200529/*                      204029             Date 26Apr02              */
018600200529/* Midas Release 4.01 -----------------------------------------------*/
018700200529/*                      201577             Date 22Jan02              */
018800200529/*                      200217             Date 16Nov01              */
018900200529/*                      CSC011             Date 18Sep01              */
019000200529/*                      197792             Date 30Jan01              */
019100200529/*                      195220             Date 21Jan02              */
019200200529/*                      196378             Date 28Nov01              */
019300200529/*                      197845             Date 26Nov01              */
019400200529/*                      193883             Date 20Nov01              */
019500200529/*                      196562             Date 20Sep01              */
019600200529/*                      196813             Date 20Sep01              */
019700200529/*                      195566             Date 15Aug01              *
019800200529/* Midas Release 4 --------------- Base -----------------------------*/
019900200529/*                      202150             Date 21Jan02              */
020000200529/*                      CPK014  *CREATE    Date 09Oct01              */
020100200529/*       ----------------------------------------------              */
020200200529/*                      CFT009             Date 01Aug00              */
020300200529/*                      190845             Date 21Mar01              */
020400200529/*                      186611             Date 21Nov00              */
020500200529/*                      189451             Date 09Feb01              */
020600200529/*                      185764             Date 01NOV00              */
020700200529/*                      187056             Date 01Dec00              */
020800200529/*                      CFT014             Date 25May00              */
020900200529/*                      179994             Date 14Aug00              */
021000200529/*                      175479             Date 23May00              */
021100200529/*                      CFT007             Date 16Mar00              */
021200200529/*                      174745             Date 09Feb00              */
021300200529/*                      CPB001             Date 21Sep99              */
021400200529/*                      CAP031             Date 28SEP99              */
021500200529/*                                                                   */
021600200529/*-------------------------------------------------------------------*/
021700200529/*                                                                   */
021800200529/*       250041 - Recompiled due to changes in FTOPAY3DT.            */
021900200529/*       MD054037 - Outward payment routing from incoming (OPIN = Y) */
022000200529/*                  via API (Recompile)                              */
022100200529/*       CSD102 - Password Length Extension (Recompile)              */
022200200529/*       MD052529 - If Ordering Customer line 1 = 'MT202', Ordering  */
022300200529/*                  Customer lines 2 - 5 should be blank. (Recompile)*/
022400200529/*       MD039094 - Adjust CFT157 to work with Rabo MHUB             */
022500200529/*                - Applied fix for MD050928 (Recompile)             */
022600200529/*       MD041294 - Customer extension details is missing in         */
022700200529/*                  CUSD repair browse (Recompile)                   */
022800200529/*       MD046248 - Finastra Rebranding                              */
022900200529/*       CDL099 - Split Value Date (Recompile)                       */
023000200529/*       MD044588 - Transactions sent via SOAP that falls under      */
023100200529/*                  CFT049 contains 'N' in the Authorise field       */
023200200529/*                  instead of 'No'.                                 */
023300200529/*                  Recompiled due to changes in FTOPAYUPD           */
023400200529/*       MD039986 - Additional codes to upgrade AR1090283. Recompile */
023500200529/*       MD024011 - Pb when job name is QZDASSINIT. Recompile.       */
023600200529/*                - Applied for MD-39986.                            */
023700200529/*       AR1090283 - Customer details not visible for enquire.       */
023800200529/*                   Recompile. (Child: AR1090284)                   */
023900200529/*                 - Applied for MD-39986.                           */
024000200529/*       MD035776 - User need to press twice on input screen         */
024100200529/*                - Remove unsupported keywords of HATS from dspf    */
024200200529/*                  (Recompile)                                      */
024300200529/*       MD033641 - Remove unsupported keywords of HATS. (Recompile) */
024400200529/*       CFT049 - Account with Bank validation if EU/EEA Payment     */
024500200529/*                (Recompile)                                        */
024600200529/*       AR898165 - Message unique reference is zeroized on amend    */
024700200529/*                  (Recompile) (Child: AR898166)                    */
024800200529/*       AR898162 - Charge codes passed via API are lost             */
024900200529/*                  (Recompile) (Child: AR898163)                    */
025000200529/*       MD030940 - (CFT157) Error when inserting new payment.       */
025100200529/*                  (Recompile)                                      */
025200200529/*       CFT157 - Stop FT Transaction after Authorisation            */
025300200529/*                (Recompile)                                        */
025400200529/*       MD027047 - Avoid HATS issue with redisplaying previous      */
025500200529/*                  screen on the stack. End program with SETON LR   */
025600200529/*                  with no RETURN. (Recompile)                      */
025700200529/*       MD029681 - Serious Midas Error occurred due to *LDA lock    */
025800200529/*                  being not granted (Recompile)                    */
025900200529/*       260903 - Remove the error validation for reversed account.  */
026000200529/*                Changed DBERR hard coded Return Code for AOCUSTR0. */
026100200529/*              - Applied for MD-23839 (Recompile)                   */
026200200529/*       CFT151 - FT IN/OP Alphanumeric sequence (recompile)         */
026300200529/*       AR1091503 - Recompile due to changes on FTOPAYUPD           */
026400200529/*                  (Child: AR1091504)                               */
026500200529/*       MD020737 - System not applying FT commission to OPAY        */
026600200529/*                  transaction (Recompile)                          */
026700200529/*       MD000091 - Event Codes Substitution (Recompile)             */
026800200529/*       262724 - PRFlag should be reset if F12 is pressed in the    */
026900200529/*                first screen. (Recompile)                          */
027000200529/*       MD019877 - Retest of 260045. FT-Outgoing Payments Enquiry   */
027100200529/*                  Screen is Missing (Recompile)                    */
027200200529/*       MD019850 - Posting to the first account was not reversed    */
027300200529/*                  during amend of 'Charges to the Debit of A/c'    */
027400200529/*                  (Recompile)                                      */
027500200529/*       AR1084524 - Performance issue on IPAY & OPAY listview       */
027600200529/*                   (Recompile)                                     */
027700200529/*       AR402906 - Recompile due to changes in FTOPAYUPD and        */
027800200529/*                  and FTOPAYAMD.(Child: AR402906)                  */
027900200529/*       262786 - Recompiled due to changes in FTOPAYUPD.            */
028000200529/*       260045A- ERZ123 F15 screen enquiry allows all action codes  */
028100200529/*                (Recompiled)                                       */
028200200529/*       260045 - Restrict Select Scrn Codes. FTOPAYBRW - Recompile  */
028300200529/*       217973 - Incorrect fee amount. Correctly use M/D indicator  */
028400200529/*                for conversion from base ccy to other ccy.         */
028500200529/*                (Recompile)                                        */
028600200529/*              - Applied for AR1023847 (Child: AR1023849)           */
028700200529/*       AR895223 - Exchange rates should allow 5 digits. Fix is to  */
028800200529/*                  increase the number of digits to five.           */
028900200529/*                  Recompiled due to changes in module FTOPAY1DT    */
029000200529/*                  (Child: AR895224)                                */
029100200529/*       AR1080200 - In Charge details 2 tab, charges on the left and*/
029200200529/*                   right hand side of the screen is incorrect      */
029300200529/*                   (Recompile)                                     */
029400200529/*       CFT120 - FT IN/OP - Charges to DR of Account Currency       */
029500200529/*                (Recompile)                                        */
029600200529/*       CAP211 - FT IN_OP APIs - Auto-Authorization of Payment      */
029700200529/*                (Recompile)                                        */
029800200529/*       CFT039 - SWIFT Mapping of Field Ordering Bank (Recompile)   */
029900200529/*       AR572042 - Charges Amount are incorrectly defaulted.  Allow */
030000200529/*                  manual input of charge amounts in API            */
030100200529/*                  (Recompile)                                      */
030200200529/*       CLE134 - Past Due Call Loan Processing (Recompile)          */
030300200529/*       AR941425 - Defaulted transfer commission charge amount      */
030400200529/*                  warning error (Recompile)                        */
030500200529/*       CSF011A - CCR015: Display Order in Confirmation Pages       */
030600200529/*                 (Recompile)                                       */
030700200529/*       AR787620 - Hooks Incorporation (Recompile)                  */
030800200529/*       CRE075 - Effective Date for Retail Accounts (Recompile)     */
030900200529/*       CRE067 - BankFusion Midas Teller - Midas Specific Changes   */
031000200529/*                (Recompile)                                        */
031100200529/*       CER059 - German Feature Upgrade to Delhi                    */
031200200529/*       BUG23088A - RE-OPEN (Recompile)                             */
031300200529/*       BUG23088 - Transactions using non-retail A/C format did     */
031400200529/*                appear in the posting (Recompile)                  */
031500200529/*       BUG23063 - OPAY generated from Regular Payment has details  */
031600200529/*                  mixed up in Outgoing Payment Enquiry (Recompile) */
031700200529/*       CER043 - German Features LF041-00 New Fields and Defaulting */
031800200529/*                (Recompile)                                        */
031900200529/*       CSD083 - Watch List Compliance Upgrade (Recompile)          */
032000200529/*       CAP205 - Teller Related APIs - Account Balance Check        */
032100200529/*                (Recompile)                                        */
032200200529/*       CAP204 - Teller Related APIs - Account Transfer (Recompile) */
032300200529/*       BUG26557 - Transfer Commission Charge Amount field value is */
032400200529/*               not displayed on the confirmation screen (Recompile)*/
032500200529/*       258229 - FT fees and charges - Wrong amendment of payment   */
032600200529/*                (refreshing commission)                            */
032700200529/*       260233 - Apply GEMS 245712 parts missing from GEMS 256169   */
032800200529/*       BUG24776 - Settlement type may not be amended (Recompile)   */
032900200529/*       CSW209 - SWIFT 2009 Changes (Recompile)                     */
033000200529/*       257897 - Recompile over changed FTOPAY1DT.                  */
033100200529/*                Apply client fix 250881                            */
033200200529/*       257487 - Write to Incoming Payments extension file OTPAYDQD */
033300200529/*       256564 - Recompile due to PF changes done by fix 256330     */
033400200529/*       257122 - FT OP Miscellaneous Charge error (Recompile)       */
033500200529/*       256586 - Recompiled due to change in module FTOPAY1DP.      */
033600200529/*       256255 - Charges in Paid Currency is incorrect (Recompile)  */
033700200529/*       255710 - Incorrect calculation of commission. (Recompile)   */
033800200529/*       255711 - Field Ref rate does not record rate. (Recompiled)  */
033900200529/*       BUG18500 - Unable to authorize amended data (Recompile)     */
034000200529/*       BUG18401 - During amend of newly inserted transactions,     */
034100200529/*                  expanding the field details caused errors        */
034200200529/*                  (Recompile)                                      */
034300200529/*       BUG17019A - Some Charge code amounts change values after    */
034400200529/*                  authorisation (Recompile)                        */
034500200529/*       BUG17718 - Reverse fix 249709 since bug14157 is             */
034600200529/*                  present (Recompile)                              */
034700200529/*       BUG17019 - Some Charge code amounts change values after     */
034800200529/*                  authorisation (Recompile)                        */
034900200529/*       BUG15088A - A srious Midas Error occurs if Ordering         */
035000200529/*                   Customer is specified with '/'. (Recompile)     */
035100200529/*       BUG15042A - Recompiled due to changes in module FTOPAYUPD   */
035200200529/*       BUG15042 - Recompiled due to changes in module FTOPAYUPD    */
035300200529/*       250600 - Various errors in CFT032/CSW207 (Recompile)        */
035400200529/*       BUG14880 - A serious Midas Error if Ordering Customer       */
035500200529/*                  is an IBAN (Recompile)                           */
035600200529/*       246723 - If no Spread Set for the currency, Spot Rate was   */
035700200529/*                used instead of the Sell Rate (spot rate + spread  */
035800200529/*                rate as defined within SDCURRPD). Additional       */
035900200529/*                issue where Settle Amount is defaulted incorrectly */
036000200529/*                if a Spread Set is used in cross ccy transaction. */
036100200529/*                Recompiled due to change to FT000980 & FT000982.  */
036200200529/*       245881 -  Apply fix BUG12862R. Recompiled due to changes    */
036300200529/*                 in FTOPAYAMD.                                     */
036400200529/*       CSW207A - SWIFT 2007 Changes (Recompile)                    */
036500200529/*       248174 - Recompiled due to changes in MOD/FT000980.         */
036600200529/*       246583 - Recompiled due to changes in MOD/FT000980.         */
036700200529/*       249709 - Recompiled due to changes in FTOPAYCVT module.     */
036800200529/*       249111 - Recompiled due to changes done to FT000981 module. */
036900200529/*       BUG14156 - Amend decimal places in Charge Amount (Recompile)*/
037000200529/*       BUG14157 - Error in SWIFT Standard Charge Conv. (Recompile) */
037100200529/*       247314 - Recompiled due to changes in FTOPAYUPD module.     */
037200200529/*       241255 - Recompiled due to changes done to FT000984 module. */
037300200529/*       242480A- Recompile due change in FTOPAY1DT.                 */
037400200529/*       CRE026 - Consumer Banking (Recompile)                       */
037500200529/*       BUG13029 - Outgoing payment error: Unable to find retail    */
037600200529/*                  account (Recompile)                              */
037700200529/*       BUG12862R - BUG12862 reopened. Recompiled due to changes    */
037800200529/*                   in FTOPAYAMD.                                   */
037900200529/*       BUG12862 - Recompiled due to changes in FTOPAY1DP           */
038000200529/*       228101 - Transactions should be sorted by reference, with   */
038100200529/*                the latest ones first. Applied fix 217202.         */
038200200529/*                Recompiled due to change in FTOPAYBRW.             */
038300200529/*       241810A- Reverse fix 241810.                                */
038400200529/*       241810 - Recompiled due to changes in FTOPAYUPD module.     */
038500200529/*       BUG12705 - Error in ordering customer       (Recompile)     */
038600200529/*       CFT032 - Account line in Field 50X in MT103 (Recompile)     */
038700200529/*       240624 - Messages routed to OPAY cant be amended (recompile)*/
038800200529/*       221478 - Recompiled due to changes in FTOPAYUPD module.     */
038900200529/*       223737 - Do not allow the database to be updated during     */
039000200529/*                amendment if the transaction is already authorised.*/
039100200529/*                Recompile over changes to module(s) FTOPAYUPD.     */
039200200529/*       222731 - Recompiled due to change in FTOPAY3DT              */
039300200529/*       240077 - Recompiled due to changes in FTOPAYCVT.            */
039400200529/*       240008 - Recompiled due to changes to module FTOPAYUPD.     */
039500200529/*       CDL049 - Addition of a Reference Rate field (recompile)     */
039600200529/*       CSD031 - Enhanced Centralised Static Data (Recompile)       */
039700200529/*       219718 - Recompiled due to changes to module FTOPAYUPD.     */
039800200529/*       227243 - Recompiled over changes made in FTOPAYUPD and      */
039900200529/*                FTOPAY3DTY4DP modules.                             */
040000200529/*       BUG6864- Recompiled due to change in FTOPAYCVT              */
040100200529/*       BUG433 - Recompiled due to change in FT000982 & FT000983    */
040200200529/*       CSD027 - Conversion Of Customer Number to Alpha             */
040300200529/*       CLE042 - Extended Loan Sub Type (Recompile)                 */
040400200529/*       BUG7029- Recompiled due to change in FTOPAYRTV              */
040500200529/*       BUG7455 - Recompiled due to change in FTOPAYCVT             */
040600200529/*       BUG9071 - Error on payment reference when this module was   */
040700200529/*                called via meridian and the action is 'I'.         */
040800200529/*       CER001 - LUX Upgrade to MidasPlus                           */
040900200529/*       CDL038 - Extended Deal Sub Type (Recompile)                 */
041000200529/*       BUG8305- Recompiled due to change in FT000980               */
041100200529/*       CSC024 - Open Month End                                     */
041200200529/*       CSW037A- Additional Field extended to 40 chars (recompile)  */
041300200529/*       BUG6198- Cannot save new Details for CUSD (Recompile)       */
041400200529/*       CSD025 - Customer De-Activation                             */
041500200529/*       BUG4449 - Recompiled due to change in FTOPAYUPD             */
041600200529/*       CSW037 - Additional Field Data on MT300/MT320               */
041700200529/*       CSW036 - Dual SWIFT BIC held on Client Details              */
041800200529/*       BUG4776- Reverse fix since fix only applies to Incoming.    */
041900200529/*                (Reopen)                                           */
042000200529/*       BUG4776- Correct skipping of transaction reference.         */
042100200529/*       BUG4331- Do not overwrite charges entered with defaults     */
042200200529/*                during amendement, recompile over changed FTOPAY3DT*/
042300200529/*       CFT116 - Core changes for GBO016.                           */
042400200529/*              - MT110 Generation in Funds Transfer                 */
042500200529/*              - Upgrade to Midasplus                               */
042600200529/*       BUG3854 - Shadow postings to partial accounts incorrect     */
042700200529/*       BUG3821 - Shadow postings incorrect due to 10 digit a/c code*/
042800200529/*       BUG3191 - Recompile due to changes in FTOPAYUPD.            */
042900200529/*       CGL014 - Collaterals Processing (Recompile)                 */
043000200529/*       CLE025 - Credit Lines (Recompile)                           */
043100200529/*       BUG317 - Recompiled due to change in FTOPAYCVT              */
043200200529/*       221761 - Incorrect routing of multiple MT101s.  Recompile   */
043300200529/*                due to changes in modules.                         */
043400200529/*       TDA035 - RTS Signon changes for MidasPlus. (Recompile)      */
043500200529/*       CRE020 - Midas Plus Online Printing of Advices (GE7)        */
043600200529/*                (Recompile)                                        */
043700200529/*       TDA006 - Fix 10-digit account code processing.              */
043800200529/*                - Recompiled due to changes in FT000980.           */
043900200529/*       CSC022 - Commitment Control Changes for MidasPlus           */
044000200529/*                (Recompile)                                        */
044100200529/*       CGL029 - Increase Account Code to 10 digits                 */
044200200529/*       CGP001 - Global Processing.                                 */
044300200529/*              - Recompiled due to change in FTVOPY2PD              */
044400200529/*       221778 - Ordering Cust wrongly expanded for Compliance      */
044500200529/*       CAP084 - MidasPlus Changes                                  */
044600200529/*       CSW203 - SWIFT 2003 Standards Update.                       */
044700200529/*       210873 - Recompiled due to changes in the following modules:*/
044800200529/*                FTOPAYUPD and FTOPAY3DT                            */
044900200529/*       212647 - Recompiled due to changes in the modules FTOPAYCVT */
045000200529/*                and FTOPAY4DP.                                     */
045100200529/*       215687 - Recompiled due to changes in module FTOPAYRTV.     */
045200200529/*       212656 - Recompiled due to changes in module FTOPAY1DP.     */
045300200529/*       219241 - Defaulting of "Details of Charges" assign a        */
045400200529/*                system value (Recompile)                           */
045500200529/*       CSD015 - Midas Compliance Watch - Watch List Checking.      */
045600200529/*                (Recompile).                                       */
045700200529/*       CFT018 - Standard Settlement Instructions for Outgoing      */
045800200529/*                Payments (Recompile)                               */
045900200529/*       213004 - Recompiled due to amendments in module FTOPAYUPD   */
046000200529/*       207404 - Recompiled due to amendments in module FTOPAYRPB   */
046100200529/*       209408 - Recompiled due to changes to module FTOPAYRTV.     */
046200200529/*       201852 - Recompiled due to changes to module FTOPAYRTV.     */
046300200529/*       204029 - Data decimal error on fields MISC01,2,3,4,5        */
046400200529/*                and SWSCHG when CFT009 is not on (RECOMPILED)      */
046500200529/*       201577 - Call AOC8000 for deallocation of dataarea TREF.    */
046600200529/*                (Recompile)                                        */
046700200529/*       200217 - Error updating records coming from FTVOPAYPD when  */
046800200529/*                action code is not equal to 'I' (Recompile)        */
046900200529/*       CSC011 - 24x7 Midas Availability (Recompile)                */
047000200529/*       197792 - Recompiled due to changes in FTOPAYBRW.            */
047100200529/*       195220 - Recompiled due to changes in module FTOPAYCVT      */
047200200529/*       196378 - Recompile over changed FTOPAYUPD.                  */
047300200529/*       197845 - Recompiled due to amendments in module FTOPAY4DP.  */
047400200529/*       193883 - Recompile over changed FTOPAYUPD.                  */
047500200529/*       196562 - Recompile over changed FTOPAY3DT.                  */
047600200529/*       196813 - Recompiled due to changes in FTOPAYUPD             */
047700200529/*       195566 - Recompiled due to changes in FTOPAYUPD             */
047800200529/*       202150 - Recompiled due to changes in module FTOPAYUPD.     */
047900200529/*       CPK014 - Release 4 packaging:                               */
048000200529/*                - Rebuilding of the service program structure to   */
048100200529/*                  reduce the number of objects, simplify the       */
048200200529/*                  system and reduce signature violation problems.  */
048300200529/*                - The original header box entries have been        */
048400200529/*                  retained for reference.                          */
048500200529/*                - The following DBA3 service programs have been    */
048600200529/*                  put into this one: SP570OP_FC, SP570OP_GN,       */
048700200529/*                  SP570OPDB and SP570OPSCN.                        */
048800200529/*       ----------------------------------------------------------  */
048900200529/*       CFT009 - Funds Transfer Fees and Charges                    */
049000200529/*       190845 - New fields added for Message Unique Reference and  */
049100200529/*                Part Number (recompile)                            */
049200200529/*       186611 - API Repair Queues : Review Delete Operation.       */
049300200529/*                Recompile.                                         */
049400200529/*       189451 - Removal of hook FT0040MOV1 as is an OPM hook name  */
049500200529/*                from FT0040.                                       */
049600200529/*       185764 - Recompiled due to changes in FTOPAYUPD             */
049700200529/*       187056 - IP and OP do not recalculate screen charges if     */
049800200529/*                'Charges to the Debit of a/c' has been changed     */
049900200529/*                from blank to non-blank. Recompile only.           */
050000200529/*       CFT014 - Straight-through Processing Phase 2 MT103          */
050100200529/*                Messages Generation for FT. (Recompile)            */
050200200529/*       179994 - Recompile.                                         */
050300200529/*                Access FT ICD and not FO ICD                       */
050400200529/*       174749 - Recompile - CGL009 Dealer's Reference              */
050500200529/*       CFT007 - Recompile - BIC Database Plus Integration          */
050600200529/*       174745 - Recompile.                                         */
050700200529/*                Put modules not previously contained in service    */
050800200529/*                programs into service programs.                    */
050900200529/*                Also removed modules which should not be included. */
051000200529/*       CPB001 - Meridian DBA Middleware Replication Customisation. */
051100200529/*                Recompiled due to changes in FTOPAYxxx.            */
051200200529/*       CAP031 - API service program breakdown                      */
051300200529/*                                                                   */
051400200529/*********************************************************************/
051500200529
051600200529             STRPGMEXP  PGMLVL(*CURRENT) LVLCHK(*YES) SIGNATURE(*GEN)
051700200529                EXPORT     SYMBOL(FT000980)                                               /*CFT009*/
051800200529                EXPORT     SYMBOL(FT000981)                                               /*CFT009*/
051900200529                EXPORT     SYMBOL(FT000982)                                               /*CFT009*/
052000200529                EXPORT     SYMBOL(FT000983)                                               /*CFT009*/
052100200529                EXPORT     SYMBOL(FT000984)                                               /*CFT009*/
052200200529                EXPORT     SYMBOL(FT000985)                                               /*CFT009*/
052300200529                EXPORT     SYMBOL(FT000652)                                               /*CFT009*/
052400200529                EXPORT     SYMBOL(FTCALCRNG)                                              /*CFT009*/
052500200529                EXPORT     SYMBOL(FTCALCLEV)                                              /*CFT009*/
052600200529                EXPORT     SYMBOL(FTRTVLOC)                                               /*CFT009*/
052700200529                EXPORT     SYMBOL(FTTIMECHAR)                                             /*CFT009*/
052800200529                EXPORT     SYMBOL(FTOPAYAMD)                                              /*CAP031*/
052900200529                EXPORT     SYMBOL(FTOPAYRTV)                                              /*CAP031*/
053000200529                EXPORT     SYMBOL(FTOPAY3DT)                                              /*CAP031*/
053100200529                EXPORT     SYMBOL(FTOPAY1DT)                                              /*CFT009*/
053200200529                EXPORT     SYMBOL(FTOPAYUPD)                                              /*CAP031*/
053300200529                EXPORT     SYMBOL(FTOPAYBRW)                                              /*CAP031*/
053400200529                EXPORT     SYMBOL(FTOPAYCVT)                                              /*CAP031*/
053500200529                EXPORT     SYMBOL(FTOPAY1DP)                                              /*CAP031*/
053600200529                EXPORT     SYMBOL(FTOPAY2DP)                                              /*CAP031*/
053700200529                EXPORT     SYMBOL(FTOPAY3DP)                                              /*CAP031*/
053800200529                EXPORT     SYMBOL(FTOPAYRPB)                                              /*CAP031*/
053900200529                EXPORT     SYMBOL(FTOPAY4DP)                                              /*CFT014*/
054000200529                EXPORT     SYMBOL(FTOPAY5DP)                                              /*CFT014*/
054100200529/* End of Midas Release 4 -------- Base -----------------------------*/
054200200529/* End of Midas Release 4.01 ----------------------------------------*/
054300200529/* End of Midas Plus 1.3 --------- Base -----------------------------*/
054400200529             ENDPGMEXP
054500200529/************************************************************************/
054600200529/*       THIS SERVICE PROGRAM IS FULL. DO NOT ADD ANY NEW MODULES       */
054700200529/************************************************************************/
