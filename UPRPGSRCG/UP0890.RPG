     H        1
      *****************************************************************
/*XBI *  OVRDBF FILE(UPDFFDPD) TOFILE(QADSPFFD)                       *
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas UP Retrieve file field information')
      *****************************************************************
      *                                                               *
      *  Midas - Upgrade module                                       *
      *                                                               *
      *  UP0890 - Retrieve file field information                     *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CUP031             Date 18Nov04               *
      *  Prev Amend No. CUP028 *MOVED      Date 08Sep04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CUP004             Date 16Mar98               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CUP031  -  Amended so that if text description field is      *
      *             blank, retrieve column description as field       *
      *             description.                                      *
      *  CUP028  -  Moved from zone to global.                        *
      *  CUP004  -  Make upgrade of DTALIB files easier               *
      *                                                               *
      *****************************************************************
      * ID F  C  H  L    FUNCTION OF INDICATORS
      *
      *       20      End of file
      *       30      Chain - record not found
      *       69      Read, write, update or delete fail
      *
     FUPDFFDPDIF  E                    DISK
      *
      /EJECT
      * Array containing Copyright statement
     E                    CPY@    1   1 80
     E                    ERR@    1   1 50
      *
      /SPACE 3
     C           *ENTRY    PLIST
     C                     PARM           DESC   50
      *
     C                     MOVEACPY@      CPY2@  80
      *
     C                     READ UPDFFDPD               6920
     C           *IN69     IFEQ *ON
     C                     DUMP
     C                     GOTO ENDPGM
     C                     ENDIF
      *
     C           *IN20     DOWEQ'0'
      *
     C                     MOVELWHFTXT    DESC
      *
      * If Text description field is blank, concatenate column headings as description        CUP031
     C           WHFTXT    IFEQ *BLANKS                                                       CUP031
     C           WHCHD1    CAT  WHCHD2:1  WDES40 40                                           CUP031
     C           WDES40    CAT  WHCHD3:1  WDES60 60                                           CUP031
     C                     MOVELWDES60    DESC                                                CUP031
     C                     ENDIF                                                              CUP031
      *
     C********   WHFTXT    IFNE *BLANKS                                                       CUP031
     C           DESC      IFNE *BLANKS                                                       CUP031
     C                     MOVE 'Y'       FOUND   1
     C                     ELSE
     C                     MOVE 'N'       FOUND
     C                     ENDIF
      *
     C                     READ UPDFFDPD               6920
     C           *IN69     IFEQ *ON
     C                     DUMP
     C                     GOTO ENDPGM
     C                     ENDIF
      *
     C                     ENDDO
      *
     C           FOUND     IFEQ 'N'
     C                     MOVEAERR@      DESC
     C                     ENDIF
      *
     C           ENDPGM    TAG
     C                     SETON                     LR
     C                     RETRN
      *****************************************************************
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**  ERR@
*** No field description available ***
