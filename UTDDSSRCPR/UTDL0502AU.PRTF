      *****************************************************************
/*STD *  PRTFBASE                                                     *
/*EXS *  PR_STD60                                                     *
/*EXI *  TEXT('Midas UT Check corrupted FSRRAT in historic -audit')   *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  PRTF/UTDL0502AU - Check corrupted FSRRAT field - Audit       *
      *                                                               *
      *  (c) Finastra International Limited 2012                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. AR317892 *CREATE   Date 26Jul12               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  AR317892 - Utility that will check corrupted FSRRAT fields   *
      *             in DLBHISPD, DLCHISPD and DLDHISPD.               *
      *                                                               *
      *****************************************************************
     A                                      REF(MFRFL)
      *
      *--------------------------------*
      ***  Report Header Record Format *
      *--------------------------------*
      *
     A          R HEADAU                    TEXT('(c) Finastra +
     A                                      International Banking +
     A                                      Limited 2012')
      *
     A                                      SKIPB(3)
     A                                     6'REFERENCE UTDL0502AU'
     A            BJURPT    R             37REFFLD(URPT)
     A                                   101'DATE'
     A            BJMRDT    R            106REFFLD(MRDT)
     A                                   119'PAGE'
     A                                   124PAGNBR
     A                                      EDTCDE(Z)
     A                                      SPACEA(1)
      *
     A                                   101'TIME'
     A                                   106TIME
     A                                      EDTWRD('  :  :  ')
     A                                      SPACEA(1)
      *
     A                                    35'DEALS WITH CORRUPTED +
     A                                      FSRRAT FIELD IN HISTORIC'
     A N50                                80' - AUDIT RUN'
     A  50                                80' - UPDATE RUN'
     A                                   132' '
     A                                      SPACEA(1)
      *
     A                                    35'---------------------+
     A                                      ------------------------'
     A N50                                80'------------'
     A  50                                80'-------------'
     A                                   132' '
     A                                      SPACEA(3)
      *
      *-----------------*
      ***  File Control *
      *-----------------*
      *
     A          R CONTROL
     A                                    42'Total deals read in DLBHISPD:'
     A            RNODLB         6S 0     80EDTCDE(3)
     A                                      SPACEA(1)
     A                                    42'Corrupted FSRRAT in DLBHISPD:'
     A            RCODLB         6S 0     80EDTCDE(3)
     A                                      SPACEA(2)
     A                                    42'Total deals read in DLCHISPD:'
     A            RNODLC         6S 0     80EDTCDE(3)
     A                                      SPACEA(1)
     A                                    42'Corrupted FSRRAT in DLCHISPD:'
     A            RCODLC         6S 0     80EDTCDE(3)
     A                                      SPACEA(2)
     A                                    42'Total deals read in DLDHISPD:'
     A            RNODLD         6S 0     80EDTCDE(3)
     A                                      SPACEA(1)
     A                                    42'Corrupted FSRRAT in DLDHISPD:'
     A            RCODLD         6S 0     80EDTCDE(3)
     A                                      SPACEA(1)
      *
      *---------------*
      ***  No Details *
      *---------------*
      *
     A          R NODTLS
     A                                    48'*** NO DETAILS TO REPORT ***'
     A                                      SPACEB(3)
      *
      *-------------------*
      ***  Database Error *
      *-------------------*
      *
     A          R DBERROR
     A                                    25'**** DATABASE ERROR ****'
     A                                      SPACEB(2)
     A                                    11'***************************+
     A                                      ***************************'
     A                                      SPACEB(2)
     A                                    11'*'
     A                                      SPACEB(1)
     A                                    64'*'
     A                                    11'*    FILE         '''
     A                                      SPACEB(1)
     A            DBFILE         8A       30
     A                                    38''''
     A                                    64'*'
     A                                    11'*    KEY          '''
     A                                      SPACEB(1)
     A            DBKEY         29        30
     A                                    59 '''    *'
     A                                    11'*    PROGRAM NAME '''
     A                                      SPACEB(1)
     A            DBPGM         10A       30
     A                                    40''''
     A                                    64'*'
     A                                    11'*    AT           '''
     A                                      SPACEB(1)
     A            DBASE          3  0     30
     A                                    33''''
     A                                    64'*'
     A                                    11'*'
     A                                      SPACEB(1)
     A                                    64'*'
     A                                    11'***************************+
     A                                      ***************************'
     A                                      SPACEB(1)
