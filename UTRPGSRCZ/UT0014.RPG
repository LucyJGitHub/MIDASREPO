     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas UT Edit FETCH search library list')
      *****************************************************************
      *                                                               *
      *  Midas - Utilities Module                                     *
      *                                                               *
      *  UT0014 - EDTFSLIBS: Edit FETCH search list                   *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Last Amend No. S01516             DATE 02NOV94               *
      *  Prev Amend No.                    DATE ddmmmyy               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  S01516 - Incorporation of enhanced CRTOBJ into core          *
      *                                                               *
      *****************************************************************
     F/EJECT
     FUT0014DFCF  E                    WORKSTN
     E                    LIBL      250  1               Parameter
     E                    ARR        25 13  A            Seqnbr/lib
     E                    CPY@    1   1 80
      *
      ** Array containing Copyright statement
      *
     C           *ENTRY    PLIST                           Parm list
     C                     PARM           LIBL             Lib list
     C                     PARM           SCNTXT           Screen text
     C                     PARM           MSG              Error msg
     C                     PARM           RTNCDE  8        Return code
      *
      * Initialize
      *
     C                     MOVE 'NOCHG   'RTNCDE           Assume NOCHG
     C                     MOVE *BLANKS   BLANK3  3        Blank 3 byts
     C                     MOVEACPY@      BIS@   80
      *
     C           BEGIN     TAG                             Begin fill
      *
      * Count number of libs (if less than 25, start as SEQ 2)
      *
     C                     Z-ADD0         X       30       Lib count
     C                     Z-ADD-9        Y                Inx to Parm
     C           CNTLOP    TAG                             Count loop
      *
      * Lib names are 10 long
      *
     C                     ADD  10        Y                Bump inx
     C                     MOVEALIBL,Y    LIB    10        Extract lib
     C           LIB       IFNE *BLANK                     Not blank
     C                     ADD  1         X                Lib count
     C                     END                             Not blank
     C           Y         CABLT240       CNTLOP           Loop back
     C                     Z-ADDX         LIBCNT  30       Set count
      *
     C           REPEAT    TAG                             Repeat
      *
     C                     Z-ADD010       SEQ1             Inlz
     C                     Z-ADD020       SEQ2
     C                     Z-ADD030       SEQ3
     C                     Z-ADD040       SEQ4
     C                     Z-ADD050       SEQ5
     C                     Z-ADD060       SEQ6
     C                     Z-ADD070       SEQ7
     C                     Z-ADD080       SEQ8
     C                     Z-ADD090       SEQ9
     C                     Z-ADD100       SEQ10
     C                     Z-ADD110       SEQ11
     C                     Z-ADD120       SEQ12
     C                     Z-ADD130       SEQ13
     C                     Z-ADD140       SEQ14
     C                     Z-ADD150       SEQ15
     C                     Z-ADD160       SEQ16
     C                     Z-ADD170       SEQ17
     C                     Z-ADD180       SEQ18
     C                     Z-ADD190       SEQ19
     C                     Z-ADD200       SEQ20
     C                     Z-ADD210       SEQ21
     C                     Z-ADD220       SEQ22
     C                     Z-ADD230       SEQ23
     C                     Z-ADD240       SEQ24
     C                     Z-ADD250       SEQ25
     C                     Z-ADD0         X       30       Lib count
     C                     Z-ADD-9        Y                Inx to Parm
      *
      * If LT 25 libraries or error, skip Seq 1
      *
     C           LIBCNT    CABEQ25        LOOP             If 25 libs
      *
      * If MSG is not blank, it has an error to be displayed
      *
     C           MSG       CABNE*BLANK    LOOP             If error
     C                     ADD  1         X                Skip Seq 1
      *
     C* Fill the library names for the display
      *
     C           LOOP      TAG                             LOOP
      *
     C                     ADD  10        Y                Bump inx
     C           Y         CABGE251       DISPLY           If at end
     C                     MOVEALIBL,Y    LIB    10        Extract lib
     C           LIB       CABEQ*BLANK    DISPLY           If blank
     C                     ADD  1         X                Lib count
     C                     EXSR MV2DSP                     Exsr MV2DSP
     C                     GOTO LOOP                       Goto LOOP
      *
      * Display the libraries
      *
     C           DISPLY    TAG                             DISPLY
      *
     C                     EXFMTPROMPT                     Prompt
      *
      * Check for F3 Exit
      *
     C   93                MOVE 'F3      'RTNCDE           If F3
     C   93                GOTO END                        If F3
      *
      * Check for F12 Previous
      *
     C   92                MOVE 'F12     'RTNCDE           If F12
     C   92                GOTO END                        If F12
      *
      * Check for F5 Refresh
      *
     C   95                GOTO REPEAT                     If F5
      *
      * Check for Change indicator
      *
     C  N91                GOTO END                        No change
      *
      * Move libraries and sequence numbers to the array
      *
     C                     MOVE LIB1      ARR,1            Move to ARR
     C                     MOVE LIB2      ARR,2
     C                     MOVE LIB3      ARR,3
     C                     MOVE LIB4      ARR,4
     C                     MOVE LIB5      ARR,5
     C                     MOVE LIB6      ARR,6
     C                     MOVE LIB7      ARR,7
     C                     MOVE LIB8      ARR,8
     C                     MOVE LIB9      ARR,9
     C                     MOVE LIB10     ARR,10
     C                     MOVE LIB11     ARR,11
     C                     MOVE LIB12     ARR,12
     C                     MOVE LIB13     ARR,13
     C                     MOVE LIB14     ARR,14
     C                     MOVE LIB15     ARR,15
     C                     MOVE LIB16     ARR,16
     C                     MOVE LIB17     ARR,17
     C                     MOVE LIB18     ARR,18
     C                     MOVE LIB19     ARR,19
     C                     MOVE LIB20     ARR,20
     C                     MOVE LIB21     ARR,21
     C                     MOVE LIB22     ARR,22
     C                     MOVE LIB23     ARR,23
     C                     MOVE LIB24     ARR,24
     C                     MOVE LIB25     ARR,25
     C                     MOVELSEQ1      ARR,1            Movel to ARR
     C                     MOVELSEQ2      ARR,2
     C                     MOVELSEQ3      ARR,3
     C                     MOVELSEQ4      ARR,4
     C                     MOVELSEQ5      ARR,5
     C                     MOVELSEQ6      ARR,6
     C                     MOVELSEQ7      ARR,7
     C                     MOVELSEQ8      ARR,8
     C                     MOVELSEQ9      ARR,9
     C                     MOVELSEQ10     ARR,10
     C                     MOVELSEQ11     ARR,11
     C                     MOVELSEQ12     ARR,12
     C                     MOVELSEQ13     ARR,13
     C                     MOVELSEQ14     ARR,14
     C                     MOVELSEQ15     ARR,15
     C                     MOVELSEQ16     ARR,16
     C                     MOVELSEQ17     ARR,17
     C                     MOVELSEQ18     ARR,18
     C                     MOVELSEQ19     ARR,19
     C                     MOVELSEQ20     ARR,20
     C                     MOVELSEQ21     ARR,21
     C                     MOVELSEQ22     ARR,22
     C                     MOVELSEQ23     ARR,23
     C                     MOVELSEQ24     ARR,24
     C                     MOVELSEQ25     ARR,25
      *
      * Place blanks in SEQ field if lib is blank
      *
     C                     DO   25        X                Do 25 times
     C                     MOVE ARR,X     SAV10  10        Move to save
     C           SAV10     IFEQ *BLANK                     If blank lib
     C                     MOVELBLANK3    ARR,X            Blank seqnbr
     C                     END                             If blank lib
     C                     END                             Do 25 times
      *
      * Sort the array of libraries
      *
     C                     SORTAARR                        Sort ARR
      *
      * Initialize
      *
     C                     MOVE *BLANK    LIBL             Blank array
     C                     Z-ADD-9        Y       30       Inx to Parm
      *
      * If SEQ is not blank, place the lib into the LIBL array
      *
     C                     DO   25        X                Do 25 times
     C                     MOVELARR,X     SAV3    3        Movel seqnbr
     C           *BLANKS   IFNE SAV3                       If not blank
     C                     ADD  10        Y                Inx to Parm
     C                     MOVE ARR,X     SAV10            Move lib
     C                     MOVEASAV10     LIBL,Y           Move to Parm
     C                     END                             If not blank
     C                     END                             Do 25 times
      *
      * Set to good. reset display values to blank and redisplay
      *
     C                     MOVE 'GOOD    'RTNCDE           Some change
     C                     MOVE *BLANKS   LIB              Blank out
     C                     DO   25        X                Do 25 times
     C                     EXSR MV2DSP                     Blank dsp
     C                     END                             Do 25 times
     C                     GOTO BEGIN                      Loop back
      *
      * End of program
      *
     C           END       TAG                             END
     C                     SETON                     LR    Set LR
     C                     RETRN                           Return
      *
      *******************************************************************
      *
      *    MV2DSP SR - To move lib values to display fields
      *                depending on the count field
      *
     C           MV2DSP    BEGSR                           MV2DSP subr
      *
     C           X         COMP 1                        20 If X=1
     C   20                MOVE LIB       LIB1             Mv to Lib 1
     C           X         COMP 2                        20
     C   20                MOVE LIB       LIB2
     C           X         COMP 3                        20
     C   20                MOVE LIB       LIB3
     C           X         COMP 4                        20
     C   20                MOVE LIB       LIB4
     C           X         COMP 5                        20
     C   20                MOVE LIB       LIB5
     C           X         COMP 6                        20
     C   20                MOVE LIB       LIB6
     C           X         COMP 7                        20
     C   20                MOVE LIB       LIB7
     C           X         COMP 8                        20
     C   20                MOVE LIB       LIB8
     C           X         COMP 9                        20
     C   20                MOVE LIB       LIB9
     C           X         COMP 10                       20
     C   20                MOVE LIB       LIB10
     C           X         COMP 11                       20
     C   20                MOVE LIB       LIB11
     C           X         COMP 12                       20
     C   20                MOVE LIB       LIB12
     C           X         COMP 13                       20
     C   20                MOVE LIB       LIB13
     C           X         COMP 14                       20
     C   20                MOVE LIB       LIB14
     C           X         COMP 15                       20
     C   20                MOVE LIB       LIB15
     C           X         COMP 16                       20
     C   20                MOVE LIB       LIB16
     C           X         COMP 17                       20
     C   20                MOVE LIB       LIB17
     C           X         COMP 18                       20
     C   20                MOVE LIB       LIB18
     C           X         COMP 19                       20
     C   20                MOVE LIB       LIB19
     C           X         COMP 20                       20
     C   20                MOVE LIB       LIB20
     C           X         COMP 21                       20
     C   20                MOVE LIB       LIB21
     C           X         COMP 22                       20
     C   20                MOVE LIB       LIB22
     C           X         COMP 23                       20
     C   20                MOVE LIB       LIB23
     C           X         COMP 24                       20
     C   20                MOVE LIB       LIB24
     C           X         COMP 25                       20
     C   20                MOVE LIB       LIB25
      *
     C                     ENDSR                           MV2DSP
      *
      ********************************************************************
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
