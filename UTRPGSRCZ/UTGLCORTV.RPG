000100191120     H        1
000101200114      ********************************************************************
000102200114/*STD *  RPGBASE                                                         *
000103200114/*EXI *  TEXT('Midas SD MD-39572 Utility program for GLCOAKPD')          *
000104200114      ********************************************************************
000105200114      *                                                                  *
000106200114      *  Midas - Standing Data Module                                    *
000107200114      *                                                                  *
000108200114      *   UTGLCORTV - SD MD-39572 Utility program for GLCOAKPD           *
000109200114      *                                                                  *
000110200114      *  (c) Finastra International Limited 2020                         *
000111200114      *                                                                  *
000112200114      *                 MD039572 *CREATE   Date 14Jan20                  *
000113200114      ********************************************************************
000114200114      *                                                                  *
000115200114      *  MD039572 - FAILED COMPONENT DURING COB - COMPONENT DLC0606C     *
000116200114      ********************************************************************
000120191120     F*FSTART                                                            *
000121191120      ********************************************************************
000122191120     FGLCOAKL0IF  E           K        DISK                           UC
000123200110     FGLCOAKP1O   E                    PRINTER
000124200110      *
000125200110      *
000126200110     ISDBANK    E DSSDBANKPD
000127200110     IDSFDY     E DSDSFDY
000128200110     IDSRUN       DS
000129200110      **  RUNDAT data area data structure (date format -ddmmmyy)
000130200110     I                                        1   7 RDAT
000131200110     I                                        1   2 @DD
000132200110     I                                        3   5 @MMM
000133200110     I                                        6   7 @YY
000134200110     I                                    P   8  100RUND
000135200110     I                                       11  11 SSF
000136200110     I                                       12  12 DATF
000137200110     I                                       13  13 MBIN
000138200110      **  First data structure for access program, Short data structure
000139191120      ************************************************************
000140191120      *MAIN
000141191120      *****************************************************
000142200110     C                     Z-ADD0         TOTAL   40
000143191120     C                     Z-ADD0         PRTLNE  20
000144191120     C                     OPEN GLCOAKL0
000145200110      *
000146200110      **  Access sdbankpd (via aobankr0)
000147200110      *
000148200110     C           PLIST1    PLIST
000149200110     C                     PARM '*DBMSG  '@RTCD   7
000150200110     C                     PARM '*FIRST  '@OPTN   7
000151200110     C           SDBANK    PARM SDBANK    DSFDY
000152200110     C                     CALL 'AOBANKR0'PLIST1
000153200110      *
000154200110      *   Retrieve rundate
000155200110     C           *NAMVAR   DEFN RUNDAT    DSRUN
000156200110     C                     IN   DSRUN
000157191120     C                     Z-ADD0         LTBLK   10
000158191120     C                     SETOF                         12
000159191120     C           *LOVAL    SETLLGLCOAKL0
000160191120     C                     READ GLCOAKL0                 01
000161191120     C           *IN01     DOWEQ*OFF
000162191120      *
000163200110      ** Scan Narrative Codes fields for leading or trailing blanks
000164191120      *
000165191120     C           CONCD1    IFNE *BLANK
000166191120     C           ' '       SCAN CONCD1    LTBLK
000167191120     C           LTBLK     IFNE 0
000168191120     C                     GOTO BLANK
000169191120     C                     ENDIF
000170191120     C                     ENDIF
000171191120      *****
000172191120     C           CONCD2    IFNE *BLANK
000173191120     C           ' '       SCAN CONCD2    LTBLK
000174191120     C           LTBLK     IFNE 0
000175191120     C                     GOTO BLANK
000176191120     C                     ENDIF
000177191120     C                     ENDIF
000178191120      *****
000179191120     C           CONCD3    IFNE *BLANK
000180191120     C           ' '       SCAN CONCD3    LTBLK
000181191120     C           LTBLK     IFNE 0
000182191120     C                     GOTO BLANK
000183191120     C                     ENDIF
000184191120     C                     ENDIF
000185191120      *****
000186191120     C           CONCD4    IFNE *BLANK
000187191120     C           ' '       SCAN CONCD4    LTBLK
000188191120     C           LTBLK     IFNE 0
000189191120     C                     GOTO BLANK
000190191120     C                     ENDIF
000191191120     C                     ENDIF
000192191120      *****
000193191120     C           CONCD5    IFNE *BLANK
000194191120     C           ' '       SCAN CONCD5    LTBLK
000195191120     C           LTBLK     IFNE 0
000196191120     C                     GOTO BLANK
000197191120     C                     ENDIF
000198191120     C                     ENDIF
000199191120      *****
000200191120     C           CONCD6    IFNE *BLANK
000201191120     C           ' '       SCAN CONCD6    LTBLK
000202191120     C                     ENDIF
000203191120      *****
000204191120     C           BLANK     TAG
000205191120     C           LTBLK     IFNE 0
000206191120     C           *IN12     IFNE *ON
000207191120     C                     SETON                         12
000208191120     C                     WRITECPY
000209191120     C                     WRITEHEADER
000210191120     C                     ENDIF
000211191120      *
000212191120      ** Write Narrative Codes
000213191120      *
000214191120     C                     ADD  1         TOTAL
000215191120     C                     ADD  1         PRTLNE
000216191120     C                     MOVE COAKEY    QAKEY
000217191120     C                     MOVE CONCD1    NCD1#
000218191120     C                     MOVE CONCD2    NCD2#
000219191120     C                     MOVE CONCD3    NCD3#
000220191120     C                     MOVE CONCD4    NCD4#
000221191120     C                     MOVE CONCD5    NCD5#
000222191120     C                     MOVE CONCD6    NCD6#
000223191120     C                     WRITEDETAIL
000224200110      *****
000225200110     C           PRTLNE    IFGE 12
000226191120     C                     SETOF                         12
000227191120     C                     Z-ADD0         PRTLNE
000228191120     C                     WRITEBREAK
000229191120     C                     ENDIF
000230191120     C                     ENDIF
000231191120      *****
000232191120     C                     READ GLCOAKL0                 01
000233191120     C                     ENDDO
000234200110      *
000235200110      ** Write Footer if No Record Found
000236200110      *
000237191120     C           TOTAL     IFEQ 0
000238200110     C                     WRITECPY
000239200110     C                     WRITEHEADER
000240200110     C                     SETON                         13
000241191120     C                     ENDIF
000242191120     C                     WRITEFOOTER
000243191120     C                     SETON                     LR
000244191120     C                     RETRN
000245191120      *ENDMAIN
