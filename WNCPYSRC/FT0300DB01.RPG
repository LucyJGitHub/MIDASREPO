      *****************************************************************
      *                                                               *
      *  Last Amend No. MD31937            Date 13Jan15               *
      *  Last Amend No. AR856737           Date 13Sep11               *
      *  Last Amend No.  244728                 Date 04Jan07          *
      *  Prev Amend No.  ERN054                 Date 29Jun04          *
      *                  EEE058                 Date 12Feb2003        *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD31937  - Upgrade STP enhancements to BF Midas 2.1          *
      *  AR856737 - Upgrade STP enhancements to Midas Plus level      *
      *  244728 - Move write to FTCRCKP0 to later in the program.     *
      *  ERN054 - Changes for Agent Authorisation                     *
      *  EEE058 - Incoming STP                                        *
      *                                                               *
      *****************************************************************
      *                                                                                 MAR012MAR015
     C*****      PNL012    IFEQ 'Y'                                                     MAR012MAR015
      ********** ERAUTH    ANDEQ'Y'                                                     MAR012MAR015
     C*****                MOVELINPREF    CRPREF                                        MAR012MAR015
     C*****                MOVEL'D'       CRRECI                                              MAR015
     C*****                WRITE@CRCKP0                                                 MAR012MAR015
     C*****                ENDIF                                                        MAR012MAR015
      *****                                                                             MAR015244728
     C*****      @REC1     IFEQ 'Y'                                                     MAR015244728
     C*****                MOVELV1RECI    CRRECI                                        MAR015244728
     C*****                MOVELINPREF    CRPREF                                        MAR015244728
     C*****                MOVELV1BRCA    CRBRCA                                        MAR015244728
     C*****                MOVELV1CNUM    CRCNUM                                        MAR015244728
     C*****                MOVELV1CCY     CRCCY                                         MAR015244728
     C*****                MOVELV1ACOD    CRACOD                                        MAR015244728
     C*****                MOVELV1ACSQ    CRACSQ                                        MAR015244728
     C*****                Z-ADDV1SMAM    CRSMAM                                        MAR015244728
     C*****                Z-ADDV1CLBL    CRCLBL                                        MAR015244728
     C*****                Z-ADDV1ODLN    CRODLN                                        MAR015244728
     C*****                Z-ADDV1AVBL    CRAVBL                                        MAR015244728
     C*****                WRITE@CRCKP0                                                 MAR015244728
     C*****                ENDIF                                                        MAR015244728
      *****                                                                             MAR015244728
     C*****      @REC2     IFEQ 'Y'                                                     MAR015244728
     C*****                MOVELV2RECI    CRRECI                                        MAR015244728
     C*****                MOVELINPREF    CRPREF                                        MAR015244728
     C*****                MOVELV2BRCA    CRBRCA                                        MAR015244728
     C*****                MOVELV2CNUM    CRCNUM                                        MAR015244728
     C*****                MOVELV2CCY     CRCCY                                         MAR015244728
     C*****                MOVELV2ACOD    CRACOD                                        MAR015244728
     C*****                MOVELV2ACSQ    CRACSQ                                        MAR015244728
     C*****                Z-ADDV2SMAM    CRSMAM                                        MAR015244728
     C*****                Z-ADDV2CLBL    CRCLBL                                        MAR015244728
     C*****                Z-ADDV2ODLN    CRODLN                                        MAR015244728
     C*****                Z-ADDV2AVBL    CRAVBL                                        MAR015244728
     C*****                WRITE@CRCKP0                                                 MAR015244728
     C*****                ENDIF                                                        MAR015244728
      *****                                                                             MAR015244728
     C*****      @REC1     IFNE 'Y'                                                     MAR015244728
     C*****      @REC2     ANDNE'Y'                                                     MAR015244728
     C*****      AUIN      ANDEQ'Y'                                                     MAR015244728
     C*****                MOVELINPREF    CRPREF                                        MAR015244728
     C*****                MOVEL'D'       CRRECI                                        MAR015244728
     C*****                WRITE@CRCKP0                                                 MAR015244728
     C*****                ENDIF                                                        MAR015244728
      *****                                                                             MAR012244728
      *                                                                                       EEE058
      *  Test to see if FTPEXTP0 needs to be written to                                       EEE058
      *                                                                                       EEE058
     C           EEE058    IFEQ *BLANKS                                                       EEE058
      *                                                                                       EEE058
      *  Test for Mt910 processing active                                                     EEE058
      *                                                                                       EEE058
     C                     CALL 'AOSARDR0'                                                    EEE058
     C                     PARM *BLANKS   P@RTCD                                              EEE058
     C                     PARM '*VERIFY' P@OPTN                                              EEE058
     C                     PARM 'EEE058'  @SARD                                               EEE058
     C           SCSARD    PARM *BLANKS   DSFDY                                               EEE058
      *                                                                                       EEE058
      *  EEE058 processing active                                                             EEE058
      *                                                                                       EEE058
     C           P@RTCD    IFEQ *BLANKS                                                       EEE058
     C                     MOVEL'EEE058'  EEE058  6                                           EEE058
     C                     OPEN FTPEXTP0                                                      EEE058
     C                     ENDIF                                                              EEE058
     C                     ENDIF                                                              EEE058
      *                                                                                       EEE058
      *  If EEE058 write extension data                                                       EEE058
      *                                                                                       EEE058
     C           EEE058    IFEQ 'EEE058'                                                      EEE058
      * get data                                                                              EEE058
     C                     CALL 'FTP960'                                                      EEE058
     C                     PARM *BLANKS   P9RTN                                               EEE058
     C                     PARM           P9PEXT                                              EEE058
      * set payment reference and write                                                       EEE058
     C                     MOVELPREF      PXPREF                                              EEE058
     C                     MOVELGNMTPY    PXMTPY                                              EEE058
     C                     Z-ADDGNMSET    PXMSET                                              EEE058
     C                     WRITE@PEXTP0                                                       EEE058
     C                     ENDIF                                                              EEE058
      *                                                                                       ERN054
      *                                                                                       ERN054
      *****************************************************************
      * End of FT0300DB01                                             *
      *****************************************************************
