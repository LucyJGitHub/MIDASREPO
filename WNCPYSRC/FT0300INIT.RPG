      *---------------------------------------------------------------*    
      *   Last Amend No. MD031937           Date 13Jan15              *
      *   Prev Amend No. AR856737           Date 13Sep11              *
      *                  MMFIX1             Date 05Oct11              *
      *                  PNL012             Date 16Sep05              *    
      *                  EEE065             Date 26Aug03              *
      *                  EEE019    *CREATE  DATE 05JUL99              *
      *                                                               *    
      *---------------------------------------------------------------*    
      *  MD031937 - Upgrade STP enhancements to BF Midas 2.1          *
      *  AR856737 - Upgrade STP enhancements to Midas Plus level      *
      *  MMFXI1 - FTPEXTP0 not opened when EEE058 checked.            *
      *  PNL012 - Account Payments Authorisation Processing           *    
      *  EEE065 - Polish Features Upgrade R4                          *
      *           Add Impact of CGL009 and CFT014                     *
      *  EEE019 - MT100 Interface with MultiCash.                     *
      *****************************************************************
      *                                                                   ERN031
      ** Access SAR details file to see if ERN031 is installed            ERN031
     C                     CALL 'AOSARDR0'                                ERN031
     C                     PARM *BLANKS   P@RTCD                          ERN031
     C                     PARM '*VERIFY' P@OPTN                          ERN031
     C                     PARM 'ERN031'  @SARD                           ERN031
     C           SCSARD    PARM *BLANKS   DSFDY                           ERN031
      *                                                                   ERN031
      ** Allow Electronic Advices processing                              ERN031
     C           P@RTCD    IFEQ *BLANKS                                   ERN031
     C                     MOVE 'Y'       ERN031  1                       ERN031
     C                     ELSE                                           ERN031
     C                     MOVE 'N'       ERN031                          ERN031
     C                     ENDIF                                          ERN031
      *                                                                   ERN031
      *                                                                   EEE019
      ** Check if feature EEE019 is switched on                           EEE019
      *                                                                   EEE019
     C                     CALL 'AOSARDR0'                                EEE019
     C                     PARM *BLANKS   P@RTCD                          EEE019
     C                     PARM '*VERIFY' P@OPTN                          EEE019
     C                     PARM 'EEE019'  @SARD                           EEE019
     C           SCSARD    PARM *BLANKS   DSFDY                           EEE019
      *                                                                   EEE019
      ** Allow MT940 processing                                           EEE019
      *                                                                   EEE019
     C           P@RTCD    IFEQ *BLANKS                                   EEE019
     C                     MOVEL'Y'       EEE019  1                       EEE019
     C                     ELSE                                           EEE019
      *                                                                   EEE019
      ** Else database error (return code other than *NRF)                EEE019
      *                                                                   EEE019
     C           P@RTCD    IFNE '*NRF   '                                 EEE019
     C                     MOVEL'SCSARDPD'W0FILE           ************   EEE019
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 98 *   EEE019
     C                     Z-ADD98        W0ERNB           ************   EEE019
     C                     EXSR SRERRA                     *ABORT PGM*    EEE019
     C                     ENDIF                                          EEE019
      *                                                                   EEE019
     C                     ENDIF                                          EEE019
      *                                                                   EEE019
     C                     CALL 'AOSARDR0'                                PNL012
     C                     PARM *BLANKS   P@RTCD                          PNL012
     C                     PARM '*VERIFY' P@OPTN                          PNL012
     C                     PARM 'PNL012'  @SARD                           PNL012
     C           SCSARD    PARM *BLANKS   DSFDY                           PNL012
      *                                                                   PNL012
      *  PNL012 processing active                                         PNL012
      *                                                                   PNL012
     C                     MOVEL'N'       PNL012  1                       PNL012
     C           P@RTCD    IFEQ *BLANKS                                   PNL012
     C                     MOVEL'Y'       PNL012                          PNL012
     C                     ENDIF                                          PNL012
      *                                                                   PNL012
      *                                                                                       EEE058
      *  Test to see if PCAT Statistics should be used                                        EEE058
      *                                                                                       EEE058
      *  Test for EEE058processing active                                                     EEE058
      *                                                                                       EEE058
     C                     CALL 'AOSARDR0'                                                    EEE058
     C                     PARM *BLANKS   P@RTCD                                              EEE058
     C                     PARM '*VERIFY' P@OPTN                                              EEE058
     C                     PARM 'EEE058'  @SARD                                               EEE058
     C           SCSARD    PARM *BLANKS   DSFDY                                               EEE058
      *                                                                                       EEE058
      *  EEE058 processing active                                                             EEE058
      *                                                                                       EEE058
     C                     MOVE *BLANKS   EEE058  6                                           EEE058
     C           P@RTCD    IFEQ *BLANKS                                                       EEE058
     C                     MOVEL'EEE058'  EEE058                                              EEE058
     C                     OPEN FTPEXTP0                                                      MMFIX1
     C                     ENDIF                                                              EEE058
      *
      *                                                                                       ERN054
      *  Test to see if PCAT Statistics extension is active                                   ERN054
      *                                                                                       ERN054
     C                     CALL 'AOSARDR0'                                                    ERN054
     C                     PARM *BLANKS   P@RTCD                                              ERN054
     C                     PARM '*VERIFY' P@OPTN                                              ERN054
     C                     PARM 'ERN054'  @SARD                                               ERN054
     C           SCSARD    PARM *BLANKS   DSFDY                                               ERN054
      *                                                                                       ERN054
      *  ERN054 processing active                                                             ERN054
      *                                                                                       ERN054
     C                     MOVE *BLANKS   ERN054  6                                           ERN054
     C           P@RTCD    IFEQ *BLANKS                                                       ERN054
     C                     MOVEL'ERN054'  ERN054                                              ERN054
     C                     ENDIF                                                              ERN054
      *
      *************************************************************************
      * End of copy hook FT0300INIT                                           *
      *************************************************************************
