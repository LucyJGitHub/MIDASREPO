      *****************************************************************
      *                                                               *
      *  Last Amend No. MD31937            Date 13Jan15               *
      *  Last Amend No. AR856737           Date 13Sep11               *
      *  Last Amend No.  CFT032                 Date 09Dec07          *
      *  Prev Amend No.  PNL012                 Date 16Sep05          *   PNL012
      *                  ESL038                 Date 04Oct2004        *
      *                  ESL038 *Create         Date 29Jun2004        *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD31937  - Upgrade STP enhancements to BF Midas 2.1          *
      *  AR856737 - Upgrade STP enhancements to Midas Plus level      *
      *           - Insufficient Fund check flag incorrectly reset    *
      *  CFT032 - Ordering Customer Account Line Swift 2007 Changes   *
      *  PNL012 - Account Payments Authorisation Processing           *   PNL012
      *  ESL038 - ING STP Development                                 *
      *  ESL038 - Agent Message Changes                               *
      *                                                               *
      *****************************************************************
      *                                                                                       ESL038
     C*****                MOVEL'N'       @RCD                                      ESL038  AR856737
      *                                                                                       ESL038
      *  Test to see if ESL038 processing active                                              ESL038
      *                                                                                       ESL038
     C           ESL038    IFEQ *BLANKS                                                       ESL038
     C                     CALL 'AOSARDR0'                                                    ESL038
     C                     PARM *BLANKS   P@RTCD                                              ESL038
     C                     PARM '*VERIFY' P@OPTN                                              ESL038
     C                     PARM 'ESL038'  @SARD                                               ESL038
     C           SCSARD    PARM *BLANKS   DSFDY                                               ESL038
      *                                                                                       ESL038
     C           P@RTCD    IFEQ *BLANKS                                                       ESL038
     C                     MOVEL'ESL038'  ESL038                                              ESL038
     C                     ENDIF                                                              ESL038
     C                     ENDIF                                                              ESL038
      *                                                                                       ESL038
      *  If ESL038 call validator                                                             ESL038
      *                                                                                       ESL038
     C           ESL038    IFEQ 'ESL038'                                                ESL038MAR013
      *                                                                                 ESL038MAR013
     C                     MOVEL'N'       @RCD                                              AR856737
      * Clear parameters                                                                ESL038MAR013
     C                     CLEARP@IDTA                                                  ESL038MAR013
     C                     CLEARP@ODTA                                                  ESL038MAR013
     C                     CLEARSOODTA                                                  ESL038MAR013
      * Debit side                                                                      ESL038MAR013
      * Outgoing Payments                                                               ESL038MAR013
      * Account currency, amount, date                                                  ESL038MAR013
     C                     MOVELS4SMCY    PICCY                                         ESL038MAR013
     C                     Z-ADDF4SMAM    PIAMNT                                        ESL038MAR013
     C           S7CDRO    IFEQ *BLANKS                                                       MAR013
     C           OTADDC    ANDEQ'A'                                                           MAR013
     C                     ADD  OTTRCM    PIAMNT                                              MAR013
     C                     ADD  OTTXCH    PIAMNT                                              MAR013
     C                     ADD  OTCQCH    PIAMNT                                              MAR013
     C                     ADD  OTCSTA    PIAMNT                                              MAR013
     C                     ADD  OTSPCH    PIAMNT                                              MAR013
     C                     ADD  OMISC1    PIAMNT                                              MAR013
     C                     ADD  OMISC2    PIAMNT                                              MAR013
     C                     ADD  OMISC3    PIAMNT                                              MAR013
     C                     ADD  OMISC4    PIAMNT                                              MAR013
     C                     ADD  OMISC5    PIAMNT                                              MAR013
     C                     ADD  OTVATT    PIAMNT                                              MAR013
     C                     ADD  OSWSCH    PIAMNT                                              MAR013
     C                     ENDIF                                                              MAR013
     C                     Z-ADDF4SLDT    PIPDTE                                        ESL038MAR013
      * Payment Reference and type                                                      ESL038MAR013
     C                     MOVELS4PREF    PIPREF                                        ESL038MAR013
     C                     MOVELS4PYTP    PIPTYP                                        ESL038MAR013
     C                     MOVELS4BRCA    PIBRCB                                        ESL038MAR013
      * Party one                                                                       ESL038MAR013
     C                     MOVELF4ORCT    PITP1                                         ESL038MAR013
     C           F4ORCT    IFEQ 'I'                                                           CFT032
     C                     MOVELV#FRGL    W#CNUM  6                                           CFT032
     C                     MOVE V#FRGL    @ACNT                                               CFT032
     C                     MOVELW#CNUM    @ACNT                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELS4ORC1    @ACNT                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVEL@ACNT     PIPRY1                                              CFT032
      *********            MOVELS4ORC1    PIPRY1                                              CFT032
     C                     MOVEL*BLANKS   PIBRC1                                        ESL038MAR013
      * Party two                                                                       ESL038MAR013
     C                     MOVELF4ORBT    PITP2                                         ESL038MAR013
     C                     MOVELS4ORBK    PIPRY2                                        ESL038MAR013
     C                     MOVELS4ORBB    PIBRC2                                        ESL038MAR013
      * Party three                                                                     ESL038MAR013
     C                     MOVEL*BLANKS   PITP3                                         ESL038MAR013
     C                     MOVEL*BLANKS   PIPRY3                                        ESL038MAR013
     C                     MOVEL*BLANKS   PIBRC3                                        ESL038MAR013
      *                                                                                 ESL038MAR013
      * Call validator                                                                  ESL038MAR013
     C                     CALL 'FTP780'                                                ESL038MAR013
     C                     PARM           P@RTCE  7                                     ESL038MAR013
     C                     PARM 'NO'      P@DSP   3                                     ESL038MAR013
     C                     PARM           P@IDTA                                        ESL038MAR013
     C                     PARM           P@ODTA                                        ESL038MAR013
     C                     PARM 'N'       P@AUTH                                        ESL038MAR013
      *                                                                                 ESL038MAR013
     C                     MOVELP@ODTA    SOODTA256
      *                                                                                 ESL038MAR013
     C           P@RTCE    IFNE '*NOCHK '                                               ESL038MAR013
     C           P@RTCE    ANDNE*BLANKS                                                 ESL038MAR013
     C           P@RTCE    ANDNE'*OVER  '                                               ESL038MAR013
     C                     MOVE 'Y'       ERAUTH                                        ESL038MAR013
     C                     MOVEL'Y'       @RCD                                          ESL038MAR013
     C                     MOVEL'Y'       @REC1                                         ESL038MAR013
     C           P@RTCE    CAT  P@ODTA    W0MSDT                                        ESL038MAR013
     C                     MOVEL'STP0036' W0LMSG                                        ESL038MAR013
     C                     MOVEL'XXUSRMSG'W0MSGF                                        ESL038MAR013
     C                     EXSR SRLOG                                                   ESL038MAR013
      * Save Principal data.                                                                  MAR015
     C                     MOVEL'D'       V1RECI                                        MAR012MAR015
     C                     MOVELS4PREF    V1PREF                                              MAR015
     C                     MOVELPOBRCA    V1BRCA                                        MAR012MAR015
     C                     MOVELPOCNUM    V1CNUM                                        MAR012MAR015
     C                     MOVELPOCCY     V1CCY                                         MAR012MAR015
     C                     MOVELPOACOD    V1ACOD                                        MAR012MAR015
     C                     MOVELPOACSQ    V1ACSQ                                        MAR012MAR015
      * Balances on Authorisation                                                       MAR012MAR013
     C                     Z-ADDPIAMNT    V1SMAM                                        MAR012MAR015
     C                     Z-ADDPOCLBL    V1CLBL                                        MAR012MAR015
     C                     Z-ADDPOODLN    V1ODLN                                        MAR012MAR015
     C                     Z-ADDPOAVBL    V1AVBL                                        MAR012MAR015
     C                     ENDIF                                                        ESL038MAR013
      *
      *                                                                                 MAR012MAR013
     C           PNL012    IFEQ 'Y'                                                     PNL012MAR013
     C           F7CDRT    IFNE *BLANKS                                                 PNL012MAR013
     C           S7CDRO    ORNE *BLANKS                                                 PNL012MAR013
     C           S7CDBR    ORNE *BLANKS                                                 PNL012MAR013
      * Account currency, amount, date                                                  PNL012MAR013
      *                                                                                 PNL012MAR013
     C                     MOVELV#CCCY    PICCY                                         PNL012MAR013
      *                                                                                 PNL012MAR013
     C                     Z-ADDOTTRCM    PIAMNT                                        PNL012MAR013
     C                     ADD  OTTXCH    PIAMNT                                              MAR013
     C                     ADD  OTCQCH    PIAMNT                                              MAR013
     C                     ADD  OTCSTA    PIAMNT                                              MAR013
     C                     ADD  OTSPCH    PIAMNT                                              MAR013
     C                     ADD  OTMSCH    PIAMNT                                              MAR013
     C                     ADD  OMISC1    PIAMNT                                              MAR013
     C                     ADD  OMISC2    PIAMNT                                              MAR013
     C                     ADD  OMISC3    PIAMNT                                              MAR013
     C                     ADD  OMISC4    PIAMNT                                              MAR013
     C                     ADD  OMISC5    PIAMNT                                              MAR013
     C                     ADD  OTVATT    PIAMNT                                              MAR013
     C                     ADD  OSWSCH    PIAMNT                                              MAR013
      *                                                                                 PNL012MAR013
     C                     Z-ADDF4SLDT    PIPDTE                                        PNL012MAR013
      **Payment Reference and type                                                      PNL012MAR013
     C                     MOVELS4PREF    PIPREF                                        PNL012MAR013
     C                     MOVELS4PYTP    PIPTYP                                        PNL012MAR013
     C                     MOVELS4BRCA    PIBRCB                                        PNL012MAR013
      * Party one                                                                       PNL012MAR013
     C                     MOVEL*BLANKS   PITP1                                         PNL012MAR013
     C                     MOVEL*BLANKS   PIPRY1                                        PNL012MAR013
     C                     MOVEL*BLANKS   PIBRC1                                        PNL012MAR013
      * Party two                                                                       PNL012MAR013
     C                     MOVEL*BLANKS   PITP2                                         PNL012MAR013
     C                     MOVEL*BLANKS   PIPRY2                                        PNL012MAR013
     C                     MOVEL*BLANKS   PIBRC2                                        PNL012MAR013
      * Party three                                                                     PNL012MAR013
     C                     MOVELF7CDRT    PITP3                                         PNL012MAR013
     C                     MOVELS7CDRO    PIPRY3                                        PNL012MAR013
     C                     MOVELS7CDBR    PIBRC3                                        PNL012MAR013
      *                                                                                 PNL012MAR013
      **Call validator                                                                  PNL012MAR013
     C                     CALL 'FTP780'                                                PNL012MAR013
     C                     PARM           P@RTCE  7                                     PNL012MAR013
     C                     PARM 'NO'      P@DSP   3                                     PNL012MAR013
     C                     PARM           P@IDTA                                        PNL012MAR013
     C                     PARM           P@ODTA                                        PNL012MAR013
     C                     PARM 'N'       P@AUTH  1                                     PNL012MAR013
      *                                                                                 PNL012MAR013
     C                     MOVELP@ODTA    SOODTA
      *
     C           P@RTCE    IFNE '*NOCHK '                                               PNL012MAR013
     C           P@RTCE    ANDNE*BLANKS                                                 PNL012MAR013
     C           P@RTCE    ANDNE'*OVER  '                                               PNL012MAR013
     C                     MOVE 'Y'       ERAUTH                                        PNL012MAR013
     C                     MOVEL'Y'       @RCD                                          PNL012MAR013
     C                     MOVEL'Y'       @REC2                                         ESL038MAR013
     C           P@RTCE    CAT  P@ODTA    W0MSDT                                        PNL012MAR013
     C                     MOVEL'STP0036' W0LMSG                                        PNL012MAR013
     C                     MOVEL'XXUSRMSG'W0MSGF                                        PNL012MAR013
     C                     EXSR SRLOG                                                   PNL012MAR013
      *
     C                     MOVEL'D'       V2RECI  1                                     MAR012MAR015
     C                     MOVELS4PREF    V2PREF 15                                           MAR015
     C                     MOVELPOBRCA    V2BRCA  3                                     MAR012MAR015
     C                     MOVELPOCNUM    V2CNUM  6                                     MAR012MAR015
     C                     MOVELPOCCY     V2CCY   3                                     MAR012MAR015
     C                     MOVELPOACOD    V2ACOD  4                                     MAR012MAR015
     C                     MOVELPOACSQ    V2ACSQ  2                                     MAR012MAR015
      * Balances on Authorisation                                                       MAR012MAR013
     C                     Z-ADDPIAMNT    V2SMAM 150                                    MAR012MAR015
     C                     Z-ADDPOCLBL    V2CLBL 150                                    MAR012MAR015
     C                     Z-ADDPOODLN    V2ODLN 150                                    MAR012MAR015
     C                     Z-ADDPOAVBL    V2AVBL 150                                    MAR012MAR015
      *                                                                                 MAR012MAR013
     C                     ENDIF                                                        PNL012MAR013
      *                                                                                 PNL012MAR013
     C                     ENDIF                                                        PNL012MAR013
     C                     ENDIF                                                        PNL012MAR013
     C                     MOVELP@RTCE    U0RTCE  7
      *                                                                                 PNL012MAR013
      *                                                                                 PNL012MAR013
      * Credit side                                                                     ESL038MAR013
      * Outgoing Payments                                                               ESL038MAR013
     C           PNL012    IFEQ 'Y'                                                           MAR013
      * Account currency, amount, date                                                        ESL038
     C                     MOVELS4PCCY    PICCY                                         ESL038MAR013
     C                     Z-ADDF4PYAM    PIAMNT                                        ESL038MAR013
     C                     MOVELS4SMCY    PICCY                                               MAR013
     C                     Z-ADDF4PVDT    PIPDTE                                              ESL038
      * Payment Reference and type                                                            ESL038
     C                     MOVELS4PREF    PIPREF                                              ESL038
     C                     MOVELS4PYTP    PIPTYP                                              ESL038
     C                     MOVELS4BRCA    PIBRCB                                              ESL038
      ** Set up FX data                                                                       ESL038
     C                     MOVELS4SMCY    PISMCY                                              ESL038
     C                     Z-ADDF4SMAM    PISMAM                                              ESL038
     C                     Z-ADDF4RATE    PIRATE                                              ESL038
     C                     MOVELS4PCCY    PIPCCY                                              ESL038
     C                     Z-ADDF4PYAM    PIPYAM                                              ESL038
      * Party one                                                                             ESL038
     C                     MOVELF4DSTT    PITP1                                         ESL038MAR013
     C                     MOVELS4DST1    PIPRY1                                        ESL038MAR013
     C                     MOVEL*BLANKS   PIBRC1                                        ESL038MAR013
      * Party two                                                                             ESL038
     C                     MOVELF4SNCT    PITP2                                         ESL038MAR013
     C                     MOVELS4SNCO    PIPRY2                                        ESL038MAR013
     C                     MOVEL*BLANKS   PIBRC2                                        ESL038MAR013
      * Party three                                                                           ESL038
     C                     MOVEL*BLANKS   PITP3                                               ESL038
     C                     MOVEL*BLANKS   PIPRY3                                              ESL038
     C                     MOVEL*BLANKS   PIBRC3                                              ESL038
      *                                                                                       MAR013
      *                                                                                       ESL038
      * Call validator                                                                        ESL038
     C                     CALL 'FTP780'                                                      ESL038
     C                     PARM           P@RTCE  7                                           ESL038
     C                     PARM 'NO'      P@DSP   3                                           ESL038
     C                     PARM           P@IDTA                                              ESL038
     C                     PARM           P@ODTA                                              ESL038
     C                     PARM 'N'       P@AUTH  1                                           PNL012
      *                                                                                 ESL038MAR015
     C           P@RTCE    IFNE '*NOCHK '                                               ESL038MAR015
     C           P@RTCE    ANDNE*BLANKS                                                 ESL038MAR015
     C           P@RTCE    ANDNE'*OVER  '                                               ESL038MAR015
     C                     MOVE 'Y'       ERAUTH                                        ESL038MAR015
     C                     MOVEL'Y'       @RCD                                          ESL038MAR015
     C           P@RTCE    CAT  P@ODTA    W0MSDT                                        ESL038MAR015
     C                     MOVEL'STP0036' W0LMSG                                        ESL038MAR015
     C                     MOVEL'XXUSRMSG'W0MSGF                                        ESL038MAR015
     C                     EXSR SRLOG                                                   ESL038MAR015
      *                                                                                 ESL038MAR015
     C                     ENDIF                                                        ESL038MAR015
      * Credit Check                                                                    MAR012MAR013
     C                     MOVELPODRCK    CRDRCK                                        MAR012MAR013
     C                     MOVEL*BLANKS   CRCPRF                                        MAR012MAR013
     C                     MOVELU0RTCE    CROVRT                                        MAR012MAR013
     C                     MOVELPOBRCA    CRCBRC                                        MAR012MAR013
     C                     MOVELPOCNUM    CRCCUS                                        MAR012MAR013
     C                     MOVELPOCCY     CRCCCY                                        MAR012MAR013
     C                     MOVELPOACOD    CRCACD                                        MAR012MAR013
     C                     MOVELPOACSQ    CRCASQ                                        MAR012MAR013
      *                                                                                 MAR012MAR013
      *                                                                                       ESL038
     C                     ENDIF                                                              ESL038
     C                     ENDIF                                                              ESL038
      * Outgoing Payments                                                                     ESL038
     C                     SELEC                                                              ESL038
     C           S4PYTP    WHEQ 'OP'                                                          ESL038
     C           S4STMT    ANDEQ'08'                                                          ESL038
     C           F4PVDT    ANDLTBJRDNB                                                        ESL038
     C                     MOVE 'Y'       ERAUTH                                              ESL038
     C                     MOVEL'ST10003' W0LMSG                                              ESL038
     C                     MOVEL'XXUSRMSG'W0MSGF                                              ESL038
     C                     EXSR SRLOG                                                         ESL038
     C                     ENDSL                                                              ESL038
      *                                                                                       ESL038
      *****************************************************************
      * End of FT0300RK02                                             *
      *****************************************************************
