000100210907                                                                  H DEBUG
000101210907     H
000102210907      *****************************************************************
000103210907/*STD *  RPGBASEMOD                                                   *
000104210907/*EXI *  TEXT('Midas XX TAB001 upload to XXACHOMTD')                  *
000105210907      *****************************************************************
000106210907      *                                                               *
000107210907      *  Midas - General Ledger Module                                *
000108210907      *                                                               *
000109210907      *  XX005005 - Midas XX TAB001 upload to XXACHOMTD               *
000110210907      *                                                               *
000111210907      *  (c) Finastra International Limited 2021                      *
000112210907      *                                                               *
000113210907      *  Last Amend No. DRI005  *CREATE    Date 13Apr21               *
000114210907      *                                                               *
000115210907      *---------------------------------------------------------------*
000116210907      *                                                               *
000117210907      *  DRI005 - HO and EDW Extracts                                 *
000118210907      *                                                               *
000119210907      *****************************************************************
000120210907      *
000121210907     FTAB001L0  IF   E           K Disk    InfSR(*PSSR)
000122210907      *
000123210907     FXXACHOML0 UF A E           K Disk    InfSR(*PSSR)
000124210907      *
000125210907      /Title Function of indicators
000126210907     F*****************************************************************
000127210907     F*                                                               *
000128210907     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
000129210907     F*                                                               *
000130210907     F*                                                               *
000131210907     F*  90-99 - Used by Standard Subroutines                         *
000132210907     F*                                                               *
000133210907     F*  U7+U8 - Database Error                                       *
000134210907     F*                                                               *
000135210907     F*****************************************************************
000136210907      /Title Subroutine Index
000137210907     F*****************************************************************
000138210907     F*                                                               *
000139210907     F*  S U B R O U T I N E   I N D E X                              *
000140210907     F*                                                               *
000141210907     F*  Init      - Initial Processing                               *
000142210907     F*  Proces    - Main processing                                  *
000143210907     F*                                                               *
000144210907     F*  *PSSR     - Program error handling routine                   *
000145210907     F*                                                               *
000146210907     F*****************************************************************
000147210907     D/Title D-Specifications
000148210907     D CPY@            S             80    Dim(1) CTData PerRCD(1)
000149210907      ***  Array for Object Copyright Statement.
000150210907      *
000151210907     D SDBANK        E DS                  ExtName(SDBANKPD)
000152210907      ** Bank Details
000153210907      *
000154210907     D DSSDY         E DS                  ExtName(DSSDY)
000155210907      ** Second DS For Access Programs, Long Data Structure
000156210907      *
000157210907     D DBERR           DS           256
000158210907      * Data structure for data-base error processing
000159210907     D  DBFILE               134    141
000160210907     D  DBKEY                142    170
000161210907     D  DBPGM                171    180
000162210907     D  DBASE                181    183  0
000163210907      *
000164210907
000165210907     C/Title Main Processing
000166210907      *================================================================
000167210907      *  P R O G R A M     S T A R T                                  *
000168210907      *================================================================
000169210907      *
000170210907      * Perform Initialisation.
000171210907     C                   ExSR      Init
000172210907      *
000173210907      * Perform Upload from TAB001
000174210907     C                   ExSR      UpLoad
000175210907      *
000176210907     C                   SetOn                                        LR
000177210907     C                   Return
000178210907      *================================================================
000179210907      *  P R O G R A M     E N D                                      *
000180210907      *================================================================
000181210907      /Title SR/Init
000182210907      *****************************************************************
000183210907      *                                                               *
000184210907      *  Init   - Subroutine to do Program Initialisation.            *
000185210907      *                                                               *
000186210907      *  Called By: Main Processing                                   *
000187210907      *  Calls    : None                                              *
000188210907      *                                                               *
000189210907      *****************************************************************
000190210907      *
000191210907     C     Init          BegSR
000192210907      *
000193210907      ***  Copyright Statement.
000194210907     C                   MoveA     CPY@          BIS@             80
000195210907      *
000196210907      ** Klist to access the XXFEEDDTD file
000197210907     C     KACHOD        KList
000198210907     C                   KFld                    KACOD            10 0
000199210907      *
000200210907     C                   EndSR
000201210907      *****************************************************************
000202210907      /Title SR/Feeder
000203210907      *****************************************************************
000204210907      *                                                               *
000205210907      *  UpLoad - Subroutine to upload recs from TAB001 to XXACHOMTD  *
000206210907      *                                                               *
000207210907      *  Called By: Main Processing                                   *
000208210907      *  Calls:                                                       *
000209210907      *                                                               *
000210210907      *****************************************************************
000211210907      *
000212210907     C     UpLoad        BegSR
000213210907      *
000214210907      ** Access TAB001
000215210907      ** Write to XXACHOMTD
000216210907     C     *LOVAL        SETLL     TAB001L0
000217210907     C                   READ      TAB001L0                               50
000218210907     C                   Dow       *IN50 = '0'
000219210907      *
000220210907     C                   MOVEL     ACODE         WKACOD           10
000221210907     C                   MOVE      '000000'      WKACOD
000222210907     C                   MOVEL     WKACOD        KACOD
000223210907     C     KACHOD        CHAIN     XXACHOML0                          51
000224210907     C                   if        *IN51 = '1'
000225210907     C                   Z-ADD     KACOD         XXMACOD
000226210907     C                   Z-ADD     ACODE1        XXMHOAC
000227210907     C                   MOVEL     PRCODE1       XXMHOPC
000228210907     C                   MOVEL     MKCODE1       XXMHOMC
000229210907     C                   MOVEL     'N'           XXMEXCL
000230210907     C                   WRITE     XXACHOMD0
000231210907     C                   ENDIF
000232210907      *
000233210907     C                   READ      TAB001L0                               50
000234210907     C                   ENDDO
000235210907      *
000236210907     C                   EndSR
000237210907      *
000238210907      *****************************************************************
000239210907      /Title SR/*PSSR
000240210907      *****************************************************************
000241210907      *                                                               *
000242210907      *  *PSSR  - Program Error Processing Subroutine.                *
000243210907      *                                                               *
000244210907      *  Called By: Various                                           *
000245210907      *                                                               *
000246210907      *****************************************************************
000247210907      *
000248210907     C     *PSSR         BegSR                                                  *** *PSSR  ***
000249210907      *
000250210907      ***  Check to see that *PSSR has not already been called.
000251210907     C                   If        WRUN = *BLANK
000252210907     C                   Move      'Y'           WRUN              1
000253210907     C                   MoveL     'XX005005'    DBPGM
000254210907      *
000255210907     C     *DTAARA       Define    LDA           WLDA            256
000256210907     C     *Lock         In        WLDA
000257210907     C                   MoveL     DBERR         WLDA
000258210907     C                   Out       WLDA
000259210907     C                   SetOn                                        U7U8LR
000260210907      *
000261210907     C                   Dump
000262210907     C                   EndIf
000263210907      *
000264210907      ** Exit program
000265210907     C                   Return
000266210907      *
000267210907     C                   EndSR
000268210907      *
000269210907      *****************************************************************
000270210907      ***
000271210907**  CPY@
000272210907(c) Finastra Ltd 2021
