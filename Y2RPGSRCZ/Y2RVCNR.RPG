      *****************************************************************
      *                                                               *
      *  Midas - (module name) Module                                 *
      *                                                               *
      *  mmnnnn - (Program Name)                                      *
      *                                                               *
      *  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
      *  (phase(s))                                                   *
      *                                                               *
      *  Called By: mmCnnnn - (program name)                          *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *  Prev Amend No. Xnnnnn  *CREATE    Date ddmmmyy               *
      *                                    Date ddmmmyy               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  nnnnnn - (fix details)                                       *
      *                                                               *
     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Y2 R2.1.1 Retrieve condition name')
     H/TITLE YAPPOBJ Retrieve Condition Name
     Z* CRTRPGPGM
     Y* OVRDBF Y2VLLSL0 YYVLLSL0
     H* System        : SYNON/2  SHIPPED ROUTINE
     H* AUTHOR        : JPL
     H* DATE          : 1987
      *  (c) Finastra International Limited 2001                      *
     W* LR IS NOT SET ON
      *================================================================
     M* 05.10.87 JPL - Remove KIGNORE - causing problems later on
      *================================================================
     H* SYNOPSIS :
     H*  - Retrieves Condition name for a nominated field (eg list)
     H*  - at its current value.
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FY2VLLSL0IF  E           K        DISK         KINFDS INFDS1     UC
      * Values list               Retrieval index
      *
      /EJECT
     E                    @OV    19  19  2
      * Override to correct values list file.
      /EJECT
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IINFDS1    E DSY2I1DSP
      * File information data structure.
      /EJECT
      * Parameter declarations.
     IP1PARM      DS
      * FLD: Values list               Retrieval index
      * List number
     I                                    P   1   40P1LSNO
      * External value.
     I                                        5  24 P1INVL
      * Value mapped field?
     I                                       25  25 P1VLMP
      * Retrieved condition name
     I                                       26  50 P1CNNM
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           P0RTN   7        Return code
     C           P1LSNO    PARM           WP0001  70       List number
     C           P1INVL    PARM           WP0002 20        Internal value
     C           P1VLMP    PARM           WP0003  1        Value Mapped?
     C                     PARM P1CNNM    WP0004 25        Condition Name
      *****************************************************************
     C                     MOVE *BLANK    P0RTN            Return code
      * Initialise
     C                     EXSR ZZINIT
      *
      * Define Keylist
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO           List Number
     C                     KFLD           Y2INVL           Internal Value
      *
      * Setup Key fields
     C                     Z-ADDP1LSNO    Y2LSNO           List number
     C                     MOVELP1INVL    Y2INVL           Internal value
      *
      * Fetch Condition Name from appropriate format
      * Use @Y2EXIN if field is not value mapped
      * Since it will not be in @Y2INEX
     C           P1VLMP    IFEQ 'Y'
     C           KINEX     CHAIN@Y2INEX              90    *
     C                     ELSE
     C           KINEX     CHAIN@Y2EXIN              90    *
     C                     END
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANKS   P1CNNM           * Not found
     C                     MOVEL'Y2U0014' P0RTN            * Not found
     C                     ELSE
     C                     MOVELY2CNTX    P1CNNM           Condition Name
     C                     END
      *
     C                     RETRN
      *****************************************************************
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
      * File already opened?
     C           ZZOPN     IFNE 'N'                        *IF
      * Open file xxVLLSL0 where xx is 1st 2 char of program name.
     C                     MOVEL##PGM     @OV,9
      * OVRDBF to correct file name.
     C                     CALL 'QCAEXEC'
     C                     PARM           @OV
     C                     PARM 38        WKOVLN 155
     C                     OPEN Y2VLLSL0               90
     C           *IN90     IFEQ '1'                        *IF
     C                     MOVEL@1MSID    P0RTN            Exception msgid
     C                     MOVEL*BLANKS   P1CNNM           * Not found
     C                     RETRN
     C                     END                             *FI 90
     C                     END                             *FI ZZOPN
     C                     MOVE 'N'       ZZOPN   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @OV4 5 6 7 8 9
OVRDBF Y2VLLSL0 ??VLLSL0 SECURE(*YES)
