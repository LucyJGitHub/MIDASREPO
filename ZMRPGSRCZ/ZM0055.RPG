     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Format SWIFT Address.')
      ****************************************************************
      *                                                              *
      *  Midas - MESSAGE MAINTENANCE UTILITIES.                       *
      *                                                              *
      *  ZM0055 - FORMAT S.W.I.F.T. 'D' TYPE ADDRESS (FULL ADDRESS)  *
      *                                                              *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *        COMPANY CONFIDENTIAL.                                 *
      *                                                              *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *  Prev Amend No. CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 000000             Date .00/00/0              *
      *                                                              *
      ****************************************************************
      *  C R E A T I O N  P A R A M E T E R S.                       *
      *                                                              *
      *                                                              *
      ****************************************************************
      *                                                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *                                                               *
      *****************************************************************
      * PURPOSE.                                                     *
      *                                                              *
      *  To set up a D type address for use within a S.W.I.F.T.      *
      *  format message.                                             *
      ****************************************************************
      *
     E                    CPY@    1   1 80
      ** COPYRIGHT STATEMENT ARRAY.
      *
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      ** DSTS STRUCTURE FOR COMPILATION - COPYRIGHT INSERTION
      *
     ISDCUST    E DSSDCUSTPD
      ** External Data structure for Customer Details.
      *
     ISDCNST    E DSSDCNSTPD
      ** External Data structure for Counterparty Nostro Codes.
      *
     IDSFDY     E DSDSFDY
      ** 1st DS for access program , short data structure.
      *
     IDSSDY     E DSDSSDY
      ** 2nd DS for access program , long data structure.
     I/COPY WNCPYSRC,ZM0055I001
      *
      **  Entry of address information
     C           *ENTRY    PLIST
     C                     PARM           ZDEST  12
     C                     PARM           ZSADD1 35
     C                     PARM           ZSADD2 35
     C                     PARM           ZSADD3 35
     C                     PARM           ZSADD4 35
     C                     PARM           ZERR    1
      *
     C                     MOVE *BLANKS   ZSADD1
     C                     MOVE *BLANKS   ZSADD2
     C                     MOVE *BLANKS   ZSADD3
     C                     MOVE *BLANKS   ZSADD4
     C                     MOVE *BLANKS   ZERR
      *
     C/COPY WNCPYSRC,ZM0055C001
      ** Initially check for counterparty nostro.
     C                     MOVELZDEST     @CNCD
      *
     C                     CALL 'AOCNSTR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY'    @OPTN   7
     C                     PARM           @CNCD   8
     C           SDCNST    PARM SDCNST    DSFDY
      *
      ** If found set address type to 'C' (C/party nostro), and set up
      ** addresses
     C           @RTCD     IFEQ *BLANKS                    b*1
      *
     C           AWSWID    IFNE *BLANKS                    b*2
     C                     MOVELAWSWID    ZSADD1
     C                     ELSE                            x*2
     C                     MOVELAWCPNM    ZSADD1
     C                     MOVELAWCNTN    ZSADD2
     C                     END                             e*2
      *
      ** Else assume that address is customer
     C                     ELSE                            x*1
      *
      ** Check for customer number or shortname
     C                     MOVELZDEST     @KEY1
      *
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY'    @OPTN   7
     C                     PARM           @KEY1  10
     C                     PARM *BLANKS   @KYST   7
     C           SDCUST    PARM SDCUST    DSSDY
      *
      ** Error handling.
     C           @RTCD     IFNE *BLANKS                    b*2
     C                     MOVE '1'       ZERR
     C                     ELSE                            x*2
      *
      ** Retrieve the customer full address
      *
     C                     MOVELBBCNA1    ZSADD1
     C                     MOVELBBCNA2    ZSADD2
     C                     MOVELBBCNA3    ZSADD3
     C                     MOVELBBCNA4    ZSADD4
      *
     C                     END                             e*2
      *
     C                     END                             e*1
     C/COPY WNCPYSRC,ZM0055C002
      *
      **  Termination Processing.
     C                     SETON                     LR
      *
      **  End
** CPY@
(c) Misys International Banking Systems Ltd. 2001
